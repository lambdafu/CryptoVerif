Doing expand if, let, find... No change.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
No change.
Doing move all binders... No change.
Doing remove assignments of useless... No change.
{251}in(start, ());
{250}new pw: passwd;
{249}out(c8, {248}());
{247}(
{242}  ! !_53 <= NU
{241}  in(c1[{240}!_53], ());
{239}  new x: exponent;
{238}  let X: G = {237}exp({234}g, {236}x) in
{233}  out(c2[{232}!_53], {231}({228}U, {230}X));
{227}  in(c5[{226}!_53], (={225}S, Ystar_u: G));
{224}  let Y_u: G = {223}dec({221}Ystar_u, {222}pw) in
{219}  let K_u: G = {218}exp({215}Y_u, {217}x) in
{213}  let auth_u: hash1 = {212}h1({204}U, {205}S, {207}X, {209}Y_u, {211}K_u) in
{203}  out(c6[{202}!_53], {201}auth_u);
{199}  in(c9[{198}!_53], ());
{197}  let sk_u: hash0 = {196}h0({188}U, {189}S, {191}X, {193}Y_u, {195}K_u)
) | (
{181}  ! !_54 <= NS
{180}  in(c3[{179}!_54], (={178}U, X_s: G));
{177}  new y: exponent;
{176}  let Y: G = {175}exp({172}g, {174}y) in
{171}  let Ystar: G = {170}enc({168}Y, {169}pw) in
{166}  out(c4[{165}!_54], {164}({161}S, {163}Ystar));
{160}  in(c7[{159}!_54], auth_s: hash1);
{158}  let K_s: G = {157}exp({154}X_s, {156}y) in
{152}  if {151}({141}auth_s = {150}h1({142}U, {143}S, {145}X_s, {147}Y, {149}K_s)) then
{139}  let sk_s: hash0 = {138}h0({130}U, {131}S, {133}X_s, {135}Y, {137}K_s)
) | (
{123}  ! !_55 <= NP
{122}  in(cp[{121}!_55], ());
{120}  new xp: exponent;
{119}  let Xp: G = {118}exp({115}g, {117}xp) in
{114}  new yp: exponent;
{113}  let Yp: G = {112}exp({109}g, {111}yp) in
{108}  let Kp: G = {107}exp({101}g, {106}mult({103}xp, {105}yp)) in
{100}  let Ystarp: G = {99}enc({97}Yp, {98}pw) in
{95}  let authp: hash1 = {94}h1({86}U, {87}S, {89}Xp, {91}Yp, {93}Kp) in
{85}  let sk_p: hash0 = {84}h0({76}U, {77}S, {79}Xp, {81}Yp, {83}Kp) in
{75}  out(cp[{74}!_55], {73}({65}U, {67}Xp, {68}S, {70}Ystarp, {72}authp))
) | (
{56}  ! !_56 <= qE
{55}  in(@2_c1[{54}!_56], (@2_x: G, @2_ke: passwd));
{53}  out(@2_c2[{52}!_56], {51}enc({48}@2_x, {50}@2_ke))
) | (
{45}  ! !_57 <= qD
{44}  in(@2_c3[{43}!_57], (@2_m: G, @2_kd: passwd));
{42}  out(@2_c4[{41}!_57], {40}dec({37}@2_m, {39}@2_kd))
) | (
{34}  ! !_58 <= qH0
{33}  in(c10[{32}!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
{31}  out(c20[{30}!_58], {29}h0({20}x1_69, {22}x2_68, {24}x3_67, {26}x4_66, {28}x5_65))
) | (
{17}  ! !_59 <= qH1
{16}  in(c11[{15}!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
{14}  out(c21[{13}!_59], {12}h1({3}x1_64, {5}x2_63, {7}x3_62, {9}x4_61, {11}x5_60))
)

Doing insert instruction find j <= NU suchthat defined(X[j]) && X[j] = X_s then at occurrence 158... Done.
{293}in(start, ());
{292}new pw: passwd;
{291}out(c8, {290}());
{289}(
{284}  ! !_53 <= NU
{283}  in(c1[{282}!_53], ());
{281}  new x: exponent;
{280}  let X: G = {279}exp({276}g, {278}x) in
{275}  out(c2[{274}!_53], {273}({270}U, {272}X));
{269}  in(c5[{268}!_53], (={267}S, Ystar_u: G));
{266}  let Y_u: G = {265}dec({263}Ystar_u, {264}pw) in
{261}  let K_u: G = {260}exp({257}Y_u, {259}x) in
{255}  let auth_u: hash1 = {254}h1({246}U, {247}S, {249}X, {251}Y_u, {253}K_u) in
{245}  out(c6[{244}!_53], {243}auth_u);
{241}  in(c9[{240}!_53], ());
{239}  let sk_u: hash0 = {238}h0({230}U, {231}S, {233}X, {235}Y_u, {237}K_u)
) | (
{223}  ! !_54 <= NS
{222}  in(c3[{221}!_54], (={220}U, X_s: G));
{219}  new y: exponent;
{218}  let Y: G = {217}exp({214}g, {216}y) in
{213}  let Ystar: G = {212}enc({210}Y, {211}pw) in
{208}  out(c4[{207}!_54], {206}({203}S, {205}Ystar));
{202}  in(c7[{201}!_54], auth_s: hash1);
{200}  find j <= NU suchthat defined(X[{199}j]) && {197}({194}X[{193}j] = {196}X_s) then
  (
{191}    let K_s: G = {190}exp({187}X_s, {189}y) in
{185}    if {184}({174}auth_s = {183}h1({175}U, {176}S, {178}X_s, {180}Y, {182}K_s)) then
{172}    let sk_s: hash0 = {171}h0({163}U, {164}S, {166}X_s, {168}Y, {170}K_s)
  )
  else
  (
{158}    let K_s: G = {157}exp({154}X_s, {156}y) in
{152}    if {151}({141}auth_s = {150}h1({142}U, {143}S, {145}X_s, {147}Y, {149}K_s)) then
{139}    let sk_s: hash0 = {138}h0({130}U, {131}S, {133}X_s, {135}Y, {137}K_s)
  )
) | (
{123}  ! !_55 <= NP
{122}  in(cp[{121}!_55], ());
{120}  new xp: exponent;
{119}  let Xp: G = {118}exp({115}g, {117}xp) in
{114}  new yp: exponent;
{113}  let Yp: G = {112}exp({109}g, {111}yp) in
{108}  let Kp: G = {107}exp({101}g, {106}mult({103}xp, {105}yp)) in
{100}  let Ystarp: G = {99}enc({97}Yp, {98}pw) in
{95}  let authp: hash1 = {94}h1({86}U, {87}S, {89}Xp, {91}Yp, {93}Kp) in
{85}  let sk_p: hash0 = {84}h0({76}U, {77}S, {79}Xp, {81}Yp, {83}Kp) in
{75}  out(cp[{74}!_55], {73}({65}U, {67}Xp, {68}S, {70}Ystarp, {72}authp))
) | (
{56}  ! !_56 <= qE
{55}  in(@2_c1[{54}!_56], (@2_x: G, @2_ke: passwd));
{53}  out(@2_c2[{52}!_56], {51}enc({48}@2_x, {50}@2_ke))
) | (
{45}  ! !_57 <= qD
{44}  in(@2_c3[{43}!_57], (@2_m: G, @2_kd: passwd));
{42}  out(@2_c4[{41}!_57], {40}dec({37}@2_m, {39}@2_kd))
) | (
{34}  ! !_58 <= qH0
{33}  in(c10[{32}!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
{31}  out(c20[{30}!_58], {29}h0({20}x1_69, {22}x2_68, {24}x3_67, {26}x4_66, {28}x5_65))
) | (
{17}  ! !_59 <= qH1
{16}  in(c11[{15}!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
{14}  out(c21[{13}!_59], {12}h1({3}x1_64, {5}x2_63, {7}x3_62, {9}x4_61, {11}x5_60))
)

Doing insert instruction find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && (U = x1_64[nj]) && (S = x2_63[nj]) && (X_s = x3_62[nj]) && (Y = x4_61[nj]) then at occurrence 158... Done.
{360}in(start, ());
{359}new pw: passwd;
{358}out(c8, {357}());
{356}(
{351}  ! !_53 <= NU
{350}  in(c1[{349}!_53], ());
{348}  new x: exponent;
{347}  let X: G = {346}exp({343}g, {345}x) in
{342}  out(c2[{341}!_53], {340}({337}U, {339}X));
{336}  in(c5[{335}!_53], (={334}S, Ystar_u: G));
{333}  let Y_u: G = {332}dec({330}Ystar_u, {331}pw) in
{328}  let K_u: G = {327}exp({324}Y_u, {326}x) in
{322}  let auth_u: hash1 = {321}h1({313}U, {314}S, {316}X, {318}Y_u, {320}K_u) in
{312}  out(c6[{311}!_53], {310}auth_u);
{308}  in(c9[{307}!_53], ());
{306}  let sk_u: hash0 = {305}h0({297}U, {298}S, {300}X, {302}Y_u, {304}K_u)
) | (
{290}  ! !_54 <= NS
{289}  in(c3[{288}!_54], (={287}U, X_s: G));
{286}  new y: exponent;
{285}  let Y: G = {284}exp({281}g, {283}y) in
{280}  let Ystar: G = {279}enc({277}Y, {278}pw) in
{275}  out(c4[{274}!_54], {273}({270}S, {272}Ystar));
{269}  in(c7[{268}!_54], auth_s: hash1);
{267}  find j <= NU suchthat defined(X[{266}j]) && {264}({261}X[{260}j] = {263}X_s) then
  (
{258}    let K_s: G = {257}exp({254}X_s, {256}y) in
{252}    if {251}({241}auth_s = {250}h1({242}U, {243}S, {245}X_s, {247}Y, {249}K_s)) then
{239}    let sk_s: hash0 = {238}h0({230}U, {231}S, {233}X_s, {235}Y, {237}K_s)
  )
  else
  (
{225}    find nj <= qH1 suchthat defined(x1_64[{218}nj], x2_63[{220}nj], x3_62[{222}nj], x4_61[{224}nj]) && {216}({196}({192}U = {195}x1_64[{194}nj]) && {215}({201}({197}S = {200}x2_63[{199}nj]) && {214}({207}({203}X_s = {206}x3_62[{205}nj]) && {213}({209}Y = {212}x4_61[{211}nj])))) then
    (
{191}      let K_s: G = {190}exp({187}X_s, {189}y) in
{185}      if {184}({174}auth_s = {183}h1({175}U, {176}S, {178}X_s, {180}Y, {182}K_s)) then
{172}      let sk_s: hash0 = {171}h0({163}U, {164}S, {166}X_s, {168}Y, {170}K_s)
    )
    else
    (
{158}      let K_s: G = {157}exp({154}X_s, {156}y) in
{152}      if {151}({141}auth_s = {150}h1({142}U, {143}S, {145}X_s, {147}Y, {149}K_s)) then
{139}      let sk_s: hash0 = {138}h0({130}U, {131}S, {133}X_s, {135}Y, {137}K_s)
    )
  )
) | (
{123}  ! !_55 <= NP
{122}  in(cp[{121}!_55], ());
{120}  new xp: exponent;
{119}  let Xp: G = {118}exp({115}g, {117}xp) in
{114}  new yp: exponent;
{113}  let Yp: G = {112}exp({109}g, {111}yp) in
{108}  let Kp: G = {107}exp({101}g, {106}mult({103}xp, {105}yp)) in
{100}  let Ystarp: G = {99}enc({97}Yp, {98}pw) in
{95}  let authp: hash1 = {94}h1({86}U, {87}S, {89}Xp, {91}Yp, {93}Kp) in
{85}  let sk_p: hash0 = {84}h0({76}U, {77}S, {79}Xp, {81}Yp, {83}Kp) in
{75}  out(cp[{74}!_55], {73}({65}U, {67}Xp, {68}S, {70}Ystarp, {72}authp))
) | (
{56}  ! !_56 <= qE
{55}  in(@2_c1[{54}!_56], (@2_x: G, @2_ke: passwd));
{53}  out(@2_c2[{52}!_56], {51}enc({48}@2_x, {50}@2_ke))
) | (
{45}  ! !_57 <= qD
{44}  in(@2_c3[{43}!_57], (@2_m: G, @2_kd: passwd));
{42}  out(@2_c4[{41}!_57], {40}dec({37}@2_m, {39}@2_kd))
) | (
{34}  ! !_58 <= qH0
{33}  in(c10[{32}!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
{31}  out(c20[{30}!_58], {29}h0({20}x1_69, {22}x2_68, {24}x3_67, {26}x4_66, {28}x5_65))
) | (
{17}  ! !_59 <= qH1
{16}  in(c11[{15}!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
{14}  out(c21[{13}!_59], {12}h1({3}x1_64, {5}x2_63, {7}x3_62, {9}x4_61, {11}x5_60))
)

Doing insert event Auth at occurrence 191... Done.
Trying equivalence
equiv ! !_41 <= @2_N (@2_x: G, @2_ke: passwd) -> enc(@2_x, @2_ke) [all], ! !_42 <= @2_N2 (@2_m: G, @2_kd: passwd) -> dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_43 <= @2_N (@2_x_81: G, @2_ke_80: passwd) -> let @2_x: G = @2_x_81 in let @2_ke: passwd = @2_ke_80 in find [unique] @2_j_45 <= @2_N suchthat defined(@2_x[@2_j_45], @2_ke[@2_j_45], @2_r2[@2_j_45]) && otheruses(@2_r2[@2_j_45]) && ((@2_x = @2_x[@2_j_45]) && (@2_ke = @2_ke[@2_j_45])) then @2_r2[@2_j_45] orfind @2_k_46 <= @2_N2 suchthat defined(@2_r4[@2_k_46], @2_m[@2_k_46], @2_kd[@2_k_46]) && otheruses(@2_r4[@2_k_46]) && ((@2_x = @2_r4[@2_k_46]) && (@2_ke = @2_kd[@2_k_46])) then @2_m[@2_k_46] else new @2_r2: G; @2_r2, ! !_44 <= @2_N2 (@2_m_83: G, @2_kd_82: passwd) -> let @2_m: G = @2_m_83 in let @2_kd: passwd = @2_kd_82 in find [unique] @2_j_47 <= @2_N suchthat defined(@2_x[@2_j_47], @2_ke[@2_j_47], @2_r2[@2_j_47]) && otheruses(@2_r2[@2_j_47]) && ((@2_m = @2_r2[@2_j_47]) && (@2_kd = @2_ke[@2_j_47])) then @2_x[@2_j_47] orfind @2_k_48 <= @2_N2 suchthat defined(@2_r4[@2_k_48], @2_m[@2_k_48], @2_kd[@2_k_48]) && otheruses(@2_r4[@2_k_48]) && ((@2_m = @2_m[@2_k_48]) && (@2_kd = @2_kd[@2_k_48])) then @2_r4[@2_k_48] else new @2_r4: G; @2_r4
... Succeeded.
Doing simplify... Run simplify 2 time(s). Fixpoint reached.
Eliminated collisions between y and y Probability: 0.5 * NS * NS / |exponent|
Eliminated collisions between yp and yp Probability: 0.5 * NP * NP / |exponent|
Eliminated collisions between exp(g, y[!_54]) and @2_r4_84[!2_84] Probability: NS * qD / |exponent|
(exp(g, y[!_54]) characterizes a part of y[!_54] of type(s) exponent;
 @2_r4_84[!2_84] does not depend on y[!_54])
Eliminated collisions between exp(g, y[!_54]) and @2_r4_96[!2_83] Probability: NS * NU / |exponent|
(exp(g, y[!_54]) characterizes a part of y[!_54] of type(s) exponent;
 @2_r4_96[!2_83] does not depend on y[!_54])
Eliminated collisions between exp(g, y[!_54]) and @2_x_89[!2_82] Probability: NS * qE / |exponent|
(exp(g, y[!_54]) characterizes a part of y[!_54] of type(s) exponent;
 @2_x_89[!2_82] does not depend on y[!_54])
Eliminated collisions between exp(g, y[!_54]) and @2_x_92[!2_81] Probability: NS * NP / |exponent|
(exp(g, y[!_54]) characterizes a part of y[!_54] of type(s) exponent;
 @2_x_92[!2_81] does not depend on y[!_54])
Eliminated collisions between exp(g, yp[!_55]) and @2_r4_84[!2_79] Probability: NP * qD / |exponent|
(exp(g, yp[!_55]) characterizes a part of yp[!_55] of type(s) exponent;
 @2_r4_84[!2_79] does not depend on yp[!_55])
Eliminated collisions between exp(g, yp[!_55]) and @2_r4_96[!2_78] Probability: NP * NU / |exponent|
(exp(g, yp[!_55]) characterizes a part of yp[!_55] of type(s) exponent;
 @2_r4_96[!2_78] does not depend on yp[!_55])
Eliminated collisions between exp(g, yp[!_55]) and @2_x_89[!2_77] Probability: NP * qE / |exponent|
(exp(g, yp[!_55]) characterizes a part of yp[!_55] of type(s) exponent;
 @2_x_89[!2_77] does not depend on yp[!_55])
Eliminated collisions between exp(g, yp[!_55]) and @2_x_95[!2_75] Probability: NP * NS / |exponent|
(exp(g, yp[!_55]) characterizes a part of yp[!_55] of type(s) exponent;
 @2_x_95[!2_75] does not depend on yp[!_55])
Done.
Doing move all binders... No change.
Doing remove assignments of useless... Done.
{929}in(start, ());
{928}new pw: passwd;
{927}out(c8, {926}());
{925}(
{920}  ! !_53 <= NU
{919}  in(c1[{918}!_53], ());
{917}  new x: exponent;
{916}  let X: G = {915}exp({912}g, {914}x) in
{911}  out(c2[{910}!_53], {909}({906}U, {908}X));
{905}  in(c5[{904}!_53], (={903}S, Ystar_u: G));
{902}  let @2_m_98: G = {901}cst_G in
{900}  let @2_kd_97: passwd = {899}cst_passwd in
{898}  find [unique] @i_148 <= qD suchthat defined(@2_m[{659}@i_148], @2_kd[{661}@i_148], @2_kd_85[{663}@i_148], @2_m_86[{665}@i_148], @2_r4_84[{667}@i_148]) && otheruses(@2_r4_84[{657}@i_148]) && {655}({649}({645}Ystar_u = {648}@2_m[{647}@i_148]) && {654}({650}pw = {653}@2_kd[{652}@i_148])) then
  (
{643}    let K_u: G = {642}exp({639}@2_r4_84[{638}@i_148], {641}x) in
{636}    let auth_u: hash1 = {635}h1({626}U, {627}S, {629}X, {632}@2_r4_84[{631}@i_148], {634}K_u) in
{625}    out(c6[{624}!_53], {623}auth_u);
{621}    in(c9[{620}!_53], ());
{619}    let sk_u: hash0 = {618}h0({609}U, {610}S, {612}X, {615}@2_r4_84[{614}@i_148], {617}K_u)
  )
  orfind @i_144 <= NU suchthat defined(Ystar_u[{716}@i_144], @2_m_98[{718}@i_144], @2_r4_96[{720}@i_144]) && otheruses(@2_r4_96[{714}@i_144]) && {712}({708}Ystar_u = {711}Ystar_u[{710}@i_144]) then
  (
{706}    let K_u: G = {705}exp({702}@2_r4_96[{701}@i_144], {704}x) in
{699}    let auth_u: hash1 = {698}h1({689}U, {690}S, {692}X, {695}@2_r4_96[{694}@i_144], {697}K_u) in
{688}    out(c6[{687}!_53], {686}auth_u);
{684}    in(c9[{683}!_53], ());
{682}    let sk_u: hash0 = {681}h0({672}U, {673}S, {675}X, {678}@2_r4_96[{677}@i_144], {680}K_u)
  )
  orfind @i_142 <= qE suchthat defined(@2_ke[{775}@i_142], @2_x[{777}@i_142], @2_x_89[{779}@i_142], @2_ke_88[{781}@i_142], @2_r2_87[{783}@i_142]) && otheruses(@2_r2_87[{773}@i_142]) && {771}({765}({761}Ystar_u = {764}@2_r2_87[{763}@i_142]) && {770}({766}pw = {769}@2_ke[{768}@i_142])) then
  (
{759}    let K_u: G = {758}exp({755}@2_x[{754}@i_142], {757}x) in
{752}    let auth_u: hash1 = {751}h1({742}U, {743}S, {745}X, {748}@2_x[{747}@i_142], {750}K_u) in
{741}    out(c6[{740}!_53], {739}auth_u);
{737}    in(c9[{736}!_53], ());
{735}    let sk_u: hash0 = {734}h0({725}U, {726}S, {728}X, {731}@2_x[{730}@i_142], {733}K_u)
  )
  orfind @i_141 <= NP suchthat defined(Yp[{834}@i_141], @2_x_92[{836}@i_141], @2_r2_90[{838}@i_141], yp[{840}@i_141]) && otheruses(@2_r2_90[{832}@i_141]) && {830}({826}Ystar_u = {829}@2_r2_90[{828}@i_141]) then
  (
{824}    let K_u: G = {823}exp({816}g, {822}mult({819}yp[{818}@i_141], {821}x)) in
{815}    let auth_u: hash1 = {814}h1({805}U, {806}S, {808}X, {811}Yp[{810}@i_141], {813}K_u) in
{804}    out(c6[{803}!_53], {802}auth_u);
{800}    in(c9[{799}!_53], ());
{798}    let sk_u: hash0 = {797}h0({788}U, {789}S, {791}X, {794}Yp[{793}@i_141], {796}K_u)
  )
  orfind @i_140 <= NS suchthat defined(Y[{891}@i_140], @2_x_95[{893}@i_140], @2_r2_93[{895}@i_140], y[{897}@i_140]) && otheruses(@2_r2_93[{889}@i_140]) && {887}({883}Ystar_u = {886}@2_r2_93[{885}@i_140]) then
  (
{881}    let K_u: G = {880}exp({873}g, {879}mult({876}y[{875}@i_140], {878}x)) in
{872}    let auth_u: hash1 = {871}h1({862}U, {863}S, {865}X, {868}Y[{867}@i_140], {870}K_u) in
{861}    out(c6[{860}!_53], {859}auth_u);
{857}    in(c9[{856}!_53], ());
{855}    let sk_u: hash0 = {854}h0({845}U, {846}S, {848}X, {851}Y[{850}@i_140], {853}K_u)
  )
  else
  (
{604}    new @2_r4_96: G;
{603}    let K_u: G = {602}exp({599}@2_r4_96, {601}x) in
{597}    let auth_u: hash1 = {596}h1({588}U, {589}S, {591}X, {593}@2_r4_96, {595}K_u) in
{587}    out(c6[{586}!_53], {585}auth_u);
{583}    in(c9[{582}!_53], ());
{581}    let sk_u: hash0 = {580}h0({572}U, {573}S, {575}X, {577}@2_r4_96, {579}K_u)
  )
) | (
{564}  ! !_54 <= NS
{563}  in(c3[{562}!_54], (={561}U, X_s: G));
{560}  new y: exponent;
{559}  let Y: G = {558}exp({555}g, {557}y) in
{554}  let @2_x_95: G = {553}cst_G in
{552}  let @2_ke_94: passwd = {551}cst_passwd in
{550}  new @2_r2_93: G;
{549}  out(c4[{548}!_54], {547}({544}S, {546}@2_r2_93));
{543}  in(c7[{542}!_54], auth_s: hash1);
{541}  find j <= NU suchthat defined(X[{538}j], x[{540}j]) && {536}({533}X[{532}j] = {535}X_s) then
  (
{530}    let K_s: G = {529}exp({522}g, {528}mult({525}x[{524}j], {527}y)) in
{521}    if {520}({510}auth_s = {519}h1({511}U, {512}S, {514}X_s, {516}Y, {518}K_s)) then
{508}    let sk_s: hash0 = {507}h0({499}U, {500}S, {502}X_s, {504}Y, {506}K_s)
  )
  else
  (
{494}    find nj <= qH1 suchthat defined(x1_64[{487}nj], x2_63[{489}nj], x3_62[{491}nj], x4_61[{493}nj]) && {485}({465}({461}U = {464}x1_64[{463}nj]) && {484}({470}({466}S = {469}x2_63[{468}nj]) && {483}({476}({472}X_s = {475}x3_62[{474}nj]) && {482}({478}Y = {481}x4_61[{480}nj])))) then
    (
{460}      event {459}Auth
    )
    else
    (
{456}      let K_s: G = {455}exp({452}X_s, {454}y) in
{450}      if {449}({439}auth_s = {448}h1({440}U, {441}S, {443}X_s, {445}Y, {447}K_s)) then
{437}      let sk_s: hash0 = {436}h0({428}U, {429}S, {431}X_s, {433}Y, {435}K_s)
    )
  )
) | (
{420}  ! !_55 <= NP
{419}  in(cp[{418}!_55], ());
{417}  new xp: exponent;
{416}  let Xp: G = {415}exp({412}g, {414}xp) in
{411}  new yp: exponent;
{410}  let Yp: G = {409}exp({406}g, {408}yp) in
{405}  let Kp: G = {404}exp({398}g, {403}mult({400}xp, {402}yp)) in
{397}  let @2_x_92: G = {396}cst_G in
{395}  let @2_ke_91: passwd = {394}cst_passwd in
{393}  new @2_r2_90: G;
{392}  let authp: hash1 = {391}h1({383}U, {384}S, {386}Xp, {388}Yp, {390}Kp) in
{382}  let sk_p: hash0 = {381}h0({373}U, {374}S, {376}Xp, {378}Yp, {380}Kp) in
{372}  out(cp[{371}!_55], {370}({362}U, {364}Xp, {365}S, {367}@2_r2_90, {369}authp))
) | (
{352}  ! !_56 <= qE
{351}  in(@2_c1[{350}!_56], (@2_x: G, @2_ke: passwd));
{349}  let @2_x_89: G = {348}cst_G in
{347}  let @2_ke_88: passwd = {346}cst_passwd in
{345}  find [unique] @i_118 <= qD suchthat defined(@2_kd[{224}@i_118], @2_m[{226}@i_118], @2_m_86[{228}@i_118], @2_kd_85[{230}@i_118], @2_r4_84[{232}@i_118]) && otheruses(@2_r4_84[{222}@i_118]) && {220}({213}({209}@2_x = {212}@2_r4_84[{211}@i_118]) && {219}({215}@2_ke = {218}@2_kd[{217}@i_118])) then
  (
{207}    out(@2_c2[{206}!_56], {205}@2_m[{204}@i_118])
  )
  orfind @i_114 <= NU suchthat defined(pw, Ystar_u[{253}@i_114], @2_m_98[{255}@i_114], @2_kd_97[{257}@i_114], @2_r4_96[{259}@i_114]) && otheruses(@2_r4_96[{251}@i_114]) && {249}({244}({240}@2_x = {243}@2_r4_96[{242}@i_114]) && {248}({246}@2_ke = {247}pw)) then
  (
{238}    out(@2_c2[{237}!_56], {236}Ystar_u[{235}@i_114])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[{282}@i_112], @2_ke[{284}@i_112], @2_ke_88[{286}@i_112], @2_x_89[{288}@i_112], @2_r2_87[{290}@i_112]) && otheruses(@2_r2_87[{280}@i_112]) && {278}({271}({267}@2_x = {270}@2_x[{269}@i_112]) && {277}({273}@2_ke = {276}@2_ke[{275}@i_112])) then
  (
{265}    out(@2_c2[{264}!_56], {263}@2_r2_87[{262}@i_112])
  )
  orfind @i_111 <= NP suchthat defined(Yp[{311}@i_111], pw, @2_ke_91[{313}@i_111], @2_x_92[{315}@i_111], @2_r2_90[{317}@i_111]) && otheruses(@2_r2_90[{309}@i_111]) && {307}({302}({298}@2_x = {301}Yp[{300}@i_111]) && {306}({304}@2_ke = {305}pw)) then
  (
{296}    out(@2_c2[{295}!_56], {294}@2_r2_90[{293}@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[{338}@i_110], pw, @2_ke_94[{340}@i_110], @2_x_95[{342}@i_110], @2_r2_93[{344}@i_110]) && otheruses(@2_r2_93[{336}@i_110]) && {334}({329}({325}@2_x = {328}Y[{327}@i_110]) && {333}({331}@2_ke = {332}pw)) then
  (
{323}    out(@2_c2[{322}!_56], {321}@2_r2_93[{320}@i_110])
  )
  else
  (
{201}    new @2_r2_87: G;
{200}    out(@2_c2[{199}!_56], {198}@2_r2_87)
  )
) | (
{193}  ! !_57 <= qD
{192}  in(@2_c3[{191}!_57], (@2_m: G, @2_kd: passwd));
{190}  let @2_m_86: G = {189}cst_G in
{188}  let @2_kd_85: passwd = {187}cst_passwd in
{186}  find [unique] @i_108 <= qD suchthat defined(@2_m[{65}@i_108], @2_kd[{67}@i_108], @2_kd_85[{69}@i_108], @2_m_86[{71}@i_108], @2_r4_84[{73}@i_108]) && otheruses(@2_r4_84[{63}@i_108]) && {61}({54}({50}@2_m = {53}@2_m[{52}@i_108]) && {60}({56}@2_kd = {59}@2_kd[{58}@i_108])) then
  (
{48}    out(@2_c4[{47}!_57], {46}@2_r4_84[{45}@i_108])
  )
  orfind @i_104 <= NU suchthat defined(Ystar_u[{94}@i_104], pw, @2_kd_97[{96}@i_104], @2_m_98[{98}@i_104], @2_r4_96[{100}@i_104]) && otheruses(@2_r4_96[{92}@i_104]) && {90}({85}({81}@2_m = {84}Ystar_u[{83}@i_104]) && {89}({87}@2_kd = {88}pw)) then
  (
{79}    out(@2_c4[{78}!_57], {77}@2_r4_96[{76}@i_104])
  )
  orfind @i_102 <= qE suchthat defined(@2_ke[{123}@i_102], @2_x[{125}@i_102], @2_x_89[{127}@i_102], @2_ke_88[{129}@i_102], @2_r2_87[{131}@i_102]) && otheruses(@2_r2_87[{121}@i_102]) && {119}({112}({108}@2_m = {111}@2_r2_87[{110}@i_102]) && {118}({114}@2_kd = {117}@2_ke[{116}@i_102])) then
  (
{106}    out(@2_c4[{105}!_57], {104}@2_x[{103}@i_102])
  )
  orfind @i_101 <= NP suchthat defined(pw, Yp[{152}@i_101], @2_x_92[{154}@i_101], @2_ke_91[{156}@i_101], @2_r2_90[{158}@i_101]) && otheruses(@2_r2_90[{150}@i_101]) && {148}({143}({139}@2_m = {142}@2_r2_90[{141}@i_101]) && {147}({145}@2_kd = {146}pw)) then
  (
{137}    out(@2_c4[{136}!_57], {135}Yp[{134}@i_101])
  )
  orfind @i_100 <= NS suchthat defined(pw, Y[{179}@i_100], @2_x_95[{181}@i_100], @2_ke_94[{183}@i_100], @2_r2_93[{185}@i_100]) && otheruses(@2_r2_93[{177}@i_100]) && {175}({170}({166}@2_m = {169}@2_r2_93[{168}@i_100]) && {174}({172}@2_kd = {173}pw)) then
  (
{164}    out(@2_c4[{163}!_57], {162}Y[{161}@i_100])
  )
  else
  (
{42}    new @2_r4_84: G;
{41}    out(@2_c4[{40}!_57], {39}@2_r4_84)
  )
) | (
{34}  ! !_58 <= qH0
{33}  in(c10[{32}!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
{31}  out(c20[{30}!_58], {29}h0({20}x1_69, {22}x2_68, {24}x3_67, {26}x4_66, {28}x5_65))
) | (
{17}  ! !_59 <= qH1
{16}  in(c11[{15}!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
{14}  out(c21[{13}!_59], {12}h1({3}x1_64, {5}x2_63, {7}x3_62, {9}x4_61, {11}x5_60))
)

Doing insert event Encrypt at occurrence 759... Done.
Trying equivalence
equiv ! !_51 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_52 <= N (x1_74: host, x2_73: host, x3_72: G, x4_71: G, x5_70: G) -> let x1: host = x1_74 in let x2: host = x2_73 in let x3: G = x3_72 in let x4: G = x4_71 in let x5: G = x5_70 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash1; r
... Succeeded.
Doing simplify... Run simplify 2 time(s). Maximum reached.
Eliminated collisions between @2_r4_84 and @2_r4_84 Probability: 0.5 * qD * qD / |G|
Eliminated collisions between @2_r4_96 and @2_r4_84 Probability: NU * qD / |G|
Eliminated collisions between @2_r4_96 and @2_r4_96 Probability: 0.5 * NU * NU / |G|
Eliminated collisions between x and xp Probability: NU * NP / |exponent|
Eliminated collisions between y and xp Probability: NS * NP / |exponent|
Eliminated collisions between x and yp Probability: NU * NP / |exponent|
Eliminated collisions between y and x Probability: NS * NU / |exponent|
Eliminated collisions between x and x Probability: 0.5 * NU * NU / |exponent|
Eliminated collisions between y and yp Probability: NS * NP / |exponent|
Eliminated collisions between xp and xp Probability: 0.5 * NP * NP / |exponent|
Eliminated collisions between yp and xp Probability: NP * NP / |exponent|
Eliminated collisions between @2_r4_84[!2_995] and exp(g, yp[!2_996]) Probability: qD * NP / |G|
(@2_r4_84[!2_995] characterizes a part of @2_r4_84[!2_995] of type(s) G;
 exp(g, yp[!2_996]) does not depend on @2_r4_84[!2_995])
Eliminated collisions between @2_r4_84[!2_988] and exp(g, y[!2_989]) Probability: qD * NS / |G|
(@2_r4_84[!2_988] characterizes a part of @2_r4_84[!2_988] of type(s) G;
 exp(g, y[!2_989]) does not depend on @2_r4_84[!2_988])
Eliminated collisions between @2_r4_96[!2_915] and exp(g, yp[!2_916]) Probability: NU * NP / |G|
(@2_r4_96[!2_915] characterizes a part of @2_r4_96[!2_915] of type(s) G;
 exp(g, yp[!2_916]) does not depend on @2_r4_96[!2_915])
Eliminated collisions between @2_r4_96[!2_908] and exp(g, y[!2_909]) Probability: NU * NS / |G|
(@2_r4_96[!2_908] characterizes a part of @2_r4_96[!2_908] of type(s) G;
 exp(g, y[!2_909]) does not depend on @2_r4_96[!2_908])
Eliminated collisions between exp(g, yp[!2_857]) and @2_r4_84[!2_858] Probability: NP * qD / |exponent|
(exp(g, yp[!2_857]) characterizes a part of yp[!2_857] of type(s) exponent;
 @2_r4_84[!2_858] does not depend on yp[!2_857])
Eliminated collisions between exp(g, yp[!2_849]) and @2_r4_96[!2_850] Probability: NP * NU / |exponent|
(exp(g, yp[!2_849]) characterizes a part of yp[!2_849] of type(s) exponent;
 @2_r4_96[!2_850] does not depend on yp[!2_849])
Eliminated collisions between @2_r4_96[!_53] and x4_250[!2_760] Probability: NU * qH1 / |G|
(@2_r4_96[!_53] characterizes a part of @2_r4_96[!_53] of type(s) G;
 x4_250[!2_760] does not depend on @2_r4_96[!_53])
Eliminated collisions between @2_r4_96[!_53] and x4_256[!2_759] Probability: NU * NP / |G|
(@2_r4_96[!_53] characterizes a part of @2_r4_96[!_53] of type(s) G;
 x4_256[!2_759] does not depend on @2_r4_96[!_53])
Eliminated collisions between @2_r4_96[!_53] and x4_262[!2_758] Probability: NU * NS / |G|
(@2_r4_96[!_53] characterizes a part of @2_r4_96[!_53] of type(s) G;
 x4_262[!2_758] does not depend on @2_r4_96[!_53])
Eliminated collisions between @2_r4_96[!_53] and x4_268[!2_757] Probability: NU * NS / |G|
(@2_r4_96[!_53] characterizes a part of @2_r4_96[!_53] of type(s) G;
 x4_268[!2_757] does not depend on @2_r4_96[!_53])
Eliminated collisions between @2_r4_96[!_53] and x4_280[!2_755] Probability: NU * NU / |G|
(@2_r4_96[!_53] characterizes a part of @2_r4_96[!_53] of type(s) G;
 x4_280[!2_755] does not depend on @2_r4_96[!_53])
Eliminated collisions between @2_r4_96[!_53] and x4_286[!2_754] Probability: NU * NU / |G|
(@2_r4_96[!_53] characterizes a part of @2_r4_96[!_53] of type(s) G;
 x4_286[!2_754] does not depend on @2_r4_96[!_53])
Eliminated collisions between @2_r4_96[!_53] and x4_292[!2_753] Probability: NU * NU / |G|
(@2_r4_96[!_53] characterizes a part of @2_r4_96[!_53] of type(s) G;
 x4_292[!2_753] does not depend on @2_r4_96[!_53])
Eliminated collisions between @2_r4_96[!_53] and x4_298[!2_752] Probability: NU * NU / |G|
(@2_r4_96[!_53] characterizes a part of @2_r4_96[!_53] of type(s) G;
 x4_298[!2_752] does not depend on @2_r4_96[!_53])
Eliminated collisions between r_266[!_54] and auth_s[!_54] Probability: NS / |hash1|
(r_266[!_54] characterizes a part of r_266[!_54] of type(s) hash1;
 auth_s[!_54] does not depend on r_266[!_54])
Eliminated collisions between exp(g, y[!_54]) and @2_r4_84[!2_596] Probability: NS * qD / |exponent|
(exp(g, y[!_54]) characterizes a part of y[!_54] of type(s) exponent;
 @2_r4_84[!2_596] does not depend on y[!_54])
Eliminated collisions between exp(g, y[!_54]) and @2_r4_96[!2_590] Probability: NS * NU / |exponent|
(exp(g, y[!_54]) characterizes a part of y[!_54] of type(s) exponent;
 @2_r4_96[!2_590] does not depend on y[!_54])
Eliminated collisions between r_260[!_54] and auth_s[!_54] Probability: NS / |hash1|
(r_260[!_54] characterizes a part of r_260[!_54] of type(s) hash1;
 auth_s[!_54] does not depend on r_260[!_54])
Eliminated collisions between exp(g, xp[!_55]) and x3_251[!2_562] Probability: NP * qH1 / |exponent|
(exp(g, xp[!_55]) characterizes a part of xp[!_55] of type(s) exponent;
 x3_251[!2_562] does not depend on xp[!_55])
Eliminated collisions between exp(g, yp[!_55]) and x4_250[!2_562] Probability: NP * qH1 / |exponent|
(exp(g, yp[!_55]) characterizes a part of yp[!_55] of type(s) exponent;
 x4_250[!2_562] does not depend on yp[!_55])
Eliminated collisions between exp(g, xp[!_55]) and x3_263[!2_560] Probability: NP * NS / |exponent|
(exp(g, xp[!_55]) characterizes a part of xp[!_55] of type(s) exponent;
 x3_263[!2_560] does not depend on xp[!_55])
Eliminated collisions between exp(g, yp[!_55]) and x4_262[!2_560] Probability: NP * NS / |exponent|
(exp(g, yp[!_55]) characterizes a part of yp[!_55] of type(s) exponent;
 x4_262[!2_560] does not depend on yp[!_55])
Eliminated collisions between exp(g, xp[!_55]) and x3_269[!2_559] Probability: NP * NS / |exponent|
(exp(g, xp[!_55]) characterizes a part of xp[!_55] of type(s) exponent;
 x3_269[!2_559] does not depend on xp[!_55])
Eliminated collisions between exp(g, yp[!_55]) and x4_268[!2_559] Probability: NP * NS / |exponent|
(exp(g, yp[!_55]) characterizes a part of yp[!_55] of type(s) exponent;
 x4_268[!2_559] does not depend on yp[!_55])
Eliminated collisions between exp(g, xp[!_55]) and x3_275[!2_558] Probability: NP * NU / |exponent|
(exp(g, xp[!_55]) characterizes a part of xp[!_55] of type(s) exponent;
 x3_275[!2_558] does not depend on xp[!_55])
Eliminated collisions between exp(g, yp[!_55]) and x4_274[!2_558] Probability: NP * NU / |exponent|
(exp(g, yp[!_55]) characterizes a part of yp[!_55] of type(s) exponent;
 x4_274[!2_558] does not depend on yp[!_55])
Eliminated collisions between exp(g, xp[!_55]) and x3_281[!2_557] Probability: NP * NU / |exponent|
(exp(g, xp[!_55]) characterizes a part of xp[!_55] of type(s) exponent;
 x3_281[!2_557] does not depend on xp[!_55])
Eliminated collisions between exp(g, yp[!_55]) and x4_280[!2_557] Probability: NP * NU / |exponent|
(exp(g, yp[!_55]) characterizes a part of yp[!_55] of type(s) exponent;
 x4_280[!2_557] does not depend on yp[!_55])
Eliminated collisions between exp(g, xp[!_55]) and x3_287[!2_556] Probability: NP * NU / |exponent|
(exp(g, xp[!_55]) characterizes a part of xp[!_55] of type(s) exponent;
 x3_287[!2_556] does not depend on xp[!_55])
Eliminated collisions between exp(g, yp[!_55]) and x4_286[!2_556] Probability: NP * NU / |exponent|
(exp(g, yp[!_55]) characterizes a part of yp[!_55] of type(s) exponent;
 x4_286[!2_556] does not depend on yp[!_55])
Eliminated collisions between exp(g, xp[!_55]) and x3_293[!2_555] Probability: NP * NU / |exponent|
(exp(g, xp[!_55]) characterizes a part of xp[!_55] of type(s) exponent;
 x3_293[!2_555] does not depend on xp[!_55])
Eliminated collisions between exp(g, yp[!_55]) and x4_292[!2_555] Probability: NP * NU / |exponent|
(exp(g, yp[!_55]) characterizes a part of yp[!_55] of type(s) exponent;
 x4_292[!2_555] does not depend on yp[!_55])
Eliminated collisions between exp(g, xp[!_55]) and x3_299[!2_554] Probability: NP * NU / |exponent|
(exp(g, xp[!_55]) characterizes a part of xp[!_55] of type(s) exponent;
 x3_299[!2_554] does not depend on xp[!_55])
Eliminated collisions between exp(g, yp[!_55]) and x4_298[!2_554] Probability: NP * NU / |exponent|
(exp(g, yp[!_55]) characterizes a part of yp[!_55] of type(s) exponent;
 x4_298[!2_554] does not depend on yp[!_55])
Reduced (mult(yp[@i_141[!_53]], x[!_53]) = mult(xp[@i_372[!_53]], yp[@i_372[!_53]])) to (((yp[@i_141[!_53]] = xp[@i_372[!_53]]) && (x[!_53] = yp[@i_372[!_53]])) || ((yp[@i_141[!_53]] = yp[@i_372[!_53]]) && (x[!_53] = xp[@i_372[!_53]]))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_141[!_53]], x[!_53]) = mult(x[j[@i_370[!_53]]], y[@i_370[!_53]])) to (((yp[@i_141[!_53]] = x[j[@i_370[!_53]]]) && (x[!_53] = y[@i_370[!_53]])) || ((yp[@i_141[!_53]] = y[@i_370[!_53]]) && (x[!_53] = x[j[@i_370[!_53]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_141[!_53]], x[!_53]) = mult(yp[@i_141[@i_366[!_53]]], x[@i_366[!_53]])) to (((yp[@i_141[!_53]] = yp[@i_141[@i_366[!_53]]]) && (x[!_53] = x[@i_366[!_53]])) || ((yp[@i_141[!_53]] = x[@i_366[!_53]]) && (x[!_53] = yp[@i_141[@i_366[!_53]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_141[!_53]], x[!_53]) = mult(y[@i_140[@i_365[!_53]]], x[@i_365[!_53]])) to (((yp[@i_141[!_53]] = y[@i_140[@i_365[!_53]]]) && (x[!_53] = x[@i_365[!_53]])) || ((yp[@i_141[!_53]] = x[@i_365[!_53]]) && (x[!_53] = y[@i_140[@i_365[!_53]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_140[!_53]], x[!_53]) = mult(xp[@i_381[!_53]], yp[@i_381[!_53]])) to (((y[@i_140[!_53]] = xp[@i_381[!_53]]) && (x[!_53] = yp[@i_381[!_53]])) || ((y[@i_140[!_53]] = yp[@i_381[!_53]]) && (x[!_53] = xp[@i_381[!_53]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_140[!_53]], x[!_53]) = mult(x[!_53], y[@i_380[!_53]])) to (((y[@i_140[!_53]] = x[!_53]) && (x[!_53] = y[@i_380[!_53]])) || ((y[@i_140[!_53]] = y[@i_380[!_53]]) && (x[!_53] = x[!_53]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_140[!_53]], x[!_53]) = mult(x[j[@i_379[!_53]]], y[@i_379[!_53]])) to (((y[@i_140[!_53]] = x[j[@i_379[!_53]]]) && (x[!_53] = y[@i_379[!_53]])) || ((y[@i_140[!_53]] = y[@i_379[!_53]]) && (x[!_53] = x[j[@i_379[!_53]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_140[!_53]], x[!_53]) = mult(yp[@i_141[@i_375[!_53]]], x[@i_375[!_53]])) to (((y[@i_140[!_53]] = yp[@i_141[@i_375[!_53]]]) && (x[!_53] = x[@i_375[!_53]])) || ((y[@i_140[!_53]] = x[@i_375[!_53]]) && (x[!_53] = yp[@i_141[@i_375[!_53]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_140[!_53]], x[!_53]) = mult(y[@i_140[@i_374[!_53]]], x[@i_374[!_53]])) to (((y[@i_140[!_53]] = y[@i_140[@i_374[!_53]]]) && (x[!_53] = x[@i_374[!_53]])) || ((y[@i_140[!_53]] = x[@i_374[!_53]]) && (x[!_53] = y[@i_140[@i_374[!_53]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(x[j[!_54]], y[!_54]) = mult(xp[@i_336[!_54]], yp[@i_336[!_54]])) to (((x[j[!_54]] = xp[@i_336[!_54]]) && (y[!_54] = yp[@i_336[!_54]])) || ((x[j[!_54]] = yp[@i_336[!_54]]) && (y[!_54] = xp[@i_336[!_54]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_54]], y[!_54]) = mult(x[j[!_54]], y[@i_335[!_54]])) to (((x[j[!_54]] = x[j[!_54]]) && (y[!_54] = y[@i_335[!_54]])) || ((x[j[!_54]] = y[@i_335[!_54]]) && (y[!_54] = x[j[!_54]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_54]], y[!_54]) = mult(x[j[@i_334[!_54]]], y[@i_334[!_54]])) to (((x[j[!_54]] = x[j[@i_334[!_54]]]) && (y[!_54] = y[@i_334[!_54]])) || ((x[j[!_54]] = y[@i_334[!_54]]) && (y[!_54] = x[j[@i_334[!_54]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_54]], y[!_54]) = mult(yp[@i_141[@i_330[!_54]]], x[@i_330[!_54]])) to (((x[j[!_54]] = yp[@i_141[@i_330[!_54]]]) && (y[!_54] = x[@i_330[!_54]])) || ((x[j[!_54]] = x[@i_330[!_54]]) && (y[!_54] = yp[@i_141[@i_330[!_54]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_54]], y[!_54]) = mult(y[@i_140[@i_329[!_54]]], x[@i_329[!_54]])) to (((x[j[!_54]] = y[@i_140[@i_329[!_54]]]) && (y[!_54] = x[@i_329[!_54]])) || ((x[j[!_54]] = x[@i_329[!_54]]) && (y[!_54] = y[@i_140[@i_329[!_54]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[@i_325[!_54]]], y[!_54]) = mult(x[j[@i_325[!_54]]], y[@i_325[!_54]])) to (((x[j[@i_325[!_54]]] = x[j[@i_325[!_54]]]) && (y[!_54] = y[@i_325[!_54]])) || ((x[j[@i_325[!_54]]] = y[@i_325[!_54]]) && (y[!_54] = x[j[@i_325[!_54]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[@i_320[!_54]], y[!_54]) = mult(y[@i_140[@i_320[!_54]]], x[@i_320[!_54]])) to (((x[@i_320[!_54]] = y[@i_140[@i_320[!_54]]]) && (y[!_54] = x[@i_320[!_54]])) || ((x[@i_320[!_54]] = x[@i_320[!_54]]) && (y[!_54] = y[@i_140[@i_320[!_54]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(xp[!_55], yp[!_55]) = mult(xp[@i_318[!_55]], yp[@i_318[!_55]])) to (((xp[!_55] = xp[@i_318[!_55]]) && (yp[!_55] = yp[@i_318[!_55]])) || ((xp[!_55] = yp[@i_318[!_55]]) && (yp[!_55] = xp[@i_318[!_55]]))) Probability: 1. / |exponent| * NP
Done.
Doing move all binders... Done.
Doing remove assignments of useless... Done.
Trying equivalence
equiv ! !_51 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_52 <= N (x1_74: host, x2_73: host, x3_72: G, x4_71: G, x5_70: G) -> let x1: host = x1_74 in let x2: host = x2_73 in let x3: G = x3_72 in let x4: G = x4_71 in let x5: G = x5_70 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash1; r
... Failed.
Trying equivalence
equiv ! !_49 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_50 <= N (x1_79: host, x2_78: host, x3_77: G, x4_76: G, x5_75: G) -> let x1: host = x1_79 in let x2: host = x2_78 in let x3: G = x3_77 in let x4: G = x4_76 in let x5: G = x5_75 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash0; r
... Succeeded.
Doing simplify... Run simplify 2 time(s). Maximum reached.
Eliminated collisions between r_296 and r_248 Probability: NU * qH1 / |hash1|
Eliminated collisions between @2_r2_93 and @2_r2_93 Probability: 0.5 * NS * NS / |G|
Eliminated collisions between @2_r4_84[!2_3945] and exp(g, yp[!2_3946]) Probability: qD * NP / |G|
(@2_r4_84[!2_3945] characterizes a part of @2_r4_84[!2_3945] of type(s) G;
 exp(g, yp[!2_3946]) does not depend on @2_r4_84[!2_3945])
Eliminated collisions between @2_r4_84[!2_3920] and exp(g, y[!2_3921]) Probability: qD * NS / |G|
(@2_r4_84[!2_3920] characterizes a part of @2_r4_84[!2_3920] of type(s) G;
 exp(g, y[!2_3921]) does not depend on @2_r4_84[!2_3920])
Eliminated collisions between exp(g, yp[!2_3289]) and @2_r4_84[!2_3290] Probability: NP * qD / |exponent|
(exp(g, yp[!2_3289]) characterizes a part of yp[!2_3289] of type(s) exponent;
 @2_r4_84[!2_3290] does not depend on yp[!2_3289])
Eliminated collisions between exp(g, yp[!2_3265]) and @2_r4_96[!2_3266] Probability: NP * NU / |exponent|
(exp(g, yp[!2_3265]) characterizes a part of yp[!2_3265] of type(s) exponent;
 @2_r4_96[!2_3266] does not depend on yp[!2_3265])
Eliminated collisions between @2_r4_96[!_53] and exp(g, yp[!2_2713]) Probability: NU * NP / |G|
(@2_r4_96[!_53] characterizes a part of @2_r4_96[!_53] of type(s) G;
 exp(g, yp[!2_2713]) does not depend on @2_r4_96[!_53])
Eliminated collisions between @2_r4_96[!_53] and exp(g, y[!2_2694]) Probability: NU * NS / |G|
(@2_r4_96[!_53] characterizes a part of @2_r4_96[!_53] of type(s) G;
 exp(g, y[!2_2694]) does not depend on @2_r4_96[!_53])
Eliminated collisions between exp(g, y[!_54]) and @2_r4_84[!2_2405] Probability: NS * qD / |exponent|
(exp(g, y[!_54]) characterizes a part of y[!_54] of type(s) exponent;
 @2_r4_84[!2_2405] does not depend on y[!_54])
Eliminated collisions between exp(g, y[!_54]) and @2_r4_96[!2_2383] Probability: NS * NU / |exponent|
(exp(g, y[!_54]) characterizes a part of y[!_54] of type(s) exponent;
 @2_r4_96[!2_2383] does not depend on y[!_54])
Eliminated collisions between exp(g, xp[!_55]) and x3_676[!2_2208] Probability: NP * qH0 / |exponent|
(exp(g, xp[!_55]) characterizes a part of xp[!_55] of type(s) exponent;
 x3_676[!2_2208] does not depend on xp[!_55])
Eliminated collisions between exp(g, yp[!_55]) and x4_675[!2_2208] Probability: NP * qH0 / |exponent|
(exp(g, yp[!_55]) characterizes a part of yp[!_55] of type(s) exponent;
 x4_675[!2_2208] does not depend on yp[!_55])
Eliminated collisions between exp(g, xp[!_55]) and x3_688[!2_2206] Probability: NP * NS / |exponent|
(exp(g, xp[!_55]) characterizes a part of xp[!_55] of type(s) exponent;
 x3_688[!2_2206] does not depend on xp[!_55])
Eliminated collisions between exp(g, yp[!_55]) and x4_687[!2_2206] Probability: NP * NS / |exponent|
(exp(g, yp[!_55]) characterizes a part of yp[!_55] of type(s) exponent;
 x4_687[!2_2206] does not depend on yp[!_55])
Eliminated collisions between exp(g, xp[!_55]) and x3_694[!2_2205] Probability: NP * NS / |exponent|
(exp(g, xp[!_55]) characterizes a part of xp[!_55] of type(s) exponent;
 x3_694[!2_2205] does not depend on xp[!_55])
Eliminated collisions between exp(g, yp[!_55]) and x4_693[!2_2205] Probability: NP * NS / |exponent|
(exp(g, yp[!_55]) characterizes a part of yp[!_55] of type(s) exponent;
 x4_693[!2_2205] does not depend on yp[!_55])
Eliminated collisions between exp(g, xp[!_55]) and x3_700[!2_2204] Probability: NP * NU / |exponent|
(exp(g, xp[!_55]) characterizes a part of xp[!_55] of type(s) exponent;
 x3_700[!2_2204] does not depend on xp[!_55])
Eliminated collisions between exp(g, yp[!_55]) and x4_699[!2_2204] Probability: NP * NU / |exponent|
(exp(g, yp[!_55]) characterizes a part of yp[!_55] of type(s) exponent;
 x4_699[!2_2204] does not depend on yp[!_55])
Eliminated collisions between exp(g, xp[!_55]) and x3_706[!2_2203] Probability: NP * NU / |exponent|
(exp(g, xp[!_55]) characterizes a part of xp[!_55] of type(s) exponent;
 x3_706[!2_2203] does not depend on xp[!_55])
Eliminated collisions between exp(g, yp[!_55]) and x4_705[!2_2203] Probability: NP * NU / |exponent|
(exp(g, yp[!_55]) characterizes a part of yp[!_55] of type(s) exponent;
 x4_705[!2_2203] does not depend on yp[!_55])
Eliminated collisions between exp(g, xp[!_55]) and x3_712[!2_2202] Probability: NP * NU / |exponent|
(exp(g, xp[!_55]) characterizes a part of xp[!_55] of type(s) exponent;
 x3_712[!2_2202] does not depend on xp[!_55])
Eliminated collisions between exp(g, yp[!_55]) and x4_711[!2_2202] Probability: NP * NU / |exponent|
(exp(g, yp[!_55]) characterizes a part of yp[!_55] of type(s) exponent;
 x4_711[!2_2202] does not depend on yp[!_55])
Eliminated collisions between exp(g, xp[!_55]) and x3_718[!2_2201] Probability: NP * NU / |exponent|
(exp(g, xp[!_55]) characterizes a part of xp[!_55] of type(s) exponent;
 x3_718[!2_2201] does not depend on xp[!_55])
Eliminated collisions between exp(g, yp[!_55]) and x4_717[!2_2201] Probability: NP * NU / |exponent|
(exp(g, yp[!_55]) characterizes a part of yp[!_55] of type(s) exponent;
 x4_717[!2_2201] does not depend on yp[!_55])
Eliminated collisions between exp(g, xp[!_55]) and x3_724[!2_2200] Probability: NP * NU / |exponent|
(exp(g, xp[!_55]) characterizes a part of xp[!_55] of type(s) exponent;
 x3_724[!2_2200] does not depend on xp[!_55])
Eliminated collisions between exp(g, yp[!_55]) and x4_723[!2_2200] Probability: NP * NU / |exponent|
(exp(g, yp[!_55]) characterizes a part of yp[!_55] of type(s) exponent;
 x4_723[!2_2200] does not depend on yp[!_55])
Eliminated collisions between exp(g, xp[!_55]) and x3_730[!2_2199] Probability: NP * NU / |exponent|
(exp(g, xp[!_55]) characterizes a part of xp[!_55] of type(s) exponent;
 x3_730[!2_2199] does not depend on xp[!_55])
Eliminated collisions between exp(g, yp[!_55]) and x4_729[!2_2199] Probability: NP * NU / |exponent|
(exp(g, yp[!_55]) characterizes a part of yp[!_55] of type(s) exponent;
 x4_729[!2_2199] does not depend on yp[!_55])
Eliminated collisions between exp(g, xp[!_55]) and x3_736[!2_2198] Probability: NP * NU / |exponent|
(exp(g, xp[!_55]) characterizes a part of xp[!_55] of type(s) exponent;
 x3_736[!2_2198] does not depend on xp[!_55])
Eliminated collisions between exp(g, yp[!_55]) and x4_735[!2_2198] Probability: NP * NU / |exponent|
(exp(g, yp[!_55]) characterizes a part of yp[!_55] of type(s) exponent;
 x4_735[!2_2198] does not depend on yp[!_55])
Eliminated collisions between exp(g, xp[!_55]) and x3_742[!2_2197] Probability: NP * NU / |exponent|
(exp(g, xp[!_55]) characterizes a part of xp[!_55] of type(s) exponent;
 x3_742[!2_2197] does not depend on xp[!_55])
Eliminated collisions between exp(g, yp[!_55]) and x4_741[!2_2197] Probability: NP * NU / |exponent|
(exp(g, yp[!_55]) characterizes a part of yp[!_55] of type(s) exponent;
 x4_741[!2_2197] does not depend on yp[!_55])
Eliminated collisions between exp(g, xp[!_55]) and x3_748[!2_2196] Probability: NP * NU / |exponent|
(exp(g, xp[!_55]) characterizes a part of xp[!_55] of type(s) exponent;
 x3_748[!2_2196] does not depend on xp[!_55])
Eliminated collisions between exp(g, yp[!_55]) and x4_747[!2_2196] Probability: NP * NU / |exponent|
(exp(g, yp[!_55]) characterizes a part of yp[!_55] of type(s) exponent;
 x4_747[!2_2196] does not depend on yp[!_55])
Reduced (mult(yp[@i_141[!_53]], x[!_53]) = mult(xp[@i_892[!_53]], yp[@i_892[!_53]])) to (((yp[@i_141[!_53]] = xp[@i_892[!_53]]) && (x[!_53] = yp[@i_892[!_53]])) || ((yp[@i_141[!_53]] = yp[@i_892[!_53]]) && (x[!_53] = xp[@i_892[!_53]]))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_141[!_53]], x[!_53]) = mult(x[j[@i_891[!_53]]], y[@i_891[!_53]])) to (((yp[@i_141[!_53]] = x[j[@i_891[!_53]]]) && (x[!_53] = y[@i_891[!_53]])) || ((yp[@i_141[!_53]] = y[@i_891[!_53]]) && (x[!_53] = x[j[@i_891[!_53]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_141[!_53]], x[!_53]) = mult(x[j[@i_890[!_53]]], y[@i_890[!_53]])) to (((yp[@i_141[!_53]] = x[j[@i_890[!_53]]]) && (x[!_53] = y[@i_890[!_53]])) || ((yp[@i_141[!_53]] = y[@i_890[!_53]]) && (x[!_53] = x[j[@i_890[!_53]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_141[!_53]], x[!_53]) = mult(yp[@i_141[@i_884[!_53]]], x[@i_884[!_53]])) to (((yp[@i_141[!_53]] = yp[@i_141[@i_884[!_53]]]) && (x[!_53] = x[@i_884[!_53]])) || ((yp[@i_141[!_53]] = x[@i_884[!_53]]) && (x[!_53] = yp[@i_141[@i_884[!_53]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_141[!_53]], x[!_53]) = mult(yp[@i_141[@i_883[!_53]]], x[@i_883[!_53]])) to (((yp[@i_141[!_53]] = yp[@i_141[@i_883[!_53]]]) && (x[!_53] = x[@i_883[!_53]])) || ((yp[@i_141[!_53]] = x[@i_883[!_53]]) && (x[!_53] = yp[@i_141[@i_883[!_53]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_141[!_53]], x[!_53]) = mult(y[@i_140[@i_882[!_53]]], x[@i_882[!_53]])) to (((yp[@i_141[!_53]] = y[@i_140[@i_882[!_53]]]) && (x[!_53] = x[@i_882[!_53]])) || ((yp[@i_141[!_53]] = x[@i_882[!_53]]) && (x[!_53] = y[@i_140[@i_882[!_53]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_141[!_53]], x[!_53]) = mult(y[@i_140[@i_881[!_53]]], x[@i_881[!_53]])) to (((yp[@i_141[!_53]] = y[@i_140[@i_881[!_53]]]) && (x[!_53] = x[@i_881[!_53]])) || ((yp[@i_141[!_53]] = x[@i_881[!_53]]) && (x[!_53] = y[@i_140[@i_881[!_53]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_141[!_53]], x[!_53]) = mult(xp[@i_879[!_53]], yp[@i_879[!_53]])) to (((yp[@i_141[!_53]] = xp[@i_879[!_53]]) && (x[!_53] = yp[@i_879[!_53]])) || ((yp[@i_141[!_53]] = yp[@i_879[!_53]]) && (x[!_53] = xp[@i_879[!_53]]))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_141[!_53]], x[!_53]) = mult(x[j[@i_878[!_53]]], y[@i_878[!_53]])) to (((yp[@i_141[!_53]] = x[j[@i_878[!_53]]]) && (x[!_53] = y[@i_878[!_53]])) || ((yp[@i_141[!_53]] = y[@i_878[!_53]]) && (x[!_53] = x[j[@i_878[!_53]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_141[!_53]], x[!_53]) = mult(x[j[@i_877[!_53]]], y[@i_877[!_53]])) to (((yp[@i_141[!_53]] = x[j[@i_877[!_53]]]) && (x[!_53] = y[@i_877[!_53]])) || ((yp[@i_141[!_53]] = y[@i_877[!_53]]) && (x[!_53] = x[j[@i_877[!_53]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_141[!_53]], x[!_53]) = mult(yp[@i_141[@i_871[!_53]]], x[@i_871[!_53]])) to (((yp[@i_141[!_53]] = yp[@i_141[@i_871[!_53]]]) && (x[!_53] = x[@i_871[!_53]])) || ((yp[@i_141[!_53]] = x[@i_871[!_53]]) && (x[!_53] = yp[@i_141[@i_871[!_53]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_141[!_53]], x[!_53]) = mult(yp[@i_141[@i_870[!_53]]], x[@i_870[!_53]])) to (((yp[@i_141[!_53]] = yp[@i_141[@i_870[!_53]]]) && (x[!_53] = x[@i_870[!_53]])) || ((yp[@i_141[!_53]] = x[@i_870[!_53]]) && (x[!_53] = yp[@i_141[@i_870[!_53]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_141[!_53]], x[!_53]) = mult(y[@i_140[@i_869[!_53]]], x[@i_869[!_53]])) to (((yp[@i_141[!_53]] = y[@i_140[@i_869[!_53]]]) && (x[!_53] = x[@i_869[!_53]])) || ((yp[@i_141[!_53]] = x[@i_869[!_53]]) && (x[!_53] = y[@i_140[@i_869[!_53]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_141[!_53]], x[!_53]) = mult(y[@i_140[@i_868[!_53]]], x[@i_868[!_53]])) to (((yp[@i_141[!_53]] = y[@i_140[@i_868[!_53]]]) && (x[!_53] = x[@i_868[!_53]])) || ((yp[@i_141[!_53]] = x[@i_868[!_53]]) && (x[!_53] = y[@i_140[@i_868[!_53]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_140[!_53]], x[!_53]) = mult(xp[@i_918[!_53]], yp[@i_918[!_53]])) to (((y[@i_140[!_53]] = xp[@i_918[!_53]]) && (x[!_53] = yp[@i_918[!_53]])) || ((y[@i_140[!_53]] = yp[@i_918[!_53]]) && (x[!_53] = xp[@i_918[!_53]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_140[!_53]], x[!_53]) = mult(x[j[@i_917[!_53]]], y[@i_917[!_53]])) to (((y[@i_140[!_53]] = x[j[@i_917[!_53]]]) && (x[!_53] = y[@i_917[!_53]])) || ((y[@i_140[!_53]] = y[@i_917[!_53]]) && (x[!_53] = x[j[@i_917[!_53]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_140[!_53]], x[!_53]) = mult(x[j[@i_916[!_53]]], y[@i_916[!_53]])) to (((y[@i_140[!_53]] = x[j[@i_916[!_53]]]) && (x[!_53] = y[@i_916[!_53]])) || ((y[@i_140[!_53]] = y[@i_916[!_53]]) && (x[!_53] = x[j[@i_916[!_53]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_140[!_53]], x[!_53]) = mult(yp[@i_141[@i_910[!_53]]], x[@i_910[!_53]])) to (((y[@i_140[!_53]] = yp[@i_141[@i_910[!_53]]]) && (x[!_53] = x[@i_910[!_53]])) || ((y[@i_140[!_53]] = x[@i_910[!_53]]) && (x[!_53] = yp[@i_141[@i_910[!_53]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_140[!_53]], x[!_53]) = mult(yp[@i_141[@i_909[!_53]]], x[@i_909[!_53]])) to (((y[@i_140[!_53]] = yp[@i_141[@i_909[!_53]]]) && (x[!_53] = x[@i_909[!_53]])) || ((y[@i_140[!_53]] = x[@i_909[!_53]]) && (x[!_53] = yp[@i_141[@i_909[!_53]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_140[!_53]], x[!_53]) = mult(y[@i_140[@i_908[!_53]]], x[@i_908[!_53]])) to (((y[@i_140[!_53]] = y[@i_140[@i_908[!_53]]]) && (x[!_53] = x[@i_908[!_53]])) || ((y[@i_140[!_53]] = x[@i_908[!_53]]) && (x[!_53] = y[@i_140[@i_908[!_53]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_140[!_53]], x[!_53]) = mult(y[@i_140[@i_907[!_53]]], x[@i_907[!_53]])) to (((y[@i_140[!_53]] = y[@i_140[@i_907[!_53]]]) && (x[!_53] = x[@i_907[!_53]])) || ((y[@i_140[!_53]] = x[@i_907[!_53]]) && (x[!_53] = y[@i_140[@i_907[!_53]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_140[!_53]], x[!_53]) = mult(xp[@i_905[!_53]], yp[@i_905[!_53]])) to (((y[@i_140[!_53]] = xp[@i_905[!_53]]) && (x[!_53] = yp[@i_905[!_53]])) || ((y[@i_140[!_53]] = yp[@i_905[!_53]]) && (x[!_53] = xp[@i_905[!_53]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_140[!_53]], x[!_53]) = mult(x[j[@i_904[!_53]]], y[@i_904[!_53]])) to (((y[@i_140[!_53]] = x[j[@i_904[!_53]]]) && (x[!_53] = y[@i_904[!_53]])) || ((y[@i_140[!_53]] = y[@i_904[!_53]]) && (x[!_53] = x[j[@i_904[!_53]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_140[!_53]], x[!_53]) = mult(x[j[@i_903[!_53]]], y[@i_903[!_53]])) to (((y[@i_140[!_53]] = x[j[@i_903[!_53]]]) && (x[!_53] = y[@i_903[!_53]])) || ((y[@i_140[!_53]] = y[@i_903[!_53]]) && (x[!_53] = x[j[@i_903[!_53]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_140[!_53]], x[!_53]) = mult(yp[@i_141[@i_897[!_53]]], x[@i_897[!_53]])) to (((y[@i_140[!_53]] = yp[@i_141[@i_897[!_53]]]) && (x[!_53] = x[@i_897[!_53]])) || ((y[@i_140[!_53]] = x[@i_897[!_53]]) && (x[!_53] = yp[@i_141[@i_897[!_53]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_140[!_53]], x[!_53]) = mult(yp[@i_141[@i_896[!_53]]], x[@i_896[!_53]])) to (((y[@i_140[!_53]] = yp[@i_141[@i_896[!_53]]]) && (x[!_53] = x[@i_896[!_53]])) || ((y[@i_140[!_53]] = x[@i_896[!_53]]) && (x[!_53] = yp[@i_141[@i_896[!_53]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_140[!_53]], x[!_53]) = mult(y[@i_140[@i_895[!_53]]], x[@i_895[!_53]])) to (((y[@i_140[!_53]] = y[@i_140[@i_895[!_53]]]) && (x[!_53] = x[@i_895[!_53]])) || ((y[@i_140[!_53]] = x[@i_895[!_53]]) && (x[!_53] = y[@i_140[@i_895[!_53]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_140[!_53]], x[!_53]) = mult(y[@i_140[@i_894[!_53]]], x[@i_894[!_53]])) to (((y[@i_140[!_53]] = y[@i_140[@i_894[!_53]]]) && (x[!_53] = x[@i_894[!_53]])) || ((y[@i_140[!_53]] = x[@i_894[!_53]]) && (x[!_53] = y[@i_140[@i_894[!_53]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(x[j[!_54]], y[!_54]) = mult(xp[@i_788[!_54]], yp[@i_788[!_54]])) to (((x[j[!_54]] = xp[@i_788[!_54]]) && (y[!_54] = yp[@i_788[!_54]])) || ((x[j[!_54]] = yp[@i_788[!_54]]) && (y[!_54] = xp[@i_788[!_54]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_54]], y[!_54]) = mult(x[j[@i_787[!_54]]], y[@i_787[!_54]])) to (((x[j[!_54]] = x[j[@i_787[!_54]]]) && (y[!_54] = y[@i_787[!_54]])) || ((x[j[!_54]] = y[@i_787[!_54]]) && (y[!_54] = x[j[@i_787[!_54]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_54]], y[!_54]) = mult(x[j[@i_786[!_54]]], y[@i_786[!_54]])) to (((x[j[!_54]] = x[j[@i_786[!_54]]]) && (y[!_54] = y[@i_786[!_54]])) || ((x[j[!_54]] = y[@i_786[!_54]]) && (y[!_54] = x[j[@i_786[!_54]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_54]], y[!_54]) = mult(yp[@i_141[@i_780[!_54]]], x[@i_780[!_54]])) to (((x[j[!_54]] = yp[@i_141[@i_780[!_54]]]) && (y[!_54] = x[@i_780[!_54]])) || ((x[j[!_54]] = x[@i_780[!_54]]) && (y[!_54] = yp[@i_141[@i_780[!_54]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_54]], y[!_54]) = mult(yp[@i_141[@i_779[!_54]]], x[@i_779[!_54]])) to (((x[j[!_54]] = yp[@i_141[@i_779[!_54]]]) && (y[!_54] = x[@i_779[!_54]])) || ((x[j[!_54]] = x[@i_779[!_54]]) && (y[!_54] = yp[@i_141[@i_779[!_54]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_54]], y[!_54]) = mult(y[@i_140[@i_778[!_54]]], x[@i_778[!_54]])) to (((x[j[!_54]] = y[@i_140[@i_778[!_54]]]) && (y[!_54] = x[@i_778[!_54]])) || ((x[j[!_54]] = x[@i_778[!_54]]) && (y[!_54] = y[@i_140[@i_778[!_54]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_54]], y[!_54]) = mult(y[@i_140[@i_777[!_54]]], x[@i_777[!_54]])) to (((x[j[!_54]] = y[@i_140[@i_777[!_54]]]) && (y[!_54] = x[@i_777[!_54]])) || ((x[j[!_54]] = x[@i_777[!_54]]) && (y[!_54] = y[@i_140[@i_777[!_54]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_54]], y[!_54]) = mult(xp[@i_801[!_54]], yp[@i_801[!_54]])) to (((x[j[!_54]] = xp[@i_801[!_54]]) && (y[!_54] = yp[@i_801[!_54]])) || ((x[j[!_54]] = yp[@i_801[!_54]]) && (y[!_54] = xp[@i_801[!_54]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_54]], y[!_54]) = mult(x[j[@i_800[!_54]]], y[@i_800[!_54]])) to (((x[j[!_54]] = x[j[@i_800[!_54]]]) && (y[!_54] = y[@i_800[!_54]])) || ((x[j[!_54]] = y[@i_800[!_54]]) && (y[!_54] = x[j[@i_800[!_54]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_54]], y[!_54]) = mult(x[j[@i_799[!_54]]], y[@i_799[!_54]])) to (((x[j[!_54]] = x[j[@i_799[!_54]]]) && (y[!_54] = y[@i_799[!_54]])) || ((x[j[!_54]] = y[@i_799[!_54]]) && (y[!_54] = x[j[@i_799[!_54]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_54]], y[!_54]) = mult(yp[@i_141[@i_793[!_54]]], x[@i_793[!_54]])) to (((x[j[!_54]] = yp[@i_141[@i_793[!_54]]]) && (y[!_54] = x[@i_793[!_54]])) || ((x[j[!_54]] = x[@i_793[!_54]]) && (y[!_54] = yp[@i_141[@i_793[!_54]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_54]], y[!_54]) = mult(yp[@i_141[@i_792[!_54]]], x[@i_792[!_54]])) to (((x[j[!_54]] = yp[@i_141[@i_792[!_54]]]) && (y[!_54] = x[@i_792[!_54]])) || ((x[j[!_54]] = x[@i_792[!_54]]) && (y[!_54] = yp[@i_141[@i_792[!_54]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_54]], y[!_54]) = mult(y[@i_140[@i_791[!_54]]], x[@i_791[!_54]])) to (((x[j[!_54]] = y[@i_140[@i_791[!_54]]]) && (y[!_54] = x[@i_791[!_54]])) || ((x[j[!_54]] = x[@i_791[!_54]]) && (y[!_54] = y[@i_140[@i_791[!_54]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_54]], y[!_54]) = mult(y[@i_140[@i_790[!_54]]], x[@i_790[!_54]])) to (((x[j[!_54]] = y[@i_140[@i_790[!_54]]]) && (y[!_54] = x[@i_790[!_54]])) || ((x[j[!_54]] = x[@i_790[!_54]]) && (y[!_54] = y[@i_140[@i_790[!_54]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(xp[!_55], yp[!_55]) = mult(xp[@i_775[!_55]], yp[@i_775[!_55]])) to (((xp[!_55] = xp[@i_775[!_55]]) && (yp[!_55] = yp[@i_775[!_55]])) || ((xp[!_55] = yp[@i_775[!_55]]) && (yp[!_55] = xp[@i_775[!_55]]))) Probability: 1. / |exponent| * NP
Done.
Doing move all binders... Done.
Doing remove assignments of useless... Done.
Trying equivalence
equiv ! !_51 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_52 <= N (x1_74: host, x2_73: host, x3_72: G, x4_71: G, x5_70: G) -> let x1: host = x1_74 in let x2: host = x2_73 in let x3: G = x3_72 in let x4: G = x4_71 in let x5: G = x5_70 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash1; r
... Failed.
Trying equivalence
equiv ! !_49 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_50 <= N (x1_79: host, x2_78: host, x3_77: G, x4_76: G, x5_75: G) -> let x1: host = x1_79 in let x2: host = x2_78 in let x3: G = x3_77 in let x4: G = x4_76 in let x5: G = x5_75 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash0; r
... Failed.
Trying equivalence
equiv ! !_41 <= @2_N (@2_x: G, @2_ke: passwd) -> enc(@2_x, @2_ke) [all], ! !_42 <= @2_N2 (@2_m: G, @2_kd: passwd) -> dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_43 <= @2_N (@2_x_81: G, @2_ke_80: passwd) -> let @2_x: G = @2_x_81 in let @2_ke: passwd = @2_ke_80 in find [unique] @2_j_45 <= @2_N suchthat defined(@2_x[@2_j_45], @2_ke[@2_j_45], @2_r2[@2_j_45]) && otheruses(@2_r2[@2_j_45]) && ((@2_x = @2_x[@2_j_45]) && (@2_ke = @2_ke[@2_j_45])) then @2_r2[@2_j_45] orfind @2_k_46 <= @2_N2 suchthat defined(@2_r4[@2_k_46], @2_m[@2_k_46], @2_kd[@2_k_46]) && otheruses(@2_r4[@2_k_46]) && ((@2_x = @2_r4[@2_k_46]) && (@2_ke = @2_kd[@2_k_46])) then @2_m[@2_k_46] else new @2_r2: G; @2_r2, ! !_44 <= @2_N2 (@2_m_83: G, @2_kd_82: passwd) -> let @2_m: G = @2_m_83 in let @2_kd: passwd = @2_kd_82 in find [unique] @2_j_47 <= @2_N suchthat defined(@2_x[@2_j_47], @2_ke[@2_j_47], @2_r2[@2_j_47]) && otheruses(@2_r2[@2_j_47]) && ((@2_m = @2_r2[@2_j_47]) && (@2_kd = @2_ke[@2_j_47])) then @2_x[@2_j_47] orfind @2_k_48 <= @2_N2 suchthat defined(@2_r4[@2_k_48], @2_m[@2_k_48], @2_kd[@2_k_48]) && otheruses(@2_r4[@2_k_48]) && ((@2_m = @2_m[@2_k_48]) && (@2_kd = @2_kd[@2_k_48])) then @2_r4[@2_k_48] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  () -> exp(g, @1_a),
  ! !_12 <= @1_na' (@1_m_17: G) -> exp(@1_m_17, @1_a),
  ! !_13 <= @1_naCDH (@1_m_18: G, @1_j_19 <= @1_nb) -> (@1_m_18 = exp(g, mult(@1_b[@1_j_19], @1_a)))), ! !_14 <= @1_nb new @1_b: exponent; (
  () -> exp(g, @1_b),
  ! !_15 <= @1_nb' (@1_m_20: G) -> exp(@1_m_20, @1_b),
  ! !_16 <= @1_nbCDH (@1_m_21: G, @1_j_22 <= @1_na) -> (@1_m_21 = exp(g, mult(@1_a[@1_j_22], @1_b))))
<=(set(proba <= pCDH(time, @1_na, @1_nb, @1_naCDH, @1_nbCDH)))=>
      ! !_23 <= @1_na new @1_a: exponent; (
  () -> @1_exp'(g, @1_a),
  ! !_24 <= @1_na' (@1_m_29: G) -> let @1_ka: bitstring = @1_mark in @1_exp'(@1_m_29, @1_a),
  ! !_25 <= @1_naCDH (@1_m_30: G, @1_j_31 <= @1_nb) -> find @1_v_33 <= @1_nb', @1_u_34 <= @1_nb suchthat defined(@1_kb[@1_v_33, @1_u_34], @1_b[@1_u_34]) && (@1_b[@1_j_31] = @1_b[@1_u_34]) then (@1_m_30 = @1_exp'(g, mult(@1_b[@1_j_31], @1_a))) else find @1_v_32 <= @1_na' suchthat defined(@1_ka[@1_v_32]) then (@1_m_30 = @1_exp'(g, mult(@1_b[@1_j_31], @1_a))) else false), ! !_26 <= @1_nb new @1_b: exponent; (
  () -> @1_exp'(g, @1_b),
  ! !_27 <= @1_nb' (@1_m_35: G) -> let @1_kb: bitstring = @1_mark in @1_exp'(@1_m_35, @1_b),
  ! !_28 <= @1_nbCDH (@1_m_36: G, @1_j_37 <= @1_na) -> find @1_v_39 <= @1_na', @1_u_40 <= @1_na suchthat defined(@1_ka[@1_v_39, @1_u_40], @1_a[@1_u_40]) && (@1_a[@1_j_37] = @1_a[@1_u_40]) then (@1_m_36 = @1_exp'(g, mult(@1_a[@1_j_37], @1_b))) else find @1_v_38 <= @1_nb' suchthat defined(@1_kb[@1_v_38]) then (@1_m_36 = @1_exp'(g, mult(@1_a[@1_j_37], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; () -> @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; () -> @1_X
... Failed.
Trying equivalence
equiv ! !_7 <= @1_N new @1_x: exponent; () -> exp(g, @1_x)
<=(0)=>
      ! !_8 <= @1_N new @1_X: G; () -> @1_X
... Failed.
Trying equivalence
equiv ! !_1 <= @1_N new @1_X: G; (
  () -> @1_X,
  ! !_2 <= @1_N' (@1_m: exponent) -> exp(@1_X, @1_m))
<=(0)=>
      ! !_3 <= @1_N new @1_x: exponent; (
  () -> exp(g, @1_x),
  ! !_4 <= @1_N' (@1_m: exponent) -> exp(g, mult(@1_x, @1_m)))
... Succeeded.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
No change.
Doing move all binders... No change.
Doing remove assignments of useless... No change.
Trying equivalence
equiv ! !_51 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_52 <= N (x1_74: host, x2_73: host, x3_72: G, x4_71: G, x5_70: G) -> let x1: host = x1_74 in let x2: host = x2_73 in let x3: G = x3_72 in let x4: G = x4_71 in let x5: G = x5_70 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash1; r
... Failed.
Trying equivalence
equiv ! !_49 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_50 <= N (x1_79: host, x2_78: host, x3_77: G, x4_76: G, x5_75: G) -> let x1: host = x1_79 in let x2: host = x2_78 in let x3: G = x3_77 in let x4: G = x4_76 in let x5: G = x5_75 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash0; r
... Failed.
Trying equivalence
equiv ! !_41 <= @2_N (@2_x: G, @2_ke: passwd) -> enc(@2_x, @2_ke) [all], ! !_42 <= @2_N2 (@2_m: G, @2_kd: passwd) -> dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_43 <= @2_N (@2_x_81: G, @2_ke_80: passwd) -> let @2_x: G = @2_x_81 in let @2_ke: passwd = @2_ke_80 in find [unique] @2_j_45 <= @2_N suchthat defined(@2_x[@2_j_45], @2_ke[@2_j_45], @2_r2[@2_j_45]) && otheruses(@2_r2[@2_j_45]) && ((@2_x = @2_x[@2_j_45]) && (@2_ke = @2_ke[@2_j_45])) then @2_r2[@2_j_45] orfind @2_k_46 <= @2_N2 suchthat defined(@2_r4[@2_k_46], @2_m[@2_k_46], @2_kd[@2_k_46]) && otheruses(@2_r4[@2_k_46]) && ((@2_x = @2_r4[@2_k_46]) && (@2_ke = @2_kd[@2_k_46])) then @2_m[@2_k_46] else new @2_r2: G; @2_r2, ! !_44 <= @2_N2 (@2_m_83: G, @2_kd_82: passwd) -> let @2_m: G = @2_m_83 in let @2_kd: passwd = @2_kd_82 in find [unique] @2_j_47 <= @2_N suchthat defined(@2_x[@2_j_47], @2_ke[@2_j_47], @2_r2[@2_j_47]) && otheruses(@2_r2[@2_j_47]) && ((@2_m = @2_r2[@2_j_47]) && (@2_kd = @2_ke[@2_j_47])) then @2_x[@2_j_47] orfind @2_k_48 <= @2_N2 suchthat defined(@2_r4[@2_k_48], @2_m[@2_k_48], @2_kd[@2_k_48]) && otheruses(@2_r4[@2_k_48]) && ((@2_m = @2_m[@2_k_48]) && (@2_kd = @2_kd[@2_k_48])) then @2_r4[@2_k_48] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  () -> exp(g, @1_a),
  ! !_12 <= @1_na' (@1_m_17: G) -> exp(@1_m_17, @1_a),
  ! !_13 <= @1_naCDH (@1_m_18: G, @1_j_19 <= @1_nb) -> (@1_m_18 = exp(g, mult(@1_b[@1_j_19], @1_a)))), ! !_14 <= @1_nb new @1_b: exponent; (
  () -> exp(g, @1_b),
  ! !_15 <= @1_nb' (@1_m_20: G) -> exp(@1_m_20, @1_b),
  ! !_16 <= @1_nbCDH (@1_m_21: G, @1_j_22 <= @1_na) -> (@1_m_21 = exp(g, mult(@1_a[@1_j_22], @1_b))))
<=(set(proba <= pCDH(time, @1_na, @1_nb, @1_naCDH, @1_nbCDH)))=>
      ! !_23 <= @1_na new @1_a: exponent; (
  () -> @1_exp'(g, @1_a),
  ! !_24 <= @1_na' (@1_m_29: G) -> let @1_ka: bitstring = @1_mark in @1_exp'(@1_m_29, @1_a),
  ! !_25 <= @1_naCDH (@1_m_30: G, @1_j_31 <= @1_nb) -> find @1_v_33 <= @1_nb', @1_u_34 <= @1_nb suchthat defined(@1_kb[@1_v_33, @1_u_34], @1_b[@1_u_34]) && (@1_b[@1_j_31] = @1_b[@1_u_34]) then (@1_m_30 = @1_exp'(g, mult(@1_b[@1_j_31], @1_a))) else find @1_v_32 <= @1_na' suchthat defined(@1_ka[@1_v_32]) then (@1_m_30 = @1_exp'(g, mult(@1_b[@1_j_31], @1_a))) else false), ! !_26 <= @1_nb new @1_b: exponent; (
  () -> @1_exp'(g, @1_b),
  ! !_27 <= @1_nb' (@1_m_35: G) -> let @1_kb: bitstring = @1_mark in @1_exp'(@1_m_35, @1_b),
  ! !_28 <= @1_nbCDH (@1_m_36: G, @1_j_37 <= @1_na) -> find @1_v_39 <= @1_na', @1_u_40 <= @1_na suchthat defined(@1_ka[@1_v_39, @1_u_40], @1_a[@1_u_40]) && (@1_a[@1_j_37] = @1_a[@1_u_40]) then (@1_m_36 = @1_exp'(g, mult(@1_a[@1_j_37], @1_b))) else find @1_v_38 <= @1_nb' suchthat defined(@1_kb[@1_v_38]) then (@1_m_36 = @1_exp'(g, mult(@1_a[@1_j_37], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; () -> @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; () -> @1_X
... Failed.
Trying equivalence
equiv ! !_7 <= @1_N new @1_x: exponent; () -> exp(g, @1_x)
<=(0)=>
      ! !_8 <= @1_N new @1_X: G; () -> @1_X
... Failed.
Trying equivalence
equiv ! !_1 <= @1_N new @1_X: G; (
  () -> @1_X,
  ! !_2 <= @1_N' (@1_m: exponent) -> exp(@1_X, @1_m))
<=(0)=>
      ! !_3 <= @1_N new @1_x: exponent; (
  () -> exp(g, @1_x),
  ! !_4 <= @1_N' (@1_m: exponent) -> exp(g, mult(@1_x, @1_m)))
... Succeeded.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
No change.
Doing move all binders... No change.
Doing remove assignments of useless... No change.
Trying equivalence
equiv ! !_51 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_52 <= N (x1_74: host, x2_73: host, x3_72: G, x4_71: G, x5_70: G) -> let x1: host = x1_74 in let x2: host = x2_73 in let x3: G = x3_72 in let x4: G = x4_71 in let x5: G = x5_70 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash1; r
... Failed.
Trying equivalence
equiv ! !_49 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_50 <= N (x1_79: host, x2_78: host, x3_77: G, x4_76: G, x5_75: G) -> let x1: host = x1_79 in let x2: host = x2_78 in let x3: G = x3_77 in let x4: G = x4_76 in let x5: G = x5_75 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash0; r
... Failed.
Trying equivalence
equiv ! !_41 <= @2_N (@2_x: G, @2_ke: passwd) -> enc(@2_x, @2_ke) [all], ! !_42 <= @2_N2 (@2_m: G, @2_kd: passwd) -> dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_43 <= @2_N (@2_x_81: G, @2_ke_80: passwd) -> let @2_x: G = @2_x_81 in let @2_ke: passwd = @2_ke_80 in find [unique] @2_j_45 <= @2_N suchthat defined(@2_x[@2_j_45], @2_ke[@2_j_45], @2_r2[@2_j_45]) && otheruses(@2_r2[@2_j_45]) && ((@2_x = @2_x[@2_j_45]) && (@2_ke = @2_ke[@2_j_45])) then @2_r2[@2_j_45] orfind @2_k_46 <= @2_N2 suchthat defined(@2_r4[@2_k_46], @2_m[@2_k_46], @2_kd[@2_k_46]) && otheruses(@2_r4[@2_k_46]) && ((@2_x = @2_r4[@2_k_46]) && (@2_ke = @2_kd[@2_k_46])) then @2_m[@2_k_46] else new @2_r2: G; @2_r2, ! !_44 <= @2_N2 (@2_m_83: G, @2_kd_82: passwd) -> let @2_m: G = @2_m_83 in let @2_kd: passwd = @2_kd_82 in find [unique] @2_j_47 <= @2_N suchthat defined(@2_x[@2_j_47], @2_ke[@2_j_47], @2_r2[@2_j_47]) && otheruses(@2_r2[@2_j_47]) && ((@2_m = @2_r2[@2_j_47]) && (@2_kd = @2_ke[@2_j_47])) then @2_x[@2_j_47] orfind @2_k_48 <= @2_N2 suchthat defined(@2_r4[@2_k_48], @2_m[@2_k_48], @2_kd[@2_k_48]) && otheruses(@2_r4[@2_k_48]) && ((@2_m = @2_m[@2_k_48]) && (@2_kd = @2_kd[@2_k_48])) then @2_r4[@2_k_48] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  () -> exp(g, @1_a),
  ! !_12 <= @1_na' (@1_m_17: G) -> exp(@1_m_17, @1_a),
  ! !_13 <= @1_naCDH (@1_m_18: G, @1_j_19 <= @1_nb) -> (@1_m_18 = exp(g, mult(@1_b[@1_j_19], @1_a)))), ! !_14 <= @1_nb new @1_b: exponent; (
  () -> exp(g, @1_b),
  ! !_15 <= @1_nb' (@1_m_20: G) -> exp(@1_m_20, @1_b),
  ! !_16 <= @1_nbCDH (@1_m_21: G, @1_j_22 <= @1_na) -> (@1_m_21 = exp(g, mult(@1_a[@1_j_22], @1_b))))
<=(set(proba <= pCDH(time, @1_na, @1_nb, @1_naCDH, @1_nbCDH)))=>
      ! !_23 <= @1_na new @1_a: exponent; (
  () -> @1_exp'(g, @1_a),
  ! !_24 <= @1_na' (@1_m_29: G) -> let @1_ka: bitstring = @1_mark in @1_exp'(@1_m_29, @1_a),
  ! !_25 <= @1_naCDH (@1_m_30: G, @1_j_31 <= @1_nb) -> find @1_v_33 <= @1_nb', @1_u_34 <= @1_nb suchthat defined(@1_kb[@1_v_33, @1_u_34], @1_b[@1_u_34]) && (@1_b[@1_j_31] = @1_b[@1_u_34]) then (@1_m_30 = @1_exp'(g, mult(@1_b[@1_j_31], @1_a))) else find @1_v_32 <= @1_na' suchthat defined(@1_ka[@1_v_32]) then (@1_m_30 = @1_exp'(g, mult(@1_b[@1_j_31], @1_a))) else false), ! !_26 <= @1_nb new @1_b: exponent; (
  () -> @1_exp'(g, @1_b),
  ! !_27 <= @1_nb' (@1_m_35: G) -> let @1_kb: bitstring = @1_mark in @1_exp'(@1_m_35, @1_b),
  ! !_28 <= @1_nbCDH (@1_m_36: G, @1_j_37 <= @1_na) -> find @1_v_39 <= @1_na', @1_u_40 <= @1_na suchthat defined(@1_ka[@1_v_39, @1_u_40], @1_a[@1_u_40]) && (@1_a[@1_j_37] = @1_a[@1_u_40]) then (@1_m_36 = @1_exp'(g, mult(@1_a[@1_j_37], @1_b))) else find @1_v_38 <= @1_nb' suchthat defined(@1_kb[@1_v_38]) then (@1_m_36 = @1_exp'(g, mult(@1_a[@1_j_37], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; () -> @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; () -> @1_X
... Failed.
Trying equivalence
equiv ! !_7 <= @1_N new @1_x: exponent; () -> exp(g, @1_x)
<=(0)=>
      ! !_8 <= @1_N new @1_X: G; () -> @1_X
... Failed.
Trying equivalence
equiv ! !_1 <= @1_N new @1_X: G; (
  () -> @1_X,
  ! !_2 <= @1_N' (@1_m: exponent) -> exp(@1_X, @1_m))
<=(0)=>
      ! !_3 <= @1_N new @1_x: exponent; (
  () -> exp(g, @1_x),
  ! !_4 <= @1_N' (@1_m: exponent) -> exp(g, mult(@1_x, @1_m)))
... Failed.
Doing remove assignments of binder Kp... Done.
Doing remove assignments of binder K_s... Done.
Doing SA rename K_u... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  () -> exp(g, @1_a),
  ! !_12 <= @1_na' (@1_m_17: G) -> exp(@1_m_17, @1_a),
  ! !_13 <= @1_naCDH (@1_m_18: G, @1_j_19 <= @1_nb) -> (@1_m_18 = exp(g, mult(@1_b[@1_j_19], @1_a)))), ! !_14 <= @1_nb new @1_b: exponent; (
  () -> exp(g, @1_b),
  ! !_15 <= @1_nb' (@1_m_20: G) -> exp(@1_m_20, @1_b),
  ! !_16 <= @1_nbCDH (@1_m_21: G, @1_j_22 <= @1_na) -> (@1_m_21 = exp(g, mult(@1_a[@1_j_22], @1_b))))
<=(set(proba <= pCDH(time, @1_na, @1_nb, @1_naCDH, @1_nbCDH)))=>
      ! !_23 <= @1_na new @1_a: exponent; (
  () -> @1_exp'(g, @1_a),
  ! !_24 <= @1_na' (@1_m_29: G) -> let @1_ka: bitstring = @1_mark in @1_exp'(@1_m_29, @1_a),
  ! !_25 <= @1_naCDH (@1_m_30: G, @1_j_31 <= @1_nb) -> find @1_v_33 <= @1_nb', @1_u_34 <= @1_nb suchthat defined(@1_kb[@1_v_33, @1_u_34], @1_b[@1_u_34]) && (@1_b[@1_j_31] = @1_b[@1_u_34]) then (@1_m_30 = @1_exp'(g, mult(@1_b[@1_j_31], @1_a))) else find @1_v_32 <= @1_na' suchthat defined(@1_ka[@1_v_32]) then (@1_m_30 = @1_exp'(g, mult(@1_b[@1_j_31], @1_a))) else false), ! !_26 <= @1_nb new @1_b: exponent; (
  () -> @1_exp'(g, @1_b),
  ! !_27 <= @1_nb' (@1_m_35: G) -> let @1_kb: bitstring = @1_mark in @1_exp'(@1_m_35, @1_b),
  ! !_28 <= @1_nbCDH (@1_m_36: G, @1_j_37 <= @1_na) -> find @1_v_39 <= @1_na', @1_u_40 <= @1_na suchthat defined(@1_ka[@1_v_39, @1_u_40], @1_a[@1_u_40]) && (@1_a[@1_j_37] = @1_a[@1_u_40]) then (@1_m_36 = @1_exp'(g, mult(@1_a[@1_j_37], @1_b))) else find @1_v_38 <= @1_nb' suchthat defined(@1_kb[@1_v_38]) then (@1_m_36 = @1_exp'(g, mult(@1_a[@1_j_37], @1_b))) else false)
with xp, y, yp, @1_x_1271, x, @1_x_1092... Failed.
Doing remove assignments of binder K_u_1534... Done.
Doing remove assignments of binder K_u_1530... Done.
Doing remove assignments of binder K_u_1531... Done.
Doing remove assignments of binder K_u_1532... Done.
Doing remove assignments of binder K_u_1533... Done.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  () -> exp(g, @1_a),
  ! !_12 <= @1_na' (@1_m_17: G) -> exp(@1_m_17, @1_a),
  ! !_13 <= @1_naCDH (@1_m_18: G, @1_j_19 <= @1_nb) -> (@1_m_18 = exp(g, mult(@1_b[@1_j_19], @1_a)))), ! !_14 <= @1_nb new @1_b: exponent; (
  () -> exp(g, @1_b),
  ! !_15 <= @1_nb' (@1_m_20: G) -> exp(@1_m_20, @1_b),
  ! !_16 <= @1_nbCDH (@1_m_21: G, @1_j_22 <= @1_na) -> (@1_m_21 = exp(g, mult(@1_a[@1_j_22], @1_b))))
<=(set(proba <= pCDH(time, @1_na, @1_nb, @1_naCDH, @1_nbCDH)))=>
      ! !_23 <= @1_na new @1_a: exponent; (
  () -> @1_exp'(g, @1_a),
  ! !_24 <= @1_na' (@1_m_29: G) -> let @1_ka: bitstring = @1_mark in @1_exp'(@1_m_29, @1_a),
  ! !_25 <= @1_naCDH (@1_m_30: G, @1_j_31 <= @1_nb) -> find @1_v_33 <= @1_nb', @1_u_34 <= @1_nb suchthat defined(@1_kb[@1_v_33, @1_u_34], @1_b[@1_u_34]) && (@1_b[@1_j_31] = @1_b[@1_u_34]) then (@1_m_30 = @1_exp'(g, mult(@1_b[@1_j_31], @1_a))) else find @1_v_32 <= @1_na' suchthat defined(@1_ka[@1_v_32]) then (@1_m_30 = @1_exp'(g, mult(@1_b[@1_j_31], @1_a))) else false), ! !_26 <= @1_nb new @1_b: exponent; (
  () -> @1_exp'(g, @1_b),
  ! !_27 <= @1_nb' (@1_m_35: G) -> let @1_kb: bitstring = @1_mark in @1_exp'(@1_m_35, @1_b),
  ! !_28 <= @1_nbCDH (@1_m_36: G, @1_j_37 <= @1_na) -> find @1_v_39 <= @1_na', @1_u_40 <= @1_na suchthat defined(@1_ka[@1_v_39, @1_u_40], @1_a[@1_u_40]) && (@1_a[@1_j_37] = @1_a[@1_u_40]) then (@1_m_36 = @1_exp'(g, mult(@1_a[@1_j_37], @1_b))) else find @1_v_38 <= @1_nb' suchthat defined(@1_kb[@1_v_38]) then (@1_m_36 = @1_exp'(g, mult(@1_a[@1_j_37], @1_b))) else false)
with xp, y, yp, @1_x_1271, x, @1_x_1092... Succeeded.
Doing simplify... Run simplify 2 time(s). Maximum reached.
Done.
Doing move all binders... Done.
Doing remove assignments of useless... Done.
Proved one-session secrecy of sk_u
Proved secrecy of sk_u
Proved one-session secrecy of sk_s
Proved secrecy of sk_s
Proved one-session secrecy of sk_p
Proved secrecy of sk_p
Trying equivalence
equiv ! !_51 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_52 <= N (x1_74: host, x2_73: host, x3_72: G, x4_71: G, x5_70: G) -> let x1: host = x1_74 in let x2: host = x2_73 in let x3: G = x3_72 in let x4: G = x4_71 in let x5: G = x5_70 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash1; r
... Failed.
Trying equivalence
equiv ! !_49 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_50 <= N (x1_79: host, x2_78: host, x3_77: G, x4_76: G, x5_75: G) -> let x1: host = x1_79 in let x2: host = x2_78 in let x3: G = x3_77 in let x4: G = x4_76 in let x5: G = x5_75 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash0; r
... Failed.
Trying equivalence
equiv ! !_41 <= @2_N (@2_x: G, @2_ke: passwd) -> enc(@2_x, @2_ke) [all], ! !_42 <= @2_N2 (@2_m: G, @2_kd: passwd) -> dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_43 <= @2_N (@2_x_81: G, @2_ke_80: passwd) -> let @2_x: G = @2_x_81 in let @2_ke: passwd = @2_ke_80 in find [unique] @2_j_45 <= @2_N suchthat defined(@2_x[@2_j_45], @2_ke[@2_j_45], @2_r2[@2_j_45]) && otheruses(@2_r2[@2_j_45]) && ((@2_x = @2_x[@2_j_45]) && (@2_ke = @2_ke[@2_j_45])) then @2_r2[@2_j_45] orfind @2_k_46 <= @2_N2 suchthat defined(@2_r4[@2_k_46], @2_m[@2_k_46], @2_kd[@2_k_46]) && otheruses(@2_r4[@2_k_46]) && ((@2_x = @2_r4[@2_k_46]) && (@2_ke = @2_kd[@2_k_46])) then @2_m[@2_k_46] else new @2_r2: G; @2_r2, ! !_44 <= @2_N2 (@2_m_83: G, @2_kd_82: passwd) -> let @2_m: G = @2_m_83 in let @2_kd: passwd = @2_kd_82 in find [unique] @2_j_47 <= @2_N suchthat defined(@2_x[@2_j_47], @2_ke[@2_j_47], @2_r2[@2_j_47]) && otheruses(@2_r2[@2_j_47]) && ((@2_m = @2_r2[@2_j_47]) && (@2_kd = @2_ke[@2_j_47])) then @2_x[@2_j_47] orfind @2_k_48 <= @2_N2 suchthat defined(@2_r4[@2_k_48], @2_m[@2_k_48], @2_kd[@2_k_48]) && otheruses(@2_r4[@2_k_48]) && ((@2_m = @2_m[@2_k_48]) && (@2_kd = @2_kd[@2_k_48])) then @2_r4[@2_k_48] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  () -> exp(g, @1_a),
  ! !_12 <= @1_na' (@1_m_17: G) -> exp(@1_m_17, @1_a),
  ! !_13 <= @1_naCDH (@1_m_18: G, @1_j_19 <= @1_nb) -> (@1_m_18 = exp(g, mult(@1_b[@1_j_19], @1_a)))), ! !_14 <= @1_nb new @1_b: exponent; (
  () -> exp(g, @1_b),
  ! !_15 <= @1_nb' (@1_m_20: G) -> exp(@1_m_20, @1_b),
  ! !_16 <= @1_nbCDH (@1_m_21: G, @1_j_22 <= @1_na) -> (@1_m_21 = exp(g, mult(@1_a[@1_j_22], @1_b))))
<=(set(proba <= pCDH(time, @1_na, @1_nb, @1_naCDH, @1_nbCDH)))=>
      ! !_23 <= @1_na new @1_a: exponent; (
  () -> @1_exp'(g, @1_a),
  ! !_24 <= @1_na' (@1_m_29: G) -> let @1_ka: bitstring = @1_mark in @1_exp'(@1_m_29, @1_a),
  ! !_25 <= @1_naCDH (@1_m_30: G, @1_j_31 <= @1_nb) -> find @1_v_33 <= @1_nb', @1_u_34 <= @1_nb suchthat defined(@1_kb[@1_v_33, @1_u_34], @1_b[@1_u_34]) && (@1_b[@1_j_31] = @1_b[@1_u_34]) then (@1_m_30 = @1_exp'(g, mult(@1_b[@1_j_31], @1_a))) else find @1_v_32 <= @1_na' suchthat defined(@1_ka[@1_v_32]) then (@1_m_30 = @1_exp'(g, mult(@1_b[@1_j_31], @1_a))) else false), ! !_26 <= @1_nb new @1_b: exponent; (
  () -> @1_exp'(g, @1_b),
  ! !_27 <= @1_nb' (@1_m_35: G) -> let @1_kb: bitstring = @1_mark in @1_exp'(@1_m_35, @1_b),
  ! !_28 <= @1_nbCDH (@1_m_36: G, @1_j_37 <= @1_na) -> find @1_v_39 <= @1_na', @1_u_40 <= @1_na suchthat defined(@1_ka[@1_v_39, @1_u_40], @1_a[@1_u_40]) && (@1_a[@1_j_37] = @1_a[@1_u_40]) then (@1_m_36 = @1_exp'(g, mult(@1_a[@1_j_37], @1_b))) else find @1_v_38 <= @1_nb' suchthat defined(@1_kb[@1_v_38]) then (@1_m_36 = @1_exp'(g, mult(@1_a[@1_j_37], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; () -> @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; () -> @1_X
... Succeeded.
Doing simplify... Run simplify 2 time(s). Maximum reached.
Done.
Doing move all binders... No change.
Doing remove assignments of useless... Done.
Trying equivalence
equiv ! !_51 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_52 <= N (x1_74: host, x2_73: host, x3_72: G, x4_71: G, x5_70: G) -> let x1: host = x1_74 in let x2: host = x2_73 in let x3: G = x3_72 in let x4: G = x4_71 in let x5: G = x5_70 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash1; r
... Failed.
Trying equivalence
equiv ! !_49 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_50 <= N (x1_79: host, x2_78: host, x3_77: G, x4_76: G, x5_75: G) -> let x1: host = x1_79 in let x2: host = x2_78 in let x3: G = x3_77 in let x4: G = x4_76 in let x5: G = x5_75 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash0; r
... Failed.
Trying equivalence
equiv ! !_41 <= @2_N (@2_x: G, @2_ke: passwd) -> enc(@2_x, @2_ke) [all], ! !_42 <= @2_N2 (@2_m: G, @2_kd: passwd) -> dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_43 <= @2_N (@2_x_81: G, @2_ke_80: passwd) -> let @2_x: G = @2_x_81 in let @2_ke: passwd = @2_ke_80 in find [unique] @2_j_45 <= @2_N suchthat defined(@2_x[@2_j_45], @2_ke[@2_j_45], @2_r2[@2_j_45]) && otheruses(@2_r2[@2_j_45]) && ((@2_x = @2_x[@2_j_45]) && (@2_ke = @2_ke[@2_j_45])) then @2_r2[@2_j_45] orfind @2_k_46 <= @2_N2 suchthat defined(@2_r4[@2_k_46], @2_m[@2_k_46], @2_kd[@2_k_46]) && otheruses(@2_r4[@2_k_46]) && ((@2_x = @2_r4[@2_k_46]) && (@2_ke = @2_kd[@2_k_46])) then @2_m[@2_k_46] else new @2_r2: G; @2_r2, ! !_44 <= @2_N2 (@2_m_83: G, @2_kd_82: passwd) -> let @2_m: G = @2_m_83 in let @2_kd: passwd = @2_kd_82 in find [unique] @2_j_47 <= @2_N suchthat defined(@2_x[@2_j_47], @2_ke[@2_j_47], @2_r2[@2_j_47]) && otheruses(@2_r2[@2_j_47]) && ((@2_m = @2_r2[@2_j_47]) && (@2_kd = @2_ke[@2_j_47])) then @2_x[@2_j_47] orfind @2_k_48 <= @2_N2 suchthat defined(@2_r4[@2_k_48], @2_m[@2_k_48], @2_kd[@2_k_48]) && otheruses(@2_r4[@2_k_48]) && ((@2_m = @2_m[@2_k_48]) && (@2_kd = @2_kd[@2_k_48])) then @2_r4[@2_k_48] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  () -> exp(g, @1_a),
  ! !_12 <= @1_na' (@1_m_17: G) -> exp(@1_m_17, @1_a),
  ! !_13 <= @1_naCDH (@1_m_18: G, @1_j_19 <= @1_nb) -> (@1_m_18 = exp(g, mult(@1_b[@1_j_19], @1_a)))), ! !_14 <= @1_nb new @1_b: exponent; (
  () -> exp(g, @1_b),
  ! !_15 <= @1_nb' (@1_m_20: G) -> exp(@1_m_20, @1_b),
  ! !_16 <= @1_nbCDH (@1_m_21: G, @1_j_22 <= @1_na) -> (@1_m_21 = exp(g, mult(@1_a[@1_j_22], @1_b))))
<=(set(proba <= pCDH(time, @1_na, @1_nb, @1_naCDH, @1_nbCDH)))=>
      ! !_23 <= @1_na new @1_a: exponent; (
  () -> @1_exp'(g, @1_a),
  ! !_24 <= @1_na' (@1_m_29: G) -> let @1_ka: bitstring = @1_mark in @1_exp'(@1_m_29, @1_a),
  ! !_25 <= @1_naCDH (@1_m_30: G, @1_j_31 <= @1_nb) -> find @1_v_33 <= @1_nb', @1_u_34 <= @1_nb suchthat defined(@1_kb[@1_v_33, @1_u_34], @1_b[@1_u_34]) && (@1_b[@1_j_31] = @1_b[@1_u_34]) then (@1_m_30 = @1_exp'(g, mult(@1_b[@1_j_31], @1_a))) else find @1_v_32 <= @1_na' suchthat defined(@1_ka[@1_v_32]) then (@1_m_30 = @1_exp'(g, mult(@1_b[@1_j_31], @1_a))) else false), ! !_26 <= @1_nb new @1_b: exponent; (
  () -> @1_exp'(g, @1_b),
  ! !_27 <= @1_nb' (@1_m_35: G) -> let @1_kb: bitstring = @1_mark in @1_exp'(@1_m_35, @1_b),
  ! !_28 <= @1_nbCDH (@1_m_36: G, @1_j_37 <= @1_na) -> find @1_v_39 <= @1_na', @1_u_40 <= @1_na suchthat defined(@1_ka[@1_v_39, @1_u_40], @1_a[@1_u_40]) && (@1_a[@1_j_37] = @1_a[@1_u_40]) then (@1_m_36 = @1_exp'(g, mult(@1_a[@1_j_37], @1_b))) else find @1_v_38 <= @1_nb' suchthat defined(@1_kb[@1_v_38]) then (@1_m_36 = @1_exp'(g, mult(@1_a[@1_j_37], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; () -> @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; () -> @1_X
... Succeeded.
Doing simplify... Run simplify 2 time(s). Maximum reached.
Done.
Doing move all binders... No change.
Doing remove assignments of useless... Done.
Trying equivalence
equiv ! !_51 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_52 <= N (x1_74: host, x2_73: host, x3_72: G, x4_71: G, x5_70: G) -> let x1: host = x1_74 in let x2: host = x2_73 in let x3: G = x3_72 in let x4: G = x4_71 in let x5: G = x5_70 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash1; r
... Failed.
Trying equivalence
equiv ! !_49 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_50 <= N (x1_79: host, x2_78: host, x3_77: G, x4_76: G, x5_75: G) -> let x1: host = x1_79 in let x2: host = x2_78 in let x3: G = x3_77 in let x4: G = x4_76 in let x5: G = x5_75 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash0; r
... Failed.
Trying equivalence
equiv ! !_41 <= @2_N (@2_x: G, @2_ke: passwd) -> enc(@2_x, @2_ke) [all], ! !_42 <= @2_N2 (@2_m: G, @2_kd: passwd) -> dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_43 <= @2_N (@2_x_81: G, @2_ke_80: passwd) -> let @2_x: G = @2_x_81 in let @2_ke: passwd = @2_ke_80 in find [unique] @2_j_45 <= @2_N suchthat defined(@2_x[@2_j_45], @2_ke[@2_j_45], @2_r2[@2_j_45]) && otheruses(@2_r2[@2_j_45]) && ((@2_x = @2_x[@2_j_45]) && (@2_ke = @2_ke[@2_j_45])) then @2_r2[@2_j_45] orfind @2_k_46 <= @2_N2 suchthat defined(@2_r4[@2_k_46], @2_m[@2_k_46], @2_kd[@2_k_46]) && otheruses(@2_r4[@2_k_46]) && ((@2_x = @2_r4[@2_k_46]) && (@2_ke = @2_kd[@2_k_46])) then @2_m[@2_k_46] else new @2_r2: G; @2_r2, ! !_44 <= @2_N2 (@2_m_83: G, @2_kd_82: passwd) -> let @2_m: G = @2_m_83 in let @2_kd: passwd = @2_kd_82 in find [unique] @2_j_47 <= @2_N suchthat defined(@2_x[@2_j_47], @2_ke[@2_j_47], @2_r2[@2_j_47]) && otheruses(@2_r2[@2_j_47]) && ((@2_m = @2_r2[@2_j_47]) && (@2_kd = @2_ke[@2_j_47])) then @2_x[@2_j_47] orfind @2_k_48 <= @2_N2 suchthat defined(@2_r4[@2_k_48], @2_m[@2_k_48], @2_kd[@2_k_48]) && otheruses(@2_r4[@2_k_48]) && ((@2_m = @2_m[@2_k_48]) && (@2_kd = @2_kd[@2_k_48])) then @2_r4[@2_k_48] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  () -> exp(g, @1_a),
  ! !_12 <= @1_na' (@1_m_17: G) -> exp(@1_m_17, @1_a),
  ! !_13 <= @1_naCDH (@1_m_18: G, @1_j_19 <= @1_nb) -> (@1_m_18 = exp(g, mult(@1_b[@1_j_19], @1_a)))), ! !_14 <= @1_nb new @1_b: exponent; (
  () -> exp(g, @1_b),
  ! !_15 <= @1_nb' (@1_m_20: G) -> exp(@1_m_20, @1_b),
  ! !_16 <= @1_nbCDH (@1_m_21: G, @1_j_22 <= @1_na) -> (@1_m_21 = exp(g, mult(@1_a[@1_j_22], @1_b))))
<=(set(proba <= pCDH(time, @1_na, @1_nb, @1_naCDH, @1_nbCDH)))=>
      ! !_23 <= @1_na new @1_a: exponent; (
  () -> @1_exp'(g, @1_a),
  ! !_24 <= @1_na' (@1_m_29: G) -> let @1_ka: bitstring = @1_mark in @1_exp'(@1_m_29, @1_a),
  ! !_25 <= @1_naCDH (@1_m_30: G, @1_j_31 <= @1_nb) -> find @1_v_33 <= @1_nb', @1_u_34 <= @1_nb suchthat defined(@1_kb[@1_v_33, @1_u_34], @1_b[@1_u_34]) && (@1_b[@1_j_31] = @1_b[@1_u_34]) then (@1_m_30 = @1_exp'(g, mult(@1_b[@1_j_31], @1_a))) else find @1_v_32 <= @1_na' suchthat defined(@1_ka[@1_v_32]) then (@1_m_30 = @1_exp'(g, mult(@1_b[@1_j_31], @1_a))) else false), ! !_26 <= @1_nb new @1_b: exponent; (
  () -> @1_exp'(g, @1_b),
  ! !_27 <= @1_nb' (@1_m_35: G) -> let @1_kb: bitstring = @1_mark in @1_exp'(@1_m_35, @1_b),
  ! !_28 <= @1_nbCDH (@1_m_36: G, @1_j_37 <= @1_na) -> find @1_v_39 <= @1_na', @1_u_40 <= @1_na suchthat defined(@1_ka[@1_v_39, @1_u_40], @1_a[@1_u_40]) && (@1_a[@1_j_37] = @1_a[@1_u_40]) then (@1_m_36 = @1_exp'(g, mult(@1_a[@1_j_37], @1_b))) else find @1_v_38 <= @1_nb' suchthat defined(@1_kb[@1_v_38]) then (@1_m_36 = @1_exp'(g, mult(@1_a[@1_j_37], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; () -> @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; () -> @1_X
... Succeeded.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
No change.
Doing move all binders... No change.
Doing remove assignments of useless... Done.
Trying equivalence
equiv ! !_51 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_52 <= N (x1_74: host, x2_73: host, x3_72: G, x4_71: G, x5_70: G) -> let x1: host = x1_74 in let x2: host = x2_73 in let x3: G = x3_72 in let x4: G = x4_71 in let x5: G = x5_70 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash1; r
... Failed.
Trying equivalence
equiv ! !_49 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_50 <= N (x1_79: host, x2_78: host, x3_77: G, x4_76: G, x5_75: G) -> let x1: host = x1_79 in let x2: host = x2_78 in let x3: G = x3_77 in let x4: G = x4_76 in let x5: G = x5_75 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash0; r
... Failed.
Trying equivalence
equiv ! !_41 <= @2_N (@2_x: G, @2_ke: passwd) -> enc(@2_x, @2_ke) [all], ! !_42 <= @2_N2 (@2_m: G, @2_kd: passwd) -> dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_43 <= @2_N (@2_x_81: G, @2_ke_80: passwd) -> let @2_x: G = @2_x_81 in let @2_ke: passwd = @2_ke_80 in find [unique] @2_j_45 <= @2_N suchthat defined(@2_x[@2_j_45], @2_ke[@2_j_45], @2_r2[@2_j_45]) && otheruses(@2_r2[@2_j_45]) && ((@2_x = @2_x[@2_j_45]) && (@2_ke = @2_ke[@2_j_45])) then @2_r2[@2_j_45] orfind @2_k_46 <= @2_N2 suchthat defined(@2_r4[@2_k_46], @2_m[@2_k_46], @2_kd[@2_k_46]) && otheruses(@2_r4[@2_k_46]) && ((@2_x = @2_r4[@2_k_46]) && (@2_ke = @2_kd[@2_k_46])) then @2_m[@2_k_46] else new @2_r2: G; @2_r2, ! !_44 <= @2_N2 (@2_m_83: G, @2_kd_82: passwd) -> let @2_m: G = @2_m_83 in let @2_kd: passwd = @2_kd_82 in find [unique] @2_j_47 <= @2_N suchthat defined(@2_x[@2_j_47], @2_ke[@2_j_47], @2_r2[@2_j_47]) && otheruses(@2_r2[@2_j_47]) && ((@2_m = @2_r2[@2_j_47]) && (@2_kd = @2_ke[@2_j_47])) then @2_x[@2_j_47] orfind @2_k_48 <= @2_N2 suchthat defined(@2_r4[@2_k_48], @2_m[@2_k_48], @2_kd[@2_k_48]) && otheruses(@2_r4[@2_k_48]) && ((@2_m = @2_m[@2_k_48]) && (@2_kd = @2_kd[@2_k_48])) then @2_r4[@2_k_48] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  () -> exp(g, @1_a),
  ! !_12 <= @1_na' (@1_m_17: G) -> exp(@1_m_17, @1_a),
  ! !_13 <= @1_naCDH (@1_m_18: G, @1_j_19 <= @1_nb) -> (@1_m_18 = exp(g, mult(@1_b[@1_j_19], @1_a)))), ! !_14 <= @1_nb new @1_b: exponent; (
  () -> exp(g, @1_b),
  ! !_15 <= @1_nb' (@1_m_20: G) -> exp(@1_m_20, @1_b),
  ! !_16 <= @1_nbCDH (@1_m_21: G, @1_j_22 <= @1_na) -> (@1_m_21 = exp(g, mult(@1_a[@1_j_22], @1_b))))
<=(set(proba <= pCDH(time, @1_na, @1_nb, @1_naCDH, @1_nbCDH)))=>
      ! !_23 <= @1_na new @1_a: exponent; (
  () -> @1_exp'(g, @1_a),
  ! !_24 <= @1_na' (@1_m_29: G) -> let @1_ka: bitstring = @1_mark in @1_exp'(@1_m_29, @1_a),
  ! !_25 <= @1_naCDH (@1_m_30: G, @1_j_31 <= @1_nb) -> find @1_v_33 <= @1_nb', @1_u_34 <= @1_nb suchthat defined(@1_kb[@1_v_33, @1_u_34], @1_b[@1_u_34]) && (@1_b[@1_j_31] = @1_b[@1_u_34]) then (@1_m_30 = @1_exp'(g, mult(@1_b[@1_j_31], @1_a))) else find @1_v_32 <= @1_na' suchthat defined(@1_ka[@1_v_32]) then (@1_m_30 = @1_exp'(g, mult(@1_b[@1_j_31], @1_a))) else false), ! !_26 <= @1_nb new @1_b: exponent; (
  () -> @1_exp'(g, @1_b),
  ! !_27 <= @1_nb' (@1_m_35: G) -> let @1_kb: bitstring = @1_mark in @1_exp'(@1_m_35, @1_b),
  ! !_28 <= @1_nbCDH (@1_m_36: G, @1_j_37 <= @1_na) -> find @1_v_39 <= @1_na', @1_u_40 <= @1_na suchthat defined(@1_ka[@1_v_39, @1_u_40], @1_a[@1_u_40]) && (@1_a[@1_j_37] = @1_a[@1_u_40]) then (@1_m_36 = @1_exp'(g, mult(@1_a[@1_j_37], @1_b))) else find @1_v_38 <= @1_nb' suchthat defined(@1_kb[@1_v_38]) then (@1_m_36 = @1_exp'(g, mult(@1_a[@1_j_37], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; () -> @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; () -> @1_X
... Succeeded.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
No change.
Doing move all binders... No change.
Doing remove assignments of useless... Done.
Trying equivalence
equiv ! !_51 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_52 <= N (x1_74: host, x2_73: host, x3_72: G, x4_71: G, x5_70: G) -> let x1: host = x1_74 in let x2: host = x2_73 in let x3: G = x3_72 in let x4: G = x4_71 in let x5: G = x5_70 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash1; r
... Failed.
Trying equivalence
equiv ! !_49 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_50 <= N (x1_79: host, x2_78: host, x3_77: G, x4_76: G, x5_75: G) -> let x1: host = x1_79 in let x2: host = x2_78 in let x3: G = x3_77 in let x4: G = x4_76 in let x5: G = x5_75 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash0; r
... Failed.
Trying equivalence
equiv ! !_41 <= @2_N (@2_x: G, @2_ke: passwd) -> enc(@2_x, @2_ke) [all], ! !_42 <= @2_N2 (@2_m: G, @2_kd: passwd) -> dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_43 <= @2_N (@2_x_81: G, @2_ke_80: passwd) -> let @2_x: G = @2_x_81 in let @2_ke: passwd = @2_ke_80 in find [unique] @2_j_45 <= @2_N suchthat defined(@2_x[@2_j_45], @2_ke[@2_j_45], @2_r2[@2_j_45]) && otheruses(@2_r2[@2_j_45]) && ((@2_x = @2_x[@2_j_45]) && (@2_ke = @2_ke[@2_j_45])) then @2_r2[@2_j_45] orfind @2_k_46 <= @2_N2 suchthat defined(@2_r4[@2_k_46], @2_m[@2_k_46], @2_kd[@2_k_46]) && otheruses(@2_r4[@2_k_46]) && ((@2_x = @2_r4[@2_k_46]) && (@2_ke = @2_kd[@2_k_46])) then @2_m[@2_k_46] else new @2_r2: G; @2_r2, ! !_44 <= @2_N2 (@2_m_83: G, @2_kd_82: passwd) -> let @2_m: G = @2_m_83 in let @2_kd: passwd = @2_kd_82 in find [unique] @2_j_47 <= @2_N suchthat defined(@2_x[@2_j_47], @2_ke[@2_j_47], @2_r2[@2_j_47]) && otheruses(@2_r2[@2_j_47]) && ((@2_m = @2_r2[@2_j_47]) && (@2_kd = @2_ke[@2_j_47])) then @2_x[@2_j_47] orfind @2_k_48 <= @2_N2 suchthat defined(@2_r4[@2_k_48], @2_m[@2_k_48], @2_kd[@2_k_48]) && otheruses(@2_r4[@2_k_48]) && ((@2_m = @2_m[@2_k_48]) && (@2_kd = @2_kd[@2_k_48])) then @2_r4[@2_k_48] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  () -> exp(g, @1_a),
  ! !_12 <= @1_na' (@1_m_17: G) -> exp(@1_m_17, @1_a),
  ! !_13 <= @1_naCDH (@1_m_18: G, @1_j_19 <= @1_nb) -> (@1_m_18 = exp(g, mult(@1_b[@1_j_19], @1_a)))), ! !_14 <= @1_nb new @1_b: exponent; (
  () -> exp(g, @1_b),
  ! !_15 <= @1_nb' (@1_m_20: G) -> exp(@1_m_20, @1_b),
  ! !_16 <= @1_nbCDH (@1_m_21: G, @1_j_22 <= @1_na) -> (@1_m_21 = exp(g, mult(@1_a[@1_j_22], @1_b))))
<=(set(proba <= pCDH(time, @1_na, @1_nb, @1_naCDH, @1_nbCDH)))=>
      ! !_23 <= @1_na new @1_a: exponent; (
  () -> @1_exp'(g, @1_a),
  ! !_24 <= @1_na' (@1_m_29: G) -> let @1_ka: bitstring = @1_mark in @1_exp'(@1_m_29, @1_a),
  ! !_25 <= @1_naCDH (@1_m_30: G, @1_j_31 <= @1_nb) -> find @1_v_33 <= @1_nb', @1_u_34 <= @1_nb suchthat defined(@1_kb[@1_v_33, @1_u_34], @1_b[@1_u_34]) && (@1_b[@1_j_31] = @1_b[@1_u_34]) then (@1_m_30 = @1_exp'(g, mult(@1_b[@1_j_31], @1_a))) else find @1_v_32 <= @1_na' suchthat defined(@1_ka[@1_v_32]) then (@1_m_30 = @1_exp'(g, mult(@1_b[@1_j_31], @1_a))) else false), ! !_26 <= @1_nb new @1_b: exponent; (
  () -> @1_exp'(g, @1_b),
  ! !_27 <= @1_nb' (@1_m_35: G) -> let @1_kb: bitstring = @1_mark in @1_exp'(@1_m_35, @1_b),
  ! !_28 <= @1_nbCDH (@1_m_36: G, @1_j_37 <= @1_na) -> find @1_v_39 <= @1_na', @1_u_40 <= @1_na suchthat defined(@1_ka[@1_v_39, @1_u_40], @1_a[@1_u_40]) && (@1_a[@1_j_37] = @1_a[@1_u_40]) then (@1_m_36 = @1_exp'(g, mult(@1_a[@1_j_37], @1_b))) else find @1_v_38 <= @1_nb' suchthat defined(@1_kb[@1_v_38]) then (@1_m_36 = @1_exp'(g, mult(@1_a[@1_j_37], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; () -> @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; () -> @1_X
... Succeeded.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
No change.
Doing move all binders... No change.
Doing remove assignments of useless... Done.
Trying equivalence
equiv ! !_51 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_52 <= N (x1_74: host, x2_73: host, x3_72: G, x4_71: G, x5_70: G) -> let x1: host = x1_74 in let x2: host = x2_73 in let x3: G = x3_72 in let x4: G = x4_71 in let x5: G = x5_70 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash1; r
... Failed.
Trying equivalence
equiv ! !_49 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_50 <= N (x1_79: host, x2_78: host, x3_77: G, x4_76: G, x5_75: G) -> let x1: host = x1_79 in let x2: host = x2_78 in let x3: G = x3_77 in let x4: G = x4_76 in let x5: G = x5_75 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash0; r
... Failed.
Trying equivalence
equiv ! !_41 <= @2_N (@2_x: G, @2_ke: passwd) -> enc(@2_x, @2_ke) [all], ! !_42 <= @2_N2 (@2_m: G, @2_kd: passwd) -> dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_43 <= @2_N (@2_x_81: G, @2_ke_80: passwd) -> let @2_x: G = @2_x_81 in let @2_ke: passwd = @2_ke_80 in find [unique] @2_j_45 <= @2_N suchthat defined(@2_x[@2_j_45], @2_ke[@2_j_45], @2_r2[@2_j_45]) && otheruses(@2_r2[@2_j_45]) && ((@2_x = @2_x[@2_j_45]) && (@2_ke = @2_ke[@2_j_45])) then @2_r2[@2_j_45] orfind @2_k_46 <= @2_N2 suchthat defined(@2_r4[@2_k_46], @2_m[@2_k_46], @2_kd[@2_k_46]) && otheruses(@2_r4[@2_k_46]) && ((@2_x = @2_r4[@2_k_46]) && (@2_ke = @2_kd[@2_k_46])) then @2_m[@2_k_46] else new @2_r2: G; @2_r2, ! !_44 <= @2_N2 (@2_m_83: G, @2_kd_82: passwd) -> let @2_m: G = @2_m_83 in let @2_kd: passwd = @2_kd_82 in find [unique] @2_j_47 <= @2_N suchthat defined(@2_x[@2_j_47], @2_ke[@2_j_47], @2_r2[@2_j_47]) && otheruses(@2_r2[@2_j_47]) && ((@2_m = @2_r2[@2_j_47]) && (@2_kd = @2_ke[@2_j_47])) then @2_x[@2_j_47] orfind @2_k_48 <= @2_N2 suchthat defined(@2_r4[@2_k_48], @2_m[@2_k_48], @2_kd[@2_k_48]) && otheruses(@2_r4[@2_k_48]) && ((@2_m = @2_m[@2_k_48]) && (@2_kd = @2_kd[@2_k_48])) then @2_r4[@2_k_48] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  () -> exp(g, @1_a),
  ! !_12 <= @1_na' (@1_m_17: G) -> exp(@1_m_17, @1_a),
  ! !_13 <= @1_naCDH (@1_m_18: G, @1_j_19 <= @1_nb) -> (@1_m_18 = exp(g, mult(@1_b[@1_j_19], @1_a)))), ! !_14 <= @1_nb new @1_b: exponent; (
  () -> exp(g, @1_b),
  ! !_15 <= @1_nb' (@1_m_20: G) -> exp(@1_m_20, @1_b),
  ! !_16 <= @1_nbCDH (@1_m_21: G, @1_j_22 <= @1_na) -> (@1_m_21 = exp(g, mult(@1_a[@1_j_22], @1_b))))
<=(set(proba <= pCDH(time, @1_na, @1_nb, @1_naCDH, @1_nbCDH)))=>
      ! !_23 <= @1_na new @1_a: exponent; (
  () -> @1_exp'(g, @1_a),
  ! !_24 <= @1_na' (@1_m_29: G) -> let @1_ka: bitstring = @1_mark in @1_exp'(@1_m_29, @1_a),
  ! !_25 <= @1_naCDH (@1_m_30: G, @1_j_31 <= @1_nb) -> find @1_v_33 <= @1_nb', @1_u_34 <= @1_nb suchthat defined(@1_kb[@1_v_33, @1_u_34], @1_b[@1_u_34]) && (@1_b[@1_j_31] = @1_b[@1_u_34]) then (@1_m_30 = @1_exp'(g, mult(@1_b[@1_j_31], @1_a))) else find @1_v_32 <= @1_na' suchthat defined(@1_ka[@1_v_32]) then (@1_m_30 = @1_exp'(g, mult(@1_b[@1_j_31], @1_a))) else false), ! !_26 <= @1_nb new @1_b: exponent; (
  () -> @1_exp'(g, @1_b),
  ! !_27 <= @1_nb' (@1_m_35: G) -> let @1_kb: bitstring = @1_mark in @1_exp'(@1_m_35, @1_b),
  ! !_28 <= @1_nbCDH (@1_m_36: G, @1_j_37 <= @1_na) -> find @1_v_39 <= @1_na', @1_u_40 <= @1_na suchthat defined(@1_ka[@1_v_39, @1_u_40], @1_a[@1_u_40]) && (@1_a[@1_j_37] = @1_a[@1_u_40]) then (@1_m_36 = @1_exp'(g, mult(@1_a[@1_j_37], @1_b))) else find @1_v_38 <= @1_nb' suchthat defined(@1_kb[@1_v_38]) then (@1_m_36 = @1_exp'(g, mult(@1_a[@1_j_37], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; () -> @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; () -> @1_X
... Failed.
Trying equivalence
equiv ! !_7 <= @1_N new @1_x: exponent; () -> exp(g, @1_x)
<=(0)=>
      ! !_8 <= @1_N new @1_X: G; () -> @1_X
... Failed.
Trying equivalence
equiv ! !_1 <= @1_N new @1_X: G; (
  () -> @1_X,
  ! !_2 <= @1_N' (@1_m: exponent) -> exp(@1_X, @1_m))
<=(0)=>
      ! !_3 <= @1_N new @1_x: exponent; (
  () -> exp(g, @1_x),
  ! !_4 <= @1_N' (@1_m: exponent) -> exp(g, mult(@1_x, @1_m)))
... Failed.
===================== Proof starts =======================
Initial state
Game 1 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let auth_u: hash1 = h1(U, S, X, Y_u, K_u) in
  out(c6[!_53], auth_u);
  in(c9[!_53], ());
  let sk_u: hash0 = h0(U, S, X, Y_u, K_u)
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_54], (S, Ystar));
  in(c7[!_54], auth_s: hash1);
  let K_s: G = exp(X_s, y) in
  if (auth_s = h1(U, S, X_s, Y, K_s)) then
  let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let authp: hash1 = h1(U, S, Xp, Yp, Kp) in
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_55], (U, Xp, S, Ystarp, authp))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_56], enc(@2_x, @2_ke))
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_57], dec(@2_m, @2_kd))
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  out(c20[!_58], h0(x1_69, x2_68, x3_67, x4_66, x5_65))
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  out(c21[!_59], h1(x1_64, x2_63, x3_62, x4_61, x5_60))
)


Applying insert instruction find j <= NU suchthat defined(X[j]) && X[j] = X_s then at occurrence 158 yields

Game 2 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let auth_u: hash1 = h1(U, S, X, Y_u, K_u) in
  out(c6[!_53], auth_u);
  in(c9[!_53], ());
  let sk_u: hash0 = h0(U, S, X, Y_u, K_u)
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_54], (S, Ystar));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(X_s, y) in
    if (auth_s = h1(U, S, X_s, Y, K_s)) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
  )
  else
  (
    let K_s: G = exp(X_s, y) in
    if (auth_s = h1(U, S, X_s, Y, K_s)) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let authp: hash1 = h1(U, S, Xp, Yp, Kp) in
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_55], (U, Xp, S, Ystarp, authp))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_56], enc(@2_x, @2_ke))
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_57], dec(@2_m, @2_kd))
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  out(c20[!_58], h0(x1_69, x2_68, x3_67, x4_66, x5_65))
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  out(c21[!_59], h1(x1_64, x2_63, x3_62, x4_61, x5_60))
)


Applying insert instruction find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && (U = x1_64[nj]) && (S = x2_63[nj]) && (X_s = x3_62[nj]) && (Y = x4_61[nj]) then at occurrence 158 yields

Game 3 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let auth_u: hash1 = h1(U, S, X, Y_u, K_u) in
  out(c6[!_53], auth_u);
  in(c9[!_53], ());
  let sk_u: hash0 = h0(U, S, X, Y_u, K_u)
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_54], (S, Ystar));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(X_s, y) in
    if (auth_s = h1(U, S, X_s, Y, K_s)) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    (
      let K_s: G = exp(X_s, y) in
      if (auth_s = h1(U, S, X_s, Y, K_s)) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
    )
    else
    (
      let K_s: G = exp(X_s, y) in
      if (auth_s = h1(U, S, X_s, Y, K_s)) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
    )
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let authp: hash1 = h1(U, S, Xp, Yp, Kp) in
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_55], (U, Xp, S, Ystarp, authp))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_56], enc(@2_x, @2_ke))
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_57], dec(@2_m, @2_kd))
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  out(c20[!_58], h0(x1_69, x2_68, x3_67, x4_66, x5_65))
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  out(c21[!_59], h1(x1_64, x2_63, x3_62, x4_61, x5_60))
)


Applying insert event Auth at occurrence 191 [Excluding set(event Auth in game 4)] yields

Game 4 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let auth_u: hash1 = h1(U, S, X, Y_u, K_u) in
  out(c6[!_53], auth_u);
  in(c9[!_53], ());
  let sk_u: hash0 = h0(U, S, X, Y_u, K_u)
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_54], (S, Ystar));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(X_s, y) in
    if (auth_s = h1(U, S, X_s, Y, K_s)) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    (
      event Auth
    )
    else
    (
      let K_s: G = exp(X_s, y) in
      if (auth_s = h1(U, S, X_s, Y, K_s)) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
    )
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let authp: hash1 = h1(U, S, Xp, Yp, Kp) in
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_55], (U, Xp, S, Ystarp, authp))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_56], enc(@2_x, @2_ke))
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_57], dec(@2_m, @2_kd))
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  out(c20[!_58], h0(x1_69, x2_68, x3_67, x4_66, x5_65))
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  out(c21[!_59], h1(x1_64, x2_63, x3_62, x4_61, x5_60))
)


Applying equivalence
equiv ! !_41 <= @2_N (@2_x: G, @2_ke: passwd) -> enc(@2_x, @2_ke) [all], ! !_42 <= @2_N2 (@2_m: G, @2_kd: passwd) -> dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_43 <= @2_N (@2_x_81: G, @2_ke_80: passwd) -> let @2_x: G = @2_x_81 in let @2_ke: passwd = @2_ke_80 in find [unique] @2_j_45 <= @2_N suchthat defined(@2_x[@2_j_45], @2_ke[@2_j_45], @2_r2[@2_j_45]) && otheruses(@2_r2[@2_j_45]) && ((@2_x = @2_x[@2_j_45]) && (@2_ke = @2_ke[@2_j_45])) then @2_r2[@2_j_45] orfind @2_k_46 <= @2_N2 suchthat defined(@2_r4[@2_k_46], @2_m[@2_k_46], @2_kd[@2_k_46]) && otheruses(@2_r4[@2_k_46]) && ((@2_x = @2_r4[@2_k_46]) && (@2_ke = @2_kd[@2_k_46])) then @2_m[@2_k_46] else new @2_r2: G; @2_r2, ! !_44 <= @2_N2 (@2_m_83: G, @2_kd_82: passwd) -> let @2_m: G = @2_m_83 in let @2_kd: passwd = @2_kd_82 in find [unique] @2_j_47 <= @2_N suchthat defined(@2_x[@2_j_47], @2_ke[@2_j_47], @2_r2[@2_j_47]) && otheruses(@2_r2[@2_j_47]) && ((@2_m = @2_r2[@2_j_47]) && (@2_kd = @2_ke[@2_j_47])) then @2_x[@2_j_47] orfind @2_k_48 <= @2_N2 suchthat defined(@2_r4[@2_k_48], @2_m[@2_k_48], @2_kd[@2_k_48]) && otheruses(@2_r4[@2_k_48]) && ((@2_m = @2_m[@2_k_48]) && (@2_kd = @2_kd[@2_k_48])) then @2_r4[@2_k_48] else new @2_r4: G; @2_r4
 [Excluding set(dist 4->5, proba <= (NS * NS + 2. * NP * NS + 2. * qE * NS + 2. * NU * NS + 2. * qD * NS + NP * NP + 2. * qE * NP + 2. * NU * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 2. * qD * qE + NU * NU + 2. * qD * NU + qD * qD + -1. * NS + -1. * NP + -1. * qE + -1. * NU + -1. * qD) / |G|)] yields

Game 5 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  let @2_m_98: G = Ystar_u in
  let @2_kd_97: passwd = pw in
  find [unique] @i_148 <= qD suchthat defined(@2_r4_84[@i_148], @2_m_86[@i_148], @2_kd_85[@i_148]) && otheruses(@2_r4_84[@i_148]) && ((@2_m_98 = @2_m_86[@i_148]) && (@2_kd_97 = @2_kd_85[@i_148])) then
  (
    let Y_u: G = @2_r4_84[@i_148] in
    let K_u: G = exp(Y_u, x) in
    let auth_u: hash1 = h1(U, S, X, Y_u, K_u) in
    out(c6[!_53], auth_u);
    in(c9[!_53], ());
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u)
  )
  orfind @i_144 <= NU suchthat defined(@2_r4_96[@i_144], @2_m_98[@i_144], @2_kd_97[@i_144]) && otheruses(@2_r4_96[@i_144]) && ((@2_m_98 = @2_m_98[@i_144]) && (@2_kd_97 = @2_kd_97[@i_144])) then
  (
    let Y_u: G = @2_r4_96[@i_144] in
    let K_u: G = exp(Y_u, x) in
    let auth_u: hash1 = h1(U, S, X, Y_u, K_u) in
    out(c6[!_53], auth_u);
    in(c9[!_53], ());
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u)
  )
  orfind @i_142 <= qE suchthat defined(@2_x_89[@i_142], @2_ke_88[@i_142], @2_r2_87[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((@2_m_98 = @2_r2_87[@i_142]) && (@2_kd_97 = @2_ke_88[@i_142])) then
  (
    let Y_u: G = @2_x_89[@i_142] in
    let K_u: G = exp(Y_u, x) in
    let auth_u: hash1 = h1(U, S, X, Y_u, K_u) in
    out(c6[!_53], auth_u);
    in(c9[!_53], ());
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u)
  )
  orfind @i_141 <= NP suchthat defined(@2_x_92[@i_141], @2_ke_91[@i_141], @2_r2_90[@i_141]) && otheruses(@2_r2_90[@i_141]) && ((@2_m_98 = @2_r2_90[@i_141]) && (@2_kd_97 = @2_ke_91[@i_141])) then
  (
    let Y_u: G = @2_x_92[@i_141] in
    let K_u: G = exp(Y_u, x) in
    let auth_u: hash1 = h1(U, S, X, Y_u, K_u) in
    out(c6[!_53], auth_u);
    in(c9[!_53], ());
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u)
  )
  orfind @i_140 <= NS suchthat defined(@2_x_95[@i_140], @2_ke_94[@i_140], @2_r2_93[@i_140]) && otheruses(@2_r2_93[@i_140]) && ((@2_m_98 = @2_r2_93[@i_140]) && (@2_kd_97 = @2_ke_94[@i_140])) then
  (
    let Y_u: G = @2_x_95[@i_140] in
    let K_u: G = exp(Y_u, x) in
    let auth_u: hash1 = h1(U, S, X, Y_u, K_u) in
    out(c6[!_53], auth_u);
    in(c9[!_53], ());
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u)
  )
  else
  (
    new @2_r4_96: G;
    let Y_u: G = @2_r4_96 in
    let K_u: G = exp(Y_u, x) in
    let auth_u: hash1 = h1(U, S, X, Y_u, K_u) in
    out(c6[!_53], auth_u);
    in(c9[!_53], ());
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u)
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let @2_x_95: G = Y in
  let @2_ke_94: passwd = pw in
  find [unique] @i_138 <= qD suchthat defined(@2_r4_84[@i_138], @2_m_86[@i_138], @2_kd_85[@i_138]) && otheruses(@2_r4_84[@i_138]) && ((@2_x_95 = @2_r4_84[@i_138]) && (@2_ke_94 = @2_kd_85[@i_138])) then
  (
    let Ystar: G = @2_m_86[@i_138] in
    out(c4[!_54], (S, Ystar));
    in(c7[!_54], auth_s: hash1);
    find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
    (
      let K_s: G = exp(X_s, y) in
      if (auth_s = h1(U, S, X_s, Y, K_s)) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
    )
    else
    (
      find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
      (
        event Auth
      )
      else
      (
        let K_s: G = exp(X_s, y) in
        if (auth_s = h1(U, S, X_s, Y, K_s)) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
      )
    )
  )
  orfind @i_134 <= NU suchthat defined(@2_r4_96[@i_134], @2_m_98[@i_134], @2_kd_97[@i_134]) && otheruses(@2_r4_96[@i_134]) && ((@2_x_95 = @2_r4_96[@i_134]) && (@2_ke_94 = @2_kd_97[@i_134])) then
  (
    let Ystar: G = @2_m_98[@i_134] in
    out(c4[!_54], (S, Ystar));
    in(c7[!_54], auth_s: hash1);
    find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
    (
      let K_s: G = exp(X_s, y) in
      if (auth_s = h1(U, S, X_s, Y, K_s)) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
    )
    else
    (
      find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
      (
        event Auth
      )
      else
      (
        let K_s: G = exp(X_s, y) in
        if (auth_s = h1(U, S, X_s, Y, K_s)) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
      )
    )
  )
  orfind @i_132 <= qE suchthat defined(@2_x_89[@i_132], @2_ke_88[@i_132], @2_r2_87[@i_132]) && otheruses(@2_r2_87[@i_132]) && ((@2_x_95 = @2_x_89[@i_132]) && (@2_ke_94 = @2_ke_88[@i_132])) then
  (
    let Ystar: G = @2_r2_87[@i_132] in
    out(c4[!_54], (S, Ystar));
    in(c7[!_54], auth_s: hash1);
    find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
    (
      let K_s: G = exp(X_s, y) in
      if (auth_s = h1(U, S, X_s, Y, K_s)) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
    )
    else
    (
      find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
      (
        event Auth
      )
      else
      (
        let K_s: G = exp(X_s, y) in
        if (auth_s = h1(U, S, X_s, Y, K_s)) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
      )
    )
  )
  orfind @i_131 <= NP suchthat defined(@2_x_92[@i_131], @2_ke_91[@i_131], @2_r2_90[@i_131]) && otheruses(@2_r2_90[@i_131]) && ((@2_x_95 = @2_x_92[@i_131]) && (@2_ke_94 = @2_ke_91[@i_131])) then
  (
    let Ystar: G = @2_r2_90[@i_131] in
    out(c4[!_54], (S, Ystar));
    in(c7[!_54], auth_s: hash1);
    find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
    (
      let K_s: G = exp(X_s, y) in
      if (auth_s = h1(U, S, X_s, Y, K_s)) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
    )
    else
    (
      find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
      (
        event Auth
      )
      else
      (
        let K_s: G = exp(X_s, y) in
        if (auth_s = h1(U, S, X_s, Y, K_s)) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
      )
    )
  )
  orfind @i_130 <= NS suchthat defined(@2_x_95[@i_130], @2_ke_94[@i_130], @2_r2_93[@i_130]) && otheruses(@2_r2_93[@i_130]) && ((@2_x_95 = @2_x_95[@i_130]) && (@2_ke_94 = @2_ke_94[@i_130])) then
  (
    let Ystar: G = @2_r2_93[@i_130] in
    out(c4[!_54], (S, Ystar));
    in(c7[!_54], auth_s: hash1);
    find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
    (
      let K_s: G = exp(X_s, y) in
      if (auth_s = h1(U, S, X_s, Y, K_s)) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
    )
    else
    (
      find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
      (
        event Auth
      )
      else
      (
        let K_s: G = exp(X_s, y) in
        if (auth_s = h1(U, S, X_s, Y, K_s)) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
      )
    )
  )
  else
  (
    new @2_r2_93: G;
    let Ystar: G = @2_r2_93 in
    out(c4[!_54], (S, Ystar));
    in(c7[!_54], auth_s: hash1);
    find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
    (
      let K_s: G = exp(X_s, y) in
      if (auth_s = h1(U, S, X_s, Y, K_s)) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
    )
    else
    (
      find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
      (
        event Auth
      )
      else
      (
        let K_s: G = exp(X_s, y) in
        if (auth_s = h1(U, S, X_s, Y, K_s)) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
      )
    )
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let @2_x_92: G = Yp in
  let @2_ke_91: passwd = pw in
  find [unique] @i_128 <= qD suchthat defined(@2_r4_84[@i_128], @2_m_86[@i_128], @2_kd_85[@i_128]) && otheruses(@2_r4_84[@i_128]) && ((@2_x_92 = @2_r4_84[@i_128]) && (@2_ke_91 = @2_kd_85[@i_128])) then
  (
    let Ystarp: G = @2_m_86[@i_128] in
    let authp: hash1 = h1(U, S, Xp, Yp, Kp) in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_55], (U, Xp, S, Ystarp, authp))
  )
  orfind @i_124 <= NU suchthat defined(@2_r4_96[@i_124], @2_m_98[@i_124], @2_kd_97[@i_124]) && otheruses(@2_r4_96[@i_124]) && ((@2_x_92 = @2_r4_96[@i_124]) && (@2_ke_91 = @2_kd_97[@i_124])) then
  (
    let Ystarp: G = @2_m_98[@i_124] in
    let authp: hash1 = h1(U, S, Xp, Yp, Kp) in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_55], (U, Xp, S, Ystarp, authp))
  )
  orfind @i_122 <= qE suchthat defined(@2_x_89[@i_122], @2_ke_88[@i_122], @2_r2_87[@i_122]) && otheruses(@2_r2_87[@i_122]) && ((@2_x_92 = @2_x_89[@i_122]) && (@2_ke_91 = @2_ke_88[@i_122])) then
  (
    let Ystarp: G = @2_r2_87[@i_122] in
    let authp: hash1 = h1(U, S, Xp, Yp, Kp) in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_55], (U, Xp, S, Ystarp, authp))
  )
  orfind @i_121 <= NP suchthat defined(@2_x_92[@i_121], @2_ke_91[@i_121], @2_r2_90[@i_121]) && otheruses(@2_r2_90[@i_121]) && ((@2_x_92 = @2_x_92[@i_121]) && (@2_ke_91 = @2_ke_91[@i_121])) then
  (
    let Ystarp: G = @2_r2_90[@i_121] in
    let authp: hash1 = h1(U, S, Xp, Yp, Kp) in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_55], (U, Xp, S, Ystarp, authp))
  )
  orfind @i_120 <= NS suchthat defined(@2_x_95[@i_120], @2_ke_94[@i_120], @2_r2_93[@i_120]) && otheruses(@2_r2_93[@i_120]) && ((@2_x_92 = @2_x_95[@i_120]) && (@2_ke_91 = @2_ke_94[@i_120])) then
  (
    let Ystarp: G = @2_r2_93[@i_120] in
    let authp: hash1 = h1(U, S, Xp, Yp, Kp) in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_55], (U, Xp, S, Ystarp, authp))
  )
  else
  (
    new @2_r2_90: G;
    let Ystarp: G = @2_r2_90 in
    let authp: hash1 = h1(U, S, Xp, Yp, Kp) in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_55], (U, Xp, S, Ystarp, authp))
  )
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  let @2_x_89: G = @2_x in
  let @2_ke_88: passwd = @2_ke in
  find [unique] @i_118 <= qD suchthat defined(@2_r4_84[@i_118], @2_m_86[@i_118], @2_kd_85[@i_118]) && otheruses(@2_r4_84[@i_118]) && ((@2_x_89 = @2_r4_84[@i_118]) && (@2_ke_88 = @2_kd_85[@i_118])) then
  (
    out(@2_c2[!_56], @2_m_86[@i_118])
  )
  orfind @i_114 <= NU suchthat defined(@2_r4_96[@i_114], @2_m_98[@i_114], @2_kd_97[@i_114]) && otheruses(@2_r4_96[@i_114]) && ((@2_x_89 = @2_r4_96[@i_114]) && (@2_ke_88 = @2_kd_97[@i_114])) then
  (
    out(@2_c2[!_56], @2_m_98[@i_114])
  )
  orfind @i_112 <= qE suchthat defined(@2_x_89[@i_112], @2_ke_88[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x_89 = @2_x_89[@i_112]) && (@2_ke_88 = @2_ke_88[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(@2_x_92[@i_111], @2_ke_91[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x_89 = @2_x_92[@i_111]) && (@2_ke_88 = @2_ke_91[@i_111])) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(@2_x_95[@i_110], @2_ke_94[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x_89 = @2_x_95[@i_110]) && (@2_ke_88 = @2_ke_94[@i_110])) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  let @2_m_86: G = @2_m in
  let @2_kd_85: passwd = @2_kd in
  find [unique] @i_108 <= qD suchthat defined(@2_r4_84[@i_108], @2_m_86[@i_108], @2_kd_85[@i_108]) && otheruses(@2_r4_84[@i_108]) && ((@2_m_86 = @2_m_86[@i_108]) && (@2_kd_85 = @2_kd_85[@i_108])) then
  (
    out(@2_c4[!_57], @2_r4_84[@i_108])
  )
  orfind @i_104 <= NU suchthat defined(@2_r4_96[@i_104], @2_m_98[@i_104], @2_kd_97[@i_104]) && otheruses(@2_r4_96[@i_104]) && ((@2_m_86 = @2_m_98[@i_104]) && (@2_kd_85 = @2_kd_97[@i_104])) then
  (
    out(@2_c4[!_57], @2_r4_96[@i_104])
  )
  orfind @i_102 <= qE suchthat defined(@2_x_89[@i_102], @2_ke_88[@i_102], @2_r2_87[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m_86 = @2_r2_87[@i_102]) && (@2_kd_85 = @2_ke_88[@i_102])) then
  (
    out(@2_c4[!_57], @2_x_89[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@2_x_92[@i_101], @2_ke_91[@i_101], @2_r2_90[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m_86 = @2_r2_90[@i_101]) && (@2_kd_85 = @2_ke_91[@i_101])) then
  (
    out(@2_c4[!_57], @2_x_92[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_x_95[@i_100], @2_ke_94[@i_100], @2_r2_93[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m_86 = @2_r2_93[@i_100]) && (@2_kd_85 = @2_ke_94[@i_100])) then
  (
    out(@2_c4[!_57], @2_x_95[@i_100])
  )
  else
  (
    new @2_r4_84: G;
    out(@2_c4[!_57], @2_r4_84)
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  out(c20[!_58], h0(x1_69, x2_68, x3_67, x4_66, x5_65))
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  out(c21[!_59], h1(x1_64, x2_63, x3_62, x4_61, x5_60))
)


Applying simplify [Excluding set(dist 5->6, proba <= NP * NS / |exponent| + NP * qE / |exponent| + NP * NU / |exponent| + NP * qD / |exponent| + NS * NP / |exponent| + NS * qE / |exponent| + NS * NU / |exponent| + NS * qD / |exponent| + 0.5 * NP * NP / |exponent| + 0.5 * NS * NS / |exponent|)] yields

Game 6 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  let @2_m_98: G = Ystar_u in
  let @2_kd_97: passwd = pw in
  find [unique] @i_148 <= qD suchthat defined(@2_m_86[@i_148], @2_kd_85[@i_148], @2_r4_84[@i_148]) && otheruses(@2_r4_84[@i_148]) && ((@2_m_98 = @2_m_86[@i_148]) && (@2_kd_97 = @2_kd_85[@i_148])) then
  (
    let Y_u: G = @2_r4_84[@i_148] in
    let K_u: G = exp(Y_u, x) in
    let auth_u: hash1 = h1(U, S, X, Y_u, K_u) in
    out(c6[!_53], auth_u);
    in(c9[!_53], ());
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u)
  )
  orfind @i_144 <= NU suchthat defined(@2_m_98[@i_144], @2_r4_96[@i_144]) && otheruses(@2_r4_96[@i_144]) && (@2_m_98 = @2_m_98[@i_144]) then
  (
    let Y_u: G = @2_r4_96[@i_144] in
    let K_u: G = exp(Y_u, x) in
    let auth_u: hash1 = h1(U, S, X, Y_u, K_u) in
    out(c6[!_53], auth_u);
    in(c9[!_53], ());
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u)
  )
  orfind @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke_88[@i_142], @2_x_89[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((@2_m_98 = @2_r2_87[@i_142]) && (@2_kd_97 = @2_ke_88[@i_142])) then
  (
    let Y_u: G = @2_x_89[@i_142] in
    let K_u: G = exp(Y_u, x) in
    let auth_u: hash1 = h1(U, S, X, Y_u, K_u) in
    out(c6[!_53], auth_u);
    in(c9[!_53], ());
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u)
  )
  orfind @i_141 <= NP suchthat defined(@2_r2_90[@i_141], @2_x_92[@i_141], yp[@i_141]) && otheruses(@2_r2_90[@i_141]) && (@2_m_98 = @2_r2_90[@i_141]) then
  (
    let Y_u: G = @2_x_92[@i_141] in
    let K_u: G = exp(g, mult(yp[@i_141], x)) in
    let auth_u: hash1 = h1(U, S, X, Y_u, K_u) in
    out(c6[!_53], auth_u);
    in(c9[!_53], ());
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u)
  )
  orfind @i_140 <= NS suchthat defined(@2_r2_93[@i_140], @2_x_95[@i_140], y[@i_140]) && otheruses(@2_r2_93[@i_140]) && (@2_m_98 = @2_r2_93[@i_140]) then
  (
    let Y_u: G = @2_x_95[@i_140] in
    let K_u: G = exp(g, mult(y[@i_140], x)) in
    let auth_u: hash1 = h1(U, S, X, Y_u, K_u) in
    out(c6[!_53], auth_u);
    in(c9[!_53], ());
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u)
  )
  else
  (
    new @2_r4_96: G;
    let Y_u: G = @2_r4_96 in
    let K_u: G = exp(Y_u, x) in
    let auth_u: hash1 = h1(U, S, X, Y_u, K_u) in
    out(c6[!_53], auth_u);
    in(c9[!_53], ());
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u)
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let @2_x_95: G = Y in
  let @2_ke_94: passwd = pw in
  new @2_r2_93: G;
  let Ystar: G = @2_r2_93 in
  out(c4[!_54], (S, Ystar));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    if (auth_s = h1(U, S, X_s, Y, K_s)) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    (
      event Auth
    )
    else
    (
      let K_s: G = exp(X_s, y) in
      if (auth_s = h1(U, S, X_s, Y, K_s)) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
    )
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let @2_x_92: G = Yp in
  let @2_ke_91: passwd = pw in
  new @2_r2_90: G;
  let Ystarp: G = @2_r2_90 in
  let authp: hash1 = h1(U, S, Xp, Yp, Kp) in
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_55], (U, Xp, S, Ystarp, authp))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  let @2_x_89: G = @2_x in
  let @2_ke_88: passwd = @2_ke in
  find [unique] @i_118 <= qD suchthat defined(@2_r4_84[@i_118], @2_kd_85[@i_118], @2_m_86[@i_118]) && otheruses(@2_r4_84[@i_118]) && ((@2_x_89 = @2_r4_84[@i_118]) && (@2_ke_88 = @2_kd_85[@i_118])) then
  (
    out(@2_c2[!_56], @2_m_86[@i_118])
  )
  orfind @i_114 <= NU suchthat defined(@2_r4_96[@i_114], @2_kd_97[@i_114], @2_m_98[@i_114]) && otheruses(@2_r4_96[@i_114]) && ((@2_x_89 = @2_r4_96[@i_114]) && (@2_ke_88 = @2_kd_97[@i_114])) then
  (
    out(@2_c2[!_56], @2_m_98[@i_114])
  )
  orfind @i_112 <= qE suchthat defined(@2_x_89[@i_112], @2_ke_88[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x_89 = @2_x_89[@i_112]) && (@2_ke_88 = @2_ke_88[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(@2_x_92[@i_111], @2_ke_91[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x_89 = @2_x_92[@i_111]) && (@2_ke_88 = @2_ke_91[@i_111])) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(@2_x_95[@i_110], @2_ke_94[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x_89 = @2_x_95[@i_110]) && (@2_ke_88 = @2_ke_94[@i_110])) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  let @2_m_86: G = @2_m in
  let @2_kd_85: passwd = @2_kd in
  find [unique] @i_108 <= qD suchthat defined(@2_m_86[@i_108], @2_kd_85[@i_108], @2_r4_84[@i_108]) && otheruses(@2_r4_84[@i_108]) && ((@2_m_86 = @2_m_86[@i_108]) && (@2_kd_85 = @2_kd_85[@i_108])) then
  (
    out(@2_c4[!_57], @2_r4_84[@i_108])
  )
  orfind @i_104 <= NU suchthat defined(@2_m_98[@i_104], @2_kd_97[@i_104], @2_r4_96[@i_104]) && otheruses(@2_r4_96[@i_104]) && ((@2_m_86 = @2_m_98[@i_104]) && (@2_kd_85 = @2_kd_97[@i_104])) then
  (
    out(@2_c4[!_57], @2_r4_96[@i_104])
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke_88[@i_102], @2_x_89[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m_86 = @2_r2_87[@i_102]) && (@2_kd_85 = @2_ke_88[@i_102])) then
  (
    out(@2_c4[!_57], @2_x_89[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@2_r2_90[@i_101], @2_ke_91[@i_101], @2_x_92[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m_86 = @2_r2_90[@i_101]) && (@2_kd_85 = @2_ke_91[@i_101])) then
  (
    out(@2_c4[!_57], @2_x_92[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_r2_93[@i_100], @2_ke_94[@i_100], @2_x_95[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m_86 = @2_r2_93[@i_100]) && (@2_kd_85 = @2_ke_94[@i_100])) then
  (
    out(@2_c4[!_57], @2_x_95[@i_100])
  )
  else
  (
    new @2_r4_84: G;
    out(@2_c4[!_57], @2_r4_84)
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  out(c20[!_58], h0(x1_69, x2_68, x3_67, x4_66, x5_65))
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  out(c21[!_59], h1(x1_64, x2_63, x3_62, x4_61, x5_60))
)


Applying remove assignments of useless yields

Game 7 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  let @2_m_98: G = cst_G in
  let @2_kd_97: passwd = cst_passwd in
  find [unique] @i_148 <= qD suchthat defined(@2_m[@i_148], @2_kd[@i_148], @2_kd_85[@i_148], @2_m_86[@i_148], @2_r4_84[@i_148]) && otheruses(@2_r4_84[@i_148]) && ((Ystar_u = @2_m[@i_148]) && (pw = @2_kd[@i_148])) then
  (
    let K_u: G = exp(@2_r4_84[@i_148], x) in
    let auth_u: hash1 = h1(U, S, X, @2_r4_84[@i_148], K_u) in
    out(c6[!_53], auth_u);
    in(c9[!_53], ());
    let sk_u: hash0 = h0(U, S, X, @2_r4_84[@i_148], K_u)
  )
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], @2_m_98[@i_144], @2_r4_96[@i_144]) && otheruses(@2_r4_96[@i_144]) && (Ystar_u = Ystar_u[@i_144]) then
  (
    let K_u: G = exp(@2_r4_96[@i_144], x) in
    let auth_u: hash1 = h1(U, S, X, @2_r4_96[@i_144], K_u) in
    out(c6[!_53], auth_u);
    in(c9[!_53], ());
    let sk_u: hash0 = h0(U, S, X, @2_r4_96[@i_144], K_u)
  )
  orfind @i_142 <= qE suchthat defined(@2_ke[@i_142], @2_x[@i_142], @2_x_89[@i_142], @2_ke_88[@i_142], @2_r2_87[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    let K_u: G = exp(@2_x[@i_142], x) in
    let auth_u: hash1 = h1(U, S, X, @2_x[@i_142], K_u) in
    out(c6[!_53], auth_u);
    in(c9[!_53], ());
    let sk_u: hash0 = h0(U, S, X, @2_x[@i_142], K_u)
  )
  orfind @i_141 <= NP suchthat defined(Yp[@i_141], @2_x_92[@i_141], @2_r2_90[@i_141], yp[@i_141]) && otheruses(@2_r2_90[@i_141]) && (Ystar_u = @2_r2_90[@i_141]) then
  (
    let K_u: G = exp(g, mult(yp[@i_141], x)) in
    let auth_u: hash1 = h1(U, S, X, Yp[@i_141], K_u) in
    out(c6[!_53], auth_u);
    in(c9[!_53], ());
    let sk_u: hash0 = h0(U, S, X, Yp[@i_141], K_u)
  )
  orfind @i_140 <= NS suchthat defined(Y[@i_140], @2_x_95[@i_140], @2_r2_93[@i_140], y[@i_140]) && otheruses(@2_r2_93[@i_140]) && (Ystar_u = @2_r2_93[@i_140]) then
  (
    let K_u: G = exp(g, mult(y[@i_140], x)) in
    let auth_u: hash1 = h1(U, S, X, Y[@i_140], K_u) in
    out(c6[!_53], auth_u);
    in(c9[!_53], ());
    let sk_u: hash0 = h0(U, S, X, Y[@i_140], K_u)
  )
  else
  (
    new @2_r4_96: G;
    let K_u: G = exp(@2_r4_96, x) in
    let auth_u: hash1 = h1(U, S, X, @2_r4_96, K_u) in
    out(c6[!_53], auth_u);
    in(c9[!_53], ());
    let sk_u: hash0 = h0(U, S, X, @2_r4_96, K_u)
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let @2_x_95: G = cst_G in
  let @2_ke_94: passwd = cst_passwd in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    if (auth_s = h1(U, S, X_s, Y, K_s)) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    (
      event Auth
    )
    else
    (
      let K_s: G = exp(X_s, y) in
      if (auth_s = h1(U, S, X_s, Y, K_s)) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
    )
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let @2_x_92: G = cst_G in
  let @2_ke_91: passwd = cst_passwd in
  new @2_r2_90: G;
  let authp: hash1 = h1(U, S, Xp, Yp, Kp) in
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_55], (U, Xp, S, @2_r2_90, authp))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  let @2_x_89: G = cst_G in
  let @2_ke_88: passwd = cst_passwd in
  find [unique] @i_118 <= qD suchthat defined(@2_kd[@i_118], @2_m[@i_118], @2_m_86[@i_118], @2_kd_85[@i_118], @2_r4_84[@i_118]) && otheruses(@2_r4_84[@i_118]) && ((@2_x = @2_r4_84[@i_118]) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_114 <= NU suchthat defined(pw, Ystar_u[@i_114], @2_m_98[@i_114], @2_kd_97[@i_114], @2_r4_96[@i_114]) && otheruses(@2_r4_96[@i_114]) && ((@2_x = @2_r4_96[@i_114]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], Ystar_u[@i_114])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_ke_88[@i_112], @2_x_89[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(Yp[@i_111], pw, @2_ke_91[@i_111], @2_x_92[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = Yp[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], pw, @2_ke_94[@i_110], @2_x_95[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  let @2_m_86: G = cst_G in
  let @2_kd_85: passwd = cst_passwd in
  find [unique] @i_108 <= qD suchthat defined(@2_m[@i_108], @2_kd[@i_108], @2_kd_85[@i_108], @2_m_86[@i_108], @2_r4_84[@i_108]) && otheruses(@2_r4_84[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], @2_r4_84[@i_108])
  )
  orfind @i_104 <= NU suchthat defined(Ystar_u[@i_104], pw, @2_kd_97[@i_104], @2_m_98[@i_104], @2_r4_96[@i_104]) && otheruses(@2_r4_96[@i_104]) && ((@2_m = Ystar_u[@i_104]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], @2_r4_96[@i_104])
  )
  orfind @i_102 <= qE suchthat defined(@2_ke[@i_102], @2_x[@i_102], @2_x_89[@i_102], @2_ke_88[@i_102], @2_r2_87[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(pw, Yp[@i_101], @2_x_92[@i_101], @2_ke_91[@i_101], @2_r2_90[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Yp[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(pw, Y[@i_100], @2_x_95[@i_100], @2_ke_94[@i_100], @2_r2_93[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @2_r4_84: G;
    out(@2_c4[!_57], @2_r4_84)
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  out(c20[!_58], h0(x1_69, x2_68, x3_67, x4_66, x5_65))
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  out(c21[!_59], h1(x1_64, x2_63, x3_62, x4_61, x5_60))
)


Applying insert event Encrypt at occurrence 759 [Excluding set(event Encrypt in game 8)] yields

Game 8 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  let @2_m_98: G = cst_G in
  let @2_kd_97: passwd = cst_passwd in
  find [unique] @i_148 <= qD suchthat defined(@2_m[@i_148], @2_kd[@i_148], @2_kd_85[@i_148], @2_m_86[@i_148], @2_r4_84[@i_148]) && otheruses(@2_r4_84[@i_148]) && ((Ystar_u = @2_m[@i_148]) && (pw = @2_kd[@i_148])) then
  (
    let K_u: G = exp(@2_r4_84[@i_148], x) in
    let auth_u: hash1 = h1(U, S, X, @2_r4_84[@i_148], K_u) in
    out(c6[!_53], auth_u);
    in(c9[!_53], ());
    let sk_u: hash0 = h0(U, S, X, @2_r4_84[@i_148], K_u)
  )
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], @2_m_98[@i_144], @2_r4_96[@i_144]) && otheruses(@2_r4_96[@i_144]) && (Ystar_u = Ystar_u[@i_144]) then
  (
    let K_u: G = exp(@2_r4_96[@i_144], x) in
    let auth_u: hash1 = h1(U, S, X, @2_r4_96[@i_144], K_u) in
    out(c6[!_53], auth_u);
    in(c9[!_53], ());
    let sk_u: hash0 = h0(U, S, X, @2_r4_96[@i_144], K_u)
  )
  orfind @i_142 <= qE suchthat defined(@2_ke[@i_142], @2_x[@i_142], @2_x_89[@i_142], @2_ke_88[@i_142], @2_r2_87[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  orfind @i_141 <= NP suchthat defined(Yp[@i_141], @2_x_92[@i_141], @2_r2_90[@i_141], yp[@i_141]) && otheruses(@2_r2_90[@i_141]) && (Ystar_u = @2_r2_90[@i_141]) then
  (
    let K_u: G = exp(g, mult(yp[@i_141], x)) in
    let auth_u: hash1 = h1(U, S, X, Yp[@i_141], K_u) in
    out(c6[!_53], auth_u);
    in(c9[!_53], ());
    let sk_u: hash0 = h0(U, S, X, Yp[@i_141], K_u)
  )
  orfind @i_140 <= NS suchthat defined(Y[@i_140], @2_x_95[@i_140], @2_r2_93[@i_140], y[@i_140]) && otheruses(@2_r2_93[@i_140]) && (Ystar_u = @2_r2_93[@i_140]) then
  (
    let K_u: G = exp(g, mult(y[@i_140], x)) in
    let auth_u: hash1 = h1(U, S, X, Y[@i_140], K_u) in
    out(c6[!_53], auth_u);
    in(c9[!_53], ());
    let sk_u: hash0 = h0(U, S, X, Y[@i_140], K_u)
  )
  else
  (
    new @2_r4_96: G;
    let K_u: G = exp(@2_r4_96, x) in
    let auth_u: hash1 = h1(U, S, X, @2_r4_96, K_u) in
    out(c6[!_53], auth_u);
    in(c9[!_53], ());
    let sk_u: hash0 = h0(U, S, X, @2_r4_96, K_u)
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let @2_x_95: G = cst_G in
  let @2_ke_94: passwd = cst_passwd in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    if (auth_s = h1(U, S, X_s, Y, K_s)) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    (
      event Auth
    )
    else
    (
      let K_s: G = exp(X_s, y) in
      if (auth_s = h1(U, S, X_s, Y, K_s)) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
    )
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let @2_x_92: G = cst_G in
  let @2_ke_91: passwd = cst_passwd in
  new @2_r2_90: G;
  let authp: hash1 = h1(U, S, Xp, Yp, Kp) in
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_55], (U, Xp, S, @2_r2_90, authp))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  let @2_x_89: G = cst_G in
  let @2_ke_88: passwd = cst_passwd in
  find [unique] @i_118 <= qD suchthat defined(@2_kd[@i_118], @2_m[@i_118], @2_m_86[@i_118], @2_kd_85[@i_118], @2_r4_84[@i_118]) && otheruses(@2_r4_84[@i_118]) && ((@2_x = @2_r4_84[@i_118]) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_114 <= NU suchthat defined(pw, Ystar_u[@i_114], @2_m_98[@i_114], @2_kd_97[@i_114], @2_r4_96[@i_114]) && otheruses(@2_r4_96[@i_114]) && ((@2_x = @2_r4_96[@i_114]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], Ystar_u[@i_114])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_ke_88[@i_112], @2_x_89[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(Yp[@i_111], pw, @2_ke_91[@i_111], @2_x_92[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = Yp[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], pw, @2_ke_94[@i_110], @2_x_95[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  let @2_m_86: G = cst_G in
  let @2_kd_85: passwd = cst_passwd in
  find [unique] @i_108 <= qD suchthat defined(@2_m[@i_108], @2_kd[@i_108], @2_kd_85[@i_108], @2_m_86[@i_108], @2_r4_84[@i_108]) && otheruses(@2_r4_84[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], @2_r4_84[@i_108])
  )
  orfind @i_104 <= NU suchthat defined(Ystar_u[@i_104], pw, @2_kd_97[@i_104], @2_m_98[@i_104], @2_r4_96[@i_104]) && otheruses(@2_r4_96[@i_104]) && ((@2_m = Ystar_u[@i_104]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], @2_r4_96[@i_104])
  )
  orfind @i_102 <= qE suchthat defined(@2_ke[@i_102], @2_x[@i_102], @2_x_89[@i_102], @2_ke_88[@i_102], @2_r2_87[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(pw, Yp[@i_101], @2_x_92[@i_101], @2_ke_91[@i_101], @2_r2_90[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Yp[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(pw, Y[@i_100], @2_x_95[@i_100], @2_ke_94[@i_100], @2_r2_93[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @2_r4_84: G;
    out(@2_c4[!_57], @2_r4_84)
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  out(c20[!_58], h0(x1_69, x2_68, x3_67, x4_66, x5_65))
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  out(c21[!_59], h1(x1_64, x2_63, x3_62, x4_61, x5_60))
)


Applying equivalence
equiv ! !_51 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_52 <= N (x1_74: host, x2_73: host, x3_72: G, x4_71: G, x5_70: G) -> let x1: host = x1_74 in let x2: host = x2_73 in let x3: G = x3_72 in let x4: G = x4_71 in let x5: G = x5_70 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash1; r
 yields

Game 9 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  let @2_m_98: G = cst_G in
  let @2_kd_97: passwd = cst_passwd in
  find [unique] @i_148 <= qD suchthat defined(@2_m[@i_148], @2_kd[@i_148], @2_kd_85[@i_148], @2_m_86[@i_148], @2_r4_84[@i_148]) && otheruses(@2_r4_84[@i_148]) && ((Ystar_u = @2_m[@i_148]) && (pw = @2_kd[@i_148])) then
  (
    let K_u: G = exp(@2_r4_84[@i_148], x) in
    let x1_283: host = U in
    let x2_282: host = S in
    let x3_281: G = X in
    let x4_280: G = @2_r4_84[@i_148] in
    let x5_279: G = K_u in
    find [unique] @i_355 <= qH1 suchthat defined(x1_253[@i_355], x2_252[@i_355], x3_251[@i_355], x4_250[@i_355], x5_249[@i_355], r_248[@i_355]) && otheruses(r_248[@i_355]) && ((x1_283 = x1_253[@i_355]) && ((x2_282 = x2_252[@i_355]) && ((x3_281 = x3_251[@i_355]) && ((x4_280 = x4_250[@i_355]) && (x5_279 = x5_249[@i_355]))))) then
    (
      let auth_u: hash1 = r_248[@i_355] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_84[@i_148], K_u)
    )
    orfind @i_354 <= NP suchthat defined(x1_259[@i_354], x2_258[@i_354], x3_257[@i_354], x4_256[@i_354], x5_255[@i_354], r_254[@i_354]) && otheruses(r_254[@i_354]) && ((x1_283 = x1_259[@i_354]) && ((x2_282 = x2_258[@i_354]) && ((x3_281 = x3_257[@i_354]) && ((x4_280 = x4_256[@i_354]) && (x5_279 = x5_255[@i_354]))))) then
    (
      let auth_u: hash1 = r_254[@i_354] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_84[@i_148], K_u)
    )
    orfind @i_353 <= NS suchthat defined(x1_265[@i_353], x2_264[@i_353], x3_263[@i_353], x4_262[@i_353], x5_261[@i_353], r_260[@i_353]) && otheruses(r_260[@i_353]) && ((x1_283 = x1_265[@i_353]) && ((x2_282 = x2_264[@i_353]) && ((x3_281 = x3_263[@i_353]) && ((x4_280 = x4_262[@i_353]) && (x5_279 = x5_261[@i_353]))))) then
    (
      let auth_u: hash1 = r_260[@i_353] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_84[@i_148], K_u)
    )
    orfind @i_352 <= NS suchthat defined(x1_271[@i_352], x2_270[@i_352], x3_269[@i_352], x4_268[@i_352], x5_267[@i_352], r_266[@i_352]) && otheruses(r_266[@i_352]) && ((x1_283 = x1_271[@i_352]) && ((x2_282 = x2_270[@i_352]) && ((x3_281 = x3_269[@i_352]) && ((x4_280 = x4_268[@i_352]) && (x5_279 = x5_267[@i_352]))))) then
    (
      let auth_u: hash1 = r_266[@i_352] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_84[@i_148], K_u)
    )
    orfind @i_351 <= NU suchthat defined(x1_277[@i_351], x2_276[@i_351], x3_275[@i_351], x4_274[@i_351], x5_273[@i_351], r_272[@i_351]) && otheruses(r_272[@i_351]) && ((x1_283 = x1_277[@i_351]) && ((x2_282 = x2_276[@i_351]) && ((x3_281 = x3_275[@i_351]) && ((x4_280 = x4_274[@i_351]) && (x5_279 = x5_273[@i_351]))))) then
    (
      let auth_u: hash1 = r_272[@i_351] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_84[@i_148], K_u)
    )
    orfind @i_350 <= NU suchthat defined(x1_283[@i_350], x2_282[@i_350], x3_281[@i_350], x4_280[@i_350], x5_279[@i_350], r_278[@i_350]) && otheruses(r_278[@i_350]) && ((x1_283 = x1_283[@i_350]) && ((x2_282 = x2_282[@i_350]) && ((x3_281 = x3_281[@i_350]) && ((x4_280 = x4_280[@i_350]) && (x5_279 = x5_279[@i_350]))))) then
    (
      let auth_u: hash1 = r_278[@i_350] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_84[@i_148], K_u)
    )
    orfind @i_349 <= NU suchthat defined(x1_289[@i_349], x2_288[@i_349], x3_287[@i_349], x4_286[@i_349], x5_285[@i_349], r_284[@i_349]) && otheruses(r_284[@i_349]) && ((x1_283 = x1_289[@i_349]) && ((x2_282 = x2_288[@i_349]) && ((x3_281 = x3_287[@i_349]) && ((x4_280 = x4_286[@i_349]) && (x5_279 = x5_285[@i_349]))))) then
    (
      let auth_u: hash1 = r_284[@i_349] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_84[@i_148], K_u)
    )
    orfind @i_348 <= NU suchthat defined(x1_295[@i_348], x2_294[@i_348], x3_293[@i_348], x4_292[@i_348], x5_291[@i_348], r_290[@i_348]) && otheruses(r_290[@i_348]) && ((x1_283 = x1_295[@i_348]) && ((x2_282 = x2_294[@i_348]) && ((x3_281 = x3_293[@i_348]) && ((x4_280 = x4_292[@i_348]) && (x5_279 = x5_291[@i_348]))))) then
    (
      let auth_u: hash1 = r_290[@i_348] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_84[@i_148], K_u)
    )
    orfind @i_347 <= NU suchthat defined(x1_301[@i_347], x2_300[@i_347], x3_299[@i_347], x4_298[@i_347], x5_297[@i_347], r_296[@i_347]) && otheruses(r_296[@i_347]) && ((x1_283 = x1_301[@i_347]) && ((x2_282 = x2_300[@i_347]) && ((x3_281 = x3_299[@i_347]) && ((x4_280 = x4_298[@i_347]) && (x5_279 = x5_297[@i_347]))))) then
    (
      let auth_u: hash1 = r_296[@i_347] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_84[@i_148], K_u)
    )
    else
    (
      new r_278: hash1;
      let auth_u: hash1 = r_278 in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_84[@i_148], K_u)
    )
  )
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], @2_m_98[@i_144], @2_r4_96[@i_144]) && otheruses(@2_r4_96[@i_144]) && (Ystar_u = Ystar_u[@i_144]) then
  (
    let K_u: G = exp(@2_r4_96[@i_144], x) in
    let x1_289: host = U in
    let x2_288: host = S in
    let x3_287: G = X in
    let x4_286: G = @2_r4_96[@i_144] in
    let x5_285: G = K_u in
    find [unique] @i_364 <= qH1 suchthat defined(x1_253[@i_364], x2_252[@i_364], x3_251[@i_364], x4_250[@i_364], x5_249[@i_364], r_248[@i_364]) && otheruses(r_248[@i_364]) && ((x1_289 = x1_253[@i_364]) && ((x2_288 = x2_252[@i_364]) && ((x3_287 = x3_251[@i_364]) && ((x4_286 = x4_250[@i_364]) && (x5_285 = x5_249[@i_364]))))) then
    (
      let auth_u: hash1 = r_248[@i_364] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_96[@i_144], K_u)
    )
    orfind @i_363 <= NP suchthat defined(x1_259[@i_363], x2_258[@i_363], x3_257[@i_363], x4_256[@i_363], x5_255[@i_363], r_254[@i_363]) && otheruses(r_254[@i_363]) && ((x1_289 = x1_259[@i_363]) && ((x2_288 = x2_258[@i_363]) && ((x3_287 = x3_257[@i_363]) && ((x4_286 = x4_256[@i_363]) && (x5_285 = x5_255[@i_363]))))) then
    (
      let auth_u: hash1 = r_254[@i_363] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_96[@i_144], K_u)
    )
    orfind @i_362 <= NS suchthat defined(x1_265[@i_362], x2_264[@i_362], x3_263[@i_362], x4_262[@i_362], x5_261[@i_362], r_260[@i_362]) && otheruses(r_260[@i_362]) && ((x1_289 = x1_265[@i_362]) && ((x2_288 = x2_264[@i_362]) && ((x3_287 = x3_263[@i_362]) && ((x4_286 = x4_262[@i_362]) && (x5_285 = x5_261[@i_362]))))) then
    (
      let auth_u: hash1 = r_260[@i_362] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_96[@i_144], K_u)
    )
    orfind @i_361 <= NS suchthat defined(x1_271[@i_361], x2_270[@i_361], x3_269[@i_361], x4_268[@i_361], x5_267[@i_361], r_266[@i_361]) && otheruses(r_266[@i_361]) && ((x1_289 = x1_271[@i_361]) && ((x2_288 = x2_270[@i_361]) && ((x3_287 = x3_269[@i_361]) && ((x4_286 = x4_268[@i_361]) && (x5_285 = x5_267[@i_361]))))) then
    (
      let auth_u: hash1 = r_266[@i_361] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_96[@i_144], K_u)
    )
    orfind @i_360 <= NU suchthat defined(x1_277[@i_360], x2_276[@i_360], x3_275[@i_360], x4_274[@i_360], x5_273[@i_360], r_272[@i_360]) && otheruses(r_272[@i_360]) && ((x1_289 = x1_277[@i_360]) && ((x2_288 = x2_276[@i_360]) && ((x3_287 = x3_275[@i_360]) && ((x4_286 = x4_274[@i_360]) && (x5_285 = x5_273[@i_360]))))) then
    (
      let auth_u: hash1 = r_272[@i_360] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_96[@i_144], K_u)
    )
    orfind @i_359 <= NU suchthat defined(x1_283[@i_359], x2_282[@i_359], x3_281[@i_359], x4_280[@i_359], x5_279[@i_359], r_278[@i_359]) && otheruses(r_278[@i_359]) && ((x1_289 = x1_283[@i_359]) && ((x2_288 = x2_282[@i_359]) && ((x3_287 = x3_281[@i_359]) && ((x4_286 = x4_280[@i_359]) && (x5_285 = x5_279[@i_359]))))) then
    (
      let auth_u: hash1 = r_278[@i_359] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_96[@i_144], K_u)
    )
    orfind @i_358 <= NU suchthat defined(x1_289[@i_358], x2_288[@i_358], x3_287[@i_358], x4_286[@i_358], x5_285[@i_358], r_284[@i_358]) && otheruses(r_284[@i_358]) && ((x1_289 = x1_289[@i_358]) && ((x2_288 = x2_288[@i_358]) && ((x3_287 = x3_287[@i_358]) && ((x4_286 = x4_286[@i_358]) && (x5_285 = x5_285[@i_358]))))) then
    (
      let auth_u: hash1 = r_284[@i_358] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_96[@i_144], K_u)
    )
    orfind @i_357 <= NU suchthat defined(x1_295[@i_357], x2_294[@i_357], x3_293[@i_357], x4_292[@i_357], x5_291[@i_357], r_290[@i_357]) && otheruses(r_290[@i_357]) && ((x1_289 = x1_295[@i_357]) && ((x2_288 = x2_294[@i_357]) && ((x3_287 = x3_293[@i_357]) && ((x4_286 = x4_292[@i_357]) && (x5_285 = x5_291[@i_357]))))) then
    (
      let auth_u: hash1 = r_290[@i_357] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_96[@i_144], K_u)
    )
    orfind @i_356 <= NU suchthat defined(x1_301[@i_356], x2_300[@i_356], x3_299[@i_356], x4_298[@i_356], x5_297[@i_356], r_296[@i_356]) && otheruses(r_296[@i_356]) && ((x1_289 = x1_301[@i_356]) && ((x2_288 = x2_300[@i_356]) && ((x3_287 = x3_299[@i_356]) && ((x4_286 = x4_298[@i_356]) && (x5_285 = x5_297[@i_356]))))) then
    (
      let auth_u: hash1 = r_296[@i_356] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_96[@i_144], K_u)
    )
    else
    (
      new r_284: hash1;
      let auth_u: hash1 = r_284 in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_96[@i_144], K_u)
    )
  )
  orfind @i_142 <= qE suchthat defined(@2_ke[@i_142], @2_x[@i_142], @2_x_89[@i_142], @2_ke_88[@i_142], @2_r2_87[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  orfind @i_141 <= NP suchthat defined(Yp[@i_141], @2_x_92[@i_141], @2_r2_90[@i_141], yp[@i_141]) && otheruses(@2_r2_90[@i_141]) && (Ystar_u = @2_r2_90[@i_141]) then
  (
    let K_u: G = exp(g, mult(yp[@i_141], x)) in
    let x1_295: host = U in
    let x2_294: host = S in
    let x3_293: G = X in
    let x4_292: G = Yp[@i_141] in
    let x5_291: G = K_u in
    find [unique] @i_373 <= qH1 suchthat defined(x1_253[@i_373], x2_252[@i_373], x3_251[@i_373], x4_250[@i_373], x5_249[@i_373], r_248[@i_373]) && otheruses(r_248[@i_373]) && ((x1_295 = x1_253[@i_373]) && ((x2_294 = x2_252[@i_373]) && ((x3_293 = x3_251[@i_373]) && ((x4_292 = x4_250[@i_373]) && (x5_291 = x5_249[@i_373]))))) then
    (
      let auth_u: hash1 = r_248[@i_373] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, Yp[@i_141], K_u)
    )
    orfind @i_372 <= NP suchthat defined(x1_259[@i_372], x2_258[@i_372], x3_257[@i_372], x4_256[@i_372], x5_255[@i_372], r_254[@i_372]) && otheruses(r_254[@i_372]) && ((x1_295 = x1_259[@i_372]) && ((x2_294 = x2_258[@i_372]) && ((x3_293 = x3_257[@i_372]) && ((x4_292 = x4_256[@i_372]) && (x5_291 = x5_255[@i_372]))))) then
    (
      let auth_u: hash1 = r_254[@i_372] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, Yp[@i_141], K_u)
    )
    orfind @i_371 <= NS suchthat defined(x1_265[@i_371], x2_264[@i_371], x3_263[@i_371], x4_262[@i_371], x5_261[@i_371], r_260[@i_371]) && otheruses(r_260[@i_371]) && ((x1_295 = x1_265[@i_371]) && ((x2_294 = x2_264[@i_371]) && ((x3_293 = x3_263[@i_371]) && ((x4_292 = x4_262[@i_371]) && (x5_291 = x5_261[@i_371]))))) then
    (
      let auth_u: hash1 = r_260[@i_371] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, Yp[@i_141], K_u)
    )
    orfind @i_370 <= NS suchthat defined(x1_271[@i_370], x2_270[@i_370], x3_269[@i_370], x4_268[@i_370], x5_267[@i_370], r_266[@i_370]) && otheruses(r_266[@i_370]) && ((x1_295 = x1_271[@i_370]) && ((x2_294 = x2_270[@i_370]) && ((x3_293 = x3_269[@i_370]) && ((x4_292 = x4_268[@i_370]) && (x5_291 = x5_267[@i_370]))))) then
    (
      let auth_u: hash1 = r_266[@i_370] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, Yp[@i_141], K_u)
    )
    orfind @i_369 <= NU suchthat defined(x1_277[@i_369], x2_276[@i_369], x3_275[@i_369], x4_274[@i_369], x5_273[@i_369], r_272[@i_369]) && otheruses(r_272[@i_369]) && ((x1_295 = x1_277[@i_369]) && ((x2_294 = x2_276[@i_369]) && ((x3_293 = x3_275[@i_369]) && ((x4_292 = x4_274[@i_369]) && (x5_291 = x5_273[@i_369]))))) then
    (
      let auth_u: hash1 = r_272[@i_369] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, Yp[@i_141], K_u)
    )
    orfind @i_368 <= NU suchthat defined(x1_283[@i_368], x2_282[@i_368], x3_281[@i_368], x4_280[@i_368], x5_279[@i_368], r_278[@i_368]) && otheruses(r_278[@i_368]) && ((x1_295 = x1_283[@i_368]) && ((x2_294 = x2_282[@i_368]) && ((x3_293 = x3_281[@i_368]) && ((x4_292 = x4_280[@i_368]) && (x5_291 = x5_279[@i_368]))))) then
    (
      let auth_u: hash1 = r_278[@i_368] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, Yp[@i_141], K_u)
    )
    orfind @i_367 <= NU suchthat defined(x1_289[@i_367], x2_288[@i_367], x3_287[@i_367], x4_286[@i_367], x5_285[@i_367], r_284[@i_367]) && otheruses(r_284[@i_367]) && ((x1_295 = x1_289[@i_367]) && ((x2_294 = x2_288[@i_367]) && ((x3_293 = x3_287[@i_367]) && ((x4_292 = x4_286[@i_367]) && (x5_291 = x5_285[@i_367]))))) then
    (
      let auth_u: hash1 = r_284[@i_367] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, Yp[@i_141], K_u)
    )
    orfind @i_366 <= NU suchthat defined(x1_295[@i_366], x2_294[@i_366], x3_293[@i_366], x4_292[@i_366], x5_291[@i_366], r_290[@i_366]) && otheruses(r_290[@i_366]) && ((x1_295 = x1_295[@i_366]) && ((x2_294 = x2_294[@i_366]) && ((x3_293 = x3_293[@i_366]) && ((x4_292 = x4_292[@i_366]) && (x5_291 = x5_291[@i_366]))))) then
    (
      let auth_u: hash1 = r_290[@i_366] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, Yp[@i_141], K_u)
    )
    orfind @i_365 <= NU suchthat defined(x1_301[@i_365], x2_300[@i_365], x3_299[@i_365], x4_298[@i_365], x5_297[@i_365], r_296[@i_365]) && otheruses(r_296[@i_365]) && ((x1_295 = x1_301[@i_365]) && ((x2_294 = x2_300[@i_365]) && ((x3_293 = x3_299[@i_365]) && ((x4_292 = x4_298[@i_365]) && (x5_291 = x5_297[@i_365]))))) then
    (
      let auth_u: hash1 = r_296[@i_365] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, Yp[@i_141], K_u)
    )
    else
    (
      new r_290: hash1;
      let auth_u: hash1 = r_290 in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, Yp[@i_141], K_u)
    )
  )
  orfind @i_140 <= NS suchthat defined(Y[@i_140], @2_x_95[@i_140], @2_r2_93[@i_140], y[@i_140]) && otheruses(@2_r2_93[@i_140]) && (Ystar_u = @2_r2_93[@i_140]) then
  (
    let K_u: G = exp(g, mult(y[@i_140], x)) in
    let x1_301: host = U in
    let x2_300: host = S in
    let x3_299: G = X in
    let x4_298: G = Y[@i_140] in
    let x5_297: G = K_u in
    find [unique] @i_382 <= qH1 suchthat defined(x1_253[@i_382], x2_252[@i_382], x3_251[@i_382], x4_250[@i_382], x5_249[@i_382], r_248[@i_382]) && otheruses(r_248[@i_382]) && ((x1_301 = x1_253[@i_382]) && ((x2_300 = x2_252[@i_382]) && ((x3_299 = x3_251[@i_382]) && ((x4_298 = x4_250[@i_382]) && (x5_297 = x5_249[@i_382]))))) then
    (
      let auth_u: hash1 = r_248[@i_382] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, Y[@i_140], K_u)
    )
    orfind @i_381 <= NP suchthat defined(x1_259[@i_381], x2_258[@i_381], x3_257[@i_381], x4_256[@i_381], x5_255[@i_381], r_254[@i_381]) && otheruses(r_254[@i_381]) && ((x1_301 = x1_259[@i_381]) && ((x2_300 = x2_258[@i_381]) && ((x3_299 = x3_257[@i_381]) && ((x4_298 = x4_256[@i_381]) && (x5_297 = x5_255[@i_381]))))) then
    (
      let auth_u: hash1 = r_254[@i_381] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, Y[@i_140], K_u)
    )
    orfind @i_380 <= NS suchthat defined(x1_265[@i_380], x2_264[@i_380], x3_263[@i_380], x4_262[@i_380], x5_261[@i_380], r_260[@i_380]) && otheruses(r_260[@i_380]) && ((x1_301 = x1_265[@i_380]) && ((x2_300 = x2_264[@i_380]) && ((x3_299 = x3_263[@i_380]) && ((x4_298 = x4_262[@i_380]) && (x5_297 = x5_261[@i_380]))))) then
    (
      let auth_u: hash1 = r_260[@i_380] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, Y[@i_140], K_u)
    )
    orfind @i_379 <= NS suchthat defined(x1_271[@i_379], x2_270[@i_379], x3_269[@i_379], x4_268[@i_379], x5_267[@i_379], r_266[@i_379]) && otheruses(r_266[@i_379]) && ((x1_301 = x1_271[@i_379]) && ((x2_300 = x2_270[@i_379]) && ((x3_299 = x3_269[@i_379]) && ((x4_298 = x4_268[@i_379]) && (x5_297 = x5_267[@i_379]))))) then
    (
      let auth_u: hash1 = r_266[@i_379] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, Y[@i_140], K_u)
    )
    orfind @i_378 <= NU suchthat defined(x1_277[@i_378], x2_276[@i_378], x3_275[@i_378], x4_274[@i_378], x5_273[@i_378], r_272[@i_378]) && otheruses(r_272[@i_378]) && ((x1_301 = x1_277[@i_378]) && ((x2_300 = x2_276[@i_378]) && ((x3_299 = x3_275[@i_378]) && ((x4_298 = x4_274[@i_378]) && (x5_297 = x5_273[@i_378]))))) then
    (
      let auth_u: hash1 = r_272[@i_378] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, Y[@i_140], K_u)
    )
    orfind @i_377 <= NU suchthat defined(x1_283[@i_377], x2_282[@i_377], x3_281[@i_377], x4_280[@i_377], x5_279[@i_377], r_278[@i_377]) && otheruses(r_278[@i_377]) && ((x1_301 = x1_283[@i_377]) && ((x2_300 = x2_282[@i_377]) && ((x3_299 = x3_281[@i_377]) && ((x4_298 = x4_280[@i_377]) && (x5_297 = x5_279[@i_377]))))) then
    (
      let auth_u: hash1 = r_278[@i_377] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, Y[@i_140], K_u)
    )
    orfind @i_376 <= NU suchthat defined(x1_289[@i_376], x2_288[@i_376], x3_287[@i_376], x4_286[@i_376], x5_285[@i_376], r_284[@i_376]) && otheruses(r_284[@i_376]) && ((x1_301 = x1_289[@i_376]) && ((x2_300 = x2_288[@i_376]) && ((x3_299 = x3_287[@i_376]) && ((x4_298 = x4_286[@i_376]) && (x5_297 = x5_285[@i_376]))))) then
    (
      let auth_u: hash1 = r_284[@i_376] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, Y[@i_140], K_u)
    )
    orfind @i_375 <= NU suchthat defined(x1_295[@i_375], x2_294[@i_375], x3_293[@i_375], x4_292[@i_375], x5_291[@i_375], r_290[@i_375]) && otheruses(r_290[@i_375]) && ((x1_301 = x1_295[@i_375]) && ((x2_300 = x2_294[@i_375]) && ((x3_299 = x3_293[@i_375]) && ((x4_298 = x4_292[@i_375]) && (x5_297 = x5_291[@i_375]))))) then
    (
      let auth_u: hash1 = r_290[@i_375] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, Y[@i_140], K_u)
    )
    orfind @i_374 <= NU suchthat defined(x1_301[@i_374], x2_300[@i_374], x3_299[@i_374], x4_298[@i_374], x5_297[@i_374], r_296[@i_374]) && otheruses(r_296[@i_374]) && ((x1_301 = x1_301[@i_374]) && ((x2_300 = x2_300[@i_374]) && ((x3_299 = x3_299[@i_374]) && ((x4_298 = x4_298[@i_374]) && (x5_297 = x5_297[@i_374]))))) then
    (
      let auth_u: hash1 = r_296[@i_374] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, Y[@i_140], K_u)
    )
    else
    (
      new r_296: hash1;
      let auth_u: hash1 = r_296 in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, Y[@i_140], K_u)
    )
  )
  else
  (
    new @2_r4_96: G;
    let K_u: G = exp(@2_r4_96, x) in
    let x1_277: host = U in
    let x2_276: host = S in
    let x3_275: G = X in
    let x4_274: G = @2_r4_96 in
    let x5_273: G = K_u in
    find [unique] @i_346 <= qH1 suchthat defined(x1_253[@i_346], x2_252[@i_346], x3_251[@i_346], x4_250[@i_346], x5_249[@i_346], r_248[@i_346]) && otheruses(r_248[@i_346]) && ((x1_277 = x1_253[@i_346]) && ((x2_276 = x2_252[@i_346]) && ((x3_275 = x3_251[@i_346]) && ((x4_274 = x4_250[@i_346]) && (x5_273 = x5_249[@i_346]))))) then
    (
      let auth_u: hash1 = r_248[@i_346] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_96, K_u)
    )
    orfind @i_345 <= NP suchthat defined(x1_259[@i_345], x2_258[@i_345], x3_257[@i_345], x4_256[@i_345], x5_255[@i_345], r_254[@i_345]) && otheruses(r_254[@i_345]) && ((x1_277 = x1_259[@i_345]) && ((x2_276 = x2_258[@i_345]) && ((x3_275 = x3_257[@i_345]) && ((x4_274 = x4_256[@i_345]) && (x5_273 = x5_255[@i_345]))))) then
    (
      let auth_u: hash1 = r_254[@i_345] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_96, K_u)
    )
    orfind @i_344 <= NS suchthat defined(x1_265[@i_344], x2_264[@i_344], x3_263[@i_344], x4_262[@i_344], x5_261[@i_344], r_260[@i_344]) && otheruses(r_260[@i_344]) && ((x1_277 = x1_265[@i_344]) && ((x2_276 = x2_264[@i_344]) && ((x3_275 = x3_263[@i_344]) && ((x4_274 = x4_262[@i_344]) && (x5_273 = x5_261[@i_344]))))) then
    (
      let auth_u: hash1 = r_260[@i_344] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_96, K_u)
    )
    orfind @i_343 <= NS suchthat defined(x1_271[@i_343], x2_270[@i_343], x3_269[@i_343], x4_268[@i_343], x5_267[@i_343], r_266[@i_343]) && otheruses(r_266[@i_343]) && ((x1_277 = x1_271[@i_343]) && ((x2_276 = x2_270[@i_343]) && ((x3_275 = x3_269[@i_343]) && ((x4_274 = x4_268[@i_343]) && (x5_273 = x5_267[@i_343]))))) then
    (
      let auth_u: hash1 = r_266[@i_343] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_96, K_u)
    )
    orfind @i_342 <= NU suchthat defined(x1_277[@i_342], x2_276[@i_342], x3_275[@i_342], x4_274[@i_342], x5_273[@i_342], r_272[@i_342]) && otheruses(r_272[@i_342]) && ((x1_277 = x1_277[@i_342]) && ((x2_276 = x2_276[@i_342]) && ((x3_275 = x3_275[@i_342]) && ((x4_274 = x4_274[@i_342]) && (x5_273 = x5_273[@i_342]))))) then
    (
      let auth_u: hash1 = r_272[@i_342] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_96, K_u)
    )
    orfind @i_341 <= NU suchthat defined(x1_283[@i_341], x2_282[@i_341], x3_281[@i_341], x4_280[@i_341], x5_279[@i_341], r_278[@i_341]) && otheruses(r_278[@i_341]) && ((x1_277 = x1_283[@i_341]) && ((x2_276 = x2_282[@i_341]) && ((x3_275 = x3_281[@i_341]) && ((x4_274 = x4_280[@i_341]) && (x5_273 = x5_279[@i_341]))))) then
    (
      let auth_u: hash1 = r_278[@i_341] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_96, K_u)
    )
    orfind @i_340 <= NU suchthat defined(x1_289[@i_340], x2_288[@i_340], x3_287[@i_340], x4_286[@i_340], x5_285[@i_340], r_284[@i_340]) && otheruses(r_284[@i_340]) && ((x1_277 = x1_289[@i_340]) && ((x2_276 = x2_288[@i_340]) && ((x3_275 = x3_287[@i_340]) && ((x4_274 = x4_286[@i_340]) && (x5_273 = x5_285[@i_340]))))) then
    (
      let auth_u: hash1 = r_284[@i_340] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_96, K_u)
    )
    orfind @i_339 <= NU suchthat defined(x1_295[@i_339], x2_294[@i_339], x3_293[@i_339], x4_292[@i_339], x5_291[@i_339], r_290[@i_339]) && otheruses(r_290[@i_339]) && ((x1_277 = x1_295[@i_339]) && ((x2_276 = x2_294[@i_339]) && ((x3_275 = x3_293[@i_339]) && ((x4_274 = x4_292[@i_339]) && (x5_273 = x5_291[@i_339]))))) then
    (
      let auth_u: hash1 = r_290[@i_339] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_96, K_u)
    )
    orfind @i_338 <= NU suchthat defined(x1_301[@i_338], x2_300[@i_338], x3_299[@i_338], x4_298[@i_338], x5_297[@i_338], r_296[@i_338]) && otheruses(r_296[@i_338]) && ((x1_277 = x1_301[@i_338]) && ((x2_276 = x2_300[@i_338]) && ((x3_275 = x3_299[@i_338]) && ((x4_274 = x4_298[@i_338]) && (x5_273 = x5_297[@i_338]))))) then
    (
      let auth_u: hash1 = r_296[@i_338] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_96, K_u)
    )
    else
    (
      new r_272: hash1;
      let auth_u: hash1 = r_272 in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_96, K_u)
    )
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let @2_x_95: G = cst_G in
  let @2_ke_94: passwd = cst_passwd in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_271: host = U in
    let x2_270: host = S in
    let x3_269: G = X_s in
    let x4_268: G = Y in
    let x5_267: G = K_s in
    find [unique] @i_337 <= qH1 suchthat defined(x1_253[@i_337], x2_252[@i_337], x3_251[@i_337], x4_250[@i_337], x5_249[@i_337], r_248[@i_337]) && otheruses(r_248[@i_337]) && ((x1_271 = x1_253[@i_337]) && ((x2_270 = x2_252[@i_337]) && ((x3_269 = x3_251[@i_337]) && ((x4_268 = x4_250[@i_337]) && (x5_267 = x5_249[@i_337]))))) then
    (
      if (auth_s = r_248[@i_337]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
    )
    orfind @i_336 <= NP suchthat defined(x1_259[@i_336], x2_258[@i_336], x3_257[@i_336], x4_256[@i_336], x5_255[@i_336], r_254[@i_336]) && otheruses(r_254[@i_336]) && ((x1_271 = x1_259[@i_336]) && ((x2_270 = x2_258[@i_336]) && ((x3_269 = x3_257[@i_336]) && ((x4_268 = x4_256[@i_336]) && (x5_267 = x5_255[@i_336]))))) then
    (
      if (auth_s = r_254[@i_336]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
    )
    orfind @i_335 <= NS suchthat defined(x1_265[@i_335], x2_264[@i_335], x3_263[@i_335], x4_262[@i_335], x5_261[@i_335], r_260[@i_335]) && otheruses(r_260[@i_335]) && ((x1_271 = x1_265[@i_335]) && ((x2_270 = x2_264[@i_335]) && ((x3_269 = x3_263[@i_335]) && ((x4_268 = x4_262[@i_335]) && (x5_267 = x5_261[@i_335]))))) then
    (
      if (auth_s = r_260[@i_335]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
    )
    orfind @i_334 <= NS suchthat defined(x1_271[@i_334], x2_270[@i_334], x3_269[@i_334], x4_268[@i_334], x5_267[@i_334], r_266[@i_334]) && otheruses(r_266[@i_334]) && ((x1_271 = x1_271[@i_334]) && ((x2_270 = x2_270[@i_334]) && ((x3_269 = x3_269[@i_334]) && ((x4_268 = x4_268[@i_334]) && (x5_267 = x5_267[@i_334]))))) then
    (
      if (auth_s = r_266[@i_334]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
    )
    orfind @i_333 <= NU suchthat defined(x1_277[@i_333], x2_276[@i_333], x3_275[@i_333], x4_274[@i_333], x5_273[@i_333], r_272[@i_333]) && otheruses(r_272[@i_333]) && ((x1_271 = x1_277[@i_333]) && ((x2_270 = x2_276[@i_333]) && ((x3_269 = x3_275[@i_333]) && ((x4_268 = x4_274[@i_333]) && (x5_267 = x5_273[@i_333]))))) then
    (
      if (auth_s = r_272[@i_333]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
    )
    orfind @i_332 <= NU suchthat defined(x1_283[@i_332], x2_282[@i_332], x3_281[@i_332], x4_280[@i_332], x5_279[@i_332], r_278[@i_332]) && otheruses(r_278[@i_332]) && ((x1_271 = x1_283[@i_332]) && ((x2_270 = x2_282[@i_332]) && ((x3_269 = x3_281[@i_332]) && ((x4_268 = x4_280[@i_332]) && (x5_267 = x5_279[@i_332]))))) then
    (
      if (auth_s = r_278[@i_332]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
    )
    orfind @i_331 <= NU suchthat defined(x1_289[@i_331], x2_288[@i_331], x3_287[@i_331], x4_286[@i_331], x5_285[@i_331], r_284[@i_331]) && otheruses(r_284[@i_331]) && ((x1_271 = x1_289[@i_331]) && ((x2_270 = x2_288[@i_331]) && ((x3_269 = x3_287[@i_331]) && ((x4_268 = x4_286[@i_331]) && (x5_267 = x5_285[@i_331]))))) then
    (
      if (auth_s = r_284[@i_331]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
    )
    orfind @i_330 <= NU suchthat defined(x1_295[@i_330], x2_294[@i_330], x3_293[@i_330], x4_292[@i_330], x5_291[@i_330], r_290[@i_330]) && otheruses(r_290[@i_330]) && ((x1_271 = x1_295[@i_330]) && ((x2_270 = x2_294[@i_330]) && ((x3_269 = x3_293[@i_330]) && ((x4_268 = x4_292[@i_330]) && (x5_267 = x5_291[@i_330]))))) then
    (
      if (auth_s = r_290[@i_330]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
    )
    orfind @i_329 <= NU suchthat defined(x1_301[@i_329], x2_300[@i_329], x3_299[@i_329], x4_298[@i_329], x5_297[@i_329], r_296[@i_329]) && otheruses(r_296[@i_329]) && ((x1_271 = x1_301[@i_329]) && ((x2_270 = x2_300[@i_329]) && ((x3_269 = x3_299[@i_329]) && ((x4_268 = x4_298[@i_329]) && (x5_267 = x5_297[@i_329]))))) then
    (
      if (auth_s = r_296[@i_329]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
    )
    else
    (
      new r_266: hash1;
      if (auth_s = r_266) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
    )
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    (
      event Auth
    )
    else
    (
      let K_s: G = exp(X_s, y) in
      let x1_265: host = U in
      let x2_264: host = S in
      let x3_263: G = X_s in
      let x4_262: G = Y in
      let x5_261: G = K_s in
      find [unique] @i_328 <= qH1 suchthat defined(x1_253[@i_328], x2_252[@i_328], x3_251[@i_328], x4_250[@i_328], x5_249[@i_328], r_248[@i_328]) && otheruses(r_248[@i_328]) && ((x1_265 = x1_253[@i_328]) && ((x2_264 = x2_252[@i_328]) && ((x3_263 = x3_251[@i_328]) && ((x4_262 = x4_250[@i_328]) && (x5_261 = x5_249[@i_328]))))) then
      (
        if (auth_s = r_248[@i_328]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
      )
      orfind @i_327 <= NP suchthat defined(x1_259[@i_327], x2_258[@i_327], x3_257[@i_327], x4_256[@i_327], x5_255[@i_327], r_254[@i_327]) && otheruses(r_254[@i_327]) && ((x1_265 = x1_259[@i_327]) && ((x2_264 = x2_258[@i_327]) && ((x3_263 = x3_257[@i_327]) && ((x4_262 = x4_256[@i_327]) && (x5_261 = x5_255[@i_327]))))) then
      (
        if (auth_s = r_254[@i_327]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
      )
      orfind @i_326 <= NS suchthat defined(x1_265[@i_326], x2_264[@i_326], x3_263[@i_326], x4_262[@i_326], x5_261[@i_326], r_260[@i_326]) && otheruses(r_260[@i_326]) && ((x1_265 = x1_265[@i_326]) && ((x2_264 = x2_264[@i_326]) && ((x3_263 = x3_263[@i_326]) && ((x4_262 = x4_262[@i_326]) && (x5_261 = x5_261[@i_326]))))) then
      (
        if (auth_s = r_260[@i_326]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
      )
      orfind @i_325 <= NS suchthat defined(x1_271[@i_325], x2_270[@i_325], x3_269[@i_325], x4_268[@i_325], x5_267[@i_325], r_266[@i_325]) && otheruses(r_266[@i_325]) && ((x1_265 = x1_271[@i_325]) && ((x2_264 = x2_270[@i_325]) && ((x3_263 = x3_269[@i_325]) && ((x4_262 = x4_268[@i_325]) && (x5_261 = x5_267[@i_325]))))) then
      (
        if (auth_s = r_266[@i_325]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
      )
      orfind @i_324 <= NU suchthat defined(x1_277[@i_324], x2_276[@i_324], x3_275[@i_324], x4_274[@i_324], x5_273[@i_324], r_272[@i_324]) && otheruses(r_272[@i_324]) && ((x1_265 = x1_277[@i_324]) && ((x2_264 = x2_276[@i_324]) && ((x3_263 = x3_275[@i_324]) && ((x4_262 = x4_274[@i_324]) && (x5_261 = x5_273[@i_324]))))) then
      (
        if (auth_s = r_272[@i_324]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
      )
      orfind @i_323 <= NU suchthat defined(x1_283[@i_323], x2_282[@i_323], x3_281[@i_323], x4_280[@i_323], x5_279[@i_323], r_278[@i_323]) && otheruses(r_278[@i_323]) && ((x1_265 = x1_283[@i_323]) && ((x2_264 = x2_282[@i_323]) && ((x3_263 = x3_281[@i_323]) && ((x4_262 = x4_280[@i_323]) && (x5_261 = x5_279[@i_323]))))) then
      (
        if (auth_s = r_278[@i_323]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
      )
      orfind @i_322 <= NU suchthat defined(x1_289[@i_322], x2_288[@i_322], x3_287[@i_322], x4_286[@i_322], x5_285[@i_322], r_284[@i_322]) && otheruses(r_284[@i_322]) && ((x1_265 = x1_289[@i_322]) && ((x2_264 = x2_288[@i_322]) && ((x3_263 = x3_287[@i_322]) && ((x4_262 = x4_286[@i_322]) && (x5_261 = x5_285[@i_322]))))) then
      (
        if (auth_s = r_284[@i_322]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
      )
      orfind @i_321 <= NU suchthat defined(x1_295[@i_321], x2_294[@i_321], x3_293[@i_321], x4_292[@i_321], x5_291[@i_321], r_290[@i_321]) && otheruses(r_290[@i_321]) && ((x1_265 = x1_295[@i_321]) && ((x2_264 = x2_294[@i_321]) && ((x3_263 = x3_293[@i_321]) && ((x4_262 = x4_292[@i_321]) && (x5_261 = x5_291[@i_321]))))) then
      (
        if (auth_s = r_290[@i_321]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
      )
      orfind @i_320 <= NU suchthat defined(x1_301[@i_320], x2_300[@i_320], x3_299[@i_320], x4_298[@i_320], x5_297[@i_320], r_296[@i_320]) && otheruses(r_296[@i_320]) && ((x1_265 = x1_301[@i_320]) && ((x2_264 = x2_300[@i_320]) && ((x3_263 = x3_299[@i_320]) && ((x4_262 = x4_298[@i_320]) && (x5_261 = x5_297[@i_320]))))) then
      (
        if (auth_s = r_296[@i_320]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
      )
      else
      (
        new r_260: hash1;
        if (auth_s = r_260) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
      )
    )
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let @2_x_92: G = cst_G in
  let @2_ke_91: passwd = cst_passwd in
  new @2_r2_90: G;
  let x1_259: host = U in
  let x2_258: host = S in
  let x3_257: G = Xp in
  let x4_256: G = Yp in
  let x5_255: G = Kp in
  find [unique] @i_319 <= qH1 suchthat defined(x1_253[@i_319], x2_252[@i_319], x3_251[@i_319], x4_250[@i_319], x5_249[@i_319], r_248[@i_319]) && otheruses(r_248[@i_319]) && ((x1_259 = x1_253[@i_319]) && ((x2_258 = x2_252[@i_319]) && ((x3_257 = x3_251[@i_319]) && ((x4_256 = x4_250[@i_319]) && (x5_255 = x5_249[@i_319]))))) then
  (
    let authp: hash1 = r_248[@i_319] in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_55], (U, Xp, S, @2_r2_90, authp))
  )
  orfind @i_318 <= NP suchthat defined(x1_259[@i_318], x2_258[@i_318], x3_257[@i_318], x4_256[@i_318], x5_255[@i_318], r_254[@i_318]) && otheruses(r_254[@i_318]) && ((x1_259 = x1_259[@i_318]) && ((x2_258 = x2_258[@i_318]) && ((x3_257 = x3_257[@i_318]) && ((x4_256 = x4_256[@i_318]) && (x5_255 = x5_255[@i_318]))))) then
  (
    let authp: hash1 = r_254[@i_318] in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_55], (U, Xp, S, @2_r2_90, authp))
  )
  orfind @i_317 <= NS suchthat defined(x1_265[@i_317], x2_264[@i_317], x3_263[@i_317], x4_262[@i_317], x5_261[@i_317], r_260[@i_317]) && otheruses(r_260[@i_317]) && ((x1_259 = x1_265[@i_317]) && ((x2_258 = x2_264[@i_317]) && ((x3_257 = x3_263[@i_317]) && ((x4_256 = x4_262[@i_317]) && (x5_255 = x5_261[@i_317]))))) then
  (
    let authp: hash1 = r_260[@i_317] in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_55], (U, Xp, S, @2_r2_90, authp))
  )
  orfind @i_316 <= NS suchthat defined(x1_271[@i_316], x2_270[@i_316], x3_269[@i_316], x4_268[@i_316], x5_267[@i_316], r_266[@i_316]) && otheruses(r_266[@i_316]) && ((x1_259 = x1_271[@i_316]) && ((x2_258 = x2_270[@i_316]) && ((x3_257 = x3_269[@i_316]) && ((x4_256 = x4_268[@i_316]) && (x5_255 = x5_267[@i_316]))))) then
  (
    let authp: hash1 = r_266[@i_316] in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_55], (U, Xp, S, @2_r2_90, authp))
  )
  orfind @i_315 <= NU suchthat defined(x1_277[@i_315], x2_276[@i_315], x3_275[@i_315], x4_274[@i_315], x5_273[@i_315], r_272[@i_315]) && otheruses(r_272[@i_315]) && ((x1_259 = x1_277[@i_315]) && ((x2_258 = x2_276[@i_315]) && ((x3_257 = x3_275[@i_315]) && ((x4_256 = x4_274[@i_315]) && (x5_255 = x5_273[@i_315]))))) then
  (
    let authp: hash1 = r_272[@i_315] in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_55], (U, Xp, S, @2_r2_90, authp))
  )
  orfind @i_314 <= NU suchthat defined(x1_283[@i_314], x2_282[@i_314], x3_281[@i_314], x4_280[@i_314], x5_279[@i_314], r_278[@i_314]) && otheruses(r_278[@i_314]) && ((x1_259 = x1_283[@i_314]) && ((x2_258 = x2_282[@i_314]) && ((x3_257 = x3_281[@i_314]) && ((x4_256 = x4_280[@i_314]) && (x5_255 = x5_279[@i_314]))))) then
  (
    let authp: hash1 = r_278[@i_314] in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_55], (U, Xp, S, @2_r2_90, authp))
  )
  orfind @i_313 <= NU suchthat defined(x1_289[@i_313], x2_288[@i_313], x3_287[@i_313], x4_286[@i_313], x5_285[@i_313], r_284[@i_313]) && otheruses(r_284[@i_313]) && ((x1_259 = x1_289[@i_313]) && ((x2_258 = x2_288[@i_313]) && ((x3_257 = x3_287[@i_313]) && ((x4_256 = x4_286[@i_313]) && (x5_255 = x5_285[@i_313]))))) then
  (
    let authp: hash1 = r_284[@i_313] in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_55], (U, Xp, S, @2_r2_90, authp))
  )
  orfind @i_312 <= NU suchthat defined(x1_295[@i_312], x2_294[@i_312], x3_293[@i_312], x4_292[@i_312], x5_291[@i_312], r_290[@i_312]) && otheruses(r_290[@i_312]) && ((x1_259 = x1_295[@i_312]) && ((x2_258 = x2_294[@i_312]) && ((x3_257 = x3_293[@i_312]) && ((x4_256 = x4_292[@i_312]) && (x5_255 = x5_291[@i_312]))))) then
  (
    let authp: hash1 = r_290[@i_312] in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_55], (U, Xp, S, @2_r2_90, authp))
  )
  orfind @i_311 <= NU suchthat defined(x1_301[@i_311], x2_300[@i_311], x3_299[@i_311], x4_298[@i_311], x5_297[@i_311], r_296[@i_311]) && otheruses(r_296[@i_311]) && ((x1_259 = x1_301[@i_311]) && ((x2_258 = x2_300[@i_311]) && ((x3_257 = x3_299[@i_311]) && ((x4_256 = x4_298[@i_311]) && (x5_255 = x5_297[@i_311]))))) then
  (
    let authp: hash1 = r_296[@i_311] in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_55], (U, Xp, S, @2_r2_90, authp))
  )
  else
  (
    new r_254: hash1;
    let authp: hash1 = r_254 in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_55], (U, Xp, S, @2_r2_90, authp))
  )
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  let @2_x_89: G = cst_G in
  let @2_ke_88: passwd = cst_passwd in
  find [unique] @i_118 <= qD suchthat defined(@2_kd[@i_118], @2_m[@i_118], @2_m_86[@i_118], @2_kd_85[@i_118], @2_r4_84[@i_118]) && otheruses(@2_r4_84[@i_118]) && ((@2_x = @2_r4_84[@i_118]) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_114 <= NU suchthat defined(pw, Ystar_u[@i_114], @2_m_98[@i_114], @2_kd_97[@i_114], @2_r4_96[@i_114]) && otheruses(@2_r4_96[@i_114]) && ((@2_x = @2_r4_96[@i_114]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], Ystar_u[@i_114])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_ke_88[@i_112], @2_x_89[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(Yp[@i_111], pw, @2_ke_91[@i_111], @2_x_92[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = Yp[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], pw, @2_ke_94[@i_110], @2_x_95[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  let @2_m_86: G = cst_G in
  let @2_kd_85: passwd = cst_passwd in
  find [unique] @i_108 <= qD suchthat defined(@2_m[@i_108], @2_kd[@i_108], @2_kd_85[@i_108], @2_m_86[@i_108], @2_r4_84[@i_108]) && otheruses(@2_r4_84[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], @2_r4_84[@i_108])
  )
  orfind @i_104 <= NU suchthat defined(Ystar_u[@i_104], pw, @2_kd_97[@i_104], @2_m_98[@i_104], @2_r4_96[@i_104]) && otheruses(@2_r4_96[@i_104]) && ((@2_m = Ystar_u[@i_104]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], @2_r4_96[@i_104])
  )
  orfind @i_102 <= qE suchthat defined(@2_ke[@i_102], @2_x[@i_102], @2_x_89[@i_102], @2_ke_88[@i_102], @2_r2_87[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(pw, Yp[@i_101], @2_x_92[@i_101], @2_ke_91[@i_101], @2_r2_90[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Yp[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(pw, Y[@i_100], @2_x_95[@i_100], @2_ke_94[@i_100], @2_r2_93[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @2_r4_84: G;
    out(@2_c4[!_57], @2_r4_84)
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  out(c20[!_58], h0(x1_69, x2_68, x3_67, x4_66, x5_65))
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  let x1_253: host = x1_64 in
  let x2_252: host = x2_63 in
  let x3_251: G = x3_62 in
  let x4_250: G = x4_61 in
  let x5_249: G = x5_60 in
  find [unique] @i_310 <= qH1 suchthat defined(x1_253[@i_310], x2_252[@i_310], x3_251[@i_310], x4_250[@i_310], x5_249[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_253 = x1_253[@i_310]) && ((x2_252 = x2_252[@i_310]) && ((x3_251 = x3_251[@i_310]) && ((x4_250 = x4_250[@i_310]) && (x5_249 = x5_249[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  orfind @i_309 <= NP suchthat defined(x1_259[@i_309], x2_258[@i_309], x3_257[@i_309], x4_256[@i_309], x5_255[@i_309], r_254[@i_309]) && otheruses(r_254[@i_309]) && ((x1_253 = x1_259[@i_309]) && ((x2_252 = x2_258[@i_309]) && ((x3_251 = x3_257[@i_309]) && ((x4_250 = x4_256[@i_309]) && (x5_249 = x5_255[@i_309]))))) then
  (
    out(c21[!_59], r_254[@i_309])
  )
  orfind @i_308 <= NS suchthat defined(x1_265[@i_308], x2_264[@i_308], x3_263[@i_308], x4_262[@i_308], x5_261[@i_308], r_260[@i_308]) && otheruses(r_260[@i_308]) && ((x1_253 = x1_265[@i_308]) && ((x2_252 = x2_264[@i_308]) && ((x3_251 = x3_263[@i_308]) && ((x4_250 = x4_262[@i_308]) && (x5_249 = x5_261[@i_308]))))) then
  (
    out(c21[!_59], r_260[@i_308])
  )
  orfind @i_307 <= NS suchthat defined(x1_271[@i_307], x2_270[@i_307], x3_269[@i_307], x4_268[@i_307], x5_267[@i_307], r_266[@i_307]) && otheruses(r_266[@i_307]) && ((x1_253 = x1_271[@i_307]) && ((x2_252 = x2_270[@i_307]) && ((x3_251 = x3_269[@i_307]) && ((x4_250 = x4_268[@i_307]) && (x5_249 = x5_267[@i_307]))))) then
  (
    out(c21[!_59], r_266[@i_307])
  )
  orfind @i_306 <= NU suchthat defined(x1_277[@i_306], x2_276[@i_306], x3_275[@i_306], x4_274[@i_306], x5_273[@i_306], r_272[@i_306]) && otheruses(r_272[@i_306]) && ((x1_253 = x1_277[@i_306]) && ((x2_252 = x2_276[@i_306]) && ((x3_251 = x3_275[@i_306]) && ((x4_250 = x4_274[@i_306]) && (x5_249 = x5_273[@i_306]))))) then
  (
    out(c21[!_59], r_272[@i_306])
  )
  orfind @i_305 <= NU suchthat defined(x1_283[@i_305], x2_282[@i_305], x3_281[@i_305], x4_280[@i_305], x5_279[@i_305], r_278[@i_305]) && otheruses(r_278[@i_305]) && ((x1_253 = x1_283[@i_305]) && ((x2_252 = x2_282[@i_305]) && ((x3_251 = x3_281[@i_305]) && ((x4_250 = x4_280[@i_305]) && (x5_249 = x5_279[@i_305]))))) then
  (
    out(c21[!_59], r_278[@i_305])
  )
  orfind @i_304 <= NU suchthat defined(x1_289[@i_304], x2_288[@i_304], x3_287[@i_304], x4_286[@i_304], x5_285[@i_304], r_284[@i_304]) && otheruses(r_284[@i_304]) && ((x1_253 = x1_289[@i_304]) && ((x2_252 = x2_288[@i_304]) && ((x3_251 = x3_287[@i_304]) && ((x4_250 = x4_286[@i_304]) && (x5_249 = x5_285[@i_304]))))) then
  (
    out(c21[!_59], r_284[@i_304])
  )
  orfind @i_303 <= NU suchthat defined(x1_295[@i_303], x2_294[@i_303], x3_293[@i_303], x4_292[@i_303], x5_291[@i_303], r_290[@i_303]) && otheruses(r_290[@i_303]) && ((x1_253 = x1_295[@i_303]) && ((x2_252 = x2_294[@i_303]) && ((x3_251 = x3_293[@i_303]) && ((x4_250 = x4_292[@i_303]) && (x5_249 = x5_291[@i_303]))))) then
  (
    out(c21[!_59], r_290[@i_303])
  )
  orfind @i_302 <= NU suchthat defined(x1_301[@i_302], x2_300[@i_302], x3_299[@i_302], x4_298[@i_302], x5_297[@i_302], r_296[@i_302]) && otheruses(r_296[@i_302]) && ((x1_253 = x1_301[@i_302]) && ((x2_252 = x2_300[@i_302]) && ((x3_251 = x3_299[@i_302]) && ((x4_250 = x4_298[@i_302]) && (x5_249 = x5_297[@i_302]))))) then
  (
    out(c21[!_59], r_296[@i_302])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying simplify [Excluding set(dist 9->10, proba <= 1. / |exponent| * NP + 7. * 1. / |exponent| * NS + 9. * 1. / |exponent| * NU + 11. * NP * NU / |exponent| + 4. * NP * NS / |exponent| + 2. * NP * qH1 / |exponent| + 2. * NS / |hash1| + 2. * NS * NU / |exponent| + NS * qD / |exponent| + 4.5 * NU * NU / |G| + 3. * NU * NS / |G| + 2. * NU * NP / |G| + NU * qH1 / |G| + NP * qD / |exponent| + qD * NS / |G| + qD * NP / |G| + 1.5 * NP * NP / |exponent| + 2. * NS * NP / |exponent| + 0.5 * NU * NU / |exponent| + 2. * NU * NP / |exponent| + NU * qD / |G| + 0.5 * qD * qD / |G|)] yields

Game 10 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  let @2_m_98: G = cst_G in
  let @2_kd_97: passwd = cst_passwd in
  find [unique] @i_148 <= qD suchthat defined(@2_m[@i_148], @2_kd[@i_148], @2_r4_84[@i_148]) && otheruses(@2_r4_84[@i_148]) && ((Ystar_u = @2_m[@i_148]) && (pw = @2_kd[@i_148])) then
  (
    let K_u: G = exp(@2_r4_84[@i_148], x) in
    let x1_283: host = U in
    let x2_282: host = S in
    let x3_281: G = X in
    let x4_280: G = @2_r4_84[@i_148] in
    let x5_279: G = K_u in
    find [unique] @i_355 <= qH1 suchthat defined(x1_253[@i_355], x2_252[@i_355], x3_251[@i_355], x4_250[@i_355], x5_249[@i_355], r_248[@i_355]) && otheruses(r_248[@i_355]) && ((x1_283 = x1_253[@i_355]) && ((x2_282 = x2_252[@i_355]) && ((x3_281 = x3_251[@i_355]) && ((x4_280 = x4_250[@i_355]) && (x5_279 = x5_249[@i_355]))))) then
    (
      let auth_u: hash1 = r_248[@i_355] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_84[@i_148], K_u)
    )
    else
    (
      new r_278: hash1;
      let auth_u: hash1 = r_278 in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_84[@i_148], K_u)
    )
  )
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], @2_r4_96[@i_144]) && otheruses(@2_r4_96[@i_144]) && (Ystar_u = Ystar_u[@i_144]) then
  (
    let K_u: G = exp(@2_r4_96[@i_144], x) in
    let x1_289: host = U in
    let x2_288: host = S in
    let x3_287: G = X in
    let x4_286: G = @2_r4_96[@i_144] in
    let x5_285: G = K_u in
    find [unique] @i_364 <= qH1 suchthat defined(x1_253[@i_364], x2_252[@i_364], x3_251[@i_364], x4_250[@i_364], x5_249[@i_364], r_248[@i_364]) && otheruses(r_248[@i_364]) && ((x1_289 = x1_253[@i_364]) && ((x2_288 = x2_252[@i_364]) && ((x3_287 = x3_251[@i_364]) && ((x4_286 = x4_250[@i_364]) && (x5_285 = x5_249[@i_364]))))) then
    (
      let auth_u: hash1 = r_248[@i_364] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_96[@i_144], K_u)
    )
    else
    (
      new r_284: hash1;
      let auth_u: hash1 = r_284 in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_96[@i_144], K_u)
    )
  )
  orfind @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  orfind @i_141 <= NP suchthat defined(@2_r2_90[@i_141], yp[@i_141], Yp[@i_141]) && otheruses(@2_r2_90[@i_141]) && (Ystar_u = @2_r2_90[@i_141]) then
  (
    let K_u: G = exp(g, mult(yp[@i_141], x)) in
    let x1_295: host = U in
    let x2_294: host = S in
    let x3_293: G = X in
    let x4_292: G = Yp[@i_141] in
    let x5_291: G = K_u in
    find [unique] @i_373 <= qH1 suchthat defined(x1_253[@i_373], x2_252[@i_373], x3_251[@i_373], x4_250[@i_373], x5_249[@i_373], r_248[@i_373]) && otheruses(r_248[@i_373]) && ((x1_295 = x1_253[@i_373]) && ((x2_294 = x2_252[@i_373]) && ((x3_293 = x3_251[@i_373]) && ((x4_292 = x4_250[@i_373]) && (x5_291 = x5_249[@i_373]))))) then
    (
      let auth_u: hash1 = r_248[@i_373] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, Yp[@i_141], K_u)
    )
    else
    (
      new r_290: hash1;
      let auth_u: hash1 = r_290 in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, Yp[@i_141], K_u)
    )
  )
  orfind @i_140 <= NS suchthat defined(@2_r2_93[@i_140], y[@i_140], Y[@i_140]) && otheruses(@2_r2_93[@i_140]) && (Ystar_u = @2_r2_93[@i_140]) then
  (
    let K_u: G = exp(g, mult(y[@i_140], x)) in
    let x1_301: host = U in
    let x2_300: host = S in
    let x3_299: G = X in
    let x4_298: G = Y[@i_140] in
    let x5_297: G = K_u in
    find [unique] @i_382 <= qH1 suchthat defined(x1_253[@i_382], x2_252[@i_382], x3_251[@i_382], x4_250[@i_382], x5_249[@i_382], r_248[@i_382]) && otheruses(r_248[@i_382]) && ((x1_301 = x1_253[@i_382]) && ((x2_300 = x2_252[@i_382]) && ((x3_299 = x3_251[@i_382]) && ((x4_298 = x4_250[@i_382]) && (x5_297 = x5_249[@i_382]))))) then
    (
      let auth_u: hash1 = r_248[@i_382] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, Y[@i_140], K_u)
    )
    else
    (
      new r_296: hash1;
      let auth_u: hash1 = r_296 in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, Y[@i_140], K_u)
    )
  )
  else
  (
    new @2_r4_96: G;
    let K_u: G = exp(@2_r4_96, x) in
    let x1_277: host = U in
    let x2_276: host = S in
    let x3_275: G = X in
    let x4_274: G = @2_r4_96 in
    let x5_273: G = K_u in
    new r_272: hash1;
    let auth_u: hash1 = r_272 in
    out(c6[!_53], auth_u);
    in(c9[!_53], ());
    let sk_u: hash0 = h0(U, S, X, @2_r4_96, K_u)
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let @2_x_95: G = cst_G in
  let @2_ke_94: passwd = cst_passwd in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_271: host = U in
    let x2_270: host = S in
    let x3_269: G = X_s in
    let x4_268: G = Y in
    let x5_267: G = K_s in
    find [unique] @i_337 <= qH1 suchthat defined(x1_253[@i_337], x2_252[@i_337], x3_251[@i_337], x4_250[@i_337], x5_249[@i_337], r_248[@i_337]) && otheruses(r_248[@i_337]) && ((x1_271 = x1_253[@i_337]) && ((x2_270 = x2_252[@i_337]) && ((x3_269 = x3_251[@i_337]) && ((x4_268 = x4_250[@i_337]) && (x5_267 = x5_249[@i_337]))))) then
    (
      if (auth_s = r_248[@i_337]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
    )
    orfind  suchthat defined(@i_140[j], r_296[j]) && otheruses(r_296[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
    (
      let @i_329 <= NU = j in
      if (auth_s = r_296[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
    )
    else
    (
      new r_266: hash1
    )
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    (
      event Auth
    )
    else
    (
      let K_s: G = exp(X_s, y) in
      let x1_265: host = U in
      let x2_264: host = S in
      let x3_263: G = X_s in
      let x4_262: G = Y in
      let x5_261: G = K_s in
      new r_260: hash1
    )
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let @2_x_92: G = cst_G in
  let @2_ke_91: passwd = cst_passwd in
  new @2_r2_90: G;
  let x1_259: host = U in
  let x2_258: host = S in
  let x3_257: G = Xp in
  let x4_256: G = Yp in
  let x5_255: G = Kp in
  new r_254: hash1;
  let authp: hash1 = r_254 in
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_55], (U, Xp, S, @2_r2_90, authp))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  let @2_x_89: G = cst_G in
  let @2_ke_88: passwd = cst_passwd in
  find [unique] @i_118 <= qD suchthat defined(@2_r4_84[@i_118], @2_kd[@i_118], @2_m[@i_118]) && otheruses(@2_r4_84[@i_118]) && ((@2_x = @2_r4_84[@i_118]) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_114 <= NU suchthat defined(@2_r4_96[@i_114], Ystar_u[@i_114]) && otheruses(@2_r4_96[@i_114]) && ((@2_x = @2_r4_96[@i_114]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], Ystar_u[@i_114])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = Yp[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  let @2_m_86: G = cst_G in
  let @2_kd_85: passwd = cst_passwd in
  find [unique] @i_108 <= qD suchthat defined(@2_m[@i_108], @2_kd[@i_108], @2_r4_84[@i_108]) && otheruses(@2_r4_84[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], @2_r4_84[@i_108])
  )
  orfind @i_104 <= NU suchthat defined(Ystar_u[@i_104], @2_r4_96[@i_104]) && otheruses(@2_r4_96[@i_104]) && ((@2_m = Ystar_u[@i_104]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], @2_r4_96[@i_104])
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@2_r2_90[@i_101], Yp[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Yp[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_r2_93[@i_100], Y[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @2_r4_84: G;
    out(@2_c4[!_57], @2_r4_84)
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  out(c20[!_58], h0(x1_69, x2_68, x3_67, x4_66, x5_65))
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  let x1_253: host = x1_64 in
  let x2_252: host = x2_63 in
  let x3_251: G = x3_62 in
  let x4_250: G = x4_61 in
  let x5_249: G = x5_60 in
  find [unique] @i_310 <= qH1 suchthat defined(x1_253[@i_310], x2_252[@i_310], x3_251[@i_310], x4_250[@i_310], x5_249[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_253 = x1_253[@i_310]) && ((x2_252 = x2_252[@i_310]) && ((x3_251 = x3_251[@i_310]) && ((x4_250 = x4_250[@i_310]) && (x5_249 = x5_249[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  orfind @i_309 <= NP suchthat defined(x1_259[@i_309], x2_258[@i_309], x3_257[@i_309], x4_256[@i_309], x5_255[@i_309], r_254[@i_309]) && otheruses(r_254[@i_309]) && ((x1_253 = x1_259[@i_309]) && ((x2_252 = x2_258[@i_309]) && ((x3_251 = x3_257[@i_309]) && ((x4_250 = x4_256[@i_309]) && (x5_249 = x5_255[@i_309]))))) then
  (
    out(c21[!_59], r_254[@i_309])
  )
  orfind @i_306 <= NU suchthat defined(x1_277[@i_306], x2_276[@i_306], x3_275[@i_306], x4_274[@i_306], x5_273[@i_306], r_272[@i_306]) && otheruses(r_272[@i_306]) && ((x1_253 = x1_277[@i_306]) && ((x2_252 = x2_276[@i_306]) && ((x3_251 = x3_275[@i_306]) && ((x4_250 = x4_274[@i_306]) && (x5_249 = x5_273[@i_306]))))) then
  (
    out(c21[!_59], r_272[@i_306])
  )
  orfind @i_305 <= NU suchthat defined(x1_283[@i_305], x2_282[@i_305], x3_281[@i_305], x4_280[@i_305], x5_279[@i_305], r_278[@i_305]) && otheruses(r_278[@i_305]) && ((x1_253 = x1_283[@i_305]) && ((x2_252 = x2_282[@i_305]) && ((x3_251 = x3_281[@i_305]) && ((x4_250 = x4_280[@i_305]) && (x5_249 = x5_279[@i_305]))))) then
  (
    out(c21[!_59], r_278[@i_305])
  )
  orfind @i_304 <= NU suchthat defined(x1_289[@i_304], x2_288[@i_304], x3_287[@i_304], x4_286[@i_304], x5_285[@i_304], r_284[@i_304]) && otheruses(r_284[@i_304]) && ((x1_253 = x1_289[@i_304]) && ((x2_252 = x2_288[@i_304]) && ((x3_251 = x3_287[@i_304]) && ((x4_250 = x4_286[@i_304]) && (x5_249 = x5_285[@i_304]))))) then
  (
    out(c21[!_59], r_284[@i_304])
  )
  orfind @i_303 <= NU suchthat defined(x1_295[@i_303], x2_294[@i_303], x3_293[@i_303], x4_292[@i_303], x5_291[@i_303], r_290[@i_303]) && otheruses(r_290[@i_303]) && ((x1_253 = x1_295[@i_303]) && ((x2_252 = x2_294[@i_303]) && ((x3_251 = x3_293[@i_303]) && ((x4_250 = x4_292[@i_303]) && (x5_249 = x5_291[@i_303]))))) then
  (
    out(c21[!_59], r_290[@i_303])
  )
  orfind @i_302 <= NU suchthat defined(x1_301[@i_302], x2_300[@i_302], x3_299[@i_302], x4_298[@i_302], x5_297[@i_302], r_296[@i_302]) && otheruses(r_296[@i_302]) && ((x1_253 = x1_301[@i_302]) && ((x2_252 = x2_300[@i_302]) && ((x3_251 = x3_299[@i_302]) && ((x4_250 = x4_298[@i_302]) && (x5_249 = x5_297[@i_302]))))) then
  (
    out(c21[!_59], r_296[@i_302])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying move all binders yields

Game 11 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_148 <= qD suchthat defined(@2_m[@i_148], @2_kd[@i_148], @2_r4_84[@i_148]) && otheruses(@2_r4_84[@i_148]) && ((Ystar_u = @2_m[@i_148]) && (pw = @2_kd[@i_148])) then
  (
    let K_u: G = exp(@2_r4_84[@i_148], x) in
    let x1_283: host = U in
    let x2_282: host = S in
    let x3_281: G = X in
    let x4_280: G = @2_r4_84[@i_148] in
    let x5_279: G = K_u in
    find [unique] @i_355 <= qH1 suchthat defined(x1_253[@i_355], x2_252[@i_355], x3_251[@i_355], x4_250[@i_355], x5_249[@i_355], r_248[@i_355]) && otheruses(r_248[@i_355]) && ((x1_283 = x1_253[@i_355]) && ((x2_282 = x2_252[@i_355]) && ((x3_281 = x3_251[@i_355]) && ((x4_280 = x4_250[@i_355]) && (x5_279 = x5_249[@i_355]))))) then
    (
      let auth_u: hash1 = r_248[@i_355] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_84[@i_148], K_u)
    )
    else
    (
      new r_278: hash1;
      let auth_u: hash1 = r_278 in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_84[@i_148], K_u)
    )
  )
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], @2_r4_96[@i_144]) && otheruses(@2_r4_96[@i_144]) && (Ystar_u = Ystar_u[@i_144]) then
  (
    let K_u: G = exp(@2_r4_96[@i_144], x) in
    let x1_289: host = U in
    let x2_288: host = S in
    let x3_287: G = X in
    let x4_286: G = @2_r4_96[@i_144] in
    let x5_285: G = K_u in
    find [unique] @i_364 <= qH1 suchthat defined(x1_253[@i_364], x2_252[@i_364], x3_251[@i_364], x4_250[@i_364], x5_249[@i_364], r_248[@i_364]) && otheruses(r_248[@i_364]) && ((x1_289 = x1_253[@i_364]) && ((x2_288 = x2_252[@i_364]) && ((x3_287 = x3_251[@i_364]) && ((x4_286 = x4_250[@i_364]) && (x5_285 = x5_249[@i_364]))))) then
    (
      let auth_u: hash1 = r_248[@i_364] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_96[@i_144], K_u)
    )
    else
    (
      new r_284: hash1;
      let auth_u: hash1 = r_284 in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_96[@i_144], K_u)
    )
  )
  orfind @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  orfind @i_141 <= NP suchthat defined(@2_r2_90[@i_141], yp[@i_141], Yp[@i_141]) && otheruses(@2_r2_90[@i_141]) && (Ystar_u = @2_r2_90[@i_141]) then
  (
    let K_u: G = exp(g, mult(yp[@i_141], x)) in
    let x1_295: host = U in
    let x2_294: host = S in
    let x3_293: G = X in
    let x4_292: G = Yp[@i_141] in
    let x5_291: G = K_u in
    find [unique] @i_373 <= qH1 suchthat defined(x1_253[@i_373], x2_252[@i_373], x3_251[@i_373], x4_250[@i_373], x5_249[@i_373], r_248[@i_373]) && otheruses(r_248[@i_373]) && ((x1_295 = x1_253[@i_373]) && ((x2_294 = x2_252[@i_373]) && ((x3_293 = x3_251[@i_373]) && ((x4_292 = x4_250[@i_373]) && (x5_291 = x5_249[@i_373]))))) then
    (
      let auth_u: hash1 = r_248[@i_373] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, Yp[@i_141], K_u)
    )
    else
    (
      new r_290: hash1;
      let auth_u: hash1 = r_290 in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, Yp[@i_141], K_u)
    )
  )
  orfind @i_140 <= NS suchthat defined(@2_r2_93[@i_140], y[@i_140], Y[@i_140]) && otheruses(@2_r2_93[@i_140]) && (Ystar_u = @2_r2_93[@i_140]) then
  (
    let K_u: G = exp(g, mult(y[@i_140], x)) in
    let x1_301: host = U in
    let x2_300: host = S in
    let x3_299: G = X in
    let x4_298: G = Y[@i_140] in
    let x5_297: G = K_u in
    find [unique] @i_382 <= qH1 suchthat defined(x1_253[@i_382], x2_252[@i_382], x3_251[@i_382], x4_250[@i_382], x5_249[@i_382], r_248[@i_382]) && otheruses(r_248[@i_382]) && ((x1_301 = x1_253[@i_382]) && ((x2_300 = x2_252[@i_382]) && ((x3_299 = x3_251[@i_382]) && ((x4_298 = x4_250[@i_382]) && (x5_297 = x5_249[@i_382]))))) then
    (
      let auth_u: hash1 = r_248[@i_382] in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, Y[@i_140], K_u)
    )
    else
    (
      new r_296: hash1;
      let auth_u: hash1 = r_296 in
      out(c6[!_53], auth_u);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, Y[@i_140], K_u)
    )
  )
  else
  (
    new @2_r4_96: G;
    let K_u: G = exp(@2_r4_96, x) in
    let x1_277: host = U in
    let x2_276: host = S in
    let x3_275: G = X in
    let x4_274: G = @2_r4_96 in
    let x5_273: G = K_u in
    new r_272: hash1;
    let auth_u: hash1 = r_272 in
    out(c6[!_53], auth_u);
    in(c9[!_53], ());
    let sk_u: hash0 = h0(U, S, X, @2_r4_96, K_u)
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_271: host = U in
    let x2_270: host = S in
    let x3_269: G = X_s in
    let x4_268: G = Y in
    let x5_267: G = K_s in
    find [unique] @i_337 <= qH1 suchthat defined(x1_253[@i_337], x2_252[@i_337], x3_251[@i_337], x4_250[@i_337], x5_249[@i_337], r_248[@i_337]) && otheruses(r_248[@i_337]) && ((x1_271 = x1_253[@i_337]) && ((x2_270 = x2_252[@i_337]) && ((x3_269 = x3_251[@i_337]) && ((x4_268 = x4_250[@i_337]) && (x5_267 = x5_249[@i_337]))))) then
    (
      if (auth_s = r_248[@i_337]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
    )
    orfind  suchthat defined(@i_140[j], r_296[j]) && otheruses(r_296[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
    (
      if (auth_s = r_296[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
    )
    else
    (
      new r_266: hash1
    )
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    (
      event Auth
    )
    else
    (
      let K_s: G = exp(X_s, y) in
      let x1_265: host = U in
      let x2_264: host = S in
      let x3_263: G = X_s in
      let x4_262: G = Y in
      let x5_261: G = K_s in
      new r_260: hash1
    )
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let @2_x_92: G = cst_G in
  let @2_ke_91: passwd = cst_passwd in
  new @2_r2_90: G;
  let x1_259: host = U in
  let x2_258: host = S in
  let x3_257: G = Xp in
  let x4_256: G = Yp in
  let x5_255: G = Kp in
  new r_254: hash1;
  let authp: hash1 = r_254 in
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_55], (U, Xp, S, @2_r2_90, authp))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@2_r4_84[@i_118], @2_kd[@i_118], @2_m[@i_118]) && otheruses(@2_r4_84[@i_118]) && ((@2_x = @2_r4_84[@i_118]) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_114 <= NU suchthat defined(@2_r4_96[@i_114], Ystar_u[@i_114]) && otheruses(@2_r4_96[@i_114]) && ((@2_x = @2_r4_96[@i_114]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], Ystar_u[@i_114])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = Yp[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@2_m[@i_108], @2_kd[@i_108], @2_r4_84[@i_108]) && otheruses(@2_r4_84[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], @2_r4_84[@i_108])
  )
  orfind @i_104 <= NU suchthat defined(Ystar_u[@i_104], @2_r4_96[@i_104]) && otheruses(@2_r4_96[@i_104]) && ((@2_m = Ystar_u[@i_104]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], @2_r4_96[@i_104])
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@2_r2_90[@i_101], Yp[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Yp[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_r2_93[@i_100], Y[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @2_r4_84: G;
    out(@2_c4[!_57], @2_r4_84)
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  out(c20[!_58], h0(x1_69, x2_68, x3_67, x4_66, x5_65))
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  let x1_253: host = x1_64 in
  let x2_252: host = x2_63 in
  let x3_251: G = x3_62 in
  let x4_250: G = x4_61 in
  let x5_249: G = x5_60 in
  find [unique] @i_310 <= qH1 suchthat defined(x1_253[@i_310], x2_252[@i_310], x3_251[@i_310], x4_250[@i_310], x5_249[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_253 = x1_253[@i_310]) && ((x2_252 = x2_252[@i_310]) && ((x3_251 = x3_251[@i_310]) && ((x4_250 = x4_250[@i_310]) && (x5_249 = x5_249[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  orfind @i_309 <= NP suchthat defined(x1_259[@i_309], x2_258[@i_309], x3_257[@i_309], x4_256[@i_309], x5_255[@i_309], r_254[@i_309]) && otheruses(r_254[@i_309]) && ((x1_253 = x1_259[@i_309]) && ((x2_252 = x2_258[@i_309]) && ((x3_251 = x3_257[@i_309]) && ((x4_250 = x4_256[@i_309]) && (x5_249 = x5_255[@i_309]))))) then
  (
    out(c21[!_59], r_254[@i_309])
  )
  orfind @i_306 <= NU suchthat defined(x1_277[@i_306], x2_276[@i_306], x3_275[@i_306], x4_274[@i_306], x5_273[@i_306], r_272[@i_306]) && otheruses(r_272[@i_306]) && ((x1_253 = x1_277[@i_306]) && ((x2_252 = x2_276[@i_306]) && ((x3_251 = x3_275[@i_306]) && ((x4_250 = x4_274[@i_306]) && (x5_249 = x5_273[@i_306]))))) then
  (
    out(c21[!_59], r_272[@i_306])
  )
  orfind @i_305 <= NU suchthat defined(x1_283[@i_305], x2_282[@i_305], x3_281[@i_305], x4_280[@i_305], x5_279[@i_305], r_278[@i_305]) && otheruses(r_278[@i_305]) && ((x1_253 = x1_283[@i_305]) && ((x2_252 = x2_282[@i_305]) && ((x3_251 = x3_281[@i_305]) && ((x4_250 = x4_280[@i_305]) && (x5_249 = x5_279[@i_305]))))) then
  (
    out(c21[!_59], r_278[@i_305])
  )
  orfind @i_304 <= NU suchthat defined(x1_289[@i_304], x2_288[@i_304], x3_287[@i_304], x4_286[@i_304], x5_285[@i_304], r_284[@i_304]) && otheruses(r_284[@i_304]) && ((x1_253 = x1_289[@i_304]) && ((x2_252 = x2_288[@i_304]) && ((x3_251 = x3_287[@i_304]) && ((x4_250 = x4_286[@i_304]) && (x5_249 = x5_285[@i_304]))))) then
  (
    out(c21[!_59], r_284[@i_304])
  )
  orfind @i_303 <= NU suchthat defined(x1_295[@i_303], x2_294[@i_303], x3_293[@i_303], x4_292[@i_303], x5_291[@i_303], r_290[@i_303]) && otheruses(r_290[@i_303]) && ((x1_253 = x1_295[@i_303]) && ((x2_252 = x2_294[@i_303]) && ((x3_251 = x3_293[@i_303]) && ((x4_250 = x4_292[@i_303]) && (x5_249 = x5_291[@i_303]))))) then
  (
    out(c21[!_59], r_290[@i_303])
  )
  orfind @i_302 <= NU suchthat defined(x1_301[@i_302], x2_300[@i_302], x3_299[@i_302], x4_298[@i_302], x5_297[@i_302], r_296[@i_302]) && otheruses(r_296[@i_302]) && ((x1_253 = x1_301[@i_302]) && ((x2_252 = x2_300[@i_302]) && ((x3_251 = x3_299[@i_302]) && ((x4_250 = x4_298[@i_302]) && (x5_249 = x5_297[@i_302]))))) then
  (
    out(c21[!_59], r_296[@i_302])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying remove assignments of useless yields

Game 12 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_148 <= qD suchthat defined(@2_m[@i_148], @2_kd[@i_148], @2_r4_84[@i_148]) && otheruses(@2_r4_84[@i_148]) && ((Ystar_u = @2_m[@i_148]) && (pw = @2_kd[@i_148])) then
  (
    let K_u: G = exp(@2_r4_84[@i_148], x) in
    let x1_283: host = U in
    let x2_282: host = S in
    let x3_281: G = cst_G in
    let x4_280: G = cst_G in
    let x5_279: G = cst_G in
    find [unique] @i_355 <= qH1 suchthat defined(x1_64[@i_355], x2_63[@i_355], x3_62[@i_355], x4_61[@i_355], x5_60[@i_355], x5_249[@i_355], x4_250[@i_355], x3_251[@i_355], x2_252[@i_355], x1_253[@i_355], r_248[@i_355]) && otheruses(r_248[@i_355]) && ((x1_283 = x1_64[@i_355]) && ((x2_282 = x2_63[@i_355]) && ((X = x3_62[@i_355]) && ((@2_r4_84[@i_148] = x4_61[@i_355]) && (K_u = x5_60[@i_355]))))) then
    (
      out(c6[!_53], r_248[@i_355]);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_84[@i_148], K_u)
    )
    else
    (
      new r_278: hash1;
      out(c6[!_53], r_278);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_84[@i_148], K_u)
    )
  )
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], @2_r4_96[@i_144]) && otheruses(@2_r4_96[@i_144]) && (Ystar_u = Ystar_u[@i_144]) then
  (
    let K_u: G = exp(@2_r4_96[@i_144], x) in
    let x1_289: host = U in
    let x2_288: host = S in
    let x3_287: G = cst_G in
    let x4_286: G = cst_G in
    let x5_285: G = cst_G in
    find [unique] @i_364 <= qH1 suchthat defined(x1_64[@i_364], x2_63[@i_364], x3_62[@i_364], x4_61[@i_364], x5_60[@i_364], x5_249[@i_364], x4_250[@i_364], x3_251[@i_364], x2_252[@i_364], x1_253[@i_364], r_248[@i_364]) && otheruses(r_248[@i_364]) && ((x1_289 = x1_64[@i_364]) && ((x2_288 = x2_63[@i_364]) && ((X = x3_62[@i_364]) && ((@2_r4_96[@i_144] = x4_61[@i_364]) && (K_u = x5_60[@i_364]))))) then
    (
      out(c6[!_53], r_248[@i_364]);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_96[@i_144], K_u)
    )
    else
    (
      new r_284: hash1;
      out(c6[!_53], r_284);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, @2_r4_96[@i_144], K_u)
    )
  )
  orfind @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  orfind @i_141 <= NP suchthat defined(@2_r2_90[@i_141], yp[@i_141], Yp[@i_141]) && otheruses(@2_r2_90[@i_141]) && (Ystar_u = @2_r2_90[@i_141]) then
  (
    let K_u: G = exp(g, mult(yp[@i_141], x)) in
    let x1_295: host = U in
    let x2_294: host = S in
    let x3_293: G = cst_G in
    let x4_292: G = cst_G in
    let x5_291: G = cst_G in
    find [unique] @i_373 <= qH1 suchthat defined(x1_64[@i_373], x2_63[@i_373], x3_62[@i_373], x4_61[@i_373], x5_60[@i_373], x5_249[@i_373], x4_250[@i_373], x3_251[@i_373], x2_252[@i_373], x1_253[@i_373], r_248[@i_373]) && otheruses(r_248[@i_373]) && ((x1_295 = x1_64[@i_373]) && ((x2_294 = x2_63[@i_373]) && ((X = x3_62[@i_373]) && ((Yp[@i_141] = x4_61[@i_373]) && (K_u = x5_60[@i_373]))))) then
    (
      out(c6[!_53], r_248[@i_373]);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, Yp[@i_141], K_u)
    )
    else
    (
      new r_290: hash1;
      out(c6[!_53], r_290);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, Yp[@i_141], K_u)
    )
  )
  orfind @i_140 <= NS suchthat defined(@2_r2_93[@i_140], y[@i_140], Y[@i_140]) && otheruses(@2_r2_93[@i_140]) && (Ystar_u = @2_r2_93[@i_140]) then
  (
    let K_u: G = exp(g, mult(y[@i_140], x)) in
    let x1_301: host = U in
    let x2_300: host = S in
    let x3_299: G = cst_G in
    let x4_298: G = cst_G in
    let x5_297: G = cst_G in
    find [unique] @i_382 <= qH1 suchthat defined(x1_64[@i_382], x2_63[@i_382], x3_62[@i_382], x4_61[@i_382], x5_60[@i_382], x5_249[@i_382], x4_250[@i_382], x3_251[@i_382], x2_252[@i_382], x1_253[@i_382], r_248[@i_382]) && otheruses(r_248[@i_382]) && ((x1_301 = x1_64[@i_382]) && ((x2_300 = x2_63[@i_382]) && ((X = x3_62[@i_382]) && ((Y[@i_140] = x4_61[@i_382]) && (K_u = x5_60[@i_382]))))) then
    (
      out(c6[!_53], r_248[@i_382]);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, Y[@i_140], K_u)
    )
    else
    (
      new r_296: hash1;
      out(c6[!_53], r_296);
      in(c9[!_53], ());
      let sk_u: hash0 = h0(U, S, X, Y[@i_140], K_u)
    )
  )
  else
  (
    new @2_r4_96: G;
    let K_u: G = exp(@2_r4_96, x) in
    let x1_277: host = U in
    let x2_276: host = S in
    let x3_275: G = cst_G in
    let x4_274: G = cst_G in
    let x5_273: G = cst_G in
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ());
    let sk_u: hash0 = h0(U, S, X, @2_r4_96, K_u)
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_271: host = U in
    let x2_270: host = S in
    find [unique] @i_337 <= qH1 suchthat defined(x1_64[@i_337], x2_63[@i_337], x3_62[@i_337], x4_61[@i_337], x5_60[@i_337], x5_249[@i_337], x4_250[@i_337], x3_251[@i_337], x2_252[@i_337], x1_253[@i_337], r_248[@i_337]) && otheruses(r_248[@i_337]) && ((x1_271 = x1_64[@i_337]) && ((x2_270 = x2_63[@i_337]) && ((X_s = x3_62[@i_337]) && ((Y = x4_61[@i_337]) && (K_s = x5_60[@i_337]))))) then
    (
      if (auth_s = r_248[@i_337]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
    )
    orfind  suchthat defined(@i_140[j], r_296[j]) && otheruses(r_296[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
    (
      if (auth_s = r_296[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s)
    )
    else
    (
      new r_266: hash1
    )
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    (
      event Auth
    )
    else
    (
      new r_260: hash1
    )
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_90: G;
  let x1_259: host = U in
  let x2_258: host = S in
  let x3_257: G = cst_G in
  let x4_256: G = cst_G in
  let x5_255: G = cst_G in
  new r_254: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@2_r4_84[@i_118], @2_kd[@i_118], @2_m[@i_118]) && otheruses(@2_r4_84[@i_118]) && ((@2_x = @2_r4_84[@i_118]) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_114 <= NU suchthat defined(@2_r4_96[@i_114], Ystar_u[@i_114]) && otheruses(@2_r4_96[@i_114]) && ((@2_x = @2_r4_96[@i_114]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], Ystar_u[@i_114])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = Yp[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@2_m[@i_108], @2_kd[@i_108], @2_r4_84[@i_108]) && otheruses(@2_r4_84[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], @2_r4_84[@i_108])
  )
  orfind @i_104 <= NU suchthat defined(Ystar_u[@i_104], @2_r4_96[@i_104]) && otheruses(@2_r4_96[@i_104]) && ((@2_m = Ystar_u[@i_104]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], @2_r4_96[@i_104])
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@2_r2_90[@i_101], Yp[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Yp[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_r2_93[@i_100], Y[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @2_r4_84: G;
    out(@2_c4[!_57], @2_r4_84)
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  out(c20[!_58], h0(x1_69, x2_68, x3_67, x4_66, x5_65))
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  let x1_253: host = cst_host in
  let x2_252: host = cst_host in
  let x3_251: G = cst_G in
  let x4_250: G = cst_G in
  let x5_249: G = cst_G in
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], x5_249[@i_310], x4_250[@i_310], x3_251[@i_310], x2_252[@i_310], x1_253[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  orfind @i_309 <= NP suchthat defined(Xp[@i_309], Yp[@i_309], Kp[@i_309], x5_255[@i_309], x4_256[@i_309], x3_257[@i_309], x1_259[@i_309], x2_258[@i_309], r_254[@i_309]) && otheruses(r_254[@i_309]) && ((x1_64 = x1_259[@i_309]) && ((x2_63 = x2_258[@i_309]) && ((x3_62 = Xp[@i_309]) && ((x4_61 = Yp[@i_309]) && (x5_60 = Kp[@i_309]))))) then
  (
    out(c21[!_59], r_254[@i_309])
  )
  orfind @i_306 <= NU suchthat defined(X[@i_306], @2_r4_96[@i_306], K_u[@i_306], x5_273[@i_306], x4_274[@i_306], x3_275[@i_306], x1_277[@i_306], x2_276[@i_306], r_272[@i_306]) && otheruses(r_272[@i_306]) && ((x1_64 = x1_277[@i_306]) && ((x2_63 = x2_276[@i_306]) && ((x3_62 = X[@i_306]) && ((x4_61 = @2_r4_96[@i_306]) && (x5_60 = K_u[@i_306]))))) then
  (
    out(c21[!_59], r_272[@i_306])
  )
  orfind @i_305 <= NU suchthat defined(X[@i_305], @2_r4_84[@i_148[@i_305]], K_u[@i_305], x5_279[@i_305], x4_280[@i_305], x3_281[@i_305], x1_283[@i_305], x2_282[@i_305], r_278[@i_305]) && otheruses(r_278[@i_305]) && ((x1_64 = x1_283[@i_305]) && ((x2_63 = x2_282[@i_305]) && ((x3_62 = X[@i_305]) && ((x4_61 = @2_r4_84[@i_148[@i_305]]) && (x5_60 = K_u[@i_305]))))) then
  (
    out(c21[!_59], r_278[@i_305])
  )
  orfind @i_304 <= NU suchthat defined(X[@i_304], @2_r4_96[@i_144[@i_304]], K_u[@i_304], x5_285[@i_304], x4_286[@i_304], x3_287[@i_304], x1_289[@i_304], x2_288[@i_304], r_284[@i_304]) && otheruses(r_284[@i_304]) && ((x1_64 = x1_289[@i_304]) && ((x2_63 = x2_288[@i_304]) && ((x3_62 = X[@i_304]) && ((x4_61 = @2_r4_96[@i_144[@i_304]]) && (x5_60 = K_u[@i_304]))))) then
  (
    out(c21[!_59], r_284[@i_304])
  )
  orfind @i_303 <= NU suchthat defined(X[@i_303], Yp[@i_141[@i_303]], K_u[@i_303], x5_291[@i_303], x4_292[@i_303], x3_293[@i_303], x1_295[@i_303], x2_294[@i_303], r_290[@i_303]) && otheruses(r_290[@i_303]) && ((x1_64 = x1_295[@i_303]) && ((x2_63 = x2_294[@i_303]) && ((x3_62 = X[@i_303]) && ((x4_61 = Yp[@i_141[@i_303]]) && (x5_60 = K_u[@i_303]))))) then
  (
    out(c21[!_59], r_290[@i_303])
  )
  orfind @i_302 <= NU suchthat defined(X[@i_302], Y[@i_140[@i_302]], K_u[@i_302], x5_297[@i_302], x4_298[@i_302], x3_299[@i_302], x1_301[@i_302], x2_300[@i_302], r_296[@i_302]) && otheruses(r_296[@i_302]) && ((x1_64 = x1_301[@i_302]) && ((x2_63 = x2_300[@i_302]) && ((x3_62 = X[@i_302]) && ((x4_61 = Y[@i_140[@i_302]]) && (x5_60 = K_u[@i_302]))))) then
  (
    out(c21[!_59], r_296[@i_302])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying equivalence
equiv ! !_49 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_50 <= N (x1_79: host, x2_78: host, x3_77: G, x4_76: G, x5_75: G) -> let x1: host = x1_79 in let x2: host = x2_78 in let x3: G = x3_77 in let x4: G = x4_76 in let x5: G = x5_75 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash0; r
 yields

Game 13 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_148 <= qD suchthat defined(@2_m[@i_148], @2_kd[@i_148], @2_r4_84[@i_148]) && otheruses(@2_r4_84[@i_148]) && ((Ystar_u = @2_m[@i_148]) && (pw = @2_kd[@i_148])) then
  (
    let K_u: G = exp(@2_r4_84[@i_148], x) in
    let x1_283: host = U in
    let x2_282: host = S in
    let x3_281: G = cst_G in
    let x4_280: G = cst_G in
    let x5_279: G = cst_G in
    find [unique] @i_355 <= qH1 suchthat defined(x1_64[@i_355], x2_63[@i_355], x3_62[@i_355], x4_61[@i_355], x5_60[@i_355], x5_249[@i_355], x4_250[@i_355], x3_251[@i_355], x2_252[@i_355], x1_253[@i_355], r_248[@i_355]) && otheruses(r_248[@i_355]) && ((x1_283 = x1_64[@i_355]) && ((x2_282 = x2_63[@i_355]) && ((X = x3_62[@i_355]) && ((@2_r4_84[@i_148] = x4_61[@i_355]) && (K_u = x5_60[@i_355]))))) then
    (
      out(c6[!_53], r_248[@i_355]);
      in(c9[!_53], ());
      let x1_714: host = U in
      let x2_713: host = S in
      let x3_712: G = X in
      let x4_711: G = @2_r4_84[@i_148] in
      let x5_710: G = K_u in
      find [unique] @i_841 <= qH0 suchthat defined(x1_678[@i_841], x2_677[@i_841], x3_676[@i_841], x4_675[@i_841], x5_674[@i_841], r_673[@i_841]) && otheruses(r_673[@i_841]) && ((x1_714 = x1_678[@i_841]) && ((x2_713 = x2_677[@i_841]) && ((x3_712 = x3_676[@i_841]) && ((x4_711 = x4_675[@i_841]) && (x5_710 = x5_674[@i_841]))))) then
      (
        let sk_u: hash0 = r_673[@i_841]
      )
      orfind @i_840 <= NP suchthat defined(x1_684[@i_840], x2_683[@i_840], x3_682[@i_840], x4_681[@i_840], x5_680[@i_840], r_679[@i_840]) && otheruses(r_679[@i_840]) && ((x1_714 = x1_684[@i_840]) && ((x2_713 = x2_683[@i_840]) && ((x3_712 = x3_682[@i_840]) && ((x4_711 = x4_681[@i_840]) && (x5_710 = x5_680[@i_840]))))) then
      (
        let sk_u: hash0 = r_679[@i_840]
      )
      orfind @i_839 <= NS suchthat defined(x1_690[@i_839], x2_689[@i_839], x3_688[@i_839], x4_687[@i_839], x5_686[@i_839], r_685[@i_839]) && otheruses(r_685[@i_839]) && ((x1_714 = x1_690[@i_839]) && ((x2_713 = x2_689[@i_839]) && ((x3_712 = x3_688[@i_839]) && ((x4_711 = x4_687[@i_839]) && (x5_710 = x5_686[@i_839]))))) then
      (
        let sk_u: hash0 = r_685[@i_839]
      )
      orfind @i_838 <= NS suchthat defined(x1_696[@i_838], x2_695[@i_838], x3_694[@i_838], x4_693[@i_838], x5_692[@i_838], r_691[@i_838]) && otheruses(r_691[@i_838]) && ((x1_714 = x1_696[@i_838]) && ((x2_713 = x2_695[@i_838]) && ((x3_712 = x3_694[@i_838]) && ((x4_711 = x4_693[@i_838]) && (x5_710 = x5_692[@i_838]))))) then
      (
        let sk_u: hash0 = r_691[@i_838]
      )
      orfind @i_837 <= NU suchthat defined(x1_702[@i_837], x2_701[@i_837], x3_700[@i_837], x4_699[@i_837], x5_698[@i_837], r_697[@i_837]) && otheruses(r_697[@i_837]) && ((x1_714 = x1_702[@i_837]) && ((x2_713 = x2_701[@i_837]) && ((x3_712 = x3_700[@i_837]) && ((x4_711 = x4_699[@i_837]) && (x5_710 = x5_698[@i_837]))))) then
      (
        let sk_u: hash0 = r_697[@i_837]
      )
      orfind @i_836 <= NU suchthat defined(x1_708[@i_836], x2_707[@i_836], x3_706[@i_836], x4_705[@i_836], x5_704[@i_836], r_703[@i_836]) && otheruses(r_703[@i_836]) && ((x1_714 = x1_708[@i_836]) && ((x2_713 = x2_707[@i_836]) && ((x3_712 = x3_706[@i_836]) && ((x4_711 = x4_705[@i_836]) && (x5_710 = x5_704[@i_836]))))) then
      (
        let sk_u: hash0 = r_703[@i_836]
      )
      orfind @i_835 <= NU suchthat defined(x1_714[@i_835], x2_713[@i_835], x3_712[@i_835], x4_711[@i_835], x5_710[@i_835], r_709[@i_835]) && otheruses(r_709[@i_835]) && ((x1_714 = x1_714[@i_835]) && ((x2_713 = x2_713[@i_835]) && ((x3_712 = x3_712[@i_835]) && ((x4_711 = x4_711[@i_835]) && (x5_710 = x5_710[@i_835]))))) then
      (
        let sk_u: hash0 = r_709[@i_835]
      )
      orfind @i_834 <= NU suchthat defined(x1_720[@i_834], x2_719[@i_834], x3_718[@i_834], x4_717[@i_834], x5_716[@i_834], r_715[@i_834]) && otheruses(r_715[@i_834]) && ((x1_714 = x1_720[@i_834]) && ((x2_713 = x2_719[@i_834]) && ((x3_712 = x3_718[@i_834]) && ((x4_711 = x4_717[@i_834]) && (x5_710 = x5_716[@i_834]))))) then
      (
        let sk_u: hash0 = r_715[@i_834]
      )
      orfind @i_833 <= NU suchthat defined(x1_726[@i_833], x2_725[@i_833], x3_724[@i_833], x4_723[@i_833], x5_722[@i_833], r_721[@i_833]) && otheruses(r_721[@i_833]) && ((x1_714 = x1_726[@i_833]) && ((x2_713 = x2_725[@i_833]) && ((x3_712 = x3_724[@i_833]) && ((x4_711 = x4_723[@i_833]) && (x5_710 = x5_722[@i_833]))))) then
      (
        let sk_u: hash0 = r_721[@i_833]
      )
      orfind @i_832 <= NU suchthat defined(x1_732[@i_832], x2_731[@i_832], x3_730[@i_832], x4_729[@i_832], x5_728[@i_832], r_727[@i_832]) && otheruses(r_727[@i_832]) && ((x1_714 = x1_732[@i_832]) && ((x2_713 = x2_731[@i_832]) && ((x3_712 = x3_730[@i_832]) && ((x4_711 = x4_729[@i_832]) && (x5_710 = x5_728[@i_832]))))) then
      (
        let sk_u: hash0 = r_727[@i_832]
      )
      orfind @i_831 <= NU suchthat defined(x1_738[@i_831], x2_737[@i_831], x3_736[@i_831], x4_735[@i_831], x5_734[@i_831], r_733[@i_831]) && otheruses(r_733[@i_831]) && ((x1_714 = x1_738[@i_831]) && ((x2_713 = x2_737[@i_831]) && ((x3_712 = x3_736[@i_831]) && ((x4_711 = x4_735[@i_831]) && (x5_710 = x5_734[@i_831]))))) then
      (
        let sk_u: hash0 = r_733[@i_831]
      )
      orfind @i_830 <= NU suchthat defined(x1_744[@i_830], x2_743[@i_830], x3_742[@i_830], x4_741[@i_830], x5_740[@i_830], r_739[@i_830]) && otheruses(r_739[@i_830]) && ((x1_714 = x1_744[@i_830]) && ((x2_713 = x2_743[@i_830]) && ((x3_712 = x3_742[@i_830]) && ((x4_711 = x4_741[@i_830]) && (x5_710 = x5_740[@i_830]))))) then
      (
        let sk_u: hash0 = r_739[@i_830]
      )
      orfind @i_829 <= NU suchthat defined(x1_750[@i_829], x2_749[@i_829], x3_748[@i_829], x4_747[@i_829], x5_746[@i_829], r_745[@i_829]) && otheruses(r_745[@i_829]) && ((x1_714 = x1_750[@i_829]) && ((x2_713 = x2_749[@i_829]) && ((x3_712 = x3_748[@i_829]) && ((x4_711 = x4_747[@i_829]) && (x5_710 = x5_746[@i_829]))))) then
      (
        let sk_u: hash0 = r_745[@i_829]
      )
      else
      (
        new r_709: hash0;
        let sk_u: hash0 = r_709
      )
    )
    else
    (
      new r_278: hash1;
      out(c6[!_53], r_278);
      in(c9[!_53], ());
      let x1_708: host = U in
      let x2_707: host = S in
      let x3_706: G = X in
      let x4_705: G = @2_r4_84[@i_148] in
      let x5_704: G = K_u in
      find [unique] @i_828 <= qH0 suchthat defined(x1_678[@i_828], x2_677[@i_828], x3_676[@i_828], x4_675[@i_828], x5_674[@i_828], r_673[@i_828]) && otheruses(r_673[@i_828]) && ((x1_708 = x1_678[@i_828]) && ((x2_707 = x2_677[@i_828]) && ((x3_706 = x3_676[@i_828]) && ((x4_705 = x4_675[@i_828]) && (x5_704 = x5_674[@i_828]))))) then
      (
        let sk_u: hash0 = r_673[@i_828]
      )
      orfind @i_827 <= NP suchthat defined(x1_684[@i_827], x2_683[@i_827], x3_682[@i_827], x4_681[@i_827], x5_680[@i_827], r_679[@i_827]) && otheruses(r_679[@i_827]) && ((x1_708 = x1_684[@i_827]) && ((x2_707 = x2_683[@i_827]) && ((x3_706 = x3_682[@i_827]) && ((x4_705 = x4_681[@i_827]) && (x5_704 = x5_680[@i_827]))))) then
      (
        let sk_u: hash0 = r_679[@i_827]
      )
      orfind @i_826 <= NS suchthat defined(x1_690[@i_826], x2_689[@i_826], x3_688[@i_826], x4_687[@i_826], x5_686[@i_826], r_685[@i_826]) && otheruses(r_685[@i_826]) && ((x1_708 = x1_690[@i_826]) && ((x2_707 = x2_689[@i_826]) && ((x3_706 = x3_688[@i_826]) && ((x4_705 = x4_687[@i_826]) && (x5_704 = x5_686[@i_826]))))) then
      (
        let sk_u: hash0 = r_685[@i_826]
      )
      orfind @i_825 <= NS suchthat defined(x1_696[@i_825], x2_695[@i_825], x3_694[@i_825], x4_693[@i_825], x5_692[@i_825], r_691[@i_825]) && otheruses(r_691[@i_825]) && ((x1_708 = x1_696[@i_825]) && ((x2_707 = x2_695[@i_825]) && ((x3_706 = x3_694[@i_825]) && ((x4_705 = x4_693[@i_825]) && (x5_704 = x5_692[@i_825]))))) then
      (
        let sk_u: hash0 = r_691[@i_825]
      )
      orfind @i_824 <= NU suchthat defined(x1_702[@i_824], x2_701[@i_824], x3_700[@i_824], x4_699[@i_824], x5_698[@i_824], r_697[@i_824]) && otheruses(r_697[@i_824]) && ((x1_708 = x1_702[@i_824]) && ((x2_707 = x2_701[@i_824]) && ((x3_706 = x3_700[@i_824]) && ((x4_705 = x4_699[@i_824]) && (x5_704 = x5_698[@i_824]))))) then
      (
        let sk_u: hash0 = r_697[@i_824]
      )
      orfind @i_823 <= NU suchthat defined(x1_708[@i_823], x2_707[@i_823], x3_706[@i_823], x4_705[@i_823], x5_704[@i_823], r_703[@i_823]) && otheruses(r_703[@i_823]) && ((x1_708 = x1_708[@i_823]) && ((x2_707 = x2_707[@i_823]) && ((x3_706 = x3_706[@i_823]) && ((x4_705 = x4_705[@i_823]) && (x5_704 = x5_704[@i_823]))))) then
      (
        let sk_u: hash0 = r_703[@i_823]
      )
      orfind @i_822 <= NU suchthat defined(x1_714[@i_822], x2_713[@i_822], x3_712[@i_822], x4_711[@i_822], x5_710[@i_822], r_709[@i_822]) && otheruses(r_709[@i_822]) && ((x1_708 = x1_714[@i_822]) && ((x2_707 = x2_713[@i_822]) && ((x3_706 = x3_712[@i_822]) && ((x4_705 = x4_711[@i_822]) && (x5_704 = x5_710[@i_822]))))) then
      (
        let sk_u: hash0 = r_709[@i_822]
      )
      orfind @i_821 <= NU suchthat defined(x1_720[@i_821], x2_719[@i_821], x3_718[@i_821], x4_717[@i_821], x5_716[@i_821], r_715[@i_821]) && otheruses(r_715[@i_821]) && ((x1_708 = x1_720[@i_821]) && ((x2_707 = x2_719[@i_821]) && ((x3_706 = x3_718[@i_821]) && ((x4_705 = x4_717[@i_821]) && (x5_704 = x5_716[@i_821]))))) then
      (
        let sk_u: hash0 = r_715[@i_821]
      )
      orfind @i_820 <= NU suchthat defined(x1_726[@i_820], x2_725[@i_820], x3_724[@i_820], x4_723[@i_820], x5_722[@i_820], r_721[@i_820]) && otheruses(r_721[@i_820]) && ((x1_708 = x1_726[@i_820]) && ((x2_707 = x2_725[@i_820]) && ((x3_706 = x3_724[@i_820]) && ((x4_705 = x4_723[@i_820]) && (x5_704 = x5_722[@i_820]))))) then
      (
        let sk_u: hash0 = r_721[@i_820]
      )
      orfind @i_819 <= NU suchthat defined(x1_732[@i_819], x2_731[@i_819], x3_730[@i_819], x4_729[@i_819], x5_728[@i_819], r_727[@i_819]) && otheruses(r_727[@i_819]) && ((x1_708 = x1_732[@i_819]) && ((x2_707 = x2_731[@i_819]) && ((x3_706 = x3_730[@i_819]) && ((x4_705 = x4_729[@i_819]) && (x5_704 = x5_728[@i_819]))))) then
      (
        let sk_u: hash0 = r_727[@i_819]
      )
      orfind @i_818 <= NU suchthat defined(x1_738[@i_818], x2_737[@i_818], x3_736[@i_818], x4_735[@i_818], x5_734[@i_818], r_733[@i_818]) && otheruses(r_733[@i_818]) && ((x1_708 = x1_738[@i_818]) && ((x2_707 = x2_737[@i_818]) && ((x3_706 = x3_736[@i_818]) && ((x4_705 = x4_735[@i_818]) && (x5_704 = x5_734[@i_818]))))) then
      (
        let sk_u: hash0 = r_733[@i_818]
      )
      orfind @i_817 <= NU suchthat defined(x1_744[@i_817], x2_743[@i_817], x3_742[@i_817], x4_741[@i_817], x5_740[@i_817], r_739[@i_817]) && otheruses(r_739[@i_817]) && ((x1_708 = x1_744[@i_817]) && ((x2_707 = x2_743[@i_817]) && ((x3_706 = x3_742[@i_817]) && ((x4_705 = x4_741[@i_817]) && (x5_704 = x5_740[@i_817]))))) then
      (
        let sk_u: hash0 = r_739[@i_817]
      )
      orfind @i_816 <= NU suchthat defined(x1_750[@i_816], x2_749[@i_816], x3_748[@i_816], x4_747[@i_816], x5_746[@i_816], r_745[@i_816]) && otheruses(r_745[@i_816]) && ((x1_708 = x1_750[@i_816]) && ((x2_707 = x2_749[@i_816]) && ((x3_706 = x3_748[@i_816]) && ((x4_705 = x4_747[@i_816]) && (x5_704 = x5_746[@i_816]))))) then
      (
        let sk_u: hash0 = r_745[@i_816]
      )
      else
      (
        new r_703: hash0;
        let sk_u: hash0 = r_703
      )
    )
  )
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], @2_r4_96[@i_144]) && otheruses(@2_r4_96[@i_144]) && (Ystar_u = Ystar_u[@i_144]) then
  (
    let K_u: G = exp(@2_r4_96[@i_144], x) in
    let x1_289: host = U in
    let x2_288: host = S in
    let x3_287: G = cst_G in
    let x4_286: G = cst_G in
    let x5_285: G = cst_G in
    find [unique] @i_364 <= qH1 suchthat defined(x1_64[@i_364], x2_63[@i_364], x3_62[@i_364], x4_61[@i_364], x5_60[@i_364], x5_249[@i_364], x4_250[@i_364], x3_251[@i_364], x2_252[@i_364], x1_253[@i_364], r_248[@i_364]) && otheruses(r_248[@i_364]) && ((x1_289 = x1_64[@i_364]) && ((x2_288 = x2_63[@i_364]) && ((X = x3_62[@i_364]) && ((@2_r4_96[@i_144] = x4_61[@i_364]) && (K_u = x5_60[@i_364]))))) then
    (
      out(c6[!_53], r_248[@i_364]);
      in(c9[!_53], ());
      let x1_726: host = U in
      let x2_725: host = S in
      let x3_724: G = X in
      let x4_723: G = @2_r4_96[@i_144] in
      let x5_722: G = K_u in
      find [unique] @i_867 <= qH0 suchthat defined(x1_678[@i_867], x2_677[@i_867], x3_676[@i_867], x4_675[@i_867], x5_674[@i_867], r_673[@i_867]) && otheruses(r_673[@i_867]) && ((x1_726 = x1_678[@i_867]) && ((x2_725 = x2_677[@i_867]) && ((x3_724 = x3_676[@i_867]) && ((x4_723 = x4_675[@i_867]) && (x5_722 = x5_674[@i_867]))))) then
      (
        let sk_u: hash0 = r_673[@i_867]
      )
      orfind @i_866 <= NP suchthat defined(x1_684[@i_866], x2_683[@i_866], x3_682[@i_866], x4_681[@i_866], x5_680[@i_866], r_679[@i_866]) && otheruses(r_679[@i_866]) && ((x1_726 = x1_684[@i_866]) && ((x2_725 = x2_683[@i_866]) && ((x3_724 = x3_682[@i_866]) && ((x4_723 = x4_681[@i_866]) && (x5_722 = x5_680[@i_866]))))) then
      (
        let sk_u: hash0 = r_679[@i_866]
      )
      orfind @i_865 <= NS suchthat defined(x1_690[@i_865], x2_689[@i_865], x3_688[@i_865], x4_687[@i_865], x5_686[@i_865], r_685[@i_865]) && otheruses(r_685[@i_865]) && ((x1_726 = x1_690[@i_865]) && ((x2_725 = x2_689[@i_865]) && ((x3_724 = x3_688[@i_865]) && ((x4_723 = x4_687[@i_865]) && (x5_722 = x5_686[@i_865]))))) then
      (
        let sk_u: hash0 = r_685[@i_865]
      )
      orfind @i_864 <= NS suchthat defined(x1_696[@i_864], x2_695[@i_864], x3_694[@i_864], x4_693[@i_864], x5_692[@i_864], r_691[@i_864]) && otheruses(r_691[@i_864]) && ((x1_726 = x1_696[@i_864]) && ((x2_725 = x2_695[@i_864]) && ((x3_724 = x3_694[@i_864]) && ((x4_723 = x4_693[@i_864]) && (x5_722 = x5_692[@i_864]))))) then
      (
        let sk_u: hash0 = r_691[@i_864]
      )
      orfind @i_863 <= NU suchthat defined(x1_702[@i_863], x2_701[@i_863], x3_700[@i_863], x4_699[@i_863], x5_698[@i_863], r_697[@i_863]) && otheruses(r_697[@i_863]) && ((x1_726 = x1_702[@i_863]) && ((x2_725 = x2_701[@i_863]) && ((x3_724 = x3_700[@i_863]) && ((x4_723 = x4_699[@i_863]) && (x5_722 = x5_698[@i_863]))))) then
      (
        let sk_u: hash0 = r_697[@i_863]
      )
      orfind @i_862 <= NU suchthat defined(x1_708[@i_862], x2_707[@i_862], x3_706[@i_862], x4_705[@i_862], x5_704[@i_862], r_703[@i_862]) && otheruses(r_703[@i_862]) && ((x1_726 = x1_708[@i_862]) && ((x2_725 = x2_707[@i_862]) && ((x3_724 = x3_706[@i_862]) && ((x4_723 = x4_705[@i_862]) && (x5_722 = x5_704[@i_862]))))) then
      (
        let sk_u: hash0 = r_703[@i_862]
      )
      orfind @i_861 <= NU suchthat defined(x1_714[@i_861], x2_713[@i_861], x3_712[@i_861], x4_711[@i_861], x5_710[@i_861], r_709[@i_861]) && otheruses(r_709[@i_861]) && ((x1_726 = x1_714[@i_861]) && ((x2_725 = x2_713[@i_861]) && ((x3_724 = x3_712[@i_861]) && ((x4_723 = x4_711[@i_861]) && (x5_722 = x5_710[@i_861]))))) then
      (
        let sk_u: hash0 = r_709[@i_861]
      )
      orfind @i_860 <= NU suchthat defined(x1_720[@i_860], x2_719[@i_860], x3_718[@i_860], x4_717[@i_860], x5_716[@i_860], r_715[@i_860]) && otheruses(r_715[@i_860]) && ((x1_726 = x1_720[@i_860]) && ((x2_725 = x2_719[@i_860]) && ((x3_724 = x3_718[@i_860]) && ((x4_723 = x4_717[@i_860]) && (x5_722 = x5_716[@i_860]))))) then
      (
        let sk_u: hash0 = r_715[@i_860]
      )
      orfind @i_859 <= NU suchthat defined(x1_726[@i_859], x2_725[@i_859], x3_724[@i_859], x4_723[@i_859], x5_722[@i_859], r_721[@i_859]) && otheruses(r_721[@i_859]) && ((x1_726 = x1_726[@i_859]) && ((x2_725 = x2_725[@i_859]) && ((x3_724 = x3_724[@i_859]) && ((x4_723 = x4_723[@i_859]) && (x5_722 = x5_722[@i_859]))))) then
      (
        let sk_u: hash0 = r_721[@i_859]
      )
      orfind @i_858 <= NU suchthat defined(x1_732[@i_858], x2_731[@i_858], x3_730[@i_858], x4_729[@i_858], x5_728[@i_858], r_727[@i_858]) && otheruses(r_727[@i_858]) && ((x1_726 = x1_732[@i_858]) && ((x2_725 = x2_731[@i_858]) && ((x3_724 = x3_730[@i_858]) && ((x4_723 = x4_729[@i_858]) && (x5_722 = x5_728[@i_858]))))) then
      (
        let sk_u: hash0 = r_727[@i_858]
      )
      orfind @i_857 <= NU suchthat defined(x1_738[@i_857], x2_737[@i_857], x3_736[@i_857], x4_735[@i_857], x5_734[@i_857], r_733[@i_857]) && otheruses(r_733[@i_857]) && ((x1_726 = x1_738[@i_857]) && ((x2_725 = x2_737[@i_857]) && ((x3_724 = x3_736[@i_857]) && ((x4_723 = x4_735[@i_857]) && (x5_722 = x5_734[@i_857]))))) then
      (
        let sk_u: hash0 = r_733[@i_857]
      )
      orfind @i_856 <= NU suchthat defined(x1_744[@i_856], x2_743[@i_856], x3_742[@i_856], x4_741[@i_856], x5_740[@i_856], r_739[@i_856]) && otheruses(r_739[@i_856]) && ((x1_726 = x1_744[@i_856]) && ((x2_725 = x2_743[@i_856]) && ((x3_724 = x3_742[@i_856]) && ((x4_723 = x4_741[@i_856]) && (x5_722 = x5_740[@i_856]))))) then
      (
        let sk_u: hash0 = r_739[@i_856]
      )
      orfind @i_855 <= NU suchthat defined(x1_750[@i_855], x2_749[@i_855], x3_748[@i_855], x4_747[@i_855], x5_746[@i_855], r_745[@i_855]) && otheruses(r_745[@i_855]) && ((x1_726 = x1_750[@i_855]) && ((x2_725 = x2_749[@i_855]) && ((x3_724 = x3_748[@i_855]) && ((x4_723 = x4_747[@i_855]) && (x5_722 = x5_746[@i_855]))))) then
      (
        let sk_u: hash0 = r_745[@i_855]
      )
      else
      (
        new r_721: hash0;
        let sk_u: hash0 = r_721
      )
    )
    else
    (
      new r_284: hash1;
      out(c6[!_53], r_284);
      in(c9[!_53], ());
      let x1_720: host = U in
      let x2_719: host = S in
      let x3_718: G = X in
      let x4_717: G = @2_r4_96[@i_144] in
      let x5_716: G = K_u in
      find [unique] @i_854 <= qH0 suchthat defined(x1_678[@i_854], x2_677[@i_854], x3_676[@i_854], x4_675[@i_854], x5_674[@i_854], r_673[@i_854]) && otheruses(r_673[@i_854]) && ((x1_720 = x1_678[@i_854]) && ((x2_719 = x2_677[@i_854]) && ((x3_718 = x3_676[@i_854]) && ((x4_717 = x4_675[@i_854]) && (x5_716 = x5_674[@i_854]))))) then
      (
        let sk_u: hash0 = r_673[@i_854]
      )
      orfind @i_853 <= NP suchthat defined(x1_684[@i_853], x2_683[@i_853], x3_682[@i_853], x4_681[@i_853], x5_680[@i_853], r_679[@i_853]) && otheruses(r_679[@i_853]) && ((x1_720 = x1_684[@i_853]) && ((x2_719 = x2_683[@i_853]) && ((x3_718 = x3_682[@i_853]) && ((x4_717 = x4_681[@i_853]) && (x5_716 = x5_680[@i_853]))))) then
      (
        let sk_u: hash0 = r_679[@i_853]
      )
      orfind @i_852 <= NS suchthat defined(x1_690[@i_852], x2_689[@i_852], x3_688[@i_852], x4_687[@i_852], x5_686[@i_852], r_685[@i_852]) && otheruses(r_685[@i_852]) && ((x1_720 = x1_690[@i_852]) && ((x2_719 = x2_689[@i_852]) && ((x3_718 = x3_688[@i_852]) && ((x4_717 = x4_687[@i_852]) && (x5_716 = x5_686[@i_852]))))) then
      (
        let sk_u: hash0 = r_685[@i_852]
      )
      orfind @i_851 <= NS suchthat defined(x1_696[@i_851], x2_695[@i_851], x3_694[@i_851], x4_693[@i_851], x5_692[@i_851], r_691[@i_851]) && otheruses(r_691[@i_851]) && ((x1_720 = x1_696[@i_851]) && ((x2_719 = x2_695[@i_851]) && ((x3_718 = x3_694[@i_851]) && ((x4_717 = x4_693[@i_851]) && (x5_716 = x5_692[@i_851]))))) then
      (
        let sk_u: hash0 = r_691[@i_851]
      )
      orfind @i_850 <= NU suchthat defined(x1_702[@i_850], x2_701[@i_850], x3_700[@i_850], x4_699[@i_850], x5_698[@i_850], r_697[@i_850]) && otheruses(r_697[@i_850]) && ((x1_720 = x1_702[@i_850]) && ((x2_719 = x2_701[@i_850]) && ((x3_718 = x3_700[@i_850]) && ((x4_717 = x4_699[@i_850]) && (x5_716 = x5_698[@i_850]))))) then
      (
        let sk_u: hash0 = r_697[@i_850]
      )
      orfind @i_849 <= NU suchthat defined(x1_708[@i_849], x2_707[@i_849], x3_706[@i_849], x4_705[@i_849], x5_704[@i_849], r_703[@i_849]) && otheruses(r_703[@i_849]) && ((x1_720 = x1_708[@i_849]) && ((x2_719 = x2_707[@i_849]) && ((x3_718 = x3_706[@i_849]) && ((x4_717 = x4_705[@i_849]) && (x5_716 = x5_704[@i_849]))))) then
      (
        let sk_u: hash0 = r_703[@i_849]
      )
      orfind @i_848 <= NU suchthat defined(x1_714[@i_848], x2_713[@i_848], x3_712[@i_848], x4_711[@i_848], x5_710[@i_848], r_709[@i_848]) && otheruses(r_709[@i_848]) && ((x1_720 = x1_714[@i_848]) && ((x2_719 = x2_713[@i_848]) && ((x3_718 = x3_712[@i_848]) && ((x4_717 = x4_711[@i_848]) && (x5_716 = x5_710[@i_848]))))) then
      (
        let sk_u: hash0 = r_709[@i_848]
      )
      orfind @i_847 <= NU suchthat defined(x1_720[@i_847], x2_719[@i_847], x3_718[@i_847], x4_717[@i_847], x5_716[@i_847], r_715[@i_847]) && otheruses(r_715[@i_847]) && ((x1_720 = x1_720[@i_847]) && ((x2_719 = x2_719[@i_847]) && ((x3_718 = x3_718[@i_847]) && ((x4_717 = x4_717[@i_847]) && (x5_716 = x5_716[@i_847]))))) then
      (
        let sk_u: hash0 = r_715[@i_847]
      )
      orfind @i_846 <= NU suchthat defined(x1_726[@i_846], x2_725[@i_846], x3_724[@i_846], x4_723[@i_846], x5_722[@i_846], r_721[@i_846]) && otheruses(r_721[@i_846]) && ((x1_720 = x1_726[@i_846]) && ((x2_719 = x2_725[@i_846]) && ((x3_718 = x3_724[@i_846]) && ((x4_717 = x4_723[@i_846]) && (x5_716 = x5_722[@i_846]))))) then
      (
        let sk_u: hash0 = r_721[@i_846]
      )
      orfind @i_845 <= NU suchthat defined(x1_732[@i_845], x2_731[@i_845], x3_730[@i_845], x4_729[@i_845], x5_728[@i_845], r_727[@i_845]) && otheruses(r_727[@i_845]) && ((x1_720 = x1_732[@i_845]) && ((x2_719 = x2_731[@i_845]) && ((x3_718 = x3_730[@i_845]) && ((x4_717 = x4_729[@i_845]) && (x5_716 = x5_728[@i_845]))))) then
      (
        let sk_u: hash0 = r_727[@i_845]
      )
      orfind @i_844 <= NU suchthat defined(x1_738[@i_844], x2_737[@i_844], x3_736[@i_844], x4_735[@i_844], x5_734[@i_844], r_733[@i_844]) && otheruses(r_733[@i_844]) && ((x1_720 = x1_738[@i_844]) && ((x2_719 = x2_737[@i_844]) && ((x3_718 = x3_736[@i_844]) && ((x4_717 = x4_735[@i_844]) && (x5_716 = x5_734[@i_844]))))) then
      (
        let sk_u: hash0 = r_733[@i_844]
      )
      orfind @i_843 <= NU suchthat defined(x1_744[@i_843], x2_743[@i_843], x3_742[@i_843], x4_741[@i_843], x5_740[@i_843], r_739[@i_843]) && otheruses(r_739[@i_843]) && ((x1_720 = x1_744[@i_843]) && ((x2_719 = x2_743[@i_843]) && ((x3_718 = x3_742[@i_843]) && ((x4_717 = x4_741[@i_843]) && (x5_716 = x5_740[@i_843]))))) then
      (
        let sk_u: hash0 = r_739[@i_843]
      )
      orfind @i_842 <= NU suchthat defined(x1_750[@i_842], x2_749[@i_842], x3_748[@i_842], x4_747[@i_842], x5_746[@i_842], r_745[@i_842]) && otheruses(r_745[@i_842]) && ((x1_720 = x1_750[@i_842]) && ((x2_719 = x2_749[@i_842]) && ((x3_718 = x3_748[@i_842]) && ((x4_717 = x4_747[@i_842]) && (x5_716 = x5_746[@i_842]))))) then
      (
        let sk_u: hash0 = r_745[@i_842]
      )
      else
      (
        new r_715: hash0;
        let sk_u: hash0 = r_715
      )
    )
  )
  orfind @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  orfind @i_141 <= NP suchthat defined(@2_r2_90[@i_141], yp[@i_141], Yp[@i_141]) && otheruses(@2_r2_90[@i_141]) && (Ystar_u = @2_r2_90[@i_141]) then
  (
    let K_u: G = exp(g, mult(yp[@i_141], x)) in
    let x1_295: host = U in
    let x2_294: host = S in
    let x3_293: G = cst_G in
    let x4_292: G = cst_G in
    let x5_291: G = cst_G in
    find [unique] @i_373 <= qH1 suchthat defined(x1_64[@i_373], x2_63[@i_373], x3_62[@i_373], x4_61[@i_373], x5_60[@i_373], x5_249[@i_373], x4_250[@i_373], x3_251[@i_373], x2_252[@i_373], x1_253[@i_373], r_248[@i_373]) && otheruses(r_248[@i_373]) && ((x1_295 = x1_64[@i_373]) && ((x2_294 = x2_63[@i_373]) && ((X = x3_62[@i_373]) && ((Yp[@i_141] = x4_61[@i_373]) && (K_u = x5_60[@i_373]))))) then
    (
      out(c6[!_53], r_248[@i_373]);
      in(c9[!_53], ());
      let x1_738: host = U in
      let x2_737: host = S in
      let x3_736: G = X in
      let x4_735: G = Yp[@i_141] in
      let x5_734: G = K_u in
      find [unique] @i_893 <= qH0 suchthat defined(x1_678[@i_893], x2_677[@i_893], x3_676[@i_893], x4_675[@i_893], x5_674[@i_893], r_673[@i_893]) && otheruses(r_673[@i_893]) && ((x1_738 = x1_678[@i_893]) && ((x2_737 = x2_677[@i_893]) && ((x3_736 = x3_676[@i_893]) && ((x4_735 = x4_675[@i_893]) && (x5_734 = x5_674[@i_893]))))) then
      (
        let sk_u: hash0 = r_673[@i_893]
      )
      orfind @i_892 <= NP suchthat defined(x1_684[@i_892], x2_683[@i_892], x3_682[@i_892], x4_681[@i_892], x5_680[@i_892], r_679[@i_892]) && otheruses(r_679[@i_892]) && ((x1_738 = x1_684[@i_892]) && ((x2_737 = x2_683[@i_892]) && ((x3_736 = x3_682[@i_892]) && ((x4_735 = x4_681[@i_892]) && (x5_734 = x5_680[@i_892]))))) then
      (
        let sk_u: hash0 = r_679[@i_892]
      )
      orfind @i_891 <= NS suchthat defined(x1_690[@i_891], x2_689[@i_891], x3_688[@i_891], x4_687[@i_891], x5_686[@i_891], r_685[@i_891]) && otheruses(r_685[@i_891]) && ((x1_738 = x1_690[@i_891]) && ((x2_737 = x2_689[@i_891]) && ((x3_736 = x3_688[@i_891]) && ((x4_735 = x4_687[@i_891]) && (x5_734 = x5_686[@i_891]))))) then
      (
        let sk_u: hash0 = r_685[@i_891]
      )
      orfind @i_890 <= NS suchthat defined(x1_696[@i_890], x2_695[@i_890], x3_694[@i_890], x4_693[@i_890], x5_692[@i_890], r_691[@i_890]) && otheruses(r_691[@i_890]) && ((x1_738 = x1_696[@i_890]) && ((x2_737 = x2_695[@i_890]) && ((x3_736 = x3_694[@i_890]) && ((x4_735 = x4_693[@i_890]) && (x5_734 = x5_692[@i_890]))))) then
      (
        let sk_u: hash0 = r_691[@i_890]
      )
      orfind @i_889 <= NU suchthat defined(x1_702[@i_889], x2_701[@i_889], x3_700[@i_889], x4_699[@i_889], x5_698[@i_889], r_697[@i_889]) && otheruses(r_697[@i_889]) && ((x1_738 = x1_702[@i_889]) && ((x2_737 = x2_701[@i_889]) && ((x3_736 = x3_700[@i_889]) && ((x4_735 = x4_699[@i_889]) && (x5_734 = x5_698[@i_889]))))) then
      (
        let sk_u: hash0 = r_697[@i_889]
      )
      orfind @i_888 <= NU suchthat defined(x1_708[@i_888], x2_707[@i_888], x3_706[@i_888], x4_705[@i_888], x5_704[@i_888], r_703[@i_888]) && otheruses(r_703[@i_888]) && ((x1_738 = x1_708[@i_888]) && ((x2_737 = x2_707[@i_888]) && ((x3_736 = x3_706[@i_888]) && ((x4_735 = x4_705[@i_888]) && (x5_734 = x5_704[@i_888]))))) then
      (
        let sk_u: hash0 = r_703[@i_888]
      )
      orfind @i_887 <= NU suchthat defined(x1_714[@i_887], x2_713[@i_887], x3_712[@i_887], x4_711[@i_887], x5_710[@i_887], r_709[@i_887]) && otheruses(r_709[@i_887]) && ((x1_738 = x1_714[@i_887]) && ((x2_737 = x2_713[@i_887]) && ((x3_736 = x3_712[@i_887]) && ((x4_735 = x4_711[@i_887]) && (x5_734 = x5_710[@i_887]))))) then
      (
        let sk_u: hash0 = r_709[@i_887]
      )
      orfind @i_886 <= NU suchthat defined(x1_720[@i_886], x2_719[@i_886], x3_718[@i_886], x4_717[@i_886], x5_716[@i_886], r_715[@i_886]) && otheruses(r_715[@i_886]) && ((x1_738 = x1_720[@i_886]) && ((x2_737 = x2_719[@i_886]) && ((x3_736 = x3_718[@i_886]) && ((x4_735 = x4_717[@i_886]) && (x5_734 = x5_716[@i_886]))))) then
      (
        let sk_u: hash0 = r_715[@i_886]
      )
      orfind @i_885 <= NU suchthat defined(x1_726[@i_885], x2_725[@i_885], x3_724[@i_885], x4_723[@i_885], x5_722[@i_885], r_721[@i_885]) && otheruses(r_721[@i_885]) && ((x1_738 = x1_726[@i_885]) && ((x2_737 = x2_725[@i_885]) && ((x3_736 = x3_724[@i_885]) && ((x4_735 = x4_723[@i_885]) && (x5_734 = x5_722[@i_885]))))) then
      (
        let sk_u: hash0 = r_721[@i_885]
      )
      orfind @i_884 <= NU suchthat defined(x1_732[@i_884], x2_731[@i_884], x3_730[@i_884], x4_729[@i_884], x5_728[@i_884], r_727[@i_884]) && otheruses(r_727[@i_884]) && ((x1_738 = x1_732[@i_884]) && ((x2_737 = x2_731[@i_884]) && ((x3_736 = x3_730[@i_884]) && ((x4_735 = x4_729[@i_884]) && (x5_734 = x5_728[@i_884]))))) then
      (
        let sk_u: hash0 = r_727[@i_884]
      )
      orfind @i_883 <= NU suchthat defined(x1_738[@i_883], x2_737[@i_883], x3_736[@i_883], x4_735[@i_883], x5_734[@i_883], r_733[@i_883]) && otheruses(r_733[@i_883]) && ((x1_738 = x1_738[@i_883]) && ((x2_737 = x2_737[@i_883]) && ((x3_736 = x3_736[@i_883]) && ((x4_735 = x4_735[@i_883]) && (x5_734 = x5_734[@i_883]))))) then
      (
        let sk_u: hash0 = r_733[@i_883]
      )
      orfind @i_882 <= NU suchthat defined(x1_744[@i_882], x2_743[@i_882], x3_742[@i_882], x4_741[@i_882], x5_740[@i_882], r_739[@i_882]) && otheruses(r_739[@i_882]) && ((x1_738 = x1_744[@i_882]) && ((x2_737 = x2_743[@i_882]) && ((x3_736 = x3_742[@i_882]) && ((x4_735 = x4_741[@i_882]) && (x5_734 = x5_740[@i_882]))))) then
      (
        let sk_u: hash0 = r_739[@i_882]
      )
      orfind @i_881 <= NU suchthat defined(x1_750[@i_881], x2_749[@i_881], x3_748[@i_881], x4_747[@i_881], x5_746[@i_881], r_745[@i_881]) && otheruses(r_745[@i_881]) && ((x1_738 = x1_750[@i_881]) && ((x2_737 = x2_749[@i_881]) && ((x3_736 = x3_748[@i_881]) && ((x4_735 = x4_747[@i_881]) && (x5_734 = x5_746[@i_881]))))) then
      (
        let sk_u: hash0 = r_745[@i_881]
      )
      else
      (
        new r_733: hash0;
        let sk_u: hash0 = r_733
      )
    )
    else
    (
      new r_290: hash1;
      out(c6[!_53], r_290);
      in(c9[!_53], ());
      let x1_732: host = U in
      let x2_731: host = S in
      let x3_730: G = X in
      let x4_729: G = Yp[@i_141] in
      let x5_728: G = K_u in
      find [unique] @i_880 <= qH0 suchthat defined(x1_678[@i_880], x2_677[@i_880], x3_676[@i_880], x4_675[@i_880], x5_674[@i_880], r_673[@i_880]) && otheruses(r_673[@i_880]) && ((x1_732 = x1_678[@i_880]) && ((x2_731 = x2_677[@i_880]) && ((x3_730 = x3_676[@i_880]) && ((x4_729 = x4_675[@i_880]) && (x5_728 = x5_674[@i_880]))))) then
      (
        let sk_u: hash0 = r_673[@i_880]
      )
      orfind @i_879 <= NP suchthat defined(x1_684[@i_879], x2_683[@i_879], x3_682[@i_879], x4_681[@i_879], x5_680[@i_879], r_679[@i_879]) && otheruses(r_679[@i_879]) && ((x1_732 = x1_684[@i_879]) && ((x2_731 = x2_683[@i_879]) && ((x3_730 = x3_682[@i_879]) && ((x4_729 = x4_681[@i_879]) && (x5_728 = x5_680[@i_879]))))) then
      (
        let sk_u: hash0 = r_679[@i_879]
      )
      orfind @i_878 <= NS suchthat defined(x1_690[@i_878], x2_689[@i_878], x3_688[@i_878], x4_687[@i_878], x5_686[@i_878], r_685[@i_878]) && otheruses(r_685[@i_878]) && ((x1_732 = x1_690[@i_878]) && ((x2_731 = x2_689[@i_878]) && ((x3_730 = x3_688[@i_878]) && ((x4_729 = x4_687[@i_878]) && (x5_728 = x5_686[@i_878]))))) then
      (
        let sk_u: hash0 = r_685[@i_878]
      )
      orfind @i_877 <= NS suchthat defined(x1_696[@i_877], x2_695[@i_877], x3_694[@i_877], x4_693[@i_877], x5_692[@i_877], r_691[@i_877]) && otheruses(r_691[@i_877]) && ((x1_732 = x1_696[@i_877]) && ((x2_731 = x2_695[@i_877]) && ((x3_730 = x3_694[@i_877]) && ((x4_729 = x4_693[@i_877]) && (x5_728 = x5_692[@i_877]))))) then
      (
        let sk_u: hash0 = r_691[@i_877]
      )
      orfind @i_876 <= NU suchthat defined(x1_702[@i_876], x2_701[@i_876], x3_700[@i_876], x4_699[@i_876], x5_698[@i_876], r_697[@i_876]) && otheruses(r_697[@i_876]) && ((x1_732 = x1_702[@i_876]) && ((x2_731 = x2_701[@i_876]) && ((x3_730 = x3_700[@i_876]) && ((x4_729 = x4_699[@i_876]) && (x5_728 = x5_698[@i_876]))))) then
      (
        let sk_u: hash0 = r_697[@i_876]
      )
      orfind @i_875 <= NU suchthat defined(x1_708[@i_875], x2_707[@i_875], x3_706[@i_875], x4_705[@i_875], x5_704[@i_875], r_703[@i_875]) && otheruses(r_703[@i_875]) && ((x1_732 = x1_708[@i_875]) && ((x2_731 = x2_707[@i_875]) && ((x3_730 = x3_706[@i_875]) && ((x4_729 = x4_705[@i_875]) && (x5_728 = x5_704[@i_875]))))) then
      (
        let sk_u: hash0 = r_703[@i_875]
      )
      orfind @i_874 <= NU suchthat defined(x1_714[@i_874], x2_713[@i_874], x3_712[@i_874], x4_711[@i_874], x5_710[@i_874], r_709[@i_874]) && otheruses(r_709[@i_874]) && ((x1_732 = x1_714[@i_874]) && ((x2_731 = x2_713[@i_874]) && ((x3_730 = x3_712[@i_874]) && ((x4_729 = x4_711[@i_874]) && (x5_728 = x5_710[@i_874]))))) then
      (
        let sk_u: hash0 = r_709[@i_874]
      )
      orfind @i_873 <= NU suchthat defined(x1_720[@i_873], x2_719[@i_873], x3_718[@i_873], x4_717[@i_873], x5_716[@i_873], r_715[@i_873]) && otheruses(r_715[@i_873]) && ((x1_732 = x1_720[@i_873]) && ((x2_731 = x2_719[@i_873]) && ((x3_730 = x3_718[@i_873]) && ((x4_729 = x4_717[@i_873]) && (x5_728 = x5_716[@i_873]))))) then
      (
        let sk_u: hash0 = r_715[@i_873]
      )
      orfind @i_872 <= NU suchthat defined(x1_726[@i_872], x2_725[@i_872], x3_724[@i_872], x4_723[@i_872], x5_722[@i_872], r_721[@i_872]) && otheruses(r_721[@i_872]) && ((x1_732 = x1_726[@i_872]) && ((x2_731 = x2_725[@i_872]) && ((x3_730 = x3_724[@i_872]) && ((x4_729 = x4_723[@i_872]) && (x5_728 = x5_722[@i_872]))))) then
      (
        let sk_u: hash0 = r_721[@i_872]
      )
      orfind @i_871 <= NU suchthat defined(x1_732[@i_871], x2_731[@i_871], x3_730[@i_871], x4_729[@i_871], x5_728[@i_871], r_727[@i_871]) && otheruses(r_727[@i_871]) && ((x1_732 = x1_732[@i_871]) && ((x2_731 = x2_731[@i_871]) && ((x3_730 = x3_730[@i_871]) && ((x4_729 = x4_729[@i_871]) && (x5_728 = x5_728[@i_871]))))) then
      (
        let sk_u: hash0 = r_727[@i_871]
      )
      orfind @i_870 <= NU suchthat defined(x1_738[@i_870], x2_737[@i_870], x3_736[@i_870], x4_735[@i_870], x5_734[@i_870], r_733[@i_870]) && otheruses(r_733[@i_870]) && ((x1_732 = x1_738[@i_870]) && ((x2_731 = x2_737[@i_870]) && ((x3_730 = x3_736[@i_870]) && ((x4_729 = x4_735[@i_870]) && (x5_728 = x5_734[@i_870]))))) then
      (
        let sk_u: hash0 = r_733[@i_870]
      )
      orfind @i_869 <= NU suchthat defined(x1_744[@i_869], x2_743[@i_869], x3_742[@i_869], x4_741[@i_869], x5_740[@i_869], r_739[@i_869]) && otheruses(r_739[@i_869]) && ((x1_732 = x1_744[@i_869]) && ((x2_731 = x2_743[@i_869]) && ((x3_730 = x3_742[@i_869]) && ((x4_729 = x4_741[@i_869]) && (x5_728 = x5_740[@i_869]))))) then
      (
        let sk_u: hash0 = r_739[@i_869]
      )
      orfind @i_868 <= NU suchthat defined(x1_750[@i_868], x2_749[@i_868], x3_748[@i_868], x4_747[@i_868], x5_746[@i_868], r_745[@i_868]) && otheruses(r_745[@i_868]) && ((x1_732 = x1_750[@i_868]) && ((x2_731 = x2_749[@i_868]) && ((x3_730 = x3_748[@i_868]) && ((x4_729 = x4_747[@i_868]) && (x5_728 = x5_746[@i_868]))))) then
      (
        let sk_u: hash0 = r_745[@i_868]
      )
      else
      (
        new r_727: hash0;
        let sk_u: hash0 = r_727
      )
    )
  )
  orfind @i_140 <= NS suchthat defined(@2_r2_93[@i_140], y[@i_140], Y[@i_140]) && otheruses(@2_r2_93[@i_140]) && (Ystar_u = @2_r2_93[@i_140]) then
  (
    let K_u: G = exp(g, mult(y[@i_140], x)) in
    let x1_301: host = U in
    let x2_300: host = S in
    let x3_299: G = cst_G in
    let x4_298: G = cst_G in
    let x5_297: G = cst_G in
    find [unique] @i_382 <= qH1 suchthat defined(x1_64[@i_382], x2_63[@i_382], x3_62[@i_382], x4_61[@i_382], x5_60[@i_382], x5_249[@i_382], x4_250[@i_382], x3_251[@i_382], x2_252[@i_382], x1_253[@i_382], r_248[@i_382]) && otheruses(r_248[@i_382]) && ((x1_301 = x1_64[@i_382]) && ((x2_300 = x2_63[@i_382]) && ((X = x3_62[@i_382]) && ((Y[@i_140] = x4_61[@i_382]) && (K_u = x5_60[@i_382]))))) then
    (
      out(c6[!_53], r_248[@i_382]);
      in(c9[!_53], ());
      let x1_750: host = U in
      let x2_749: host = S in
      let x3_748: G = X in
      let x4_747: G = Y[@i_140] in
      let x5_746: G = K_u in
      find [unique] @i_919 <= qH0 suchthat defined(x1_678[@i_919], x2_677[@i_919], x3_676[@i_919], x4_675[@i_919], x5_674[@i_919], r_673[@i_919]) && otheruses(r_673[@i_919]) && ((x1_750 = x1_678[@i_919]) && ((x2_749 = x2_677[@i_919]) && ((x3_748 = x3_676[@i_919]) && ((x4_747 = x4_675[@i_919]) && (x5_746 = x5_674[@i_919]))))) then
      (
        let sk_u: hash0 = r_673[@i_919]
      )
      orfind @i_918 <= NP suchthat defined(x1_684[@i_918], x2_683[@i_918], x3_682[@i_918], x4_681[@i_918], x5_680[@i_918], r_679[@i_918]) && otheruses(r_679[@i_918]) && ((x1_750 = x1_684[@i_918]) && ((x2_749 = x2_683[@i_918]) && ((x3_748 = x3_682[@i_918]) && ((x4_747 = x4_681[@i_918]) && (x5_746 = x5_680[@i_918]))))) then
      (
        let sk_u: hash0 = r_679[@i_918]
      )
      orfind @i_917 <= NS suchthat defined(x1_690[@i_917], x2_689[@i_917], x3_688[@i_917], x4_687[@i_917], x5_686[@i_917], r_685[@i_917]) && otheruses(r_685[@i_917]) && ((x1_750 = x1_690[@i_917]) && ((x2_749 = x2_689[@i_917]) && ((x3_748 = x3_688[@i_917]) && ((x4_747 = x4_687[@i_917]) && (x5_746 = x5_686[@i_917]))))) then
      (
        let sk_u: hash0 = r_685[@i_917]
      )
      orfind @i_916 <= NS suchthat defined(x1_696[@i_916], x2_695[@i_916], x3_694[@i_916], x4_693[@i_916], x5_692[@i_916], r_691[@i_916]) && otheruses(r_691[@i_916]) && ((x1_750 = x1_696[@i_916]) && ((x2_749 = x2_695[@i_916]) && ((x3_748 = x3_694[@i_916]) && ((x4_747 = x4_693[@i_916]) && (x5_746 = x5_692[@i_916]))))) then
      (
        let sk_u: hash0 = r_691[@i_916]
      )
      orfind @i_915 <= NU suchthat defined(x1_702[@i_915], x2_701[@i_915], x3_700[@i_915], x4_699[@i_915], x5_698[@i_915], r_697[@i_915]) && otheruses(r_697[@i_915]) && ((x1_750 = x1_702[@i_915]) && ((x2_749 = x2_701[@i_915]) && ((x3_748 = x3_700[@i_915]) && ((x4_747 = x4_699[@i_915]) && (x5_746 = x5_698[@i_915]))))) then
      (
        let sk_u: hash0 = r_697[@i_915]
      )
      orfind @i_914 <= NU suchthat defined(x1_708[@i_914], x2_707[@i_914], x3_706[@i_914], x4_705[@i_914], x5_704[@i_914], r_703[@i_914]) && otheruses(r_703[@i_914]) && ((x1_750 = x1_708[@i_914]) && ((x2_749 = x2_707[@i_914]) && ((x3_748 = x3_706[@i_914]) && ((x4_747 = x4_705[@i_914]) && (x5_746 = x5_704[@i_914]))))) then
      (
        let sk_u: hash0 = r_703[@i_914]
      )
      orfind @i_913 <= NU suchthat defined(x1_714[@i_913], x2_713[@i_913], x3_712[@i_913], x4_711[@i_913], x5_710[@i_913], r_709[@i_913]) && otheruses(r_709[@i_913]) && ((x1_750 = x1_714[@i_913]) && ((x2_749 = x2_713[@i_913]) && ((x3_748 = x3_712[@i_913]) && ((x4_747 = x4_711[@i_913]) && (x5_746 = x5_710[@i_913]))))) then
      (
        let sk_u: hash0 = r_709[@i_913]
      )
      orfind @i_912 <= NU suchthat defined(x1_720[@i_912], x2_719[@i_912], x3_718[@i_912], x4_717[@i_912], x5_716[@i_912], r_715[@i_912]) && otheruses(r_715[@i_912]) && ((x1_750 = x1_720[@i_912]) && ((x2_749 = x2_719[@i_912]) && ((x3_748 = x3_718[@i_912]) && ((x4_747 = x4_717[@i_912]) && (x5_746 = x5_716[@i_912]))))) then
      (
        let sk_u: hash0 = r_715[@i_912]
      )
      orfind @i_911 <= NU suchthat defined(x1_726[@i_911], x2_725[@i_911], x3_724[@i_911], x4_723[@i_911], x5_722[@i_911], r_721[@i_911]) && otheruses(r_721[@i_911]) && ((x1_750 = x1_726[@i_911]) && ((x2_749 = x2_725[@i_911]) && ((x3_748 = x3_724[@i_911]) && ((x4_747 = x4_723[@i_911]) && (x5_746 = x5_722[@i_911]))))) then
      (
        let sk_u: hash0 = r_721[@i_911]
      )
      orfind @i_910 <= NU suchthat defined(x1_732[@i_910], x2_731[@i_910], x3_730[@i_910], x4_729[@i_910], x5_728[@i_910], r_727[@i_910]) && otheruses(r_727[@i_910]) && ((x1_750 = x1_732[@i_910]) && ((x2_749 = x2_731[@i_910]) && ((x3_748 = x3_730[@i_910]) && ((x4_747 = x4_729[@i_910]) && (x5_746 = x5_728[@i_910]))))) then
      (
        let sk_u: hash0 = r_727[@i_910]
      )
      orfind @i_909 <= NU suchthat defined(x1_738[@i_909], x2_737[@i_909], x3_736[@i_909], x4_735[@i_909], x5_734[@i_909], r_733[@i_909]) && otheruses(r_733[@i_909]) && ((x1_750 = x1_738[@i_909]) && ((x2_749 = x2_737[@i_909]) && ((x3_748 = x3_736[@i_909]) && ((x4_747 = x4_735[@i_909]) && (x5_746 = x5_734[@i_909]))))) then
      (
        let sk_u: hash0 = r_733[@i_909]
      )
      orfind @i_908 <= NU suchthat defined(x1_744[@i_908], x2_743[@i_908], x3_742[@i_908], x4_741[@i_908], x5_740[@i_908], r_739[@i_908]) && otheruses(r_739[@i_908]) && ((x1_750 = x1_744[@i_908]) && ((x2_749 = x2_743[@i_908]) && ((x3_748 = x3_742[@i_908]) && ((x4_747 = x4_741[@i_908]) && (x5_746 = x5_740[@i_908]))))) then
      (
        let sk_u: hash0 = r_739[@i_908]
      )
      orfind @i_907 <= NU suchthat defined(x1_750[@i_907], x2_749[@i_907], x3_748[@i_907], x4_747[@i_907], x5_746[@i_907], r_745[@i_907]) && otheruses(r_745[@i_907]) && ((x1_750 = x1_750[@i_907]) && ((x2_749 = x2_749[@i_907]) && ((x3_748 = x3_748[@i_907]) && ((x4_747 = x4_747[@i_907]) && (x5_746 = x5_746[@i_907]))))) then
      (
        let sk_u: hash0 = r_745[@i_907]
      )
      else
      (
        new r_745: hash0;
        let sk_u: hash0 = r_745
      )
    )
    else
    (
      new r_296: hash1;
      out(c6[!_53], r_296);
      in(c9[!_53], ());
      let x1_744: host = U in
      let x2_743: host = S in
      let x3_742: G = X in
      let x4_741: G = Y[@i_140] in
      let x5_740: G = K_u in
      find [unique] @i_906 <= qH0 suchthat defined(x1_678[@i_906], x2_677[@i_906], x3_676[@i_906], x4_675[@i_906], x5_674[@i_906], r_673[@i_906]) && otheruses(r_673[@i_906]) && ((x1_744 = x1_678[@i_906]) && ((x2_743 = x2_677[@i_906]) && ((x3_742 = x3_676[@i_906]) && ((x4_741 = x4_675[@i_906]) && (x5_740 = x5_674[@i_906]))))) then
      (
        let sk_u: hash0 = r_673[@i_906]
      )
      orfind @i_905 <= NP suchthat defined(x1_684[@i_905], x2_683[@i_905], x3_682[@i_905], x4_681[@i_905], x5_680[@i_905], r_679[@i_905]) && otheruses(r_679[@i_905]) && ((x1_744 = x1_684[@i_905]) && ((x2_743 = x2_683[@i_905]) && ((x3_742 = x3_682[@i_905]) && ((x4_741 = x4_681[@i_905]) && (x5_740 = x5_680[@i_905]))))) then
      (
        let sk_u: hash0 = r_679[@i_905]
      )
      orfind @i_904 <= NS suchthat defined(x1_690[@i_904], x2_689[@i_904], x3_688[@i_904], x4_687[@i_904], x5_686[@i_904], r_685[@i_904]) && otheruses(r_685[@i_904]) && ((x1_744 = x1_690[@i_904]) && ((x2_743 = x2_689[@i_904]) && ((x3_742 = x3_688[@i_904]) && ((x4_741 = x4_687[@i_904]) && (x5_740 = x5_686[@i_904]))))) then
      (
        let sk_u: hash0 = r_685[@i_904]
      )
      orfind @i_903 <= NS suchthat defined(x1_696[@i_903], x2_695[@i_903], x3_694[@i_903], x4_693[@i_903], x5_692[@i_903], r_691[@i_903]) && otheruses(r_691[@i_903]) && ((x1_744 = x1_696[@i_903]) && ((x2_743 = x2_695[@i_903]) && ((x3_742 = x3_694[@i_903]) && ((x4_741 = x4_693[@i_903]) && (x5_740 = x5_692[@i_903]))))) then
      (
        let sk_u: hash0 = r_691[@i_903]
      )
      orfind @i_902 <= NU suchthat defined(x1_702[@i_902], x2_701[@i_902], x3_700[@i_902], x4_699[@i_902], x5_698[@i_902], r_697[@i_902]) && otheruses(r_697[@i_902]) && ((x1_744 = x1_702[@i_902]) && ((x2_743 = x2_701[@i_902]) && ((x3_742 = x3_700[@i_902]) && ((x4_741 = x4_699[@i_902]) && (x5_740 = x5_698[@i_902]))))) then
      (
        let sk_u: hash0 = r_697[@i_902]
      )
      orfind @i_901 <= NU suchthat defined(x1_708[@i_901], x2_707[@i_901], x3_706[@i_901], x4_705[@i_901], x5_704[@i_901], r_703[@i_901]) && otheruses(r_703[@i_901]) && ((x1_744 = x1_708[@i_901]) && ((x2_743 = x2_707[@i_901]) && ((x3_742 = x3_706[@i_901]) && ((x4_741 = x4_705[@i_901]) && (x5_740 = x5_704[@i_901]))))) then
      (
        let sk_u: hash0 = r_703[@i_901]
      )
      orfind @i_900 <= NU suchthat defined(x1_714[@i_900], x2_713[@i_900], x3_712[@i_900], x4_711[@i_900], x5_710[@i_900], r_709[@i_900]) && otheruses(r_709[@i_900]) && ((x1_744 = x1_714[@i_900]) && ((x2_743 = x2_713[@i_900]) && ((x3_742 = x3_712[@i_900]) && ((x4_741 = x4_711[@i_900]) && (x5_740 = x5_710[@i_900]))))) then
      (
        let sk_u: hash0 = r_709[@i_900]
      )
      orfind @i_899 <= NU suchthat defined(x1_720[@i_899], x2_719[@i_899], x3_718[@i_899], x4_717[@i_899], x5_716[@i_899], r_715[@i_899]) && otheruses(r_715[@i_899]) && ((x1_744 = x1_720[@i_899]) && ((x2_743 = x2_719[@i_899]) && ((x3_742 = x3_718[@i_899]) && ((x4_741 = x4_717[@i_899]) && (x5_740 = x5_716[@i_899]))))) then
      (
        let sk_u: hash0 = r_715[@i_899]
      )
      orfind @i_898 <= NU suchthat defined(x1_726[@i_898], x2_725[@i_898], x3_724[@i_898], x4_723[@i_898], x5_722[@i_898], r_721[@i_898]) && otheruses(r_721[@i_898]) && ((x1_744 = x1_726[@i_898]) && ((x2_743 = x2_725[@i_898]) && ((x3_742 = x3_724[@i_898]) && ((x4_741 = x4_723[@i_898]) && (x5_740 = x5_722[@i_898]))))) then
      (
        let sk_u: hash0 = r_721[@i_898]
      )
      orfind @i_897 <= NU suchthat defined(x1_732[@i_897], x2_731[@i_897], x3_730[@i_897], x4_729[@i_897], x5_728[@i_897], r_727[@i_897]) && otheruses(r_727[@i_897]) && ((x1_744 = x1_732[@i_897]) && ((x2_743 = x2_731[@i_897]) && ((x3_742 = x3_730[@i_897]) && ((x4_741 = x4_729[@i_897]) && (x5_740 = x5_728[@i_897]))))) then
      (
        let sk_u: hash0 = r_727[@i_897]
      )
      orfind @i_896 <= NU suchthat defined(x1_738[@i_896], x2_737[@i_896], x3_736[@i_896], x4_735[@i_896], x5_734[@i_896], r_733[@i_896]) && otheruses(r_733[@i_896]) && ((x1_744 = x1_738[@i_896]) && ((x2_743 = x2_737[@i_896]) && ((x3_742 = x3_736[@i_896]) && ((x4_741 = x4_735[@i_896]) && (x5_740 = x5_734[@i_896]))))) then
      (
        let sk_u: hash0 = r_733[@i_896]
      )
      orfind @i_895 <= NU suchthat defined(x1_744[@i_895], x2_743[@i_895], x3_742[@i_895], x4_741[@i_895], x5_740[@i_895], r_739[@i_895]) && otheruses(r_739[@i_895]) && ((x1_744 = x1_744[@i_895]) && ((x2_743 = x2_743[@i_895]) && ((x3_742 = x3_742[@i_895]) && ((x4_741 = x4_741[@i_895]) && (x5_740 = x5_740[@i_895]))))) then
      (
        let sk_u: hash0 = r_739[@i_895]
      )
      orfind @i_894 <= NU suchthat defined(x1_750[@i_894], x2_749[@i_894], x3_748[@i_894], x4_747[@i_894], x5_746[@i_894], r_745[@i_894]) && otheruses(r_745[@i_894]) && ((x1_744 = x1_750[@i_894]) && ((x2_743 = x2_749[@i_894]) && ((x3_742 = x3_748[@i_894]) && ((x4_741 = x4_747[@i_894]) && (x5_740 = x5_746[@i_894]))))) then
      (
        let sk_u: hash0 = r_745[@i_894]
      )
      else
      (
        new r_739: hash0;
        let sk_u: hash0 = r_739
      )
    )
  )
  else
  (
    new @2_r4_96: G;
    let K_u: G = exp(@2_r4_96, x) in
    let x1_277: host = U in
    let x2_276: host = S in
    let x3_275: G = cst_G in
    let x4_274: G = cst_G in
    let x5_273: G = cst_G in
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ());
    let x1_702: host = U in
    let x2_701: host = S in
    let x3_700: G = X in
    let x4_699: G = @2_r4_96 in
    let x5_698: G = K_u in
    find [unique] @i_815 <= qH0 suchthat defined(x1_678[@i_815], x2_677[@i_815], x3_676[@i_815], x4_675[@i_815], x5_674[@i_815], r_673[@i_815]) && otheruses(r_673[@i_815]) && ((x1_702 = x1_678[@i_815]) && ((x2_701 = x2_677[@i_815]) && ((x3_700 = x3_676[@i_815]) && ((x4_699 = x4_675[@i_815]) && (x5_698 = x5_674[@i_815]))))) then
    (
      let sk_u: hash0 = r_673[@i_815]
    )
    orfind @i_814 <= NP suchthat defined(x1_684[@i_814], x2_683[@i_814], x3_682[@i_814], x4_681[@i_814], x5_680[@i_814], r_679[@i_814]) && otheruses(r_679[@i_814]) && ((x1_702 = x1_684[@i_814]) && ((x2_701 = x2_683[@i_814]) && ((x3_700 = x3_682[@i_814]) && ((x4_699 = x4_681[@i_814]) && (x5_698 = x5_680[@i_814]))))) then
    (
      let sk_u: hash0 = r_679[@i_814]
    )
    orfind @i_813 <= NS suchthat defined(x1_690[@i_813], x2_689[@i_813], x3_688[@i_813], x4_687[@i_813], x5_686[@i_813], r_685[@i_813]) && otheruses(r_685[@i_813]) && ((x1_702 = x1_690[@i_813]) && ((x2_701 = x2_689[@i_813]) && ((x3_700 = x3_688[@i_813]) && ((x4_699 = x4_687[@i_813]) && (x5_698 = x5_686[@i_813]))))) then
    (
      let sk_u: hash0 = r_685[@i_813]
    )
    orfind @i_812 <= NS suchthat defined(x1_696[@i_812], x2_695[@i_812], x3_694[@i_812], x4_693[@i_812], x5_692[@i_812], r_691[@i_812]) && otheruses(r_691[@i_812]) && ((x1_702 = x1_696[@i_812]) && ((x2_701 = x2_695[@i_812]) && ((x3_700 = x3_694[@i_812]) && ((x4_699 = x4_693[@i_812]) && (x5_698 = x5_692[@i_812]))))) then
    (
      let sk_u: hash0 = r_691[@i_812]
    )
    orfind @i_811 <= NU suchthat defined(x1_702[@i_811], x2_701[@i_811], x3_700[@i_811], x4_699[@i_811], x5_698[@i_811], r_697[@i_811]) && otheruses(r_697[@i_811]) && ((x1_702 = x1_702[@i_811]) && ((x2_701 = x2_701[@i_811]) && ((x3_700 = x3_700[@i_811]) && ((x4_699 = x4_699[@i_811]) && (x5_698 = x5_698[@i_811]))))) then
    (
      let sk_u: hash0 = r_697[@i_811]
    )
    orfind @i_810 <= NU suchthat defined(x1_708[@i_810], x2_707[@i_810], x3_706[@i_810], x4_705[@i_810], x5_704[@i_810], r_703[@i_810]) && otheruses(r_703[@i_810]) && ((x1_702 = x1_708[@i_810]) && ((x2_701 = x2_707[@i_810]) && ((x3_700 = x3_706[@i_810]) && ((x4_699 = x4_705[@i_810]) && (x5_698 = x5_704[@i_810]))))) then
    (
      let sk_u: hash0 = r_703[@i_810]
    )
    orfind @i_809 <= NU suchthat defined(x1_714[@i_809], x2_713[@i_809], x3_712[@i_809], x4_711[@i_809], x5_710[@i_809], r_709[@i_809]) && otheruses(r_709[@i_809]) && ((x1_702 = x1_714[@i_809]) && ((x2_701 = x2_713[@i_809]) && ((x3_700 = x3_712[@i_809]) && ((x4_699 = x4_711[@i_809]) && (x5_698 = x5_710[@i_809]))))) then
    (
      let sk_u: hash0 = r_709[@i_809]
    )
    orfind @i_808 <= NU suchthat defined(x1_720[@i_808], x2_719[@i_808], x3_718[@i_808], x4_717[@i_808], x5_716[@i_808], r_715[@i_808]) && otheruses(r_715[@i_808]) && ((x1_702 = x1_720[@i_808]) && ((x2_701 = x2_719[@i_808]) && ((x3_700 = x3_718[@i_808]) && ((x4_699 = x4_717[@i_808]) && (x5_698 = x5_716[@i_808]))))) then
    (
      let sk_u: hash0 = r_715[@i_808]
    )
    orfind @i_807 <= NU suchthat defined(x1_726[@i_807], x2_725[@i_807], x3_724[@i_807], x4_723[@i_807], x5_722[@i_807], r_721[@i_807]) && otheruses(r_721[@i_807]) && ((x1_702 = x1_726[@i_807]) && ((x2_701 = x2_725[@i_807]) && ((x3_700 = x3_724[@i_807]) && ((x4_699 = x4_723[@i_807]) && (x5_698 = x5_722[@i_807]))))) then
    (
      let sk_u: hash0 = r_721[@i_807]
    )
    orfind @i_806 <= NU suchthat defined(x1_732[@i_806], x2_731[@i_806], x3_730[@i_806], x4_729[@i_806], x5_728[@i_806], r_727[@i_806]) && otheruses(r_727[@i_806]) && ((x1_702 = x1_732[@i_806]) && ((x2_701 = x2_731[@i_806]) && ((x3_700 = x3_730[@i_806]) && ((x4_699 = x4_729[@i_806]) && (x5_698 = x5_728[@i_806]))))) then
    (
      let sk_u: hash0 = r_727[@i_806]
    )
    orfind @i_805 <= NU suchthat defined(x1_738[@i_805], x2_737[@i_805], x3_736[@i_805], x4_735[@i_805], x5_734[@i_805], r_733[@i_805]) && otheruses(r_733[@i_805]) && ((x1_702 = x1_738[@i_805]) && ((x2_701 = x2_737[@i_805]) && ((x3_700 = x3_736[@i_805]) && ((x4_699 = x4_735[@i_805]) && (x5_698 = x5_734[@i_805]))))) then
    (
      let sk_u: hash0 = r_733[@i_805]
    )
    orfind @i_804 <= NU suchthat defined(x1_744[@i_804], x2_743[@i_804], x3_742[@i_804], x4_741[@i_804], x5_740[@i_804], r_739[@i_804]) && otheruses(r_739[@i_804]) && ((x1_702 = x1_744[@i_804]) && ((x2_701 = x2_743[@i_804]) && ((x3_700 = x3_742[@i_804]) && ((x4_699 = x4_741[@i_804]) && (x5_698 = x5_740[@i_804]))))) then
    (
      let sk_u: hash0 = r_739[@i_804]
    )
    orfind @i_803 <= NU suchthat defined(x1_750[@i_803], x2_749[@i_803], x3_748[@i_803], x4_747[@i_803], x5_746[@i_803], r_745[@i_803]) && otheruses(r_745[@i_803]) && ((x1_702 = x1_750[@i_803]) && ((x2_701 = x2_749[@i_803]) && ((x3_700 = x3_748[@i_803]) && ((x4_699 = x4_747[@i_803]) && (x5_698 = x5_746[@i_803]))))) then
    (
      let sk_u: hash0 = r_745[@i_803]
    )
    else
    (
      new r_697: hash0;
      let sk_u: hash0 = r_697
    )
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_271: host = U in
    let x2_270: host = S in
    find [unique] @i_337 <= qH1 suchthat defined(x1_64[@i_337], x2_63[@i_337], x3_62[@i_337], x4_61[@i_337], x5_60[@i_337], x5_249[@i_337], x4_250[@i_337], x3_251[@i_337], x2_252[@i_337], x1_253[@i_337], r_248[@i_337]) && otheruses(r_248[@i_337]) && ((x1_271 = x1_64[@i_337]) && ((x2_270 = x2_63[@i_337]) && ((X_s = x3_62[@i_337]) && ((Y = x4_61[@i_337]) && (K_s = x5_60[@i_337]))))) then
    (
      if (auth_s = r_248[@i_337]) then
      let x1_690: host = U in
      let x2_689: host = S in
      let x3_688: G = X_s in
      let x4_687: G = Y in
      let x5_686: G = K_s in
      find [unique] @i_789 <= qH0 suchthat defined(x1_678[@i_789], x2_677[@i_789], x3_676[@i_789], x4_675[@i_789], x5_674[@i_789], r_673[@i_789]) && otheruses(r_673[@i_789]) && ((x1_690 = x1_678[@i_789]) && ((x2_689 = x2_677[@i_789]) && ((x3_688 = x3_676[@i_789]) && ((x4_687 = x4_675[@i_789]) && (x5_686 = x5_674[@i_789]))))) then
      (
        let sk_s: hash0 = r_673[@i_789]
      )
      orfind @i_788 <= NP suchthat defined(x1_684[@i_788], x2_683[@i_788], x3_682[@i_788], x4_681[@i_788], x5_680[@i_788], r_679[@i_788]) && otheruses(r_679[@i_788]) && ((x1_690 = x1_684[@i_788]) && ((x2_689 = x2_683[@i_788]) && ((x3_688 = x3_682[@i_788]) && ((x4_687 = x4_681[@i_788]) && (x5_686 = x5_680[@i_788]))))) then
      (
        let sk_s: hash0 = r_679[@i_788]
      )
      orfind @i_787 <= NS suchthat defined(x1_690[@i_787], x2_689[@i_787], x3_688[@i_787], x4_687[@i_787], x5_686[@i_787], r_685[@i_787]) && otheruses(r_685[@i_787]) && ((x1_690 = x1_690[@i_787]) && ((x2_689 = x2_689[@i_787]) && ((x3_688 = x3_688[@i_787]) && ((x4_687 = x4_687[@i_787]) && (x5_686 = x5_686[@i_787]))))) then
      (
        let sk_s: hash0 = r_685[@i_787]
      )
      orfind @i_786 <= NS suchthat defined(x1_696[@i_786], x2_695[@i_786], x3_694[@i_786], x4_693[@i_786], x5_692[@i_786], r_691[@i_786]) && otheruses(r_691[@i_786]) && ((x1_690 = x1_696[@i_786]) && ((x2_689 = x2_695[@i_786]) && ((x3_688 = x3_694[@i_786]) && ((x4_687 = x4_693[@i_786]) && (x5_686 = x5_692[@i_786]))))) then
      (
        let sk_s: hash0 = r_691[@i_786]
      )
      orfind @i_785 <= NU suchthat defined(x1_702[@i_785], x2_701[@i_785], x3_700[@i_785], x4_699[@i_785], x5_698[@i_785], r_697[@i_785]) && otheruses(r_697[@i_785]) && ((x1_690 = x1_702[@i_785]) && ((x2_689 = x2_701[@i_785]) && ((x3_688 = x3_700[@i_785]) && ((x4_687 = x4_699[@i_785]) && (x5_686 = x5_698[@i_785]))))) then
      (
        let sk_s: hash0 = r_697[@i_785]
      )
      orfind @i_784 <= NU suchthat defined(x1_708[@i_784], x2_707[@i_784], x3_706[@i_784], x4_705[@i_784], x5_704[@i_784], r_703[@i_784]) && otheruses(r_703[@i_784]) && ((x1_690 = x1_708[@i_784]) && ((x2_689 = x2_707[@i_784]) && ((x3_688 = x3_706[@i_784]) && ((x4_687 = x4_705[@i_784]) && (x5_686 = x5_704[@i_784]))))) then
      (
        let sk_s: hash0 = r_703[@i_784]
      )
      orfind @i_783 <= NU suchthat defined(x1_714[@i_783], x2_713[@i_783], x3_712[@i_783], x4_711[@i_783], x5_710[@i_783], r_709[@i_783]) && otheruses(r_709[@i_783]) && ((x1_690 = x1_714[@i_783]) && ((x2_689 = x2_713[@i_783]) && ((x3_688 = x3_712[@i_783]) && ((x4_687 = x4_711[@i_783]) && (x5_686 = x5_710[@i_783]))))) then
      (
        let sk_s: hash0 = r_709[@i_783]
      )
      orfind @i_782 <= NU suchthat defined(x1_720[@i_782], x2_719[@i_782], x3_718[@i_782], x4_717[@i_782], x5_716[@i_782], r_715[@i_782]) && otheruses(r_715[@i_782]) && ((x1_690 = x1_720[@i_782]) && ((x2_689 = x2_719[@i_782]) && ((x3_688 = x3_718[@i_782]) && ((x4_687 = x4_717[@i_782]) && (x5_686 = x5_716[@i_782]))))) then
      (
        let sk_s: hash0 = r_715[@i_782]
      )
      orfind @i_781 <= NU suchthat defined(x1_726[@i_781], x2_725[@i_781], x3_724[@i_781], x4_723[@i_781], x5_722[@i_781], r_721[@i_781]) && otheruses(r_721[@i_781]) && ((x1_690 = x1_726[@i_781]) && ((x2_689 = x2_725[@i_781]) && ((x3_688 = x3_724[@i_781]) && ((x4_687 = x4_723[@i_781]) && (x5_686 = x5_722[@i_781]))))) then
      (
        let sk_s: hash0 = r_721[@i_781]
      )
      orfind @i_780 <= NU suchthat defined(x1_732[@i_780], x2_731[@i_780], x3_730[@i_780], x4_729[@i_780], x5_728[@i_780], r_727[@i_780]) && otheruses(r_727[@i_780]) && ((x1_690 = x1_732[@i_780]) && ((x2_689 = x2_731[@i_780]) && ((x3_688 = x3_730[@i_780]) && ((x4_687 = x4_729[@i_780]) && (x5_686 = x5_728[@i_780]))))) then
      (
        let sk_s: hash0 = r_727[@i_780]
      )
      orfind @i_779 <= NU suchthat defined(x1_738[@i_779], x2_737[@i_779], x3_736[@i_779], x4_735[@i_779], x5_734[@i_779], r_733[@i_779]) && otheruses(r_733[@i_779]) && ((x1_690 = x1_738[@i_779]) && ((x2_689 = x2_737[@i_779]) && ((x3_688 = x3_736[@i_779]) && ((x4_687 = x4_735[@i_779]) && (x5_686 = x5_734[@i_779]))))) then
      (
        let sk_s: hash0 = r_733[@i_779]
      )
      orfind @i_778 <= NU suchthat defined(x1_744[@i_778], x2_743[@i_778], x3_742[@i_778], x4_741[@i_778], x5_740[@i_778], r_739[@i_778]) && otheruses(r_739[@i_778]) && ((x1_690 = x1_744[@i_778]) && ((x2_689 = x2_743[@i_778]) && ((x3_688 = x3_742[@i_778]) && ((x4_687 = x4_741[@i_778]) && (x5_686 = x5_740[@i_778]))))) then
      (
        let sk_s: hash0 = r_739[@i_778]
      )
      orfind @i_777 <= NU suchthat defined(x1_750[@i_777], x2_749[@i_777], x3_748[@i_777], x4_747[@i_777], x5_746[@i_777], r_745[@i_777]) && otheruses(r_745[@i_777]) && ((x1_690 = x1_750[@i_777]) && ((x2_689 = x2_749[@i_777]) && ((x3_688 = x3_748[@i_777]) && ((x4_687 = x4_747[@i_777]) && (x5_686 = x5_746[@i_777]))))) then
      (
        let sk_s: hash0 = r_745[@i_777]
      )
      else
      (
        new r_685: hash0;
        let sk_s: hash0 = r_685
      )
    )
    orfind  suchthat defined(@i_140[j], r_296[j]) && otheruses(r_296[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
    (
      if (auth_s = r_296[j]) then
      let x1_696: host = U in
      let x2_695: host = S in
      let x3_694: G = X_s in
      let x4_693: G = Y in
      let x5_692: G = K_s in
      find [unique] @i_802 <= qH0 suchthat defined(x1_678[@i_802], x2_677[@i_802], x3_676[@i_802], x4_675[@i_802], x5_674[@i_802], r_673[@i_802]) && otheruses(r_673[@i_802]) && ((x1_696 = x1_678[@i_802]) && ((x2_695 = x2_677[@i_802]) && ((x3_694 = x3_676[@i_802]) && ((x4_693 = x4_675[@i_802]) && (x5_692 = x5_674[@i_802]))))) then
      (
        let sk_s: hash0 = r_673[@i_802]
      )
      orfind @i_801 <= NP suchthat defined(x1_684[@i_801], x2_683[@i_801], x3_682[@i_801], x4_681[@i_801], x5_680[@i_801], r_679[@i_801]) && otheruses(r_679[@i_801]) && ((x1_696 = x1_684[@i_801]) && ((x2_695 = x2_683[@i_801]) && ((x3_694 = x3_682[@i_801]) && ((x4_693 = x4_681[@i_801]) && (x5_692 = x5_680[@i_801]))))) then
      (
        let sk_s: hash0 = r_679[@i_801]
      )
      orfind @i_800 <= NS suchthat defined(x1_690[@i_800], x2_689[@i_800], x3_688[@i_800], x4_687[@i_800], x5_686[@i_800], r_685[@i_800]) && otheruses(r_685[@i_800]) && ((x1_696 = x1_690[@i_800]) && ((x2_695 = x2_689[@i_800]) && ((x3_694 = x3_688[@i_800]) && ((x4_693 = x4_687[@i_800]) && (x5_692 = x5_686[@i_800]))))) then
      (
        let sk_s: hash0 = r_685[@i_800]
      )
      orfind @i_799 <= NS suchthat defined(x1_696[@i_799], x2_695[@i_799], x3_694[@i_799], x4_693[@i_799], x5_692[@i_799], r_691[@i_799]) && otheruses(r_691[@i_799]) && ((x1_696 = x1_696[@i_799]) && ((x2_695 = x2_695[@i_799]) && ((x3_694 = x3_694[@i_799]) && ((x4_693 = x4_693[@i_799]) && (x5_692 = x5_692[@i_799]))))) then
      (
        let sk_s: hash0 = r_691[@i_799]
      )
      orfind @i_798 <= NU suchthat defined(x1_702[@i_798], x2_701[@i_798], x3_700[@i_798], x4_699[@i_798], x5_698[@i_798], r_697[@i_798]) && otheruses(r_697[@i_798]) && ((x1_696 = x1_702[@i_798]) && ((x2_695 = x2_701[@i_798]) && ((x3_694 = x3_700[@i_798]) && ((x4_693 = x4_699[@i_798]) && (x5_692 = x5_698[@i_798]))))) then
      (
        let sk_s: hash0 = r_697[@i_798]
      )
      orfind @i_797 <= NU suchthat defined(x1_708[@i_797], x2_707[@i_797], x3_706[@i_797], x4_705[@i_797], x5_704[@i_797], r_703[@i_797]) && otheruses(r_703[@i_797]) && ((x1_696 = x1_708[@i_797]) && ((x2_695 = x2_707[@i_797]) && ((x3_694 = x3_706[@i_797]) && ((x4_693 = x4_705[@i_797]) && (x5_692 = x5_704[@i_797]))))) then
      (
        let sk_s: hash0 = r_703[@i_797]
      )
      orfind @i_796 <= NU suchthat defined(x1_714[@i_796], x2_713[@i_796], x3_712[@i_796], x4_711[@i_796], x5_710[@i_796], r_709[@i_796]) && otheruses(r_709[@i_796]) && ((x1_696 = x1_714[@i_796]) && ((x2_695 = x2_713[@i_796]) && ((x3_694 = x3_712[@i_796]) && ((x4_693 = x4_711[@i_796]) && (x5_692 = x5_710[@i_796]))))) then
      (
        let sk_s: hash0 = r_709[@i_796]
      )
      orfind @i_795 <= NU suchthat defined(x1_720[@i_795], x2_719[@i_795], x3_718[@i_795], x4_717[@i_795], x5_716[@i_795], r_715[@i_795]) && otheruses(r_715[@i_795]) && ((x1_696 = x1_720[@i_795]) && ((x2_695 = x2_719[@i_795]) && ((x3_694 = x3_718[@i_795]) && ((x4_693 = x4_717[@i_795]) && (x5_692 = x5_716[@i_795]))))) then
      (
        let sk_s: hash0 = r_715[@i_795]
      )
      orfind @i_794 <= NU suchthat defined(x1_726[@i_794], x2_725[@i_794], x3_724[@i_794], x4_723[@i_794], x5_722[@i_794], r_721[@i_794]) && otheruses(r_721[@i_794]) && ((x1_696 = x1_726[@i_794]) && ((x2_695 = x2_725[@i_794]) && ((x3_694 = x3_724[@i_794]) && ((x4_693 = x4_723[@i_794]) && (x5_692 = x5_722[@i_794]))))) then
      (
        let sk_s: hash0 = r_721[@i_794]
      )
      orfind @i_793 <= NU suchthat defined(x1_732[@i_793], x2_731[@i_793], x3_730[@i_793], x4_729[@i_793], x5_728[@i_793], r_727[@i_793]) && otheruses(r_727[@i_793]) && ((x1_696 = x1_732[@i_793]) && ((x2_695 = x2_731[@i_793]) && ((x3_694 = x3_730[@i_793]) && ((x4_693 = x4_729[@i_793]) && (x5_692 = x5_728[@i_793]))))) then
      (
        let sk_s: hash0 = r_727[@i_793]
      )
      orfind @i_792 <= NU suchthat defined(x1_738[@i_792], x2_737[@i_792], x3_736[@i_792], x4_735[@i_792], x5_734[@i_792], r_733[@i_792]) && otheruses(r_733[@i_792]) && ((x1_696 = x1_738[@i_792]) && ((x2_695 = x2_737[@i_792]) && ((x3_694 = x3_736[@i_792]) && ((x4_693 = x4_735[@i_792]) && (x5_692 = x5_734[@i_792]))))) then
      (
        let sk_s: hash0 = r_733[@i_792]
      )
      orfind @i_791 <= NU suchthat defined(x1_744[@i_791], x2_743[@i_791], x3_742[@i_791], x4_741[@i_791], x5_740[@i_791], r_739[@i_791]) && otheruses(r_739[@i_791]) && ((x1_696 = x1_744[@i_791]) && ((x2_695 = x2_743[@i_791]) && ((x3_694 = x3_742[@i_791]) && ((x4_693 = x4_741[@i_791]) && (x5_692 = x5_740[@i_791]))))) then
      (
        let sk_s: hash0 = r_739[@i_791]
      )
      orfind @i_790 <= NU suchthat defined(x1_750[@i_790], x2_749[@i_790], x3_748[@i_790], x4_747[@i_790], x5_746[@i_790], r_745[@i_790]) && otheruses(r_745[@i_790]) && ((x1_696 = x1_750[@i_790]) && ((x2_695 = x2_749[@i_790]) && ((x3_694 = x3_748[@i_790]) && ((x4_693 = x4_747[@i_790]) && (x5_692 = x5_746[@i_790]))))) then
      (
        let sk_s: hash0 = r_745[@i_790]
      )
      else
      (
        new r_691: hash0;
        let sk_s: hash0 = r_691
      )
    )
    else
    (
      new r_266: hash1
    )
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    (
      event Auth
    )
    else
    (
      new r_260: hash1
    )
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_90: G;
  let x1_259: host = U in
  let x2_258: host = S in
  let x3_257: G = cst_G in
  let x4_256: G = cst_G in
  let x5_255: G = cst_G in
  new r_254: hash1;
  let x1_684: host = U in
  let x2_683: host = S in
  let x3_682: G = Xp in
  let x4_681: G = Yp in
  let x5_680: G = Kp in
  find [unique] @i_776 <= qH0 suchthat defined(x1_678[@i_776], x2_677[@i_776], x3_676[@i_776], x4_675[@i_776], x5_674[@i_776], r_673[@i_776]) && otheruses(r_673[@i_776]) && ((x1_684 = x1_678[@i_776]) && ((x2_683 = x2_677[@i_776]) && ((x3_682 = x3_676[@i_776]) && ((x4_681 = x4_675[@i_776]) && (x5_680 = x5_674[@i_776]))))) then
  (
    let sk_p: hash0 = r_673[@i_776] in
    out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
  )
  orfind @i_775 <= NP suchthat defined(x1_684[@i_775], x2_683[@i_775], x3_682[@i_775], x4_681[@i_775], x5_680[@i_775], r_679[@i_775]) && otheruses(r_679[@i_775]) && ((x1_684 = x1_684[@i_775]) && ((x2_683 = x2_683[@i_775]) && ((x3_682 = x3_682[@i_775]) && ((x4_681 = x4_681[@i_775]) && (x5_680 = x5_680[@i_775]))))) then
  (
    let sk_p: hash0 = r_679[@i_775] in
    out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
  )
  orfind @i_774 <= NS suchthat defined(x1_690[@i_774], x2_689[@i_774], x3_688[@i_774], x4_687[@i_774], x5_686[@i_774], r_685[@i_774]) && otheruses(r_685[@i_774]) && ((x1_684 = x1_690[@i_774]) && ((x2_683 = x2_689[@i_774]) && ((x3_682 = x3_688[@i_774]) && ((x4_681 = x4_687[@i_774]) && (x5_680 = x5_686[@i_774]))))) then
  (
    let sk_p: hash0 = r_685[@i_774] in
    out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
  )
  orfind @i_773 <= NS suchthat defined(x1_696[@i_773], x2_695[@i_773], x3_694[@i_773], x4_693[@i_773], x5_692[@i_773], r_691[@i_773]) && otheruses(r_691[@i_773]) && ((x1_684 = x1_696[@i_773]) && ((x2_683 = x2_695[@i_773]) && ((x3_682 = x3_694[@i_773]) && ((x4_681 = x4_693[@i_773]) && (x5_680 = x5_692[@i_773]))))) then
  (
    let sk_p: hash0 = r_691[@i_773] in
    out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
  )
  orfind @i_772 <= NU suchthat defined(x1_702[@i_772], x2_701[@i_772], x3_700[@i_772], x4_699[@i_772], x5_698[@i_772], r_697[@i_772]) && otheruses(r_697[@i_772]) && ((x1_684 = x1_702[@i_772]) && ((x2_683 = x2_701[@i_772]) && ((x3_682 = x3_700[@i_772]) && ((x4_681 = x4_699[@i_772]) && (x5_680 = x5_698[@i_772]))))) then
  (
    let sk_p: hash0 = r_697[@i_772] in
    out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
  )
  orfind @i_771 <= NU suchthat defined(x1_708[@i_771], x2_707[@i_771], x3_706[@i_771], x4_705[@i_771], x5_704[@i_771], r_703[@i_771]) && otheruses(r_703[@i_771]) && ((x1_684 = x1_708[@i_771]) && ((x2_683 = x2_707[@i_771]) && ((x3_682 = x3_706[@i_771]) && ((x4_681 = x4_705[@i_771]) && (x5_680 = x5_704[@i_771]))))) then
  (
    let sk_p: hash0 = r_703[@i_771] in
    out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
  )
  orfind @i_770 <= NU suchthat defined(x1_714[@i_770], x2_713[@i_770], x3_712[@i_770], x4_711[@i_770], x5_710[@i_770], r_709[@i_770]) && otheruses(r_709[@i_770]) && ((x1_684 = x1_714[@i_770]) && ((x2_683 = x2_713[@i_770]) && ((x3_682 = x3_712[@i_770]) && ((x4_681 = x4_711[@i_770]) && (x5_680 = x5_710[@i_770]))))) then
  (
    let sk_p: hash0 = r_709[@i_770] in
    out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
  )
  orfind @i_769 <= NU suchthat defined(x1_720[@i_769], x2_719[@i_769], x3_718[@i_769], x4_717[@i_769], x5_716[@i_769], r_715[@i_769]) && otheruses(r_715[@i_769]) && ((x1_684 = x1_720[@i_769]) && ((x2_683 = x2_719[@i_769]) && ((x3_682 = x3_718[@i_769]) && ((x4_681 = x4_717[@i_769]) && (x5_680 = x5_716[@i_769]))))) then
  (
    let sk_p: hash0 = r_715[@i_769] in
    out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
  )
  orfind @i_768 <= NU suchthat defined(x1_726[@i_768], x2_725[@i_768], x3_724[@i_768], x4_723[@i_768], x5_722[@i_768], r_721[@i_768]) && otheruses(r_721[@i_768]) && ((x1_684 = x1_726[@i_768]) && ((x2_683 = x2_725[@i_768]) && ((x3_682 = x3_724[@i_768]) && ((x4_681 = x4_723[@i_768]) && (x5_680 = x5_722[@i_768]))))) then
  (
    let sk_p: hash0 = r_721[@i_768] in
    out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
  )
  orfind @i_767 <= NU suchthat defined(x1_732[@i_767], x2_731[@i_767], x3_730[@i_767], x4_729[@i_767], x5_728[@i_767], r_727[@i_767]) && otheruses(r_727[@i_767]) && ((x1_684 = x1_732[@i_767]) && ((x2_683 = x2_731[@i_767]) && ((x3_682 = x3_730[@i_767]) && ((x4_681 = x4_729[@i_767]) && (x5_680 = x5_728[@i_767]))))) then
  (
    let sk_p: hash0 = r_727[@i_767] in
    out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
  )
  orfind @i_766 <= NU suchthat defined(x1_738[@i_766], x2_737[@i_766], x3_736[@i_766], x4_735[@i_766], x5_734[@i_766], r_733[@i_766]) && otheruses(r_733[@i_766]) && ((x1_684 = x1_738[@i_766]) && ((x2_683 = x2_737[@i_766]) && ((x3_682 = x3_736[@i_766]) && ((x4_681 = x4_735[@i_766]) && (x5_680 = x5_734[@i_766]))))) then
  (
    let sk_p: hash0 = r_733[@i_766] in
    out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
  )
  orfind @i_765 <= NU suchthat defined(x1_744[@i_765], x2_743[@i_765], x3_742[@i_765], x4_741[@i_765], x5_740[@i_765], r_739[@i_765]) && otheruses(r_739[@i_765]) && ((x1_684 = x1_744[@i_765]) && ((x2_683 = x2_743[@i_765]) && ((x3_682 = x3_742[@i_765]) && ((x4_681 = x4_741[@i_765]) && (x5_680 = x5_740[@i_765]))))) then
  (
    let sk_p: hash0 = r_739[@i_765] in
    out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
  )
  orfind @i_764 <= NU suchthat defined(x1_750[@i_764], x2_749[@i_764], x3_748[@i_764], x4_747[@i_764], x5_746[@i_764], r_745[@i_764]) && otheruses(r_745[@i_764]) && ((x1_684 = x1_750[@i_764]) && ((x2_683 = x2_749[@i_764]) && ((x3_682 = x3_748[@i_764]) && ((x4_681 = x4_747[@i_764]) && (x5_680 = x5_746[@i_764]))))) then
  (
    let sk_p: hash0 = r_745[@i_764] in
    out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
  )
  else
  (
    new r_679: hash0;
    let sk_p: hash0 = r_679 in
    out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
  )
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@2_r4_84[@i_118], @2_kd[@i_118], @2_m[@i_118]) && otheruses(@2_r4_84[@i_118]) && ((@2_x = @2_r4_84[@i_118]) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_114 <= NU suchthat defined(@2_r4_96[@i_114], Ystar_u[@i_114]) && otheruses(@2_r4_96[@i_114]) && ((@2_x = @2_r4_96[@i_114]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], Ystar_u[@i_114])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = Yp[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@2_m[@i_108], @2_kd[@i_108], @2_r4_84[@i_108]) && otheruses(@2_r4_84[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], @2_r4_84[@i_108])
  )
  orfind @i_104 <= NU suchthat defined(Ystar_u[@i_104], @2_r4_96[@i_104]) && otheruses(@2_r4_96[@i_104]) && ((@2_m = Ystar_u[@i_104]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], @2_r4_96[@i_104])
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@2_r2_90[@i_101], Yp[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Yp[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_r2_93[@i_100], Y[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @2_r4_84: G;
    out(@2_c4[!_57], @2_r4_84)
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  let x1_678: host = x1_69 in
  let x2_677: host = x2_68 in
  let x3_676: G = x3_67 in
  let x4_675: G = x4_66 in
  let x5_674: G = x5_65 in
  find [unique] @i_763 <= qH0 suchthat defined(x1_678[@i_763], x2_677[@i_763], x3_676[@i_763], x4_675[@i_763], x5_674[@i_763], r_673[@i_763]) && otheruses(r_673[@i_763]) && ((x1_678 = x1_678[@i_763]) && ((x2_677 = x2_677[@i_763]) && ((x3_676 = x3_676[@i_763]) && ((x4_675 = x4_675[@i_763]) && (x5_674 = x5_674[@i_763]))))) then
  (
    out(c20[!_58], r_673[@i_763])
  )
  orfind @i_762 <= NP suchthat defined(x1_684[@i_762], x2_683[@i_762], x3_682[@i_762], x4_681[@i_762], x5_680[@i_762], r_679[@i_762]) && otheruses(r_679[@i_762]) && ((x1_678 = x1_684[@i_762]) && ((x2_677 = x2_683[@i_762]) && ((x3_676 = x3_682[@i_762]) && ((x4_675 = x4_681[@i_762]) && (x5_674 = x5_680[@i_762]))))) then
  (
    out(c20[!_58], r_679[@i_762])
  )
  orfind @i_761 <= NS suchthat defined(x1_690[@i_761], x2_689[@i_761], x3_688[@i_761], x4_687[@i_761], x5_686[@i_761], r_685[@i_761]) && otheruses(r_685[@i_761]) && ((x1_678 = x1_690[@i_761]) && ((x2_677 = x2_689[@i_761]) && ((x3_676 = x3_688[@i_761]) && ((x4_675 = x4_687[@i_761]) && (x5_674 = x5_686[@i_761]))))) then
  (
    out(c20[!_58], r_685[@i_761])
  )
  orfind @i_760 <= NS suchthat defined(x1_696[@i_760], x2_695[@i_760], x3_694[@i_760], x4_693[@i_760], x5_692[@i_760], r_691[@i_760]) && otheruses(r_691[@i_760]) && ((x1_678 = x1_696[@i_760]) && ((x2_677 = x2_695[@i_760]) && ((x3_676 = x3_694[@i_760]) && ((x4_675 = x4_693[@i_760]) && (x5_674 = x5_692[@i_760]))))) then
  (
    out(c20[!_58], r_691[@i_760])
  )
  orfind @i_759 <= NU suchthat defined(x1_702[@i_759], x2_701[@i_759], x3_700[@i_759], x4_699[@i_759], x5_698[@i_759], r_697[@i_759]) && otheruses(r_697[@i_759]) && ((x1_678 = x1_702[@i_759]) && ((x2_677 = x2_701[@i_759]) && ((x3_676 = x3_700[@i_759]) && ((x4_675 = x4_699[@i_759]) && (x5_674 = x5_698[@i_759]))))) then
  (
    out(c20[!_58], r_697[@i_759])
  )
  orfind @i_758 <= NU suchthat defined(x1_708[@i_758], x2_707[@i_758], x3_706[@i_758], x4_705[@i_758], x5_704[@i_758], r_703[@i_758]) && otheruses(r_703[@i_758]) && ((x1_678 = x1_708[@i_758]) && ((x2_677 = x2_707[@i_758]) && ((x3_676 = x3_706[@i_758]) && ((x4_675 = x4_705[@i_758]) && (x5_674 = x5_704[@i_758]))))) then
  (
    out(c20[!_58], r_703[@i_758])
  )
  orfind @i_757 <= NU suchthat defined(x1_714[@i_757], x2_713[@i_757], x3_712[@i_757], x4_711[@i_757], x5_710[@i_757], r_709[@i_757]) && otheruses(r_709[@i_757]) && ((x1_678 = x1_714[@i_757]) && ((x2_677 = x2_713[@i_757]) && ((x3_676 = x3_712[@i_757]) && ((x4_675 = x4_711[@i_757]) && (x5_674 = x5_710[@i_757]))))) then
  (
    out(c20[!_58], r_709[@i_757])
  )
  orfind @i_756 <= NU suchthat defined(x1_720[@i_756], x2_719[@i_756], x3_718[@i_756], x4_717[@i_756], x5_716[@i_756], r_715[@i_756]) && otheruses(r_715[@i_756]) && ((x1_678 = x1_720[@i_756]) && ((x2_677 = x2_719[@i_756]) && ((x3_676 = x3_718[@i_756]) && ((x4_675 = x4_717[@i_756]) && (x5_674 = x5_716[@i_756]))))) then
  (
    out(c20[!_58], r_715[@i_756])
  )
  orfind @i_755 <= NU suchthat defined(x1_726[@i_755], x2_725[@i_755], x3_724[@i_755], x4_723[@i_755], x5_722[@i_755], r_721[@i_755]) && otheruses(r_721[@i_755]) && ((x1_678 = x1_726[@i_755]) && ((x2_677 = x2_725[@i_755]) && ((x3_676 = x3_724[@i_755]) && ((x4_675 = x4_723[@i_755]) && (x5_674 = x5_722[@i_755]))))) then
  (
    out(c20[!_58], r_721[@i_755])
  )
  orfind @i_754 <= NU suchthat defined(x1_732[@i_754], x2_731[@i_754], x3_730[@i_754], x4_729[@i_754], x5_728[@i_754], r_727[@i_754]) && otheruses(r_727[@i_754]) && ((x1_678 = x1_732[@i_754]) && ((x2_677 = x2_731[@i_754]) && ((x3_676 = x3_730[@i_754]) && ((x4_675 = x4_729[@i_754]) && (x5_674 = x5_728[@i_754]))))) then
  (
    out(c20[!_58], r_727[@i_754])
  )
  orfind @i_753 <= NU suchthat defined(x1_738[@i_753], x2_737[@i_753], x3_736[@i_753], x4_735[@i_753], x5_734[@i_753], r_733[@i_753]) && otheruses(r_733[@i_753]) && ((x1_678 = x1_738[@i_753]) && ((x2_677 = x2_737[@i_753]) && ((x3_676 = x3_736[@i_753]) && ((x4_675 = x4_735[@i_753]) && (x5_674 = x5_734[@i_753]))))) then
  (
    out(c20[!_58], r_733[@i_753])
  )
  orfind @i_752 <= NU suchthat defined(x1_744[@i_752], x2_743[@i_752], x3_742[@i_752], x4_741[@i_752], x5_740[@i_752], r_739[@i_752]) && otheruses(r_739[@i_752]) && ((x1_678 = x1_744[@i_752]) && ((x2_677 = x2_743[@i_752]) && ((x3_676 = x3_742[@i_752]) && ((x4_675 = x4_741[@i_752]) && (x5_674 = x5_740[@i_752]))))) then
  (
    out(c20[!_58], r_739[@i_752])
  )
  orfind @i_751 <= NU suchthat defined(x1_750[@i_751], x2_749[@i_751], x3_748[@i_751], x4_747[@i_751], x5_746[@i_751], r_745[@i_751]) && otheruses(r_745[@i_751]) && ((x1_678 = x1_750[@i_751]) && ((x2_677 = x2_749[@i_751]) && ((x3_676 = x3_748[@i_751]) && ((x4_675 = x4_747[@i_751]) && (x5_674 = x5_746[@i_751]))))) then
  (
    out(c20[!_58], r_745[@i_751])
  )
  else
  (
    new r_673: hash0;
    out(c20[!_58], r_673)
  )
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  let x1_253: host = cst_host in
  let x2_252: host = cst_host in
  let x3_251: G = cst_G in
  let x4_250: G = cst_G in
  let x5_249: G = cst_G in
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], x5_249[@i_310], x4_250[@i_310], x3_251[@i_310], x2_252[@i_310], x1_253[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  orfind @i_309 <= NP suchthat defined(Xp[@i_309], Yp[@i_309], Kp[@i_309], x5_255[@i_309], x4_256[@i_309], x3_257[@i_309], x1_259[@i_309], x2_258[@i_309], r_254[@i_309]) && otheruses(r_254[@i_309]) && ((x1_64 = x1_259[@i_309]) && ((x2_63 = x2_258[@i_309]) && ((x3_62 = Xp[@i_309]) && ((x4_61 = Yp[@i_309]) && (x5_60 = Kp[@i_309]))))) then
  (
    out(c21[!_59], r_254[@i_309])
  )
  orfind @i_306 <= NU suchthat defined(X[@i_306], @2_r4_96[@i_306], K_u[@i_306], x5_273[@i_306], x4_274[@i_306], x3_275[@i_306], x1_277[@i_306], x2_276[@i_306], r_272[@i_306]) && otheruses(r_272[@i_306]) && ((x1_64 = x1_277[@i_306]) && ((x2_63 = x2_276[@i_306]) && ((x3_62 = X[@i_306]) && ((x4_61 = @2_r4_96[@i_306]) && (x5_60 = K_u[@i_306]))))) then
  (
    out(c21[!_59], r_272[@i_306])
  )
  orfind @i_305 <= NU suchthat defined(X[@i_305], @2_r4_84[@i_148[@i_305]], K_u[@i_305], x5_279[@i_305], x4_280[@i_305], x3_281[@i_305], x1_283[@i_305], x2_282[@i_305], r_278[@i_305]) && otheruses(r_278[@i_305]) && ((x1_64 = x1_283[@i_305]) && ((x2_63 = x2_282[@i_305]) && ((x3_62 = X[@i_305]) && ((x4_61 = @2_r4_84[@i_148[@i_305]]) && (x5_60 = K_u[@i_305]))))) then
  (
    out(c21[!_59], r_278[@i_305])
  )
  orfind @i_304 <= NU suchthat defined(X[@i_304], @2_r4_96[@i_144[@i_304]], K_u[@i_304], x5_285[@i_304], x4_286[@i_304], x3_287[@i_304], x1_289[@i_304], x2_288[@i_304], r_284[@i_304]) && otheruses(r_284[@i_304]) && ((x1_64 = x1_289[@i_304]) && ((x2_63 = x2_288[@i_304]) && ((x3_62 = X[@i_304]) && ((x4_61 = @2_r4_96[@i_144[@i_304]]) && (x5_60 = K_u[@i_304]))))) then
  (
    out(c21[!_59], r_284[@i_304])
  )
  orfind @i_303 <= NU suchthat defined(X[@i_303], Yp[@i_141[@i_303]], K_u[@i_303], x5_291[@i_303], x4_292[@i_303], x3_293[@i_303], x1_295[@i_303], x2_294[@i_303], r_290[@i_303]) && otheruses(r_290[@i_303]) && ((x1_64 = x1_295[@i_303]) && ((x2_63 = x2_294[@i_303]) && ((x3_62 = X[@i_303]) && ((x4_61 = Yp[@i_141[@i_303]]) && (x5_60 = K_u[@i_303]))))) then
  (
    out(c21[!_59], r_290[@i_303])
  )
  orfind @i_302 <= NU suchthat defined(X[@i_302], Y[@i_140[@i_302]], K_u[@i_302], x5_297[@i_302], x4_298[@i_302], x3_299[@i_302], x1_301[@i_302], x2_300[@i_302], r_296[@i_302]) && otheruses(r_296[@i_302]) && ((x1_64 = x1_301[@i_302]) && ((x2_63 = x2_300[@i_302]) && ((x3_62 = X[@i_302]) && ((x4_61 = Y[@i_140[@i_302]]) && (x5_60 = K_u[@i_302]))))) then
  (
    out(c21[!_59], r_296[@i_302])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying simplify [Excluding set(dist 13->14, proba <= 1. / |exponent| * NP + 14. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + 19. * NP * NU / |exponent| + 4. * NP * NS / |exponent| + 2. * NP * qH0 / |exponent| + NS * NU / |exponent| + NS * qD / |exponent| + NU * NS / |G| + NU * NP / |G| + NP * qD / |exponent| + qD * NS / |G| + qD * NP / |G| + 0.5 * NS * NS / |G| + NU * qH1 / |hash1|)] yields

Game 14 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_148 <= qD suchthat defined(@2_m[@i_148], @2_kd[@i_148], @2_r4_84[@i_148]) && otheruses(@2_r4_84[@i_148]) && ((Ystar_u = @2_m[@i_148]) && (pw = @2_kd[@i_148])) then
  (
    let K_u: G = exp(@2_r4_84[@i_148], x) in
    let x1_283: host = U in
    let x2_282: host = S in
    let x3_281: G = cst_G in
    let x4_280: G = cst_G in
    let x5_279: G = cst_G in
    find [unique] @i_355 <= qH1 suchthat defined(x1_64[@i_355], x2_63[@i_355], x3_62[@i_355], x4_61[@i_355], x5_60[@i_355], r_248[@i_355]) && otheruses(r_248[@i_355]) && ((x1_283 = x1_64[@i_355]) && ((x2_282 = x2_63[@i_355]) && ((X = x3_62[@i_355]) && ((@2_r4_84[@i_148] = x4_61[@i_355]) && (K_u = x5_60[@i_355]))))) then
    (
      out(c6[!_53], r_248[@i_355]);
      in(c9[!_53], ());
      let x1_714: host = U in
      let x2_713: host = S in
      let x3_712: G = X in
      let x4_711: G = @2_r4_84[@i_148] in
      let x5_710: G = K_u in
      find [unique] @i_841 <= qH0 suchthat defined(x1_678[@i_841], x2_677[@i_841], x3_676[@i_841], x4_675[@i_841], x5_674[@i_841], r_673[@i_841]) && otheruses(r_673[@i_841]) && ((x1_714 = x1_678[@i_841]) && ((x2_713 = x2_677[@i_841]) && ((x3_712 = x3_676[@i_841]) && ((x4_711 = x4_675[@i_841]) && (x5_710 = x5_674[@i_841]))))) then
      (
        let sk_u: hash0 = r_673[@i_841]
      )
      else
      (
        new r_709: hash0;
        let sk_u: hash0 = r_709
      )
    )
    else
    (
      new r_278: hash1;
      out(c6[!_53], r_278);
      in(c9[!_53], ());
      let x1_708: host = U in
      let x2_707: host = S in
      let x3_706: G = X in
      let x4_705: G = @2_r4_84[@i_148] in
      let x5_704: G = K_u in
      find [unique] @i_828 <= qH0 suchthat defined(x1_678[@i_828], x2_677[@i_828], x3_676[@i_828], x4_675[@i_828], x5_674[@i_828], r_673[@i_828]) && otheruses(r_673[@i_828]) && ((x1_708 = x1_678[@i_828]) && ((x2_707 = x2_677[@i_828]) && ((x3_706 = x3_676[@i_828]) && ((x4_705 = x4_675[@i_828]) && (x5_704 = x5_674[@i_828]))))) then
      (
        let sk_u: hash0 = r_673[@i_828]
      )
      else
      (
        new r_703: hash0;
        let sk_u: hash0 = r_703
      )
    )
  )
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], @2_r4_96[@i_144]) && otheruses(@2_r4_96[@i_144]) && (Ystar_u = Ystar_u[@i_144]) then
  (
    let K_u: G = exp(@2_r4_96[@i_144], x) in
    let x1_289: host = U in
    let x2_288: host = S in
    let x3_287: G = cst_G in
    let x4_286: G = cst_G in
    let x5_285: G = cst_G in
    find [unique] @i_364 <= qH1 suchthat defined(x1_64[@i_364], x2_63[@i_364], x3_62[@i_364], x4_61[@i_364], x5_60[@i_364], r_248[@i_364]) && otheruses(r_248[@i_364]) && ((x1_289 = x1_64[@i_364]) && ((x2_288 = x2_63[@i_364]) && ((X = x3_62[@i_364]) && ((@2_r4_96[@i_144] = x4_61[@i_364]) && (K_u = x5_60[@i_364]))))) then
    (
      out(c6[!_53], r_248[@i_364]);
      in(c9[!_53], ());
      let x1_726: host = U in
      let x2_725: host = S in
      let x3_724: G = X in
      let x4_723: G = @2_r4_96[@i_144] in
      let x5_722: G = K_u in
      find [unique] @i_867 <= qH0 suchthat defined(x1_678[@i_867], x2_677[@i_867], x3_676[@i_867], x4_675[@i_867], x5_674[@i_867], r_673[@i_867]) && otheruses(r_673[@i_867]) && ((x1_726 = x1_678[@i_867]) && ((x2_725 = x2_677[@i_867]) && ((x3_724 = x3_676[@i_867]) && ((x4_723 = x4_675[@i_867]) && (x5_722 = x5_674[@i_867]))))) then
      (
        let sk_u: hash0 = r_673[@i_867]
      )
      else
      (
        new r_721: hash0;
        let sk_u: hash0 = r_721
      )
    )
    else
    (
      new r_284: hash1;
      out(c6[!_53], r_284);
      in(c9[!_53], ());
      let x1_720: host = U in
      let x2_719: host = S in
      let x3_718: G = X in
      let x4_717: G = @2_r4_96[@i_144] in
      let x5_716: G = K_u in
      find [unique] @i_854 <= qH0 suchthat defined(x1_678[@i_854], x2_677[@i_854], x3_676[@i_854], x4_675[@i_854], x5_674[@i_854], r_673[@i_854]) && otheruses(r_673[@i_854]) && ((x1_720 = x1_678[@i_854]) && ((x2_719 = x2_677[@i_854]) && ((x3_718 = x3_676[@i_854]) && ((x4_717 = x4_675[@i_854]) && (x5_716 = x5_674[@i_854]))))) then
      (
        let sk_u: hash0 = r_673[@i_854]
      )
      else
      (
        new r_715: hash0;
        let sk_u: hash0 = r_715
      )
    )
  )
  orfind @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  orfind @i_141 <= NP suchthat defined(@2_r2_90[@i_141], yp[@i_141], Yp[@i_141]) && otheruses(@2_r2_90[@i_141]) && (Ystar_u = @2_r2_90[@i_141]) then
  (
    let K_u: G = exp(g, mult(yp[@i_141], x)) in
    let x1_295: host = U in
    let x2_294: host = S in
    let x3_293: G = cst_G in
    let x4_292: G = cst_G in
    let x5_291: G = cst_G in
    find [unique] @i_373 <= qH1 suchthat defined(x1_64[@i_373], x2_63[@i_373], x3_62[@i_373], x4_61[@i_373], x5_60[@i_373], r_248[@i_373]) && otheruses(r_248[@i_373]) && ((x1_295 = x1_64[@i_373]) && ((x2_294 = x2_63[@i_373]) && ((X = x3_62[@i_373]) && ((Yp[@i_141] = x4_61[@i_373]) && (K_u = x5_60[@i_373]))))) then
    (
      out(c6[!_53], r_248[@i_373]);
      in(c9[!_53], ());
      let x1_738: host = U in
      let x2_737: host = S in
      let x3_736: G = X in
      let x4_735: G = Yp[@i_141] in
      let x5_734: G = K_u in
      find [unique] @i_893 <= qH0 suchthat defined(x1_678[@i_893], x2_677[@i_893], x3_676[@i_893], x4_675[@i_893], x5_674[@i_893], r_673[@i_893]) && otheruses(r_673[@i_893]) && ((x1_738 = x1_678[@i_893]) && ((x2_737 = x2_677[@i_893]) && ((x3_736 = x3_676[@i_893]) && ((x4_735 = x4_675[@i_893]) && (x5_734 = x5_674[@i_893]))))) then
      (
        let sk_u: hash0 = r_673[@i_893]
      )
      else
      (
        new r_733: hash0;
        let sk_u: hash0 = r_733
      )
    )
    else
    (
      new r_290: hash1;
      out(c6[!_53], r_290);
      in(c9[!_53], ());
      let x1_732: host = U in
      let x2_731: host = S in
      let x3_730: G = X in
      let x4_729: G = Yp[@i_141] in
      let x5_728: G = K_u in
      find [unique] @i_880 <= qH0 suchthat defined(x1_678[@i_880], x2_677[@i_880], x3_676[@i_880], x4_675[@i_880], x5_674[@i_880], r_673[@i_880]) && otheruses(r_673[@i_880]) && ((x1_732 = x1_678[@i_880]) && ((x2_731 = x2_677[@i_880]) && ((x3_730 = x3_676[@i_880]) && ((x4_729 = x4_675[@i_880]) && (x5_728 = x5_674[@i_880]))))) then
      (
        let sk_u: hash0 = r_673[@i_880]
      )
      else
      (
        new r_727: hash0;
        let sk_u: hash0 = r_727
      )
    )
  )
  orfind @i_140 <= NS suchthat defined(@2_r2_93[@i_140], y[@i_140], Y[@i_140]) && otheruses(@2_r2_93[@i_140]) && (Ystar_u = @2_r2_93[@i_140]) then
  (
    let K_u: G = exp(g, mult(y[@i_140], x)) in
    let x1_301: host = U in
    let x2_300: host = S in
    let x3_299: G = cst_G in
    let x4_298: G = cst_G in
    let x5_297: G = cst_G in
    find [unique] @i_382 <= qH1 suchthat defined(x1_64[@i_382], x2_63[@i_382], x3_62[@i_382], x4_61[@i_382], x5_60[@i_382], r_248[@i_382]) && otheruses(r_248[@i_382]) && ((x1_301 = x1_64[@i_382]) && ((x2_300 = x2_63[@i_382]) && ((X = x3_62[@i_382]) && ((Y[@i_140] = x4_61[@i_382]) && (K_u = x5_60[@i_382]))))) then
    (
      out(c6[!_53], r_248[@i_382]);
      in(c9[!_53], ());
      let x1_750: host = U in
      let x2_749: host = S in
      let x3_748: G = X in
      let x4_747: G = Y[@i_140] in
      let x5_746: G = K_u in
      find [unique] @i_919 <= qH0 suchthat defined(x1_678[@i_919], x2_677[@i_919], x3_676[@i_919], x4_675[@i_919], x5_674[@i_919], r_673[@i_919]) && otheruses(r_673[@i_919]) && ((x1_750 = x1_678[@i_919]) && ((x2_749 = x2_677[@i_919]) && ((x3_748 = x3_676[@i_919]) && ((x4_747 = x4_675[@i_919]) && (x5_746 = x5_674[@i_919]))))) then
      (
        let sk_u: hash0 = r_673[@i_919]
      )
      orfind  suchthat defined(j[@i_140], r_685[@i_140]) && otheruses(r_685[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let @i_917 <= NS = @i_140 in
        let sk_u: hash0 = r_685[@i_140]
      )
      else
      (
        new r_745: hash0;
        let sk_u: hash0 = r_745
      )
    )
    else
    (
      new r_296: hash1;
      out(c6[!_53], r_296);
      in(c9[!_53], ());
      let x1_744: host = U in
      let x2_743: host = S in
      let x3_742: G = X in
      let x4_741: G = Y[@i_140] in
      let x5_740: G = K_u in
      find [unique] @i_906 <= qH0 suchthat defined(x1_678[@i_906], x2_677[@i_906], x3_676[@i_906], x4_675[@i_906], x5_674[@i_906], r_673[@i_906]) && otheruses(r_673[@i_906]) && ((x1_744 = x1_678[@i_906]) && ((x2_743 = x2_677[@i_906]) && ((x3_742 = x3_676[@i_906]) && ((x4_741 = x4_675[@i_906]) && (x5_740 = x5_674[@i_906]))))) then
      (
        let sk_u: hash0 = r_673[@i_906]
      )
      orfind  suchthat defined(j[@i_140], r_685[@i_140]) && otheruses(r_685[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let @i_904 <= NS = @i_140 in
        let sk_u: hash0 = r_685[@i_140]
      )
      orfind  suchthat defined(j[@i_140], r_691[@i_140]) && otheruses(r_691[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let @i_903 <= NS = @i_140 in
        let sk_u: hash0 = r_691[@i_140]
      )
      else
      (
        new r_739: hash0;
        let sk_u: hash0 = r_739
      )
    )
  )
  else
  (
    new @2_r4_96: G;
    let K_u: G = exp(@2_r4_96, x) in
    let x1_277: host = U in
    let x2_276: host = S in
    let x3_275: G = cst_G in
    let x4_274: G = cst_G in
    let x5_273: G = cst_G in
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ());
    let x1_702: host = U in
    let x2_701: host = S in
    let x3_700: G = X in
    let x4_699: G = @2_r4_96 in
    let x5_698: G = K_u in
    find [unique] @i_815 <= qH0 suchthat defined(x1_678[@i_815], x2_677[@i_815], x3_676[@i_815], x4_675[@i_815], x5_674[@i_815], r_673[@i_815]) && otheruses(r_673[@i_815]) && ((x1_702 = x1_678[@i_815]) && ((x2_701 = x2_677[@i_815]) && ((x3_700 = x3_676[@i_815]) && ((x4_699 = x4_675[@i_815]) && (x5_698 = x5_674[@i_815]))))) then
    (
      let sk_u: hash0 = r_673[@i_815]
    )
    else
    (
      new r_697: hash0;
      let sk_u: hash0 = r_697
    )
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_271: host = U in
    let x2_270: host = S in
    find [unique] @i_337 <= qH1 suchthat defined(x1_64[@i_337], x2_63[@i_337], x3_62[@i_337], x4_61[@i_337], x5_60[@i_337], r_248[@i_337]) && otheruses(r_248[@i_337]) && ((x1_271 = x1_64[@i_337]) && ((x2_270 = x2_63[@i_337]) && ((X_s = x3_62[@i_337]) && ((Y = x4_61[@i_337]) && (K_s = x5_60[@i_337]))))) then
    (
      if (auth_s = r_248[@i_337]) then
      let x1_690: host = U in
      let x2_689: host = S in
      let x3_688: G = X_s in
      let x4_687: G = Y in
      let x5_686: G = K_s in
      find [unique] @i_789 <= qH0 suchthat defined(x1_678[@i_789], x2_677[@i_789], x3_676[@i_789], x4_675[@i_789], x5_674[@i_789], r_673[@i_789]) && otheruses(r_673[@i_789]) && ((x1_690 = x1_678[@i_789]) && ((x2_689 = x2_677[@i_789]) && ((x3_688 = x3_676[@i_789]) && ((x4_687 = x4_675[@i_789]) && (x5_686 = x5_674[@i_789]))))) then
      (
        let sk_s: hash0 = r_673[@i_789]
      )
      orfind  suchthat defined(@i_140[j], r_739[j]) && otheruses(r_739[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
      (
        let @i_778 <= NU = j in
        let sk_s: hash0 = r_739[j]
      )
      orfind  suchthat defined(@i_140[j], r_745[j]) && otheruses(r_745[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
      (
        let @i_777 <= NU = j in
        let sk_s: hash0 = r_745[j]
      )
      else
      (
        new r_685: hash0;
        let sk_s: hash0 = r_685
      )
    )
    orfind  suchthat defined(@i_140[j], r_296[j]) && otheruses(r_296[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
    (
      if (auth_s = r_296[j]) then
      let x1_696: host = U in
      let x2_695: host = S in
      let x3_694: G = X_s in
      let x4_693: G = Y in
      let x5_692: G = K_s in
      find [unique] @i_802 <= qH0 suchthat defined(x1_678[@i_802], x2_677[@i_802], x3_676[@i_802], x4_675[@i_802], x5_674[@i_802], r_673[@i_802]) && otheruses(r_673[@i_802]) && ((x1_696 = x1_678[@i_802]) && ((x2_695 = x2_677[@i_802]) && ((x3_694 = x3_676[@i_802]) && ((x4_693 = x4_675[@i_802]) && (x5_692 = x5_674[@i_802]))))) then
      (
        let sk_s: hash0 = r_673[@i_802]
      )
      orfind  suchthat defined(r_739[j]) && otheruses(r_739[j]) then
      (
        let @i_791 <= NU = j in
        let sk_s: hash0 = r_739[j]
      )
      else
      (
        new r_691: hash0;
        let sk_s: hash0 = r_691
      )
    )
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    event Auth
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_90: G;
  let x1_259: host = U in
  let x2_258: host = S in
  let x3_257: G = cst_G in
  let x4_256: G = cst_G in
  let x5_255: G = cst_G in
  new r_254: hash1;
  let x1_684: host = U in
  let x2_683: host = S in
  let x3_682: G = Xp in
  let x4_681: G = Yp in
  let x5_680: G = Kp in
  new r_679: hash0;
  let sk_p: hash0 = r_679 in
  out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@2_r4_84[@i_118], @2_kd[@i_118], @2_m[@i_118]) && otheruses(@2_r4_84[@i_118]) && ((@2_x = @2_r4_84[@i_118]) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_114 <= NU suchthat defined(@2_r4_96[@i_114], Ystar_u[@i_114]) && otheruses(@2_r4_96[@i_114]) && ((@2_x = @2_r4_96[@i_114]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], Ystar_u[@i_114])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = Yp[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@2_m[@i_108], @2_kd[@i_108], @2_r4_84[@i_108]) && otheruses(@2_r4_84[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], @2_r4_84[@i_108])
  )
  orfind @i_104 <= NU suchthat defined(Ystar_u[@i_104], @2_r4_96[@i_104]) && otheruses(@2_r4_96[@i_104]) && ((@2_m = Ystar_u[@i_104]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], @2_r4_96[@i_104])
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@2_r2_90[@i_101], Yp[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Yp[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_r2_93[@i_100], Y[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @2_r4_84: G;
    out(@2_c4[!_57], @2_r4_84)
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  let x1_678: host = x1_69 in
  let x2_677: host = x2_68 in
  let x3_676: G = x3_67 in
  let x4_675: G = x4_66 in
  let x5_674: G = x5_65 in
  find [unique] @i_763 <= qH0 suchthat defined(x1_678[@i_763], x2_677[@i_763], x3_676[@i_763], x4_675[@i_763], x5_674[@i_763], r_673[@i_763]) && otheruses(r_673[@i_763]) && ((x1_678 = x1_678[@i_763]) && ((x2_677 = x2_677[@i_763]) && ((x3_676 = x3_676[@i_763]) && ((x4_675 = x4_675[@i_763]) && (x5_674 = x5_674[@i_763]))))) then
  (
    out(c20[!_58], r_673[@i_763])
  )
  orfind @i_762 <= NP suchthat defined(x1_684[@i_762], x2_683[@i_762], x3_682[@i_762], x4_681[@i_762], x5_680[@i_762], r_679[@i_762]) && otheruses(r_679[@i_762]) && ((x1_678 = x1_684[@i_762]) && ((x2_677 = x2_683[@i_762]) && ((x3_676 = x3_682[@i_762]) && ((x4_675 = x4_681[@i_762]) && (x5_674 = x5_680[@i_762]))))) then
  (
    out(c20[!_58], r_679[@i_762])
  )
  orfind @i_761 <= NS suchthat defined(x1_690[@i_761], x2_689[@i_761], x3_688[@i_761], x4_687[@i_761], x5_686[@i_761], r_685[@i_761]) && otheruses(r_685[@i_761]) && ((x1_678 = x1_690[@i_761]) && ((x2_677 = x2_689[@i_761]) && ((x3_676 = x3_688[@i_761]) && ((x4_675 = x4_687[@i_761]) && (x5_674 = x5_686[@i_761]))))) then
  (
    out(c20[!_58], r_685[@i_761])
  )
  orfind @i_760 <= NS suchthat defined(x1_696[@i_760], x2_695[@i_760], x3_694[@i_760], x4_693[@i_760], x5_692[@i_760], r_691[@i_760]) && otheruses(r_691[@i_760]) && ((x1_678 = x1_696[@i_760]) && ((x2_677 = x2_695[@i_760]) && ((x3_676 = x3_694[@i_760]) && ((x4_675 = x4_693[@i_760]) && (x5_674 = x5_692[@i_760]))))) then
  (
    out(c20[!_58], r_691[@i_760])
  )
  orfind @i_759 <= NU suchthat defined(x1_702[@i_759], x2_701[@i_759], x3_700[@i_759], x4_699[@i_759], x5_698[@i_759], r_697[@i_759]) && otheruses(r_697[@i_759]) && ((x1_678 = x1_702[@i_759]) && ((x2_677 = x2_701[@i_759]) && ((x3_676 = x3_700[@i_759]) && ((x4_675 = x4_699[@i_759]) && (x5_674 = x5_698[@i_759]))))) then
  (
    out(c20[!_58], r_697[@i_759])
  )
  orfind @i_758 <= NU suchthat defined(x1_708[@i_758], x2_707[@i_758], x3_706[@i_758], x4_705[@i_758], x5_704[@i_758], r_703[@i_758]) && otheruses(r_703[@i_758]) && ((x1_678 = x1_708[@i_758]) && ((x2_677 = x2_707[@i_758]) && ((x3_676 = x3_706[@i_758]) && ((x4_675 = x4_705[@i_758]) && (x5_674 = x5_704[@i_758]))))) then
  (
    out(c20[!_58], r_703[@i_758])
  )
  orfind @i_757 <= NU suchthat defined(x1_714[@i_757], x2_713[@i_757], x3_712[@i_757], x4_711[@i_757], x5_710[@i_757], r_709[@i_757]) && otheruses(r_709[@i_757]) && ((x1_678 = x1_714[@i_757]) && ((x2_677 = x2_713[@i_757]) && ((x3_676 = x3_712[@i_757]) && ((x4_675 = x4_711[@i_757]) && (x5_674 = x5_710[@i_757]))))) then
  (
    out(c20[!_58], r_709[@i_757])
  )
  orfind @i_756 <= NU suchthat defined(x1_720[@i_756], x2_719[@i_756], x3_718[@i_756], x4_717[@i_756], x5_716[@i_756], r_715[@i_756]) && otheruses(r_715[@i_756]) && ((x1_678 = x1_720[@i_756]) && ((x2_677 = x2_719[@i_756]) && ((x3_676 = x3_718[@i_756]) && ((x4_675 = x4_717[@i_756]) && (x5_674 = x5_716[@i_756]))))) then
  (
    out(c20[!_58], r_715[@i_756])
  )
  orfind @i_755 <= NU suchthat defined(x1_726[@i_755], x2_725[@i_755], x3_724[@i_755], x4_723[@i_755], x5_722[@i_755], r_721[@i_755]) && otheruses(r_721[@i_755]) && ((x1_678 = x1_726[@i_755]) && ((x2_677 = x2_725[@i_755]) && ((x3_676 = x3_724[@i_755]) && ((x4_675 = x4_723[@i_755]) && (x5_674 = x5_722[@i_755]))))) then
  (
    out(c20[!_58], r_721[@i_755])
  )
  orfind @i_754 <= NU suchthat defined(x1_732[@i_754], x2_731[@i_754], x3_730[@i_754], x4_729[@i_754], x5_728[@i_754], r_727[@i_754]) && otheruses(r_727[@i_754]) && ((x1_678 = x1_732[@i_754]) && ((x2_677 = x2_731[@i_754]) && ((x3_676 = x3_730[@i_754]) && ((x4_675 = x4_729[@i_754]) && (x5_674 = x5_728[@i_754]))))) then
  (
    out(c20[!_58], r_727[@i_754])
  )
  orfind @i_753 <= NU suchthat defined(x1_738[@i_753], x2_737[@i_753], x3_736[@i_753], x4_735[@i_753], x5_734[@i_753], r_733[@i_753]) && otheruses(r_733[@i_753]) && ((x1_678 = x1_738[@i_753]) && ((x2_677 = x2_737[@i_753]) && ((x3_676 = x3_736[@i_753]) && ((x4_675 = x4_735[@i_753]) && (x5_674 = x5_734[@i_753]))))) then
  (
    out(c20[!_58], r_733[@i_753])
  )
  orfind @i_752 <= NU suchthat defined(x1_744[@i_752], x2_743[@i_752], x3_742[@i_752], x4_741[@i_752], x5_740[@i_752], r_739[@i_752]) && otheruses(r_739[@i_752]) && ((x1_678 = x1_744[@i_752]) && ((x2_677 = x2_743[@i_752]) && ((x3_676 = x3_742[@i_752]) && ((x4_675 = x4_741[@i_752]) && (x5_674 = x5_740[@i_752]))))) then
  (
    out(c20[!_58], r_739[@i_752])
  )
  orfind @i_751 <= NU suchthat defined(x1_750[@i_751], x2_749[@i_751], x3_748[@i_751], x4_747[@i_751], x5_746[@i_751], r_745[@i_751]) && otheruses(r_745[@i_751]) && ((x1_678 = x1_750[@i_751]) && ((x2_677 = x2_749[@i_751]) && ((x3_676 = x3_748[@i_751]) && ((x4_675 = x4_747[@i_751]) && (x5_674 = x5_746[@i_751]))))) then
  (
    out(c20[!_58], r_745[@i_751])
  )
  else
  (
    new r_673: hash0;
    out(c20[!_58], r_673)
  )
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  let x1_253: host = cst_host in
  let x2_252: host = cst_host in
  let x3_251: G = cst_G in
  let x4_250: G = cst_G in
  let x5_249: G = cst_G in
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  orfind @i_309 <= NP suchthat defined(x1_259[@i_309], x2_258[@i_309], Xp[@i_309], Yp[@i_309], Kp[@i_309], r_254[@i_309]) && otheruses(r_254[@i_309]) && ((x1_64 = x1_259[@i_309]) && ((x2_63 = x2_258[@i_309]) && ((x3_62 = Xp[@i_309]) && ((x4_61 = Yp[@i_309]) && (x5_60 = Kp[@i_309]))))) then
  (
    out(c21[!_59], r_254[@i_309])
  )
  orfind @i_306 <= NU suchthat defined(x1_277[@i_306], x2_276[@i_306], X[@i_306], @2_r4_96[@i_306], K_u[@i_306], r_272[@i_306]) && otheruses(r_272[@i_306]) && ((x1_64 = x1_277[@i_306]) && ((x2_63 = x2_276[@i_306]) && ((x3_62 = X[@i_306]) && ((x4_61 = @2_r4_96[@i_306]) && (x5_60 = K_u[@i_306]))))) then
  (
    out(c21[!_59], r_272[@i_306])
  )
  orfind @i_305 <= NU suchthat defined(x1_283[@i_305], x2_282[@i_305], X[@i_305], @2_r4_84[@i_148[@i_305]], K_u[@i_305], r_278[@i_305]) && otheruses(r_278[@i_305]) && ((x1_64 = x1_283[@i_305]) && ((x2_63 = x2_282[@i_305]) && ((x3_62 = X[@i_305]) && ((x4_61 = @2_r4_84[@i_148[@i_305]]) && (x5_60 = K_u[@i_305]))))) then
  (
    out(c21[!_59], r_278[@i_305])
  )
  orfind @i_304 <= NU suchthat defined(x1_289[@i_304], x2_288[@i_304], X[@i_304], @2_r4_96[@i_144[@i_304]], K_u[@i_304], r_284[@i_304]) && otheruses(r_284[@i_304]) && ((x1_64 = x1_289[@i_304]) && ((x2_63 = x2_288[@i_304]) && ((x3_62 = X[@i_304]) && ((x4_61 = @2_r4_96[@i_144[@i_304]]) && (x5_60 = K_u[@i_304]))))) then
  (
    out(c21[!_59], r_284[@i_304])
  )
  orfind @i_303 <= NU suchthat defined(x1_295[@i_303], x2_294[@i_303], X[@i_303], Yp[@i_141[@i_303]], K_u[@i_303], r_290[@i_303]) && otheruses(r_290[@i_303]) && ((x1_64 = x1_295[@i_303]) && ((x2_63 = x2_294[@i_303]) && ((x3_62 = X[@i_303]) && ((x4_61 = Yp[@i_141[@i_303]]) && (x5_60 = K_u[@i_303]))))) then
  (
    out(c21[!_59], r_290[@i_303])
  )
  orfind @i_302 <= NU suchthat defined(x1_301[@i_302], x2_300[@i_302], X[@i_302], Y[@i_140[@i_302]], K_u[@i_302], r_296[@i_302]) && otheruses(r_296[@i_302]) && ((x1_64 = x1_301[@i_302]) && ((x2_63 = x2_300[@i_302]) && ((x3_62 = X[@i_302]) && ((x4_61 = Y[@i_140[@i_302]]) && (x5_60 = K_u[@i_302]))))) then
  (
    out(c21[!_59], r_296[@i_302])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying move all binders yields

Game 15 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_148 <= qD suchthat defined(@2_m[@i_148], @2_kd[@i_148], @2_r4_84[@i_148]) && otheruses(@2_r4_84[@i_148]) && ((Ystar_u = @2_m[@i_148]) && (pw = @2_kd[@i_148])) then
  (
    let K_u: G = exp(@2_r4_84[@i_148], x) in
    let x1_283: host = U in
    let x2_282: host = S in
    find [unique] @i_355 <= qH1 suchthat defined(x1_64[@i_355], x2_63[@i_355], x3_62[@i_355], x4_61[@i_355], x5_60[@i_355], r_248[@i_355]) && otheruses(r_248[@i_355]) && ((x1_283 = x1_64[@i_355]) && ((x2_282 = x2_63[@i_355]) && ((X = x3_62[@i_355]) && ((@2_r4_84[@i_148] = x4_61[@i_355]) && (K_u = x5_60[@i_355]))))) then
    (
      out(c6[!_53], r_248[@i_355]);
      in(c9[!_53], ());
      let x1_714: host = U in
      let x2_713: host = S in
      let x3_712: G = X in
      let x4_711: G = @2_r4_84[@i_148] in
      let x5_710: G = K_u in
      find [unique] @i_841 <= qH0 suchthat defined(x1_678[@i_841], x2_677[@i_841], x3_676[@i_841], x4_675[@i_841], x5_674[@i_841], r_673[@i_841]) && otheruses(r_673[@i_841]) && ((x1_714 = x1_678[@i_841]) && ((x2_713 = x2_677[@i_841]) && ((x3_712 = x3_676[@i_841]) && ((x4_711 = x4_675[@i_841]) && (x5_710 = x5_674[@i_841]))))) then
      (
        let sk_u: hash0 = r_673[@i_841]
      )
      else
      (
        new r_709: hash0;
        let sk_u: hash0 = r_709
      )
    )
    else
    (
      new r_278: hash1;
      out(c6[!_53], r_278);
      in(c9[!_53], ());
      let x1_708: host = U in
      let x2_707: host = S in
      let x3_706: G = X in
      let x4_705: G = @2_r4_84[@i_148] in
      let x5_704: G = K_u in
      find [unique] @i_828 <= qH0 suchthat defined(x1_678[@i_828], x2_677[@i_828], x3_676[@i_828], x4_675[@i_828], x5_674[@i_828], r_673[@i_828]) && otheruses(r_673[@i_828]) && ((x1_708 = x1_678[@i_828]) && ((x2_707 = x2_677[@i_828]) && ((x3_706 = x3_676[@i_828]) && ((x4_705 = x4_675[@i_828]) && (x5_704 = x5_674[@i_828]))))) then
      (
        let sk_u: hash0 = r_673[@i_828]
      )
      else
      (
        new r_703: hash0;
        let sk_u: hash0 = r_703
      )
    )
  )
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], @2_r4_96[@i_144]) && otheruses(@2_r4_96[@i_144]) && (Ystar_u = Ystar_u[@i_144]) then
  (
    let K_u: G = exp(@2_r4_96[@i_144], x) in
    let x1_289: host = U in
    let x2_288: host = S in
    find [unique] @i_364 <= qH1 suchthat defined(x1_64[@i_364], x2_63[@i_364], x3_62[@i_364], x4_61[@i_364], x5_60[@i_364], r_248[@i_364]) && otheruses(r_248[@i_364]) && ((x1_289 = x1_64[@i_364]) && ((x2_288 = x2_63[@i_364]) && ((X = x3_62[@i_364]) && ((@2_r4_96[@i_144] = x4_61[@i_364]) && (K_u = x5_60[@i_364]))))) then
    (
      out(c6[!_53], r_248[@i_364]);
      in(c9[!_53], ());
      let x1_726: host = U in
      let x2_725: host = S in
      let x3_724: G = X in
      let x4_723: G = @2_r4_96[@i_144] in
      let x5_722: G = K_u in
      find [unique] @i_867 <= qH0 suchthat defined(x1_678[@i_867], x2_677[@i_867], x3_676[@i_867], x4_675[@i_867], x5_674[@i_867], r_673[@i_867]) && otheruses(r_673[@i_867]) && ((x1_726 = x1_678[@i_867]) && ((x2_725 = x2_677[@i_867]) && ((x3_724 = x3_676[@i_867]) && ((x4_723 = x4_675[@i_867]) && (x5_722 = x5_674[@i_867]))))) then
      (
        let sk_u: hash0 = r_673[@i_867]
      )
      else
      (
        new r_721: hash0;
        let sk_u: hash0 = r_721
      )
    )
    else
    (
      new r_284: hash1;
      out(c6[!_53], r_284);
      in(c9[!_53], ());
      let x1_720: host = U in
      let x2_719: host = S in
      let x3_718: G = X in
      let x4_717: G = @2_r4_96[@i_144] in
      let x5_716: G = K_u in
      find [unique] @i_854 <= qH0 suchthat defined(x1_678[@i_854], x2_677[@i_854], x3_676[@i_854], x4_675[@i_854], x5_674[@i_854], r_673[@i_854]) && otheruses(r_673[@i_854]) && ((x1_720 = x1_678[@i_854]) && ((x2_719 = x2_677[@i_854]) && ((x3_718 = x3_676[@i_854]) && ((x4_717 = x4_675[@i_854]) && (x5_716 = x5_674[@i_854]))))) then
      (
        let sk_u: hash0 = r_673[@i_854]
      )
      else
      (
        new r_715: hash0;
        let sk_u: hash0 = r_715
      )
    )
  )
  orfind @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  orfind @i_141 <= NP suchthat defined(@2_r2_90[@i_141], yp[@i_141], Yp[@i_141]) && otheruses(@2_r2_90[@i_141]) && (Ystar_u = @2_r2_90[@i_141]) then
  (
    let K_u: G = exp(g, mult(yp[@i_141], x)) in
    let x1_295: host = U in
    let x2_294: host = S in
    find [unique] @i_373 <= qH1 suchthat defined(x1_64[@i_373], x2_63[@i_373], x3_62[@i_373], x4_61[@i_373], x5_60[@i_373], r_248[@i_373]) && otheruses(r_248[@i_373]) && ((x1_295 = x1_64[@i_373]) && ((x2_294 = x2_63[@i_373]) && ((X = x3_62[@i_373]) && ((Yp[@i_141] = x4_61[@i_373]) && (K_u = x5_60[@i_373]))))) then
    (
      out(c6[!_53], r_248[@i_373]);
      in(c9[!_53], ());
      let x1_738: host = U in
      let x2_737: host = S in
      let x3_736: G = X in
      let x4_735: G = Yp[@i_141] in
      let x5_734: G = K_u in
      find [unique] @i_893 <= qH0 suchthat defined(x1_678[@i_893], x2_677[@i_893], x3_676[@i_893], x4_675[@i_893], x5_674[@i_893], r_673[@i_893]) && otheruses(r_673[@i_893]) && ((x1_738 = x1_678[@i_893]) && ((x2_737 = x2_677[@i_893]) && ((x3_736 = x3_676[@i_893]) && ((x4_735 = x4_675[@i_893]) && (x5_734 = x5_674[@i_893]))))) then
      (
        let sk_u: hash0 = r_673[@i_893]
      )
      else
      (
        new r_733: hash0;
        let sk_u: hash0 = r_733
      )
    )
    else
    (
      new r_290: hash1;
      out(c6[!_53], r_290);
      in(c9[!_53], ());
      let x1_732: host = U in
      let x2_731: host = S in
      let x3_730: G = X in
      let x4_729: G = Yp[@i_141] in
      let x5_728: G = K_u in
      find [unique] @i_880 <= qH0 suchthat defined(x1_678[@i_880], x2_677[@i_880], x3_676[@i_880], x4_675[@i_880], x5_674[@i_880], r_673[@i_880]) && otheruses(r_673[@i_880]) && ((x1_732 = x1_678[@i_880]) && ((x2_731 = x2_677[@i_880]) && ((x3_730 = x3_676[@i_880]) && ((x4_729 = x4_675[@i_880]) && (x5_728 = x5_674[@i_880]))))) then
      (
        let sk_u: hash0 = r_673[@i_880]
      )
      else
      (
        new r_727: hash0;
        let sk_u: hash0 = r_727
      )
    )
  )
  orfind @i_140 <= NS suchthat defined(@2_r2_93[@i_140], y[@i_140], Y[@i_140]) && otheruses(@2_r2_93[@i_140]) && (Ystar_u = @2_r2_93[@i_140]) then
  (
    let K_u: G = exp(g, mult(y[@i_140], x)) in
    let x1_301: host = U in
    let x2_300: host = S in
    find [unique] @i_382 <= qH1 suchthat defined(x1_64[@i_382], x2_63[@i_382], x3_62[@i_382], x4_61[@i_382], x5_60[@i_382], r_248[@i_382]) && otheruses(r_248[@i_382]) && ((x1_301 = x1_64[@i_382]) && ((x2_300 = x2_63[@i_382]) && ((X = x3_62[@i_382]) && ((Y[@i_140] = x4_61[@i_382]) && (K_u = x5_60[@i_382]))))) then
    (
      out(c6[!_53], r_248[@i_382]);
      in(c9[!_53], ());
      let x1_750: host = U in
      let x2_749: host = S in
      let x3_748: G = X in
      let x4_747: G = Y[@i_140] in
      let x5_746: G = K_u in
      find [unique] @i_919 <= qH0 suchthat defined(x1_678[@i_919], x2_677[@i_919], x3_676[@i_919], x4_675[@i_919], x5_674[@i_919], r_673[@i_919]) && otheruses(r_673[@i_919]) && ((x1_750 = x1_678[@i_919]) && ((x2_749 = x2_677[@i_919]) && ((x3_748 = x3_676[@i_919]) && ((x4_747 = x4_675[@i_919]) && (x5_746 = x5_674[@i_919]))))) then
      (
        let sk_u: hash0 = r_673[@i_919]
      )
      orfind  suchthat defined(j[@i_140], r_685[@i_140]) && otheruses(r_685[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let @i_917 <= NS = @i_140 in
        let sk_u: hash0 = r_685[@i_140]
      )
      else
      (
        new r_745: hash0;
        let sk_u: hash0 = r_745
      )
    )
    else
    (
      new r_296: hash1;
      out(c6[!_53], r_296);
      in(c9[!_53], ());
      let x1_744: host = U in
      let x2_743: host = S in
      let x3_742: G = X in
      let x4_741: G = Y[@i_140] in
      let x5_740: G = K_u in
      find [unique] @i_906 <= qH0 suchthat defined(x1_678[@i_906], x2_677[@i_906], x3_676[@i_906], x4_675[@i_906], x5_674[@i_906], r_673[@i_906]) && otheruses(r_673[@i_906]) && ((x1_744 = x1_678[@i_906]) && ((x2_743 = x2_677[@i_906]) && ((x3_742 = x3_676[@i_906]) && ((x4_741 = x4_675[@i_906]) && (x5_740 = x5_674[@i_906]))))) then
      (
        let sk_u: hash0 = r_673[@i_906]
      )
      orfind  suchthat defined(j[@i_140], r_685[@i_140]) && otheruses(r_685[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let @i_904 <= NS = @i_140 in
        let sk_u: hash0 = r_685[@i_140]
      )
      orfind  suchthat defined(j[@i_140], r_691[@i_140]) && otheruses(r_691[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let @i_903 <= NS = @i_140 in
        let sk_u: hash0 = r_691[@i_140]
      )
      else
      (
        new r_739: hash0;
        let sk_u: hash0 = r_739
      )
    )
  )
  else
  (
    new @2_r4_96: G;
    let K_u: G = exp(@2_r4_96, x) in
    let x1_277: host = U in
    let x2_276: host = S in
    let x3_275: G = cst_G in
    let x4_274: G = cst_G in
    let x5_273: G = cst_G in
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ());
    let x1_702: host = U in
    let x2_701: host = S in
    let x3_700: G = X in
    let x4_699: G = @2_r4_96 in
    let x5_698: G = K_u in
    find [unique] @i_815 <= qH0 suchthat defined(x1_678[@i_815], x2_677[@i_815], x3_676[@i_815], x4_675[@i_815], x5_674[@i_815], r_673[@i_815]) && otheruses(r_673[@i_815]) && ((x1_702 = x1_678[@i_815]) && ((x2_701 = x2_677[@i_815]) && ((x3_700 = x3_676[@i_815]) && ((x4_699 = x4_675[@i_815]) && (x5_698 = x5_674[@i_815]))))) then
    (
      let sk_u: hash0 = r_673[@i_815]
    )
    else
    (
      new r_697: hash0;
      let sk_u: hash0 = r_697
    )
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_271: host = U in
    let x2_270: host = S in
    find [unique] @i_337 <= qH1 suchthat defined(x1_64[@i_337], x2_63[@i_337], x3_62[@i_337], x4_61[@i_337], x5_60[@i_337], r_248[@i_337]) && otheruses(r_248[@i_337]) && ((x1_271 = x1_64[@i_337]) && ((x2_270 = x2_63[@i_337]) && ((X_s = x3_62[@i_337]) && ((Y = x4_61[@i_337]) && (K_s = x5_60[@i_337]))))) then
    (
      if (auth_s = r_248[@i_337]) then
      let x1_690: host = U in
      let x2_689: host = S in
      let x3_688: G = X_s in
      let x4_687: G = Y in
      let x5_686: G = K_s in
      find [unique] @i_789 <= qH0 suchthat defined(x1_678[@i_789], x2_677[@i_789], x3_676[@i_789], x4_675[@i_789], x5_674[@i_789], r_673[@i_789]) && otheruses(r_673[@i_789]) && ((x1_690 = x1_678[@i_789]) && ((x2_689 = x2_677[@i_789]) && ((x3_688 = x3_676[@i_789]) && ((x4_687 = x4_675[@i_789]) && (x5_686 = x5_674[@i_789]))))) then
      (
        let sk_s: hash0 = r_673[@i_789]
      )
      orfind  suchthat defined(@i_140[j], r_739[j]) && otheruses(r_739[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
      (
        let @i_778 <= NU = j in
        let sk_s: hash0 = r_739[j]
      )
      orfind  suchthat defined(@i_140[j], r_745[j]) && otheruses(r_745[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
      (
        let @i_777 <= NU = j in
        let sk_s: hash0 = r_745[j]
      )
      else
      (
        new r_685: hash0;
        let sk_s: hash0 = r_685
      )
    )
    orfind  suchthat defined(@i_140[j], r_296[j]) && otheruses(r_296[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
    (
      if (auth_s = r_296[j]) then
      let x1_696: host = U in
      let x2_695: host = S in
      let x3_694: G = X_s in
      let x4_693: G = Y in
      let x5_692: G = K_s in
      find [unique] @i_802 <= qH0 suchthat defined(x1_678[@i_802], x2_677[@i_802], x3_676[@i_802], x4_675[@i_802], x5_674[@i_802], r_673[@i_802]) && otheruses(r_673[@i_802]) && ((x1_696 = x1_678[@i_802]) && ((x2_695 = x2_677[@i_802]) && ((x3_694 = x3_676[@i_802]) && ((x4_693 = x4_675[@i_802]) && (x5_692 = x5_674[@i_802]))))) then
      (
        let sk_s: hash0 = r_673[@i_802]
      )
      orfind  suchthat defined(r_739[j]) && otheruses(r_739[j]) then
      (
        let @i_791 <= NU = j in
        let sk_s: hash0 = r_739[j]
      )
      else
      (
        new r_691: hash0;
        let sk_s: hash0 = r_691
      )
    )
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    event Auth
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_90: G;
  let x1_259: host = U in
  let x2_258: host = S in
  let x3_257: G = cst_G in
  let x4_256: G = cst_G in
  let x5_255: G = cst_G in
  new r_254: hash1;
  let x1_684: host = U in
  let x2_683: host = S in
  let x3_682: G = Xp in
  let x4_681: G = Yp in
  let x5_680: G = Kp in
  new r_679: hash0;
  let sk_p: hash0 = r_679 in
  out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@2_r4_84[@i_118], @2_kd[@i_118], @2_m[@i_118]) && otheruses(@2_r4_84[@i_118]) && ((@2_x = @2_r4_84[@i_118]) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_114 <= NU suchthat defined(@2_r4_96[@i_114], Ystar_u[@i_114]) && otheruses(@2_r4_96[@i_114]) && ((@2_x = @2_r4_96[@i_114]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], Ystar_u[@i_114])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = Yp[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@2_m[@i_108], @2_kd[@i_108], @2_r4_84[@i_108]) && otheruses(@2_r4_84[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], @2_r4_84[@i_108])
  )
  orfind @i_104 <= NU suchthat defined(Ystar_u[@i_104], @2_r4_96[@i_104]) && otheruses(@2_r4_96[@i_104]) && ((@2_m = Ystar_u[@i_104]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], @2_r4_96[@i_104])
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@2_r2_90[@i_101], Yp[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Yp[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_r2_93[@i_100], Y[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @2_r4_84: G;
    out(@2_c4[!_57], @2_r4_84)
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  let x1_678: host = x1_69 in
  let x2_677: host = x2_68 in
  let x3_676: G = x3_67 in
  let x4_675: G = x4_66 in
  let x5_674: G = x5_65 in
  find [unique] @i_763 <= qH0 suchthat defined(x1_678[@i_763], x2_677[@i_763], x3_676[@i_763], x4_675[@i_763], x5_674[@i_763], r_673[@i_763]) && otheruses(r_673[@i_763]) && ((x1_678 = x1_678[@i_763]) && ((x2_677 = x2_677[@i_763]) && ((x3_676 = x3_676[@i_763]) && ((x4_675 = x4_675[@i_763]) && (x5_674 = x5_674[@i_763]))))) then
  (
    out(c20[!_58], r_673[@i_763])
  )
  orfind @i_762 <= NP suchthat defined(x1_684[@i_762], x2_683[@i_762], x3_682[@i_762], x4_681[@i_762], x5_680[@i_762], r_679[@i_762]) && otheruses(r_679[@i_762]) && ((x1_678 = x1_684[@i_762]) && ((x2_677 = x2_683[@i_762]) && ((x3_676 = x3_682[@i_762]) && ((x4_675 = x4_681[@i_762]) && (x5_674 = x5_680[@i_762]))))) then
  (
    out(c20[!_58], r_679[@i_762])
  )
  orfind @i_761 <= NS suchthat defined(x1_690[@i_761], x2_689[@i_761], x3_688[@i_761], x4_687[@i_761], x5_686[@i_761], r_685[@i_761]) && otheruses(r_685[@i_761]) && ((x1_678 = x1_690[@i_761]) && ((x2_677 = x2_689[@i_761]) && ((x3_676 = x3_688[@i_761]) && ((x4_675 = x4_687[@i_761]) && (x5_674 = x5_686[@i_761]))))) then
  (
    out(c20[!_58], r_685[@i_761])
  )
  orfind @i_760 <= NS suchthat defined(x1_696[@i_760], x2_695[@i_760], x3_694[@i_760], x4_693[@i_760], x5_692[@i_760], r_691[@i_760]) && otheruses(r_691[@i_760]) && ((x1_678 = x1_696[@i_760]) && ((x2_677 = x2_695[@i_760]) && ((x3_676 = x3_694[@i_760]) && ((x4_675 = x4_693[@i_760]) && (x5_674 = x5_692[@i_760]))))) then
  (
    out(c20[!_58], r_691[@i_760])
  )
  orfind @i_759 <= NU suchthat defined(x1_702[@i_759], x2_701[@i_759], x3_700[@i_759], x4_699[@i_759], x5_698[@i_759], r_697[@i_759]) && otheruses(r_697[@i_759]) && ((x1_678 = x1_702[@i_759]) && ((x2_677 = x2_701[@i_759]) && ((x3_676 = x3_700[@i_759]) && ((x4_675 = x4_699[@i_759]) && (x5_674 = x5_698[@i_759]))))) then
  (
    out(c20[!_58], r_697[@i_759])
  )
  orfind @i_758 <= NU suchthat defined(x1_708[@i_758], x2_707[@i_758], x3_706[@i_758], x4_705[@i_758], x5_704[@i_758], r_703[@i_758]) && otheruses(r_703[@i_758]) && ((x1_678 = x1_708[@i_758]) && ((x2_677 = x2_707[@i_758]) && ((x3_676 = x3_706[@i_758]) && ((x4_675 = x4_705[@i_758]) && (x5_674 = x5_704[@i_758]))))) then
  (
    out(c20[!_58], r_703[@i_758])
  )
  orfind @i_757 <= NU suchthat defined(x1_714[@i_757], x2_713[@i_757], x3_712[@i_757], x4_711[@i_757], x5_710[@i_757], r_709[@i_757]) && otheruses(r_709[@i_757]) && ((x1_678 = x1_714[@i_757]) && ((x2_677 = x2_713[@i_757]) && ((x3_676 = x3_712[@i_757]) && ((x4_675 = x4_711[@i_757]) && (x5_674 = x5_710[@i_757]))))) then
  (
    out(c20[!_58], r_709[@i_757])
  )
  orfind @i_756 <= NU suchthat defined(x1_720[@i_756], x2_719[@i_756], x3_718[@i_756], x4_717[@i_756], x5_716[@i_756], r_715[@i_756]) && otheruses(r_715[@i_756]) && ((x1_678 = x1_720[@i_756]) && ((x2_677 = x2_719[@i_756]) && ((x3_676 = x3_718[@i_756]) && ((x4_675 = x4_717[@i_756]) && (x5_674 = x5_716[@i_756]))))) then
  (
    out(c20[!_58], r_715[@i_756])
  )
  orfind @i_755 <= NU suchthat defined(x1_726[@i_755], x2_725[@i_755], x3_724[@i_755], x4_723[@i_755], x5_722[@i_755], r_721[@i_755]) && otheruses(r_721[@i_755]) && ((x1_678 = x1_726[@i_755]) && ((x2_677 = x2_725[@i_755]) && ((x3_676 = x3_724[@i_755]) && ((x4_675 = x4_723[@i_755]) && (x5_674 = x5_722[@i_755]))))) then
  (
    out(c20[!_58], r_721[@i_755])
  )
  orfind @i_754 <= NU suchthat defined(x1_732[@i_754], x2_731[@i_754], x3_730[@i_754], x4_729[@i_754], x5_728[@i_754], r_727[@i_754]) && otheruses(r_727[@i_754]) && ((x1_678 = x1_732[@i_754]) && ((x2_677 = x2_731[@i_754]) && ((x3_676 = x3_730[@i_754]) && ((x4_675 = x4_729[@i_754]) && (x5_674 = x5_728[@i_754]))))) then
  (
    out(c20[!_58], r_727[@i_754])
  )
  orfind @i_753 <= NU suchthat defined(x1_738[@i_753], x2_737[@i_753], x3_736[@i_753], x4_735[@i_753], x5_734[@i_753], r_733[@i_753]) && otheruses(r_733[@i_753]) && ((x1_678 = x1_738[@i_753]) && ((x2_677 = x2_737[@i_753]) && ((x3_676 = x3_736[@i_753]) && ((x4_675 = x4_735[@i_753]) && (x5_674 = x5_734[@i_753]))))) then
  (
    out(c20[!_58], r_733[@i_753])
  )
  orfind @i_752 <= NU suchthat defined(x1_744[@i_752], x2_743[@i_752], x3_742[@i_752], x4_741[@i_752], x5_740[@i_752], r_739[@i_752]) && otheruses(r_739[@i_752]) && ((x1_678 = x1_744[@i_752]) && ((x2_677 = x2_743[@i_752]) && ((x3_676 = x3_742[@i_752]) && ((x4_675 = x4_741[@i_752]) && (x5_674 = x5_740[@i_752]))))) then
  (
    out(c20[!_58], r_739[@i_752])
  )
  orfind @i_751 <= NU suchthat defined(x1_750[@i_751], x2_749[@i_751], x3_748[@i_751], x4_747[@i_751], x5_746[@i_751], r_745[@i_751]) && otheruses(r_745[@i_751]) && ((x1_678 = x1_750[@i_751]) && ((x2_677 = x2_749[@i_751]) && ((x3_676 = x3_748[@i_751]) && ((x4_675 = x4_747[@i_751]) && (x5_674 = x5_746[@i_751]))))) then
  (
    out(c20[!_58], r_745[@i_751])
  )
  else
  (
    new r_673: hash0;
    out(c20[!_58], r_673)
  )
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  orfind @i_309 <= NP suchthat defined(x1_259[@i_309], x2_258[@i_309], Xp[@i_309], Yp[@i_309], Kp[@i_309], r_254[@i_309]) && otheruses(r_254[@i_309]) && ((x1_64 = x1_259[@i_309]) && ((x2_63 = x2_258[@i_309]) && ((x3_62 = Xp[@i_309]) && ((x4_61 = Yp[@i_309]) && (x5_60 = Kp[@i_309]))))) then
  (
    out(c21[!_59], r_254[@i_309])
  )
  orfind @i_306 <= NU suchthat defined(x1_277[@i_306], x2_276[@i_306], X[@i_306], @2_r4_96[@i_306], K_u[@i_306], r_272[@i_306]) && otheruses(r_272[@i_306]) && ((x1_64 = x1_277[@i_306]) && ((x2_63 = x2_276[@i_306]) && ((x3_62 = X[@i_306]) && ((x4_61 = @2_r4_96[@i_306]) && (x5_60 = K_u[@i_306]))))) then
  (
    out(c21[!_59], r_272[@i_306])
  )
  orfind @i_305 <= NU suchthat defined(x1_283[@i_305], x2_282[@i_305], X[@i_305], @2_r4_84[@i_148[@i_305]], K_u[@i_305], r_278[@i_305]) && otheruses(r_278[@i_305]) && ((x1_64 = x1_283[@i_305]) && ((x2_63 = x2_282[@i_305]) && ((x3_62 = X[@i_305]) && ((x4_61 = @2_r4_84[@i_148[@i_305]]) && (x5_60 = K_u[@i_305]))))) then
  (
    out(c21[!_59], r_278[@i_305])
  )
  orfind @i_304 <= NU suchthat defined(x1_289[@i_304], x2_288[@i_304], X[@i_304], @2_r4_96[@i_144[@i_304]], K_u[@i_304], r_284[@i_304]) && otheruses(r_284[@i_304]) && ((x1_64 = x1_289[@i_304]) && ((x2_63 = x2_288[@i_304]) && ((x3_62 = X[@i_304]) && ((x4_61 = @2_r4_96[@i_144[@i_304]]) && (x5_60 = K_u[@i_304]))))) then
  (
    out(c21[!_59], r_284[@i_304])
  )
  orfind @i_303 <= NU suchthat defined(x1_295[@i_303], x2_294[@i_303], X[@i_303], Yp[@i_141[@i_303]], K_u[@i_303], r_290[@i_303]) && otheruses(r_290[@i_303]) && ((x1_64 = x1_295[@i_303]) && ((x2_63 = x2_294[@i_303]) && ((x3_62 = X[@i_303]) && ((x4_61 = Yp[@i_141[@i_303]]) && (x5_60 = K_u[@i_303]))))) then
  (
    out(c21[!_59], r_290[@i_303])
  )
  orfind @i_302 <= NU suchthat defined(x1_301[@i_302], x2_300[@i_302], X[@i_302], Y[@i_140[@i_302]], K_u[@i_302], r_296[@i_302]) && otheruses(r_296[@i_302]) && ((x1_64 = x1_301[@i_302]) && ((x2_63 = x2_300[@i_302]) && ((x3_62 = X[@i_302]) && ((x4_61 = Y[@i_140[@i_302]]) && (x5_60 = K_u[@i_302]))))) then
  (
    out(c21[!_59], r_296[@i_302])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying remove assignments of useless yields

Game 16 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_148 <= qD suchthat defined(@2_m[@i_148], @2_kd[@i_148], @2_r4_84[@i_148]) && otheruses(@2_r4_84[@i_148]) && ((Ystar_u = @2_m[@i_148]) && (pw = @2_kd[@i_148])) then
  (
    let K_u: G = exp(@2_r4_84[@i_148], x) in
    let x1_283: host = U in
    let x2_282: host = S in
    find [unique] @i_355 <= qH1 suchthat defined(x1_64[@i_355], x2_63[@i_355], x3_62[@i_355], x4_61[@i_355], x5_60[@i_355], r_248[@i_355]) && otheruses(r_248[@i_355]) && ((x1_283 = x1_64[@i_355]) && ((x2_282 = x2_63[@i_355]) && ((X = x3_62[@i_355]) && ((@2_r4_84[@i_148] = x4_61[@i_355]) && (K_u = x5_60[@i_355]))))) then
    (
      out(c6[!_53], r_248[@i_355]);
      in(c9[!_53], ());
      let x1_714: host = U in
      let x2_713: host = S in
      let x3_712: G = cst_G in
      let x4_711: G = cst_G in
      let x5_710: G = cst_G in
      find [unique] @i_841 <= qH0 suchthat defined(x1_69[@i_841], x2_68[@i_841], x3_67[@i_841], x4_66[@i_841], x5_65[@i_841], x5_674[@i_841], x4_675[@i_841], x3_676[@i_841], x2_677[@i_841], x1_678[@i_841], r_673[@i_841]) && otheruses(r_673[@i_841]) && ((x1_714 = x1_69[@i_841]) && ((x2_713 = x2_68[@i_841]) && ((X = x3_67[@i_841]) && ((@2_r4_84[@i_148] = x4_66[@i_841]) && (K_u = x5_65[@i_841]))))) then
      (
        let sk_u: hash0 = r_673[@i_841]
      )
      else
      (
        new r_709: hash0;
        let sk_u: hash0 = r_709
      )
    )
    else
    (
      new r_278: hash1;
      out(c6[!_53], r_278);
      in(c9[!_53], ());
      let x1_708: host = U in
      let x2_707: host = S in
      let x3_706: G = cst_G in
      let x4_705: G = cst_G in
      let x5_704: G = cst_G in
      find [unique] @i_828 <= qH0 suchthat defined(x1_69[@i_828], x2_68[@i_828], x3_67[@i_828], x4_66[@i_828], x5_65[@i_828], x5_674[@i_828], x4_675[@i_828], x3_676[@i_828], x2_677[@i_828], x1_678[@i_828], r_673[@i_828]) && otheruses(r_673[@i_828]) && ((x1_708 = x1_69[@i_828]) && ((x2_707 = x2_68[@i_828]) && ((X = x3_67[@i_828]) && ((@2_r4_84[@i_148] = x4_66[@i_828]) && (K_u = x5_65[@i_828]))))) then
      (
        let sk_u: hash0 = r_673[@i_828]
      )
      else
      (
        new r_703: hash0;
        let sk_u: hash0 = r_703
      )
    )
  )
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], @2_r4_96[@i_144]) && otheruses(@2_r4_96[@i_144]) && (Ystar_u = Ystar_u[@i_144]) then
  (
    let K_u: G = exp(@2_r4_96[@i_144], x) in
    let x1_289: host = U in
    let x2_288: host = S in
    find [unique] @i_364 <= qH1 suchthat defined(x1_64[@i_364], x2_63[@i_364], x3_62[@i_364], x4_61[@i_364], x5_60[@i_364], r_248[@i_364]) && otheruses(r_248[@i_364]) && ((x1_289 = x1_64[@i_364]) && ((x2_288 = x2_63[@i_364]) && ((X = x3_62[@i_364]) && ((@2_r4_96[@i_144] = x4_61[@i_364]) && (K_u = x5_60[@i_364]))))) then
    (
      out(c6[!_53], r_248[@i_364]);
      in(c9[!_53], ());
      let x1_726: host = U in
      let x2_725: host = S in
      let x3_724: G = cst_G in
      let x4_723: G = cst_G in
      let x5_722: G = cst_G in
      find [unique] @i_867 <= qH0 suchthat defined(x1_69[@i_867], x2_68[@i_867], x3_67[@i_867], x4_66[@i_867], x5_65[@i_867], x5_674[@i_867], x4_675[@i_867], x3_676[@i_867], x2_677[@i_867], x1_678[@i_867], r_673[@i_867]) && otheruses(r_673[@i_867]) && ((x1_726 = x1_69[@i_867]) && ((x2_725 = x2_68[@i_867]) && ((X = x3_67[@i_867]) && ((@2_r4_96[@i_144] = x4_66[@i_867]) && (K_u = x5_65[@i_867]))))) then
      (
        let sk_u: hash0 = r_673[@i_867]
      )
      else
      (
        new r_721: hash0;
        let sk_u: hash0 = r_721
      )
    )
    else
    (
      new r_284: hash1;
      out(c6[!_53], r_284);
      in(c9[!_53], ());
      let x1_720: host = U in
      let x2_719: host = S in
      let x3_718: G = cst_G in
      let x4_717: G = cst_G in
      let x5_716: G = cst_G in
      find [unique] @i_854 <= qH0 suchthat defined(x1_69[@i_854], x2_68[@i_854], x3_67[@i_854], x4_66[@i_854], x5_65[@i_854], x5_674[@i_854], x4_675[@i_854], x3_676[@i_854], x2_677[@i_854], x1_678[@i_854], r_673[@i_854]) && otheruses(r_673[@i_854]) && ((x1_720 = x1_69[@i_854]) && ((x2_719 = x2_68[@i_854]) && ((X = x3_67[@i_854]) && ((@2_r4_96[@i_144] = x4_66[@i_854]) && (K_u = x5_65[@i_854]))))) then
      (
        let sk_u: hash0 = r_673[@i_854]
      )
      else
      (
        new r_715: hash0;
        let sk_u: hash0 = r_715
      )
    )
  )
  orfind @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  orfind @i_141 <= NP suchthat defined(@2_r2_90[@i_141], yp[@i_141], Yp[@i_141]) && otheruses(@2_r2_90[@i_141]) && (Ystar_u = @2_r2_90[@i_141]) then
  (
    let K_u: G = exp(g, mult(yp[@i_141], x)) in
    let x1_295: host = U in
    let x2_294: host = S in
    find [unique] @i_373 <= qH1 suchthat defined(x1_64[@i_373], x2_63[@i_373], x3_62[@i_373], x4_61[@i_373], x5_60[@i_373], r_248[@i_373]) && otheruses(r_248[@i_373]) && ((x1_295 = x1_64[@i_373]) && ((x2_294 = x2_63[@i_373]) && ((X = x3_62[@i_373]) && ((Yp[@i_141] = x4_61[@i_373]) && (K_u = x5_60[@i_373]))))) then
    (
      out(c6[!_53], r_248[@i_373]);
      in(c9[!_53], ());
      let x1_738: host = U in
      let x2_737: host = S in
      let x3_736: G = cst_G in
      let x4_735: G = cst_G in
      let x5_734: G = cst_G in
      find [unique] @i_893 <= qH0 suchthat defined(x1_69[@i_893], x2_68[@i_893], x3_67[@i_893], x4_66[@i_893], x5_65[@i_893], x5_674[@i_893], x4_675[@i_893], x3_676[@i_893], x2_677[@i_893], x1_678[@i_893], r_673[@i_893]) && otheruses(r_673[@i_893]) && ((x1_738 = x1_69[@i_893]) && ((x2_737 = x2_68[@i_893]) && ((X = x3_67[@i_893]) && ((Yp[@i_141] = x4_66[@i_893]) && (K_u = x5_65[@i_893]))))) then
      (
        let sk_u: hash0 = r_673[@i_893]
      )
      else
      (
        new r_733: hash0;
        let sk_u: hash0 = r_733
      )
    )
    else
    (
      new r_290: hash1;
      out(c6[!_53], r_290);
      in(c9[!_53], ());
      let x1_732: host = U in
      let x2_731: host = S in
      let x3_730: G = cst_G in
      let x4_729: G = cst_G in
      let x5_728: G = cst_G in
      find [unique] @i_880 <= qH0 suchthat defined(x1_69[@i_880], x2_68[@i_880], x3_67[@i_880], x4_66[@i_880], x5_65[@i_880], x5_674[@i_880], x4_675[@i_880], x3_676[@i_880], x2_677[@i_880], x1_678[@i_880], r_673[@i_880]) && otheruses(r_673[@i_880]) && ((x1_732 = x1_69[@i_880]) && ((x2_731 = x2_68[@i_880]) && ((X = x3_67[@i_880]) && ((Yp[@i_141] = x4_66[@i_880]) && (K_u = x5_65[@i_880]))))) then
      (
        let sk_u: hash0 = r_673[@i_880]
      )
      else
      (
        new r_727: hash0;
        let sk_u: hash0 = r_727
      )
    )
  )
  orfind @i_140 <= NS suchthat defined(@2_r2_93[@i_140], y[@i_140], Y[@i_140]) && otheruses(@2_r2_93[@i_140]) && (Ystar_u = @2_r2_93[@i_140]) then
  (
    let K_u: G = exp(g, mult(y[@i_140], x)) in
    let x1_301: host = U in
    let x2_300: host = S in
    find [unique] @i_382 <= qH1 suchthat defined(x1_64[@i_382], x2_63[@i_382], x3_62[@i_382], x4_61[@i_382], x5_60[@i_382], r_248[@i_382]) && otheruses(r_248[@i_382]) && ((x1_301 = x1_64[@i_382]) && ((x2_300 = x2_63[@i_382]) && ((X = x3_62[@i_382]) && ((Y[@i_140] = x4_61[@i_382]) && (K_u = x5_60[@i_382]))))) then
    (
      out(c6[!_53], r_248[@i_382]);
      in(c9[!_53], ());
      let x1_750: host = U in
      let x2_749: host = S in
      let x3_748: G = cst_G in
      let x4_747: G = cst_G in
      let x5_746: G = cst_G in
      find [unique] @i_919 <= qH0 suchthat defined(x1_69[@i_919], x2_68[@i_919], x3_67[@i_919], x4_66[@i_919], x5_65[@i_919], x5_674[@i_919], x4_675[@i_919], x3_676[@i_919], x2_677[@i_919], x1_678[@i_919], r_673[@i_919]) && otheruses(r_673[@i_919]) && ((x1_750 = x1_69[@i_919]) && ((x2_749 = x2_68[@i_919]) && ((X = x3_67[@i_919]) && ((Y[@i_140] = x4_66[@i_919]) && (K_u = x5_65[@i_919]))))) then
      (
        let sk_u: hash0 = r_673[@i_919]
      )
      orfind  suchthat defined(j[@i_140], r_685[@i_140]) && otheruses(r_685[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_685[@i_140]
      )
      else
      (
        new r_745: hash0;
        let sk_u: hash0 = r_745
      )
    )
    else
    (
      new r_296: hash1;
      out(c6[!_53], r_296);
      in(c9[!_53], ());
      let x1_744: host = U in
      let x2_743: host = S in
      let x3_742: G = cst_G in
      let x4_741: G = cst_G in
      let x5_740: G = cst_G in
      find [unique] @i_906 <= qH0 suchthat defined(x1_69[@i_906], x2_68[@i_906], x3_67[@i_906], x4_66[@i_906], x5_65[@i_906], x5_674[@i_906], x4_675[@i_906], x3_676[@i_906], x2_677[@i_906], x1_678[@i_906], r_673[@i_906]) && otheruses(r_673[@i_906]) && ((x1_744 = x1_69[@i_906]) && ((x2_743 = x2_68[@i_906]) && ((X = x3_67[@i_906]) && ((Y[@i_140] = x4_66[@i_906]) && (K_u = x5_65[@i_906]))))) then
      (
        let sk_u: hash0 = r_673[@i_906]
      )
      orfind  suchthat defined(j[@i_140], r_685[@i_140]) && otheruses(r_685[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_685[@i_140]
      )
      orfind  suchthat defined(j[@i_140], r_691[@i_140]) && otheruses(r_691[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_691[@i_140]
      )
      else
      (
        new r_739: hash0;
        let sk_u: hash0 = r_739
      )
    )
  )
  else
  (
    new @2_r4_96: G;
    let K_u: G = exp(@2_r4_96, x) in
    let x1_277: host = U in
    let x2_276: host = S in
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ());
    let x1_702: host = U in
    let x2_701: host = S in
    let x3_700: G = cst_G in
    let x4_699: G = cst_G in
    let x5_698: G = cst_G in
    find [unique] @i_815 <= qH0 suchthat defined(x1_69[@i_815], x2_68[@i_815], x3_67[@i_815], x4_66[@i_815], x5_65[@i_815], x5_674[@i_815], x4_675[@i_815], x3_676[@i_815], x2_677[@i_815], x1_678[@i_815], r_673[@i_815]) && otheruses(r_673[@i_815]) && ((x1_702 = x1_69[@i_815]) && ((x2_701 = x2_68[@i_815]) && ((X = x3_67[@i_815]) && ((@2_r4_96 = x4_66[@i_815]) && (K_u = x5_65[@i_815]))))) then
    (
      let sk_u: hash0 = r_673[@i_815]
    )
    else
    (
      new r_697: hash0;
      let sk_u: hash0 = r_697
    )
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_271: host = U in
    let x2_270: host = S in
    find [unique] @i_337 <= qH1 suchthat defined(x1_64[@i_337], x2_63[@i_337], x3_62[@i_337], x4_61[@i_337], x5_60[@i_337], r_248[@i_337]) && otheruses(r_248[@i_337]) && ((x1_271 = x1_64[@i_337]) && ((x2_270 = x2_63[@i_337]) && ((X_s = x3_62[@i_337]) && ((Y = x4_61[@i_337]) && (K_s = x5_60[@i_337]))))) then
    (
      if (auth_s = r_248[@i_337]) then
      let x1_690: host = U in
      let x2_689: host = S in
      let x3_688: G = cst_G in
      let x4_687: G = cst_G in
      let x5_686: G = cst_G in
      find [unique] @i_789 <= qH0 suchthat defined(x1_69[@i_789], x2_68[@i_789], x3_67[@i_789], x4_66[@i_789], x5_65[@i_789], x5_674[@i_789], x4_675[@i_789], x3_676[@i_789], x2_677[@i_789], x1_678[@i_789], r_673[@i_789]) && otheruses(r_673[@i_789]) && ((x1_690 = x1_69[@i_789]) && ((x2_689 = x2_68[@i_789]) && ((X_s = x3_67[@i_789]) && ((Y = x4_66[@i_789]) && (K_s = x5_65[@i_789]))))) then
      (
        let sk_s: hash0 = r_673[@i_789]
      )
      orfind  suchthat defined(@i_140[j], r_739[j]) && otheruses(r_739[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
      (
        let sk_s: hash0 = r_739[j]
      )
      orfind  suchthat defined(@i_140[j], r_745[j]) && otheruses(r_745[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
      (
        let sk_s: hash0 = r_745[j]
      )
      else
      (
        new r_685: hash0;
        let sk_s: hash0 = r_685
      )
    )
    orfind  suchthat defined(@i_140[j], r_296[j]) && otheruses(r_296[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
    (
      if (auth_s = r_296[j]) then
      let x1_696: host = U in
      let x2_695: host = S in
      let x3_694: G = cst_G in
      let x4_693: G = cst_G in
      let x5_692: G = cst_G in
      find [unique] @i_802 <= qH0 suchthat defined(x1_69[@i_802], x2_68[@i_802], x3_67[@i_802], x4_66[@i_802], x5_65[@i_802], x5_674[@i_802], x4_675[@i_802], x3_676[@i_802], x2_677[@i_802], x1_678[@i_802], r_673[@i_802]) && otheruses(r_673[@i_802]) && ((x1_696 = x1_69[@i_802]) && ((x2_695 = x2_68[@i_802]) && ((X_s = x3_67[@i_802]) && ((Y = x4_66[@i_802]) && (K_s = x5_65[@i_802]))))) then
      (
        let sk_s: hash0 = r_673[@i_802]
      )
      orfind  suchthat defined(r_739[j]) && otheruses(r_739[j]) then
      (
        let sk_s: hash0 = r_739[j]
      )
      else
      (
        new r_691: hash0;
        let sk_s: hash0 = r_691
      )
    )
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    event Auth
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_90: G;
  let x1_259: host = U in
  let x2_258: host = S in
  new r_254: hash1;
  let x1_684: host = U in
  let x2_683: host = S in
  let x3_682: G = cst_G in
  let x4_681: G = cst_G in
  let x5_680: G = cst_G in
  new r_679: hash0;
  let sk_p: hash0 = r_679 in
  out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@2_r4_84[@i_118], @2_kd[@i_118], @2_m[@i_118]) && otheruses(@2_r4_84[@i_118]) && ((@2_x = @2_r4_84[@i_118]) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_114 <= NU suchthat defined(@2_r4_96[@i_114], Ystar_u[@i_114]) && otheruses(@2_r4_96[@i_114]) && ((@2_x = @2_r4_96[@i_114]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], Ystar_u[@i_114])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = Yp[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@2_m[@i_108], @2_kd[@i_108], @2_r4_84[@i_108]) && otheruses(@2_r4_84[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], @2_r4_84[@i_108])
  )
  orfind @i_104 <= NU suchthat defined(Ystar_u[@i_104], @2_r4_96[@i_104]) && otheruses(@2_r4_96[@i_104]) && ((@2_m = Ystar_u[@i_104]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], @2_r4_96[@i_104])
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@2_r2_90[@i_101], Yp[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Yp[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_r2_93[@i_100], Y[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @2_r4_84: G;
    out(@2_c4[!_57], @2_r4_84)
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  let x1_678: host = cst_host in
  let x2_677: host = cst_host in
  let x3_676: G = cst_G in
  let x4_675: G = cst_G in
  let x5_674: G = cst_G in
  find [unique] @i_763 <= qH0 suchthat defined(x1_69[@i_763], x2_68[@i_763], x3_67[@i_763], x4_66[@i_763], x5_65[@i_763], x5_674[@i_763], x4_675[@i_763], x3_676[@i_763], x2_677[@i_763], x1_678[@i_763], r_673[@i_763]) && otheruses(r_673[@i_763]) && ((x1_69 = x1_69[@i_763]) && ((x2_68 = x2_68[@i_763]) && ((x3_67 = x3_67[@i_763]) && ((x4_66 = x4_66[@i_763]) && (x5_65 = x5_65[@i_763]))))) then
  (
    out(c20[!_58], r_673[@i_763])
  )
  orfind @i_762 <= NP suchthat defined(Xp[@i_762], Yp[@i_762], Kp[@i_762], x5_680[@i_762], x4_681[@i_762], x3_682[@i_762], x1_684[@i_762], x2_683[@i_762], r_679[@i_762]) && otheruses(r_679[@i_762]) && ((x1_69 = x1_684[@i_762]) && ((x2_68 = x2_683[@i_762]) && ((x3_67 = Xp[@i_762]) && ((x4_66 = Yp[@i_762]) && (x5_65 = Kp[@i_762]))))) then
  (
    out(c20[!_58], r_679[@i_762])
  )
  orfind @i_761 <= NS suchthat defined(X_s[@i_761], Y[@i_761], K_s[@i_761], x5_686[@i_761], x4_687[@i_761], x3_688[@i_761], x1_690[@i_761], x2_689[@i_761], r_685[@i_761]) && otheruses(r_685[@i_761]) && ((x1_69 = x1_690[@i_761]) && ((x2_68 = x2_689[@i_761]) && ((x3_67 = X_s[@i_761]) && ((x4_66 = Y[@i_761]) && (x5_65 = K_s[@i_761]))))) then
  (
    out(c20[!_58], r_685[@i_761])
  )
  orfind @i_760 <= NS suchthat defined(X_s[@i_760], Y[@i_760], K_s[@i_760], x5_692[@i_760], x4_693[@i_760], x3_694[@i_760], x1_696[@i_760], x2_695[@i_760], r_691[@i_760]) && otheruses(r_691[@i_760]) && ((x1_69 = x1_696[@i_760]) && ((x2_68 = x2_695[@i_760]) && ((x3_67 = X_s[@i_760]) && ((x4_66 = Y[@i_760]) && (x5_65 = K_s[@i_760]))))) then
  (
    out(c20[!_58], r_691[@i_760])
  )
  orfind @i_759 <= NU suchthat defined(X[@i_759], @2_r4_96[@i_759], K_u[@i_759], x5_698[@i_759], x4_699[@i_759], x3_700[@i_759], x1_702[@i_759], x2_701[@i_759], r_697[@i_759]) && otheruses(r_697[@i_759]) && ((x1_69 = x1_702[@i_759]) && ((x2_68 = x2_701[@i_759]) && ((x3_67 = X[@i_759]) && ((x4_66 = @2_r4_96[@i_759]) && (x5_65 = K_u[@i_759]))))) then
  (
    out(c20[!_58], r_697[@i_759])
  )
  orfind @i_758 <= NU suchthat defined(X[@i_758], @2_r4_84[@i_148[@i_758]], K_u[@i_758], x5_704[@i_758], x4_705[@i_758], x3_706[@i_758], x1_708[@i_758], x2_707[@i_758], r_703[@i_758]) && otheruses(r_703[@i_758]) && ((x1_69 = x1_708[@i_758]) && ((x2_68 = x2_707[@i_758]) && ((x3_67 = X[@i_758]) && ((x4_66 = @2_r4_84[@i_148[@i_758]]) && (x5_65 = K_u[@i_758]))))) then
  (
    out(c20[!_58], r_703[@i_758])
  )
  orfind @i_757 <= NU suchthat defined(X[@i_757], @2_r4_84[@i_148[@i_757]], K_u[@i_757], x5_710[@i_757], x4_711[@i_757], x3_712[@i_757], x1_714[@i_757], x2_713[@i_757], r_709[@i_757]) && otheruses(r_709[@i_757]) && ((x1_69 = x1_714[@i_757]) && ((x2_68 = x2_713[@i_757]) && ((x3_67 = X[@i_757]) && ((x4_66 = @2_r4_84[@i_148[@i_757]]) && (x5_65 = K_u[@i_757]))))) then
  (
    out(c20[!_58], r_709[@i_757])
  )
  orfind @i_756 <= NU suchthat defined(X[@i_756], @2_r4_96[@i_144[@i_756]], K_u[@i_756], x5_716[@i_756], x4_717[@i_756], x3_718[@i_756], x1_720[@i_756], x2_719[@i_756], r_715[@i_756]) && otheruses(r_715[@i_756]) && ((x1_69 = x1_720[@i_756]) && ((x2_68 = x2_719[@i_756]) && ((x3_67 = X[@i_756]) && ((x4_66 = @2_r4_96[@i_144[@i_756]]) && (x5_65 = K_u[@i_756]))))) then
  (
    out(c20[!_58], r_715[@i_756])
  )
  orfind @i_755 <= NU suchthat defined(X[@i_755], @2_r4_96[@i_144[@i_755]], K_u[@i_755], x5_722[@i_755], x4_723[@i_755], x3_724[@i_755], x1_726[@i_755], x2_725[@i_755], r_721[@i_755]) && otheruses(r_721[@i_755]) && ((x1_69 = x1_726[@i_755]) && ((x2_68 = x2_725[@i_755]) && ((x3_67 = X[@i_755]) && ((x4_66 = @2_r4_96[@i_144[@i_755]]) && (x5_65 = K_u[@i_755]))))) then
  (
    out(c20[!_58], r_721[@i_755])
  )
  orfind @i_754 <= NU suchthat defined(X[@i_754], Yp[@i_141[@i_754]], K_u[@i_754], x5_728[@i_754], x4_729[@i_754], x3_730[@i_754], x1_732[@i_754], x2_731[@i_754], r_727[@i_754]) && otheruses(r_727[@i_754]) && ((x1_69 = x1_732[@i_754]) && ((x2_68 = x2_731[@i_754]) && ((x3_67 = X[@i_754]) && ((x4_66 = Yp[@i_141[@i_754]]) && (x5_65 = K_u[@i_754]))))) then
  (
    out(c20[!_58], r_727[@i_754])
  )
  orfind @i_753 <= NU suchthat defined(X[@i_753], Yp[@i_141[@i_753]], K_u[@i_753], x5_734[@i_753], x4_735[@i_753], x3_736[@i_753], x1_738[@i_753], x2_737[@i_753], r_733[@i_753]) && otheruses(r_733[@i_753]) && ((x1_69 = x1_738[@i_753]) && ((x2_68 = x2_737[@i_753]) && ((x3_67 = X[@i_753]) && ((x4_66 = Yp[@i_141[@i_753]]) && (x5_65 = K_u[@i_753]))))) then
  (
    out(c20[!_58], r_733[@i_753])
  )
  orfind @i_752 <= NU suchthat defined(X[@i_752], Y[@i_140[@i_752]], K_u[@i_752], x5_740[@i_752], x4_741[@i_752], x3_742[@i_752], x1_744[@i_752], x2_743[@i_752], r_739[@i_752]) && otheruses(r_739[@i_752]) && ((x1_69 = x1_744[@i_752]) && ((x2_68 = x2_743[@i_752]) && ((x3_67 = X[@i_752]) && ((x4_66 = Y[@i_140[@i_752]]) && (x5_65 = K_u[@i_752]))))) then
  (
    out(c20[!_58], r_739[@i_752])
  )
  orfind @i_751 <= NU suchthat defined(X[@i_751], Y[@i_140[@i_751]], K_u[@i_751], x5_746[@i_751], x4_747[@i_751], x3_748[@i_751], x1_750[@i_751], x2_749[@i_751], r_745[@i_751]) && otheruses(r_745[@i_751]) && ((x1_69 = x1_750[@i_751]) && ((x2_68 = x2_749[@i_751]) && ((x3_67 = X[@i_751]) && ((x4_66 = Y[@i_140[@i_751]]) && (x5_65 = K_u[@i_751]))))) then
  (
    out(c20[!_58], r_745[@i_751])
  )
  else
  (
    new r_673: hash0;
    out(c20[!_58], r_673)
  )
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  orfind @i_309 <= NP suchthat defined(x1_259[@i_309], x2_258[@i_309], Xp[@i_309], Yp[@i_309], Kp[@i_309], r_254[@i_309]) && otheruses(r_254[@i_309]) && ((x1_64 = x1_259[@i_309]) && ((x2_63 = x2_258[@i_309]) && ((x3_62 = Xp[@i_309]) && ((x4_61 = Yp[@i_309]) && (x5_60 = Kp[@i_309]))))) then
  (
    out(c21[!_59], r_254[@i_309])
  )
  orfind @i_306 <= NU suchthat defined(x1_277[@i_306], x2_276[@i_306], X[@i_306], @2_r4_96[@i_306], K_u[@i_306], r_272[@i_306]) && otheruses(r_272[@i_306]) && ((x1_64 = x1_277[@i_306]) && ((x2_63 = x2_276[@i_306]) && ((x3_62 = X[@i_306]) && ((x4_61 = @2_r4_96[@i_306]) && (x5_60 = K_u[@i_306]))))) then
  (
    out(c21[!_59], r_272[@i_306])
  )
  orfind @i_305 <= NU suchthat defined(x1_283[@i_305], x2_282[@i_305], X[@i_305], @2_r4_84[@i_148[@i_305]], K_u[@i_305], r_278[@i_305]) && otheruses(r_278[@i_305]) && ((x1_64 = x1_283[@i_305]) && ((x2_63 = x2_282[@i_305]) && ((x3_62 = X[@i_305]) && ((x4_61 = @2_r4_84[@i_148[@i_305]]) && (x5_60 = K_u[@i_305]))))) then
  (
    out(c21[!_59], r_278[@i_305])
  )
  orfind @i_304 <= NU suchthat defined(x1_289[@i_304], x2_288[@i_304], X[@i_304], @2_r4_96[@i_144[@i_304]], K_u[@i_304], r_284[@i_304]) && otheruses(r_284[@i_304]) && ((x1_64 = x1_289[@i_304]) && ((x2_63 = x2_288[@i_304]) && ((x3_62 = X[@i_304]) && ((x4_61 = @2_r4_96[@i_144[@i_304]]) && (x5_60 = K_u[@i_304]))))) then
  (
    out(c21[!_59], r_284[@i_304])
  )
  orfind @i_303 <= NU suchthat defined(x1_295[@i_303], x2_294[@i_303], X[@i_303], Yp[@i_141[@i_303]], K_u[@i_303], r_290[@i_303]) && otheruses(r_290[@i_303]) && ((x1_64 = x1_295[@i_303]) && ((x2_63 = x2_294[@i_303]) && ((x3_62 = X[@i_303]) && ((x4_61 = Yp[@i_141[@i_303]]) && (x5_60 = K_u[@i_303]))))) then
  (
    out(c21[!_59], r_290[@i_303])
  )
  orfind @i_302 <= NU suchthat defined(x1_301[@i_302], x2_300[@i_302], X[@i_302], Y[@i_140[@i_302]], K_u[@i_302], r_296[@i_302]) && otheruses(r_296[@i_302]) && ((x1_64 = x1_301[@i_302]) && ((x2_63 = x2_300[@i_302]) && ((x3_62 = X[@i_302]) && ((x4_61 = Y[@i_140[@i_302]]) && (x5_60 = K_u[@i_302]))))) then
  (
    out(c21[!_59], r_296[@i_302])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying equivalence
equiv ! !_1 <= @1_N new @1_X: G; (
  () -> @1_X,
  ! !_2 <= @1_N' (@1_m: exponent) -> exp(@1_X, @1_m))
<=(0)=>
      ! !_3 <= @1_N new @1_x: exponent; (
  () -> exp(g, @1_x),
  ! !_4 <= @1_N' (@1_m: exponent) -> exp(g, mult(@1_x, @1_m)))
 yields

Game 17 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_148 <= qD suchthat defined(@1_x_1092[@i_148], @2_m[@i_148], @2_kd[@i_148], @2_r4_84[@i_148]) && otheruses(@1_x_1092[@i_148]) && ((Ystar_u = @2_m[@i_148]) && (pw = @2_kd[@i_148])) then
  (
    let K_u: G = exp(g, mult(@1_x_1092[@i_148], x)) in
    let x1_283: host = U in
    let x2_282: host = S in
    find [unique] @i_355 <= qH1 suchthat defined(x1_64[@i_355], x2_63[@i_355], x3_62[@i_355], x4_61[@i_355], x5_60[@i_355], r_248[@i_355]) && otheruses(r_248[@i_355]) && ((x1_283 = x1_64[@i_355]) && ((x2_282 = x2_63[@i_355]) && ((X = x3_62[@i_355]) && ((exp(g, @1_x_1092[@i_148]) = x4_61[@i_355]) && (K_u = x5_60[@i_355]))))) then
    (
      out(c6[!_53], r_248[@i_355]);
      in(c9[!_53], ());
      let x1_714: host = U in
      let x2_713: host = S in
      let x3_712: G = cst_G in
      let x4_711: G = cst_G in
      let x5_710: G = cst_G in
      find [unique] @i_841 <= qH0 suchthat defined(x1_69[@i_841], x2_68[@i_841], x3_67[@i_841], x4_66[@i_841], x5_65[@i_841], x5_674[@i_841], x4_675[@i_841], x3_676[@i_841], x2_677[@i_841], x1_678[@i_841], r_673[@i_841]) && otheruses(r_673[@i_841]) && ((x1_714 = x1_69[@i_841]) && ((x2_713 = x2_68[@i_841]) && ((X = x3_67[@i_841]) && ((exp(g, @1_x_1092[@i_148]) = x4_66[@i_841]) && (K_u = x5_65[@i_841]))))) then
      (
        let sk_u: hash0 = r_673[@i_841]
      )
      else
      (
        new r_709: hash0;
        let sk_u: hash0 = r_709
      )
    )
    else
    (
      new r_278: hash1;
      out(c6[!_53], r_278);
      in(c9[!_53], ());
      let x1_708: host = U in
      let x2_707: host = S in
      let x3_706: G = cst_G in
      let x4_705: G = cst_G in
      let x5_704: G = cst_G in
      find [unique] @i_828 <= qH0 suchthat defined(x1_69[@i_828], x2_68[@i_828], x3_67[@i_828], x4_66[@i_828], x5_65[@i_828], x5_674[@i_828], x4_675[@i_828], x3_676[@i_828], x2_677[@i_828], x1_678[@i_828], r_673[@i_828]) && otheruses(r_673[@i_828]) && ((x1_708 = x1_69[@i_828]) && ((x2_707 = x2_68[@i_828]) && ((X = x3_67[@i_828]) && ((exp(g, @1_x_1092[@i_148]) = x4_66[@i_828]) && (K_u = x5_65[@i_828]))))) then
      (
        let sk_u: hash0 = r_673[@i_828]
      )
      else
      (
        new r_703: hash0;
        let sk_u: hash0 = r_703
      )
    )
  )
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], @2_r4_96[@i_144]) && otheruses(@2_r4_96[@i_144]) && (Ystar_u = Ystar_u[@i_144]) then
  (
    let K_u: G = exp(@2_r4_96[@i_144], x) in
    let x1_289: host = U in
    let x2_288: host = S in
    find [unique] @i_364 <= qH1 suchthat defined(x1_64[@i_364], x2_63[@i_364], x3_62[@i_364], x4_61[@i_364], x5_60[@i_364], r_248[@i_364]) && otheruses(r_248[@i_364]) && ((x1_289 = x1_64[@i_364]) && ((x2_288 = x2_63[@i_364]) && ((X = x3_62[@i_364]) && ((@2_r4_96[@i_144] = x4_61[@i_364]) && (K_u = x5_60[@i_364]))))) then
    (
      out(c6[!_53], r_248[@i_364]);
      in(c9[!_53], ());
      let x1_726: host = U in
      let x2_725: host = S in
      let x3_724: G = cst_G in
      let x4_723: G = cst_G in
      let x5_722: G = cst_G in
      find [unique] @i_867 <= qH0 suchthat defined(x1_69[@i_867], x2_68[@i_867], x3_67[@i_867], x4_66[@i_867], x5_65[@i_867], x5_674[@i_867], x4_675[@i_867], x3_676[@i_867], x2_677[@i_867], x1_678[@i_867], r_673[@i_867]) && otheruses(r_673[@i_867]) && ((x1_726 = x1_69[@i_867]) && ((x2_725 = x2_68[@i_867]) && ((X = x3_67[@i_867]) && ((@2_r4_96[@i_144] = x4_66[@i_867]) && (K_u = x5_65[@i_867]))))) then
      (
        let sk_u: hash0 = r_673[@i_867]
      )
      else
      (
        new r_721: hash0;
        let sk_u: hash0 = r_721
      )
    )
    else
    (
      new r_284: hash1;
      out(c6[!_53], r_284);
      in(c9[!_53], ());
      let x1_720: host = U in
      let x2_719: host = S in
      let x3_718: G = cst_G in
      let x4_717: G = cst_G in
      let x5_716: G = cst_G in
      find [unique] @i_854 <= qH0 suchthat defined(x1_69[@i_854], x2_68[@i_854], x3_67[@i_854], x4_66[@i_854], x5_65[@i_854], x5_674[@i_854], x4_675[@i_854], x3_676[@i_854], x2_677[@i_854], x1_678[@i_854], r_673[@i_854]) && otheruses(r_673[@i_854]) && ((x1_720 = x1_69[@i_854]) && ((x2_719 = x2_68[@i_854]) && ((X = x3_67[@i_854]) && ((@2_r4_96[@i_144] = x4_66[@i_854]) && (K_u = x5_65[@i_854]))))) then
      (
        let sk_u: hash0 = r_673[@i_854]
      )
      else
      (
        new r_715: hash0;
        let sk_u: hash0 = r_715
      )
    )
  )
  orfind @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  orfind @i_141 <= NP suchthat defined(@2_r2_90[@i_141], yp[@i_141], Yp[@i_141]) && otheruses(@2_r2_90[@i_141]) && (Ystar_u = @2_r2_90[@i_141]) then
  (
    let K_u: G = exp(g, mult(yp[@i_141], x)) in
    let x1_295: host = U in
    let x2_294: host = S in
    find [unique] @i_373 <= qH1 suchthat defined(x1_64[@i_373], x2_63[@i_373], x3_62[@i_373], x4_61[@i_373], x5_60[@i_373], r_248[@i_373]) && otheruses(r_248[@i_373]) && ((x1_295 = x1_64[@i_373]) && ((x2_294 = x2_63[@i_373]) && ((X = x3_62[@i_373]) && ((Yp[@i_141] = x4_61[@i_373]) && (K_u = x5_60[@i_373]))))) then
    (
      out(c6[!_53], r_248[@i_373]);
      in(c9[!_53], ());
      let x1_738: host = U in
      let x2_737: host = S in
      let x3_736: G = cst_G in
      let x4_735: G = cst_G in
      let x5_734: G = cst_G in
      find [unique] @i_893 <= qH0 suchthat defined(x1_69[@i_893], x2_68[@i_893], x3_67[@i_893], x4_66[@i_893], x5_65[@i_893], x5_674[@i_893], x4_675[@i_893], x3_676[@i_893], x2_677[@i_893], x1_678[@i_893], r_673[@i_893]) && otheruses(r_673[@i_893]) && ((x1_738 = x1_69[@i_893]) && ((x2_737 = x2_68[@i_893]) && ((X = x3_67[@i_893]) && ((Yp[@i_141] = x4_66[@i_893]) && (K_u = x5_65[@i_893]))))) then
      (
        let sk_u: hash0 = r_673[@i_893]
      )
      else
      (
        new r_733: hash0;
        let sk_u: hash0 = r_733
      )
    )
    else
    (
      new r_290: hash1;
      out(c6[!_53], r_290);
      in(c9[!_53], ());
      let x1_732: host = U in
      let x2_731: host = S in
      let x3_730: G = cst_G in
      let x4_729: G = cst_G in
      let x5_728: G = cst_G in
      find [unique] @i_880 <= qH0 suchthat defined(x1_69[@i_880], x2_68[@i_880], x3_67[@i_880], x4_66[@i_880], x5_65[@i_880], x5_674[@i_880], x4_675[@i_880], x3_676[@i_880], x2_677[@i_880], x1_678[@i_880], r_673[@i_880]) && otheruses(r_673[@i_880]) && ((x1_732 = x1_69[@i_880]) && ((x2_731 = x2_68[@i_880]) && ((X = x3_67[@i_880]) && ((Yp[@i_141] = x4_66[@i_880]) && (K_u = x5_65[@i_880]))))) then
      (
        let sk_u: hash0 = r_673[@i_880]
      )
      else
      (
        new r_727: hash0;
        let sk_u: hash0 = r_727
      )
    )
  )
  orfind @i_140 <= NS suchthat defined(@2_r2_93[@i_140], y[@i_140], Y[@i_140]) && otheruses(@2_r2_93[@i_140]) && (Ystar_u = @2_r2_93[@i_140]) then
  (
    let K_u: G = exp(g, mult(y[@i_140], x)) in
    let x1_301: host = U in
    let x2_300: host = S in
    find [unique] @i_382 <= qH1 suchthat defined(x1_64[@i_382], x2_63[@i_382], x3_62[@i_382], x4_61[@i_382], x5_60[@i_382], r_248[@i_382]) && otheruses(r_248[@i_382]) && ((x1_301 = x1_64[@i_382]) && ((x2_300 = x2_63[@i_382]) && ((X = x3_62[@i_382]) && ((Y[@i_140] = x4_61[@i_382]) && (K_u = x5_60[@i_382]))))) then
    (
      out(c6[!_53], r_248[@i_382]);
      in(c9[!_53], ());
      let x1_750: host = U in
      let x2_749: host = S in
      let x3_748: G = cst_G in
      let x4_747: G = cst_G in
      let x5_746: G = cst_G in
      find [unique] @i_919 <= qH0 suchthat defined(x1_69[@i_919], x2_68[@i_919], x3_67[@i_919], x4_66[@i_919], x5_65[@i_919], x5_674[@i_919], x4_675[@i_919], x3_676[@i_919], x2_677[@i_919], x1_678[@i_919], r_673[@i_919]) && otheruses(r_673[@i_919]) && ((x1_750 = x1_69[@i_919]) && ((x2_749 = x2_68[@i_919]) && ((X = x3_67[@i_919]) && ((Y[@i_140] = x4_66[@i_919]) && (K_u = x5_65[@i_919]))))) then
      (
        let sk_u: hash0 = r_673[@i_919]
      )
      orfind  suchthat defined(j[@i_140], r_685[@i_140]) && otheruses(r_685[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_685[@i_140]
      )
      else
      (
        new r_745: hash0;
        let sk_u: hash0 = r_745
      )
    )
    else
    (
      new r_296: hash1;
      out(c6[!_53], r_296);
      in(c9[!_53], ());
      let x1_744: host = U in
      let x2_743: host = S in
      let x3_742: G = cst_G in
      let x4_741: G = cst_G in
      let x5_740: G = cst_G in
      find [unique] @i_906 <= qH0 suchthat defined(x1_69[@i_906], x2_68[@i_906], x3_67[@i_906], x4_66[@i_906], x5_65[@i_906], x5_674[@i_906], x4_675[@i_906], x3_676[@i_906], x2_677[@i_906], x1_678[@i_906], r_673[@i_906]) && otheruses(r_673[@i_906]) && ((x1_744 = x1_69[@i_906]) && ((x2_743 = x2_68[@i_906]) && ((X = x3_67[@i_906]) && ((Y[@i_140] = x4_66[@i_906]) && (K_u = x5_65[@i_906]))))) then
      (
        let sk_u: hash0 = r_673[@i_906]
      )
      orfind  suchthat defined(j[@i_140], r_685[@i_140]) && otheruses(r_685[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_685[@i_140]
      )
      orfind  suchthat defined(j[@i_140], r_691[@i_140]) && otheruses(r_691[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_691[@i_140]
      )
      else
      (
        new r_739: hash0;
        let sk_u: hash0 = r_739
      )
    )
  )
  else
  (
    new @2_r4_96: G;
    let K_u: G = exp(@2_r4_96, x) in
    let x1_277: host = U in
    let x2_276: host = S in
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ());
    let x1_702: host = U in
    let x2_701: host = S in
    let x3_700: G = cst_G in
    let x4_699: G = cst_G in
    let x5_698: G = cst_G in
    find [unique] @i_815 <= qH0 suchthat defined(x1_69[@i_815], x2_68[@i_815], x3_67[@i_815], x4_66[@i_815], x5_65[@i_815], x5_674[@i_815], x4_675[@i_815], x3_676[@i_815], x2_677[@i_815], x1_678[@i_815], r_673[@i_815]) && otheruses(r_673[@i_815]) && ((x1_702 = x1_69[@i_815]) && ((x2_701 = x2_68[@i_815]) && ((X = x3_67[@i_815]) && ((@2_r4_96 = x4_66[@i_815]) && (K_u = x5_65[@i_815]))))) then
    (
      let sk_u: hash0 = r_673[@i_815]
    )
    else
    (
      new r_697: hash0;
      let sk_u: hash0 = r_697
    )
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_271: host = U in
    let x2_270: host = S in
    find [unique] @i_337 <= qH1 suchthat defined(x1_64[@i_337], x2_63[@i_337], x3_62[@i_337], x4_61[@i_337], x5_60[@i_337], r_248[@i_337]) && otheruses(r_248[@i_337]) && ((x1_271 = x1_64[@i_337]) && ((x2_270 = x2_63[@i_337]) && ((X_s = x3_62[@i_337]) && ((Y = x4_61[@i_337]) && (K_s = x5_60[@i_337]))))) then
    (
      if (auth_s = r_248[@i_337]) then
      let x1_690: host = U in
      let x2_689: host = S in
      let x3_688: G = cst_G in
      let x4_687: G = cst_G in
      let x5_686: G = cst_G in
      find [unique] @i_789 <= qH0 suchthat defined(x1_69[@i_789], x2_68[@i_789], x3_67[@i_789], x4_66[@i_789], x5_65[@i_789], x5_674[@i_789], x4_675[@i_789], x3_676[@i_789], x2_677[@i_789], x1_678[@i_789], r_673[@i_789]) && otheruses(r_673[@i_789]) && ((x1_690 = x1_69[@i_789]) && ((x2_689 = x2_68[@i_789]) && ((X_s = x3_67[@i_789]) && ((Y = x4_66[@i_789]) && (K_s = x5_65[@i_789]))))) then
      (
        let sk_s: hash0 = r_673[@i_789]
      )
      orfind  suchthat defined(@i_140[j], r_739[j]) && otheruses(r_739[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
      (
        let sk_s: hash0 = r_739[j]
      )
      orfind  suchthat defined(@i_140[j], r_745[j]) && otheruses(r_745[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
      (
        let sk_s: hash0 = r_745[j]
      )
      else
      (
        new r_685: hash0;
        let sk_s: hash0 = r_685
      )
    )
    orfind  suchthat defined(@i_140[j], r_296[j]) && otheruses(r_296[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
    (
      if (auth_s = r_296[j]) then
      let x1_696: host = U in
      let x2_695: host = S in
      let x3_694: G = cst_G in
      let x4_693: G = cst_G in
      let x5_692: G = cst_G in
      find [unique] @i_802 <= qH0 suchthat defined(x1_69[@i_802], x2_68[@i_802], x3_67[@i_802], x4_66[@i_802], x5_65[@i_802], x5_674[@i_802], x4_675[@i_802], x3_676[@i_802], x2_677[@i_802], x1_678[@i_802], r_673[@i_802]) && otheruses(r_673[@i_802]) && ((x1_696 = x1_69[@i_802]) && ((x2_695 = x2_68[@i_802]) && ((X_s = x3_67[@i_802]) && ((Y = x4_66[@i_802]) && (K_s = x5_65[@i_802]))))) then
      (
        let sk_s: hash0 = r_673[@i_802]
      )
      orfind  suchthat defined(r_739[j]) && otheruses(r_739[j]) then
      (
        let sk_s: hash0 = r_739[j]
      )
      else
      (
        new r_691: hash0;
        let sk_s: hash0 = r_691
      )
    )
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    event Auth
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_90: G;
  let x1_259: host = U in
  let x2_258: host = S in
  new r_254: hash1;
  let x1_684: host = U in
  let x2_683: host = S in
  let x3_682: G = cst_G in
  let x4_681: G = cst_G in
  let x5_680: G = cst_G in
  new r_679: hash0;
  let sk_p: hash0 = r_679 in
  out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@1_x_1092[@i_118], @2_r4_84[@i_118], @2_kd[@i_118], @2_m[@i_118]) && otheruses(@1_x_1092[@i_118]) && ((@2_x = exp(g, @1_x_1092[@i_118])) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_114 <= NU suchthat defined(@2_r4_96[@i_114], Ystar_u[@i_114]) && otheruses(@2_r4_96[@i_114]) && ((@2_x = @2_r4_96[@i_114]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], Ystar_u[@i_114])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = Yp[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@1_x_1092[@i_108], @2_m[@i_108], @2_kd[@i_108], @2_r4_84[@i_108]) && otheruses(@1_x_1092[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], exp(g, @1_x_1092[@i_108]))
  )
  orfind @i_104 <= NU suchthat defined(Ystar_u[@i_104], @2_r4_96[@i_104]) && otheruses(@2_r4_96[@i_104]) && ((@2_m = Ystar_u[@i_104]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], @2_r4_96[@i_104])
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@2_r2_90[@i_101], Yp[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Yp[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_r2_93[@i_100], Y[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @1_x_1092: exponent;
    let @2_r4_84: G = cst_G in
    out(@2_c4[!_57], exp(g, @1_x_1092))
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  let x1_678: host = cst_host in
  let x2_677: host = cst_host in
  let x3_676: G = cst_G in
  let x4_675: G = cst_G in
  let x5_674: G = cst_G in
  find [unique] @i_763 <= qH0 suchthat defined(x1_69[@i_763], x2_68[@i_763], x3_67[@i_763], x4_66[@i_763], x5_65[@i_763], x5_674[@i_763], x4_675[@i_763], x3_676[@i_763], x2_677[@i_763], x1_678[@i_763], r_673[@i_763]) && otheruses(r_673[@i_763]) && ((x1_69 = x1_69[@i_763]) && ((x2_68 = x2_68[@i_763]) && ((x3_67 = x3_67[@i_763]) && ((x4_66 = x4_66[@i_763]) && (x5_65 = x5_65[@i_763]))))) then
  (
    out(c20[!_58], r_673[@i_763])
  )
  orfind @i_762 <= NP suchthat defined(Xp[@i_762], Yp[@i_762], Kp[@i_762], x5_680[@i_762], x4_681[@i_762], x3_682[@i_762], x1_684[@i_762], x2_683[@i_762], r_679[@i_762]) && otheruses(r_679[@i_762]) && ((x1_69 = x1_684[@i_762]) && ((x2_68 = x2_683[@i_762]) && ((x3_67 = Xp[@i_762]) && ((x4_66 = Yp[@i_762]) && (x5_65 = Kp[@i_762]))))) then
  (
    out(c20[!_58], r_679[@i_762])
  )
  orfind @i_761 <= NS suchthat defined(X_s[@i_761], Y[@i_761], K_s[@i_761], x5_686[@i_761], x4_687[@i_761], x3_688[@i_761], x1_690[@i_761], x2_689[@i_761], r_685[@i_761]) && otheruses(r_685[@i_761]) && ((x1_69 = x1_690[@i_761]) && ((x2_68 = x2_689[@i_761]) && ((x3_67 = X_s[@i_761]) && ((x4_66 = Y[@i_761]) && (x5_65 = K_s[@i_761]))))) then
  (
    out(c20[!_58], r_685[@i_761])
  )
  orfind @i_760 <= NS suchthat defined(X_s[@i_760], Y[@i_760], K_s[@i_760], x5_692[@i_760], x4_693[@i_760], x3_694[@i_760], x1_696[@i_760], x2_695[@i_760], r_691[@i_760]) && otheruses(r_691[@i_760]) && ((x1_69 = x1_696[@i_760]) && ((x2_68 = x2_695[@i_760]) && ((x3_67 = X_s[@i_760]) && ((x4_66 = Y[@i_760]) && (x5_65 = K_s[@i_760]))))) then
  (
    out(c20[!_58], r_691[@i_760])
  )
  orfind @i_759 <= NU suchthat defined(X[@i_759], @2_r4_96[@i_759], K_u[@i_759], x5_698[@i_759], x4_699[@i_759], x3_700[@i_759], x1_702[@i_759], x2_701[@i_759], r_697[@i_759]) && otheruses(r_697[@i_759]) && ((x1_69 = x1_702[@i_759]) && ((x2_68 = x2_701[@i_759]) && ((x3_67 = X[@i_759]) && ((x4_66 = @2_r4_96[@i_759]) && (x5_65 = K_u[@i_759]))))) then
  (
    out(c20[!_58], r_697[@i_759])
  )
  orfind @i_758 <= NU suchthat defined(@1_x_1092[@i_148[@i_758]], X[@i_758], @2_r4_84[@i_148[@i_758]], K_u[@i_758], x5_704[@i_758], x4_705[@i_758], x3_706[@i_758], x1_708[@i_758], x2_707[@i_758], r_703[@i_758]) && otheruses(r_703[@i_758]) && ((x1_69 = x1_708[@i_758]) && ((x2_68 = x2_707[@i_758]) && ((x3_67 = X[@i_758]) && ((x4_66 = exp(g, @1_x_1092[@i_148[@i_758]])) && (x5_65 = K_u[@i_758]))))) then
  (
    out(c20[!_58], r_703[@i_758])
  )
  orfind @i_757 <= NU suchthat defined(@1_x_1092[@i_148[@i_757]], X[@i_757], @2_r4_84[@i_148[@i_757]], K_u[@i_757], x5_710[@i_757], x4_711[@i_757], x3_712[@i_757], x1_714[@i_757], x2_713[@i_757], r_709[@i_757]) && otheruses(r_709[@i_757]) && ((x1_69 = x1_714[@i_757]) && ((x2_68 = x2_713[@i_757]) && ((x3_67 = X[@i_757]) && ((x4_66 = exp(g, @1_x_1092[@i_148[@i_757]])) && (x5_65 = K_u[@i_757]))))) then
  (
    out(c20[!_58], r_709[@i_757])
  )
  orfind @i_756 <= NU suchthat defined(X[@i_756], @2_r4_96[@i_144[@i_756]], K_u[@i_756], x5_716[@i_756], x4_717[@i_756], x3_718[@i_756], x1_720[@i_756], x2_719[@i_756], r_715[@i_756]) && otheruses(r_715[@i_756]) && ((x1_69 = x1_720[@i_756]) && ((x2_68 = x2_719[@i_756]) && ((x3_67 = X[@i_756]) && ((x4_66 = @2_r4_96[@i_144[@i_756]]) && (x5_65 = K_u[@i_756]))))) then
  (
    out(c20[!_58], r_715[@i_756])
  )
  orfind @i_755 <= NU suchthat defined(X[@i_755], @2_r4_96[@i_144[@i_755]], K_u[@i_755], x5_722[@i_755], x4_723[@i_755], x3_724[@i_755], x1_726[@i_755], x2_725[@i_755], r_721[@i_755]) && otheruses(r_721[@i_755]) && ((x1_69 = x1_726[@i_755]) && ((x2_68 = x2_725[@i_755]) && ((x3_67 = X[@i_755]) && ((x4_66 = @2_r4_96[@i_144[@i_755]]) && (x5_65 = K_u[@i_755]))))) then
  (
    out(c20[!_58], r_721[@i_755])
  )
  orfind @i_754 <= NU suchthat defined(X[@i_754], Yp[@i_141[@i_754]], K_u[@i_754], x5_728[@i_754], x4_729[@i_754], x3_730[@i_754], x1_732[@i_754], x2_731[@i_754], r_727[@i_754]) && otheruses(r_727[@i_754]) && ((x1_69 = x1_732[@i_754]) && ((x2_68 = x2_731[@i_754]) && ((x3_67 = X[@i_754]) && ((x4_66 = Yp[@i_141[@i_754]]) && (x5_65 = K_u[@i_754]))))) then
  (
    out(c20[!_58], r_727[@i_754])
  )
  orfind @i_753 <= NU suchthat defined(X[@i_753], Yp[@i_141[@i_753]], K_u[@i_753], x5_734[@i_753], x4_735[@i_753], x3_736[@i_753], x1_738[@i_753], x2_737[@i_753], r_733[@i_753]) && otheruses(r_733[@i_753]) && ((x1_69 = x1_738[@i_753]) && ((x2_68 = x2_737[@i_753]) && ((x3_67 = X[@i_753]) && ((x4_66 = Yp[@i_141[@i_753]]) && (x5_65 = K_u[@i_753]))))) then
  (
    out(c20[!_58], r_733[@i_753])
  )
  orfind @i_752 <= NU suchthat defined(X[@i_752], Y[@i_140[@i_752]], K_u[@i_752], x5_740[@i_752], x4_741[@i_752], x3_742[@i_752], x1_744[@i_752], x2_743[@i_752], r_739[@i_752]) && otheruses(r_739[@i_752]) && ((x1_69 = x1_744[@i_752]) && ((x2_68 = x2_743[@i_752]) && ((x3_67 = X[@i_752]) && ((x4_66 = Y[@i_140[@i_752]]) && (x5_65 = K_u[@i_752]))))) then
  (
    out(c20[!_58], r_739[@i_752])
  )
  orfind @i_751 <= NU suchthat defined(X[@i_751], Y[@i_140[@i_751]], K_u[@i_751], x5_746[@i_751], x4_747[@i_751], x3_748[@i_751], x1_750[@i_751], x2_749[@i_751], r_745[@i_751]) && otheruses(r_745[@i_751]) && ((x1_69 = x1_750[@i_751]) && ((x2_68 = x2_749[@i_751]) && ((x3_67 = X[@i_751]) && ((x4_66 = Y[@i_140[@i_751]]) && (x5_65 = K_u[@i_751]))))) then
  (
    out(c20[!_58], r_745[@i_751])
  )
  else
  (
    new r_673: hash0;
    out(c20[!_58], r_673)
  )
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  orfind @i_309 <= NP suchthat defined(x1_259[@i_309], x2_258[@i_309], Xp[@i_309], Yp[@i_309], Kp[@i_309], r_254[@i_309]) && otheruses(r_254[@i_309]) && ((x1_64 = x1_259[@i_309]) && ((x2_63 = x2_258[@i_309]) && ((x3_62 = Xp[@i_309]) && ((x4_61 = Yp[@i_309]) && (x5_60 = Kp[@i_309]))))) then
  (
    out(c21[!_59], r_254[@i_309])
  )
  orfind @i_306 <= NU suchthat defined(x1_277[@i_306], x2_276[@i_306], X[@i_306], @2_r4_96[@i_306], K_u[@i_306], r_272[@i_306]) && otheruses(r_272[@i_306]) && ((x1_64 = x1_277[@i_306]) && ((x2_63 = x2_276[@i_306]) && ((x3_62 = X[@i_306]) && ((x4_61 = @2_r4_96[@i_306]) && (x5_60 = K_u[@i_306]))))) then
  (
    out(c21[!_59], r_272[@i_306])
  )
  orfind @i_305 <= NU suchthat defined(@1_x_1092[@i_148[@i_305]], x1_283[@i_305], x2_282[@i_305], X[@i_305], @2_r4_84[@i_148[@i_305]], K_u[@i_305], r_278[@i_305]) && otheruses(r_278[@i_305]) && ((x1_64 = x1_283[@i_305]) && ((x2_63 = x2_282[@i_305]) && ((x3_62 = X[@i_305]) && ((x4_61 = exp(g, @1_x_1092[@i_148[@i_305]])) && (x5_60 = K_u[@i_305]))))) then
  (
    out(c21[!_59], r_278[@i_305])
  )
  orfind @i_304 <= NU suchthat defined(x1_289[@i_304], x2_288[@i_304], X[@i_304], @2_r4_96[@i_144[@i_304]], K_u[@i_304], r_284[@i_304]) && otheruses(r_284[@i_304]) && ((x1_64 = x1_289[@i_304]) && ((x2_63 = x2_288[@i_304]) && ((x3_62 = X[@i_304]) && ((x4_61 = @2_r4_96[@i_144[@i_304]]) && (x5_60 = K_u[@i_304]))))) then
  (
    out(c21[!_59], r_284[@i_304])
  )
  orfind @i_303 <= NU suchthat defined(x1_295[@i_303], x2_294[@i_303], X[@i_303], Yp[@i_141[@i_303]], K_u[@i_303], r_290[@i_303]) && otheruses(r_290[@i_303]) && ((x1_64 = x1_295[@i_303]) && ((x2_63 = x2_294[@i_303]) && ((x3_62 = X[@i_303]) && ((x4_61 = Yp[@i_141[@i_303]]) && (x5_60 = K_u[@i_303]))))) then
  (
    out(c21[!_59], r_290[@i_303])
  )
  orfind @i_302 <= NU suchthat defined(x1_301[@i_302], x2_300[@i_302], X[@i_302], Y[@i_140[@i_302]], K_u[@i_302], r_296[@i_302]) && otheruses(r_296[@i_302]) && ((x1_64 = x1_301[@i_302]) && ((x2_63 = x2_300[@i_302]) && ((x3_62 = X[@i_302]) && ((x4_61 = Y[@i_140[@i_302]]) && (x5_60 = K_u[@i_302]))))) then
  (
    out(c21[!_59], r_296[@i_302])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying equivalence
equiv ! !_1 <= @1_N new @1_X: G; (
  () -> @1_X,
  ! !_2 <= @1_N' (@1_m: exponent) -> exp(@1_X, @1_m))
<=(0)=>
      ! !_3 <= @1_N new @1_x: exponent; (
  () -> exp(g, @1_x),
  ! !_4 <= @1_N' (@1_m: exponent) -> exp(g, mult(@1_x, @1_m)))
 yields

Game 18 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_148 <= qD suchthat defined(@1_x_1092[@i_148], @2_m[@i_148], @2_kd[@i_148], @2_r4_84[@i_148]) && otheruses(@1_x_1092[@i_148]) && ((Ystar_u = @2_m[@i_148]) && (pw = @2_kd[@i_148])) then
  (
    let K_u: G = exp(g, mult(@1_x_1092[@i_148], x)) in
    let x1_283: host = U in
    let x2_282: host = S in
    find [unique] @i_355 <= qH1 suchthat defined(x1_64[@i_355], x2_63[@i_355], x3_62[@i_355], x4_61[@i_355], x5_60[@i_355], r_248[@i_355]) && otheruses(r_248[@i_355]) && ((x1_283 = x1_64[@i_355]) && ((x2_282 = x2_63[@i_355]) && ((X = x3_62[@i_355]) && ((exp(g, @1_x_1092[@i_148]) = x4_61[@i_355]) && (K_u = x5_60[@i_355]))))) then
    (
      out(c6[!_53], r_248[@i_355]);
      in(c9[!_53], ());
      let x1_714: host = U in
      let x2_713: host = S in
      let x3_712: G = cst_G in
      let x4_711: G = cst_G in
      let x5_710: G = cst_G in
      find [unique] @i_841 <= qH0 suchthat defined(x1_69[@i_841], x2_68[@i_841], x3_67[@i_841], x4_66[@i_841], x5_65[@i_841], x5_674[@i_841], x4_675[@i_841], x3_676[@i_841], x2_677[@i_841], x1_678[@i_841], r_673[@i_841]) && otheruses(r_673[@i_841]) && ((x1_714 = x1_69[@i_841]) && ((x2_713 = x2_68[@i_841]) && ((X = x3_67[@i_841]) && ((exp(g, @1_x_1092[@i_148]) = x4_66[@i_841]) && (K_u = x5_65[@i_841]))))) then
      (
        let sk_u: hash0 = r_673[@i_841]
      )
      else
      (
        new r_709: hash0;
        let sk_u: hash0 = r_709
      )
    )
    else
    (
      new r_278: hash1;
      out(c6[!_53], r_278);
      in(c9[!_53], ());
      let x1_708: host = U in
      let x2_707: host = S in
      let x3_706: G = cst_G in
      let x4_705: G = cst_G in
      let x5_704: G = cst_G in
      find [unique] @i_828 <= qH0 suchthat defined(x1_69[@i_828], x2_68[@i_828], x3_67[@i_828], x4_66[@i_828], x5_65[@i_828], x5_674[@i_828], x4_675[@i_828], x3_676[@i_828], x2_677[@i_828], x1_678[@i_828], r_673[@i_828]) && otheruses(r_673[@i_828]) && ((x1_708 = x1_69[@i_828]) && ((x2_707 = x2_68[@i_828]) && ((X = x3_67[@i_828]) && ((exp(g, @1_x_1092[@i_148]) = x4_66[@i_828]) && (K_u = x5_65[@i_828]))))) then
      (
        let sk_u: hash0 = r_673[@i_828]
      )
      else
      (
        new r_703: hash0;
        let sk_u: hash0 = r_703
      )
    )
  )
  orfind @i_144 <= NU suchthat defined(@1_x_1271[@i_144], Ystar_u[@i_144], @2_r4_96[@i_144]) && otheruses(@1_x_1271[@i_144]) && (Ystar_u = Ystar_u[@i_144]) then
  (
    let K_u: G = exp(g, mult(@1_x_1271[@i_144], x)) in
    let x1_289: host = U in
    let x2_288: host = S in
    find [unique] @i_364 <= qH1 suchthat defined(x1_64[@i_364], x2_63[@i_364], x3_62[@i_364], x4_61[@i_364], x5_60[@i_364], r_248[@i_364]) && otheruses(r_248[@i_364]) && ((x1_289 = x1_64[@i_364]) && ((x2_288 = x2_63[@i_364]) && ((X = x3_62[@i_364]) && ((exp(g, @1_x_1271[@i_144]) = x4_61[@i_364]) && (K_u = x5_60[@i_364]))))) then
    (
      out(c6[!_53], r_248[@i_364]);
      in(c9[!_53], ());
      let x1_726: host = U in
      let x2_725: host = S in
      let x3_724: G = cst_G in
      let x4_723: G = cst_G in
      let x5_722: G = cst_G in
      find [unique] @i_867 <= qH0 suchthat defined(x1_69[@i_867], x2_68[@i_867], x3_67[@i_867], x4_66[@i_867], x5_65[@i_867], x5_674[@i_867], x4_675[@i_867], x3_676[@i_867], x2_677[@i_867], x1_678[@i_867], r_673[@i_867]) && otheruses(r_673[@i_867]) && ((x1_726 = x1_69[@i_867]) && ((x2_725 = x2_68[@i_867]) && ((X = x3_67[@i_867]) && ((exp(g, @1_x_1271[@i_144]) = x4_66[@i_867]) && (K_u = x5_65[@i_867]))))) then
      (
        let sk_u: hash0 = r_673[@i_867]
      )
      else
      (
        new r_721: hash0;
        let sk_u: hash0 = r_721
      )
    )
    else
    (
      new r_284: hash1;
      out(c6[!_53], r_284);
      in(c9[!_53], ());
      let x1_720: host = U in
      let x2_719: host = S in
      let x3_718: G = cst_G in
      let x4_717: G = cst_G in
      let x5_716: G = cst_G in
      find [unique] @i_854 <= qH0 suchthat defined(x1_69[@i_854], x2_68[@i_854], x3_67[@i_854], x4_66[@i_854], x5_65[@i_854], x5_674[@i_854], x4_675[@i_854], x3_676[@i_854], x2_677[@i_854], x1_678[@i_854], r_673[@i_854]) && otheruses(r_673[@i_854]) && ((x1_720 = x1_69[@i_854]) && ((x2_719 = x2_68[@i_854]) && ((X = x3_67[@i_854]) && ((exp(g, @1_x_1271[@i_144]) = x4_66[@i_854]) && (K_u = x5_65[@i_854]))))) then
      (
        let sk_u: hash0 = r_673[@i_854]
      )
      else
      (
        new r_715: hash0;
        let sk_u: hash0 = r_715
      )
    )
  )
  orfind @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  orfind @i_141 <= NP suchthat defined(@2_r2_90[@i_141], yp[@i_141], Yp[@i_141]) && otheruses(@2_r2_90[@i_141]) && (Ystar_u = @2_r2_90[@i_141]) then
  (
    let K_u: G = exp(g, mult(yp[@i_141], x)) in
    let x1_295: host = U in
    let x2_294: host = S in
    find [unique] @i_373 <= qH1 suchthat defined(x1_64[@i_373], x2_63[@i_373], x3_62[@i_373], x4_61[@i_373], x5_60[@i_373], r_248[@i_373]) && otheruses(r_248[@i_373]) && ((x1_295 = x1_64[@i_373]) && ((x2_294 = x2_63[@i_373]) && ((X = x3_62[@i_373]) && ((Yp[@i_141] = x4_61[@i_373]) && (K_u = x5_60[@i_373]))))) then
    (
      out(c6[!_53], r_248[@i_373]);
      in(c9[!_53], ());
      let x1_738: host = U in
      let x2_737: host = S in
      let x3_736: G = cst_G in
      let x4_735: G = cst_G in
      let x5_734: G = cst_G in
      find [unique] @i_893 <= qH0 suchthat defined(x1_69[@i_893], x2_68[@i_893], x3_67[@i_893], x4_66[@i_893], x5_65[@i_893], x5_674[@i_893], x4_675[@i_893], x3_676[@i_893], x2_677[@i_893], x1_678[@i_893], r_673[@i_893]) && otheruses(r_673[@i_893]) && ((x1_738 = x1_69[@i_893]) && ((x2_737 = x2_68[@i_893]) && ((X = x3_67[@i_893]) && ((Yp[@i_141] = x4_66[@i_893]) && (K_u = x5_65[@i_893]))))) then
      (
        let sk_u: hash0 = r_673[@i_893]
      )
      else
      (
        new r_733: hash0;
        let sk_u: hash0 = r_733
      )
    )
    else
    (
      new r_290: hash1;
      out(c6[!_53], r_290);
      in(c9[!_53], ());
      let x1_732: host = U in
      let x2_731: host = S in
      let x3_730: G = cst_G in
      let x4_729: G = cst_G in
      let x5_728: G = cst_G in
      find [unique] @i_880 <= qH0 suchthat defined(x1_69[@i_880], x2_68[@i_880], x3_67[@i_880], x4_66[@i_880], x5_65[@i_880], x5_674[@i_880], x4_675[@i_880], x3_676[@i_880], x2_677[@i_880], x1_678[@i_880], r_673[@i_880]) && otheruses(r_673[@i_880]) && ((x1_732 = x1_69[@i_880]) && ((x2_731 = x2_68[@i_880]) && ((X = x3_67[@i_880]) && ((Yp[@i_141] = x4_66[@i_880]) && (K_u = x5_65[@i_880]))))) then
      (
        let sk_u: hash0 = r_673[@i_880]
      )
      else
      (
        new r_727: hash0;
        let sk_u: hash0 = r_727
      )
    )
  )
  orfind @i_140 <= NS suchthat defined(@2_r2_93[@i_140], y[@i_140], Y[@i_140]) && otheruses(@2_r2_93[@i_140]) && (Ystar_u = @2_r2_93[@i_140]) then
  (
    let K_u: G = exp(g, mult(y[@i_140], x)) in
    let x1_301: host = U in
    let x2_300: host = S in
    find [unique] @i_382 <= qH1 suchthat defined(x1_64[@i_382], x2_63[@i_382], x3_62[@i_382], x4_61[@i_382], x5_60[@i_382], r_248[@i_382]) && otheruses(r_248[@i_382]) && ((x1_301 = x1_64[@i_382]) && ((x2_300 = x2_63[@i_382]) && ((X = x3_62[@i_382]) && ((Y[@i_140] = x4_61[@i_382]) && (K_u = x5_60[@i_382]))))) then
    (
      out(c6[!_53], r_248[@i_382]);
      in(c9[!_53], ());
      let x1_750: host = U in
      let x2_749: host = S in
      let x3_748: G = cst_G in
      let x4_747: G = cst_G in
      let x5_746: G = cst_G in
      find [unique] @i_919 <= qH0 suchthat defined(x1_69[@i_919], x2_68[@i_919], x3_67[@i_919], x4_66[@i_919], x5_65[@i_919], x5_674[@i_919], x4_675[@i_919], x3_676[@i_919], x2_677[@i_919], x1_678[@i_919], r_673[@i_919]) && otheruses(r_673[@i_919]) && ((x1_750 = x1_69[@i_919]) && ((x2_749 = x2_68[@i_919]) && ((X = x3_67[@i_919]) && ((Y[@i_140] = x4_66[@i_919]) && (K_u = x5_65[@i_919]))))) then
      (
        let sk_u: hash0 = r_673[@i_919]
      )
      orfind  suchthat defined(j[@i_140], r_685[@i_140]) && otheruses(r_685[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_685[@i_140]
      )
      else
      (
        new r_745: hash0;
        let sk_u: hash0 = r_745
      )
    )
    else
    (
      new r_296: hash1;
      out(c6[!_53], r_296);
      in(c9[!_53], ());
      let x1_744: host = U in
      let x2_743: host = S in
      let x3_742: G = cst_G in
      let x4_741: G = cst_G in
      let x5_740: G = cst_G in
      find [unique] @i_906 <= qH0 suchthat defined(x1_69[@i_906], x2_68[@i_906], x3_67[@i_906], x4_66[@i_906], x5_65[@i_906], x5_674[@i_906], x4_675[@i_906], x3_676[@i_906], x2_677[@i_906], x1_678[@i_906], r_673[@i_906]) && otheruses(r_673[@i_906]) && ((x1_744 = x1_69[@i_906]) && ((x2_743 = x2_68[@i_906]) && ((X = x3_67[@i_906]) && ((Y[@i_140] = x4_66[@i_906]) && (K_u = x5_65[@i_906]))))) then
      (
        let sk_u: hash0 = r_673[@i_906]
      )
      orfind  suchthat defined(j[@i_140], r_685[@i_140]) && otheruses(r_685[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_685[@i_140]
      )
      orfind  suchthat defined(j[@i_140], r_691[@i_140]) && otheruses(r_691[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_691[@i_140]
      )
      else
      (
        new r_739: hash0;
        let sk_u: hash0 = r_739
      )
    )
  )
  else
  (
    new @1_x_1271: exponent;
    let @2_r4_96: G = cst_G in
    let K_u: G = exp(g, mult(@1_x_1271, x)) in
    let x1_277: host = U in
    let x2_276: host = S in
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ());
    let x1_702: host = U in
    let x2_701: host = S in
    let x3_700: G = cst_G in
    let x4_699: G = cst_G in
    let x5_698: G = cst_G in
    find [unique] @i_815 <= qH0 suchthat defined(x1_69[@i_815], x2_68[@i_815], x3_67[@i_815], x4_66[@i_815], x5_65[@i_815], x5_674[@i_815], x4_675[@i_815], x3_676[@i_815], x2_677[@i_815], x1_678[@i_815], r_673[@i_815]) && otheruses(r_673[@i_815]) && ((x1_702 = x1_69[@i_815]) && ((x2_701 = x2_68[@i_815]) && ((X = x3_67[@i_815]) && ((exp(g, @1_x_1271) = x4_66[@i_815]) && (K_u = x5_65[@i_815]))))) then
    (
      let sk_u: hash0 = r_673[@i_815]
    )
    else
    (
      new r_697: hash0;
      let sk_u: hash0 = r_697
    )
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_271: host = U in
    let x2_270: host = S in
    find [unique] @i_337 <= qH1 suchthat defined(x1_64[@i_337], x2_63[@i_337], x3_62[@i_337], x4_61[@i_337], x5_60[@i_337], r_248[@i_337]) && otheruses(r_248[@i_337]) && ((x1_271 = x1_64[@i_337]) && ((x2_270 = x2_63[@i_337]) && ((X_s = x3_62[@i_337]) && ((Y = x4_61[@i_337]) && (K_s = x5_60[@i_337]))))) then
    (
      if (auth_s = r_248[@i_337]) then
      let x1_690: host = U in
      let x2_689: host = S in
      let x3_688: G = cst_G in
      let x4_687: G = cst_G in
      let x5_686: G = cst_G in
      find [unique] @i_789 <= qH0 suchthat defined(x1_69[@i_789], x2_68[@i_789], x3_67[@i_789], x4_66[@i_789], x5_65[@i_789], x5_674[@i_789], x4_675[@i_789], x3_676[@i_789], x2_677[@i_789], x1_678[@i_789], r_673[@i_789]) && otheruses(r_673[@i_789]) && ((x1_690 = x1_69[@i_789]) && ((x2_689 = x2_68[@i_789]) && ((X_s = x3_67[@i_789]) && ((Y = x4_66[@i_789]) && (K_s = x5_65[@i_789]))))) then
      (
        let sk_s: hash0 = r_673[@i_789]
      )
      orfind  suchthat defined(@i_140[j], r_739[j]) && otheruses(r_739[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
      (
        let sk_s: hash0 = r_739[j]
      )
      orfind  suchthat defined(@i_140[j], r_745[j]) && otheruses(r_745[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
      (
        let sk_s: hash0 = r_745[j]
      )
      else
      (
        new r_685: hash0;
        let sk_s: hash0 = r_685
      )
    )
    orfind  suchthat defined(@i_140[j], r_296[j]) && otheruses(r_296[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
    (
      if (auth_s = r_296[j]) then
      let x1_696: host = U in
      let x2_695: host = S in
      let x3_694: G = cst_G in
      let x4_693: G = cst_G in
      let x5_692: G = cst_G in
      find [unique] @i_802 <= qH0 suchthat defined(x1_69[@i_802], x2_68[@i_802], x3_67[@i_802], x4_66[@i_802], x5_65[@i_802], x5_674[@i_802], x4_675[@i_802], x3_676[@i_802], x2_677[@i_802], x1_678[@i_802], r_673[@i_802]) && otheruses(r_673[@i_802]) && ((x1_696 = x1_69[@i_802]) && ((x2_695 = x2_68[@i_802]) && ((X_s = x3_67[@i_802]) && ((Y = x4_66[@i_802]) && (K_s = x5_65[@i_802]))))) then
      (
        let sk_s: hash0 = r_673[@i_802]
      )
      orfind  suchthat defined(r_739[j]) && otheruses(r_739[j]) then
      (
        let sk_s: hash0 = r_739[j]
      )
      else
      (
        new r_691: hash0;
        let sk_s: hash0 = r_691
      )
    )
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    event Auth
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_90: G;
  let x1_259: host = U in
  let x2_258: host = S in
  new r_254: hash1;
  let x1_684: host = U in
  let x2_683: host = S in
  let x3_682: G = cst_G in
  let x4_681: G = cst_G in
  let x5_680: G = cst_G in
  new r_679: hash0;
  let sk_p: hash0 = r_679 in
  out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@1_x_1092[@i_118], @2_r4_84[@i_118], @2_kd[@i_118], @2_m[@i_118]) && otheruses(@1_x_1092[@i_118]) && ((@2_x = exp(g, @1_x_1092[@i_118])) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_114 <= NU suchthat defined(@1_x_1271[@i_114], @2_r4_96[@i_114], Ystar_u[@i_114]) && otheruses(@1_x_1271[@i_114]) && ((@2_x = exp(g, @1_x_1271[@i_114])) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], Ystar_u[@i_114])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = Yp[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@1_x_1092[@i_108], @2_m[@i_108], @2_kd[@i_108], @2_r4_84[@i_108]) && otheruses(@1_x_1092[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], exp(g, @1_x_1092[@i_108]))
  )
  orfind @i_104 <= NU suchthat defined(@1_x_1271[@i_104], Ystar_u[@i_104], @2_r4_96[@i_104]) && otheruses(@1_x_1271[@i_104]) && ((@2_m = Ystar_u[@i_104]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], exp(g, @1_x_1271[@i_104]))
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@2_r2_90[@i_101], Yp[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Yp[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_r2_93[@i_100], Y[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @1_x_1092: exponent;
    let @2_r4_84: G = cst_G in
    out(@2_c4[!_57], exp(g, @1_x_1092))
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  let x1_678: host = cst_host in
  let x2_677: host = cst_host in
  let x3_676: G = cst_G in
  let x4_675: G = cst_G in
  let x5_674: G = cst_G in
  find [unique] @i_763 <= qH0 suchthat defined(x1_69[@i_763], x2_68[@i_763], x3_67[@i_763], x4_66[@i_763], x5_65[@i_763], x5_674[@i_763], x4_675[@i_763], x3_676[@i_763], x2_677[@i_763], x1_678[@i_763], r_673[@i_763]) && otheruses(r_673[@i_763]) && ((x1_69 = x1_69[@i_763]) && ((x2_68 = x2_68[@i_763]) && ((x3_67 = x3_67[@i_763]) && ((x4_66 = x4_66[@i_763]) && (x5_65 = x5_65[@i_763]))))) then
  (
    out(c20[!_58], r_673[@i_763])
  )
  orfind @i_762 <= NP suchthat defined(Xp[@i_762], Yp[@i_762], Kp[@i_762], x5_680[@i_762], x4_681[@i_762], x3_682[@i_762], x1_684[@i_762], x2_683[@i_762], r_679[@i_762]) && otheruses(r_679[@i_762]) && ((x1_69 = x1_684[@i_762]) && ((x2_68 = x2_683[@i_762]) && ((x3_67 = Xp[@i_762]) && ((x4_66 = Yp[@i_762]) && (x5_65 = Kp[@i_762]))))) then
  (
    out(c20[!_58], r_679[@i_762])
  )
  orfind @i_761 <= NS suchthat defined(X_s[@i_761], Y[@i_761], K_s[@i_761], x5_686[@i_761], x4_687[@i_761], x3_688[@i_761], x1_690[@i_761], x2_689[@i_761], r_685[@i_761]) && otheruses(r_685[@i_761]) && ((x1_69 = x1_690[@i_761]) && ((x2_68 = x2_689[@i_761]) && ((x3_67 = X_s[@i_761]) && ((x4_66 = Y[@i_761]) && (x5_65 = K_s[@i_761]))))) then
  (
    out(c20[!_58], r_685[@i_761])
  )
  orfind @i_760 <= NS suchthat defined(X_s[@i_760], Y[@i_760], K_s[@i_760], x5_692[@i_760], x4_693[@i_760], x3_694[@i_760], x1_696[@i_760], x2_695[@i_760], r_691[@i_760]) && otheruses(r_691[@i_760]) && ((x1_69 = x1_696[@i_760]) && ((x2_68 = x2_695[@i_760]) && ((x3_67 = X_s[@i_760]) && ((x4_66 = Y[@i_760]) && (x5_65 = K_s[@i_760]))))) then
  (
    out(c20[!_58], r_691[@i_760])
  )
  orfind @i_759 <= NU suchthat defined(@1_x_1271[@i_759], X[@i_759], @2_r4_96[@i_759], K_u[@i_759], x5_698[@i_759], x4_699[@i_759], x3_700[@i_759], x1_702[@i_759], x2_701[@i_759], r_697[@i_759]) && otheruses(r_697[@i_759]) && ((x1_69 = x1_702[@i_759]) && ((x2_68 = x2_701[@i_759]) && ((x3_67 = X[@i_759]) && ((x4_66 = exp(g, @1_x_1271[@i_759])) && (x5_65 = K_u[@i_759]))))) then
  (
    out(c20[!_58], r_697[@i_759])
  )
  orfind @i_758 <= NU suchthat defined(@1_x_1092[@i_148[@i_758]], X[@i_758], @2_r4_84[@i_148[@i_758]], K_u[@i_758], x5_704[@i_758], x4_705[@i_758], x3_706[@i_758], x1_708[@i_758], x2_707[@i_758], r_703[@i_758]) && otheruses(r_703[@i_758]) && ((x1_69 = x1_708[@i_758]) && ((x2_68 = x2_707[@i_758]) && ((x3_67 = X[@i_758]) && ((x4_66 = exp(g, @1_x_1092[@i_148[@i_758]])) && (x5_65 = K_u[@i_758]))))) then
  (
    out(c20[!_58], r_703[@i_758])
  )
  orfind @i_757 <= NU suchthat defined(@1_x_1092[@i_148[@i_757]], X[@i_757], @2_r4_84[@i_148[@i_757]], K_u[@i_757], x5_710[@i_757], x4_711[@i_757], x3_712[@i_757], x1_714[@i_757], x2_713[@i_757], r_709[@i_757]) && otheruses(r_709[@i_757]) && ((x1_69 = x1_714[@i_757]) && ((x2_68 = x2_713[@i_757]) && ((x3_67 = X[@i_757]) && ((x4_66 = exp(g, @1_x_1092[@i_148[@i_757]])) && (x5_65 = K_u[@i_757]))))) then
  (
    out(c20[!_58], r_709[@i_757])
  )
  orfind @i_756 <= NU suchthat defined(@1_x_1271[@i_144[@i_756]], X[@i_756], @2_r4_96[@i_144[@i_756]], K_u[@i_756], x5_716[@i_756], x4_717[@i_756], x3_718[@i_756], x1_720[@i_756], x2_719[@i_756], r_715[@i_756]) && otheruses(r_715[@i_756]) && ((x1_69 = x1_720[@i_756]) && ((x2_68 = x2_719[@i_756]) && ((x3_67 = X[@i_756]) && ((x4_66 = exp(g, @1_x_1271[@i_144[@i_756]])) && (x5_65 = K_u[@i_756]))))) then
  (
    out(c20[!_58], r_715[@i_756])
  )
  orfind @i_755 <= NU suchthat defined(@1_x_1271[@i_144[@i_755]], X[@i_755], @2_r4_96[@i_144[@i_755]], K_u[@i_755], x5_722[@i_755], x4_723[@i_755], x3_724[@i_755], x1_726[@i_755], x2_725[@i_755], r_721[@i_755]) && otheruses(r_721[@i_755]) && ((x1_69 = x1_726[@i_755]) && ((x2_68 = x2_725[@i_755]) && ((x3_67 = X[@i_755]) && ((x4_66 = exp(g, @1_x_1271[@i_144[@i_755]])) && (x5_65 = K_u[@i_755]))))) then
  (
    out(c20[!_58], r_721[@i_755])
  )
  orfind @i_754 <= NU suchthat defined(X[@i_754], Yp[@i_141[@i_754]], K_u[@i_754], x5_728[@i_754], x4_729[@i_754], x3_730[@i_754], x1_732[@i_754], x2_731[@i_754], r_727[@i_754]) && otheruses(r_727[@i_754]) && ((x1_69 = x1_732[@i_754]) && ((x2_68 = x2_731[@i_754]) && ((x3_67 = X[@i_754]) && ((x4_66 = Yp[@i_141[@i_754]]) && (x5_65 = K_u[@i_754]))))) then
  (
    out(c20[!_58], r_727[@i_754])
  )
  orfind @i_753 <= NU suchthat defined(X[@i_753], Yp[@i_141[@i_753]], K_u[@i_753], x5_734[@i_753], x4_735[@i_753], x3_736[@i_753], x1_738[@i_753], x2_737[@i_753], r_733[@i_753]) && otheruses(r_733[@i_753]) && ((x1_69 = x1_738[@i_753]) && ((x2_68 = x2_737[@i_753]) && ((x3_67 = X[@i_753]) && ((x4_66 = Yp[@i_141[@i_753]]) && (x5_65 = K_u[@i_753]))))) then
  (
    out(c20[!_58], r_733[@i_753])
  )
  orfind @i_752 <= NU suchthat defined(X[@i_752], Y[@i_140[@i_752]], K_u[@i_752], x5_740[@i_752], x4_741[@i_752], x3_742[@i_752], x1_744[@i_752], x2_743[@i_752], r_739[@i_752]) && otheruses(r_739[@i_752]) && ((x1_69 = x1_744[@i_752]) && ((x2_68 = x2_743[@i_752]) && ((x3_67 = X[@i_752]) && ((x4_66 = Y[@i_140[@i_752]]) && (x5_65 = K_u[@i_752]))))) then
  (
    out(c20[!_58], r_739[@i_752])
  )
  orfind @i_751 <= NU suchthat defined(X[@i_751], Y[@i_140[@i_751]], K_u[@i_751], x5_746[@i_751], x4_747[@i_751], x3_748[@i_751], x1_750[@i_751], x2_749[@i_751], r_745[@i_751]) && otheruses(r_745[@i_751]) && ((x1_69 = x1_750[@i_751]) && ((x2_68 = x2_749[@i_751]) && ((x3_67 = X[@i_751]) && ((x4_66 = Y[@i_140[@i_751]]) && (x5_65 = K_u[@i_751]))))) then
  (
    out(c20[!_58], r_745[@i_751])
  )
  else
  (
    new r_673: hash0;
    out(c20[!_58], r_673)
  )
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  orfind @i_309 <= NP suchthat defined(x1_259[@i_309], x2_258[@i_309], Xp[@i_309], Yp[@i_309], Kp[@i_309], r_254[@i_309]) && otheruses(r_254[@i_309]) && ((x1_64 = x1_259[@i_309]) && ((x2_63 = x2_258[@i_309]) && ((x3_62 = Xp[@i_309]) && ((x4_61 = Yp[@i_309]) && (x5_60 = Kp[@i_309]))))) then
  (
    out(c21[!_59], r_254[@i_309])
  )
  orfind @i_306 <= NU suchthat defined(@1_x_1271[@i_306], x1_277[@i_306], x2_276[@i_306], X[@i_306], @2_r4_96[@i_306], K_u[@i_306], r_272[@i_306]) && otheruses(r_272[@i_306]) && ((x1_64 = x1_277[@i_306]) && ((x2_63 = x2_276[@i_306]) && ((x3_62 = X[@i_306]) && ((x4_61 = exp(g, @1_x_1271[@i_306])) && (x5_60 = K_u[@i_306]))))) then
  (
    out(c21[!_59], r_272[@i_306])
  )
  orfind @i_305 <= NU suchthat defined(@1_x_1092[@i_148[@i_305]], x1_283[@i_305], x2_282[@i_305], X[@i_305], @2_r4_84[@i_148[@i_305]], K_u[@i_305], r_278[@i_305]) && otheruses(r_278[@i_305]) && ((x1_64 = x1_283[@i_305]) && ((x2_63 = x2_282[@i_305]) && ((x3_62 = X[@i_305]) && ((x4_61 = exp(g, @1_x_1092[@i_148[@i_305]])) && (x5_60 = K_u[@i_305]))))) then
  (
    out(c21[!_59], r_278[@i_305])
  )
  orfind @i_304 <= NU suchthat defined(@1_x_1271[@i_144[@i_304]], x1_289[@i_304], x2_288[@i_304], X[@i_304], @2_r4_96[@i_144[@i_304]], K_u[@i_304], r_284[@i_304]) && otheruses(r_284[@i_304]) && ((x1_64 = x1_289[@i_304]) && ((x2_63 = x2_288[@i_304]) && ((x3_62 = X[@i_304]) && ((x4_61 = exp(g, @1_x_1271[@i_144[@i_304]])) && (x5_60 = K_u[@i_304]))))) then
  (
    out(c21[!_59], r_284[@i_304])
  )
  orfind @i_303 <= NU suchthat defined(x1_295[@i_303], x2_294[@i_303], X[@i_303], Yp[@i_141[@i_303]], K_u[@i_303], r_290[@i_303]) && otheruses(r_290[@i_303]) && ((x1_64 = x1_295[@i_303]) && ((x2_63 = x2_294[@i_303]) && ((x3_62 = X[@i_303]) && ((x4_61 = Yp[@i_141[@i_303]]) && (x5_60 = K_u[@i_303]))))) then
  (
    out(c21[!_59], r_290[@i_303])
  )
  orfind @i_302 <= NU suchthat defined(x1_301[@i_302], x2_300[@i_302], X[@i_302], Y[@i_140[@i_302]], K_u[@i_302], r_296[@i_302]) && otheruses(r_296[@i_302]) && ((x1_64 = x1_301[@i_302]) && ((x2_63 = x2_300[@i_302]) && ((x3_62 = X[@i_302]) && ((x4_61 = Y[@i_140[@i_302]]) && (x5_60 = K_u[@i_302]))))) then
  (
    out(c21[!_59], r_296[@i_302])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying remove assignments of binder Kp yields

Game 19 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_148 <= qD suchthat defined(@1_x_1092[@i_148], @2_m[@i_148], @2_kd[@i_148], @2_r4_84[@i_148]) && otheruses(@1_x_1092[@i_148]) && ((Ystar_u = @2_m[@i_148]) && (pw = @2_kd[@i_148])) then
  (
    let K_u: G = exp(g, mult(@1_x_1092[@i_148], x)) in
    let x1_283: host = U in
    let x2_282: host = S in
    find [unique] @i_355 <= qH1 suchthat defined(x1_64[@i_355], x2_63[@i_355], x3_62[@i_355], x4_61[@i_355], x5_60[@i_355], r_248[@i_355]) && otheruses(r_248[@i_355]) && ((x1_283 = x1_64[@i_355]) && ((x2_282 = x2_63[@i_355]) && ((X = x3_62[@i_355]) && ((exp(g, @1_x_1092[@i_148]) = x4_61[@i_355]) && (K_u = x5_60[@i_355]))))) then
    (
      out(c6[!_53], r_248[@i_355]);
      in(c9[!_53], ());
      let x1_714: host = U in
      let x2_713: host = S in
      let x3_712: G = cst_G in
      let x4_711: G = cst_G in
      let x5_710: G = cst_G in
      find [unique] @i_841 <= qH0 suchthat defined(x1_69[@i_841], x2_68[@i_841], x3_67[@i_841], x4_66[@i_841], x5_65[@i_841], x5_674[@i_841], x4_675[@i_841], x3_676[@i_841], x2_677[@i_841], x1_678[@i_841], r_673[@i_841]) && otheruses(r_673[@i_841]) && ((x1_714 = x1_69[@i_841]) && ((x2_713 = x2_68[@i_841]) && ((X = x3_67[@i_841]) && ((exp(g, @1_x_1092[@i_148]) = x4_66[@i_841]) && (K_u = x5_65[@i_841]))))) then
      (
        let sk_u: hash0 = r_673[@i_841]
      )
      else
      (
        new r_709: hash0;
        let sk_u: hash0 = r_709
      )
    )
    else
    (
      new r_278: hash1;
      out(c6[!_53], r_278);
      in(c9[!_53], ());
      let x1_708: host = U in
      let x2_707: host = S in
      let x3_706: G = cst_G in
      let x4_705: G = cst_G in
      let x5_704: G = cst_G in
      find [unique] @i_828 <= qH0 suchthat defined(x1_69[@i_828], x2_68[@i_828], x3_67[@i_828], x4_66[@i_828], x5_65[@i_828], x5_674[@i_828], x4_675[@i_828], x3_676[@i_828], x2_677[@i_828], x1_678[@i_828], r_673[@i_828]) && otheruses(r_673[@i_828]) && ((x1_708 = x1_69[@i_828]) && ((x2_707 = x2_68[@i_828]) && ((X = x3_67[@i_828]) && ((exp(g, @1_x_1092[@i_148]) = x4_66[@i_828]) && (K_u = x5_65[@i_828]))))) then
      (
        let sk_u: hash0 = r_673[@i_828]
      )
      else
      (
        new r_703: hash0;
        let sk_u: hash0 = r_703
      )
    )
  )
  orfind @i_144 <= NU suchthat defined(@1_x_1271[@i_144], Ystar_u[@i_144], @2_r4_96[@i_144]) && otheruses(@1_x_1271[@i_144]) && (Ystar_u = Ystar_u[@i_144]) then
  (
    let K_u: G = exp(g, mult(@1_x_1271[@i_144], x)) in
    let x1_289: host = U in
    let x2_288: host = S in
    find [unique] @i_364 <= qH1 suchthat defined(x1_64[@i_364], x2_63[@i_364], x3_62[@i_364], x4_61[@i_364], x5_60[@i_364], r_248[@i_364]) && otheruses(r_248[@i_364]) && ((x1_289 = x1_64[@i_364]) && ((x2_288 = x2_63[@i_364]) && ((X = x3_62[@i_364]) && ((exp(g, @1_x_1271[@i_144]) = x4_61[@i_364]) && (K_u = x5_60[@i_364]))))) then
    (
      out(c6[!_53], r_248[@i_364]);
      in(c9[!_53], ());
      let x1_726: host = U in
      let x2_725: host = S in
      let x3_724: G = cst_G in
      let x4_723: G = cst_G in
      let x5_722: G = cst_G in
      find [unique] @i_867 <= qH0 suchthat defined(x1_69[@i_867], x2_68[@i_867], x3_67[@i_867], x4_66[@i_867], x5_65[@i_867], x5_674[@i_867], x4_675[@i_867], x3_676[@i_867], x2_677[@i_867], x1_678[@i_867], r_673[@i_867]) && otheruses(r_673[@i_867]) && ((x1_726 = x1_69[@i_867]) && ((x2_725 = x2_68[@i_867]) && ((X = x3_67[@i_867]) && ((exp(g, @1_x_1271[@i_144]) = x4_66[@i_867]) && (K_u = x5_65[@i_867]))))) then
      (
        let sk_u: hash0 = r_673[@i_867]
      )
      else
      (
        new r_721: hash0;
        let sk_u: hash0 = r_721
      )
    )
    else
    (
      new r_284: hash1;
      out(c6[!_53], r_284);
      in(c9[!_53], ());
      let x1_720: host = U in
      let x2_719: host = S in
      let x3_718: G = cst_G in
      let x4_717: G = cst_G in
      let x5_716: G = cst_G in
      find [unique] @i_854 <= qH0 suchthat defined(x1_69[@i_854], x2_68[@i_854], x3_67[@i_854], x4_66[@i_854], x5_65[@i_854], x5_674[@i_854], x4_675[@i_854], x3_676[@i_854], x2_677[@i_854], x1_678[@i_854], r_673[@i_854]) && otheruses(r_673[@i_854]) && ((x1_720 = x1_69[@i_854]) && ((x2_719 = x2_68[@i_854]) && ((X = x3_67[@i_854]) && ((exp(g, @1_x_1271[@i_144]) = x4_66[@i_854]) && (K_u = x5_65[@i_854]))))) then
      (
        let sk_u: hash0 = r_673[@i_854]
      )
      else
      (
        new r_715: hash0;
        let sk_u: hash0 = r_715
      )
    )
  )
  orfind @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  orfind @i_141 <= NP suchthat defined(@2_r2_90[@i_141], yp[@i_141], Yp[@i_141]) && otheruses(@2_r2_90[@i_141]) && (Ystar_u = @2_r2_90[@i_141]) then
  (
    let K_u: G = exp(g, mult(yp[@i_141], x)) in
    let x1_295: host = U in
    let x2_294: host = S in
    find [unique] @i_373 <= qH1 suchthat defined(x1_64[@i_373], x2_63[@i_373], x3_62[@i_373], x4_61[@i_373], x5_60[@i_373], r_248[@i_373]) && otheruses(r_248[@i_373]) && ((x1_295 = x1_64[@i_373]) && ((x2_294 = x2_63[@i_373]) && ((X = x3_62[@i_373]) && ((Yp[@i_141] = x4_61[@i_373]) && (K_u = x5_60[@i_373]))))) then
    (
      out(c6[!_53], r_248[@i_373]);
      in(c9[!_53], ());
      let x1_738: host = U in
      let x2_737: host = S in
      let x3_736: G = cst_G in
      let x4_735: G = cst_G in
      let x5_734: G = cst_G in
      find [unique] @i_893 <= qH0 suchthat defined(x1_69[@i_893], x2_68[@i_893], x3_67[@i_893], x4_66[@i_893], x5_65[@i_893], x5_674[@i_893], x4_675[@i_893], x3_676[@i_893], x2_677[@i_893], x1_678[@i_893], r_673[@i_893]) && otheruses(r_673[@i_893]) && ((x1_738 = x1_69[@i_893]) && ((x2_737 = x2_68[@i_893]) && ((X = x3_67[@i_893]) && ((Yp[@i_141] = x4_66[@i_893]) && (K_u = x5_65[@i_893]))))) then
      (
        let sk_u: hash0 = r_673[@i_893]
      )
      else
      (
        new r_733: hash0;
        let sk_u: hash0 = r_733
      )
    )
    else
    (
      new r_290: hash1;
      out(c6[!_53], r_290);
      in(c9[!_53], ());
      let x1_732: host = U in
      let x2_731: host = S in
      let x3_730: G = cst_G in
      let x4_729: G = cst_G in
      let x5_728: G = cst_G in
      find [unique] @i_880 <= qH0 suchthat defined(x1_69[@i_880], x2_68[@i_880], x3_67[@i_880], x4_66[@i_880], x5_65[@i_880], x5_674[@i_880], x4_675[@i_880], x3_676[@i_880], x2_677[@i_880], x1_678[@i_880], r_673[@i_880]) && otheruses(r_673[@i_880]) && ((x1_732 = x1_69[@i_880]) && ((x2_731 = x2_68[@i_880]) && ((X = x3_67[@i_880]) && ((Yp[@i_141] = x4_66[@i_880]) && (K_u = x5_65[@i_880]))))) then
      (
        let sk_u: hash0 = r_673[@i_880]
      )
      else
      (
        new r_727: hash0;
        let sk_u: hash0 = r_727
      )
    )
  )
  orfind @i_140 <= NS suchthat defined(@2_r2_93[@i_140], y[@i_140], Y[@i_140]) && otheruses(@2_r2_93[@i_140]) && (Ystar_u = @2_r2_93[@i_140]) then
  (
    let K_u: G = exp(g, mult(y[@i_140], x)) in
    let x1_301: host = U in
    let x2_300: host = S in
    find [unique] @i_382 <= qH1 suchthat defined(x1_64[@i_382], x2_63[@i_382], x3_62[@i_382], x4_61[@i_382], x5_60[@i_382], r_248[@i_382]) && otheruses(r_248[@i_382]) && ((x1_301 = x1_64[@i_382]) && ((x2_300 = x2_63[@i_382]) && ((X = x3_62[@i_382]) && ((Y[@i_140] = x4_61[@i_382]) && (K_u = x5_60[@i_382]))))) then
    (
      out(c6[!_53], r_248[@i_382]);
      in(c9[!_53], ());
      let x1_750: host = U in
      let x2_749: host = S in
      let x3_748: G = cst_G in
      let x4_747: G = cst_G in
      let x5_746: G = cst_G in
      find [unique] @i_919 <= qH0 suchthat defined(x1_69[@i_919], x2_68[@i_919], x3_67[@i_919], x4_66[@i_919], x5_65[@i_919], x5_674[@i_919], x4_675[@i_919], x3_676[@i_919], x2_677[@i_919], x1_678[@i_919], r_673[@i_919]) && otheruses(r_673[@i_919]) && ((x1_750 = x1_69[@i_919]) && ((x2_749 = x2_68[@i_919]) && ((X = x3_67[@i_919]) && ((Y[@i_140] = x4_66[@i_919]) && (K_u = x5_65[@i_919]))))) then
      (
        let sk_u: hash0 = r_673[@i_919]
      )
      orfind  suchthat defined(j[@i_140], r_685[@i_140]) && otheruses(r_685[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_685[@i_140]
      )
      else
      (
        new r_745: hash0;
        let sk_u: hash0 = r_745
      )
    )
    else
    (
      new r_296: hash1;
      out(c6[!_53], r_296);
      in(c9[!_53], ());
      let x1_744: host = U in
      let x2_743: host = S in
      let x3_742: G = cst_G in
      let x4_741: G = cst_G in
      let x5_740: G = cst_G in
      find [unique] @i_906 <= qH0 suchthat defined(x1_69[@i_906], x2_68[@i_906], x3_67[@i_906], x4_66[@i_906], x5_65[@i_906], x5_674[@i_906], x4_675[@i_906], x3_676[@i_906], x2_677[@i_906], x1_678[@i_906], r_673[@i_906]) && otheruses(r_673[@i_906]) && ((x1_744 = x1_69[@i_906]) && ((x2_743 = x2_68[@i_906]) && ((X = x3_67[@i_906]) && ((Y[@i_140] = x4_66[@i_906]) && (K_u = x5_65[@i_906]))))) then
      (
        let sk_u: hash0 = r_673[@i_906]
      )
      orfind  suchthat defined(j[@i_140], r_685[@i_140]) && otheruses(r_685[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_685[@i_140]
      )
      orfind  suchthat defined(j[@i_140], r_691[@i_140]) && otheruses(r_691[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_691[@i_140]
      )
      else
      (
        new r_739: hash0;
        let sk_u: hash0 = r_739
      )
    )
  )
  else
  (
    new @1_x_1271: exponent;
    let @2_r4_96: G = cst_G in
    let K_u: G = exp(g, mult(@1_x_1271, x)) in
    let x1_277: host = U in
    let x2_276: host = S in
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ());
    let x1_702: host = U in
    let x2_701: host = S in
    let x3_700: G = cst_G in
    let x4_699: G = cst_G in
    let x5_698: G = cst_G in
    find [unique] @i_815 <= qH0 suchthat defined(x1_69[@i_815], x2_68[@i_815], x3_67[@i_815], x4_66[@i_815], x5_65[@i_815], x5_674[@i_815], x4_675[@i_815], x3_676[@i_815], x2_677[@i_815], x1_678[@i_815], r_673[@i_815]) && otheruses(r_673[@i_815]) && ((x1_702 = x1_69[@i_815]) && ((x2_701 = x2_68[@i_815]) && ((X = x3_67[@i_815]) && ((exp(g, @1_x_1271) = x4_66[@i_815]) && (K_u = x5_65[@i_815]))))) then
    (
      let sk_u: hash0 = r_673[@i_815]
    )
    else
    (
      new r_697: hash0;
      let sk_u: hash0 = r_697
    )
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_271: host = U in
    let x2_270: host = S in
    find [unique] @i_337 <= qH1 suchthat defined(x1_64[@i_337], x2_63[@i_337], x3_62[@i_337], x4_61[@i_337], x5_60[@i_337], r_248[@i_337]) && otheruses(r_248[@i_337]) && ((x1_271 = x1_64[@i_337]) && ((x2_270 = x2_63[@i_337]) && ((X_s = x3_62[@i_337]) && ((Y = x4_61[@i_337]) && (K_s = x5_60[@i_337]))))) then
    (
      if (auth_s = r_248[@i_337]) then
      let x1_690: host = U in
      let x2_689: host = S in
      let x3_688: G = cst_G in
      let x4_687: G = cst_G in
      let x5_686: G = cst_G in
      find [unique] @i_789 <= qH0 suchthat defined(x1_69[@i_789], x2_68[@i_789], x3_67[@i_789], x4_66[@i_789], x5_65[@i_789], x5_674[@i_789], x4_675[@i_789], x3_676[@i_789], x2_677[@i_789], x1_678[@i_789], r_673[@i_789]) && otheruses(r_673[@i_789]) && ((x1_690 = x1_69[@i_789]) && ((x2_689 = x2_68[@i_789]) && ((X_s = x3_67[@i_789]) && ((Y = x4_66[@i_789]) && (K_s = x5_65[@i_789]))))) then
      (
        let sk_s: hash0 = r_673[@i_789]
      )
      orfind  suchthat defined(@i_140[j], r_739[j]) && otheruses(r_739[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
      (
        let sk_s: hash0 = r_739[j]
      )
      orfind  suchthat defined(@i_140[j], r_745[j]) && otheruses(r_745[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
      (
        let sk_s: hash0 = r_745[j]
      )
      else
      (
        new r_685: hash0;
        let sk_s: hash0 = r_685
      )
    )
    orfind  suchthat defined(@i_140[j], r_296[j]) && otheruses(r_296[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
    (
      if (auth_s = r_296[j]) then
      let x1_696: host = U in
      let x2_695: host = S in
      let x3_694: G = cst_G in
      let x4_693: G = cst_G in
      let x5_692: G = cst_G in
      find [unique] @i_802 <= qH0 suchthat defined(x1_69[@i_802], x2_68[@i_802], x3_67[@i_802], x4_66[@i_802], x5_65[@i_802], x5_674[@i_802], x4_675[@i_802], x3_676[@i_802], x2_677[@i_802], x1_678[@i_802], r_673[@i_802]) && otheruses(r_673[@i_802]) && ((x1_696 = x1_69[@i_802]) && ((x2_695 = x2_68[@i_802]) && ((X_s = x3_67[@i_802]) && ((Y = x4_66[@i_802]) && (K_s = x5_65[@i_802]))))) then
      (
        let sk_s: hash0 = r_673[@i_802]
      )
      orfind  suchthat defined(r_739[j]) && otheruses(r_739[j]) then
      (
        let sk_s: hash0 = r_739[j]
      )
      else
      (
        new r_691: hash0;
        let sk_s: hash0 = r_691
      )
    )
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    event Auth
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = cst_G in
  new @2_r2_90: G;
  let x1_259: host = U in
  let x2_258: host = S in
  new r_254: hash1;
  let x1_684: host = U in
  let x2_683: host = S in
  let x3_682: G = cst_G in
  let x4_681: G = cst_G in
  let x5_680: G = cst_G in
  new r_679: hash0;
  let sk_p: hash0 = r_679 in
  out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@1_x_1092[@i_118], @2_r4_84[@i_118], @2_kd[@i_118], @2_m[@i_118]) && otheruses(@1_x_1092[@i_118]) && ((@2_x = exp(g, @1_x_1092[@i_118])) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_114 <= NU suchthat defined(@1_x_1271[@i_114], @2_r4_96[@i_114], Ystar_u[@i_114]) && otheruses(@1_x_1271[@i_114]) && ((@2_x = exp(g, @1_x_1271[@i_114])) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], Ystar_u[@i_114])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = Yp[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@1_x_1092[@i_108], @2_m[@i_108], @2_kd[@i_108], @2_r4_84[@i_108]) && otheruses(@1_x_1092[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], exp(g, @1_x_1092[@i_108]))
  )
  orfind @i_104 <= NU suchthat defined(@1_x_1271[@i_104], Ystar_u[@i_104], @2_r4_96[@i_104]) && otheruses(@1_x_1271[@i_104]) && ((@2_m = Ystar_u[@i_104]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], exp(g, @1_x_1271[@i_104]))
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@2_r2_90[@i_101], Yp[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Yp[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_r2_93[@i_100], Y[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @1_x_1092: exponent;
    let @2_r4_84: G = cst_G in
    out(@2_c4[!_57], exp(g, @1_x_1092))
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  let x1_678: host = cst_host in
  let x2_677: host = cst_host in
  let x3_676: G = cst_G in
  let x4_675: G = cst_G in
  let x5_674: G = cst_G in
  find [unique] @i_763 <= qH0 suchthat defined(x1_69[@i_763], x2_68[@i_763], x3_67[@i_763], x4_66[@i_763], x5_65[@i_763], x5_674[@i_763], x4_675[@i_763], x3_676[@i_763], x2_677[@i_763], x1_678[@i_763], r_673[@i_763]) && otheruses(r_673[@i_763]) && ((x1_69 = x1_69[@i_763]) && ((x2_68 = x2_68[@i_763]) && ((x3_67 = x3_67[@i_763]) && ((x4_66 = x4_66[@i_763]) && (x5_65 = x5_65[@i_763]))))) then
  (
    out(c20[!_58], r_673[@i_763])
  )
  orfind @i_762 <= NP suchthat defined(yp[@i_762], xp[@i_762], Kp[@i_762], Xp[@i_762], Yp[@i_762], x5_680[@i_762], x4_681[@i_762], x3_682[@i_762], x1_684[@i_762], x2_683[@i_762], r_679[@i_762]) && otheruses(r_679[@i_762]) && ((x1_69 = x1_684[@i_762]) && ((x2_68 = x2_683[@i_762]) && ((x3_67 = Xp[@i_762]) && ((x4_66 = Yp[@i_762]) && (x5_65 = exp(g, mult(xp[@i_762], yp[@i_762]))))))) then
  (
    out(c20[!_58], r_679[@i_762])
  )
  orfind @i_761 <= NS suchthat defined(X_s[@i_761], Y[@i_761], K_s[@i_761], x5_686[@i_761], x4_687[@i_761], x3_688[@i_761], x1_690[@i_761], x2_689[@i_761], r_685[@i_761]) && otheruses(r_685[@i_761]) && ((x1_69 = x1_690[@i_761]) && ((x2_68 = x2_689[@i_761]) && ((x3_67 = X_s[@i_761]) && ((x4_66 = Y[@i_761]) && (x5_65 = K_s[@i_761]))))) then
  (
    out(c20[!_58], r_685[@i_761])
  )
  orfind @i_760 <= NS suchthat defined(X_s[@i_760], Y[@i_760], K_s[@i_760], x5_692[@i_760], x4_693[@i_760], x3_694[@i_760], x1_696[@i_760], x2_695[@i_760], r_691[@i_760]) && otheruses(r_691[@i_760]) && ((x1_69 = x1_696[@i_760]) && ((x2_68 = x2_695[@i_760]) && ((x3_67 = X_s[@i_760]) && ((x4_66 = Y[@i_760]) && (x5_65 = K_s[@i_760]))))) then
  (
    out(c20[!_58], r_691[@i_760])
  )
  orfind @i_759 <= NU suchthat defined(@1_x_1271[@i_759], X[@i_759], @2_r4_96[@i_759], K_u[@i_759], x5_698[@i_759], x4_699[@i_759], x3_700[@i_759], x1_702[@i_759], x2_701[@i_759], r_697[@i_759]) && otheruses(r_697[@i_759]) && ((x1_69 = x1_702[@i_759]) && ((x2_68 = x2_701[@i_759]) && ((x3_67 = X[@i_759]) && ((x4_66 = exp(g, @1_x_1271[@i_759])) && (x5_65 = K_u[@i_759]))))) then
  (
    out(c20[!_58], r_697[@i_759])
  )
  orfind @i_758 <= NU suchthat defined(@1_x_1092[@i_148[@i_758]], X[@i_758], @2_r4_84[@i_148[@i_758]], K_u[@i_758], x5_704[@i_758], x4_705[@i_758], x3_706[@i_758], x1_708[@i_758], x2_707[@i_758], r_703[@i_758]) && otheruses(r_703[@i_758]) && ((x1_69 = x1_708[@i_758]) && ((x2_68 = x2_707[@i_758]) && ((x3_67 = X[@i_758]) && ((x4_66 = exp(g, @1_x_1092[@i_148[@i_758]])) && (x5_65 = K_u[@i_758]))))) then
  (
    out(c20[!_58], r_703[@i_758])
  )
  orfind @i_757 <= NU suchthat defined(@1_x_1092[@i_148[@i_757]], X[@i_757], @2_r4_84[@i_148[@i_757]], K_u[@i_757], x5_710[@i_757], x4_711[@i_757], x3_712[@i_757], x1_714[@i_757], x2_713[@i_757], r_709[@i_757]) && otheruses(r_709[@i_757]) && ((x1_69 = x1_714[@i_757]) && ((x2_68 = x2_713[@i_757]) && ((x3_67 = X[@i_757]) && ((x4_66 = exp(g, @1_x_1092[@i_148[@i_757]])) && (x5_65 = K_u[@i_757]))))) then
  (
    out(c20[!_58], r_709[@i_757])
  )
  orfind @i_756 <= NU suchthat defined(@1_x_1271[@i_144[@i_756]], X[@i_756], @2_r4_96[@i_144[@i_756]], K_u[@i_756], x5_716[@i_756], x4_717[@i_756], x3_718[@i_756], x1_720[@i_756], x2_719[@i_756], r_715[@i_756]) && otheruses(r_715[@i_756]) && ((x1_69 = x1_720[@i_756]) && ((x2_68 = x2_719[@i_756]) && ((x3_67 = X[@i_756]) && ((x4_66 = exp(g, @1_x_1271[@i_144[@i_756]])) && (x5_65 = K_u[@i_756]))))) then
  (
    out(c20[!_58], r_715[@i_756])
  )
  orfind @i_755 <= NU suchthat defined(@1_x_1271[@i_144[@i_755]], X[@i_755], @2_r4_96[@i_144[@i_755]], K_u[@i_755], x5_722[@i_755], x4_723[@i_755], x3_724[@i_755], x1_726[@i_755], x2_725[@i_755], r_721[@i_755]) && otheruses(r_721[@i_755]) && ((x1_69 = x1_726[@i_755]) && ((x2_68 = x2_725[@i_755]) && ((x3_67 = X[@i_755]) && ((x4_66 = exp(g, @1_x_1271[@i_144[@i_755]])) && (x5_65 = K_u[@i_755]))))) then
  (
    out(c20[!_58], r_721[@i_755])
  )
  orfind @i_754 <= NU suchthat defined(X[@i_754], Yp[@i_141[@i_754]], K_u[@i_754], x5_728[@i_754], x4_729[@i_754], x3_730[@i_754], x1_732[@i_754], x2_731[@i_754], r_727[@i_754]) && otheruses(r_727[@i_754]) && ((x1_69 = x1_732[@i_754]) && ((x2_68 = x2_731[@i_754]) && ((x3_67 = X[@i_754]) && ((x4_66 = Yp[@i_141[@i_754]]) && (x5_65 = K_u[@i_754]))))) then
  (
    out(c20[!_58], r_727[@i_754])
  )
  orfind @i_753 <= NU suchthat defined(X[@i_753], Yp[@i_141[@i_753]], K_u[@i_753], x5_734[@i_753], x4_735[@i_753], x3_736[@i_753], x1_738[@i_753], x2_737[@i_753], r_733[@i_753]) && otheruses(r_733[@i_753]) && ((x1_69 = x1_738[@i_753]) && ((x2_68 = x2_737[@i_753]) && ((x3_67 = X[@i_753]) && ((x4_66 = Yp[@i_141[@i_753]]) && (x5_65 = K_u[@i_753]))))) then
  (
    out(c20[!_58], r_733[@i_753])
  )
  orfind @i_752 <= NU suchthat defined(X[@i_752], Y[@i_140[@i_752]], K_u[@i_752], x5_740[@i_752], x4_741[@i_752], x3_742[@i_752], x1_744[@i_752], x2_743[@i_752], r_739[@i_752]) && otheruses(r_739[@i_752]) && ((x1_69 = x1_744[@i_752]) && ((x2_68 = x2_743[@i_752]) && ((x3_67 = X[@i_752]) && ((x4_66 = Y[@i_140[@i_752]]) && (x5_65 = K_u[@i_752]))))) then
  (
    out(c20[!_58], r_739[@i_752])
  )
  orfind @i_751 <= NU suchthat defined(X[@i_751], Y[@i_140[@i_751]], K_u[@i_751], x5_746[@i_751], x4_747[@i_751], x3_748[@i_751], x1_750[@i_751], x2_749[@i_751], r_745[@i_751]) && otheruses(r_745[@i_751]) && ((x1_69 = x1_750[@i_751]) && ((x2_68 = x2_749[@i_751]) && ((x3_67 = X[@i_751]) && ((x4_66 = Y[@i_140[@i_751]]) && (x5_65 = K_u[@i_751]))))) then
  (
    out(c20[!_58], r_745[@i_751])
  )
  else
  (
    new r_673: hash0;
    out(c20[!_58], r_673)
  )
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  orfind @i_309 <= NP suchthat defined(yp[@i_309], xp[@i_309], Kp[@i_309], x1_259[@i_309], x2_258[@i_309], Xp[@i_309], Yp[@i_309], r_254[@i_309]) && otheruses(r_254[@i_309]) && ((x1_64 = x1_259[@i_309]) && ((x2_63 = x2_258[@i_309]) && ((x3_62 = Xp[@i_309]) && ((x4_61 = Yp[@i_309]) && (x5_60 = exp(g, mult(xp[@i_309], yp[@i_309]))))))) then
  (
    out(c21[!_59], r_254[@i_309])
  )
  orfind @i_306 <= NU suchthat defined(@1_x_1271[@i_306], x1_277[@i_306], x2_276[@i_306], X[@i_306], @2_r4_96[@i_306], K_u[@i_306], r_272[@i_306]) && otheruses(r_272[@i_306]) && ((x1_64 = x1_277[@i_306]) && ((x2_63 = x2_276[@i_306]) && ((x3_62 = X[@i_306]) && ((x4_61 = exp(g, @1_x_1271[@i_306])) && (x5_60 = K_u[@i_306]))))) then
  (
    out(c21[!_59], r_272[@i_306])
  )
  orfind @i_305 <= NU suchthat defined(@1_x_1092[@i_148[@i_305]], x1_283[@i_305], x2_282[@i_305], X[@i_305], @2_r4_84[@i_148[@i_305]], K_u[@i_305], r_278[@i_305]) && otheruses(r_278[@i_305]) && ((x1_64 = x1_283[@i_305]) && ((x2_63 = x2_282[@i_305]) && ((x3_62 = X[@i_305]) && ((x4_61 = exp(g, @1_x_1092[@i_148[@i_305]])) && (x5_60 = K_u[@i_305]))))) then
  (
    out(c21[!_59], r_278[@i_305])
  )
  orfind @i_304 <= NU suchthat defined(@1_x_1271[@i_144[@i_304]], x1_289[@i_304], x2_288[@i_304], X[@i_304], @2_r4_96[@i_144[@i_304]], K_u[@i_304], r_284[@i_304]) && otheruses(r_284[@i_304]) && ((x1_64 = x1_289[@i_304]) && ((x2_63 = x2_288[@i_304]) && ((x3_62 = X[@i_304]) && ((x4_61 = exp(g, @1_x_1271[@i_144[@i_304]])) && (x5_60 = K_u[@i_304]))))) then
  (
    out(c21[!_59], r_284[@i_304])
  )
  orfind @i_303 <= NU suchthat defined(x1_295[@i_303], x2_294[@i_303], X[@i_303], Yp[@i_141[@i_303]], K_u[@i_303], r_290[@i_303]) && otheruses(r_290[@i_303]) && ((x1_64 = x1_295[@i_303]) && ((x2_63 = x2_294[@i_303]) && ((x3_62 = X[@i_303]) && ((x4_61 = Yp[@i_141[@i_303]]) && (x5_60 = K_u[@i_303]))))) then
  (
    out(c21[!_59], r_290[@i_303])
  )
  orfind @i_302 <= NU suchthat defined(x1_301[@i_302], x2_300[@i_302], X[@i_302], Y[@i_140[@i_302]], K_u[@i_302], r_296[@i_302]) && otheruses(r_296[@i_302]) && ((x1_64 = x1_301[@i_302]) && ((x2_63 = x2_300[@i_302]) && ((x3_62 = X[@i_302]) && ((x4_61 = Y[@i_140[@i_302]]) && (x5_60 = K_u[@i_302]))))) then
  (
    out(c21[!_59], r_296[@i_302])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying remove assignments of binder K_s yields

Game 20 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_148 <= qD suchthat defined(@1_x_1092[@i_148], @2_m[@i_148], @2_kd[@i_148], @2_r4_84[@i_148]) && otheruses(@1_x_1092[@i_148]) && ((Ystar_u = @2_m[@i_148]) && (pw = @2_kd[@i_148])) then
  (
    let K_u: G = exp(g, mult(@1_x_1092[@i_148], x)) in
    let x1_283: host = U in
    let x2_282: host = S in
    find [unique] @i_355 <= qH1 suchthat defined(x1_64[@i_355], x2_63[@i_355], x3_62[@i_355], x4_61[@i_355], x5_60[@i_355], r_248[@i_355]) && otheruses(r_248[@i_355]) && ((x1_283 = x1_64[@i_355]) && ((x2_282 = x2_63[@i_355]) && ((X = x3_62[@i_355]) && ((exp(g, @1_x_1092[@i_148]) = x4_61[@i_355]) && (K_u = x5_60[@i_355]))))) then
    (
      out(c6[!_53], r_248[@i_355]);
      in(c9[!_53], ());
      let x1_714: host = U in
      let x2_713: host = S in
      let x3_712: G = cst_G in
      let x4_711: G = cst_G in
      let x5_710: G = cst_G in
      find [unique] @i_841 <= qH0 suchthat defined(x1_69[@i_841], x2_68[@i_841], x3_67[@i_841], x4_66[@i_841], x5_65[@i_841], x5_674[@i_841], x4_675[@i_841], x3_676[@i_841], x2_677[@i_841], x1_678[@i_841], r_673[@i_841]) && otheruses(r_673[@i_841]) && ((x1_714 = x1_69[@i_841]) && ((x2_713 = x2_68[@i_841]) && ((X = x3_67[@i_841]) && ((exp(g, @1_x_1092[@i_148]) = x4_66[@i_841]) && (K_u = x5_65[@i_841]))))) then
      (
        let sk_u: hash0 = r_673[@i_841]
      )
      else
      (
        new r_709: hash0;
        let sk_u: hash0 = r_709
      )
    )
    else
    (
      new r_278: hash1;
      out(c6[!_53], r_278);
      in(c9[!_53], ());
      let x1_708: host = U in
      let x2_707: host = S in
      let x3_706: G = cst_G in
      let x4_705: G = cst_G in
      let x5_704: G = cst_G in
      find [unique] @i_828 <= qH0 suchthat defined(x1_69[@i_828], x2_68[@i_828], x3_67[@i_828], x4_66[@i_828], x5_65[@i_828], x5_674[@i_828], x4_675[@i_828], x3_676[@i_828], x2_677[@i_828], x1_678[@i_828], r_673[@i_828]) && otheruses(r_673[@i_828]) && ((x1_708 = x1_69[@i_828]) && ((x2_707 = x2_68[@i_828]) && ((X = x3_67[@i_828]) && ((exp(g, @1_x_1092[@i_148]) = x4_66[@i_828]) && (K_u = x5_65[@i_828]))))) then
      (
        let sk_u: hash0 = r_673[@i_828]
      )
      else
      (
        new r_703: hash0;
        let sk_u: hash0 = r_703
      )
    )
  )
  orfind @i_144 <= NU suchthat defined(@1_x_1271[@i_144], Ystar_u[@i_144], @2_r4_96[@i_144]) && otheruses(@1_x_1271[@i_144]) && (Ystar_u = Ystar_u[@i_144]) then
  (
    let K_u: G = exp(g, mult(@1_x_1271[@i_144], x)) in
    let x1_289: host = U in
    let x2_288: host = S in
    find [unique] @i_364 <= qH1 suchthat defined(x1_64[@i_364], x2_63[@i_364], x3_62[@i_364], x4_61[@i_364], x5_60[@i_364], r_248[@i_364]) && otheruses(r_248[@i_364]) && ((x1_289 = x1_64[@i_364]) && ((x2_288 = x2_63[@i_364]) && ((X = x3_62[@i_364]) && ((exp(g, @1_x_1271[@i_144]) = x4_61[@i_364]) && (K_u = x5_60[@i_364]))))) then
    (
      out(c6[!_53], r_248[@i_364]);
      in(c9[!_53], ());
      let x1_726: host = U in
      let x2_725: host = S in
      let x3_724: G = cst_G in
      let x4_723: G = cst_G in
      let x5_722: G = cst_G in
      find [unique] @i_867 <= qH0 suchthat defined(x1_69[@i_867], x2_68[@i_867], x3_67[@i_867], x4_66[@i_867], x5_65[@i_867], x5_674[@i_867], x4_675[@i_867], x3_676[@i_867], x2_677[@i_867], x1_678[@i_867], r_673[@i_867]) && otheruses(r_673[@i_867]) && ((x1_726 = x1_69[@i_867]) && ((x2_725 = x2_68[@i_867]) && ((X = x3_67[@i_867]) && ((exp(g, @1_x_1271[@i_144]) = x4_66[@i_867]) && (K_u = x5_65[@i_867]))))) then
      (
        let sk_u: hash0 = r_673[@i_867]
      )
      else
      (
        new r_721: hash0;
        let sk_u: hash0 = r_721
      )
    )
    else
    (
      new r_284: hash1;
      out(c6[!_53], r_284);
      in(c9[!_53], ());
      let x1_720: host = U in
      let x2_719: host = S in
      let x3_718: G = cst_G in
      let x4_717: G = cst_G in
      let x5_716: G = cst_G in
      find [unique] @i_854 <= qH0 suchthat defined(x1_69[@i_854], x2_68[@i_854], x3_67[@i_854], x4_66[@i_854], x5_65[@i_854], x5_674[@i_854], x4_675[@i_854], x3_676[@i_854], x2_677[@i_854], x1_678[@i_854], r_673[@i_854]) && otheruses(r_673[@i_854]) && ((x1_720 = x1_69[@i_854]) && ((x2_719 = x2_68[@i_854]) && ((X = x3_67[@i_854]) && ((exp(g, @1_x_1271[@i_144]) = x4_66[@i_854]) && (K_u = x5_65[@i_854]))))) then
      (
        let sk_u: hash0 = r_673[@i_854]
      )
      else
      (
        new r_715: hash0;
        let sk_u: hash0 = r_715
      )
    )
  )
  orfind @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  orfind @i_141 <= NP suchthat defined(@2_r2_90[@i_141], yp[@i_141], Yp[@i_141]) && otheruses(@2_r2_90[@i_141]) && (Ystar_u = @2_r2_90[@i_141]) then
  (
    let K_u: G = exp(g, mult(yp[@i_141], x)) in
    let x1_295: host = U in
    let x2_294: host = S in
    find [unique] @i_373 <= qH1 suchthat defined(x1_64[@i_373], x2_63[@i_373], x3_62[@i_373], x4_61[@i_373], x5_60[@i_373], r_248[@i_373]) && otheruses(r_248[@i_373]) && ((x1_295 = x1_64[@i_373]) && ((x2_294 = x2_63[@i_373]) && ((X = x3_62[@i_373]) && ((Yp[@i_141] = x4_61[@i_373]) && (K_u = x5_60[@i_373]))))) then
    (
      out(c6[!_53], r_248[@i_373]);
      in(c9[!_53], ());
      let x1_738: host = U in
      let x2_737: host = S in
      let x3_736: G = cst_G in
      let x4_735: G = cst_G in
      let x5_734: G = cst_G in
      find [unique] @i_893 <= qH0 suchthat defined(x1_69[@i_893], x2_68[@i_893], x3_67[@i_893], x4_66[@i_893], x5_65[@i_893], x5_674[@i_893], x4_675[@i_893], x3_676[@i_893], x2_677[@i_893], x1_678[@i_893], r_673[@i_893]) && otheruses(r_673[@i_893]) && ((x1_738 = x1_69[@i_893]) && ((x2_737 = x2_68[@i_893]) && ((X = x3_67[@i_893]) && ((Yp[@i_141] = x4_66[@i_893]) && (K_u = x5_65[@i_893]))))) then
      (
        let sk_u: hash0 = r_673[@i_893]
      )
      else
      (
        new r_733: hash0;
        let sk_u: hash0 = r_733
      )
    )
    else
    (
      new r_290: hash1;
      out(c6[!_53], r_290);
      in(c9[!_53], ());
      let x1_732: host = U in
      let x2_731: host = S in
      let x3_730: G = cst_G in
      let x4_729: G = cst_G in
      let x5_728: G = cst_G in
      find [unique] @i_880 <= qH0 suchthat defined(x1_69[@i_880], x2_68[@i_880], x3_67[@i_880], x4_66[@i_880], x5_65[@i_880], x5_674[@i_880], x4_675[@i_880], x3_676[@i_880], x2_677[@i_880], x1_678[@i_880], r_673[@i_880]) && otheruses(r_673[@i_880]) && ((x1_732 = x1_69[@i_880]) && ((x2_731 = x2_68[@i_880]) && ((X = x3_67[@i_880]) && ((Yp[@i_141] = x4_66[@i_880]) && (K_u = x5_65[@i_880]))))) then
      (
        let sk_u: hash0 = r_673[@i_880]
      )
      else
      (
        new r_727: hash0;
        let sk_u: hash0 = r_727
      )
    )
  )
  orfind @i_140 <= NS suchthat defined(@2_r2_93[@i_140], y[@i_140], Y[@i_140]) && otheruses(@2_r2_93[@i_140]) && (Ystar_u = @2_r2_93[@i_140]) then
  (
    let K_u: G = exp(g, mult(y[@i_140], x)) in
    let x1_301: host = U in
    let x2_300: host = S in
    find [unique] @i_382 <= qH1 suchthat defined(x1_64[@i_382], x2_63[@i_382], x3_62[@i_382], x4_61[@i_382], x5_60[@i_382], r_248[@i_382]) && otheruses(r_248[@i_382]) && ((x1_301 = x1_64[@i_382]) && ((x2_300 = x2_63[@i_382]) && ((X = x3_62[@i_382]) && ((Y[@i_140] = x4_61[@i_382]) && (K_u = x5_60[@i_382]))))) then
    (
      out(c6[!_53], r_248[@i_382]);
      in(c9[!_53], ());
      let x1_750: host = U in
      let x2_749: host = S in
      let x3_748: G = cst_G in
      let x4_747: G = cst_G in
      let x5_746: G = cst_G in
      find [unique] @i_919 <= qH0 suchthat defined(x1_69[@i_919], x2_68[@i_919], x3_67[@i_919], x4_66[@i_919], x5_65[@i_919], x5_674[@i_919], x4_675[@i_919], x3_676[@i_919], x2_677[@i_919], x1_678[@i_919], r_673[@i_919]) && otheruses(r_673[@i_919]) && ((x1_750 = x1_69[@i_919]) && ((x2_749 = x2_68[@i_919]) && ((X = x3_67[@i_919]) && ((Y[@i_140] = x4_66[@i_919]) && (K_u = x5_65[@i_919]))))) then
      (
        let sk_u: hash0 = r_673[@i_919]
      )
      orfind  suchthat defined(j[@i_140], r_685[@i_140]) && otheruses(r_685[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_685[@i_140]
      )
      else
      (
        new r_745: hash0;
        let sk_u: hash0 = r_745
      )
    )
    else
    (
      new r_296: hash1;
      out(c6[!_53], r_296);
      in(c9[!_53], ());
      let x1_744: host = U in
      let x2_743: host = S in
      let x3_742: G = cst_G in
      let x4_741: G = cst_G in
      let x5_740: G = cst_G in
      find [unique] @i_906 <= qH0 suchthat defined(x1_69[@i_906], x2_68[@i_906], x3_67[@i_906], x4_66[@i_906], x5_65[@i_906], x5_674[@i_906], x4_675[@i_906], x3_676[@i_906], x2_677[@i_906], x1_678[@i_906], r_673[@i_906]) && otheruses(r_673[@i_906]) && ((x1_744 = x1_69[@i_906]) && ((x2_743 = x2_68[@i_906]) && ((X = x3_67[@i_906]) && ((Y[@i_140] = x4_66[@i_906]) && (K_u = x5_65[@i_906]))))) then
      (
        let sk_u: hash0 = r_673[@i_906]
      )
      orfind  suchthat defined(j[@i_140], r_685[@i_140]) && otheruses(r_685[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_685[@i_140]
      )
      orfind  suchthat defined(j[@i_140], r_691[@i_140]) && otheruses(r_691[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_691[@i_140]
      )
      else
      (
        new r_739: hash0;
        let sk_u: hash0 = r_739
      )
    )
  )
  else
  (
    new @1_x_1271: exponent;
    let @2_r4_96: G = cst_G in
    let K_u: G = exp(g, mult(@1_x_1271, x)) in
    let x1_277: host = U in
    let x2_276: host = S in
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ());
    let x1_702: host = U in
    let x2_701: host = S in
    let x3_700: G = cst_G in
    let x4_699: G = cst_G in
    let x5_698: G = cst_G in
    find [unique] @i_815 <= qH0 suchthat defined(x1_69[@i_815], x2_68[@i_815], x3_67[@i_815], x4_66[@i_815], x5_65[@i_815], x5_674[@i_815], x4_675[@i_815], x3_676[@i_815], x2_677[@i_815], x1_678[@i_815], r_673[@i_815]) && otheruses(r_673[@i_815]) && ((x1_702 = x1_69[@i_815]) && ((x2_701 = x2_68[@i_815]) && ((X = x3_67[@i_815]) && ((exp(g, @1_x_1271) = x4_66[@i_815]) && (K_u = x5_65[@i_815]))))) then
    (
      let sk_u: hash0 = r_673[@i_815]
    )
    else
    (
      new r_697: hash0;
      let sk_u: hash0 = r_697
    )
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    let x1_271: host = U in
    let x2_270: host = S in
    find [unique] @i_337 <= qH1 suchthat defined(x1_64[@i_337], x2_63[@i_337], x3_62[@i_337], x4_61[@i_337], x5_60[@i_337], r_248[@i_337]) && otheruses(r_248[@i_337]) && ((x1_271 = x1_64[@i_337]) && ((x2_270 = x2_63[@i_337]) && ((X_s = x3_62[@i_337]) && ((Y = x4_61[@i_337]) && (exp(g, mult(x[j], y)) = x5_60[@i_337]))))) then
    (
      if (auth_s = r_248[@i_337]) then
      let x1_690: host = U in
      let x2_689: host = S in
      let x3_688: G = cst_G in
      let x4_687: G = cst_G in
      let x5_686: G = cst_G in
      find [unique] @i_789 <= qH0 suchthat defined(x1_69[@i_789], x2_68[@i_789], x3_67[@i_789], x4_66[@i_789], x5_65[@i_789], x5_674[@i_789], x4_675[@i_789], x3_676[@i_789], x2_677[@i_789], x1_678[@i_789], r_673[@i_789]) && otheruses(r_673[@i_789]) && ((x1_690 = x1_69[@i_789]) && ((x2_689 = x2_68[@i_789]) && ((X_s = x3_67[@i_789]) && ((Y = x4_66[@i_789]) && (exp(g, mult(x[j], y)) = x5_65[@i_789]))))) then
      (
        let sk_s: hash0 = r_673[@i_789]
      )
      orfind  suchthat defined(@i_140[j], r_739[j]) && otheruses(r_739[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
      (
        let sk_s: hash0 = r_739[j]
      )
      orfind  suchthat defined(@i_140[j], r_745[j]) && otheruses(r_745[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
      (
        let sk_s: hash0 = r_745[j]
      )
      else
      (
        new r_685: hash0;
        let sk_s: hash0 = r_685
      )
    )
    orfind  suchthat defined(@i_140[j], r_296[j]) && otheruses(r_296[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
    (
      if (auth_s = r_296[j]) then
      let x1_696: host = U in
      let x2_695: host = S in
      let x3_694: G = cst_G in
      let x4_693: G = cst_G in
      let x5_692: G = cst_G in
      find [unique] @i_802 <= qH0 suchthat defined(x1_69[@i_802], x2_68[@i_802], x3_67[@i_802], x4_66[@i_802], x5_65[@i_802], x5_674[@i_802], x4_675[@i_802], x3_676[@i_802], x2_677[@i_802], x1_678[@i_802], r_673[@i_802]) && otheruses(r_673[@i_802]) && ((x1_696 = x1_69[@i_802]) && ((x2_695 = x2_68[@i_802]) && ((X_s = x3_67[@i_802]) && ((Y = x4_66[@i_802]) && (exp(g, mult(x[j], y)) = x5_65[@i_802]))))) then
      (
        let sk_s: hash0 = r_673[@i_802]
      )
      orfind  suchthat defined(r_739[j]) && otheruses(r_739[j]) then
      (
        let sk_s: hash0 = r_739[j]
      )
      else
      (
        new r_691: hash0;
        let sk_s: hash0 = r_691
      )
    )
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    event Auth
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = cst_G in
  new @2_r2_90: G;
  let x1_259: host = U in
  let x2_258: host = S in
  new r_254: hash1;
  let x1_684: host = U in
  let x2_683: host = S in
  let x3_682: G = cst_G in
  let x4_681: G = cst_G in
  let x5_680: G = cst_G in
  new r_679: hash0;
  let sk_p: hash0 = r_679 in
  out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@1_x_1092[@i_118], @2_r4_84[@i_118], @2_kd[@i_118], @2_m[@i_118]) && otheruses(@1_x_1092[@i_118]) && ((@2_x = exp(g, @1_x_1092[@i_118])) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_114 <= NU suchthat defined(@1_x_1271[@i_114], @2_r4_96[@i_114], Ystar_u[@i_114]) && otheruses(@1_x_1271[@i_114]) && ((@2_x = exp(g, @1_x_1271[@i_114])) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], Ystar_u[@i_114])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = Yp[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@1_x_1092[@i_108], @2_m[@i_108], @2_kd[@i_108], @2_r4_84[@i_108]) && otheruses(@1_x_1092[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], exp(g, @1_x_1092[@i_108]))
  )
  orfind @i_104 <= NU suchthat defined(@1_x_1271[@i_104], Ystar_u[@i_104], @2_r4_96[@i_104]) && otheruses(@1_x_1271[@i_104]) && ((@2_m = Ystar_u[@i_104]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], exp(g, @1_x_1271[@i_104]))
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@2_r2_90[@i_101], Yp[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Yp[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_r2_93[@i_100], Y[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @1_x_1092: exponent;
    let @2_r4_84: G = cst_G in
    out(@2_c4[!_57], exp(g, @1_x_1092))
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  let x1_678: host = cst_host in
  let x2_677: host = cst_host in
  let x3_676: G = cst_G in
  let x4_675: G = cst_G in
  let x5_674: G = cst_G in
  find [unique] @i_763 <= qH0 suchthat defined(x1_69[@i_763], x2_68[@i_763], x3_67[@i_763], x4_66[@i_763], x5_65[@i_763], x5_674[@i_763], x4_675[@i_763], x3_676[@i_763], x2_677[@i_763], x1_678[@i_763], r_673[@i_763]) && otheruses(r_673[@i_763]) && ((x1_69 = x1_69[@i_763]) && ((x2_68 = x2_68[@i_763]) && ((x3_67 = x3_67[@i_763]) && ((x4_66 = x4_66[@i_763]) && (x5_65 = x5_65[@i_763]))))) then
  (
    out(c20[!_58], r_673[@i_763])
  )
  orfind @i_762 <= NP suchthat defined(yp[@i_762], xp[@i_762], Kp[@i_762], Xp[@i_762], Yp[@i_762], x5_680[@i_762], x4_681[@i_762], x3_682[@i_762], x1_684[@i_762], x2_683[@i_762], r_679[@i_762]) && otheruses(r_679[@i_762]) && ((x1_69 = x1_684[@i_762]) && ((x2_68 = x2_683[@i_762]) && ((x3_67 = Xp[@i_762]) && ((x4_66 = Yp[@i_762]) && (x5_65 = exp(g, mult(xp[@i_762], yp[@i_762]))))))) then
  (
    out(c20[!_58], r_679[@i_762])
  )
  orfind @i_761 <= NS suchthat defined(y[@i_761], x[j[@i_761]], K_s[@i_761], X_s[@i_761], Y[@i_761], x5_686[@i_761], x4_687[@i_761], x3_688[@i_761], x1_690[@i_761], x2_689[@i_761], r_685[@i_761]) && otheruses(r_685[@i_761]) && ((x1_69 = x1_690[@i_761]) && ((x2_68 = x2_689[@i_761]) && ((x3_67 = X_s[@i_761]) && ((x4_66 = Y[@i_761]) && (x5_65 = exp(g, mult(x[j[@i_761]], y[@i_761]))))))) then
  (
    out(c20[!_58], r_685[@i_761])
  )
  orfind @i_760 <= NS suchthat defined(y[@i_760], x[j[@i_760]], K_s[@i_760], X_s[@i_760], Y[@i_760], x5_692[@i_760], x4_693[@i_760], x3_694[@i_760], x1_696[@i_760], x2_695[@i_760], r_691[@i_760]) && otheruses(r_691[@i_760]) && ((x1_69 = x1_696[@i_760]) && ((x2_68 = x2_695[@i_760]) && ((x3_67 = X_s[@i_760]) && ((x4_66 = Y[@i_760]) && (x5_65 = exp(g, mult(x[j[@i_760]], y[@i_760]))))))) then
  (
    out(c20[!_58], r_691[@i_760])
  )
  orfind @i_759 <= NU suchthat defined(@1_x_1271[@i_759], X[@i_759], @2_r4_96[@i_759], K_u[@i_759], x5_698[@i_759], x4_699[@i_759], x3_700[@i_759], x1_702[@i_759], x2_701[@i_759], r_697[@i_759]) && otheruses(r_697[@i_759]) && ((x1_69 = x1_702[@i_759]) && ((x2_68 = x2_701[@i_759]) && ((x3_67 = X[@i_759]) && ((x4_66 = exp(g, @1_x_1271[@i_759])) && (x5_65 = K_u[@i_759]))))) then
  (
    out(c20[!_58], r_697[@i_759])
  )
  orfind @i_758 <= NU suchthat defined(@1_x_1092[@i_148[@i_758]], X[@i_758], @2_r4_84[@i_148[@i_758]], K_u[@i_758], x5_704[@i_758], x4_705[@i_758], x3_706[@i_758], x1_708[@i_758], x2_707[@i_758], r_703[@i_758]) && otheruses(r_703[@i_758]) && ((x1_69 = x1_708[@i_758]) && ((x2_68 = x2_707[@i_758]) && ((x3_67 = X[@i_758]) && ((x4_66 = exp(g, @1_x_1092[@i_148[@i_758]])) && (x5_65 = K_u[@i_758]))))) then
  (
    out(c20[!_58], r_703[@i_758])
  )
  orfind @i_757 <= NU suchthat defined(@1_x_1092[@i_148[@i_757]], X[@i_757], @2_r4_84[@i_148[@i_757]], K_u[@i_757], x5_710[@i_757], x4_711[@i_757], x3_712[@i_757], x1_714[@i_757], x2_713[@i_757], r_709[@i_757]) && otheruses(r_709[@i_757]) && ((x1_69 = x1_714[@i_757]) && ((x2_68 = x2_713[@i_757]) && ((x3_67 = X[@i_757]) && ((x4_66 = exp(g, @1_x_1092[@i_148[@i_757]])) && (x5_65 = K_u[@i_757]))))) then
  (
    out(c20[!_58], r_709[@i_757])
  )
  orfind @i_756 <= NU suchthat defined(@1_x_1271[@i_144[@i_756]], X[@i_756], @2_r4_96[@i_144[@i_756]], K_u[@i_756], x5_716[@i_756], x4_717[@i_756], x3_718[@i_756], x1_720[@i_756], x2_719[@i_756], r_715[@i_756]) && otheruses(r_715[@i_756]) && ((x1_69 = x1_720[@i_756]) && ((x2_68 = x2_719[@i_756]) && ((x3_67 = X[@i_756]) && ((x4_66 = exp(g, @1_x_1271[@i_144[@i_756]])) && (x5_65 = K_u[@i_756]))))) then
  (
    out(c20[!_58], r_715[@i_756])
  )
  orfind @i_755 <= NU suchthat defined(@1_x_1271[@i_144[@i_755]], X[@i_755], @2_r4_96[@i_144[@i_755]], K_u[@i_755], x5_722[@i_755], x4_723[@i_755], x3_724[@i_755], x1_726[@i_755], x2_725[@i_755], r_721[@i_755]) && otheruses(r_721[@i_755]) && ((x1_69 = x1_726[@i_755]) && ((x2_68 = x2_725[@i_755]) && ((x3_67 = X[@i_755]) && ((x4_66 = exp(g, @1_x_1271[@i_144[@i_755]])) && (x5_65 = K_u[@i_755]))))) then
  (
    out(c20[!_58], r_721[@i_755])
  )
  orfind @i_754 <= NU suchthat defined(X[@i_754], Yp[@i_141[@i_754]], K_u[@i_754], x5_728[@i_754], x4_729[@i_754], x3_730[@i_754], x1_732[@i_754], x2_731[@i_754], r_727[@i_754]) && otheruses(r_727[@i_754]) && ((x1_69 = x1_732[@i_754]) && ((x2_68 = x2_731[@i_754]) && ((x3_67 = X[@i_754]) && ((x4_66 = Yp[@i_141[@i_754]]) && (x5_65 = K_u[@i_754]))))) then
  (
    out(c20[!_58], r_727[@i_754])
  )
  orfind @i_753 <= NU suchthat defined(X[@i_753], Yp[@i_141[@i_753]], K_u[@i_753], x5_734[@i_753], x4_735[@i_753], x3_736[@i_753], x1_738[@i_753], x2_737[@i_753], r_733[@i_753]) && otheruses(r_733[@i_753]) && ((x1_69 = x1_738[@i_753]) && ((x2_68 = x2_737[@i_753]) && ((x3_67 = X[@i_753]) && ((x4_66 = Yp[@i_141[@i_753]]) && (x5_65 = K_u[@i_753]))))) then
  (
    out(c20[!_58], r_733[@i_753])
  )
  orfind @i_752 <= NU suchthat defined(X[@i_752], Y[@i_140[@i_752]], K_u[@i_752], x5_740[@i_752], x4_741[@i_752], x3_742[@i_752], x1_744[@i_752], x2_743[@i_752], r_739[@i_752]) && otheruses(r_739[@i_752]) && ((x1_69 = x1_744[@i_752]) && ((x2_68 = x2_743[@i_752]) && ((x3_67 = X[@i_752]) && ((x4_66 = Y[@i_140[@i_752]]) && (x5_65 = K_u[@i_752]))))) then
  (
    out(c20[!_58], r_739[@i_752])
  )
  orfind @i_751 <= NU suchthat defined(X[@i_751], Y[@i_140[@i_751]], K_u[@i_751], x5_746[@i_751], x4_747[@i_751], x3_748[@i_751], x1_750[@i_751], x2_749[@i_751], r_745[@i_751]) && otheruses(r_745[@i_751]) && ((x1_69 = x1_750[@i_751]) && ((x2_68 = x2_749[@i_751]) && ((x3_67 = X[@i_751]) && ((x4_66 = Y[@i_140[@i_751]]) && (x5_65 = K_u[@i_751]))))) then
  (
    out(c20[!_58], r_745[@i_751])
  )
  else
  (
    new r_673: hash0;
    out(c20[!_58], r_673)
  )
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  orfind @i_309 <= NP suchthat defined(yp[@i_309], xp[@i_309], Kp[@i_309], x1_259[@i_309], x2_258[@i_309], Xp[@i_309], Yp[@i_309], r_254[@i_309]) && otheruses(r_254[@i_309]) && ((x1_64 = x1_259[@i_309]) && ((x2_63 = x2_258[@i_309]) && ((x3_62 = Xp[@i_309]) && ((x4_61 = Yp[@i_309]) && (x5_60 = exp(g, mult(xp[@i_309], yp[@i_309]))))))) then
  (
    out(c21[!_59], r_254[@i_309])
  )
  orfind @i_306 <= NU suchthat defined(@1_x_1271[@i_306], x1_277[@i_306], x2_276[@i_306], X[@i_306], @2_r4_96[@i_306], K_u[@i_306], r_272[@i_306]) && otheruses(r_272[@i_306]) && ((x1_64 = x1_277[@i_306]) && ((x2_63 = x2_276[@i_306]) && ((x3_62 = X[@i_306]) && ((x4_61 = exp(g, @1_x_1271[@i_306])) && (x5_60 = K_u[@i_306]))))) then
  (
    out(c21[!_59], r_272[@i_306])
  )
  orfind @i_305 <= NU suchthat defined(@1_x_1092[@i_148[@i_305]], x1_283[@i_305], x2_282[@i_305], X[@i_305], @2_r4_84[@i_148[@i_305]], K_u[@i_305], r_278[@i_305]) && otheruses(r_278[@i_305]) && ((x1_64 = x1_283[@i_305]) && ((x2_63 = x2_282[@i_305]) && ((x3_62 = X[@i_305]) && ((x4_61 = exp(g, @1_x_1092[@i_148[@i_305]])) && (x5_60 = K_u[@i_305]))))) then
  (
    out(c21[!_59], r_278[@i_305])
  )
  orfind @i_304 <= NU suchthat defined(@1_x_1271[@i_144[@i_304]], x1_289[@i_304], x2_288[@i_304], X[@i_304], @2_r4_96[@i_144[@i_304]], K_u[@i_304], r_284[@i_304]) && otheruses(r_284[@i_304]) && ((x1_64 = x1_289[@i_304]) && ((x2_63 = x2_288[@i_304]) && ((x3_62 = X[@i_304]) && ((x4_61 = exp(g, @1_x_1271[@i_144[@i_304]])) && (x5_60 = K_u[@i_304]))))) then
  (
    out(c21[!_59], r_284[@i_304])
  )
  orfind @i_303 <= NU suchthat defined(x1_295[@i_303], x2_294[@i_303], X[@i_303], Yp[@i_141[@i_303]], K_u[@i_303], r_290[@i_303]) && otheruses(r_290[@i_303]) && ((x1_64 = x1_295[@i_303]) && ((x2_63 = x2_294[@i_303]) && ((x3_62 = X[@i_303]) && ((x4_61 = Yp[@i_141[@i_303]]) && (x5_60 = K_u[@i_303]))))) then
  (
    out(c21[!_59], r_290[@i_303])
  )
  orfind @i_302 <= NU suchthat defined(x1_301[@i_302], x2_300[@i_302], X[@i_302], Y[@i_140[@i_302]], K_u[@i_302], r_296[@i_302]) && otheruses(r_296[@i_302]) && ((x1_64 = x1_301[@i_302]) && ((x2_63 = x2_300[@i_302]) && ((x3_62 = X[@i_302]) && ((x4_61 = Y[@i_140[@i_302]]) && (x5_60 = K_u[@i_302]))))) then
  (
    out(c21[!_59], r_296[@i_302])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying SA rename K_u yields

Game 21 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_148 <= qD suchthat defined(@1_x_1092[@i_148], @2_m[@i_148], @2_kd[@i_148], @2_r4_84[@i_148]) && otheruses(@1_x_1092[@i_148]) && ((Ystar_u = @2_m[@i_148]) && (pw = @2_kd[@i_148])) then
  (
    let K_u_1530: G = exp(g, mult(@1_x_1092[@i_148], x)) in
    let x1_283: host = U in
    let x2_282: host = S in
    find [unique] @i_355 <= qH1 suchthat defined(x1_64[@i_355], x2_63[@i_355], x3_62[@i_355], x4_61[@i_355], x5_60[@i_355], r_248[@i_355]) && otheruses(r_248[@i_355]) && ((x1_283 = x1_64[@i_355]) && ((x2_282 = x2_63[@i_355]) && ((X = x3_62[@i_355]) && ((exp(g, @1_x_1092[@i_148]) = x4_61[@i_355]) && (K_u_1530 = x5_60[@i_355]))))) then
    (
      out(c6[!_53], r_248[@i_355]);
      in(c9[!_53], ());
      let x1_714: host = U in
      let x2_713: host = S in
      let x3_712: G = cst_G in
      let x4_711: G = cst_G in
      let x5_710: G = cst_G in
      find [unique] @i_841 <= qH0 suchthat defined(x1_69[@i_841], x2_68[@i_841], x3_67[@i_841], x4_66[@i_841], x5_65[@i_841], x5_674[@i_841], x4_675[@i_841], x3_676[@i_841], x2_677[@i_841], x1_678[@i_841], r_673[@i_841]) && otheruses(r_673[@i_841]) && ((x1_714 = x1_69[@i_841]) && ((x2_713 = x2_68[@i_841]) && ((X = x3_67[@i_841]) && ((exp(g, @1_x_1092[@i_148]) = x4_66[@i_841]) && (K_u_1530 = x5_65[@i_841]))))) then
      (
        let sk_u: hash0 = r_673[@i_841]
      )
      else
      (
        new r_709: hash0;
        let sk_u: hash0 = r_709
      )
    )
    else
    (
      new r_278: hash1;
      out(c6[!_53], r_278);
      in(c9[!_53], ());
      let x1_708: host = U in
      let x2_707: host = S in
      let x3_706: G = cst_G in
      let x4_705: G = cst_G in
      let x5_704: G = cst_G in
      find [unique] @i_828 <= qH0 suchthat defined(x1_69[@i_828], x2_68[@i_828], x3_67[@i_828], x4_66[@i_828], x5_65[@i_828], x5_674[@i_828], x4_675[@i_828], x3_676[@i_828], x2_677[@i_828], x1_678[@i_828], r_673[@i_828]) && otheruses(r_673[@i_828]) && ((x1_708 = x1_69[@i_828]) && ((x2_707 = x2_68[@i_828]) && ((X = x3_67[@i_828]) && ((exp(g, @1_x_1092[@i_148]) = x4_66[@i_828]) && (K_u_1530 = x5_65[@i_828]))))) then
      (
        let sk_u: hash0 = r_673[@i_828]
      )
      else
      (
        new r_703: hash0;
        let sk_u: hash0 = r_703
      )
    )
  )
  orfind @i_144 <= NU suchthat defined(@1_x_1271[@i_144], Ystar_u[@i_144], @2_r4_96[@i_144]) && otheruses(@1_x_1271[@i_144]) && (Ystar_u = Ystar_u[@i_144]) then
  (
    let K_u_1531: G = exp(g, mult(@1_x_1271[@i_144], x)) in
    let x1_289: host = U in
    let x2_288: host = S in
    find [unique] @i_364 <= qH1 suchthat defined(x1_64[@i_364], x2_63[@i_364], x3_62[@i_364], x4_61[@i_364], x5_60[@i_364], r_248[@i_364]) && otheruses(r_248[@i_364]) && ((x1_289 = x1_64[@i_364]) && ((x2_288 = x2_63[@i_364]) && ((X = x3_62[@i_364]) && ((exp(g, @1_x_1271[@i_144]) = x4_61[@i_364]) && (K_u_1531 = x5_60[@i_364]))))) then
    (
      out(c6[!_53], r_248[@i_364]);
      in(c9[!_53], ());
      let x1_726: host = U in
      let x2_725: host = S in
      let x3_724: G = cst_G in
      let x4_723: G = cst_G in
      let x5_722: G = cst_G in
      find [unique] @i_867 <= qH0 suchthat defined(x1_69[@i_867], x2_68[@i_867], x3_67[@i_867], x4_66[@i_867], x5_65[@i_867], x5_674[@i_867], x4_675[@i_867], x3_676[@i_867], x2_677[@i_867], x1_678[@i_867], r_673[@i_867]) && otheruses(r_673[@i_867]) && ((x1_726 = x1_69[@i_867]) && ((x2_725 = x2_68[@i_867]) && ((X = x3_67[@i_867]) && ((exp(g, @1_x_1271[@i_144]) = x4_66[@i_867]) && (K_u_1531 = x5_65[@i_867]))))) then
      (
        let sk_u: hash0 = r_673[@i_867]
      )
      else
      (
        new r_721: hash0;
        let sk_u: hash0 = r_721
      )
    )
    else
    (
      new r_284: hash1;
      out(c6[!_53], r_284);
      in(c9[!_53], ());
      let x1_720: host = U in
      let x2_719: host = S in
      let x3_718: G = cst_G in
      let x4_717: G = cst_G in
      let x5_716: G = cst_G in
      find [unique] @i_854 <= qH0 suchthat defined(x1_69[@i_854], x2_68[@i_854], x3_67[@i_854], x4_66[@i_854], x5_65[@i_854], x5_674[@i_854], x4_675[@i_854], x3_676[@i_854], x2_677[@i_854], x1_678[@i_854], r_673[@i_854]) && otheruses(r_673[@i_854]) && ((x1_720 = x1_69[@i_854]) && ((x2_719 = x2_68[@i_854]) && ((X = x3_67[@i_854]) && ((exp(g, @1_x_1271[@i_144]) = x4_66[@i_854]) && (K_u_1531 = x5_65[@i_854]))))) then
      (
        let sk_u: hash0 = r_673[@i_854]
      )
      else
      (
        new r_715: hash0;
        let sk_u: hash0 = r_715
      )
    )
  )
  orfind @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  orfind @i_141 <= NP suchthat defined(@2_r2_90[@i_141], yp[@i_141], Yp[@i_141]) && otheruses(@2_r2_90[@i_141]) && (Ystar_u = @2_r2_90[@i_141]) then
  (
    let K_u_1532: G = exp(g, mult(yp[@i_141], x)) in
    let x1_295: host = U in
    let x2_294: host = S in
    find [unique] @i_373 <= qH1 suchthat defined(x1_64[@i_373], x2_63[@i_373], x3_62[@i_373], x4_61[@i_373], x5_60[@i_373], r_248[@i_373]) && otheruses(r_248[@i_373]) && ((x1_295 = x1_64[@i_373]) && ((x2_294 = x2_63[@i_373]) && ((X = x3_62[@i_373]) && ((Yp[@i_141] = x4_61[@i_373]) && (K_u_1532 = x5_60[@i_373]))))) then
    (
      out(c6[!_53], r_248[@i_373]);
      in(c9[!_53], ());
      let x1_738: host = U in
      let x2_737: host = S in
      let x3_736: G = cst_G in
      let x4_735: G = cst_G in
      let x5_734: G = cst_G in
      find [unique] @i_893 <= qH0 suchthat defined(x1_69[@i_893], x2_68[@i_893], x3_67[@i_893], x4_66[@i_893], x5_65[@i_893], x5_674[@i_893], x4_675[@i_893], x3_676[@i_893], x2_677[@i_893], x1_678[@i_893], r_673[@i_893]) && otheruses(r_673[@i_893]) && ((x1_738 = x1_69[@i_893]) && ((x2_737 = x2_68[@i_893]) && ((X = x3_67[@i_893]) && ((Yp[@i_141] = x4_66[@i_893]) && (K_u_1532 = x5_65[@i_893]))))) then
      (
        let sk_u: hash0 = r_673[@i_893]
      )
      else
      (
        new r_733: hash0;
        let sk_u: hash0 = r_733
      )
    )
    else
    (
      new r_290: hash1;
      out(c6[!_53], r_290);
      in(c9[!_53], ());
      let x1_732: host = U in
      let x2_731: host = S in
      let x3_730: G = cst_G in
      let x4_729: G = cst_G in
      let x5_728: G = cst_G in
      find [unique] @i_880 <= qH0 suchthat defined(x1_69[@i_880], x2_68[@i_880], x3_67[@i_880], x4_66[@i_880], x5_65[@i_880], x5_674[@i_880], x4_675[@i_880], x3_676[@i_880], x2_677[@i_880], x1_678[@i_880], r_673[@i_880]) && otheruses(r_673[@i_880]) && ((x1_732 = x1_69[@i_880]) && ((x2_731 = x2_68[@i_880]) && ((X = x3_67[@i_880]) && ((Yp[@i_141] = x4_66[@i_880]) && (K_u_1532 = x5_65[@i_880]))))) then
      (
        let sk_u: hash0 = r_673[@i_880]
      )
      else
      (
        new r_727: hash0;
        let sk_u: hash0 = r_727
      )
    )
  )
  orfind @i_140 <= NS suchthat defined(@2_r2_93[@i_140], y[@i_140], Y[@i_140]) && otheruses(@2_r2_93[@i_140]) && (Ystar_u = @2_r2_93[@i_140]) then
  (
    let K_u_1533: G = exp(g, mult(y[@i_140], x)) in
    let x1_301: host = U in
    let x2_300: host = S in
    find [unique] @i_382 <= qH1 suchthat defined(x1_64[@i_382], x2_63[@i_382], x3_62[@i_382], x4_61[@i_382], x5_60[@i_382], r_248[@i_382]) && otheruses(r_248[@i_382]) && ((x1_301 = x1_64[@i_382]) && ((x2_300 = x2_63[@i_382]) && ((X = x3_62[@i_382]) && ((Y[@i_140] = x4_61[@i_382]) && (K_u_1533 = x5_60[@i_382]))))) then
    (
      out(c6[!_53], r_248[@i_382]);
      in(c9[!_53], ());
      let x1_750: host = U in
      let x2_749: host = S in
      let x3_748: G = cst_G in
      let x4_747: G = cst_G in
      let x5_746: G = cst_G in
      find [unique] @i_919 <= qH0 suchthat defined(x1_69[@i_919], x2_68[@i_919], x3_67[@i_919], x4_66[@i_919], x5_65[@i_919], x5_674[@i_919], x4_675[@i_919], x3_676[@i_919], x2_677[@i_919], x1_678[@i_919], r_673[@i_919]) && otheruses(r_673[@i_919]) && ((x1_750 = x1_69[@i_919]) && ((x2_749 = x2_68[@i_919]) && ((X = x3_67[@i_919]) && ((Y[@i_140] = x4_66[@i_919]) && (K_u_1533 = x5_65[@i_919]))))) then
      (
        let sk_u: hash0 = r_673[@i_919]
      )
      orfind  suchthat defined(j[@i_140], r_685[@i_140]) && otheruses(r_685[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_685[@i_140]
      )
      else
      (
        new r_745: hash0;
        let sk_u: hash0 = r_745
      )
    )
    else
    (
      new r_296: hash1;
      out(c6[!_53], r_296);
      in(c9[!_53], ());
      let x1_744: host = U in
      let x2_743: host = S in
      let x3_742: G = cst_G in
      let x4_741: G = cst_G in
      let x5_740: G = cst_G in
      find [unique] @i_906 <= qH0 suchthat defined(x1_69[@i_906], x2_68[@i_906], x3_67[@i_906], x4_66[@i_906], x5_65[@i_906], x5_674[@i_906], x4_675[@i_906], x3_676[@i_906], x2_677[@i_906], x1_678[@i_906], r_673[@i_906]) && otheruses(r_673[@i_906]) && ((x1_744 = x1_69[@i_906]) && ((x2_743 = x2_68[@i_906]) && ((X = x3_67[@i_906]) && ((Y[@i_140] = x4_66[@i_906]) && (K_u_1533 = x5_65[@i_906]))))) then
      (
        let sk_u: hash0 = r_673[@i_906]
      )
      orfind  suchthat defined(j[@i_140], r_685[@i_140]) && otheruses(r_685[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_685[@i_140]
      )
      orfind  suchthat defined(j[@i_140], r_691[@i_140]) && otheruses(r_691[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_691[@i_140]
      )
      else
      (
        new r_739: hash0;
        let sk_u: hash0 = r_739
      )
    )
  )
  else
  (
    new @1_x_1271: exponent;
    let @2_r4_96: G = cst_G in
    let K_u_1534: G = exp(g, mult(@1_x_1271, x)) in
    let x1_277: host = U in
    let x2_276: host = S in
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ());
    let x1_702: host = U in
    let x2_701: host = S in
    let x3_700: G = cst_G in
    let x4_699: G = cst_G in
    let x5_698: G = cst_G in
    find [unique] @i_815 <= qH0 suchthat defined(x1_69[@i_815], x2_68[@i_815], x3_67[@i_815], x4_66[@i_815], x5_65[@i_815], x5_674[@i_815], x4_675[@i_815], x3_676[@i_815], x2_677[@i_815], x1_678[@i_815], r_673[@i_815]) && otheruses(r_673[@i_815]) && ((x1_702 = x1_69[@i_815]) && ((x2_701 = x2_68[@i_815]) && ((X = x3_67[@i_815]) && ((exp(g, @1_x_1271) = x4_66[@i_815]) && (K_u_1534 = x5_65[@i_815]))))) then
    (
      let sk_u: hash0 = r_673[@i_815]
    )
    else
    (
      new r_697: hash0;
      let sk_u: hash0 = r_697
    )
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    let x1_271: host = U in
    let x2_270: host = S in
    find [unique] @i_337 <= qH1 suchthat defined(x1_64[@i_337], x2_63[@i_337], x3_62[@i_337], x4_61[@i_337], x5_60[@i_337], r_248[@i_337]) && otheruses(r_248[@i_337]) && ((x1_271 = x1_64[@i_337]) && ((x2_270 = x2_63[@i_337]) && ((X_s = x3_62[@i_337]) && ((Y = x4_61[@i_337]) && (exp(g, mult(x[j], y)) = x5_60[@i_337]))))) then
    (
      if (auth_s = r_248[@i_337]) then
      let x1_690: host = U in
      let x2_689: host = S in
      let x3_688: G = cst_G in
      let x4_687: G = cst_G in
      let x5_686: G = cst_G in
      find [unique] @i_789 <= qH0 suchthat defined(x1_69[@i_789], x2_68[@i_789], x3_67[@i_789], x4_66[@i_789], x5_65[@i_789], x5_674[@i_789], x4_675[@i_789], x3_676[@i_789], x2_677[@i_789], x1_678[@i_789], r_673[@i_789]) && otheruses(r_673[@i_789]) && ((x1_690 = x1_69[@i_789]) && ((x2_689 = x2_68[@i_789]) && ((X_s = x3_67[@i_789]) && ((Y = x4_66[@i_789]) && (exp(g, mult(x[j], y)) = x5_65[@i_789]))))) then
      (
        let sk_s: hash0 = r_673[@i_789]
      )
      orfind  suchthat defined(@i_140[j], r_739[j]) && otheruses(r_739[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
      (
        let sk_s: hash0 = r_739[j]
      )
      orfind  suchthat defined(@i_140[j], r_745[j]) && otheruses(r_745[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
      (
        let sk_s: hash0 = r_745[j]
      )
      else
      (
        new r_685: hash0;
        let sk_s: hash0 = r_685
      )
    )
    orfind  suchthat defined(@i_140[j], r_296[j]) && otheruses(r_296[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
    (
      if (auth_s = r_296[j]) then
      let x1_696: host = U in
      let x2_695: host = S in
      let x3_694: G = cst_G in
      let x4_693: G = cst_G in
      let x5_692: G = cst_G in
      find [unique] @i_802 <= qH0 suchthat defined(x1_69[@i_802], x2_68[@i_802], x3_67[@i_802], x4_66[@i_802], x5_65[@i_802], x5_674[@i_802], x4_675[@i_802], x3_676[@i_802], x2_677[@i_802], x1_678[@i_802], r_673[@i_802]) && otheruses(r_673[@i_802]) && ((x1_696 = x1_69[@i_802]) && ((x2_695 = x2_68[@i_802]) && ((X_s = x3_67[@i_802]) && ((Y = x4_66[@i_802]) && (exp(g, mult(x[j], y)) = x5_65[@i_802]))))) then
      (
        let sk_s: hash0 = r_673[@i_802]
      )
      orfind  suchthat defined(r_739[j]) && otheruses(r_739[j]) then
      (
        let sk_s: hash0 = r_739[j]
      )
      else
      (
        new r_691: hash0;
        let sk_s: hash0 = r_691
      )
    )
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    event Auth
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = cst_G in
  new @2_r2_90: G;
  let x1_259: host = U in
  let x2_258: host = S in
  new r_254: hash1;
  let x1_684: host = U in
  let x2_683: host = S in
  let x3_682: G = cst_G in
  let x4_681: G = cst_G in
  let x5_680: G = cst_G in
  new r_679: hash0;
  let sk_p: hash0 = r_679 in
  out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@1_x_1092[@i_118], @2_r4_84[@i_118], @2_kd[@i_118], @2_m[@i_118]) && otheruses(@1_x_1092[@i_118]) && ((@2_x = exp(g, @1_x_1092[@i_118])) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_114 <= NU suchthat defined(@1_x_1271[@i_114], @2_r4_96[@i_114], Ystar_u[@i_114]) && otheruses(@1_x_1271[@i_114]) && ((@2_x = exp(g, @1_x_1271[@i_114])) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], Ystar_u[@i_114])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = Yp[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@1_x_1092[@i_108], @2_m[@i_108], @2_kd[@i_108], @2_r4_84[@i_108]) && otheruses(@1_x_1092[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], exp(g, @1_x_1092[@i_108]))
  )
  orfind @i_104 <= NU suchthat defined(@1_x_1271[@i_104], Ystar_u[@i_104], @2_r4_96[@i_104]) && otheruses(@1_x_1271[@i_104]) && ((@2_m = Ystar_u[@i_104]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], exp(g, @1_x_1271[@i_104]))
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@2_r2_90[@i_101], Yp[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Yp[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_r2_93[@i_100], Y[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @1_x_1092: exponent;
    let @2_r4_84: G = cst_G in
    out(@2_c4[!_57], exp(g, @1_x_1092))
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  let x1_678: host = cst_host in
  let x2_677: host = cst_host in
  let x3_676: G = cst_G in
  let x4_675: G = cst_G in
  let x5_674: G = cst_G in
  find [unique] @i_763 <= qH0 suchthat defined(x1_69[@i_763], x2_68[@i_763], x3_67[@i_763], x4_66[@i_763], x5_65[@i_763], x5_674[@i_763], x4_675[@i_763], x3_676[@i_763], x2_677[@i_763], x1_678[@i_763], r_673[@i_763]) && otheruses(r_673[@i_763]) && ((x1_69 = x1_69[@i_763]) && ((x2_68 = x2_68[@i_763]) && ((x3_67 = x3_67[@i_763]) && ((x4_66 = x4_66[@i_763]) && (x5_65 = x5_65[@i_763]))))) then
  (
    out(c20[!_58], r_673[@i_763])
  )
  orfind @i_762 <= NP suchthat defined(yp[@i_762], xp[@i_762], Kp[@i_762], Xp[@i_762], Yp[@i_762], x5_680[@i_762], x4_681[@i_762], x3_682[@i_762], x1_684[@i_762], x2_683[@i_762], r_679[@i_762]) && otheruses(r_679[@i_762]) && ((x1_69 = x1_684[@i_762]) && ((x2_68 = x2_683[@i_762]) && ((x3_67 = Xp[@i_762]) && ((x4_66 = Yp[@i_762]) && (x5_65 = exp(g, mult(xp[@i_762], yp[@i_762]))))))) then
  (
    out(c20[!_58], r_679[@i_762])
  )
  orfind @i_761 <= NS suchthat defined(y[@i_761], x[j[@i_761]], K_s[@i_761], X_s[@i_761], Y[@i_761], x5_686[@i_761], x4_687[@i_761], x3_688[@i_761], x1_690[@i_761], x2_689[@i_761], r_685[@i_761]) && otheruses(r_685[@i_761]) && ((x1_69 = x1_690[@i_761]) && ((x2_68 = x2_689[@i_761]) && ((x3_67 = X_s[@i_761]) && ((x4_66 = Y[@i_761]) && (x5_65 = exp(g, mult(x[j[@i_761]], y[@i_761]))))))) then
  (
    out(c20[!_58], r_685[@i_761])
  )
  orfind @i_760 <= NS suchthat defined(y[@i_760], x[j[@i_760]], K_s[@i_760], X_s[@i_760], Y[@i_760], x5_692[@i_760], x4_693[@i_760], x3_694[@i_760], x1_696[@i_760], x2_695[@i_760], r_691[@i_760]) && otheruses(r_691[@i_760]) && ((x1_69 = x1_696[@i_760]) && ((x2_68 = x2_695[@i_760]) && ((x3_67 = X_s[@i_760]) && ((x4_66 = Y[@i_760]) && (x5_65 = exp(g, mult(x[j[@i_760]], y[@i_760]))))))) then
  (
    out(c20[!_58], r_691[@i_760])
  )
  orfind @i_759 <= NU suchthat defined(@1_x_1271[@i_759], X[@i_759], @2_r4_96[@i_759], K_u_1534[@i_759], x5_698[@i_759], x4_699[@i_759], x3_700[@i_759], x1_702[@i_759], x2_701[@i_759], r_697[@i_759]) && otheruses(r_697[@i_759]) && ((x1_69 = x1_702[@i_759]) && ((x2_68 = x2_701[@i_759]) && ((x3_67 = X[@i_759]) && ((x4_66 = exp(g, @1_x_1271[@i_759])) && (x5_65 = K_u_1534[@i_759]))))) then
  (
    out(c20[!_58], r_697[@i_759])
  )
  orfind @i_758 <= NU suchthat defined(@1_x_1092[@i_148[@i_758]], X[@i_758], @2_r4_84[@i_148[@i_758]], K_u_1530[@i_758], x5_704[@i_758], x4_705[@i_758], x3_706[@i_758], x1_708[@i_758], x2_707[@i_758], r_703[@i_758]) && otheruses(r_703[@i_758]) && ((x1_69 = x1_708[@i_758]) && ((x2_68 = x2_707[@i_758]) && ((x3_67 = X[@i_758]) && ((x4_66 = exp(g, @1_x_1092[@i_148[@i_758]])) && (x5_65 = K_u_1530[@i_758]))))) then
  (
    out(c20[!_58], r_703[@i_758])
  )
  orfind @i_757 <= NU suchthat defined(@1_x_1092[@i_148[@i_757]], X[@i_757], @2_r4_84[@i_148[@i_757]], K_u_1530[@i_757], x5_710[@i_757], x4_711[@i_757], x3_712[@i_757], x1_714[@i_757], x2_713[@i_757], r_709[@i_757]) && otheruses(r_709[@i_757]) && ((x1_69 = x1_714[@i_757]) && ((x2_68 = x2_713[@i_757]) && ((x3_67 = X[@i_757]) && ((x4_66 = exp(g, @1_x_1092[@i_148[@i_757]])) && (x5_65 = K_u_1530[@i_757]))))) then
  (
    out(c20[!_58], r_709[@i_757])
  )
  orfind @i_756 <= NU suchthat defined(@1_x_1271[@i_144[@i_756]], X[@i_756], @2_r4_96[@i_144[@i_756]], K_u_1531[@i_756], x5_716[@i_756], x4_717[@i_756], x3_718[@i_756], x1_720[@i_756], x2_719[@i_756], r_715[@i_756]) && otheruses(r_715[@i_756]) && ((x1_69 = x1_720[@i_756]) && ((x2_68 = x2_719[@i_756]) && ((x3_67 = X[@i_756]) && ((x4_66 = exp(g, @1_x_1271[@i_144[@i_756]])) && (x5_65 = K_u_1531[@i_756]))))) then
  (
    out(c20[!_58], r_715[@i_756])
  )
  orfind @i_755 <= NU suchthat defined(@1_x_1271[@i_144[@i_755]], X[@i_755], @2_r4_96[@i_144[@i_755]], K_u_1531[@i_755], x5_722[@i_755], x4_723[@i_755], x3_724[@i_755], x1_726[@i_755], x2_725[@i_755], r_721[@i_755]) && otheruses(r_721[@i_755]) && ((x1_69 = x1_726[@i_755]) && ((x2_68 = x2_725[@i_755]) && ((x3_67 = X[@i_755]) && ((x4_66 = exp(g, @1_x_1271[@i_144[@i_755]])) && (x5_65 = K_u_1531[@i_755]))))) then
  (
    out(c20[!_58], r_721[@i_755])
  )
  orfind @i_754 <= NU suchthat defined(X[@i_754], Yp[@i_141[@i_754]], K_u_1532[@i_754], x5_728[@i_754], x4_729[@i_754], x3_730[@i_754], x1_732[@i_754], x2_731[@i_754], r_727[@i_754]) && otheruses(r_727[@i_754]) && ((x1_69 = x1_732[@i_754]) && ((x2_68 = x2_731[@i_754]) && ((x3_67 = X[@i_754]) && ((x4_66 = Yp[@i_141[@i_754]]) && (x5_65 = K_u_1532[@i_754]))))) then
  (
    out(c20[!_58], r_727[@i_754])
  )
  orfind @i_753 <= NU suchthat defined(X[@i_753], Yp[@i_141[@i_753]], K_u_1532[@i_753], x5_734[@i_753], x4_735[@i_753], x3_736[@i_753], x1_738[@i_753], x2_737[@i_753], r_733[@i_753]) && otheruses(r_733[@i_753]) && ((x1_69 = x1_738[@i_753]) && ((x2_68 = x2_737[@i_753]) && ((x3_67 = X[@i_753]) && ((x4_66 = Yp[@i_141[@i_753]]) && (x5_65 = K_u_1532[@i_753]))))) then
  (
    out(c20[!_58], r_733[@i_753])
  )
  orfind @i_752 <= NU suchthat defined(X[@i_752], Y[@i_140[@i_752]], K_u_1533[@i_752], x5_740[@i_752], x4_741[@i_752], x3_742[@i_752], x1_744[@i_752], x2_743[@i_752], r_739[@i_752]) && otheruses(r_739[@i_752]) && ((x1_69 = x1_744[@i_752]) && ((x2_68 = x2_743[@i_752]) && ((x3_67 = X[@i_752]) && ((x4_66 = Y[@i_140[@i_752]]) && (x5_65 = K_u_1533[@i_752]))))) then
  (
    out(c20[!_58], r_739[@i_752])
  )
  orfind @i_751 <= NU suchthat defined(X[@i_751], Y[@i_140[@i_751]], K_u_1533[@i_751], x5_746[@i_751], x4_747[@i_751], x3_748[@i_751], x1_750[@i_751], x2_749[@i_751], r_745[@i_751]) && otheruses(r_745[@i_751]) && ((x1_69 = x1_750[@i_751]) && ((x2_68 = x2_749[@i_751]) && ((x3_67 = X[@i_751]) && ((x4_66 = Y[@i_140[@i_751]]) && (x5_65 = K_u_1533[@i_751]))))) then
  (
    out(c20[!_58], r_745[@i_751])
  )
  else
  (
    new r_673: hash0;
    out(c20[!_58], r_673)
  )
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  orfind @i_309 <= NP suchthat defined(yp[@i_309], xp[@i_309], Kp[@i_309], x1_259[@i_309], x2_258[@i_309], Xp[@i_309], Yp[@i_309], r_254[@i_309]) && otheruses(r_254[@i_309]) && ((x1_64 = x1_259[@i_309]) && ((x2_63 = x2_258[@i_309]) && ((x3_62 = Xp[@i_309]) && ((x4_61 = Yp[@i_309]) && (x5_60 = exp(g, mult(xp[@i_309], yp[@i_309]))))))) then
  (
    out(c21[!_59], r_254[@i_309])
  )
  orfind @i_306 <= NU suchthat defined(@1_x_1271[@i_306], x1_277[@i_306], x2_276[@i_306], X[@i_306], @2_r4_96[@i_306], K_u_1534[@i_306], r_272[@i_306]) && otheruses(r_272[@i_306]) && ((x1_64 = x1_277[@i_306]) && ((x2_63 = x2_276[@i_306]) && ((x3_62 = X[@i_306]) && ((x4_61 = exp(g, @1_x_1271[@i_306])) && (x5_60 = K_u_1534[@i_306]))))) then
  (
    out(c21[!_59], r_272[@i_306])
  )
  orfind @i_305 <= NU suchthat defined(@1_x_1092[@i_148[@i_305]], x1_283[@i_305], x2_282[@i_305], X[@i_305], @2_r4_84[@i_148[@i_305]], K_u_1530[@i_305], r_278[@i_305]) && otheruses(r_278[@i_305]) && ((x1_64 = x1_283[@i_305]) && ((x2_63 = x2_282[@i_305]) && ((x3_62 = X[@i_305]) && ((x4_61 = exp(g, @1_x_1092[@i_148[@i_305]])) && (x5_60 = K_u_1530[@i_305]))))) then
  (
    out(c21[!_59], r_278[@i_305])
  )
  orfind @i_304 <= NU suchthat defined(@1_x_1271[@i_144[@i_304]], x1_289[@i_304], x2_288[@i_304], X[@i_304], @2_r4_96[@i_144[@i_304]], K_u_1531[@i_304], r_284[@i_304]) && otheruses(r_284[@i_304]) && ((x1_64 = x1_289[@i_304]) && ((x2_63 = x2_288[@i_304]) && ((x3_62 = X[@i_304]) && ((x4_61 = exp(g, @1_x_1271[@i_144[@i_304]])) && (x5_60 = K_u_1531[@i_304]))))) then
  (
    out(c21[!_59], r_284[@i_304])
  )
  orfind @i_303 <= NU suchthat defined(x1_295[@i_303], x2_294[@i_303], X[@i_303], Yp[@i_141[@i_303]], K_u_1532[@i_303], r_290[@i_303]) && otheruses(r_290[@i_303]) && ((x1_64 = x1_295[@i_303]) && ((x2_63 = x2_294[@i_303]) && ((x3_62 = X[@i_303]) && ((x4_61 = Yp[@i_141[@i_303]]) && (x5_60 = K_u_1532[@i_303]))))) then
  (
    out(c21[!_59], r_290[@i_303])
  )
  orfind @i_302 <= NU suchthat defined(x1_301[@i_302], x2_300[@i_302], X[@i_302], Y[@i_140[@i_302]], K_u_1533[@i_302], r_296[@i_302]) && otheruses(r_296[@i_302]) && ((x1_64 = x1_301[@i_302]) && ((x2_63 = x2_300[@i_302]) && ((x3_62 = X[@i_302]) && ((x4_61 = Y[@i_140[@i_302]]) && (x5_60 = K_u_1533[@i_302]))))) then
  (
    out(c21[!_59], r_296[@i_302])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying remove assignments of useless yields

Game 22 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_148 <= qD suchthat defined(@1_x_1092[@i_148], @2_m[@i_148], @2_kd[@i_148], @2_r4_84[@i_148]) && otheruses(@1_x_1092[@i_148]) && ((Ystar_u = @2_m[@i_148]) && (pw = @2_kd[@i_148])) then
  (
    let K_u_1530: G = exp(g, mult(@1_x_1092[@i_148], x)) in
    let x1_283: host = U in
    let x2_282: host = S in
    find [unique] @i_355 <= qH1 suchthat defined(x1_64[@i_355], x2_63[@i_355], x3_62[@i_355], x4_61[@i_355], x5_60[@i_355], r_248[@i_355]) && otheruses(r_248[@i_355]) && ((x1_283 = x1_64[@i_355]) && ((x2_282 = x2_63[@i_355]) && ((X = x3_62[@i_355]) && ((exp(g, @1_x_1092[@i_148]) = x4_61[@i_355]) && (K_u_1530 = x5_60[@i_355]))))) then
    (
      out(c6[!_53], r_248[@i_355]);
      in(c9[!_53], ());
      let x1_714: host = U in
      let x2_713: host = S in
      let x3_712: G = cst_G in
      let x4_711: G = cst_G in
      let x5_710: G = cst_G in
      find [unique] @i_841 <= qH0 suchthat defined(x1_69[@i_841], x2_68[@i_841], x3_67[@i_841], x4_66[@i_841], x5_65[@i_841], x5_674[@i_841], x4_675[@i_841], x3_676[@i_841], x2_677[@i_841], x1_678[@i_841], r_673[@i_841]) && otheruses(r_673[@i_841]) && ((x1_714 = x1_69[@i_841]) && ((x2_713 = x2_68[@i_841]) && ((X = x3_67[@i_841]) && ((exp(g, @1_x_1092[@i_148]) = x4_66[@i_841]) && (K_u_1530 = x5_65[@i_841]))))) then
      (
        let sk_u: hash0 = r_673[@i_841]
      )
      else
      (
        new r_709: hash0;
        let sk_u: hash0 = r_709
      )
    )
    else
    (
      new r_278: hash1;
      out(c6[!_53], r_278);
      in(c9[!_53], ());
      let x1_708: host = U in
      let x2_707: host = S in
      let x3_706: G = cst_G in
      let x4_705: G = cst_G in
      let x5_704: G = cst_G in
      find [unique] @i_828 <= qH0 suchthat defined(x1_69[@i_828], x2_68[@i_828], x3_67[@i_828], x4_66[@i_828], x5_65[@i_828], x5_674[@i_828], x4_675[@i_828], x3_676[@i_828], x2_677[@i_828], x1_678[@i_828], r_673[@i_828]) && otheruses(r_673[@i_828]) && ((x1_708 = x1_69[@i_828]) && ((x2_707 = x2_68[@i_828]) && ((X = x3_67[@i_828]) && ((exp(g, @1_x_1092[@i_148]) = x4_66[@i_828]) && (K_u_1530 = x5_65[@i_828]))))) then
      (
        let sk_u: hash0 = r_673[@i_828]
      )
      else
      (
        new r_703: hash0;
        let sk_u: hash0 = r_703
      )
    )
  )
  orfind @i_144 <= NU suchthat defined(@1_x_1271[@i_144], Ystar_u[@i_144], @2_r4_96[@i_144]) && otheruses(@1_x_1271[@i_144]) && (Ystar_u = Ystar_u[@i_144]) then
  (
    let K_u_1531: G = exp(g, mult(@1_x_1271[@i_144], x)) in
    let x1_289: host = U in
    let x2_288: host = S in
    find [unique] @i_364 <= qH1 suchthat defined(x1_64[@i_364], x2_63[@i_364], x3_62[@i_364], x4_61[@i_364], x5_60[@i_364], r_248[@i_364]) && otheruses(r_248[@i_364]) && ((x1_289 = x1_64[@i_364]) && ((x2_288 = x2_63[@i_364]) && ((X = x3_62[@i_364]) && ((exp(g, @1_x_1271[@i_144]) = x4_61[@i_364]) && (K_u_1531 = x5_60[@i_364]))))) then
    (
      out(c6[!_53], r_248[@i_364]);
      in(c9[!_53], ());
      let x1_726: host = U in
      let x2_725: host = S in
      let x3_724: G = cst_G in
      let x4_723: G = cst_G in
      let x5_722: G = cst_G in
      find [unique] @i_867 <= qH0 suchthat defined(x1_69[@i_867], x2_68[@i_867], x3_67[@i_867], x4_66[@i_867], x5_65[@i_867], x5_674[@i_867], x4_675[@i_867], x3_676[@i_867], x2_677[@i_867], x1_678[@i_867], r_673[@i_867]) && otheruses(r_673[@i_867]) && ((x1_726 = x1_69[@i_867]) && ((x2_725 = x2_68[@i_867]) && ((X = x3_67[@i_867]) && ((exp(g, @1_x_1271[@i_144]) = x4_66[@i_867]) && (K_u_1531 = x5_65[@i_867]))))) then
      (
        let sk_u: hash0 = r_673[@i_867]
      )
      else
      (
        new r_721: hash0;
        let sk_u: hash0 = r_721
      )
    )
    else
    (
      new r_284: hash1;
      out(c6[!_53], r_284);
      in(c9[!_53], ());
      let x1_720: host = U in
      let x2_719: host = S in
      let x3_718: G = cst_G in
      let x4_717: G = cst_G in
      let x5_716: G = cst_G in
      find [unique] @i_854 <= qH0 suchthat defined(x1_69[@i_854], x2_68[@i_854], x3_67[@i_854], x4_66[@i_854], x5_65[@i_854], x5_674[@i_854], x4_675[@i_854], x3_676[@i_854], x2_677[@i_854], x1_678[@i_854], r_673[@i_854]) && otheruses(r_673[@i_854]) && ((x1_720 = x1_69[@i_854]) && ((x2_719 = x2_68[@i_854]) && ((X = x3_67[@i_854]) && ((exp(g, @1_x_1271[@i_144]) = x4_66[@i_854]) && (K_u_1531 = x5_65[@i_854]))))) then
      (
        let sk_u: hash0 = r_673[@i_854]
      )
      else
      (
        new r_715: hash0;
        let sk_u: hash0 = r_715
      )
    )
  )
  orfind @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  orfind @i_141 <= NP suchthat defined(@2_r2_90[@i_141], yp[@i_141], Yp[@i_141]) && otheruses(@2_r2_90[@i_141]) && (Ystar_u = @2_r2_90[@i_141]) then
  (
    let K_u_1532: G = exp(g, mult(yp[@i_141], x)) in
    let x1_295: host = U in
    let x2_294: host = S in
    find [unique] @i_373 <= qH1 suchthat defined(x1_64[@i_373], x2_63[@i_373], x3_62[@i_373], x4_61[@i_373], x5_60[@i_373], r_248[@i_373]) && otheruses(r_248[@i_373]) && ((x1_295 = x1_64[@i_373]) && ((x2_294 = x2_63[@i_373]) && ((X = x3_62[@i_373]) && ((Yp[@i_141] = x4_61[@i_373]) && (K_u_1532 = x5_60[@i_373]))))) then
    (
      out(c6[!_53], r_248[@i_373]);
      in(c9[!_53], ());
      let x1_738: host = U in
      let x2_737: host = S in
      let x3_736: G = cst_G in
      let x4_735: G = cst_G in
      let x5_734: G = cst_G in
      find [unique] @i_893 <= qH0 suchthat defined(x1_69[@i_893], x2_68[@i_893], x3_67[@i_893], x4_66[@i_893], x5_65[@i_893], x5_674[@i_893], x4_675[@i_893], x3_676[@i_893], x2_677[@i_893], x1_678[@i_893], r_673[@i_893]) && otheruses(r_673[@i_893]) && ((x1_738 = x1_69[@i_893]) && ((x2_737 = x2_68[@i_893]) && ((X = x3_67[@i_893]) && ((Yp[@i_141] = x4_66[@i_893]) && (K_u_1532 = x5_65[@i_893]))))) then
      (
        let sk_u: hash0 = r_673[@i_893]
      )
      else
      (
        new r_733: hash0;
        let sk_u: hash0 = r_733
      )
    )
    else
    (
      new r_290: hash1;
      out(c6[!_53], r_290);
      in(c9[!_53], ());
      let x1_732: host = U in
      let x2_731: host = S in
      let x3_730: G = cst_G in
      let x4_729: G = cst_G in
      let x5_728: G = cst_G in
      find [unique] @i_880 <= qH0 suchthat defined(x1_69[@i_880], x2_68[@i_880], x3_67[@i_880], x4_66[@i_880], x5_65[@i_880], x5_674[@i_880], x4_675[@i_880], x3_676[@i_880], x2_677[@i_880], x1_678[@i_880], r_673[@i_880]) && otheruses(r_673[@i_880]) && ((x1_732 = x1_69[@i_880]) && ((x2_731 = x2_68[@i_880]) && ((X = x3_67[@i_880]) && ((Yp[@i_141] = x4_66[@i_880]) && (K_u_1532 = x5_65[@i_880]))))) then
      (
        let sk_u: hash0 = r_673[@i_880]
      )
      else
      (
        new r_727: hash0;
        let sk_u: hash0 = r_727
      )
    )
  )
  orfind @i_140 <= NS suchthat defined(@2_r2_93[@i_140], y[@i_140], Y[@i_140]) && otheruses(@2_r2_93[@i_140]) && (Ystar_u = @2_r2_93[@i_140]) then
  (
    let K_u_1533: G = exp(g, mult(y[@i_140], x)) in
    let x1_301: host = U in
    let x2_300: host = S in
    find [unique] @i_382 <= qH1 suchthat defined(x1_64[@i_382], x2_63[@i_382], x3_62[@i_382], x4_61[@i_382], x5_60[@i_382], r_248[@i_382]) && otheruses(r_248[@i_382]) && ((x1_301 = x1_64[@i_382]) && ((x2_300 = x2_63[@i_382]) && ((X = x3_62[@i_382]) && ((Y[@i_140] = x4_61[@i_382]) && (K_u_1533 = x5_60[@i_382]))))) then
    (
      out(c6[!_53], r_248[@i_382]);
      in(c9[!_53], ());
      let x1_750: host = U in
      let x2_749: host = S in
      let x3_748: G = cst_G in
      let x4_747: G = cst_G in
      let x5_746: G = cst_G in
      find [unique] @i_919 <= qH0 suchthat defined(x1_69[@i_919], x2_68[@i_919], x3_67[@i_919], x4_66[@i_919], x5_65[@i_919], x5_674[@i_919], x4_675[@i_919], x3_676[@i_919], x2_677[@i_919], x1_678[@i_919], r_673[@i_919]) && otheruses(r_673[@i_919]) && ((x1_750 = x1_69[@i_919]) && ((x2_749 = x2_68[@i_919]) && ((X = x3_67[@i_919]) && ((Y[@i_140] = x4_66[@i_919]) && (K_u_1533 = x5_65[@i_919]))))) then
      (
        let sk_u: hash0 = r_673[@i_919]
      )
      orfind  suchthat defined(j[@i_140], r_685[@i_140]) && otheruses(r_685[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_685[@i_140]
      )
      else
      (
        new r_745: hash0;
        let sk_u: hash0 = r_745
      )
    )
    else
    (
      new r_296: hash1;
      out(c6[!_53], r_296);
      in(c9[!_53], ());
      let x1_744: host = U in
      let x2_743: host = S in
      let x3_742: G = cst_G in
      let x4_741: G = cst_G in
      let x5_740: G = cst_G in
      find [unique] @i_906 <= qH0 suchthat defined(x1_69[@i_906], x2_68[@i_906], x3_67[@i_906], x4_66[@i_906], x5_65[@i_906], x5_674[@i_906], x4_675[@i_906], x3_676[@i_906], x2_677[@i_906], x1_678[@i_906], r_673[@i_906]) && otheruses(r_673[@i_906]) && ((x1_744 = x1_69[@i_906]) && ((x2_743 = x2_68[@i_906]) && ((X = x3_67[@i_906]) && ((Y[@i_140] = x4_66[@i_906]) && (K_u_1533 = x5_65[@i_906]))))) then
      (
        let sk_u: hash0 = r_673[@i_906]
      )
      orfind  suchthat defined(j[@i_140], r_685[@i_140]) && otheruses(r_685[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_685[@i_140]
      )
      orfind  suchthat defined(j[@i_140], r_691[@i_140]) && otheruses(r_691[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_691[@i_140]
      )
      else
      (
        new r_739: hash0;
        let sk_u: hash0 = r_739
      )
    )
  )
  else
  (
    new @1_x_1271: exponent;
    let @2_r4_96: G = cst_G in
    let K_u_1534: G = exp(g, mult(@1_x_1271, x)) in
    let x1_277: host = U in
    let x2_276: host = S in
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ());
    let x1_702: host = U in
    let x2_701: host = S in
    let x3_700: G = cst_G in
    let x4_699: G = cst_G in
    let x5_698: G = cst_G in
    find [unique] @i_815 <= qH0 suchthat defined(x1_69[@i_815], x2_68[@i_815], x3_67[@i_815], x4_66[@i_815], x5_65[@i_815], x5_674[@i_815], x4_675[@i_815], x3_676[@i_815], x2_677[@i_815], x1_678[@i_815], r_673[@i_815]) && otheruses(r_673[@i_815]) && ((x1_702 = x1_69[@i_815]) && ((x2_701 = x2_68[@i_815]) && ((X = x3_67[@i_815]) && ((exp(g, @1_x_1271) = x4_66[@i_815]) && (K_u_1534 = x5_65[@i_815]))))) then
    (
      let sk_u: hash0 = r_673[@i_815]
    )
    else
    (
      new r_697: hash0;
      let sk_u: hash0 = r_697
    )
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    let x1_271: host = U in
    let x2_270: host = S in
    find [unique] @i_337 <= qH1 suchthat defined(x1_64[@i_337], x2_63[@i_337], x3_62[@i_337], x4_61[@i_337], x5_60[@i_337], r_248[@i_337]) && otheruses(r_248[@i_337]) && ((x1_271 = x1_64[@i_337]) && ((x2_270 = x2_63[@i_337]) && ((X_s = x3_62[@i_337]) && ((Y = x4_61[@i_337]) && (exp(g, mult(x[j], y)) = x5_60[@i_337]))))) then
    (
      if (auth_s = r_248[@i_337]) then
      let x1_690: host = U in
      let x2_689: host = S in
      let x3_688: G = cst_G in
      let x4_687: G = cst_G in
      let x5_686: G = cst_G in
      find [unique] @i_789 <= qH0 suchthat defined(x1_69[@i_789], x2_68[@i_789], x3_67[@i_789], x4_66[@i_789], x5_65[@i_789], x5_674[@i_789], x4_675[@i_789], x3_676[@i_789], x2_677[@i_789], x1_678[@i_789], r_673[@i_789]) && otheruses(r_673[@i_789]) && ((x1_690 = x1_69[@i_789]) && ((x2_689 = x2_68[@i_789]) && ((X_s = x3_67[@i_789]) && ((Y = x4_66[@i_789]) && (exp(g, mult(x[j], y)) = x5_65[@i_789]))))) then
      (
        let sk_s: hash0 = r_673[@i_789]
      )
      orfind  suchthat defined(@i_140[j], r_739[j]) && otheruses(r_739[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
      (
        let sk_s: hash0 = r_739[j]
      )
      orfind  suchthat defined(@i_140[j], r_745[j]) && otheruses(r_745[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
      (
        let sk_s: hash0 = r_745[j]
      )
      else
      (
        new r_685: hash0;
        let sk_s: hash0 = r_685
      )
    )
    orfind  suchthat defined(@i_140[j], r_296[j]) && otheruses(r_296[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
    (
      if (auth_s = r_296[j]) then
      let x1_696: host = U in
      let x2_695: host = S in
      let x3_694: G = cst_G in
      let x4_693: G = cst_G in
      let x5_692: G = cst_G in
      find [unique] @i_802 <= qH0 suchthat defined(x1_69[@i_802], x2_68[@i_802], x3_67[@i_802], x4_66[@i_802], x5_65[@i_802], x5_674[@i_802], x4_675[@i_802], x3_676[@i_802], x2_677[@i_802], x1_678[@i_802], r_673[@i_802]) && otheruses(r_673[@i_802]) && ((x1_696 = x1_69[@i_802]) && ((x2_695 = x2_68[@i_802]) && ((X_s = x3_67[@i_802]) && ((Y = x4_66[@i_802]) && (exp(g, mult(x[j], y)) = x5_65[@i_802]))))) then
      (
        let sk_s: hash0 = r_673[@i_802]
      )
      orfind  suchthat defined(r_739[j]) && otheruses(r_739[j]) then
      (
        let sk_s: hash0 = r_739[j]
      )
      else
      (
        new r_691: hash0;
        let sk_s: hash0 = r_691
      )
    )
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    event Auth
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = cst_G in
  new @2_r2_90: G;
  let x1_259: host = U in
  let x2_258: host = S in
  new r_254: hash1;
  let x1_684: host = U in
  let x2_683: host = S in
  let x3_682: G = cst_G in
  let x4_681: G = cst_G in
  let x5_680: G = cst_G in
  new r_679: hash0;
  let sk_p: hash0 = r_679 in
  out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@1_x_1092[@i_118], @2_r4_84[@i_118], @2_kd[@i_118], @2_m[@i_118]) && otheruses(@1_x_1092[@i_118]) && ((@2_x = exp(g, @1_x_1092[@i_118])) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_114 <= NU suchthat defined(@1_x_1271[@i_114], @2_r4_96[@i_114], Ystar_u[@i_114]) && otheruses(@1_x_1271[@i_114]) && ((@2_x = exp(g, @1_x_1271[@i_114])) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], Ystar_u[@i_114])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = Yp[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@1_x_1092[@i_108], @2_m[@i_108], @2_kd[@i_108], @2_r4_84[@i_108]) && otheruses(@1_x_1092[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], exp(g, @1_x_1092[@i_108]))
  )
  orfind @i_104 <= NU suchthat defined(@1_x_1271[@i_104], Ystar_u[@i_104], @2_r4_96[@i_104]) && otheruses(@1_x_1271[@i_104]) && ((@2_m = Ystar_u[@i_104]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], exp(g, @1_x_1271[@i_104]))
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@2_r2_90[@i_101], Yp[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Yp[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_r2_93[@i_100], Y[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @1_x_1092: exponent;
    let @2_r4_84: G = cst_G in
    out(@2_c4[!_57], exp(g, @1_x_1092))
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  let x1_678: host = cst_host in
  let x2_677: host = cst_host in
  let x3_676: G = cst_G in
  let x4_675: G = cst_G in
  let x5_674: G = cst_G in
  find [unique] @i_763 <= qH0 suchthat defined(x1_69[@i_763], x2_68[@i_763], x3_67[@i_763], x4_66[@i_763], x5_65[@i_763], x5_674[@i_763], x4_675[@i_763], x3_676[@i_763], x2_677[@i_763], x1_678[@i_763], r_673[@i_763]) && otheruses(r_673[@i_763]) && ((x1_69 = x1_69[@i_763]) && ((x2_68 = x2_68[@i_763]) && ((x3_67 = x3_67[@i_763]) && ((x4_66 = x4_66[@i_763]) && (x5_65 = x5_65[@i_763]))))) then
  (
    out(c20[!_58], r_673[@i_763])
  )
  orfind @i_762 <= NP suchthat defined(yp[@i_762], xp[@i_762], Kp[@i_762], Xp[@i_762], Yp[@i_762], x5_680[@i_762], x4_681[@i_762], x3_682[@i_762], x1_684[@i_762], x2_683[@i_762], r_679[@i_762]) && otheruses(r_679[@i_762]) && ((x1_69 = x1_684[@i_762]) && ((x2_68 = x2_683[@i_762]) && ((x3_67 = Xp[@i_762]) && ((x4_66 = Yp[@i_762]) && (x5_65 = exp(g, mult(xp[@i_762], yp[@i_762]))))))) then
  (
    out(c20[!_58], r_679[@i_762])
  )
  orfind @i_761 <= NS suchthat defined(y[@i_761], x[j[@i_761]], K_s[@i_761], X_s[@i_761], Y[@i_761], x5_686[@i_761], x4_687[@i_761], x3_688[@i_761], x1_690[@i_761], x2_689[@i_761], r_685[@i_761]) && otheruses(r_685[@i_761]) && ((x1_69 = x1_690[@i_761]) && ((x2_68 = x2_689[@i_761]) && ((x3_67 = X_s[@i_761]) && ((x4_66 = Y[@i_761]) && (x5_65 = exp(g, mult(x[j[@i_761]], y[@i_761]))))))) then
  (
    out(c20[!_58], r_685[@i_761])
  )
  orfind @i_760 <= NS suchthat defined(y[@i_760], x[j[@i_760]], K_s[@i_760], X_s[@i_760], Y[@i_760], x5_692[@i_760], x4_693[@i_760], x3_694[@i_760], x1_696[@i_760], x2_695[@i_760], r_691[@i_760]) && otheruses(r_691[@i_760]) && ((x1_69 = x1_696[@i_760]) && ((x2_68 = x2_695[@i_760]) && ((x3_67 = X_s[@i_760]) && ((x4_66 = Y[@i_760]) && (x5_65 = exp(g, mult(x[j[@i_760]], y[@i_760]))))))) then
  (
    out(c20[!_58], r_691[@i_760])
  )
  orfind @i_759 <= NU suchthat defined(@1_x_1271[@i_759], X[@i_759], @2_r4_96[@i_759], K_u_1534[@i_759], x5_698[@i_759], x4_699[@i_759], x3_700[@i_759], x1_702[@i_759], x2_701[@i_759], r_697[@i_759]) && otheruses(r_697[@i_759]) && ((x1_69 = x1_702[@i_759]) && ((x2_68 = x2_701[@i_759]) && ((x3_67 = X[@i_759]) && ((x4_66 = exp(g, @1_x_1271[@i_759])) && (x5_65 = K_u_1534[@i_759]))))) then
  (
    out(c20[!_58], r_697[@i_759])
  )
  orfind @i_758 <= NU suchthat defined(@1_x_1092[@i_148[@i_758]], X[@i_758], @2_r4_84[@i_148[@i_758]], K_u_1530[@i_758], x5_704[@i_758], x4_705[@i_758], x3_706[@i_758], x1_708[@i_758], x2_707[@i_758], r_703[@i_758]) && otheruses(r_703[@i_758]) && ((x1_69 = x1_708[@i_758]) && ((x2_68 = x2_707[@i_758]) && ((x3_67 = X[@i_758]) && ((x4_66 = exp(g, @1_x_1092[@i_148[@i_758]])) && (x5_65 = K_u_1530[@i_758]))))) then
  (
    out(c20[!_58], r_703[@i_758])
  )
  orfind @i_757 <= NU suchthat defined(@1_x_1092[@i_148[@i_757]], X[@i_757], @2_r4_84[@i_148[@i_757]], K_u_1530[@i_757], x5_710[@i_757], x4_711[@i_757], x3_712[@i_757], x1_714[@i_757], x2_713[@i_757], r_709[@i_757]) && otheruses(r_709[@i_757]) && ((x1_69 = x1_714[@i_757]) && ((x2_68 = x2_713[@i_757]) && ((x3_67 = X[@i_757]) && ((x4_66 = exp(g, @1_x_1092[@i_148[@i_757]])) && (x5_65 = K_u_1530[@i_757]))))) then
  (
    out(c20[!_58], r_709[@i_757])
  )
  orfind @i_756 <= NU suchthat defined(@1_x_1271[@i_144[@i_756]], X[@i_756], @2_r4_96[@i_144[@i_756]], K_u_1531[@i_756], x5_716[@i_756], x4_717[@i_756], x3_718[@i_756], x1_720[@i_756], x2_719[@i_756], r_715[@i_756]) && otheruses(r_715[@i_756]) && ((x1_69 = x1_720[@i_756]) && ((x2_68 = x2_719[@i_756]) && ((x3_67 = X[@i_756]) && ((x4_66 = exp(g, @1_x_1271[@i_144[@i_756]])) && (x5_65 = K_u_1531[@i_756]))))) then
  (
    out(c20[!_58], r_715[@i_756])
  )
  orfind @i_755 <= NU suchthat defined(@1_x_1271[@i_144[@i_755]], X[@i_755], @2_r4_96[@i_144[@i_755]], K_u_1531[@i_755], x5_722[@i_755], x4_723[@i_755], x3_724[@i_755], x1_726[@i_755], x2_725[@i_755], r_721[@i_755]) && otheruses(r_721[@i_755]) && ((x1_69 = x1_726[@i_755]) && ((x2_68 = x2_725[@i_755]) && ((x3_67 = X[@i_755]) && ((x4_66 = exp(g, @1_x_1271[@i_144[@i_755]])) && (x5_65 = K_u_1531[@i_755]))))) then
  (
    out(c20[!_58], r_721[@i_755])
  )
  orfind @i_754 <= NU suchthat defined(X[@i_754], Yp[@i_141[@i_754]], K_u_1532[@i_754], x5_728[@i_754], x4_729[@i_754], x3_730[@i_754], x1_732[@i_754], x2_731[@i_754], r_727[@i_754]) && otheruses(r_727[@i_754]) && ((x1_69 = x1_732[@i_754]) && ((x2_68 = x2_731[@i_754]) && ((x3_67 = X[@i_754]) && ((x4_66 = Yp[@i_141[@i_754]]) && (x5_65 = K_u_1532[@i_754]))))) then
  (
    out(c20[!_58], r_727[@i_754])
  )
  orfind @i_753 <= NU suchthat defined(X[@i_753], Yp[@i_141[@i_753]], K_u_1532[@i_753], x5_734[@i_753], x4_735[@i_753], x3_736[@i_753], x1_738[@i_753], x2_737[@i_753], r_733[@i_753]) && otheruses(r_733[@i_753]) && ((x1_69 = x1_738[@i_753]) && ((x2_68 = x2_737[@i_753]) && ((x3_67 = X[@i_753]) && ((x4_66 = Yp[@i_141[@i_753]]) && (x5_65 = K_u_1532[@i_753]))))) then
  (
    out(c20[!_58], r_733[@i_753])
  )
  orfind @i_752 <= NU suchthat defined(X[@i_752], Y[@i_140[@i_752]], K_u_1533[@i_752], x5_740[@i_752], x4_741[@i_752], x3_742[@i_752], x1_744[@i_752], x2_743[@i_752], r_739[@i_752]) && otheruses(r_739[@i_752]) && ((x1_69 = x1_744[@i_752]) && ((x2_68 = x2_743[@i_752]) && ((x3_67 = X[@i_752]) && ((x4_66 = Y[@i_140[@i_752]]) && (x5_65 = K_u_1533[@i_752]))))) then
  (
    out(c20[!_58], r_739[@i_752])
  )
  orfind @i_751 <= NU suchthat defined(X[@i_751], Y[@i_140[@i_751]], K_u_1533[@i_751], x5_746[@i_751], x4_747[@i_751], x3_748[@i_751], x1_750[@i_751], x2_749[@i_751], r_745[@i_751]) && otheruses(r_745[@i_751]) && ((x1_69 = x1_750[@i_751]) && ((x2_68 = x2_749[@i_751]) && ((x3_67 = X[@i_751]) && ((x4_66 = Y[@i_140[@i_751]]) && (x5_65 = K_u_1533[@i_751]))))) then
  (
    out(c20[!_58], r_745[@i_751])
  )
  else
  (
    new r_673: hash0;
    out(c20[!_58], r_673)
  )
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  orfind @i_309 <= NP suchthat defined(yp[@i_309], xp[@i_309], Kp[@i_309], x1_259[@i_309], x2_258[@i_309], Xp[@i_309], Yp[@i_309], r_254[@i_309]) && otheruses(r_254[@i_309]) && ((x1_64 = x1_259[@i_309]) && ((x2_63 = x2_258[@i_309]) && ((x3_62 = Xp[@i_309]) && ((x4_61 = Yp[@i_309]) && (x5_60 = exp(g, mult(xp[@i_309], yp[@i_309]))))))) then
  (
    out(c21[!_59], r_254[@i_309])
  )
  orfind @i_306 <= NU suchthat defined(@1_x_1271[@i_306], x1_277[@i_306], x2_276[@i_306], X[@i_306], @2_r4_96[@i_306], K_u_1534[@i_306], r_272[@i_306]) && otheruses(r_272[@i_306]) && ((x1_64 = x1_277[@i_306]) && ((x2_63 = x2_276[@i_306]) && ((x3_62 = X[@i_306]) && ((x4_61 = exp(g, @1_x_1271[@i_306])) && (x5_60 = K_u_1534[@i_306]))))) then
  (
    out(c21[!_59], r_272[@i_306])
  )
  orfind @i_305 <= NU suchthat defined(@1_x_1092[@i_148[@i_305]], x1_283[@i_305], x2_282[@i_305], X[@i_305], @2_r4_84[@i_148[@i_305]], K_u_1530[@i_305], r_278[@i_305]) && otheruses(r_278[@i_305]) && ((x1_64 = x1_283[@i_305]) && ((x2_63 = x2_282[@i_305]) && ((x3_62 = X[@i_305]) && ((x4_61 = exp(g, @1_x_1092[@i_148[@i_305]])) && (x5_60 = K_u_1530[@i_305]))))) then
  (
    out(c21[!_59], r_278[@i_305])
  )
  orfind @i_304 <= NU suchthat defined(@1_x_1271[@i_144[@i_304]], x1_289[@i_304], x2_288[@i_304], X[@i_304], @2_r4_96[@i_144[@i_304]], K_u_1531[@i_304], r_284[@i_304]) && otheruses(r_284[@i_304]) && ((x1_64 = x1_289[@i_304]) && ((x2_63 = x2_288[@i_304]) && ((x3_62 = X[@i_304]) && ((x4_61 = exp(g, @1_x_1271[@i_144[@i_304]])) && (x5_60 = K_u_1531[@i_304]))))) then
  (
    out(c21[!_59], r_284[@i_304])
  )
  orfind @i_303 <= NU suchthat defined(x1_295[@i_303], x2_294[@i_303], X[@i_303], Yp[@i_141[@i_303]], K_u_1532[@i_303], r_290[@i_303]) && otheruses(r_290[@i_303]) && ((x1_64 = x1_295[@i_303]) && ((x2_63 = x2_294[@i_303]) && ((x3_62 = X[@i_303]) && ((x4_61 = Yp[@i_141[@i_303]]) && (x5_60 = K_u_1532[@i_303]))))) then
  (
    out(c21[!_59], r_290[@i_303])
  )
  orfind @i_302 <= NU suchthat defined(x1_301[@i_302], x2_300[@i_302], X[@i_302], Y[@i_140[@i_302]], K_u_1533[@i_302], r_296[@i_302]) && otheruses(r_296[@i_302]) && ((x1_64 = x1_301[@i_302]) && ((x2_63 = x2_300[@i_302]) && ((x3_62 = X[@i_302]) && ((x4_61 = Y[@i_140[@i_302]]) && (x5_60 = K_u_1533[@i_302]))))) then
  (
    out(c21[!_59], r_296[@i_302])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying simplify yields

Game 23 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_148 <= qD suchthat defined(@2_m[@i_148], @2_kd[@i_148], @1_x_1092[@i_148], @2_r4_84[@i_148]) && otheruses(@1_x_1092[@i_148]) && ((Ystar_u = @2_m[@i_148]) && (pw = @2_kd[@i_148])) then
  (
    let K_u_1530: G = exp(g, mult(@1_x_1092[@i_148], x)) in
    let x1_283: host = U in
    let x2_282: host = S in
    find [unique] @i_355 <= qH1 suchthat defined(x1_64[@i_355], x2_63[@i_355], x3_62[@i_355], x4_61[@i_355], x5_60[@i_355], r_248[@i_355]) && otheruses(r_248[@i_355]) && ((x1_283 = x1_64[@i_355]) && ((x2_282 = x2_63[@i_355]) && ((X = x3_62[@i_355]) && ((exp(g, @1_x_1092[@i_148]) = x4_61[@i_355]) && (K_u_1530 = x5_60[@i_355]))))) then
    (
      out(c6[!_53], r_248[@i_355]);
      in(c9[!_53], ());
      let x1_714: host = U in
      let x2_713: host = S in
      let x3_712: G = cst_G in
      let x4_711: G = cst_G in
      let x5_710: G = cst_G in
      find [unique] @i_841 <= qH0 suchthat defined(x1_69[@i_841], x2_68[@i_841], x3_67[@i_841], x4_66[@i_841], x5_65[@i_841], r_673[@i_841]) && otheruses(r_673[@i_841]) && ((x1_714 = x1_69[@i_841]) && ((x2_713 = x2_68[@i_841]) && ((X = x3_67[@i_841]) && ((exp(g, @1_x_1092[@i_148]) = x4_66[@i_841]) && (K_u_1530 = x5_65[@i_841]))))) then
      (
        let sk_u: hash0 = r_673[@i_841]
      )
      else
      (
        new r_709: hash0;
        let sk_u: hash0 = r_709
      )
    )
    else
    (
      new r_278: hash1;
      out(c6[!_53], r_278);
      in(c9[!_53], ());
      let x1_708: host = U in
      let x2_707: host = S in
      let x3_706: G = cst_G in
      let x4_705: G = cst_G in
      let x5_704: G = cst_G in
      find [unique] @i_828 <= qH0 suchthat defined(x1_69[@i_828], x2_68[@i_828], x3_67[@i_828], x4_66[@i_828], x5_65[@i_828], r_673[@i_828]) && otheruses(r_673[@i_828]) && ((x1_708 = x1_69[@i_828]) && ((x2_707 = x2_68[@i_828]) && ((X = x3_67[@i_828]) && ((exp(g, @1_x_1092[@i_148]) = x4_66[@i_828]) && (K_u_1530 = x5_65[@i_828]))))) then
      (
        let sk_u: hash0 = r_673[@i_828]
      )
      else
      (
        new r_703: hash0;
        let sk_u: hash0 = r_703
      )
    )
  )
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], @1_x_1271[@i_144], @2_r4_96[@i_144]) && otheruses(@1_x_1271[@i_144]) && (Ystar_u = Ystar_u[@i_144]) then
  (
    let K_u_1531: G = exp(g, mult(@1_x_1271[@i_144], x)) in
    let x1_289: host = U in
    let x2_288: host = S in
    find [unique] @i_364 <= qH1 suchthat defined(x1_64[@i_364], x2_63[@i_364], x3_62[@i_364], x4_61[@i_364], x5_60[@i_364], r_248[@i_364]) && otheruses(r_248[@i_364]) && ((x1_289 = x1_64[@i_364]) && ((x2_288 = x2_63[@i_364]) && ((X = x3_62[@i_364]) && ((exp(g, @1_x_1271[@i_144]) = x4_61[@i_364]) && (K_u_1531 = x5_60[@i_364]))))) then
    (
      out(c6[!_53], r_248[@i_364]);
      in(c9[!_53], ());
      let x1_726: host = U in
      let x2_725: host = S in
      let x3_724: G = cst_G in
      let x4_723: G = cst_G in
      let x5_722: G = cst_G in
      find [unique] @i_867 <= qH0 suchthat defined(x1_69[@i_867], x2_68[@i_867], x3_67[@i_867], x4_66[@i_867], x5_65[@i_867], r_673[@i_867]) && otheruses(r_673[@i_867]) && ((x1_726 = x1_69[@i_867]) && ((x2_725 = x2_68[@i_867]) && ((X = x3_67[@i_867]) && ((exp(g, @1_x_1271[@i_144]) = x4_66[@i_867]) && (K_u_1531 = x5_65[@i_867]))))) then
      (
        let sk_u: hash0 = r_673[@i_867]
      )
      else
      (
        new r_721: hash0;
        let sk_u: hash0 = r_721
      )
    )
    else
    (
      new r_284: hash1;
      out(c6[!_53], r_284);
      in(c9[!_53], ());
      let x1_720: host = U in
      let x2_719: host = S in
      let x3_718: G = cst_G in
      let x4_717: G = cst_G in
      let x5_716: G = cst_G in
      find [unique] @i_854 <= qH0 suchthat defined(x1_69[@i_854], x2_68[@i_854], x3_67[@i_854], x4_66[@i_854], x5_65[@i_854], r_673[@i_854]) && otheruses(r_673[@i_854]) && ((x1_720 = x1_69[@i_854]) && ((x2_719 = x2_68[@i_854]) && ((X = x3_67[@i_854]) && ((exp(g, @1_x_1271[@i_144]) = x4_66[@i_854]) && (K_u_1531 = x5_65[@i_854]))))) then
      (
        let sk_u: hash0 = r_673[@i_854]
      )
      else
      (
        new r_715: hash0;
        let sk_u: hash0 = r_715
      )
    )
  )
  orfind @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  orfind @i_141 <= NP suchthat defined(@2_r2_90[@i_141], yp[@i_141], Yp[@i_141]) && otheruses(@2_r2_90[@i_141]) && (Ystar_u = @2_r2_90[@i_141]) then
  (
    let K_u_1532: G = exp(g, mult(yp[@i_141], x)) in
    let x1_295: host = U in
    let x2_294: host = S in
    find [unique] @i_373 <= qH1 suchthat defined(x1_64[@i_373], x2_63[@i_373], x3_62[@i_373], x4_61[@i_373], x5_60[@i_373], r_248[@i_373]) && otheruses(r_248[@i_373]) && ((x1_295 = x1_64[@i_373]) && ((x2_294 = x2_63[@i_373]) && ((X = x3_62[@i_373]) && ((Yp[@i_141] = x4_61[@i_373]) && (K_u_1532 = x5_60[@i_373]))))) then
    (
      out(c6[!_53], r_248[@i_373]);
      in(c9[!_53], ());
      let x1_738: host = U in
      let x2_737: host = S in
      let x3_736: G = cst_G in
      let x4_735: G = cst_G in
      let x5_734: G = cst_G in
      find [unique] @i_893 <= qH0 suchthat defined(x1_69[@i_893], x2_68[@i_893], x3_67[@i_893], x4_66[@i_893], x5_65[@i_893], r_673[@i_893]) && otheruses(r_673[@i_893]) && ((x1_738 = x1_69[@i_893]) && ((x2_737 = x2_68[@i_893]) && ((X = x3_67[@i_893]) && ((Yp[@i_141] = x4_66[@i_893]) && (K_u_1532 = x5_65[@i_893]))))) then
      (
        let sk_u: hash0 = r_673[@i_893]
      )
      else
      (
        new r_733: hash0;
        let sk_u: hash0 = r_733
      )
    )
    else
    (
      new r_290: hash1;
      out(c6[!_53], r_290);
      in(c9[!_53], ());
      let x1_732: host = U in
      let x2_731: host = S in
      let x3_730: G = cst_G in
      let x4_729: G = cst_G in
      let x5_728: G = cst_G in
      find [unique] @i_880 <= qH0 suchthat defined(x1_69[@i_880], x2_68[@i_880], x3_67[@i_880], x4_66[@i_880], x5_65[@i_880], r_673[@i_880]) && otheruses(r_673[@i_880]) && ((x1_732 = x1_69[@i_880]) && ((x2_731 = x2_68[@i_880]) && ((X = x3_67[@i_880]) && ((Yp[@i_141] = x4_66[@i_880]) && (K_u_1532 = x5_65[@i_880]))))) then
      (
        let sk_u: hash0 = r_673[@i_880]
      )
      else
      (
        new r_727: hash0;
        let sk_u: hash0 = r_727
      )
    )
  )
  orfind @i_140 <= NS suchthat defined(@2_r2_93[@i_140], y[@i_140], Y[@i_140]) && otheruses(@2_r2_93[@i_140]) && (Ystar_u = @2_r2_93[@i_140]) then
  (
    let K_u_1533: G = exp(g, mult(y[@i_140], x)) in
    let x1_301: host = U in
    let x2_300: host = S in
    find [unique] @i_382 <= qH1 suchthat defined(x1_64[@i_382], x2_63[@i_382], x3_62[@i_382], x4_61[@i_382], x5_60[@i_382], r_248[@i_382]) && otheruses(r_248[@i_382]) && ((x1_301 = x1_64[@i_382]) && ((x2_300 = x2_63[@i_382]) && ((X = x3_62[@i_382]) && ((Y[@i_140] = x4_61[@i_382]) && (K_u_1533 = x5_60[@i_382]))))) then
    (
      out(c6[!_53], r_248[@i_382]);
      in(c9[!_53], ());
      let x1_750: host = U in
      let x2_749: host = S in
      let x3_748: G = cst_G in
      let x4_747: G = cst_G in
      let x5_746: G = cst_G in
      find [unique] @i_919 <= qH0 suchthat defined(x1_69[@i_919], x2_68[@i_919], x3_67[@i_919], x4_66[@i_919], x5_65[@i_919], r_673[@i_919]) && otheruses(r_673[@i_919]) && ((x1_750 = x1_69[@i_919]) && ((x2_749 = x2_68[@i_919]) && ((X = x3_67[@i_919]) && ((Y[@i_140] = x4_66[@i_919]) && (K_u_1533 = x5_65[@i_919]))))) then
      (
        let sk_u: hash0 = r_673[@i_919]
      )
      orfind  suchthat defined(j[@i_140], r_685[@i_140]) && otheruses(r_685[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_685[@i_140]
      )
      else
      (
        new r_745: hash0;
        let sk_u: hash0 = r_745
      )
    )
    else
    (
      new r_296: hash1;
      out(c6[!_53], r_296);
      in(c9[!_53], ());
      let x1_744: host = U in
      let x2_743: host = S in
      let x3_742: G = cst_G in
      let x4_741: G = cst_G in
      let x5_740: G = cst_G in
      find [unique] @i_906 <= qH0 suchthat defined(x1_69[@i_906], x2_68[@i_906], x3_67[@i_906], x4_66[@i_906], x5_65[@i_906], r_673[@i_906]) && otheruses(r_673[@i_906]) && ((x1_744 = x1_69[@i_906]) && ((x2_743 = x2_68[@i_906]) && ((X = x3_67[@i_906]) && ((Y[@i_140] = x4_66[@i_906]) && (K_u_1533 = x5_65[@i_906]))))) then
      (
        let sk_u: hash0 = r_673[@i_906]
      )
      orfind  suchthat defined(j[@i_140], r_685[@i_140]) && otheruses(r_685[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_685[@i_140]
      )
      orfind  suchthat defined(j[@i_140], r_691[@i_140]) && otheruses(r_691[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_691[@i_140]
      )
      else
      (
        new r_739: hash0;
        let sk_u: hash0 = r_739
      )
    )
  )
  else
  (
    new @1_x_1271: exponent;
    let @2_r4_96: G = cst_G in
    let K_u_1534: G = exp(g, mult(@1_x_1271, x)) in
    let x1_277: host = U in
    let x2_276: host = S in
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ());
    let x1_702: host = U in
    let x2_701: host = S in
    let x3_700: G = cst_G in
    let x4_699: G = cst_G in
    let x5_698: G = cst_G in
    find [unique] @i_815 <= qH0 suchthat defined(x1_69[@i_815], x2_68[@i_815], x3_67[@i_815], x4_66[@i_815], x5_65[@i_815], r_673[@i_815]) && otheruses(r_673[@i_815]) && ((x1_702 = x1_69[@i_815]) && ((x2_701 = x2_68[@i_815]) && ((X = x3_67[@i_815]) && ((exp(g, @1_x_1271) = x4_66[@i_815]) && (K_u_1534 = x5_65[@i_815]))))) then
    (
      let sk_u: hash0 = r_673[@i_815]
    )
    else
    (
      new r_697: hash0;
      let sk_u: hash0 = r_697
    )
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    let x1_271: host = U in
    let x2_270: host = S in
    find [unique] @i_337 <= qH1 suchthat defined(x1_64[@i_337], x2_63[@i_337], x3_62[@i_337], x4_61[@i_337], x5_60[@i_337], r_248[@i_337]) && otheruses(r_248[@i_337]) && ((x1_271 = x1_64[@i_337]) && ((x2_270 = x2_63[@i_337]) && ((X_s = x3_62[@i_337]) && ((Y = x4_61[@i_337]) && (exp(g, mult(x[j], y)) = x5_60[@i_337]))))) then
    (
      if (auth_s = r_248[@i_337]) then
      let x1_690: host = U in
      let x2_689: host = S in
      let x3_688: G = cst_G in
      let x4_687: G = cst_G in
      let x5_686: G = cst_G in
      find [unique] @i_789 <= qH0 suchthat defined(x1_69[@i_789], x2_68[@i_789], x3_67[@i_789], x4_66[@i_789], x5_65[@i_789], r_673[@i_789]) && otheruses(r_673[@i_789]) && ((x1_690 = x1_69[@i_789]) && ((x2_689 = x2_68[@i_789]) && ((X_s = x3_67[@i_789]) && ((Y = x4_66[@i_789]) && (exp(g, mult(x[j], y)) = x5_65[@i_789]))))) then
      (
        let sk_s: hash0 = r_673[@i_789]
      )
      orfind  suchthat defined(@i_140[j], r_739[j]) && otheruses(r_739[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
      (
        let sk_s: hash0 = r_739[j]
      )
      orfind  suchthat defined(@i_140[j], r_745[j]) && otheruses(r_745[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
      (
        let sk_s: hash0 = r_745[j]
      )
      else
      (
        new r_685: hash0;
        let sk_s: hash0 = r_685
      )
    )
    orfind  suchthat defined(@i_140[j], r_296[j]) && otheruses(r_296[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
    (
      if (auth_s = r_296[j]) then
      let x1_696: host = U in
      let x2_695: host = S in
      let x3_694: G = cst_G in
      let x4_693: G = cst_G in
      let x5_692: G = cst_G in
      find [unique] @i_802 <= qH0 suchthat defined(x1_69[@i_802], x2_68[@i_802], x3_67[@i_802], x4_66[@i_802], x5_65[@i_802], r_673[@i_802]) && otheruses(r_673[@i_802]) && ((x1_696 = x1_69[@i_802]) && ((x2_695 = x2_68[@i_802]) && ((X_s = x3_67[@i_802]) && ((Y = x4_66[@i_802]) && (exp(g, mult(x[j], y)) = x5_65[@i_802]))))) then
      (
        let sk_s: hash0 = r_673[@i_802]
      )
      orfind  suchthat defined(r_739[j]) && otheruses(r_739[j]) then
      (
        let sk_s: hash0 = r_739[j]
      )
      else
      (
        new r_691: hash0;
        let sk_s: hash0 = r_691
      )
    )
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    event Auth
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = cst_G in
  new @2_r2_90: G;
  let x1_259: host = U in
  let x2_258: host = S in
  new r_254: hash1;
  let x1_684: host = U in
  let x2_683: host = S in
  let x3_682: G = cst_G in
  let x4_681: G = cst_G in
  let x5_680: G = cst_G in
  new r_679: hash0;
  let sk_p: hash0 = r_679 in
  out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@1_x_1092[@i_118], @2_kd[@i_118], @2_m[@i_118], @2_r4_84[@i_118]) && otheruses(@1_x_1092[@i_118]) && ((@2_x = exp(g, @1_x_1092[@i_118])) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_114 <= NU suchthat defined(@1_x_1271[@i_114], Ystar_u[@i_114], @2_r4_96[@i_114]) && otheruses(@1_x_1271[@i_114]) && ((@2_x = exp(g, @1_x_1271[@i_114])) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], Ystar_u[@i_114])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = Yp[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@2_m[@i_108], @2_kd[@i_108], @1_x_1092[@i_108], @2_r4_84[@i_108]) && otheruses(@1_x_1092[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], exp(g, @1_x_1092[@i_108]))
  )
  orfind @i_104 <= NU suchthat defined(Ystar_u[@i_104], @1_x_1271[@i_104], @2_r4_96[@i_104]) && otheruses(@1_x_1271[@i_104]) && ((@2_m = Ystar_u[@i_104]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], exp(g, @1_x_1271[@i_104]))
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@2_r2_90[@i_101], Yp[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Yp[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_r2_93[@i_100], Y[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @1_x_1092: exponent;
    let @2_r4_84: G = cst_G in
    out(@2_c4[!_57], exp(g, @1_x_1092))
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  let x1_678: host = cst_host in
  let x2_677: host = cst_host in
  let x3_676: G = cst_G in
  let x4_675: G = cst_G in
  let x5_674: G = cst_G in
  find [unique] @i_763 <= qH0 suchthat defined(x1_69[@i_763], x2_68[@i_763], x3_67[@i_763], x4_66[@i_763], x5_65[@i_763], r_673[@i_763]) && otheruses(r_673[@i_763]) && ((x1_69 = x1_69[@i_763]) && ((x2_68 = x2_68[@i_763]) && ((x3_67 = x3_67[@i_763]) && ((x4_66 = x4_66[@i_763]) && (x5_65 = x5_65[@i_763]))))) then
  (
    out(c20[!_58], r_673[@i_763])
  )
  orfind @i_762 <= NP suchthat defined(x1_684[@i_762], x2_683[@i_762], Xp[@i_762], Yp[@i_762], xp[@i_762], yp[@i_762], r_679[@i_762]) && otheruses(r_679[@i_762]) && ((x1_69 = x1_684[@i_762]) && ((x2_68 = x2_683[@i_762]) && ((x3_67 = Xp[@i_762]) && ((x4_66 = Yp[@i_762]) && (x5_65 = exp(g, mult(xp[@i_762], yp[@i_762]))))))) then
  (
    out(c20[!_58], r_679[@i_762])
  )
  orfind @i_761 <= NS suchthat defined(x1_690[@i_761], x2_689[@i_761], X_s[@i_761], Y[@i_761], x[j[@i_761]], y[@i_761], r_685[@i_761]) && otheruses(r_685[@i_761]) && ((x1_69 = x1_690[@i_761]) && ((x2_68 = x2_689[@i_761]) && ((x3_67 = X_s[@i_761]) && ((x4_66 = Y[@i_761]) && (x5_65 = exp(g, mult(x[j[@i_761]], y[@i_761]))))))) then
  (
    out(c20[!_58], r_685[@i_761])
  )
  orfind @i_760 <= NS suchthat defined(x1_696[@i_760], x2_695[@i_760], X_s[@i_760], Y[@i_760], x[j[@i_760]], y[@i_760], r_691[@i_760]) && otheruses(r_691[@i_760]) && ((x1_69 = x1_696[@i_760]) && ((x2_68 = x2_695[@i_760]) && ((x3_67 = X_s[@i_760]) && ((x4_66 = Y[@i_760]) && (x5_65 = exp(g, mult(x[j[@i_760]], y[@i_760]))))))) then
  (
    out(c20[!_58], r_691[@i_760])
  )
  orfind @i_759 <= NU suchthat defined(x1_702[@i_759], x2_701[@i_759], X[@i_759], @1_x_1271[@i_759], K_u_1534[@i_759], r_697[@i_759]) && otheruses(r_697[@i_759]) && ((x1_69 = x1_702[@i_759]) && ((x2_68 = x2_701[@i_759]) && ((x3_67 = X[@i_759]) && ((x4_66 = exp(g, @1_x_1271[@i_759])) && (x5_65 = K_u_1534[@i_759]))))) then
  (
    out(c20[!_58], r_697[@i_759])
  )
  orfind @i_758 <= NU suchthat defined(x1_708[@i_758], x2_707[@i_758], X[@i_758], @1_x_1092[@i_148[@i_758]], K_u_1530[@i_758], r_703[@i_758]) && otheruses(r_703[@i_758]) && ((x1_69 = x1_708[@i_758]) && ((x2_68 = x2_707[@i_758]) && ((x3_67 = X[@i_758]) && ((x4_66 = exp(g, @1_x_1092[@i_148[@i_758]])) && (x5_65 = K_u_1530[@i_758]))))) then
  (
    out(c20[!_58], r_703[@i_758])
  )
  orfind @i_757 <= NU suchthat defined(x1_714[@i_757], x2_713[@i_757], X[@i_757], @1_x_1092[@i_148[@i_757]], K_u_1530[@i_757], r_709[@i_757]) && otheruses(r_709[@i_757]) && ((x1_69 = x1_714[@i_757]) && ((x2_68 = x2_713[@i_757]) && ((x3_67 = X[@i_757]) && ((x4_66 = exp(g, @1_x_1092[@i_148[@i_757]])) && (x5_65 = K_u_1530[@i_757]))))) then
  (
    out(c20[!_58], r_709[@i_757])
  )
  orfind @i_756 <= NU suchthat defined(x1_720[@i_756], x2_719[@i_756], X[@i_756], @1_x_1271[@i_144[@i_756]], K_u_1531[@i_756], r_715[@i_756]) && otheruses(r_715[@i_756]) && ((x1_69 = x1_720[@i_756]) && ((x2_68 = x2_719[@i_756]) && ((x3_67 = X[@i_756]) && ((x4_66 = exp(g, @1_x_1271[@i_144[@i_756]])) && (x5_65 = K_u_1531[@i_756]))))) then
  (
    out(c20[!_58], r_715[@i_756])
  )
  orfind @i_755 <= NU suchthat defined(x1_726[@i_755], x2_725[@i_755], X[@i_755], @1_x_1271[@i_144[@i_755]], K_u_1531[@i_755], r_721[@i_755]) && otheruses(r_721[@i_755]) && ((x1_69 = x1_726[@i_755]) && ((x2_68 = x2_725[@i_755]) && ((x3_67 = X[@i_755]) && ((x4_66 = exp(g, @1_x_1271[@i_144[@i_755]])) && (x5_65 = K_u_1531[@i_755]))))) then
  (
    out(c20[!_58], r_721[@i_755])
  )
  orfind @i_754 <= NU suchthat defined(x1_732[@i_754], x2_731[@i_754], X[@i_754], Yp[@i_141[@i_754]], K_u_1532[@i_754], r_727[@i_754]) && otheruses(r_727[@i_754]) && ((x1_69 = x1_732[@i_754]) && ((x2_68 = x2_731[@i_754]) && ((x3_67 = X[@i_754]) && ((x4_66 = Yp[@i_141[@i_754]]) && (x5_65 = K_u_1532[@i_754]))))) then
  (
    out(c20[!_58], r_727[@i_754])
  )
  orfind @i_753 <= NU suchthat defined(x1_738[@i_753], x2_737[@i_753], X[@i_753], Yp[@i_141[@i_753]], K_u_1532[@i_753], r_733[@i_753]) && otheruses(r_733[@i_753]) && ((x1_69 = x1_738[@i_753]) && ((x2_68 = x2_737[@i_753]) && ((x3_67 = X[@i_753]) && ((x4_66 = Yp[@i_141[@i_753]]) && (x5_65 = K_u_1532[@i_753]))))) then
  (
    out(c20[!_58], r_733[@i_753])
  )
  orfind @i_752 <= NU suchthat defined(x1_744[@i_752], x2_743[@i_752], X[@i_752], Y[@i_140[@i_752]], K_u_1533[@i_752], r_739[@i_752]) && otheruses(r_739[@i_752]) && ((x1_69 = x1_744[@i_752]) && ((x2_68 = x2_743[@i_752]) && ((x3_67 = X[@i_752]) && ((x4_66 = Y[@i_140[@i_752]]) && (x5_65 = K_u_1533[@i_752]))))) then
  (
    out(c20[!_58], r_739[@i_752])
  )
  orfind @i_751 <= NU suchthat defined(x1_750[@i_751], x2_749[@i_751], X[@i_751], Y[@i_140[@i_751]], K_u_1533[@i_751], r_745[@i_751]) && otheruses(r_745[@i_751]) && ((x1_69 = x1_750[@i_751]) && ((x2_68 = x2_749[@i_751]) && ((x3_67 = X[@i_751]) && ((x4_66 = Y[@i_140[@i_751]]) && (x5_65 = K_u_1533[@i_751]))))) then
  (
    out(c20[!_58], r_745[@i_751])
  )
  else
  (
    new r_673: hash0;
    out(c20[!_58], r_673)
  )
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  orfind @i_309 <= NP suchthat defined(x1_259[@i_309], x2_258[@i_309], Xp[@i_309], Yp[@i_309], xp[@i_309], yp[@i_309], r_254[@i_309]) && otheruses(r_254[@i_309]) && ((x1_64 = x1_259[@i_309]) && ((x2_63 = x2_258[@i_309]) && ((x3_62 = Xp[@i_309]) && ((x4_61 = Yp[@i_309]) && (x5_60 = exp(g, mult(xp[@i_309], yp[@i_309]))))))) then
  (
    out(c21[!_59], r_254[@i_309])
  )
  orfind @i_306 <= NU suchthat defined(x1_277[@i_306], x2_276[@i_306], X[@i_306], @1_x_1271[@i_306], K_u_1534[@i_306], r_272[@i_306]) && otheruses(r_272[@i_306]) && ((x1_64 = x1_277[@i_306]) && ((x2_63 = x2_276[@i_306]) && ((x3_62 = X[@i_306]) && ((x4_61 = exp(g, @1_x_1271[@i_306])) && (x5_60 = K_u_1534[@i_306]))))) then
  (
    out(c21[!_59], r_272[@i_306])
  )
  orfind @i_305 <= NU suchthat defined(x1_283[@i_305], x2_282[@i_305], X[@i_305], @1_x_1092[@i_148[@i_305]], K_u_1530[@i_305], r_278[@i_305]) && otheruses(r_278[@i_305]) && ((x1_64 = x1_283[@i_305]) && ((x2_63 = x2_282[@i_305]) && ((x3_62 = X[@i_305]) && ((x4_61 = exp(g, @1_x_1092[@i_148[@i_305]])) && (x5_60 = K_u_1530[@i_305]))))) then
  (
    out(c21[!_59], r_278[@i_305])
  )
  orfind @i_304 <= NU suchthat defined(x1_289[@i_304], x2_288[@i_304], X[@i_304], @1_x_1271[@i_144[@i_304]], K_u_1531[@i_304], r_284[@i_304]) && otheruses(r_284[@i_304]) && ((x1_64 = x1_289[@i_304]) && ((x2_63 = x2_288[@i_304]) && ((x3_62 = X[@i_304]) && ((x4_61 = exp(g, @1_x_1271[@i_144[@i_304]])) && (x5_60 = K_u_1531[@i_304]))))) then
  (
    out(c21[!_59], r_284[@i_304])
  )
  orfind @i_303 <= NU suchthat defined(x1_295[@i_303], x2_294[@i_303], X[@i_303], Yp[@i_141[@i_303]], K_u_1532[@i_303], r_290[@i_303]) && otheruses(r_290[@i_303]) && ((x1_64 = x1_295[@i_303]) && ((x2_63 = x2_294[@i_303]) && ((x3_62 = X[@i_303]) && ((x4_61 = Yp[@i_141[@i_303]]) && (x5_60 = K_u_1532[@i_303]))))) then
  (
    out(c21[!_59], r_290[@i_303])
  )
  orfind @i_302 <= NU suchthat defined(x1_301[@i_302], x2_300[@i_302], X[@i_302], Y[@i_140[@i_302]], K_u_1533[@i_302], r_296[@i_302]) && otheruses(r_296[@i_302]) && ((x1_64 = x1_301[@i_302]) && ((x2_63 = x2_300[@i_302]) && ((x3_62 = X[@i_302]) && ((x4_61 = Y[@i_140[@i_302]]) && (x5_60 = K_u_1533[@i_302]))))) then
  (
    out(c21[!_59], r_296[@i_302])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying remove assignments of binder K_u_1534 yields

Game 24 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_148 <= qD suchthat defined(@2_m[@i_148], @2_kd[@i_148], @1_x_1092[@i_148], @2_r4_84[@i_148]) && otheruses(@1_x_1092[@i_148]) && ((Ystar_u = @2_m[@i_148]) && (pw = @2_kd[@i_148])) then
  (
    let K_u_1530: G = exp(g, mult(@1_x_1092[@i_148], x)) in
    let x1_283: host = U in
    let x2_282: host = S in
    find [unique] @i_355 <= qH1 suchthat defined(x1_64[@i_355], x2_63[@i_355], x3_62[@i_355], x4_61[@i_355], x5_60[@i_355], r_248[@i_355]) && otheruses(r_248[@i_355]) && ((x1_283 = x1_64[@i_355]) && ((x2_282 = x2_63[@i_355]) && ((X = x3_62[@i_355]) && ((exp(g, @1_x_1092[@i_148]) = x4_61[@i_355]) && (K_u_1530 = x5_60[@i_355]))))) then
    (
      out(c6[!_53], r_248[@i_355]);
      in(c9[!_53], ());
      let x1_714: host = U in
      let x2_713: host = S in
      find [unique] @i_841 <= qH0 suchthat defined(x1_69[@i_841], x2_68[@i_841], x3_67[@i_841], x4_66[@i_841], x5_65[@i_841], r_673[@i_841]) && otheruses(r_673[@i_841]) && ((x1_714 = x1_69[@i_841]) && ((x2_713 = x2_68[@i_841]) && ((X = x3_67[@i_841]) && ((exp(g, @1_x_1092[@i_148]) = x4_66[@i_841]) && (K_u_1530 = x5_65[@i_841]))))) then
      (
        let sk_u: hash0 = r_673[@i_841]
      )
      else
      (
        new r_709: hash0;
        let sk_u: hash0 = r_709
      )
    )
    else
    (
      new r_278: hash1;
      out(c6[!_53], r_278);
      in(c9[!_53], ());
      let x1_708: host = U in
      let x2_707: host = S in
      find [unique] @i_828 <= qH0 suchthat defined(x1_69[@i_828], x2_68[@i_828], x3_67[@i_828], x4_66[@i_828], x5_65[@i_828], r_673[@i_828]) && otheruses(r_673[@i_828]) && ((x1_708 = x1_69[@i_828]) && ((x2_707 = x2_68[@i_828]) && ((X = x3_67[@i_828]) && ((exp(g, @1_x_1092[@i_148]) = x4_66[@i_828]) && (K_u_1530 = x5_65[@i_828]))))) then
      (
        let sk_u: hash0 = r_673[@i_828]
      )
      else
      (
        new r_703: hash0;
        let sk_u: hash0 = r_703
      )
    )
  )
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], @1_x_1271[@i_144], @2_r4_96[@i_144]) && otheruses(@1_x_1271[@i_144]) && (Ystar_u = Ystar_u[@i_144]) then
  (
    let K_u_1531: G = exp(g, mult(@1_x_1271[@i_144], x)) in
    let x1_289: host = U in
    let x2_288: host = S in
    find [unique] @i_364 <= qH1 suchthat defined(x1_64[@i_364], x2_63[@i_364], x3_62[@i_364], x4_61[@i_364], x5_60[@i_364], r_248[@i_364]) && otheruses(r_248[@i_364]) && ((x1_289 = x1_64[@i_364]) && ((x2_288 = x2_63[@i_364]) && ((X = x3_62[@i_364]) && ((exp(g, @1_x_1271[@i_144]) = x4_61[@i_364]) && (K_u_1531 = x5_60[@i_364]))))) then
    (
      out(c6[!_53], r_248[@i_364]);
      in(c9[!_53], ());
      let x1_726: host = U in
      let x2_725: host = S in
      find [unique] @i_867 <= qH0 suchthat defined(x1_69[@i_867], x2_68[@i_867], x3_67[@i_867], x4_66[@i_867], x5_65[@i_867], r_673[@i_867]) && otheruses(r_673[@i_867]) && ((x1_726 = x1_69[@i_867]) && ((x2_725 = x2_68[@i_867]) && ((X = x3_67[@i_867]) && ((exp(g, @1_x_1271[@i_144]) = x4_66[@i_867]) && (K_u_1531 = x5_65[@i_867]))))) then
      (
        let sk_u: hash0 = r_673[@i_867]
      )
      else
      (
        new r_721: hash0;
        let sk_u: hash0 = r_721
      )
    )
    else
    (
      new r_284: hash1;
      out(c6[!_53], r_284);
      in(c9[!_53], ());
      let x1_720: host = U in
      let x2_719: host = S in
      find [unique] @i_854 <= qH0 suchthat defined(x1_69[@i_854], x2_68[@i_854], x3_67[@i_854], x4_66[@i_854], x5_65[@i_854], r_673[@i_854]) && otheruses(r_673[@i_854]) && ((x1_720 = x1_69[@i_854]) && ((x2_719 = x2_68[@i_854]) && ((X = x3_67[@i_854]) && ((exp(g, @1_x_1271[@i_144]) = x4_66[@i_854]) && (K_u_1531 = x5_65[@i_854]))))) then
      (
        let sk_u: hash0 = r_673[@i_854]
      )
      else
      (
        new r_715: hash0;
        let sk_u: hash0 = r_715
      )
    )
  )
  orfind @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  orfind @i_141 <= NP suchthat defined(@2_r2_90[@i_141], yp[@i_141], Yp[@i_141]) && otheruses(@2_r2_90[@i_141]) && (Ystar_u = @2_r2_90[@i_141]) then
  (
    let K_u_1532: G = exp(g, mult(yp[@i_141], x)) in
    let x1_295: host = U in
    let x2_294: host = S in
    find [unique] @i_373 <= qH1 suchthat defined(x1_64[@i_373], x2_63[@i_373], x3_62[@i_373], x4_61[@i_373], x5_60[@i_373], r_248[@i_373]) && otheruses(r_248[@i_373]) && ((x1_295 = x1_64[@i_373]) && ((x2_294 = x2_63[@i_373]) && ((X = x3_62[@i_373]) && ((Yp[@i_141] = x4_61[@i_373]) && (K_u_1532 = x5_60[@i_373]))))) then
    (
      out(c6[!_53], r_248[@i_373]);
      in(c9[!_53], ());
      let x1_738: host = U in
      let x2_737: host = S in
      find [unique] @i_893 <= qH0 suchthat defined(x1_69[@i_893], x2_68[@i_893], x3_67[@i_893], x4_66[@i_893], x5_65[@i_893], r_673[@i_893]) && otheruses(r_673[@i_893]) && ((x1_738 = x1_69[@i_893]) && ((x2_737 = x2_68[@i_893]) && ((X = x3_67[@i_893]) && ((Yp[@i_141] = x4_66[@i_893]) && (K_u_1532 = x5_65[@i_893]))))) then
      (
        let sk_u: hash0 = r_673[@i_893]
      )
      else
      (
        new r_733: hash0;
        let sk_u: hash0 = r_733
      )
    )
    else
    (
      new r_290: hash1;
      out(c6[!_53], r_290);
      in(c9[!_53], ());
      let x1_732: host = U in
      let x2_731: host = S in
      find [unique] @i_880 <= qH0 suchthat defined(x1_69[@i_880], x2_68[@i_880], x3_67[@i_880], x4_66[@i_880], x5_65[@i_880], r_673[@i_880]) && otheruses(r_673[@i_880]) && ((x1_732 = x1_69[@i_880]) && ((x2_731 = x2_68[@i_880]) && ((X = x3_67[@i_880]) && ((Yp[@i_141] = x4_66[@i_880]) && (K_u_1532 = x5_65[@i_880]))))) then
      (
        let sk_u: hash0 = r_673[@i_880]
      )
      else
      (
        new r_727: hash0;
        let sk_u: hash0 = r_727
      )
    )
  )
  orfind @i_140 <= NS suchthat defined(@2_r2_93[@i_140], y[@i_140], Y[@i_140]) && otheruses(@2_r2_93[@i_140]) && (Ystar_u = @2_r2_93[@i_140]) then
  (
    let K_u_1533: G = exp(g, mult(y[@i_140], x)) in
    let x1_301: host = U in
    let x2_300: host = S in
    find [unique] @i_382 <= qH1 suchthat defined(x1_64[@i_382], x2_63[@i_382], x3_62[@i_382], x4_61[@i_382], x5_60[@i_382], r_248[@i_382]) && otheruses(r_248[@i_382]) && ((x1_301 = x1_64[@i_382]) && ((x2_300 = x2_63[@i_382]) && ((X = x3_62[@i_382]) && ((Y[@i_140] = x4_61[@i_382]) && (K_u_1533 = x5_60[@i_382]))))) then
    (
      out(c6[!_53], r_248[@i_382]);
      in(c9[!_53], ());
      let x1_750: host = U in
      let x2_749: host = S in
      find [unique] @i_919 <= qH0 suchthat defined(x1_69[@i_919], x2_68[@i_919], x3_67[@i_919], x4_66[@i_919], x5_65[@i_919], r_673[@i_919]) && otheruses(r_673[@i_919]) && ((x1_750 = x1_69[@i_919]) && ((x2_749 = x2_68[@i_919]) && ((X = x3_67[@i_919]) && ((Y[@i_140] = x4_66[@i_919]) && (K_u_1533 = x5_65[@i_919]))))) then
      (
        let sk_u: hash0 = r_673[@i_919]
      )
      orfind  suchthat defined(j[@i_140], r_685[@i_140]) && otheruses(r_685[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_685[@i_140]
      )
      else
      (
        new r_745: hash0;
        let sk_u: hash0 = r_745
      )
    )
    else
    (
      new r_296: hash1;
      out(c6[!_53], r_296);
      in(c9[!_53], ());
      let x1_744: host = U in
      let x2_743: host = S in
      find [unique] @i_906 <= qH0 suchthat defined(x1_69[@i_906], x2_68[@i_906], x3_67[@i_906], x4_66[@i_906], x5_65[@i_906], r_673[@i_906]) && otheruses(r_673[@i_906]) && ((x1_744 = x1_69[@i_906]) && ((x2_743 = x2_68[@i_906]) && ((X = x3_67[@i_906]) && ((Y[@i_140] = x4_66[@i_906]) && (K_u_1533 = x5_65[@i_906]))))) then
      (
        let sk_u: hash0 = r_673[@i_906]
      )
      orfind  suchthat defined(j[@i_140], r_685[@i_140]) && otheruses(r_685[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_685[@i_140]
      )
      orfind  suchthat defined(j[@i_140], r_691[@i_140]) && otheruses(r_691[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_691[@i_140]
      )
      else
      (
        new r_739: hash0;
        let sk_u: hash0 = r_739
      )
    )
  )
  else
  (
    new @1_x_1271: exponent;
    let @2_r4_96: G = cst_G in
    let K_u_1534: G = cst_G in
    let x1_277: host = U in
    let x2_276: host = S in
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ());
    let x1_702: host = U in
    let x2_701: host = S in
    find [unique] @i_815 <= qH0 suchthat defined(x1_69[@i_815], x2_68[@i_815], x3_67[@i_815], x4_66[@i_815], x5_65[@i_815], r_673[@i_815]) && otheruses(r_673[@i_815]) && ((x1_702 = x1_69[@i_815]) && ((x2_701 = x2_68[@i_815]) && ((X = x3_67[@i_815]) && ((exp(g, @1_x_1271) = x4_66[@i_815]) && (exp(g, mult(@1_x_1271, x)) = x5_65[@i_815]))))) then
    (
      let sk_u: hash0 = r_673[@i_815]
    )
    else
    (
      new r_697: hash0;
      let sk_u: hash0 = r_697
    )
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let x1_271: host = U in
    let x2_270: host = S in
    find [unique] @i_337 <= qH1 suchthat defined(x1_64[@i_337], x2_63[@i_337], x3_62[@i_337], x4_61[@i_337], x5_60[@i_337], r_248[@i_337]) && otheruses(r_248[@i_337]) && ((x1_271 = x1_64[@i_337]) && ((x2_270 = x2_63[@i_337]) && ((X_s = x3_62[@i_337]) && ((Y = x4_61[@i_337]) && (exp(g, mult(x[j], y)) = x5_60[@i_337]))))) then
    (
      if (auth_s = r_248[@i_337]) then
      let x1_690: host = U in
      let x2_689: host = S in
      find [unique] @i_789 <= qH0 suchthat defined(x1_69[@i_789], x2_68[@i_789], x3_67[@i_789], x4_66[@i_789], x5_65[@i_789], r_673[@i_789]) && otheruses(r_673[@i_789]) && ((x1_690 = x1_69[@i_789]) && ((x2_689 = x2_68[@i_789]) && ((X_s = x3_67[@i_789]) && ((Y = x4_66[@i_789]) && (exp(g, mult(x[j], y)) = x5_65[@i_789]))))) then
      (
        let sk_s: hash0 = r_673[@i_789]
      )
      orfind  suchthat defined(@i_140[j], r_739[j]) && otheruses(r_739[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
      (
        let sk_s: hash0 = r_739[j]
      )
      orfind  suchthat defined(@i_140[j], r_745[j]) && otheruses(r_745[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
      (
        let sk_s: hash0 = r_745[j]
      )
      else
      (
        new r_685: hash0;
        let sk_s: hash0 = r_685
      )
    )
    orfind  suchthat defined(@i_140[j], r_296[j]) && otheruses(r_296[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
    (
      if (auth_s = r_296[j]) then
      let x1_696: host = U in
      let x2_695: host = S in
      find [unique] @i_802 <= qH0 suchthat defined(x1_69[@i_802], x2_68[@i_802], x3_67[@i_802], x4_66[@i_802], x5_65[@i_802], r_673[@i_802]) && otheruses(r_673[@i_802]) && ((x1_696 = x1_69[@i_802]) && ((x2_695 = x2_68[@i_802]) && ((X_s = x3_67[@i_802]) && ((Y = x4_66[@i_802]) && (exp(g, mult(x[j], y)) = x5_65[@i_802]))))) then
      (
        let sk_s: hash0 = r_673[@i_802]
      )
      orfind  suchthat defined(r_739[j]) && otheruses(r_739[j]) then
      (
        let sk_s: hash0 = r_739[j]
      )
      else
      (
        new r_691: hash0;
        let sk_s: hash0 = r_691
      )
    )
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    event Auth
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  new @2_r2_90: G;
  let x1_259: host = U in
  let x2_258: host = S in
  new r_254: hash1;
  let x1_684: host = U in
  let x2_683: host = S in
  new r_679: hash0;
  let sk_p: hash0 = r_679 in
  out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@1_x_1092[@i_118], @2_kd[@i_118], @2_m[@i_118], @2_r4_84[@i_118]) && otheruses(@1_x_1092[@i_118]) && ((@2_x = exp(g, @1_x_1092[@i_118])) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_114 <= NU suchthat defined(@1_x_1271[@i_114], Ystar_u[@i_114], @2_r4_96[@i_114]) && otheruses(@1_x_1271[@i_114]) && ((@2_x = exp(g, @1_x_1271[@i_114])) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], Ystar_u[@i_114])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = Yp[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@2_m[@i_108], @2_kd[@i_108], @1_x_1092[@i_108], @2_r4_84[@i_108]) && otheruses(@1_x_1092[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], exp(g, @1_x_1092[@i_108]))
  )
  orfind @i_104 <= NU suchthat defined(Ystar_u[@i_104], @1_x_1271[@i_104], @2_r4_96[@i_104]) && otheruses(@1_x_1271[@i_104]) && ((@2_m = Ystar_u[@i_104]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], exp(g, @1_x_1271[@i_104]))
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@2_r2_90[@i_101], Yp[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Yp[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_r2_93[@i_100], Y[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @1_x_1092: exponent;
    let @2_r4_84: G = cst_G in
    out(@2_c4[!_57], exp(g, @1_x_1092))
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  find [unique] @i_763 <= qH0 suchthat defined(x1_69[@i_763], x2_68[@i_763], x3_67[@i_763], x4_66[@i_763], x5_65[@i_763], r_673[@i_763]) && otheruses(r_673[@i_763]) && ((x1_69 = x1_69[@i_763]) && ((x2_68 = x2_68[@i_763]) && ((x3_67 = x3_67[@i_763]) && ((x4_66 = x4_66[@i_763]) && (x5_65 = x5_65[@i_763]))))) then
  (
    out(c20[!_58], r_673[@i_763])
  )
  orfind @i_762 <= NP suchthat defined(x1_684[@i_762], x2_683[@i_762], Xp[@i_762], Yp[@i_762], xp[@i_762], yp[@i_762], r_679[@i_762]) && otheruses(r_679[@i_762]) && ((x1_69 = x1_684[@i_762]) && ((x2_68 = x2_683[@i_762]) && ((x3_67 = Xp[@i_762]) && ((x4_66 = Yp[@i_762]) && (x5_65 = exp(g, mult(xp[@i_762], yp[@i_762]))))))) then
  (
    out(c20[!_58], r_679[@i_762])
  )
  orfind @i_761 <= NS suchthat defined(x1_690[@i_761], x2_689[@i_761], X_s[@i_761], Y[@i_761], x[j[@i_761]], y[@i_761], r_685[@i_761]) && otheruses(r_685[@i_761]) && ((x1_69 = x1_690[@i_761]) && ((x2_68 = x2_689[@i_761]) && ((x3_67 = X_s[@i_761]) && ((x4_66 = Y[@i_761]) && (x5_65 = exp(g, mult(x[j[@i_761]], y[@i_761]))))))) then
  (
    out(c20[!_58], r_685[@i_761])
  )
  orfind @i_760 <= NS suchthat defined(x1_696[@i_760], x2_695[@i_760], X_s[@i_760], Y[@i_760], x[j[@i_760]], y[@i_760], r_691[@i_760]) && otheruses(r_691[@i_760]) && ((x1_69 = x1_696[@i_760]) && ((x2_68 = x2_695[@i_760]) && ((x3_67 = X_s[@i_760]) && ((x4_66 = Y[@i_760]) && (x5_65 = exp(g, mult(x[j[@i_760]], y[@i_760]))))))) then
  (
    out(c20[!_58], r_691[@i_760])
  )
  orfind @i_759 <= NU suchthat defined(x[@i_759], K_u_1534[@i_759], x1_702[@i_759], x2_701[@i_759], X[@i_759], @1_x_1271[@i_759], r_697[@i_759]) && otheruses(r_697[@i_759]) && ((x1_69 = x1_702[@i_759]) && ((x2_68 = x2_701[@i_759]) && ((x3_67 = X[@i_759]) && ((x4_66 = exp(g, @1_x_1271[@i_759])) && (x5_65 = exp(g, mult(@1_x_1271[@i_759], x[@i_759]))))))) then
  (
    out(c20[!_58], r_697[@i_759])
  )
  orfind @i_758 <= NU suchthat defined(x1_708[@i_758], x2_707[@i_758], X[@i_758], @1_x_1092[@i_148[@i_758]], K_u_1530[@i_758], r_703[@i_758]) && otheruses(r_703[@i_758]) && ((x1_69 = x1_708[@i_758]) && ((x2_68 = x2_707[@i_758]) && ((x3_67 = X[@i_758]) && ((x4_66 = exp(g, @1_x_1092[@i_148[@i_758]])) && (x5_65 = K_u_1530[@i_758]))))) then
  (
    out(c20[!_58], r_703[@i_758])
  )
  orfind @i_757 <= NU suchthat defined(x1_714[@i_757], x2_713[@i_757], X[@i_757], @1_x_1092[@i_148[@i_757]], K_u_1530[@i_757], r_709[@i_757]) && otheruses(r_709[@i_757]) && ((x1_69 = x1_714[@i_757]) && ((x2_68 = x2_713[@i_757]) && ((x3_67 = X[@i_757]) && ((x4_66 = exp(g, @1_x_1092[@i_148[@i_757]])) && (x5_65 = K_u_1530[@i_757]))))) then
  (
    out(c20[!_58], r_709[@i_757])
  )
  orfind @i_756 <= NU suchthat defined(x1_720[@i_756], x2_719[@i_756], X[@i_756], @1_x_1271[@i_144[@i_756]], K_u_1531[@i_756], r_715[@i_756]) && otheruses(r_715[@i_756]) && ((x1_69 = x1_720[@i_756]) && ((x2_68 = x2_719[@i_756]) && ((x3_67 = X[@i_756]) && ((x4_66 = exp(g, @1_x_1271[@i_144[@i_756]])) && (x5_65 = K_u_1531[@i_756]))))) then
  (
    out(c20[!_58], r_715[@i_756])
  )
  orfind @i_755 <= NU suchthat defined(x1_726[@i_755], x2_725[@i_755], X[@i_755], @1_x_1271[@i_144[@i_755]], K_u_1531[@i_755], r_721[@i_755]) && otheruses(r_721[@i_755]) && ((x1_69 = x1_726[@i_755]) && ((x2_68 = x2_725[@i_755]) && ((x3_67 = X[@i_755]) && ((x4_66 = exp(g, @1_x_1271[@i_144[@i_755]])) && (x5_65 = K_u_1531[@i_755]))))) then
  (
    out(c20[!_58], r_721[@i_755])
  )
  orfind @i_754 <= NU suchthat defined(x1_732[@i_754], x2_731[@i_754], X[@i_754], Yp[@i_141[@i_754]], K_u_1532[@i_754], r_727[@i_754]) && otheruses(r_727[@i_754]) && ((x1_69 = x1_732[@i_754]) && ((x2_68 = x2_731[@i_754]) && ((x3_67 = X[@i_754]) && ((x4_66 = Yp[@i_141[@i_754]]) && (x5_65 = K_u_1532[@i_754]))))) then
  (
    out(c20[!_58], r_727[@i_754])
  )
  orfind @i_753 <= NU suchthat defined(x1_738[@i_753], x2_737[@i_753], X[@i_753], Yp[@i_141[@i_753]], K_u_1532[@i_753], r_733[@i_753]) && otheruses(r_733[@i_753]) && ((x1_69 = x1_738[@i_753]) && ((x2_68 = x2_737[@i_753]) && ((x3_67 = X[@i_753]) && ((x4_66 = Yp[@i_141[@i_753]]) && (x5_65 = K_u_1532[@i_753]))))) then
  (
    out(c20[!_58], r_733[@i_753])
  )
  orfind @i_752 <= NU suchthat defined(x1_744[@i_752], x2_743[@i_752], X[@i_752], Y[@i_140[@i_752]], K_u_1533[@i_752], r_739[@i_752]) && otheruses(r_739[@i_752]) && ((x1_69 = x1_744[@i_752]) && ((x2_68 = x2_743[@i_752]) && ((x3_67 = X[@i_752]) && ((x4_66 = Y[@i_140[@i_752]]) && (x5_65 = K_u_1533[@i_752]))))) then
  (
    out(c20[!_58], r_739[@i_752])
  )
  orfind @i_751 <= NU suchthat defined(x1_750[@i_751], x2_749[@i_751], X[@i_751], Y[@i_140[@i_751]], K_u_1533[@i_751], r_745[@i_751]) && otheruses(r_745[@i_751]) && ((x1_69 = x1_750[@i_751]) && ((x2_68 = x2_749[@i_751]) && ((x3_67 = X[@i_751]) && ((x4_66 = Y[@i_140[@i_751]]) && (x5_65 = K_u_1533[@i_751]))))) then
  (
    out(c20[!_58], r_745[@i_751])
  )
  else
  (
    new r_673: hash0;
    out(c20[!_58], r_673)
  )
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  orfind @i_309 <= NP suchthat defined(x1_259[@i_309], x2_258[@i_309], Xp[@i_309], Yp[@i_309], xp[@i_309], yp[@i_309], r_254[@i_309]) && otheruses(r_254[@i_309]) && ((x1_64 = x1_259[@i_309]) && ((x2_63 = x2_258[@i_309]) && ((x3_62 = Xp[@i_309]) && ((x4_61 = Yp[@i_309]) && (x5_60 = exp(g, mult(xp[@i_309], yp[@i_309]))))))) then
  (
    out(c21[!_59], r_254[@i_309])
  )
  orfind @i_306 <= NU suchthat defined(x[@i_306], K_u_1534[@i_306], x1_277[@i_306], x2_276[@i_306], X[@i_306], @1_x_1271[@i_306], r_272[@i_306]) && otheruses(r_272[@i_306]) && ((x1_64 = x1_277[@i_306]) && ((x2_63 = x2_276[@i_306]) && ((x3_62 = X[@i_306]) && ((x4_61 = exp(g, @1_x_1271[@i_306])) && (x5_60 = exp(g, mult(@1_x_1271[@i_306], x[@i_306]))))))) then
  (
    out(c21[!_59], r_272[@i_306])
  )
  orfind @i_305 <= NU suchthat defined(x1_283[@i_305], x2_282[@i_305], X[@i_305], @1_x_1092[@i_148[@i_305]], K_u_1530[@i_305], r_278[@i_305]) && otheruses(r_278[@i_305]) && ((x1_64 = x1_283[@i_305]) && ((x2_63 = x2_282[@i_305]) && ((x3_62 = X[@i_305]) && ((x4_61 = exp(g, @1_x_1092[@i_148[@i_305]])) && (x5_60 = K_u_1530[@i_305]))))) then
  (
    out(c21[!_59], r_278[@i_305])
  )
  orfind @i_304 <= NU suchthat defined(x1_289[@i_304], x2_288[@i_304], X[@i_304], @1_x_1271[@i_144[@i_304]], K_u_1531[@i_304], r_284[@i_304]) && otheruses(r_284[@i_304]) && ((x1_64 = x1_289[@i_304]) && ((x2_63 = x2_288[@i_304]) && ((x3_62 = X[@i_304]) && ((x4_61 = exp(g, @1_x_1271[@i_144[@i_304]])) && (x5_60 = K_u_1531[@i_304]))))) then
  (
    out(c21[!_59], r_284[@i_304])
  )
  orfind @i_303 <= NU suchthat defined(x1_295[@i_303], x2_294[@i_303], X[@i_303], Yp[@i_141[@i_303]], K_u_1532[@i_303], r_290[@i_303]) && otheruses(r_290[@i_303]) && ((x1_64 = x1_295[@i_303]) && ((x2_63 = x2_294[@i_303]) && ((x3_62 = X[@i_303]) && ((x4_61 = Yp[@i_141[@i_303]]) && (x5_60 = K_u_1532[@i_303]))))) then
  (
    out(c21[!_59], r_290[@i_303])
  )
  orfind @i_302 <= NU suchthat defined(x1_301[@i_302], x2_300[@i_302], X[@i_302], Y[@i_140[@i_302]], K_u_1533[@i_302], r_296[@i_302]) && otheruses(r_296[@i_302]) && ((x1_64 = x1_301[@i_302]) && ((x2_63 = x2_300[@i_302]) && ((x3_62 = X[@i_302]) && ((x4_61 = Y[@i_140[@i_302]]) && (x5_60 = K_u_1533[@i_302]))))) then
  (
    out(c21[!_59], r_296[@i_302])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying remove assignments of binder K_u_1530 yields

Game 25 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_148 <= qD suchthat defined(@2_m[@i_148], @2_kd[@i_148], @1_x_1092[@i_148], @2_r4_84[@i_148]) && otheruses(@1_x_1092[@i_148]) && ((Ystar_u = @2_m[@i_148]) && (pw = @2_kd[@i_148])) then
  (
    let K_u_1530: G = cst_G in
    let x1_283: host = U in
    let x2_282: host = S in
    find [unique] @i_355 <= qH1 suchthat defined(x1_64[@i_355], x2_63[@i_355], x3_62[@i_355], x4_61[@i_355], x5_60[@i_355], r_248[@i_355]) && otheruses(r_248[@i_355]) && ((x1_283 = x1_64[@i_355]) && ((x2_282 = x2_63[@i_355]) && ((X = x3_62[@i_355]) && ((exp(g, @1_x_1092[@i_148]) = x4_61[@i_355]) && (exp(g, mult(@1_x_1092[@i_148], x)) = x5_60[@i_355]))))) then
    (
      out(c6[!_53], r_248[@i_355]);
      in(c9[!_53], ());
      let x1_714: host = U in
      let x2_713: host = S in
      find [unique] @i_841 <= qH0 suchthat defined(x1_69[@i_841], x2_68[@i_841], x3_67[@i_841], x4_66[@i_841], x5_65[@i_841], r_673[@i_841]) && otheruses(r_673[@i_841]) && ((x1_714 = x1_69[@i_841]) && ((x2_713 = x2_68[@i_841]) && ((X = x3_67[@i_841]) && ((exp(g, @1_x_1092[@i_148]) = x4_66[@i_841]) && (exp(g, mult(@1_x_1092[@i_148], x)) = x5_65[@i_841]))))) then
      (
        let sk_u: hash0 = r_673[@i_841]
      )
      else
      (
        new r_709: hash0;
        let sk_u: hash0 = r_709
      )
    )
    else
    (
      new r_278: hash1;
      out(c6[!_53], r_278);
      in(c9[!_53], ());
      let x1_708: host = U in
      let x2_707: host = S in
      find [unique] @i_828 <= qH0 suchthat defined(x1_69[@i_828], x2_68[@i_828], x3_67[@i_828], x4_66[@i_828], x5_65[@i_828], r_673[@i_828]) && otheruses(r_673[@i_828]) && ((x1_708 = x1_69[@i_828]) && ((x2_707 = x2_68[@i_828]) && ((X = x3_67[@i_828]) && ((exp(g, @1_x_1092[@i_148]) = x4_66[@i_828]) && (exp(g, mult(@1_x_1092[@i_148], x)) = x5_65[@i_828]))))) then
      (
        let sk_u: hash0 = r_673[@i_828]
      )
      else
      (
        new r_703: hash0;
        let sk_u: hash0 = r_703
      )
    )
  )
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], @1_x_1271[@i_144], @2_r4_96[@i_144]) && otheruses(@1_x_1271[@i_144]) && (Ystar_u = Ystar_u[@i_144]) then
  (
    let K_u_1531: G = exp(g, mult(@1_x_1271[@i_144], x)) in
    let x1_289: host = U in
    let x2_288: host = S in
    find [unique] @i_364 <= qH1 suchthat defined(x1_64[@i_364], x2_63[@i_364], x3_62[@i_364], x4_61[@i_364], x5_60[@i_364], r_248[@i_364]) && otheruses(r_248[@i_364]) && ((x1_289 = x1_64[@i_364]) && ((x2_288 = x2_63[@i_364]) && ((X = x3_62[@i_364]) && ((exp(g, @1_x_1271[@i_144]) = x4_61[@i_364]) && (K_u_1531 = x5_60[@i_364]))))) then
    (
      out(c6[!_53], r_248[@i_364]);
      in(c9[!_53], ());
      let x1_726: host = U in
      let x2_725: host = S in
      find [unique] @i_867 <= qH0 suchthat defined(x1_69[@i_867], x2_68[@i_867], x3_67[@i_867], x4_66[@i_867], x5_65[@i_867], r_673[@i_867]) && otheruses(r_673[@i_867]) && ((x1_726 = x1_69[@i_867]) && ((x2_725 = x2_68[@i_867]) && ((X = x3_67[@i_867]) && ((exp(g, @1_x_1271[@i_144]) = x4_66[@i_867]) && (K_u_1531 = x5_65[@i_867]))))) then
      (
        let sk_u: hash0 = r_673[@i_867]
      )
      else
      (
        new r_721: hash0;
        let sk_u: hash0 = r_721
      )
    )
    else
    (
      new r_284: hash1;
      out(c6[!_53], r_284);
      in(c9[!_53], ());
      let x1_720: host = U in
      let x2_719: host = S in
      find [unique] @i_854 <= qH0 suchthat defined(x1_69[@i_854], x2_68[@i_854], x3_67[@i_854], x4_66[@i_854], x5_65[@i_854], r_673[@i_854]) && otheruses(r_673[@i_854]) && ((x1_720 = x1_69[@i_854]) && ((x2_719 = x2_68[@i_854]) && ((X = x3_67[@i_854]) && ((exp(g, @1_x_1271[@i_144]) = x4_66[@i_854]) && (K_u_1531 = x5_65[@i_854]))))) then
      (
        let sk_u: hash0 = r_673[@i_854]
      )
      else
      (
        new r_715: hash0;
        let sk_u: hash0 = r_715
      )
    )
  )
  orfind @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  orfind @i_141 <= NP suchthat defined(@2_r2_90[@i_141], yp[@i_141], Yp[@i_141]) && otheruses(@2_r2_90[@i_141]) && (Ystar_u = @2_r2_90[@i_141]) then
  (
    let K_u_1532: G = exp(g, mult(yp[@i_141], x)) in
    let x1_295: host = U in
    let x2_294: host = S in
    find [unique] @i_373 <= qH1 suchthat defined(x1_64[@i_373], x2_63[@i_373], x3_62[@i_373], x4_61[@i_373], x5_60[@i_373], r_248[@i_373]) && otheruses(r_248[@i_373]) && ((x1_295 = x1_64[@i_373]) && ((x2_294 = x2_63[@i_373]) && ((X = x3_62[@i_373]) && ((Yp[@i_141] = x4_61[@i_373]) && (K_u_1532 = x5_60[@i_373]))))) then
    (
      out(c6[!_53], r_248[@i_373]);
      in(c9[!_53], ());
      let x1_738: host = U in
      let x2_737: host = S in
      find [unique] @i_893 <= qH0 suchthat defined(x1_69[@i_893], x2_68[@i_893], x3_67[@i_893], x4_66[@i_893], x5_65[@i_893], r_673[@i_893]) && otheruses(r_673[@i_893]) && ((x1_738 = x1_69[@i_893]) && ((x2_737 = x2_68[@i_893]) && ((X = x3_67[@i_893]) && ((Yp[@i_141] = x4_66[@i_893]) && (K_u_1532 = x5_65[@i_893]))))) then
      (
        let sk_u: hash0 = r_673[@i_893]
      )
      else
      (
        new r_733: hash0;
        let sk_u: hash0 = r_733
      )
    )
    else
    (
      new r_290: hash1;
      out(c6[!_53], r_290);
      in(c9[!_53], ());
      let x1_732: host = U in
      let x2_731: host = S in
      find [unique] @i_880 <= qH0 suchthat defined(x1_69[@i_880], x2_68[@i_880], x3_67[@i_880], x4_66[@i_880], x5_65[@i_880], r_673[@i_880]) && otheruses(r_673[@i_880]) && ((x1_732 = x1_69[@i_880]) && ((x2_731 = x2_68[@i_880]) && ((X = x3_67[@i_880]) && ((Yp[@i_141] = x4_66[@i_880]) && (K_u_1532 = x5_65[@i_880]))))) then
      (
        let sk_u: hash0 = r_673[@i_880]
      )
      else
      (
        new r_727: hash0;
        let sk_u: hash0 = r_727
      )
    )
  )
  orfind @i_140 <= NS suchthat defined(@2_r2_93[@i_140], y[@i_140], Y[@i_140]) && otheruses(@2_r2_93[@i_140]) && (Ystar_u = @2_r2_93[@i_140]) then
  (
    let K_u_1533: G = exp(g, mult(y[@i_140], x)) in
    let x1_301: host = U in
    let x2_300: host = S in
    find [unique] @i_382 <= qH1 suchthat defined(x1_64[@i_382], x2_63[@i_382], x3_62[@i_382], x4_61[@i_382], x5_60[@i_382], r_248[@i_382]) && otheruses(r_248[@i_382]) && ((x1_301 = x1_64[@i_382]) && ((x2_300 = x2_63[@i_382]) && ((X = x3_62[@i_382]) && ((Y[@i_140] = x4_61[@i_382]) && (K_u_1533 = x5_60[@i_382]))))) then
    (
      out(c6[!_53], r_248[@i_382]);
      in(c9[!_53], ());
      let x1_750: host = U in
      let x2_749: host = S in
      find [unique] @i_919 <= qH0 suchthat defined(x1_69[@i_919], x2_68[@i_919], x3_67[@i_919], x4_66[@i_919], x5_65[@i_919], r_673[@i_919]) && otheruses(r_673[@i_919]) && ((x1_750 = x1_69[@i_919]) && ((x2_749 = x2_68[@i_919]) && ((X = x3_67[@i_919]) && ((Y[@i_140] = x4_66[@i_919]) && (K_u_1533 = x5_65[@i_919]))))) then
      (
        let sk_u: hash0 = r_673[@i_919]
      )
      orfind  suchthat defined(j[@i_140], r_685[@i_140]) && otheruses(r_685[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_685[@i_140]
      )
      else
      (
        new r_745: hash0;
        let sk_u: hash0 = r_745
      )
    )
    else
    (
      new r_296: hash1;
      out(c6[!_53], r_296);
      in(c9[!_53], ());
      let x1_744: host = U in
      let x2_743: host = S in
      find [unique] @i_906 <= qH0 suchthat defined(x1_69[@i_906], x2_68[@i_906], x3_67[@i_906], x4_66[@i_906], x5_65[@i_906], r_673[@i_906]) && otheruses(r_673[@i_906]) && ((x1_744 = x1_69[@i_906]) && ((x2_743 = x2_68[@i_906]) && ((X = x3_67[@i_906]) && ((Y[@i_140] = x4_66[@i_906]) && (K_u_1533 = x5_65[@i_906]))))) then
      (
        let sk_u: hash0 = r_673[@i_906]
      )
      orfind  suchthat defined(j[@i_140], r_685[@i_140]) && otheruses(r_685[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_685[@i_140]
      )
      orfind  suchthat defined(j[@i_140], r_691[@i_140]) && otheruses(r_691[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_691[@i_140]
      )
      else
      (
        new r_739: hash0;
        let sk_u: hash0 = r_739
      )
    )
  )
  else
  (
    new @1_x_1271: exponent;
    let @2_r4_96: G = cst_G in
    let K_u_1534: G = cst_G in
    let x1_277: host = U in
    let x2_276: host = S in
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ());
    let x1_702: host = U in
    let x2_701: host = S in
    find [unique] @i_815 <= qH0 suchthat defined(x1_69[@i_815], x2_68[@i_815], x3_67[@i_815], x4_66[@i_815], x5_65[@i_815], r_673[@i_815]) && otheruses(r_673[@i_815]) && ((x1_702 = x1_69[@i_815]) && ((x2_701 = x2_68[@i_815]) && ((X = x3_67[@i_815]) && ((exp(g, @1_x_1271) = x4_66[@i_815]) && (exp(g, mult(@1_x_1271, x)) = x5_65[@i_815]))))) then
    (
      let sk_u: hash0 = r_673[@i_815]
    )
    else
    (
      new r_697: hash0;
      let sk_u: hash0 = r_697
    )
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let x1_271: host = U in
    let x2_270: host = S in
    find [unique] @i_337 <= qH1 suchthat defined(x1_64[@i_337], x2_63[@i_337], x3_62[@i_337], x4_61[@i_337], x5_60[@i_337], r_248[@i_337]) && otheruses(r_248[@i_337]) && ((x1_271 = x1_64[@i_337]) && ((x2_270 = x2_63[@i_337]) && ((X_s = x3_62[@i_337]) && ((Y = x4_61[@i_337]) && (exp(g, mult(x[j], y)) = x5_60[@i_337]))))) then
    (
      if (auth_s = r_248[@i_337]) then
      let x1_690: host = U in
      let x2_689: host = S in
      find [unique] @i_789 <= qH0 suchthat defined(x1_69[@i_789], x2_68[@i_789], x3_67[@i_789], x4_66[@i_789], x5_65[@i_789], r_673[@i_789]) && otheruses(r_673[@i_789]) && ((x1_690 = x1_69[@i_789]) && ((x2_689 = x2_68[@i_789]) && ((X_s = x3_67[@i_789]) && ((Y = x4_66[@i_789]) && (exp(g, mult(x[j], y)) = x5_65[@i_789]))))) then
      (
        let sk_s: hash0 = r_673[@i_789]
      )
      orfind  suchthat defined(@i_140[j], r_739[j]) && otheruses(r_739[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
      (
        let sk_s: hash0 = r_739[j]
      )
      orfind  suchthat defined(@i_140[j], r_745[j]) && otheruses(r_745[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
      (
        let sk_s: hash0 = r_745[j]
      )
      else
      (
        new r_685: hash0;
        let sk_s: hash0 = r_685
      )
    )
    orfind  suchthat defined(@i_140[j], r_296[j]) && otheruses(r_296[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
    (
      if (auth_s = r_296[j]) then
      let x1_696: host = U in
      let x2_695: host = S in
      find [unique] @i_802 <= qH0 suchthat defined(x1_69[@i_802], x2_68[@i_802], x3_67[@i_802], x4_66[@i_802], x5_65[@i_802], r_673[@i_802]) && otheruses(r_673[@i_802]) && ((x1_696 = x1_69[@i_802]) && ((x2_695 = x2_68[@i_802]) && ((X_s = x3_67[@i_802]) && ((Y = x4_66[@i_802]) && (exp(g, mult(x[j], y)) = x5_65[@i_802]))))) then
      (
        let sk_s: hash0 = r_673[@i_802]
      )
      orfind  suchthat defined(r_739[j]) && otheruses(r_739[j]) then
      (
        let sk_s: hash0 = r_739[j]
      )
      else
      (
        new r_691: hash0;
        let sk_s: hash0 = r_691
      )
    )
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    event Auth
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  new @2_r2_90: G;
  let x1_259: host = U in
  let x2_258: host = S in
  new r_254: hash1;
  let x1_684: host = U in
  let x2_683: host = S in
  new r_679: hash0;
  let sk_p: hash0 = r_679 in
  out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@1_x_1092[@i_118], @2_kd[@i_118], @2_m[@i_118], @2_r4_84[@i_118]) && otheruses(@1_x_1092[@i_118]) && ((@2_x = exp(g, @1_x_1092[@i_118])) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_114 <= NU suchthat defined(@1_x_1271[@i_114], Ystar_u[@i_114], @2_r4_96[@i_114]) && otheruses(@1_x_1271[@i_114]) && ((@2_x = exp(g, @1_x_1271[@i_114])) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], Ystar_u[@i_114])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = Yp[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@2_m[@i_108], @2_kd[@i_108], @1_x_1092[@i_108], @2_r4_84[@i_108]) && otheruses(@1_x_1092[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], exp(g, @1_x_1092[@i_108]))
  )
  orfind @i_104 <= NU suchthat defined(Ystar_u[@i_104], @1_x_1271[@i_104], @2_r4_96[@i_104]) && otheruses(@1_x_1271[@i_104]) && ((@2_m = Ystar_u[@i_104]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], exp(g, @1_x_1271[@i_104]))
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@2_r2_90[@i_101], Yp[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Yp[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_r2_93[@i_100], Y[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @1_x_1092: exponent;
    let @2_r4_84: G = cst_G in
    out(@2_c4[!_57], exp(g, @1_x_1092))
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  find [unique] @i_763 <= qH0 suchthat defined(x1_69[@i_763], x2_68[@i_763], x3_67[@i_763], x4_66[@i_763], x5_65[@i_763], r_673[@i_763]) && otheruses(r_673[@i_763]) && ((x1_69 = x1_69[@i_763]) && ((x2_68 = x2_68[@i_763]) && ((x3_67 = x3_67[@i_763]) && ((x4_66 = x4_66[@i_763]) && (x5_65 = x5_65[@i_763]))))) then
  (
    out(c20[!_58], r_673[@i_763])
  )
  orfind @i_762 <= NP suchthat defined(x1_684[@i_762], x2_683[@i_762], Xp[@i_762], Yp[@i_762], xp[@i_762], yp[@i_762], r_679[@i_762]) && otheruses(r_679[@i_762]) && ((x1_69 = x1_684[@i_762]) && ((x2_68 = x2_683[@i_762]) && ((x3_67 = Xp[@i_762]) && ((x4_66 = Yp[@i_762]) && (x5_65 = exp(g, mult(xp[@i_762], yp[@i_762]))))))) then
  (
    out(c20[!_58], r_679[@i_762])
  )
  orfind @i_761 <= NS suchthat defined(x1_690[@i_761], x2_689[@i_761], X_s[@i_761], Y[@i_761], x[j[@i_761]], y[@i_761], r_685[@i_761]) && otheruses(r_685[@i_761]) && ((x1_69 = x1_690[@i_761]) && ((x2_68 = x2_689[@i_761]) && ((x3_67 = X_s[@i_761]) && ((x4_66 = Y[@i_761]) && (x5_65 = exp(g, mult(x[j[@i_761]], y[@i_761]))))))) then
  (
    out(c20[!_58], r_685[@i_761])
  )
  orfind @i_760 <= NS suchthat defined(x1_696[@i_760], x2_695[@i_760], X_s[@i_760], Y[@i_760], x[j[@i_760]], y[@i_760], r_691[@i_760]) && otheruses(r_691[@i_760]) && ((x1_69 = x1_696[@i_760]) && ((x2_68 = x2_695[@i_760]) && ((x3_67 = X_s[@i_760]) && ((x4_66 = Y[@i_760]) && (x5_65 = exp(g, mult(x[j[@i_760]], y[@i_760]))))))) then
  (
    out(c20[!_58], r_691[@i_760])
  )
  orfind @i_759 <= NU suchthat defined(x[@i_759], K_u_1534[@i_759], x1_702[@i_759], x2_701[@i_759], X[@i_759], @1_x_1271[@i_759], r_697[@i_759]) && otheruses(r_697[@i_759]) && ((x1_69 = x1_702[@i_759]) && ((x2_68 = x2_701[@i_759]) && ((x3_67 = X[@i_759]) && ((x4_66 = exp(g, @1_x_1271[@i_759])) && (x5_65 = exp(g, mult(@1_x_1271[@i_759], x[@i_759]))))))) then
  (
    out(c20[!_58], r_697[@i_759])
  )
  orfind @i_758 <= NU suchthat defined(x[@i_758], K_u_1530[@i_758], x1_708[@i_758], x2_707[@i_758], X[@i_758], @1_x_1092[@i_148[@i_758]], r_703[@i_758]) && otheruses(r_703[@i_758]) && ((x1_69 = x1_708[@i_758]) && ((x2_68 = x2_707[@i_758]) && ((x3_67 = X[@i_758]) && ((x4_66 = exp(g, @1_x_1092[@i_148[@i_758]])) && (x5_65 = exp(g, mult(@1_x_1092[@i_148[@i_758]], x[@i_758]))))))) then
  (
    out(c20[!_58], r_703[@i_758])
  )
  orfind @i_757 <= NU suchthat defined(x[@i_757], K_u_1530[@i_757], x1_714[@i_757], x2_713[@i_757], X[@i_757], @1_x_1092[@i_148[@i_757]], r_709[@i_757]) && otheruses(r_709[@i_757]) && ((x1_69 = x1_714[@i_757]) && ((x2_68 = x2_713[@i_757]) && ((x3_67 = X[@i_757]) && ((x4_66 = exp(g, @1_x_1092[@i_148[@i_757]])) && (x5_65 = exp(g, mult(@1_x_1092[@i_148[@i_757]], x[@i_757]))))))) then
  (
    out(c20[!_58], r_709[@i_757])
  )
  orfind @i_756 <= NU suchthat defined(x1_720[@i_756], x2_719[@i_756], X[@i_756], @1_x_1271[@i_144[@i_756]], K_u_1531[@i_756], r_715[@i_756]) && otheruses(r_715[@i_756]) && ((x1_69 = x1_720[@i_756]) && ((x2_68 = x2_719[@i_756]) && ((x3_67 = X[@i_756]) && ((x4_66 = exp(g, @1_x_1271[@i_144[@i_756]])) && (x5_65 = K_u_1531[@i_756]))))) then
  (
    out(c20[!_58], r_715[@i_756])
  )
  orfind @i_755 <= NU suchthat defined(x1_726[@i_755], x2_725[@i_755], X[@i_755], @1_x_1271[@i_144[@i_755]], K_u_1531[@i_755], r_721[@i_755]) && otheruses(r_721[@i_755]) && ((x1_69 = x1_726[@i_755]) && ((x2_68 = x2_725[@i_755]) && ((x3_67 = X[@i_755]) && ((x4_66 = exp(g, @1_x_1271[@i_144[@i_755]])) && (x5_65 = K_u_1531[@i_755]))))) then
  (
    out(c20[!_58], r_721[@i_755])
  )
  orfind @i_754 <= NU suchthat defined(x1_732[@i_754], x2_731[@i_754], X[@i_754], Yp[@i_141[@i_754]], K_u_1532[@i_754], r_727[@i_754]) && otheruses(r_727[@i_754]) && ((x1_69 = x1_732[@i_754]) && ((x2_68 = x2_731[@i_754]) && ((x3_67 = X[@i_754]) && ((x4_66 = Yp[@i_141[@i_754]]) && (x5_65 = K_u_1532[@i_754]))))) then
  (
    out(c20[!_58], r_727[@i_754])
  )
  orfind @i_753 <= NU suchthat defined(x1_738[@i_753], x2_737[@i_753], X[@i_753], Yp[@i_141[@i_753]], K_u_1532[@i_753], r_733[@i_753]) && otheruses(r_733[@i_753]) && ((x1_69 = x1_738[@i_753]) && ((x2_68 = x2_737[@i_753]) && ((x3_67 = X[@i_753]) && ((x4_66 = Yp[@i_141[@i_753]]) && (x5_65 = K_u_1532[@i_753]))))) then
  (
    out(c20[!_58], r_733[@i_753])
  )
  orfind @i_752 <= NU suchthat defined(x1_744[@i_752], x2_743[@i_752], X[@i_752], Y[@i_140[@i_752]], K_u_1533[@i_752], r_739[@i_752]) && otheruses(r_739[@i_752]) && ((x1_69 = x1_744[@i_752]) && ((x2_68 = x2_743[@i_752]) && ((x3_67 = X[@i_752]) && ((x4_66 = Y[@i_140[@i_752]]) && (x5_65 = K_u_1533[@i_752]))))) then
  (
    out(c20[!_58], r_739[@i_752])
  )
  orfind @i_751 <= NU suchthat defined(x1_750[@i_751], x2_749[@i_751], X[@i_751], Y[@i_140[@i_751]], K_u_1533[@i_751], r_745[@i_751]) && otheruses(r_745[@i_751]) && ((x1_69 = x1_750[@i_751]) && ((x2_68 = x2_749[@i_751]) && ((x3_67 = X[@i_751]) && ((x4_66 = Y[@i_140[@i_751]]) && (x5_65 = K_u_1533[@i_751]))))) then
  (
    out(c20[!_58], r_745[@i_751])
  )
  else
  (
    new r_673: hash0;
    out(c20[!_58], r_673)
  )
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  orfind @i_309 <= NP suchthat defined(x1_259[@i_309], x2_258[@i_309], Xp[@i_309], Yp[@i_309], xp[@i_309], yp[@i_309], r_254[@i_309]) && otheruses(r_254[@i_309]) && ((x1_64 = x1_259[@i_309]) && ((x2_63 = x2_258[@i_309]) && ((x3_62 = Xp[@i_309]) && ((x4_61 = Yp[@i_309]) && (x5_60 = exp(g, mult(xp[@i_309], yp[@i_309]))))))) then
  (
    out(c21[!_59], r_254[@i_309])
  )
  orfind @i_306 <= NU suchthat defined(x[@i_306], K_u_1534[@i_306], x1_277[@i_306], x2_276[@i_306], X[@i_306], @1_x_1271[@i_306], r_272[@i_306]) && otheruses(r_272[@i_306]) && ((x1_64 = x1_277[@i_306]) && ((x2_63 = x2_276[@i_306]) && ((x3_62 = X[@i_306]) && ((x4_61 = exp(g, @1_x_1271[@i_306])) && (x5_60 = exp(g, mult(@1_x_1271[@i_306], x[@i_306]))))))) then
  (
    out(c21[!_59], r_272[@i_306])
  )
  orfind @i_305 <= NU suchthat defined(x[@i_305], K_u_1530[@i_305], x1_283[@i_305], x2_282[@i_305], X[@i_305], @1_x_1092[@i_148[@i_305]], r_278[@i_305]) && otheruses(r_278[@i_305]) && ((x1_64 = x1_283[@i_305]) && ((x2_63 = x2_282[@i_305]) && ((x3_62 = X[@i_305]) && ((x4_61 = exp(g, @1_x_1092[@i_148[@i_305]])) && (x5_60 = exp(g, mult(@1_x_1092[@i_148[@i_305]], x[@i_305]))))))) then
  (
    out(c21[!_59], r_278[@i_305])
  )
  orfind @i_304 <= NU suchthat defined(x1_289[@i_304], x2_288[@i_304], X[@i_304], @1_x_1271[@i_144[@i_304]], K_u_1531[@i_304], r_284[@i_304]) && otheruses(r_284[@i_304]) && ((x1_64 = x1_289[@i_304]) && ((x2_63 = x2_288[@i_304]) && ((x3_62 = X[@i_304]) && ((x4_61 = exp(g, @1_x_1271[@i_144[@i_304]])) && (x5_60 = K_u_1531[@i_304]))))) then
  (
    out(c21[!_59], r_284[@i_304])
  )
  orfind @i_303 <= NU suchthat defined(x1_295[@i_303], x2_294[@i_303], X[@i_303], Yp[@i_141[@i_303]], K_u_1532[@i_303], r_290[@i_303]) && otheruses(r_290[@i_303]) && ((x1_64 = x1_295[@i_303]) && ((x2_63 = x2_294[@i_303]) && ((x3_62 = X[@i_303]) && ((x4_61 = Yp[@i_141[@i_303]]) && (x5_60 = K_u_1532[@i_303]))))) then
  (
    out(c21[!_59], r_290[@i_303])
  )
  orfind @i_302 <= NU suchthat defined(x1_301[@i_302], x2_300[@i_302], X[@i_302], Y[@i_140[@i_302]], K_u_1533[@i_302], r_296[@i_302]) && otheruses(r_296[@i_302]) && ((x1_64 = x1_301[@i_302]) && ((x2_63 = x2_300[@i_302]) && ((x3_62 = X[@i_302]) && ((x4_61 = Y[@i_140[@i_302]]) && (x5_60 = K_u_1533[@i_302]))))) then
  (
    out(c21[!_59], r_296[@i_302])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying remove assignments of binder K_u_1531 yields

Game 26 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_148 <= qD suchthat defined(@2_m[@i_148], @2_kd[@i_148], @1_x_1092[@i_148], @2_r4_84[@i_148]) && otheruses(@1_x_1092[@i_148]) && ((Ystar_u = @2_m[@i_148]) && (pw = @2_kd[@i_148])) then
  (
    let K_u_1530: G = cst_G in
    let x1_283: host = U in
    let x2_282: host = S in
    find [unique] @i_355 <= qH1 suchthat defined(x1_64[@i_355], x2_63[@i_355], x3_62[@i_355], x4_61[@i_355], x5_60[@i_355], r_248[@i_355]) && otheruses(r_248[@i_355]) && ((x1_283 = x1_64[@i_355]) && ((x2_282 = x2_63[@i_355]) && ((X = x3_62[@i_355]) && ((exp(g, @1_x_1092[@i_148]) = x4_61[@i_355]) && (exp(g, mult(@1_x_1092[@i_148], x)) = x5_60[@i_355]))))) then
    (
      out(c6[!_53], r_248[@i_355]);
      in(c9[!_53], ());
      let x1_714: host = U in
      let x2_713: host = S in
      find [unique] @i_841 <= qH0 suchthat defined(x1_69[@i_841], x2_68[@i_841], x3_67[@i_841], x4_66[@i_841], x5_65[@i_841], r_673[@i_841]) && otheruses(r_673[@i_841]) && ((x1_714 = x1_69[@i_841]) && ((x2_713 = x2_68[@i_841]) && ((X = x3_67[@i_841]) && ((exp(g, @1_x_1092[@i_148]) = x4_66[@i_841]) && (exp(g, mult(@1_x_1092[@i_148], x)) = x5_65[@i_841]))))) then
      (
        let sk_u: hash0 = r_673[@i_841]
      )
      else
      (
        new r_709: hash0;
        let sk_u: hash0 = r_709
      )
    )
    else
    (
      new r_278: hash1;
      out(c6[!_53], r_278);
      in(c9[!_53], ());
      let x1_708: host = U in
      let x2_707: host = S in
      find [unique] @i_828 <= qH0 suchthat defined(x1_69[@i_828], x2_68[@i_828], x3_67[@i_828], x4_66[@i_828], x5_65[@i_828], r_673[@i_828]) && otheruses(r_673[@i_828]) && ((x1_708 = x1_69[@i_828]) && ((x2_707 = x2_68[@i_828]) && ((X = x3_67[@i_828]) && ((exp(g, @1_x_1092[@i_148]) = x4_66[@i_828]) && (exp(g, mult(@1_x_1092[@i_148], x)) = x5_65[@i_828]))))) then
      (
        let sk_u: hash0 = r_673[@i_828]
      )
      else
      (
        new r_703: hash0;
        let sk_u: hash0 = r_703
      )
    )
  )
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], @1_x_1271[@i_144], @2_r4_96[@i_144]) && otheruses(@1_x_1271[@i_144]) && (Ystar_u = Ystar_u[@i_144]) then
  (
    let K_u_1531: G = cst_G in
    let x1_289: host = U in
    let x2_288: host = S in
    find [unique] @i_364 <= qH1 suchthat defined(x1_64[@i_364], x2_63[@i_364], x3_62[@i_364], x4_61[@i_364], x5_60[@i_364], r_248[@i_364]) && otheruses(r_248[@i_364]) && ((x1_289 = x1_64[@i_364]) && ((x2_288 = x2_63[@i_364]) && ((X = x3_62[@i_364]) && ((exp(g, @1_x_1271[@i_144]) = x4_61[@i_364]) && (exp(g, mult(@1_x_1271[@i_144], x)) = x5_60[@i_364]))))) then
    (
      out(c6[!_53], r_248[@i_364]);
      in(c9[!_53], ());
      let x1_726: host = U in
      let x2_725: host = S in
      find [unique] @i_867 <= qH0 suchthat defined(x1_69[@i_867], x2_68[@i_867], x3_67[@i_867], x4_66[@i_867], x5_65[@i_867], r_673[@i_867]) && otheruses(r_673[@i_867]) && ((x1_726 = x1_69[@i_867]) && ((x2_725 = x2_68[@i_867]) && ((X = x3_67[@i_867]) && ((exp(g, @1_x_1271[@i_144]) = x4_66[@i_867]) && (exp(g, mult(@1_x_1271[@i_144], x)) = x5_65[@i_867]))))) then
      (
        let sk_u: hash0 = r_673[@i_867]
      )
      else
      (
        new r_721: hash0;
        let sk_u: hash0 = r_721
      )
    )
    else
    (
      new r_284: hash1;
      out(c6[!_53], r_284);
      in(c9[!_53], ());
      let x1_720: host = U in
      let x2_719: host = S in
      find [unique] @i_854 <= qH0 suchthat defined(x1_69[@i_854], x2_68[@i_854], x3_67[@i_854], x4_66[@i_854], x5_65[@i_854], r_673[@i_854]) && otheruses(r_673[@i_854]) && ((x1_720 = x1_69[@i_854]) && ((x2_719 = x2_68[@i_854]) && ((X = x3_67[@i_854]) && ((exp(g, @1_x_1271[@i_144]) = x4_66[@i_854]) && (exp(g, mult(@1_x_1271[@i_144], x)) = x5_65[@i_854]))))) then
      (
        let sk_u: hash0 = r_673[@i_854]
      )
      else
      (
        new r_715: hash0;
        let sk_u: hash0 = r_715
      )
    )
  )
  orfind @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  orfind @i_141 <= NP suchthat defined(@2_r2_90[@i_141], yp[@i_141], Yp[@i_141]) && otheruses(@2_r2_90[@i_141]) && (Ystar_u = @2_r2_90[@i_141]) then
  (
    let K_u_1532: G = exp(g, mult(yp[@i_141], x)) in
    let x1_295: host = U in
    let x2_294: host = S in
    find [unique] @i_373 <= qH1 suchthat defined(x1_64[@i_373], x2_63[@i_373], x3_62[@i_373], x4_61[@i_373], x5_60[@i_373], r_248[@i_373]) && otheruses(r_248[@i_373]) && ((x1_295 = x1_64[@i_373]) && ((x2_294 = x2_63[@i_373]) && ((X = x3_62[@i_373]) && ((Yp[@i_141] = x4_61[@i_373]) && (K_u_1532 = x5_60[@i_373]))))) then
    (
      out(c6[!_53], r_248[@i_373]);
      in(c9[!_53], ());
      let x1_738: host = U in
      let x2_737: host = S in
      find [unique] @i_893 <= qH0 suchthat defined(x1_69[@i_893], x2_68[@i_893], x3_67[@i_893], x4_66[@i_893], x5_65[@i_893], r_673[@i_893]) && otheruses(r_673[@i_893]) && ((x1_738 = x1_69[@i_893]) && ((x2_737 = x2_68[@i_893]) && ((X = x3_67[@i_893]) && ((Yp[@i_141] = x4_66[@i_893]) && (K_u_1532 = x5_65[@i_893]))))) then
      (
        let sk_u: hash0 = r_673[@i_893]
      )
      else
      (
        new r_733: hash0;
        let sk_u: hash0 = r_733
      )
    )
    else
    (
      new r_290: hash1;
      out(c6[!_53], r_290);
      in(c9[!_53], ());
      let x1_732: host = U in
      let x2_731: host = S in
      find [unique] @i_880 <= qH0 suchthat defined(x1_69[@i_880], x2_68[@i_880], x3_67[@i_880], x4_66[@i_880], x5_65[@i_880], r_673[@i_880]) && otheruses(r_673[@i_880]) && ((x1_732 = x1_69[@i_880]) && ((x2_731 = x2_68[@i_880]) && ((X = x3_67[@i_880]) && ((Yp[@i_141] = x4_66[@i_880]) && (K_u_1532 = x5_65[@i_880]))))) then
      (
        let sk_u: hash0 = r_673[@i_880]
      )
      else
      (
        new r_727: hash0;
        let sk_u: hash0 = r_727
      )
    )
  )
  orfind @i_140 <= NS suchthat defined(@2_r2_93[@i_140], y[@i_140], Y[@i_140]) && otheruses(@2_r2_93[@i_140]) && (Ystar_u = @2_r2_93[@i_140]) then
  (
    let K_u_1533: G = exp(g, mult(y[@i_140], x)) in
    let x1_301: host = U in
    let x2_300: host = S in
    find [unique] @i_382 <= qH1 suchthat defined(x1_64[@i_382], x2_63[@i_382], x3_62[@i_382], x4_61[@i_382], x5_60[@i_382], r_248[@i_382]) && otheruses(r_248[@i_382]) && ((x1_301 = x1_64[@i_382]) && ((x2_300 = x2_63[@i_382]) && ((X = x3_62[@i_382]) && ((Y[@i_140] = x4_61[@i_382]) && (K_u_1533 = x5_60[@i_382]))))) then
    (
      out(c6[!_53], r_248[@i_382]);
      in(c9[!_53], ());
      let x1_750: host = U in
      let x2_749: host = S in
      find [unique] @i_919 <= qH0 suchthat defined(x1_69[@i_919], x2_68[@i_919], x3_67[@i_919], x4_66[@i_919], x5_65[@i_919], r_673[@i_919]) && otheruses(r_673[@i_919]) && ((x1_750 = x1_69[@i_919]) && ((x2_749 = x2_68[@i_919]) && ((X = x3_67[@i_919]) && ((Y[@i_140] = x4_66[@i_919]) && (K_u_1533 = x5_65[@i_919]))))) then
      (
        let sk_u: hash0 = r_673[@i_919]
      )
      orfind  suchthat defined(j[@i_140], r_685[@i_140]) && otheruses(r_685[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_685[@i_140]
      )
      else
      (
        new r_745: hash0;
        let sk_u: hash0 = r_745
      )
    )
    else
    (
      new r_296: hash1;
      out(c6[!_53], r_296);
      in(c9[!_53], ());
      let x1_744: host = U in
      let x2_743: host = S in
      find [unique] @i_906 <= qH0 suchthat defined(x1_69[@i_906], x2_68[@i_906], x3_67[@i_906], x4_66[@i_906], x5_65[@i_906], r_673[@i_906]) && otheruses(r_673[@i_906]) && ((x1_744 = x1_69[@i_906]) && ((x2_743 = x2_68[@i_906]) && ((X = x3_67[@i_906]) && ((Y[@i_140] = x4_66[@i_906]) && (K_u_1533 = x5_65[@i_906]))))) then
      (
        let sk_u: hash0 = r_673[@i_906]
      )
      orfind  suchthat defined(j[@i_140], r_685[@i_140]) && otheruses(r_685[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_685[@i_140]
      )
      orfind  suchthat defined(j[@i_140], r_691[@i_140]) && otheruses(r_691[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_691[@i_140]
      )
      else
      (
        new r_739: hash0;
        let sk_u: hash0 = r_739
      )
    )
  )
  else
  (
    new @1_x_1271: exponent;
    let @2_r4_96: G = cst_G in
    let K_u_1534: G = cst_G in
    let x1_277: host = U in
    let x2_276: host = S in
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ());
    let x1_702: host = U in
    let x2_701: host = S in
    find [unique] @i_815 <= qH0 suchthat defined(x1_69[@i_815], x2_68[@i_815], x3_67[@i_815], x4_66[@i_815], x5_65[@i_815], r_673[@i_815]) && otheruses(r_673[@i_815]) && ((x1_702 = x1_69[@i_815]) && ((x2_701 = x2_68[@i_815]) && ((X = x3_67[@i_815]) && ((exp(g, @1_x_1271) = x4_66[@i_815]) && (exp(g, mult(@1_x_1271, x)) = x5_65[@i_815]))))) then
    (
      let sk_u: hash0 = r_673[@i_815]
    )
    else
    (
      new r_697: hash0;
      let sk_u: hash0 = r_697
    )
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let x1_271: host = U in
    let x2_270: host = S in
    find [unique] @i_337 <= qH1 suchthat defined(x1_64[@i_337], x2_63[@i_337], x3_62[@i_337], x4_61[@i_337], x5_60[@i_337], r_248[@i_337]) && otheruses(r_248[@i_337]) && ((x1_271 = x1_64[@i_337]) && ((x2_270 = x2_63[@i_337]) && ((X_s = x3_62[@i_337]) && ((Y = x4_61[@i_337]) && (exp(g, mult(x[j], y)) = x5_60[@i_337]))))) then
    (
      if (auth_s = r_248[@i_337]) then
      let x1_690: host = U in
      let x2_689: host = S in
      find [unique] @i_789 <= qH0 suchthat defined(x1_69[@i_789], x2_68[@i_789], x3_67[@i_789], x4_66[@i_789], x5_65[@i_789], r_673[@i_789]) && otheruses(r_673[@i_789]) && ((x1_690 = x1_69[@i_789]) && ((x2_689 = x2_68[@i_789]) && ((X_s = x3_67[@i_789]) && ((Y = x4_66[@i_789]) && (exp(g, mult(x[j], y)) = x5_65[@i_789]))))) then
      (
        let sk_s: hash0 = r_673[@i_789]
      )
      orfind  suchthat defined(@i_140[j], r_739[j]) && otheruses(r_739[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
      (
        let sk_s: hash0 = r_739[j]
      )
      orfind  suchthat defined(@i_140[j], r_745[j]) && otheruses(r_745[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
      (
        let sk_s: hash0 = r_745[j]
      )
      else
      (
        new r_685: hash0;
        let sk_s: hash0 = r_685
      )
    )
    orfind  suchthat defined(@i_140[j], r_296[j]) && otheruses(r_296[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
    (
      if (auth_s = r_296[j]) then
      let x1_696: host = U in
      let x2_695: host = S in
      find [unique] @i_802 <= qH0 suchthat defined(x1_69[@i_802], x2_68[@i_802], x3_67[@i_802], x4_66[@i_802], x5_65[@i_802], r_673[@i_802]) && otheruses(r_673[@i_802]) && ((x1_696 = x1_69[@i_802]) && ((x2_695 = x2_68[@i_802]) && ((X_s = x3_67[@i_802]) && ((Y = x4_66[@i_802]) && (exp(g, mult(x[j], y)) = x5_65[@i_802]))))) then
      (
        let sk_s: hash0 = r_673[@i_802]
      )
      orfind  suchthat defined(r_739[j]) && otheruses(r_739[j]) then
      (
        let sk_s: hash0 = r_739[j]
      )
      else
      (
        new r_691: hash0;
        let sk_s: hash0 = r_691
      )
    )
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    event Auth
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  new @2_r2_90: G;
  let x1_259: host = U in
  let x2_258: host = S in
  new r_254: hash1;
  let x1_684: host = U in
  let x2_683: host = S in
  new r_679: hash0;
  let sk_p: hash0 = r_679 in
  out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@1_x_1092[@i_118], @2_kd[@i_118], @2_m[@i_118], @2_r4_84[@i_118]) && otheruses(@1_x_1092[@i_118]) && ((@2_x = exp(g, @1_x_1092[@i_118])) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_114 <= NU suchthat defined(@1_x_1271[@i_114], Ystar_u[@i_114], @2_r4_96[@i_114]) && otheruses(@1_x_1271[@i_114]) && ((@2_x = exp(g, @1_x_1271[@i_114])) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], Ystar_u[@i_114])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = Yp[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@2_m[@i_108], @2_kd[@i_108], @1_x_1092[@i_108], @2_r4_84[@i_108]) && otheruses(@1_x_1092[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], exp(g, @1_x_1092[@i_108]))
  )
  orfind @i_104 <= NU suchthat defined(Ystar_u[@i_104], @1_x_1271[@i_104], @2_r4_96[@i_104]) && otheruses(@1_x_1271[@i_104]) && ((@2_m = Ystar_u[@i_104]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], exp(g, @1_x_1271[@i_104]))
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@2_r2_90[@i_101], Yp[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Yp[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_r2_93[@i_100], Y[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @1_x_1092: exponent;
    let @2_r4_84: G = cst_G in
    out(@2_c4[!_57], exp(g, @1_x_1092))
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  find [unique] @i_763 <= qH0 suchthat defined(x1_69[@i_763], x2_68[@i_763], x3_67[@i_763], x4_66[@i_763], x5_65[@i_763], r_673[@i_763]) && otheruses(r_673[@i_763]) && ((x1_69 = x1_69[@i_763]) && ((x2_68 = x2_68[@i_763]) && ((x3_67 = x3_67[@i_763]) && ((x4_66 = x4_66[@i_763]) && (x5_65 = x5_65[@i_763]))))) then
  (
    out(c20[!_58], r_673[@i_763])
  )
  orfind @i_762 <= NP suchthat defined(x1_684[@i_762], x2_683[@i_762], Xp[@i_762], Yp[@i_762], xp[@i_762], yp[@i_762], r_679[@i_762]) && otheruses(r_679[@i_762]) && ((x1_69 = x1_684[@i_762]) && ((x2_68 = x2_683[@i_762]) && ((x3_67 = Xp[@i_762]) && ((x4_66 = Yp[@i_762]) && (x5_65 = exp(g, mult(xp[@i_762], yp[@i_762]))))))) then
  (
    out(c20[!_58], r_679[@i_762])
  )
  orfind @i_761 <= NS suchthat defined(x1_690[@i_761], x2_689[@i_761], X_s[@i_761], Y[@i_761], x[j[@i_761]], y[@i_761], r_685[@i_761]) && otheruses(r_685[@i_761]) && ((x1_69 = x1_690[@i_761]) && ((x2_68 = x2_689[@i_761]) && ((x3_67 = X_s[@i_761]) && ((x4_66 = Y[@i_761]) && (x5_65 = exp(g, mult(x[j[@i_761]], y[@i_761]))))))) then
  (
    out(c20[!_58], r_685[@i_761])
  )
  orfind @i_760 <= NS suchthat defined(x1_696[@i_760], x2_695[@i_760], X_s[@i_760], Y[@i_760], x[j[@i_760]], y[@i_760], r_691[@i_760]) && otheruses(r_691[@i_760]) && ((x1_69 = x1_696[@i_760]) && ((x2_68 = x2_695[@i_760]) && ((x3_67 = X_s[@i_760]) && ((x4_66 = Y[@i_760]) && (x5_65 = exp(g, mult(x[j[@i_760]], y[@i_760]))))))) then
  (
    out(c20[!_58], r_691[@i_760])
  )
  orfind @i_759 <= NU suchthat defined(x[@i_759], K_u_1534[@i_759], x1_702[@i_759], x2_701[@i_759], X[@i_759], @1_x_1271[@i_759], r_697[@i_759]) && otheruses(r_697[@i_759]) && ((x1_69 = x1_702[@i_759]) && ((x2_68 = x2_701[@i_759]) && ((x3_67 = X[@i_759]) && ((x4_66 = exp(g, @1_x_1271[@i_759])) && (x5_65 = exp(g, mult(@1_x_1271[@i_759], x[@i_759]))))))) then
  (
    out(c20[!_58], r_697[@i_759])
  )
  orfind @i_758 <= NU suchthat defined(x[@i_758], K_u_1530[@i_758], x1_708[@i_758], x2_707[@i_758], X[@i_758], @1_x_1092[@i_148[@i_758]], r_703[@i_758]) && otheruses(r_703[@i_758]) && ((x1_69 = x1_708[@i_758]) && ((x2_68 = x2_707[@i_758]) && ((x3_67 = X[@i_758]) && ((x4_66 = exp(g, @1_x_1092[@i_148[@i_758]])) && (x5_65 = exp(g, mult(@1_x_1092[@i_148[@i_758]], x[@i_758]))))))) then
  (
    out(c20[!_58], r_703[@i_758])
  )
  orfind @i_757 <= NU suchthat defined(x[@i_757], K_u_1530[@i_757], x1_714[@i_757], x2_713[@i_757], X[@i_757], @1_x_1092[@i_148[@i_757]], r_709[@i_757]) && otheruses(r_709[@i_757]) && ((x1_69 = x1_714[@i_757]) && ((x2_68 = x2_713[@i_757]) && ((x3_67 = X[@i_757]) && ((x4_66 = exp(g, @1_x_1092[@i_148[@i_757]])) && (x5_65 = exp(g, mult(@1_x_1092[@i_148[@i_757]], x[@i_757]))))))) then
  (
    out(c20[!_58], r_709[@i_757])
  )
  orfind @i_756 <= NU suchthat defined(x[@i_756], K_u_1531[@i_756], x1_720[@i_756], x2_719[@i_756], X[@i_756], @1_x_1271[@i_144[@i_756]], r_715[@i_756]) && otheruses(r_715[@i_756]) && ((x1_69 = x1_720[@i_756]) && ((x2_68 = x2_719[@i_756]) && ((x3_67 = X[@i_756]) && ((x4_66 = exp(g, @1_x_1271[@i_144[@i_756]])) && (x5_65 = exp(g, mult(@1_x_1271[@i_144[@i_756]], x[@i_756]))))))) then
  (
    out(c20[!_58], r_715[@i_756])
  )
  orfind @i_755 <= NU suchthat defined(x[@i_755], K_u_1531[@i_755], x1_726[@i_755], x2_725[@i_755], X[@i_755], @1_x_1271[@i_144[@i_755]], r_721[@i_755]) && otheruses(r_721[@i_755]) && ((x1_69 = x1_726[@i_755]) && ((x2_68 = x2_725[@i_755]) && ((x3_67 = X[@i_755]) && ((x4_66 = exp(g, @1_x_1271[@i_144[@i_755]])) && (x5_65 = exp(g, mult(@1_x_1271[@i_144[@i_755]], x[@i_755]))))))) then
  (
    out(c20[!_58], r_721[@i_755])
  )
  orfind @i_754 <= NU suchthat defined(x1_732[@i_754], x2_731[@i_754], X[@i_754], Yp[@i_141[@i_754]], K_u_1532[@i_754], r_727[@i_754]) && otheruses(r_727[@i_754]) && ((x1_69 = x1_732[@i_754]) && ((x2_68 = x2_731[@i_754]) && ((x3_67 = X[@i_754]) && ((x4_66 = Yp[@i_141[@i_754]]) && (x5_65 = K_u_1532[@i_754]))))) then
  (
    out(c20[!_58], r_727[@i_754])
  )
  orfind @i_753 <= NU suchthat defined(x1_738[@i_753], x2_737[@i_753], X[@i_753], Yp[@i_141[@i_753]], K_u_1532[@i_753], r_733[@i_753]) && otheruses(r_733[@i_753]) && ((x1_69 = x1_738[@i_753]) && ((x2_68 = x2_737[@i_753]) && ((x3_67 = X[@i_753]) && ((x4_66 = Yp[@i_141[@i_753]]) && (x5_65 = K_u_1532[@i_753]))))) then
  (
    out(c20[!_58], r_733[@i_753])
  )
  orfind @i_752 <= NU suchthat defined(x1_744[@i_752], x2_743[@i_752], X[@i_752], Y[@i_140[@i_752]], K_u_1533[@i_752], r_739[@i_752]) && otheruses(r_739[@i_752]) && ((x1_69 = x1_744[@i_752]) && ((x2_68 = x2_743[@i_752]) && ((x3_67 = X[@i_752]) && ((x4_66 = Y[@i_140[@i_752]]) && (x5_65 = K_u_1533[@i_752]))))) then
  (
    out(c20[!_58], r_739[@i_752])
  )
  orfind @i_751 <= NU suchthat defined(x1_750[@i_751], x2_749[@i_751], X[@i_751], Y[@i_140[@i_751]], K_u_1533[@i_751], r_745[@i_751]) && otheruses(r_745[@i_751]) && ((x1_69 = x1_750[@i_751]) && ((x2_68 = x2_749[@i_751]) && ((x3_67 = X[@i_751]) && ((x4_66 = Y[@i_140[@i_751]]) && (x5_65 = K_u_1533[@i_751]))))) then
  (
    out(c20[!_58], r_745[@i_751])
  )
  else
  (
    new r_673: hash0;
    out(c20[!_58], r_673)
  )
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  orfind @i_309 <= NP suchthat defined(x1_259[@i_309], x2_258[@i_309], Xp[@i_309], Yp[@i_309], xp[@i_309], yp[@i_309], r_254[@i_309]) && otheruses(r_254[@i_309]) && ((x1_64 = x1_259[@i_309]) && ((x2_63 = x2_258[@i_309]) && ((x3_62 = Xp[@i_309]) && ((x4_61 = Yp[@i_309]) && (x5_60 = exp(g, mult(xp[@i_309], yp[@i_309]))))))) then
  (
    out(c21[!_59], r_254[@i_309])
  )
  orfind @i_306 <= NU suchthat defined(x[@i_306], K_u_1534[@i_306], x1_277[@i_306], x2_276[@i_306], X[@i_306], @1_x_1271[@i_306], r_272[@i_306]) && otheruses(r_272[@i_306]) && ((x1_64 = x1_277[@i_306]) && ((x2_63 = x2_276[@i_306]) && ((x3_62 = X[@i_306]) && ((x4_61 = exp(g, @1_x_1271[@i_306])) && (x5_60 = exp(g, mult(@1_x_1271[@i_306], x[@i_306]))))))) then
  (
    out(c21[!_59], r_272[@i_306])
  )
  orfind @i_305 <= NU suchthat defined(x[@i_305], K_u_1530[@i_305], x1_283[@i_305], x2_282[@i_305], X[@i_305], @1_x_1092[@i_148[@i_305]], r_278[@i_305]) && otheruses(r_278[@i_305]) && ((x1_64 = x1_283[@i_305]) && ((x2_63 = x2_282[@i_305]) && ((x3_62 = X[@i_305]) && ((x4_61 = exp(g, @1_x_1092[@i_148[@i_305]])) && (x5_60 = exp(g, mult(@1_x_1092[@i_148[@i_305]], x[@i_305]))))))) then
  (
    out(c21[!_59], r_278[@i_305])
  )
  orfind @i_304 <= NU suchthat defined(x[@i_304], K_u_1531[@i_304], x1_289[@i_304], x2_288[@i_304], X[@i_304], @1_x_1271[@i_144[@i_304]], r_284[@i_304]) && otheruses(r_284[@i_304]) && ((x1_64 = x1_289[@i_304]) && ((x2_63 = x2_288[@i_304]) && ((x3_62 = X[@i_304]) && ((x4_61 = exp(g, @1_x_1271[@i_144[@i_304]])) && (x5_60 = exp(g, mult(@1_x_1271[@i_144[@i_304]], x[@i_304]))))))) then
  (
    out(c21[!_59], r_284[@i_304])
  )
  orfind @i_303 <= NU suchthat defined(x1_295[@i_303], x2_294[@i_303], X[@i_303], Yp[@i_141[@i_303]], K_u_1532[@i_303], r_290[@i_303]) && otheruses(r_290[@i_303]) && ((x1_64 = x1_295[@i_303]) && ((x2_63 = x2_294[@i_303]) && ((x3_62 = X[@i_303]) && ((x4_61 = Yp[@i_141[@i_303]]) && (x5_60 = K_u_1532[@i_303]))))) then
  (
    out(c21[!_59], r_290[@i_303])
  )
  orfind @i_302 <= NU suchthat defined(x1_301[@i_302], x2_300[@i_302], X[@i_302], Y[@i_140[@i_302]], K_u_1533[@i_302], r_296[@i_302]) && otheruses(r_296[@i_302]) && ((x1_64 = x1_301[@i_302]) && ((x2_63 = x2_300[@i_302]) && ((x3_62 = X[@i_302]) && ((x4_61 = Y[@i_140[@i_302]]) && (x5_60 = K_u_1533[@i_302]))))) then
  (
    out(c21[!_59], r_296[@i_302])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying remove assignments of binder K_u_1532 yields

Game 27 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_148 <= qD suchthat defined(@2_m[@i_148], @2_kd[@i_148], @1_x_1092[@i_148], @2_r4_84[@i_148]) && otheruses(@1_x_1092[@i_148]) && ((Ystar_u = @2_m[@i_148]) && (pw = @2_kd[@i_148])) then
  (
    let K_u_1530: G = cst_G in
    let x1_283: host = U in
    let x2_282: host = S in
    find [unique] @i_355 <= qH1 suchthat defined(x1_64[@i_355], x2_63[@i_355], x3_62[@i_355], x4_61[@i_355], x5_60[@i_355], r_248[@i_355]) && otheruses(r_248[@i_355]) && ((x1_283 = x1_64[@i_355]) && ((x2_282 = x2_63[@i_355]) && ((X = x3_62[@i_355]) && ((exp(g, @1_x_1092[@i_148]) = x4_61[@i_355]) && (exp(g, mult(@1_x_1092[@i_148], x)) = x5_60[@i_355]))))) then
    (
      out(c6[!_53], r_248[@i_355]);
      in(c9[!_53], ());
      let x1_714: host = U in
      let x2_713: host = S in
      find [unique] @i_841 <= qH0 suchthat defined(x1_69[@i_841], x2_68[@i_841], x3_67[@i_841], x4_66[@i_841], x5_65[@i_841], r_673[@i_841]) && otheruses(r_673[@i_841]) && ((x1_714 = x1_69[@i_841]) && ((x2_713 = x2_68[@i_841]) && ((X = x3_67[@i_841]) && ((exp(g, @1_x_1092[@i_148]) = x4_66[@i_841]) && (exp(g, mult(@1_x_1092[@i_148], x)) = x5_65[@i_841]))))) then
      (
        let sk_u: hash0 = r_673[@i_841]
      )
      else
      (
        new r_709: hash0;
        let sk_u: hash0 = r_709
      )
    )
    else
    (
      new r_278: hash1;
      out(c6[!_53], r_278);
      in(c9[!_53], ());
      let x1_708: host = U in
      let x2_707: host = S in
      find [unique] @i_828 <= qH0 suchthat defined(x1_69[@i_828], x2_68[@i_828], x3_67[@i_828], x4_66[@i_828], x5_65[@i_828], r_673[@i_828]) && otheruses(r_673[@i_828]) && ((x1_708 = x1_69[@i_828]) && ((x2_707 = x2_68[@i_828]) && ((X = x3_67[@i_828]) && ((exp(g, @1_x_1092[@i_148]) = x4_66[@i_828]) && (exp(g, mult(@1_x_1092[@i_148], x)) = x5_65[@i_828]))))) then
      (
        let sk_u: hash0 = r_673[@i_828]
      )
      else
      (
        new r_703: hash0;
        let sk_u: hash0 = r_703
      )
    )
  )
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], @1_x_1271[@i_144], @2_r4_96[@i_144]) && otheruses(@1_x_1271[@i_144]) && (Ystar_u = Ystar_u[@i_144]) then
  (
    let K_u_1531: G = cst_G in
    let x1_289: host = U in
    let x2_288: host = S in
    find [unique] @i_364 <= qH1 suchthat defined(x1_64[@i_364], x2_63[@i_364], x3_62[@i_364], x4_61[@i_364], x5_60[@i_364], r_248[@i_364]) && otheruses(r_248[@i_364]) && ((x1_289 = x1_64[@i_364]) && ((x2_288 = x2_63[@i_364]) && ((X = x3_62[@i_364]) && ((exp(g, @1_x_1271[@i_144]) = x4_61[@i_364]) && (exp(g, mult(@1_x_1271[@i_144], x)) = x5_60[@i_364]))))) then
    (
      out(c6[!_53], r_248[@i_364]);
      in(c9[!_53], ());
      let x1_726: host = U in
      let x2_725: host = S in
      find [unique] @i_867 <= qH0 suchthat defined(x1_69[@i_867], x2_68[@i_867], x3_67[@i_867], x4_66[@i_867], x5_65[@i_867], r_673[@i_867]) && otheruses(r_673[@i_867]) && ((x1_726 = x1_69[@i_867]) && ((x2_725 = x2_68[@i_867]) && ((X = x3_67[@i_867]) && ((exp(g, @1_x_1271[@i_144]) = x4_66[@i_867]) && (exp(g, mult(@1_x_1271[@i_144], x)) = x5_65[@i_867]))))) then
      (
        let sk_u: hash0 = r_673[@i_867]
      )
      else
      (
        new r_721: hash0;
        let sk_u: hash0 = r_721
      )
    )
    else
    (
      new r_284: hash1;
      out(c6[!_53], r_284);
      in(c9[!_53], ());
      let x1_720: host = U in
      let x2_719: host = S in
      find [unique] @i_854 <= qH0 suchthat defined(x1_69[@i_854], x2_68[@i_854], x3_67[@i_854], x4_66[@i_854], x5_65[@i_854], r_673[@i_854]) && otheruses(r_673[@i_854]) && ((x1_720 = x1_69[@i_854]) && ((x2_719 = x2_68[@i_854]) && ((X = x3_67[@i_854]) && ((exp(g, @1_x_1271[@i_144]) = x4_66[@i_854]) && (exp(g, mult(@1_x_1271[@i_144], x)) = x5_65[@i_854]))))) then
      (
        let sk_u: hash0 = r_673[@i_854]
      )
      else
      (
        new r_715: hash0;
        let sk_u: hash0 = r_715
      )
    )
  )
  orfind @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  orfind @i_141 <= NP suchthat defined(@2_r2_90[@i_141], yp[@i_141], Yp[@i_141]) && otheruses(@2_r2_90[@i_141]) && (Ystar_u = @2_r2_90[@i_141]) then
  (
    let K_u_1532: G = cst_G in
    let x1_295: host = U in
    let x2_294: host = S in
    find [unique] @i_373 <= qH1 suchthat defined(x1_64[@i_373], x2_63[@i_373], x3_62[@i_373], x4_61[@i_373], x5_60[@i_373], r_248[@i_373]) && otheruses(r_248[@i_373]) && ((x1_295 = x1_64[@i_373]) && ((x2_294 = x2_63[@i_373]) && ((X = x3_62[@i_373]) && ((Yp[@i_141] = x4_61[@i_373]) && (exp(g, mult(yp[@i_141], x)) = x5_60[@i_373]))))) then
    (
      out(c6[!_53], r_248[@i_373]);
      in(c9[!_53], ());
      let x1_738: host = U in
      let x2_737: host = S in
      find [unique] @i_893 <= qH0 suchthat defined(x1_69[@i_893], x2_68[@i_893], x3_67[@i_893], x4_66[@i_893], x5_65[@i_893], r_673[@i_893]) && otheruses(r_673[@i_893]) && ((x1_738 = x1_69[@i_893]) && ((x2_737 = x2_68[@i_893]) && ((X = x3_67[@i_893]) && ((Yp[@i_141] = x4_66[@i_893]) && (exp(g, mult(yp[@i_141], x)) = x5_65[@i_893]))))) then
      (
        let sk_u: hash0 = r_673[@i_893]
      )
      else
      (
        new r_733: hash0;
        let sk_u: hash0 = r_733
      )
    )
    else
    (
      new r_290: hash1;
      out(c6[!_53], r_290);
      in(c9[!_53], ());
      let x1_732: host = U in
      let x2_731: host = S in
      find [unique] @i_880 <= qH0 suchthat defined(x1_69[@i_880], x2_68[@i_880], x3_67[@i_880], x4_66[@i_880], x5_65[@i_880], r_673[@i_880]) && otheruses(r_673[@i_880]) && ((x1_732 = x1_69[@i_880]) && ((x2_731 = x2_68[@i_880]) && ((X = x3_67[@i_880]) && ((Yp[@i_141] = x4_66[@i_880]) && (exp(g, mult(yp[@i_141], x)) = x5_65[@i_880]))))) then
      (
        let sk_u: hash0 = r_673[@i_880]
      )
      else
      (
        new r_727: hash0;
        let sk_u: hash0 = r_727
      )
    )
  )
  orfind @i_140 <= NS suchthat defined(@2_r2_93[@i_140], y[@i_140], Y[@i_140]) && otheruses(@2_r2_93[@i_140]) && (Ystar_u = @2_r2_93[@i_140]) then
  (
    let K_u_1533: G = exp(g, mult(y[@i_140], x)) in
    let x1_301: host = U in
    let x2_300: host = S in
    find [unique] @i_382 <= qH1 suchthat defined(x1_64[@i_382], x2_63[@i_382], x3_62[@i_382], x4_61[@i_382], x5_60[@i_382], r_248[@i_382]) && otheruses(r_248[@i_382]) && ((x1_301 = x1_64[@i_382]) && ((x2_300 = x2_63[@i_382]) && ((X = x3_62[@i_382]) && ((Y[@i_140] = x4_61[@i_382]) && (K_u_1533 = x5_60[@i_382]))))) then
    (
      out(c6[!_53], r_248[@i_382]);
      in(c9[!_53], ());
      let x1_750: host = U in
      let x2_749: host = S in
      find [unique] @i_919 <= qH0 suchthat defined(x1_69[@i_919], x2_68[@i_919], x3_67[@i_919], x4_66[@i_919], x5_65[@i_919], r_673[@i_919]) && otheruses(r_673[@i_919]) && ((x1_750 = x1_69[@i_919]) && ((x2_749 = x2_68[@i_919]) && ((X = x3_67[@i_919]) && ((Y[@i_140] = x4_66[@i_919]) && (K_u_1533 = x5_65[@i_919]))))) then
      (
        let sk_u: hash0 = r_673[@i_919]
      )
      orfind  suchthat defined(j[@i_140], r_685[@i_140]) && otheruses(r_685[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_685[@i_140]
      )
      else
      (
        new r_745: hash0;
        let sk_u: hash0 = r_745
      )
    )
    else
    (
      new r_296: hash1;
      out(c6[!_53], r_296);
      in(c9[!_53], ());
      let x1_744: host = U in
      let x2_743: host = S in
      find [unique] @i_906 <= qH0 suchthat defined(x1_69[@i_906], x2_68[@i_906], x3_67[@i_906], x4_66[@i_906], x5_65[@i_906], r_673[@i_906]) && otheruses(r_673[@i_906]) && ((x1_744 = x1_69[@i_906]) && ((x2_743 = x2_68[@i_906]) && ((X = x3_67[@i_906]) && ((Y[@i_140] = x4_66[@i_906]) && (K_u_1533 = x5_65[@i_906]))))) then
      (
        let sk_u: hash0 = r_673[@i_906]
      )
      orfind  suchthat defined(j[@i_140], r_685[@i_140]) && otheruses(r_685[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_685[@i_140]
      )
      orfind  suchthat defined(j[@i_140], r_691[@i_140]) && otheruses(r_691[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_691[@i_140]
      )
      else
      (
        new r_739: hash0;
        let sk_u: hash0 = r_739
      )
    )
  )
  else
  (
    new @1_x_1271: exponent;
    let @2_r4_96: G = cst_G in
    let K_u_1534: G = cst_G in
    let x1_277: host = U in
    let x2_276: host = S in
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ());
    let x1_702: host = U in
    let x2_701: host = S in
    find [unique] @i_815 <= qH0 suchthat defined(x1_69[@i_815], x2_68[@i_815], x3_67[@i_815], x4_66[@i_815], x5_65[@i_815], r_673[@i_815]) && otheruses(r_673[@i_815]) && ((x1_702 = x1_69[@i_815]) && ((x2_701 = x2_68[@i_815]) && ((X = x3_67[@i_815]) && ((exp(g, @1_x_1271) = x4_66[@i_815]) && (exp(g, mult(@1_x_1271, x)) = x5_65[@i_815]))))) then
    (
      let sk_u: hash0 = r_673[@i_815]
    )
    else
    (
      new r_697: hash0;
      let sk_u: hash0 = r_697
    )
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let x1_271: host = U in
    let x2_270: host = S in
    find [unique] @i_337 <= qH1 suchthat defined(x1_64[@i_337], x2_63[@i_337], x3_62[@i_337], x4_61[@i_337], x5_60[@i_337], r_248[@i_337]) && otheruses(r_248[@i_337]) && ((x1_271 = x1_64[@i_337]) && ((x2_270 = x2_63[@i_337]) && ((X_s = x3_62[@i_337]) && ((Y = x4_61[@i_337]) && (exp(g, mult(x[j], y)) = x5_60[@i_337]))))) then
    (
      if (auth_s = r_248[@i_337]) then
      let x1_690: host = U in
      let x2_689: host = S in
      find [unique] @i_789 <= qH0 suchthat defined(x1_69[@i_789], x2_68[@i_789], x3_67[@i_789], x4_66[@i_789], x5_65[@i_789], r_673[@i_789]) && otheruses(r_673[@i_789]) && ((x1_690 = x1_69[@i_789]) && ((x2_689 = x2_68[@i_789]) && ((X_s = x3_67[@i_789]) && ((Y = x4_66[@i_789]) && (exp(g, mult(x[j], y)) = x5_65[@i_789]))))) then
      (
        let sk_s: hash0 = r_673[@i_789]
      )
      orfind  suchthat defined(@i_140[j], r_739[j]) && otheruses(r_739[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
      (
        let sk_s: hash0 = r_739[j]
      )
      orfind  suchthat defined(@i_140[j], r_745[j]) && otheruses(r_745[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
      (
        let sk_s: hash0 = r_745[j]
      )
      else
      (
        new r_685: hash0;
        let sk_s: hash0 = r_685
      )
    )
    orfind  suchthat defined(@i_140[j], r_296[j]) && otheruses(r_296[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
    (
      if (auth_s = r_296[j]) then
      let x1_696: host = U in
      let x2_695: host = S in
      find [unique] @i_802 <= qH0 suchthat defined(x1_69[@i_802], x2_68[@i_802], x3_67[@i_802], x4_66[@i_802], x5_65[@i_802], r_673[@i_802]) && otheruses(r_673[@i_802]) && ((x1_696 = x1_69[@i_802]) && ((x2_695 = x2_68[@i_802]) && ((X_s = x3_67[@i_802]) && ((Y = x4_66[@i_802]) && (exp(g, mult(x[j], y)) = x5_65[@i_802]))))) then
      (
        let sk_s: hash0 = r_673[@i_802]
      )
      orfind  suchthat defined(r_739[j]) && otheruses(r_739[j]) then
      (
        let sk_s: hash0 = r_739[j]
      )
      else
      (
        new r_691: hash0;
        let sk_s: hash0 = r_691
      )
    )
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    event Auth
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  new @2_r2_90: G;
  let x1_259: host = U in
  let x2_258: host = S in
  new r_254: hash1;
  let x1_684: host = U in
  let x2_683: host = S in
  new r_679: hash0;
  let sk_p: hash0 = r_679 in
  out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@1_x_1092[@i_118], @2_kd[@i_118], @2_m[@i_118], @2_r4_84[@i_118]) && otheruses(@1_x_1092[@i_118]) && ((@2_x = exp(g, @1_x_1092[@i_118])) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_114 <= NU suchthat defined(@1_x_1271[@i_114], Ystar_u[@i_114], @2_r4_96[@i_114]) && otheruses(@1_x_1271[@i_114]) && ((@2_x = exp(g, @1_x_1271[@i_114])) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], Ystar_u[@i_114])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = Yp[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@2_m[@i_108], @2_kd[@i_108], @1_x_1092[@i_108], @2_r4_84[@i_108]) && otheruses(@1_x_1092[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], exp(g, @1_x_1092[@i_108]))
  )
  orfind @i_104 <= NU suchthat defined(Ystar_u[@i_104], @1_x_1271[@i_104], @2_r4_96[@i_104]) && otheruses(@1_x_1271[@i_104]) && ((@2_m = Ystar_u[@i_104]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], exp(g, @1_x_1271[@i_104]))
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@2_r2_90[@i_101], Yp[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Yp[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_r2_93[@i_100], Y[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @1_x_1092: exponent;
    let @2_r4_84: G = cst_G in
    out(@2_c4[!_57], exp(g, @1_x_1092))
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  find [unique] @i_763 <= qH0 suchthat defined(x1_69[@i_763], x2_68[@i_763], x3_67[@i_763], x4_66[@i_763], x5_65[@i_763], r_673[@i_763]) && otheruses(r_673[@i_763]) && ((x1_69 = x1_69[@i_763]) && ((x2_68 = x2_68[@i_763]) && ((x3_67 = x3_67[@i_763]) && ((x4_66 = x4_66[@i_763]) && (x5_65 = x5_65[@i_763]))))) then
  (
    out(c20[!_58], r_673[@i_763])
  )
  orfind @i_762 <= NP suchthat defined(x1_684[@i_762], x2_683[@i_762], Xp[@i_762], Yp[@i_762], xp[@i_762], yp[@i_762], r_679[@i_762]) && otheruses(r_679[@i_762]) && ((x1_69 = x1_684[@i_762]) && ((x2_68 = x2_683[@i_762]) && ((x3_67 = Xp[@i_762]) && ((x4_66 = Yp[@i_762]) && (x5_65 = exp(g, mult(xp[@i_762], yp[@i_762]))))))) then
  (
    out(c20[!_58], r_679[@i_762])
  )
  orfind @i_761 <= NS suchthat defined(x1_690[@i_761], x2_689[@i_761], X_s[@i_761], Y[@i_761], x[j[@i_761]], y[@i_761], r_685[@i_761]) && otheruses(r_685[@i_761]) && ((x1_69 = x1_690[@i_761]) && ((x2_68 = x2_689[@i_761]) && ((x3_67 = X_s[@i_761]) && ((x4_66 = Y[@i_761]) && (x5_65 = exp(g, mult(x[j[@i_761]], y[@i_761]))))))) then
  (
    out(c20[!_58], r_685[@i_761])
  )
  orfind @i_760 <= NS suchthat defined(x1_696[@i_760], x2_695[@i_760], X_s[@i_760], Y[@i_760], x[j[@i_760]], y[@i_760], r_691[@i_760]) && otheruses(r_691[@i_760]) && ((x1_69 = x1_696[@i_760]) && ((x2_68 = x2_695[@i_760]) && ((x3_67 = X_s[@i_760]) && ((x4_66 = Y[@i_760]) && (x5_65 = exp(g, mult(x[j[@i_760]], y[@i_760]))))))) then
  (
    out(c20[!_58], r_691[@i_760])
  )
  orfind @i_759 <= NU suchthat defined(x[@i_759], K_u_1534[@i_759], x1_702[@i_759], x2_701[@i_759], X[@i_759], @1_x_1271[@i_759], r_697[@i_759]) && otheruses(r_697[@i_759]) && ((x1_69 = x1_702[@i_759]) && ((x2_68 = x2_701[@i_759]) && ((x3_67 = X[@i_759]) && ((x4_66 = exp(g, @1_x_1271[@i_759])) && (x5_65 = exp(g, mult(@1_x_1271[@i_759], x[@i_759]))))))) then
  (
    out(c20[!_58], r_697[@i_759])
  )
  orfind @i_758 <= NU suchthat defined(x[@i_758], K_u_1530[@i_758], x1_708[@i_758], x2_707[@i_758], X[@i_758], @1_x_1092[@i_148[@i_758]], r_703[@i_758]) && otheruses(r_703[@i_758]) && ((x1_69 = x1_708[@i_758]) && ((x2_68 = x2_707[@i_758]) && ((x3_67 = X[@i_758]) && ((x4_66 = exp(g, @1_x_1092[@i_148[@i_758]])) && (x5_65 = exp(g, mult(@1_x_1092[@i_148[@i_758]], x[@i_758]))))))) then
  (
    out(c20[!_58], r_703[@i_758])
  )
  orfind @i_757 <= NU suchthat defined(x[@i_757], K_u_1530[@i_757], x1_714[@i_757], x2_713[@i_757], X[@i_757], @1_x_1092[@i_148[@i_757]], r_709[@i_757]) && otheruses(r_709[@i_757]) && ((x1_69 = x1_714[@i_757]) && ((x2_68 = x2_713[@i_757]) && ((x3_67 = X[@i_757]) && ((x4_66 = exp(g, @1_x_1092[@i_148[@i_757]])) && (x5_65 = exp(g, mult(@1_x_1092[@i_148[@i_757]], x[@i_757]))))))) then
  (
    out(c20[!_58], r_709[@i_757])
  )
  orfind @i_756 <= NU suchthat defined(x[@i_756], K_u_1531[@i_756], x1_720[@i_756], x2_719[@i_756], X[@i_756], @1_x_1271[@i_144[@i_756]], r_715[@i_756]) && otheruses(r_715[@i_756]) && ((x1_69 = x1_720[@i_756]) && ((x2_68 = x2_719[@i_756]) && ((x3_67 = X[@i_756]) && ((x4_66 = exp(g, @1_x_1271[@i_144[@i_756]])) && (x5_65 = exp(g, mult(@1_x_1271[@i_144[@i_756]], x[@i_756]))))))) then
  (
    out(c20[!_58], r_715[@i_756])
  )
  orfind @i_755 <= NU suchthat defined(x[@i_755], K_u_1531[@i_755], x1_726[@i_755], x2_725[@i_755], X[@i_755], @1_x_1271[@i_144[@i_755]], r_721[@i_755]) && otheruses(r_721[@i_755]) && ((x1_69 = x1_726[@i_755]) && ((x2_68 = x2_725[@i_755]) && ((x3_67 = X[@i_755]) && ((x4_66 = exp(g, @1_x_1271[@i_144[@i_755]])) && (x5_65 = exp(g, mult(@1_x_1271[@i_144[@i_755]], x[@i_755]))))))) then
  (
    out(c20[!_58], r_721[@i_755])
  )
  orfind @i_754 <= NU suchthat defined(x[@i_754], yp[@i_141[@i_754]], K_u_1532[@i_754], x1_732[@i_754], x2_731[@i_754], X[@i_754], Yp[@i_141[@i_754]], r_727[@i_754]) && otheruses(r_727[@i_754]) && ((x1_69 = x1_732[@i_754]) && ((x2_68 = x2_731[@i_754]) && ((x3_67 = X[@i_754]) && ((x4_66 = Yp[@i_141[@i_754]]) && (x5_65 = exp(g, mult(yp[@i_141[@i_754]], x[@i_754]))))))) then
  (
    out(c20[!_58], r_727[@i_754])
  )
  orfind @i_753 <= NU suchthat defined(x[@i_753], yp[@i_141[@i_753]], K_u_1532[@i_753], x1_738[@i_753], x2_737[@i_753], X[@i_753], Yp[@i_141[@i_753]], r_733[@i_753]) && otheruses(r_733[@i_753]) && ((x1_69 = x1_738[@i_753]) && ((x2_68 = x2_737[@i_753]) && ((x3_67 = X[@i_753]) && ((x4_66 = Yp[@i_141[@i_753]]) && (x5_65 = exp(g, mult(yp[@i_141[@i_753]], x[@i_753]))))))) then
  (
    out(c20[!_58], r_733[@i_753])
  )
  orfind @i_752 <= NU suchthat defined(x1_744[@i_752], x2_743[@i_752], X[@i_752], Y[@i_140[@i_752]], K_u_1533[@i_752], r_739[@i_752]) && otheruses(r_739[@i_752]) && ((x1_69 = x1_744[@i_752]) && ((x2_68 = x2_743[@i_752]) && ((x3_67 = X[@i_752]) && ((x4_66 = Y[@i_140[@i_752]]) && (x5_65 = K_u_1533[@i_752]))))) then
  (
    out(c20[!_58], r_739[@i_752])
  )
  orfind @i_751 <= NU suchthat defined(x1_750[@i_751], x2_749[@i_751], X[@i_751], Y[@i_140[@i_751]], K_u_1533[@i_751], r_745[@i_751]) && otheruses(r_745[@i_751]) && ((x1_69 = x1_750[@i_751]) && ((x2_68 = x2_749[@i_751]) && ((x3_67 = X[@i_751]) && ((x4_66 = Y[@i_140[@i_751]]) && (x5_65 = K_u_1533[@i_751]))))) then
  (
    out(c20[!_58], r_745[@i_751])
  )
  else
  (
    new r_673: hash0;
    out(c20[!_58], r_673)
  )
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  orfind @i_309 <= NP suchthat defined(x1_259[@i_309], x2_258[@i_309], Xp[@i_309], Yp[@i_309], xp[@i_309], yp[@i_309], r_254[@i_309]) && otheruses(r_254[@i_309]) && ((x1_64 = x1_259[@i_309]) && ((x2_63 = x2_258[@i_309]) && ((x3_62 = Xp[@i_309]) && ((x4_61 = Yp[@i_309]) && (x5_60 = exp(g, mult(xp[@i_309], yp[@i_309]))))))) then
  (
    out(c21[!_59], r_254[@i_309])
  )
  orfind @i_306 <= NU suchthat defined(x[@i_306], K_u_1534[@i_306], x1_277[@i_306], x2_276[@i_306], X[@i_306], @1_x_1271[@i_306], r_272[@i_306]) && otheruses(r_272[@i_306]) && ((x1_64 = x1_277[@i_306]) && ((x2_63 = x2_276[@i_306]) && ((x3_62 = X[@i_306]) && ((x4_61 = exp(g, @1_x_1271[@i_306])) && (x5_60 = exp(g, mult(@1_x_1271[@i_306], x[@i_306]))))))) then
  (
    out(c21[!_59], r_272[@i_306])
  )
  orfind @i_305 <= NU suchthat defined(x[@i_305], K_u_1530[@i_305], x1_283[@i_305], x2_282[@i_305], X[@i_305], @1_x_1092[@i_148[@i_305]], r_278[@i_305]) && otheruses(r_278[@i_305]) && ((x1_64 = x1_283[@i_305]) && ((x2_63 = x2_282[@i_305]) && ((x3_62 = X[@i_305]) && ((x4_61 = exp(g, @1_x_1092[@i_148[@i_305]])) && (x5_60 = exp(g, mult(@1_x_1092[@i_148[@i_305]], x[@i_305]))))))) then
  (
    out(c21[!_59], r_278[@i_305])
  )
  orfind @i_304 <= NU suchthat defined(x[@i_304], K_u_1531[@i_304], x1_289[@i_304], x2_288[@i_304], X[@i_304], @1_x_1271[@i_144[@i_304]], r_284[@i_304]) && otheruses(r_284[@i_304]) && ((x1_64 = x1_289[@i_304]) && ((x2_63 = x2_288[@i_304]) && ((x3_62 = X[@i_304]) && ((x4_61 = exp(g, @1_x_1271[@i_144[@i_304]])) && (x5_60 = exp(g, mult(@1_x_1271[@i_144[@i_304]], x[@i_304]))))))) then
  (
    out(c21[!_59], r_284[@i_304])
  )
  orfind @i_303 <= NU suchthat defined(x[@i_303], yp[@i_141[@i_303]], K_u_1532[@i_303], x1_295[@i_303], x2_294[@i_303], X[@i_303], Yp[@i_141[@i_303]], r_290[@i_303]) && otheruses(r_290[@i_303]) && ((x1_64 = x1_295[@i_303]) && ((x2_63 = x2_294[@i_303]) && ((x3_62 = X[@i_303]) && ((x4_61 = Yp[@i_141[@i_303]]) && (x5_60 = exp(g, mult(yp[@i_141[@i_303]], x[@i_303]))))))) then
  (
    out(c21[!_59], r_290[@i_303])
  )
  orfind @i_302 <= NU suchthat defined(x1_301[@i_302], x2_300[@i_302], X[@i_302], Y[@i_140[@i_302]], K_u_1533[@i_302], r_296[@i_302]) && otheruses(r_296[@i_302]) && ((x1_64 = x1_301[@i_302]) && ((x2_63 = x2_300[@i_302]) && ((x3_62 = X[@i_302]) && ((x4_61 = Y[@i_140[@i_302]]) && (x5_60 = K_u_1533[@i_302]))))) then
  (
    out(c21[!_59], r_296[@i_302])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying remove assignments of binder K_u_1533 yields

Game 28 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_148 <= qD suchthat defined(@2_m[@i_148], @2_kd[@i_148], @1_x_1092[@i_148], @2_r4_84[@i_148]) && otheruses(@1_x_1092[@i_148]) && ((Ystar_u = @2_m[@i_148]) && (pw = @2_kd[@i_148])) then
  (
    let K_u_1530: G = cst_G in
    let x1_283: host = U in
    let x2_282: host = S in
    find [unique] @i_355 <= qH1 suchthat defined(x1_64[@i_355], x2_63[@i_355], x3_62[@i_355], x4_61[@i_355], x5_60[@i_355], r_248[@i_355]) && otheruses(r_248[@i_355]) && ((x1_283 = x1_64[@i_355]) && ((x2_282 = x2_63[@i_355]) && ((X = x3_62[@i_355]) && ((exp(g, @1_x_1092[@i_148]) = x4_61[@i_355]) && (exp(g, mult(@1_x_1092[@i_148], x)) = x5_60[@i_355]))))) then
    (
      out(c6[!_53], r_248[@i_355]);
      in(c9[!_53], ());
      let x1_714: host = U in
      let x2_713: host = S in
      find [unique] @i_841 <= qH0 suchthat defined(x1_69[@i_841], x2_68[@i_841], x3_67[@i_841], x4_66[@i_841], x5_65[@i_841], r_673[@i_841]) && otheruses(r_673[@i_841]) && ((x1_714 = x1_69[@i_841]) && ((x2_713 = x2_68[@i_841]) && ((X = x3_67[@i_841]) && ((exp(g, @1_x_1092[@i_148]) = x4_66[@i_841]) && (exp(g, mult(@1_x_1092[@i_148], x)) = x5_65[@i_841]))))) then
      (
        let sk_u: hash0 = r_673[@i_841]
      )
      else
      (
        new r_709: hash0;
        let sk_u: hash0 = r_709
      )
    )
    else
    (
      new r_278: hash1;
      out(c6[!_53], r_278);
      in(c9[!_53], ());
      let x1_708: host = U in
      let x2_707: host = S in
      find [unique] @i_828 <= qH0 suchthat defined(x1_69[@i_828], x2_68[@i_828], x3_67[@i_828], x4_66[@i_828], x5_65[@i_828], r_673[@i_828]) && otheruses(r_673[@i_828]) && ((x1_708 = x1_69[@i_828]) && ((x2_707 = x2_68[@i_828]) && ((X = x3_67[@i_828]) && ((exp(g, @1_x_1092[@i_148]) = x4_66[@i_828]) && (exp(g, mult(@1_x_1092[@i_148], x)) = x5_65[@i_828]))))) then
      (
        let sk_u: hash0 = r_673[@i_828]
      )
      else
      (
        new r_703: hash0;
        let sk_u: hash0 = r_703
      )
    )
  )
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], @1_x_1271[@i_144], @2_r4_96[@i_144]) && otheruses(@1_x_1271[@i_144]) && (Ystar_u = Ystar_u[@i_144]) then
  (
    let K_u_1531: G = cst_G in
    let x1_289: host = U in
    let x2_288: host = S in
    find [unique] @i_364 <= qH1 suchthat defined(x1_64[@i_364], x2_63[@i_364], x3_62[@i_364], x4_61[@i_364], x5_60[@i_364], r_248[@i_364]) && otheruses(r_248[@i_364]) && ((x1_289 = x1_64[@i_364]) && ((x2_288 = x2_63[@i_364]) && ((X = x3_62[@i_364]) && ((exp(g, @1_x_1271[@i_144]) = x4_61[@i_364]) && (exp(g, mult(@1_x_1271[@i_144], x)) = x5_60[@i_364]))))) then
    (
      out(c6[!_53], r_248[@i_364]);
      in(c9[!_53], ());
      let x1_726: host = U in
      let x2_725: host = S in
      find [unique] @i_867 <= qH0 suchthat defined(x1_69[@i_867], x2_68[@i_867], x3_67[@i_867], x4_66[@i_867], x5_65[@i_867], r_673[@i_867]) && otheruses(r_673[@i_867]) && ((x1_726 = x1_69[@i_867]) && ((x2_725 = x2_68[@i_867]) && ((X = x3_67[@i_867]) && ((exp(g, @1_x_1271[@i_144]) = x4_66[@i_867]) && (exp(g, mult(@1_x_1271[@i_144], x)) = x5_65[@i_867]))))) then
      (
        let sk_u: hash0 = r_673[@i_867]
      )
      else
      (
        new r_721: hash0;
        let sk_u: hash0 = r_721
      )
    )
    else
    (
      new r_284: hash1;
      out(c6[!_53], r_284);
      in(c9[!_53], ());
      let x1_720: host = U in
      let x2_719: host = S in
      find [unique] @i_854 <= qH0 suchthat defined(x1_69[@i_854], x2_68[@i_854], x3_67[@i_854], x4_66[@i_854], x5_65[@i_854], r_673[@i_854]) && otheruses(r_673[@i_854]) && ((x1_720 = x1_69[@i_854]) && ((x2_719 = x2_68[@i_854]) && ((X = x3_67[@i_854]) && ((exp(g, @1_x_1271[@i_144]) = x4_66[@i_854]) && (exp(g, mult(@1_x_1271[@i_144], x)) = x5_65[@i_854]))))) then
      (
        let sk_u: hash0 = r_673[@i_854]
      )
      else
      (
        new r_715: hash0;
        let sk_u: hash0 = r_715
      )
    )
  )
  orfind @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  orfind @i_141 <= NP suchthat defined(@2_r2_90[@i_141], yp[@i_141], Yp[@i_141]) && otheruses(@2_r2_90[@i_141]) && (Ystar_u = @2_r2_90[@i_141]) then
  (
    let K_u_1532: G = cst_G in
    let x1_295: host = U in
    let x2_294: host = S in
    find [unique] @i_373 <= qH1 suchthat defined(x1_64[@i_373], x2_63[@i_373], x3_62[@i_373], x4_61[@i_373], x5_60[@i_373], r_248[@i_373]) && otheruses(r_248[@i_373]) && ((x1_295 = x1_64[@i_373]) && ((x2_294 = x2_63[@i_373]) && ((X = x3_62[@i_373]) && ((Yp[@i_141] = x4_61[@i_373]) && (exp(g, mult(yp[@i_141], x)) = x5_60[@i_373]))))) then
    (
      out(c6[!_53], r_248[@i_373]);
      in(c9[!_53], ());
      let x1_738: host = U in
      let x2_737: host = S in
      find [unique] @i_893 <= qH0 suchthat defined(x1_69[@i_893], x2_68[@i_893], x3_67[@i_893], x4_66[@i_893], x5_65[@i_893], r_673[@i_893]) && otheruses(r_673[@i_893]) && ((x1_738 = x1_69[@i_893]) && ((x2_737 = x2_68[@i_893]) && ((X = x3_67[@i_893]) && ((Yp[@i_141] = x4_66[@i_893]) && (exp(g, mult(yp[@i_141], x)) = x5_65[@i_893]))))) then
      (
        let sk_u: hash0 = r_673[@i_893]
      )
      else
      (
        new r_733: hash0;
        let sk_u: hash0 = r_733
      )
    )
    else
    (
      new r_290: hash1;
      out(c6[!_53], r_290);
      in(c9[!_53], ());
      let x1_732: host = U in
      let x2_731: host = S in
      find [unique] @i_880 <= qH0 suchthat defined(x1_69[@i_880], x2_68[@i_880], x3_67[@i_880], x4_66[@i_880], x5_65[@i_880], r_673[@i_880]) && otheruses(r_673[@i_880]) && ((x1_732 = x1_69[@i_880]) && ((x2_731 = x2_68[@i_880]) && ((X = x3_67[@i_880]) && ((Yp[@i_141] = x4_66[@i_880]) && (exp(g, mult(yp[@i_141], x)) = x5_65[@i_880]))))) then
      (
        let sk_u: hash0 = r_673[@i_880]
      )
      else
      (
        new r_727: hash0;
        let sk_u: hash0 = r_727
      )
    )
  )
  orfind @i_140 <= NS suchthat defined(@2_r2_93[@i_140], y[@i_140], Y[@i_140]) && otheruses(@2_r2_93[@i_140]) && (Ystar_u = @2_r2_93[@i_140]) then
  (
    let K_u_1533: G = cst_G in
    let x1_301: host = U in
    let x2_300: host = S in
    find [unique] @i_382 <= qH1 suchthat defined(x1_64[@i_382], x2_63[@i_382], x3_62[@i_382], x4_61[@i_382], x5_60[@i_382], r_248[@i_382]) && otheruses(r_248[@i_382]) && ((x1_301 = x1_64[@i_382]) && ((x2_300 = x2_63[@i_382]) && ((X = x3_62[@i_382]) && ((Y[@i_140] = x4_61[@i_382]) && (exp(g, mult(y[@i_140], x)) = x5_60[@i_382]))))) then
    (
      out(c6[!_53], r_248[@i_382]);
      in(c9[!_53], ());
      let x1_750: host = U in
      let x2_749: host = S in
      find [unique] @i_919 <= qH0 suchthat defined(x1_69[@i_919], x2_68[@i_919], x3_67[@i_919], x4_66[@i_919], x5_65[@i_919], r_673[@i_919]) && otheruses(r_673[@i_919]) && ((x1_750 = x1_69[@i_919]) && ((x2_749 = x2_68[@i_919]) && ((X = x3_67[@i_919]) && ((Y[@i_140] = x4_66[@i_919]) && (exp(g, mult(y[@i_140], x)) = x5_65[@i_919]))))) then
      (
        let sk_u: hash0 = r_673[@i_919]
      )
      orfind  suchthat defined(j[@i_140], r_685[@i_140]) && otheruses(r_685[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_685[@i_140]
      )
      else
      (
        new r_745: hash0;
        let sk_u: hash0 = r_745
      )
    )
    else
    (
      new r_296: hash1;
      out(c6[!_53], r_296);
      in(c9[!_53], ());
      let x1_744: host = U in
      let x2_743: host = S in
      find [unique] @i_906 <= qH0 suchthat defined(x1_69[@i_906], x2_68[@i_906], x3_67[@i_906], x4_66[@i_906], x5_65[@i_906], r_673[@i_906]) && otheruses(r_673[@i_906]) && ((x1_744 = x1_69[@i_906]) && ((x2_743 = x2_68[@i_906]) && ((X = x3_67[@i_906]) && ((Y[@i_140] = x4_66[@i_906]) && (exp(g, mult(y[@i_140], x)) = x5_65[@i_906]))))) then
      (
        let sk_u: hash0 = r_673[@i_906]
      )
      orfind  suchthat defined(j[@i_140], r_685[@i_140]) && otheruses(r_685[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_685[@i_140]
      )
      orfind  suchthat defined(j[@i_140], r_691[@i_140]) && otheruses(r_691[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_691[@i_140]
      )
      else
      (
        new r_739: hash0;
        let sk_u: hash0 = r_739
      )
    )
  )
  else
  (
    new @1_x_1271: exponent;
    let @2_r4_96: G = cst_G in
    let K_u_1534: G = cst_G in
    let x1_277: host = U in
    let x2_276: host = S in
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ());
    let x1_702: host = U in
    let x2_701: host = S in
    find [unique] @i_815 <= qH0 suchthat defined(x1_69[@i_815], x2_68[@i_815], x3_67[@i_815], x4_66[@i_815], x5_65[@i_815], r_673[@i_815]) && otheruses(r_673[@i_815]) && ((x1_702 = x1_69[@i_815]) && ((x2_701 = x2_68[@i_815]) && ((X = x3_67[@i_815]) && ((exp(g, @1_x_1271) = x4_66[@i_815]) && (exp(g, mult(@1_x_1271, x)) = x5_65[@i_815]))))) then
    (
      let sk_u: hash0 = r_673[@i_815]
    )
    else
    (
      new r_697: hash0;
      let sk_u: hash0 = r_697
    )
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let x1_271: host = U in
    let x2_270: host = S in
    find [unique] @i_337 <= qH1 suchthat defined(x1_64[@i_337], x2_63[@i_337], x3_62[@i_337], x4_61[@i_337], x5_60[@i_337], r_248[@i_337]) && otheruses(r_248[@i_337]) && ((x1_271 = x1_64[@i_337]) && ((x2_270 = x2_63[@i_337]) && ((X_s = x3_62[@i_337]) && ((Y = x4_61[@i_337]) && (exp(g, mult(x[j], y)) = x5_60[@i_337]))))) then
    (
      if (auth_s = r_248[@i_337]) then
      let x1_690: host = U in
      let x2_689: host = S in
      find [unique] @i_789 <= qH0 suchthat defined(x1_69[@i_789], x2_68[@i_789], x3_67[@i_789], x4_66[@i_789], x5_65[@i_789], r_673[@i_789]) && otheruses(r_673[@i_789]) && ((x1_690 = x1_69[@i_789]) && ((x2_689 = x2_68[@i_789]) && ((X_s = x3_67[@i_789]) && ((Y = x4_66[@i_789]) && (exp(g, mult(x[j], y)) = x5_65[@i_789]))))) then
      (
        let sk_s: hash0 = r_673[@i_789]
      )
      orfind  suchthat defined(@i_140[j], r_739[j]) && otheruses(r_739[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
      (
        let sk_s: hash0 = r_739[j]
      )
      orfind  suchthat defined(@i_140[j], r_745[j]) && otheruses(r_745[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
      (
        let sk_s: hash0 = r_745[j]
      )
      else
      (
        new r_685: hash0;
        let sk_s: hash0 = r_685
      )
    )
    orfind  suchthat defined(@i_140[j], r_296[j]) && otheruses(r_296[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
    (
      if (auth_s = r_296[j]) then
      let x1_696: host = U in
      let x2_695: host = S in
      find [unique] @i_802 <= qH0 suchthat defined(x1_69[@i_802], x2_68[@i_802], x3_67[@i_802], x4_66[@i_802], x5_65[@i_802], r_673[@i_802]) && otheruses(r_673[@i_802]) && ((x1_696 = x1_69[@i_802]) && ((x2_695 = x2_68[@i_802]) && ((X_s = x3_67[@i_802]) && ((Y = x4_66[@i_802]) && (exp(g, mult(x[j], y)) = x5_65[@i_802]))))) then
      (
        let sk_s: hash0 = r_673[@i_802]
      )
      orfind  suchthat defined(r_739[j]) && otheruses(r_739[j]) then
      (
        let sk_s: hash0 = r_739[j]
      )
      else
      (
        new r_691: hash0;
        let sk_s: hash0 = r_691
      )
    )
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    event Auth
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  new @2_r2_90: G;
  let x1_259: host = U in
  let x2_258: host = S in
  new r_254: hash1;
  let x1_684: host = U in
  let x2_683: host = S in
  new r_679: hash0;
  let sk_p: hash0 = r_679 in
  out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@1_x_1092[@i_118], @2_kd[@i_118], @2_m[@i_118], @2_r4_84[@i_118]) && otheruses(@1_x_1092[@i_118]) && ((@2_x = exp(g, @1_x_1092[@i_118])) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_114 <= NU suchthat defined(@1_x_1271[@i_114], Ystar_u[@i_114], @2_r4_96[@i_114]) && otheruses(@1_x_1271[@i_114]) && ((@2_x = exp(g, @1_x_1271[@i_114])) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], Ystar_u[@i_114])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = Yp[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@2_m[@i_108], @2_kd[@i_108], @1_x_1092[@i_108], @2_r4_84[@i_108]) && otheruses(@1_x_1092[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], exp(g, @1_x_1092[@i_108]))
  )
  orfind @i_104 <= NU suchthat defined(Ystar_u[@i_104], @1_x_1271[@i_104], @2_r4_96[@i_104]) && otheruses(@1_x_1271[@i_104]) && ((@2_m = Ystar_u[@i_104]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], exp(g, @1_x_1271[@i_104]))
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@2_r2_90[@i_101], Yp[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Yp[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_r2_93[@i_100], Y[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @1_x_1092: exponent;
    let @2_r4_84: G = cst_G in
    out(@2_c4[!_57], exp(g, @1_x_1092))
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  find [unique] @i_763 <= qH0 suchthat defined(x1_69[@i_763], x2_68[@i_763], x3_67[@i_763], x4_66[@i_763], x5_65[@i_763], r_673[@i_763]) && otheruses(r_673[@i_763]) && ((x1_69 = x1_69[@i_763]) && ((x2_68 = x2_68[@i_763]) && ((x3_67 = x3_67[@i_763]) && ((x4_66 = x4_66[@i_763]) && (x5_65 = x5_65[@i_763]))))) then
  (
    out(c20[!_58], r_673[@i_763])
  )
  orfind @i_762 <= NP suchthat defined(x1_684[@i_762], x2_683[@i_762], Xp[@i_762], Yp[@i_762], xp[@i_762], yp[@i_762], r_679[@i_762]) && otheruses(r_679[@i_762]) && ((x1_69 = x1_684[@i_762]) && ((x2_68 = x2_683[@i_762]) && ((x3_67 = Xp[@i_762]) && ((x4_66 = Yp[@i_762]) && (x5_65 = exp(g, mult(xp[@i_762], yp[@i_762]))))))) then
  (
    out(c20[!_58], r_679[@i_762])
  )
  orfind @i_761 <= NS suchthat defined(x1_690[@i_761], x2_689[@i_761], X_s[@i_761], Y[@i_761], x[j[@i_761]], y[@i_761], r_685[@i_761]) && otheruses(r_685[@i_761]) && ((x1_69 = x1_690[@i_761]) && ((x2_68 = x2_689[@i_761]) && ((x3_67 = X_s[@i_761]) && ((x4_66 = Y[@i_761]) && (x5_65 = exp(g, mult(x[j[@i_761]], y[@i_761]))))))) then
  (
    out(c20[!_58], r_685[@i_761])
  )
  orfind @i_760 <= NS suchthat defined(x1_696[@i_760], x2_695[@i_760], X_s[@i_760], Y[@i_760], x[j[@i_760]], y[@i_760], r_691[@i_760]) && otheruses(r_691[@i_760]) && ((x1_69 = x1_696[@i_760]) && ((x2_68 = x2_695[@i_760]) && ((x3_67 = X_s[@i_760]) && ((x4_66 = Y[@i_760]) && (x5_65 = exp(g, mult(x[j[@i_760]], y[@i_760]))))))) then
  (
    out(c20[!_58], r_691[@i_760])
  )
  orfind @i_759 <= NU suchthat defined(x[@i_759], K_u_1534[@i_759], x1_702[@i_759], x2_701[@i_759], X[@i_759], @1_x_1271[@i_759], r_697[@i_759]) && otheruses(r_697[@i_759]) && ((x1_69 = x1_702[@i_759]) && ((x2_68 = x2_701[@i_759]) && ((x3_67 = X[@i_759]) && ((x4_66 = exp(g, @1_x_1271[@i_759])) && (x5_65 = exp(g, mult(@1_x_1271[@i_759], x[@i_759]))))))) then
  (
    out(c20[!_58], r_697[@i_759])
  )
  orfind @i_758 <= NU suchthat defined(x[@i_758], K_u_1530[@i_758], x1_708[@i_758], x2_707[@i_758], X[@i_758], @1_x_1092[@i_148[@i_758]], r_703[@i_758]) && otheruses(r_703[@i_758]) && ((x1_69 = x1_708[@i_758]) && ((x2_68 = x2_707[@i_758]) && ((x3_67 = X[@i_758]) && ((x4_66 = exp(g, @1_x_1092[@i_148[@i_758]])) && (x5_65 = exp(g, mult(@1_x_1092[@i_148[@i_758]], x[@i_758]))))))) then
  (
    out(c20[!_58], r_703[@i_758])
  )
  orfind @i_757 <= NU suchthat defined(x[@i_757], K_u_1530[@i_757], x1_714[@i_757], x2_713[@i_757], X[@i_757], @1_x_1092[@i_148[@i_757]], r_709[@i_757]) && otheruses(r_709[@i_757]) && ((x1_69 = x1_714[@i_757]) && ((x2_68 = x2_713[@i_757]) && ((x3_67 = X[@i_757]) && ((x4_66 = exp(g, @1_x_1092[@i_148[@i_757]])) && (x5_65 = exp(g, mult(@1_x_1092[@i_148[@i_757]], x[@i_757]))))))) then
  (
    out(c20[!_58], r_709[@i_757])
  )
  orfind @i_756 <= NU suchthat defined(x[@i_756], K_u_1531[@i_756], x1_720[@i_756], x2_719[@i_756], X[@i_756], @1_x_1271[@i_144[@i_756]], r_715[@i_756]) && otheruses(r_715[@i_756]) && ((x1_69 = x1_720[@i_756]) && ((x2_68 = x2_719[@i_756]) && ((x3_67 = X[@i_756]) && ((x4_66 = exp(g, @1_x_1271[@i_144[@i_756]])) && (x5_65 = exp(g, mult(@1_x_1271[@i_144[@i_756]], x[@i_756]))))))) then
  (
    out(c20[!_58], r_715[@i_756])
  )
  orfind @i_755 <= NU suchthat defined(x[@i_755], K_u_1531[@i_755], x1_726[@i_755], x2_725[@i_755], X[@i_755], @1_x_1271[@i_144[@i_755]], r_721[@i_755]) && otheruses(r_721[@i_755]) && ((x1_69 = x1_726[@i_755]) && ((x2_68 = x2_725[@i_755]) && ((x3_67 = X[@i_755]) && ((x4_66 = exp(g, @1_x_1271[@i_144[@i_755]])) && (x5_65 = exp(g, mult(@1_x_1271[@i_144[@i_755]], x[@i_755]))))))) then
  (
    out(c20[!_58], r_721[@i_755])
  )
  orfind @i_754 <= NU suchthat defined(x[@i_754], yp[@i_141[@i_754]], K_u_1532[@i_754], x1_732[@i_754], x2_731[@i_754], X[@i_754], Yp[@i_141[@i_754]], r_727[@i_754]) && otheruses(r_727[@i_754]) && ((x1_69 = x1_732[@i_754]) && ((x2_68 = x2_731[@i_754]) && ((x3_67 = X[@i_754]) && ((x4_66 = Yp[@i_141[@i_754]]) && (x5_65 = exp(g, mult(yp[@i_141[@i_754]], x[@i_754]))))))) then
  (
    out(c20[!_58], r_727[@i_754])
  )
  orfind @i_753 <= NU suchthat defined(x[@i_753], yp[@i_141[@i_753]], K_u_1532[@i_753], x1_738[@i_753], x2_737[@i_753], X[@i_753], Yp[@i_141[@i_753]], r_733[@i_753]) && otheruses(r_733[@i_753]) && ((x1_69 = x1_738[@i_753]) && ((x2_68 = x2_737[@i_753]) && ((x3_67 = X[@i_753]) && ((x4_66 = Yp[@i_141[@i_753]]) && (x5_65 = exp(g, mult(yp[@i_141[@i_753]], x[@i_753]))))))) then
  (
    out(c20[!_58], r_733[@i_753])
  )
  orfind @i_752 <= NU suchthat defined(x[@i_752], y[@i_140[@i_752]], K_u_1533[@i_752], x1_744[@i_752], x2_743[@i_752], X[@i_752], Y[@i_140[@i_752]], r_739[@i_752]) && otheruses(r_739[@i_752]) && ((x1_69 = x1_744[@i_752]) && ((x2_68 = x2_743[@i_752]) && ((x3_67 = X[@i_752]) && ((x4_66 = Y[@i_140[@i_752]]) && (x5_65 = exp(g, mult(y[@i_140[@i_752]], x[@i_752]))))))) then
  (
    out(c20[!_58], r_739[@i_752])
  )
  orfind @i_751 <= NU suchthat defined(x[@i_751], y[@i_140[@i_751]], K_u_1533[@i_751], x1_750[@i_751], x2_749[@i_751], X[@i_751], Y[@i_140[@i_751]], r_745[@i_751]) && otheruses(r_745[@i_751]) && ((x1_69 = x1_750[@i_751]) && ((x2_68 = x2_749[@i_751]) && ((x3_67 = X[@i_751]) && ((x4_66 = Y[@i_140[@i_751]]) && (x5_65 = exp(g, mult(y[@i_140[@i_751]], x[@i_751]))))))) then
  (
    out(c20[!_58], r_745[@i_751])
  )
  else
  (
    new r_673: hash0;
    out(c20[!_58], r_673)
  )
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  orfind @i_309 <= NP suchthat defined(x1_259[@i_309], x2_258[@i_309], Xp[@i_309], Yp[@i_309], xp[@i_309], yp[@i_309], r_254[@i_309]) && otheruses(r_254[@i_309]) && ((x1_64 = x1_259[@i_309]) && ((x2_63 = x2_258[@i_309]) && ((x3_62 = Xp[@i_309]) && ((x4_61 = Yp[@i_309]) && (x5_60 = exp(g, mult(xp[@i_309], yp[@i_309]))))))) then
  (
    out(c21[!_59], r_254[@i_309])
  )
  orfind @i_306 <= NU suchthat defined(x[@i_306], K_u_1534[@i_306], x1_277[@i_306], x2_276[@i_306], X[@i_306], @1_x_1271[@i_306], r_272[@i_306]) && otheruses(r_272[@i_306]) && ((x1_64 = x1_277[@i_306]) && ((x2_63 = x2_276[@i_306]) && ((x3_62 = X[@i_306]) && ((x4_61 = exp(g, @1_x_1271[@i_306])) && (x5_60 = exp(g, mult(@1_x_1271[@i_306], x[@i_306]))))))) then
  (
    out(c21[!_59], r_272[@i_306])
  )
  orfind @i_305 <= NU suchthat defined(x[@i_305], K_u_1530[@i_305], x1_283[@i_305], x2_282[@i_305], X[@i_305], @1_x_1092[@i_148[@i_305]], r_278[@i_305]) && otheruses(r_278[@i_305]) && ((x1_64 = x1_283[@i_305]) && ((x2_63 = x2_282[@i_305]) && ((x3_62 = X[@i_305]) && ((x4_61 = exp(g, @1_x_1092[@i_148[@i_305]])) && (x5_60 = exp(g, mult(@1_x_1092[@i_148[@i_305]], x[@i_305]))))))) then
  (
    out(c21[!_59], r_278[@i_305])
  )
  orfind @i_304 <= NU suchthat defined(x[@i_304], K_u_1531[@i_304], x1_289[@i_304], x2_288[@i_304], X[@i_304], @1_x_1271[@i_144[@i_304]], r_284[@i_304]) && otheruses(r_284[@i_304]) && ((x1_64 = x1_289[@i_304]) && ((x2_63 = x2_288[@i_304]) && ((x3_62 = X[@i_304]) && ((x4_61 = exp(g, @1_x_1271[@i_144[@i_304]])) && (x5_60 = exp(g, mult(@1_x_1271[@i_144[@i_304]], x[@i_304]))))))) then
  (
    out(c21[!_59], r_284[@i_304])
  )
  orfind @i_303 <= NU suchthat defined(x[@i_303], yp[@i_141[@i_303]], K_u_1532[@i_303], x1_295[@i_303], x2_294[@i_303], X[@i_303], Yp[@i_141[@i_303]], r_290[@i_303]) && otheruses(r_290[@i_303]) && ((x1_64 = x1_295[@i_303]) && ((x2_63 = x2_294[@i_303]) && ((x3_62 = X[@i_303]) && ((x4_61 = Yp[@i_141[@i_303]]) && (x5_60 = exp(g, mult(yp[@i_141[@i_303]], x[@i_303]))))))) then
  (
    out(c21[!_59], r_290[@i_303])
  )
  orfind @i_302 <= NU suchthat defined(x[@i_302], y[@i_140[@i_302]], K_u_1533[@i_302], x1_301[@i_302], x2_300[@i_302], X[@i_302], Y[@i_140[@i_302]], r_296[@i_302]) && otheruses(r_296[@i_302]) && ((x1_64 = x1_301[@i_302]) && ((x2_63 = x2_300[@i_302]) && ((x3_62 = X[@i_302]) && ((x4_61 = Y[@i_140[@i_302]]) && (x5_60 = exp(g, mult(y[@i_140[@i_302]], x[@i_302]))))))) then
  (
    out(c21[!_59], r_296[@i_302])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  () -> exp(g, @1_a),
  ! !_12 <= @1_na' (@1_m_17: G) -> exp(@1_m_17, @1_a),
  ! !_13 <= @1_naCDH (@1_m_18: G, @1_j_19 <= @1_nb) -> (@1_m_18 = exp(g, mult(@1_b[@1_j_19], @1_a)))), ! !_14 <= @1_nb new @1_b: exponent; (
  () -> exp(g, @1_b),
  ! !_15 <= @1_nb' (@1_m_20: G) -> exp(@1_m_20, @1_b),
  ! !_16 <= @1_nbCDH (@1_m_21: G, @1_j_22 <= @1_na) -> (@1_m_21 = exp(g, mult(@1_a[@1_j_22], @1_b))))
<=(set(proba <= pCDH(time, @1_na, @1_nb, @1_naCDH, @1_nbCDH)))=>
      ! !_23 <= @1_na new @1_a: exponent; (
  () -> @1_exp'(g, @1_a),
  ! !_24 <= @1_na' (@1_m_29: G) -> let @1_ka: bitstring = @1_mark in @1_exp'(@1_m_29, @1_a),
  ! !_25 <= @1_naCDH (@1_m_30: G, @1_j_31 <= @1_nb) -> find @1_v_33 <= @1_nb', @1_u_34 <= @1_nb suchthat defined(@1_kb[@1_v_33, @1_u_34], @1_b[@1_u_34]) && (@1_b[@1_j_31] = @1_b[@1_u_34]) then (@1_m_30 = @1_exp'(g, mult(@1_b[@1_j_31], @1_a))) else find @1_v_32 <= @1_na' suchthat defined(@1_ka[@1_v_32]) then (@1_m_30 = @1_exp'(g, mult(@1_b[@1_j_31], @1_a))) else false), ! !_26 <= @1_nb new @1_b: exponent; (
  () -> @1_exp'(g, @1_b),
  ! !_27 <= @1_nb' (@1_m_35: G) -> let @1_kb: bitstring = @1_mark in @1_exp'(@1_m_35, @1_b),
  ! !_28 <= @1_nbCDH (@1_m_36: G, @1_j_37 <= @1_na) -> find @1_v_39 <= @1_na', @1_u_40 <= @1_na suchthat defined(@1_ka[@1_v_39, @1_u_40], @1_a[@1_u_40]) && (@1_a[@1_j_37] = @1_a[@1_u_40]) then (@1_m_36 = @1_exp'(g, mult(@1_a[@1_j_37], @1_b))) else find @1_v_38 <= @1_nb' suchthat defined(@1_kb[@1_v_38]) then (@1_m_36 = @1_exp'(g, mult(@1_a[@1_j_37], @1_b))) else false)
with xp, y, yp, @1_x_1271, x, @1_x_1092 [Excluding set(dist 28->29, proba <= pCDH(time + time(context for game 28), NU + NP, NU + qD + NP + NS, 5. * NU * qH1 + NP * qH1 + 9. * NU * qH0 + 3. * NS * qH0 + NP * qH0 + qH1 * NS + qH0 + qH1, 0))] yields

Game 29 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_148 <= qD suchthat defined(@2_m[@i_148], @2_kd[@i_148], @1_x_1092[@i_148], @2_r4_84[@i_148]) && otheruses(@1_x_1092[@i_148]) && ((Ystar_u = @2_m[@i_148]) && (pw = @2_kd[@i_148])) then
  (
    let K_u_1530: G = cst_G in
    let x1_283: host = U in
    let x2_282: host = S in
    find [unique] @i_355 <= qH1 suchthat defined(x1_64[@i_355], x2_63[@i_355], x3_62[@i_355], x4_61[@i_355], x5_60[@i_355], r_248[@i_355]) && otheruses(r_248[@i_355]) && find  else find  else ((x1_283 = x1_64[@i_355]) && ((x2_282 = x2_63[@i_355]) && ((X = x3_62[@i_355]) && ((@1_exp'(g, @1_x_1092[@i_148]) = x4_61[@i_355]) && false)))) then
    (
      out(c6[!_53], r_248[@i_355]);
      in(c9[!_53], ());
      let x1_714: host = U in
      let x2_713: host = S in
      find [unique] @i_841 <= qH0 suchthat defined(x1_69[@i_841], x2_68[@i_841], x3_67[@i_841], x4_66[@i_841], x5_65[@i_841], r_673[@i_841]) && otheruses(r_673[@i_841]) && find  else find  else ((x1_714 = x1_69[@i_841]) && ((x2_713 = x2_68[@i_841]) && ((X = x3_67[@i_841]) && ((@1_exp'(g, @1_x_1092[@i_148]) = x4_66[@i_841]) && false)))) then
      (
        let sk_u: hash0 = r_673[@i_841]
      )
      else
      (
        new r_709: hash0;
        let sk_u: hash0 = r_709
      )
    )
    else
    (
      new r_278: hash1;
      out(c6[!_53], r_278);
      in(c9[!_53], ());
      let x1_708: host = U in
      let x2_707: host = S in
      find [unique] @i_828 <= qH0 suchthat defined(x1_69[@i_828], x2_68[@i_828], x3_67[@i_828], x4_66[@i_828], x5_65[@i_828], r_673[@i_828]) && otheruses(r_673[@i_828]) && find  else find  else ((x1_708 = x1_69[@i_828]) && ((x2_707 = x2_68[@i_828]) && ((X = x3_67[@i_828]) && ((@1_exp'(g, @1_x_1092[@i_148]) = x4_66[@i_828]) && false)))) then
      (
        let sk_u: hash0 = r_673[@i_828]
      )
      else
      (
        new r_703: hash0;
        let sk_u: hash0 = r_703
      )
    )
  )
  orfind @i_144 <= NU suchthat defined(Ystar_u[@i_144], @1_x_1271[@i_144], @2_r4_96[@i_144]) && otheruses(@1_x_1271[@i_144]) && (Ystar_u = Ystar_u[@i_144]) then
  (
    let K_u_1531: G = cst_G in
    let x1_289: host = U in
    let x2_288: host = S in
    find [unique] @i_364 <= qH1 suchthat defined(x1_64[@i_364], x2_63[@i_364], x3_62[@i_364], x4_61[@i_364], x5_60[@i_364], r_248[@i_364]) && otheruses(r_248[@i_364]) && find  else find  else ((x1_289 = x1_64[@i_364]) && ((x2_288 = x2_63[@i_364]) && ((X = x3_62[@i_364]) && ((@1_exp'(g, @1_x_1271[@i_144]) = x4_61[@i_364]) && false)))) then
    (
      out(c6[!_53], r_248[@i_364]);
      in(c9[!_53], ());
      let x1_726: host = U in
      let x2_725: host = S in
      find [unique] @i_867 <= qH0 suchthat defined(x1_69[@i_867], x2_68[@i_867], x3_67[@i_867], x4_66[@i_867], x5_65[@i_867], r_673[@i_867]) && otheruses(r_673[@i_867]) && find  else find  else ((x1_726 = x1_69[@i_867]) && ((x2_725 = x2_68[@i_867]) && ((X = x3_67[@i_867]) && ((@1_exp'(g, @1_x_1271[@i_144]) = x4_66[@i_867]) && false)))) then
      (
        let sk_u: hash0 = r_673[@i_867]
      )
      else
      (
        new r_721: hash0;
        let sk_u: hash0 = r_721
      )
    )
    else
    (
      new r_284: hash1;
      out(c6[!_53], r_284);
      in(c9[!_53], ());
      let x1_720: host = U in
      let x2_719: host = S in
      find [unique] @i_854 <= qH0 suchthat defined(x1_69[@i_854], x2_68[@i_854], x3_67[@i_854], x4_66[@i_854], x5_65[@i_854], r_673[@i_854]) && otheruses(r_673[@i_854]) && find  else find  else ((x1_720 = x1_69[@i_854]) && ((x2_719 = x2_68[@i_854]) && ((X = x3_67[@i_854]) && ((@1_exp'(g, @1_x_1271[@i_144]) = x4_66[@i_854]) && false)))) then
      (
        let sk_u: hash0 = r_673[@i_854]
      )
      else
      (
        new r_715: hash0;
        let sk_u: hash0 = r_715
      )
    )
  )
  orfind @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  orfind @i_141 <= NP suchthat defined(@2_r2_90[@i_141], yp[@i_141], Yp[@i_141]) && otheruses(@2_r2_90[@i_141]) && (Ystar_u = @2_r2_90[@i_141]) then
  (
    let K_u_1532: G = cst_G in
    let x1_295: host = U in
    let x2_294: host = S in
    find [unique] @i_373 <= qH1 suchthat defined(x1_64[@i_373], x2_63[@i_373], x3_62[@i_373], x4_61[@i_373], x5_60[@i_373], r_248[@i_373]) && otheruses(r_248[@i_373]) && find  else find  else ((x1_295 = x1_64[@i_373]) && ((x2_294 = x2_63[@i_373]) && ((X = x3_62[@i_373]) && ((Yp[@i_141] = x4_61[@i_373]) && false)))) then
    (
      out(c6[!_53], r_248[@i_373]);
      in(c9[!_53], ());
      let x1_738: host = U in
      let x2_737: host = S in
      find [unique] @i_893 <= qH0 suchthat defined(x1_69[@i_893], x2_68[@i_893], x3_67[@i_893], x4_66[@i_893], x5_65[@i_893], r_673[@i_893]) && otheruses(r_673[@i_893]) && find  else find  else ((x1_738 = x1_69[@i_893]) && ((x2_737 = x2_68[@i_893]) && ((X = x3_67[@i_893]) && ((Yp[@i_141] = x4_66[@i_893]) && false)))) then
      (
        let sk_u: hash0 = r_673[@i_893]
      )
      else
      (
        new r_733: hash0;
        let sk_u: hash0 = r_733
      )
    )
    else
    (
      new r_290: hash1;
      out(c6[!_53], r_290);
      in(c9[!_53], ());
      let x1_732: host = U in
      let x2_731: host = S in
      find [unique] @i_880 <= qH0 suchthat defined(x1_69[@i_880], x2_68[@i_880], x3_67[@i_880], x4_66[@i_880], x5_65[@i_880], r_673[@i_880]) && otheruses(r_673[@i_880]) && find  else find  else ((x1_732 = x1_69[@i_880]) && ((x2_731 = x2_68[@i_880]) && ((X = x3_67[@i_880]) && ((Yp[@i_141] = x4_66[@i_880]) && false)))) then
      (
        let sk_u: hash0 = r_673[@i_880]
      )
      else
      (
        new r_727: hash0;
        let sk_u: hash0 = r_727
      )
    )
  )
  orfind @i_140 <= NS suchthat defined(@2_r2_93[@i_140], y[@i_140], Y[@i_140]) && otheruses(@2_r2_93[@i_140]) && (Ystar_u = @2_r2_93[@i_140]) then
  (
    let K_u_1533: G = cst_G in
    let x1_301: host = U in
    let x2_300: host = S in
    find [unique] @i_382 <= qH1 suchthat defined(x1_64[@i_382], x2_63[@i_382], x3_62[@i_382], x4_61[@i_382], x5_60[@i_382], r_248[@i_382]) && otheruses(r_248[@i_382]) && find  else find  else ((x1_301 = x1_64[@i_382]) && ((x2_300 = x2_63[@i_382]) && ((X = x3_62[@i_382]) && ((Y[@i_140] = x4_61[@i_382]) && false)))) then
    (
      out(c6[!_53], r_248[@i_382]);
      in(c9[!_53], ());
      let x1_750: host = U in
      let x2_749: host = S in
      find [unique] @i_919 <= qH0 suchthat defined(x1_69[@i_919], x2_68[@i_919], x3_67[@i_919], x4_66[@i_919], x5_65[@i_919], r_673[@i_919]) && otheruses(r_673[@i_919]) && find  else find  else ((x1_750 = x1_69[@i_919]) && ((x2_749 = x2_68[@i_919]) && ((X = x3_67[@i_919]) && ((Y[@i_140] = x4_66[@i_919]) && false)))) then
      (
        let sk_u: hash0 = r_673[@i_919]
      )
      orfind  suchthat defined(j[@i_140], r_685[@i_140]) && otheruses(r_685[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_685[@i_140]
      )
      else
      (
        new r_745: hash0;
        let sk_u: hash0 = r_745
      )
    )
    else
    (
      new r_296: hash1;
      out(c6[!_53], r_296);
      in(c9[!_53], ());
      let x1_744: host = U in
      let x2_743: host = S in
      find [unique] @i_906 <= qH0 suchthat defined(x1_69[@i_906], x2_68[@i_906], x3_67[@i_906], x4_66[@i_906], x5_65[@i_906], r_673[@i_906]) && otheruses(r_673[@i_906]) && find  else find  else ((x1_744 = x1_69[@i_906]) && ((x2_743 = x2_68[@i_906]) && ((X = x3_67[@i_906]) && ((Y[@i_140] = x4_66[@i_906]) && false)))) then
      (
        let sk_u: hash0 = r_673[@i_906]
      )
      orfind  suchthat defined(j[@i_140], r_685[@i_140]) && otheruses(r_685[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_685[@i_140]
      )
      orfind  suchthat defined(j[@i_140], r_691[@i_140]) && otheruses(r_691[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
      (
        let sk_u: hash0 = r_691[@i_140]
      )
      else
      (
        new r_739: hash0;
        let sk_u: hash0 = r_739
      )
    )
  )
  else
  (
    new @1_x_1271: exponent;
    let @2_r4_96: G = cst_G in
    let K_u_1534: G = cst_G in
    let x1_277: host = U in
    let x2_276: host = S in
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ());
    let x1_702: host = U in
    let x2_701: host = S in
    find [unique] @i_815 <= qH0 suchthat defined(x1_69[@i_815], x2_68[@i_815], x3_67[@i_815], x4_66[@i_815], x5_65[@i_815], r_673[@i_815]) && otheruses(r_673[@i_815]) && find  else find  else ((x1_702 = x1_69[@i_815]) && ((x2_701 = x2_68[@i_815]) && ((X = x3_67[@i_815]) && ((@1_exp'(g, @1_x_1271) = x4_66[@i_815]) && false)))) then
    (
      let sk_u: hash0 = r_673[@i_815]
    )
    else
    (
      new r_697: hash0;
      let sk_u: hash0 = r_697
    )
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let x1_271: host = U in
    let x2_270: host = S in
    find [unique] @i_337 <= qH1 suchthat defined(x1_64[@i_337], x2_63[@i_337], x3_62[@i_337], x4_61[@i_337], x5_60[@i_337], r_248[@i_337]) && otheruses(r_248[@i_337]) && find  else find  else ((x1_271 = x1_64[@i_337]) && ((x2_270 = x2_63[@i_337]) && ((X_s = x3_62[@i_337]) && ((Y = x4_61[@i_337]) && false)))) then
    (
      if (auth_s = r_248[@i_337]) then
      let x1_690: host = U in
      let x2_689: host = S in
      find [unique] @i_789 <= qH0 suchthat defined(x1_69[@i_789], x2_68[@i_789], x3_67[@i_789], x4_66[@i_789], x5_65[@i_789], r_673[@i_789]) && otheruses(r_673[@i_789]) && find  else find  else ((x1_690 = x1_69[@i_789]) && ((x2_689 = x2_68[@i_789]) && ((X_s = x3_67[@i_789]) && ((Y = x4_66[@i_789]) && false)))) then
      (
        let sk_s: hash0 = r_673[@i_789]
      )
      orfind  suchthat defined(@i_140[j], r_739[j]) && otheruses(r_739[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
      (
        let sk_s: hash0 = r_739[j]
      )
      orfind  suchthat defined(@i_140[j], r_745[j]) && otheruses(r_745[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
      (
        let sk_s: hash0 = r_745[j]
      )
      else
      (
        new r_685: hash0;
        let sk_s: hash0 = r_685
      )
    )
    orfind  suchthat defined(@i_140[j], r_296[j]) && otheruses(r_296[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
    (
      if (auth_s = r_296[j]) then
      let x1_696: host = U in
      let x2_695: host = S in
      find [unique] @i_802 <= qH0 suchthat defined(x1_69[@i_802], x2_68[@i_802], x3_67[@i_802], x4_66[@i_802], x5_65[@i_802], r_673[@i_802]) && otheruses(r_673[@i_802]) && find  else find  else ((x1_696 = x1_69[@i_802]) && ((x2_695 = x2_68[@i_802]) && ((X_s = x3_67[@i_802]) && ((Y = x4_66[@i_802]) && false)))) then
      (
        let sk_s: hash0 = r_673[@i_802]
      )
      orfind  suchthat defined(r_739[j]) && otheruses(r_739[j]) then
      (
        let sk_s: hash0 = r_739[j]
      )
      else
      (
        new r_691: hash0;
        let sk_s: hash0 = r_691
      )
    )
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    event Auth
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  new @2_r2_90: G;
  let x1_259: host = U in
  let x2_258: host = S in
  new r_254: hash1;
  let x1_684: host = U in
  let x2_683: host = S in
  new r_679: hash0;
  let sk_p: hash0 = r_679 in
  out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@1_x_1092[@i_118], @2_kd[@i_118], @2_m[@i_118], @2_r4_84[@i_118]) && otheruses(@1_x_1092[@i_118]) && ((@2_x = @1_exp'(g, @1_x_1092[@i_118])) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_114 <= NU suchthat defined(@1_x_1271[@i_114], Ystar_u[@i_114], @2_r4_96[@i_114]) && otheruses(@1_x_1271[@i_114]) && ((@2_x = @1_exp'(g, @1_x_1271[@i_114])) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], Ystar_u[@i_114])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = Yp[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@2_m[@i_108], @2_kd[@i_108], @1_x_1092[@i_108], @2_r4_84[@i_108]) && otheruses(@1_x_1092[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], @1_exp'(g, @1_x_1092[@i_108]))
  )
  orfind @i_104 <= NU suchthat defined(Ystar_u[@i_104], @1_x_1271[@i_104], @2_r4_96[@i_104]) && otheruses(@1_x_1271[@i_104]) && ((@2_m = Ystar_u[@i_104]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], @1_exp'(g, @1_x_1271[@i_104]))
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@2_r2_90[@i_101], Yp[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Yp[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_r2_93[@i_100], Y[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @1_x_1092: exponent;
    let @2_r4_84: G = cst_G in
    out(@2_c4[!_57], @1_exp'(g, @1_x_1092))
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  find [unique] @i_763 <= qH0 suchthat defined(x1_69[@i_763], x2_68[@i_763], x3_67[@i_763], x4_66[@i_763], x5_65[@i_763], r_673[@i_763]) && otheruses(r_673[@i_763]) && ((x1_69 = x1_69[@i_763]) && ((x2_68 = x2_68[@i_763]) && ((x3_67 = x3_67[@i_763]) && ((x4_66 = x4_66[@i_763]) && (x5_65 = x5_65[@i_763]))))) then
  (
    out(c20[!_58], r_673[@i_763])
  )
  orfind @i_762 <= NP suchthat defined(x1_684[@i_762], x2_683[@i_762], Xp[@i_762], Yp[@i_762], xp[@i_762], yp[@i_762], r_679[@i_762]) && otheruses(r_679[@i_762]) && find  else find  else ((x1_69 = x1_684[@i_762]) && ((x2_68 = x2_683[@i_762]) && ((x3_67 = Xp[@i_762]) && ((x4_66 = Yp[@i_762]) && false)))) then
  (
    out(c20[!_58], r_679[@i_762])
  )
  orfind @i_761 <= NS suchthat defined(x1_690[@i_761], x2_689[@i_761], X_s[@i_761], Y[@i_761], x[j[@i_761]], y[@i_761], r_685[@i_761]) && otheruses(r_685[@i_761]) && find  else find  else ((x1_69 = x1_690[@i_761]) && ((x2_68 = x2_689[@i_761]) && ((x3_67 = X_s[@i_761]) && ((x4_66 = Y[@i_761]) && false)))) then
  (
    out(c20[!_58], r_685[@i_761])
  )
  orfind @i_760 <= NS suchthat defined(x1_696[@i_760], x2_695[@i_760], X_s[@i_760], Y[@i_760], x[j[@i_760]], y[@i_760], r_691[@i_760]) && otheruses(r_691[@i_760]) && find  else find  else ((x1_69 = x1_696[@i_760]) && ((x2_68 = x2_695[@i_760]) && ((x3_67 = X_s[@i_760]) && ((x4_66 = Y[@i_760]) && false)))) then
  (
    out(c20[!_58], r_691[@i_760])
  )
  orfind @i_759 <= NU suchthat defined(x[@i_759], K_u_1534[@i_759], x1_702[@i_759], x2_701[@i_759], X[@i_759], @1_x_1271[@i_759], r_697[@i_759]) && otheruses(r_697[@i_759]) && find  else find  else ((x1_69 = x1_702[@i_759]) && ((x2_68 = x2_701[@i_759]) && ((x3_67 = X[@i_759]) && ((x4_66 = @1_exp'(g, @1_x_1271[@i_759])) && false)))) then
  (
    out(c20[!_58], r_697[@i_759])
  )
  orfind @i_758 <= NU suchthat defined(x[@i_758], K_u_1530[@i_758], x1_708[@i_758], x2_707[@i_758], X[@i_758], @1_x_1092[@i_148[@i_758]], r_703[@i_758]) && otheruses(r_703[@i_758]) && find  else find  else ((x1_69 = x1_708[@i_758]) && ((x2_68 = x2_707[@i_758]) && ((x3_67 = X[@i_758]) && ((x4_66 = @1_exp'(g, @1_x_1092[@i_148[@i_758]])) && false)))) then
  (
    out(c20[!_58], r_703[@i_758])
  )
  orfind @i_757 <= NU suchthat defined(x[@i_757], K_u_1530[@i_757], x1_714[@i_757], x2_713[@i_757], X[@i_757], @1_x_1092[@i_148[@i_757]], r_709[@i_757]) && otheruses(r_709[@i_757]) && find  else find  else ((x1_69 = x1_714[@i_757]) && ((x2_68 = x2_713[@i_757]) && ((x3_67 = X[@i_757]) && ((x4_66 = @1_exp'(g, @1_x_1092[@i_148[@i_757]])) && false)))) then
  (
    out(c20[!_58], r_709[@i_757])
  )
  orfind @i_756 <= NU suchthat defined(x[@i_756], K_u_1531[@i_756], x1_720[@i_756], x2_719[@i_756], X[@i_756], @1_x_1271[@i_144[@i_756]], r_715[@i_756]) && otheruses(r_715[@i_756]) && find  else find  else ((x1_69 = x1_720[@i_756]) && ((x2_68 = x2_719[@i_756]) && ((x3_67 = X[@i_756]) && ((x4_66 = @1_exp'(g, @1_x_1271[@i_144[@i_756]])) && false)))) then
  (
    out(c20[!_58], r_715[@i_756])
  )
  orfind @i_755 <= NU suchthat defined(x[@i_755], K_u_1531[@i_755], x1_726[@i_755], x2_725[@i_755], X[@i_755], @1_x_1271[@i_144[@i_755]], r_721[@i_755]) && otheruses(r_721[@i_755]) && find  else find  else ((x1_69 = x1_726[@i_755]) && ((x2_68 = x2_725[@i_755]) && ((x3_67 = X[@i_755]) && ((x4_66 = @1_exp'(g, @1_x_1271[@i_144[@i_755]])) && false)))) then
  (
    out(c20[!_58], r_721[@i_755])
  )
  orfind @i_754 <= NU suchthat defined(x[@i_754], yp[@i_141[@i_754]], K_u_1532[@i_754], x1_732[@i_754], x2_731[@i_754], X[@i_754], Yp[@i_141[@i_754]], r_727[@i_754]) && otheruses(r_727[@i_754]) && find  else find  else ((x1_69 = x1_732[@i_754]) && ((x2_68 = x2_731[@i_754]) && ((x3_67 = X[@i_754]) && ((x4_66 = Yp[@i_141[@i_754]]) && false)))) then
  (
    out(c20[!_58], r_727[@i_754])
  )
  orfind @i_753 <= NU suchthat defined(x[@i_753], yp[@i_141[@i_753]], K_u_1532[@i_753], x1_738[@i_753], x2_737[@i_753], X[@i_753], Yp[@i_141[@i_753]], r_733[@i_753]) && otheruses(r_733[@i_753]) && find  else find  else ((x1_69 = x1_738[@i_753]) && ((x2_68 = x2_737[@i_753]) && ((x3_67 = X[@i_753]) && ((x4_66 = Yp[@i_141[@i_753]]) && false)))) then
  (
    out(c20[!_58], r_733[@i_753])
  )
  orfind @i_752 <= NU suchthat defined(x[@i_752], y[@i_140[@i_752]], K_u_1533[@i_752], x1_744[@i_752], x2_743[@i_752], X[@i_752], Y[@i_140[@i_752]], r_739[@i_752]) && otheruses(r_739[@i_752]) && find  else find  else ((x1_69 = x1_744[@i_752]) && ((x2_68 = x2_743[@i_752]) && ((x3_67 = X[@i_752]) && ((x4_66 = Y[@i_140[@i_752]]) && false)))) then
  (
    out(c20[!_58], r_739[@i_752])
  )
  orfind @i_751 <= NU suchthat defined(x[@i_751], y[@i_140[@i_751]], K_u_1533[@i_751], x1_750[@i_751], x2_749[@i_751], X[@i_751], Y[@i_140[@i_751]], r_745[@i_751]) && otheruses(r_745[@i_751]) && find  else find  else ((x1_69 = x1_750[@i_751]) && ((x2_68 = x2_749[@i_751]) && ((x3_67 = X[@i_751]) && ((x4_66 = Y[@i_140[@i_751]]) && false)))) then
  (
    out(c20[!_58], r_745[@i_751])
  )
  else
  (
    new r_673: hash0;
    out(c20[!_58], r_673)
  )
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  orfind @i_309 <= NP suchthat defined(x1_259[@i_309], x2_258[@i_309], Xp[@i_309], Yp[@i_309], xp[@i_309], yp[@i_309], r_254[@i_309]) && otheruses(r_254[@i_309]) && find  else find  else ((x1_64 = x1_259[@i_309]) && ((x2_63 = x2_258[@i_309]) && ((x3_62 = Xp[@i_309]) && ((x4_61 = Yp[@i_309]) && false)))) then
  (
    out(c21[!_59], r_254[@i_309])
  )
  orfind @i_306 <= NU suchthat defined(x[@i_306], K_u_1534[@i_306], x1_277[@i_306], x2_276[@i_306], X[@i_306], @1_x_1271[@i_306], r_272[@i_306]) && otheruses(r_272[@i_306]) && find  else find  else ((x1_64 = x1_277[@i_306]) && ((x2_63 = x2_276[@i_306]) && ((x3_62 = X[@i_306]) && ((x4_61 = @1_exp'(g, @1_x_1271[@i_306])) && false)))) then
  (
    out(c21[!_59], r_272[@i_306])
  )
  orfind @i_305 <= NU suchthat defined(x[@i_305], K_u_1530[@i_305], x1_283[@i_305], x2_282[@i_305], X[@i_305], @1_x_1092[@i_148[@i_305]], r_278[@i_305]) && otheruses(r_278[@i_305]) && find  else find  else ((x1_64 = x1_283[@i_305]) && ((x2_63 = x2_282[@i_305]) && ((x3_62 = X[@i_305]) && ((x4_61 = @1_exp'(g, @1_x_1092[@i_148[@i_305]])) && false)))) then
  (
    out(c21[!_59], r_278[@i_305])
  )
  orfind @i_304 <= NU suchthat defined(x[@i_304], K_u_1531[@i_304], x1_289[@i_304], x2_288[@i_304], X[@i_304], @1_x_1271[@i_144[@i_304]], r_284[@i_304]) && otheruses(r_284[@i_304]) && find  else find  else ((x1_64 = x1_289[@i_304]) && ((x2_63 = x2_288[@i_304]) && ((x3_62 = X[@i_304]) && ((x4_61 = @1_exp'(g, @1_x_1271[@i_144[@i_304]])) && false)))) then
  (
    out(c21[!_59], r_284[@i_304])
  )
  orfind @i_303 <= NU suchthat defined(x[@i_303], yp[@i_141[@i_303]], K_u_1532[@i_303], x1_295[@i_303], x2_294[@i_303], X[@i_303], Yp[@i_141[@i_303]], r_290[@i_303]) && otheruses(r_290[@i_303]) && find  else find  else ((x1_64 = x1_295[@i_303]) && ((x2_63 = x2_294[@i_303]) && ((x3_62 = X[@i_303]) && ((x4_61 = Yp[@i_141[@i_303]]) && false)))) then
  (
    out(c21[!_59], r_290[@i_303])
  )
  orfind @i_302 <= NU suchthat defined(x[@i_302], y[@i_140[@i_302]], K_u_1533[@i_302], x1_301[@i_302], x2_300[@i_302], X[@i_302], Y[@i_140[@i_302]], r_296[@i_302]) && otheruses(r_296[@i_302]) && find  else find  else ((x1_64 = x1_301[@i_302]) && ((x2_63 = x2_300[@i_302]) && ((x3_62 = X[@i_302]) && ((x4_61 = Y[@i_140[@i_302]]) && false)))) then
  (
    out(c21[!_59], r_296[@i_302])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying simplify yields

Game 30 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_148 <= qD suchthat defined(@2_m[@i_148], @2_kd[@i_148], @1_x_1092[@i_148], @2_r4_84[@i_148]) && otheruses(@1_x_1092[@i_148]) && ((Ystar_u = @2_m[@i_148]) && (pw = @2_kd[@i_148])) then
  (
    let K_u_1530: G = cst_G in
    let x1_283: host = U in
    let x2_282: host = S in
    new r_278: hash1;
    out(c6[!_53], r_278);
    in(c9[!_53], ());
    let x1_708: host = U in
    let x2_707: host = S in
    new r_703: hash0;
    let sk_u: hash0 = r_703
  )
  orfind @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  orfind @i_141 <= NP suchthat defined(@2_r2_90[@i_141]) && otheruses(@2_r2_90[@i_141]) && (Ystar_u = @2_r2_90[@i_141]) then
  (
    let K_u_1532: G = cst_G in
    let x1_295: host = U in
    let x2_294: host = S in
    new r_290: hash1;
    out(c6[!_53], r_290);
    in(c9[!_53], ());
    let x1_732: host = U in
    let x2_731: host = S in
    new r_727: hash0;
    let sk_u: hash0 = r_727
  )
  orfind @i_140 <= NS suchthat defined(@2_r2_93[@i_140]) && otheruses(@2_r2_93[@i_140]) && (Ystar_u = @2_r2_93[@i_140]) then
  (
    let K_u_1533: G = cst_G in
    let x1_301: host = U in
    let x2_300: host = S in
    new r_296: hash1;
    out(c6[!_53], r_296);
    in(c9[!_53], ());
    let x1_744: host = U in
    let x2_743: host = S in
    if defined(j[@i_140], r_691[@i_140]) && otheruses(r_691[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
    (
      let sk_u: hash0 = r_691[@i_140]
    )
    else
    (
      new r_739: hash0;
      let sk_u: hash0 = r_739
    )
  )
  else
  (
    new @1_x_1271: exponent;
    let @2_r4_96: G = cst_G in
    let K_u_1534: G = cst_G in
    let x1_277: host = U in
    let x2_276: host = S in
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ());
    let x1_702: host = U in
    let x2_701: host = S in
    new r_697: hash0;
    let sk_u: hash0 = r_697
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    let x1_271: host = U in
    let x2_270: host = S in
    if defined(@i_140[j], r_296[j]) && otheruses(r_296[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
    if (auth_s = r_296[j]) then
    let x1_696: host = U in
    let x2_695: host = S in
    if defined(r_739[j]) && otheruses(r_739[j]) then
    (
      let sk_s: hash0 = r_739[j]
    )
    else
    (
      new r_691: hash0;
      let sk_s: hash0 = r_691
    )
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    event Auth
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  new @2_r2_90: G;
  let x1_259: host = U in
  let x2_258: host = S in
  new r_254: hash1;
  let x1_684: host = U in
  let x2_683: host = S in
  new r_679: hash0;
  let sk_p: hash0 = r_679 in
  out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@1_x_1092[@i_118], @2_kd[@i_118], @2_m[@i_118], @2_r4_84[@i_118]) && otheruses(@1_x_1092[@i_118]) && ((@2_x = @1_exp'(g, @1_x_1092[@i_118])) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = Yp[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@2_m[@i_108], @2_kd[@i_108], @1_x_1092[@i_108], @2_r4_84[@i_108]) && otheruses(@1_x_1092[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], @1_exp'(g, @1_x_1092[@i_108]))
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@2_r2_90[@i_101], Yp[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Yp[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_r2_93[@i_100], Y[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @1_x_1092: exponent;
    let @2_r4_84: G = cst_G in
    out(@2_c4[!_57], @1_exp'(g, @1_x_1092))
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  find [unique] @i_763 <= qH0 suchthat defined(x1_69[@i_763], x2_68[@i_763], x3_67[@i_763], x4_66[@i_763], x5_65[@i_763], r_673[@i_763]) && otheruses(r_673[@i_763]) && ((x1_69 = x1_69[@i_763]) && ((x2_68 = x2_68[@i_763]) && ((x3_67 = x3_67[@i_763]) && ((x4_66 = x4_66[@i_763]) && (x5_65 = x5_65[@i_763]))))) then
  (
    out(c20[!_58], r_673[@i_763])
  )
  else
  (
    new r_673: hash0;
    out(c20[!_58], r_673)
  )
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying move all binders yields

Game 31 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_148 <= qD suchthat defined(@2_m[@i_148], @2_kd[@i_148], @1_x_1092[@i_148], @2_r4_84[@i_148]) && otheruses(@1_x_1092[@i_148]) && ((Ystar_u = @2_m[@i_148]) && (pw = @2_kd[@i_148])) then
  (
    let K_u_1530: G = cst_G in
    let x1_283: host = U in
    let x2_282: host = S in
    new r_278: hash1;
    out(c6[!_53], r_278);
    in(c9[!_53], ());
    let x1_708: host = U in
    let x2_707: host = S in
    new r_703: hash0;
    let sk_u: hash0 = r_703
  )
  orfind @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  orfind @i_141 <= NP suchthat defined(@2_r2_90[@i_141]) && otheruses(@2_r2_90[@i_141]) && (Ystar_u = @2_r2_90[@i_141]) then
  (
    let K_u_1532: G = cst_G in
    let x1_295: host = U in
    let x2_294: host = S in
    new r_290: hash1;
    out(c6[!_53], r_290);
    in(c9[!_53], ());
    let x1_732: host = U in
    let x2_731: host = S in
    new r_727: hash0;
    let sk_u: hash0 = r_727
  )
  orfind @i_140 <= NS suchthat defined(@2_r2_93[@i_140]) && otheruses(@2_r2_93[@i_140]) && (Ystar_u = @2_r2_93[@i_140]) then
  (
    new r_296: hash1;
    out(c6[!_53], r_296);
    in(c9[!_53], ());
    if defined(j[@i_140], r_691[@i_140]) && otheruses(r_691[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
    (
      let sk_u: hash0 = r_691[@i_140]
    )
    else
    (
      new r_739: hash0;
      let sk_u: hash0 = r_739
    )
  )
  else
  (
    new @1_x_1271: exponent;
    let @2_r4_96: G = cst_G in
    let K_u_1534: G = cst_G in
    let x1_277: host = U in
    let x2_276: host = S in
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ());
    let x1_702: host = U in
    let x2_701: host = S in
    new r_697: hash0;
    let sk_u: hash0 = r_697
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_140[j], r_296[j]) && otheruses(r_296[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
    if (auth_s = r_296[j]) then
    if defined(r_739[j]) && otheruses(r_739[j]) then
    (
      let sk_s: hash0 = r_739[j]
    )
    else
    (
      new r_691: hash0;
      let sk_s: hash0 = r_691
    )
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    event Auth
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  new @2_r2_90: G;
  let x1_259: host = U in
  let x2_258: host = S in
  new r_254: hash1;
  let x1_684: host = U in
  let x2_683: host = S in
  new r_679: hash0;
  let sk_p: hash0 = r_679 in
  out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@1_x_1092[@i_118], @2_kd[@i_118], @2_m[@i_118], @2_r4_84[@i_118]) && otheruses(@1_x_1092[@i_118]) && ((@2_x = @1_exp'(g, @1_x_1092[@i_118])) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = Yp[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@2_m[@i_108], @2_kd[@i_108], @1_x_1092[@i_108], @2_r4_84[@i_108]) && otheruses(@1_x_1092[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], @1_exp'(g, @1_x_1092[@i_108]))
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@2_r2_90[@i_101], Yp[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Yp[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_r2_93[@i_100], Y[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @1_x_1092: exponent;
    let @2_r4_84: G = cst_G in
    out(@2_c4[!_57], @1_exp'(g, @1_x_1092))
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  find [unique] @i_763 <= qH0 suchthat defined(x1_69[@i_763], x2_68[@i_763], x3_67[@i_763], x4_66[@i_763], x5_65[@i_763], r_673[@i_763]) && otheruses(r_673[@i_763]) && ((x1_69 = x1_69[@i_763]) && ((x2_68 = x2_68[@i_763]) && ((x3_67 = x3_67[@i_763]) && ((x4_66 = x4_66[@i_763]) && (x5_65 = x5_65[@i_763]))))) then
  (
    out(c20[!_58], r_673[@i_763])
  )
  else
  (
    new r_673: hash0;
    out(c20[!_58], r_673)
  )
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying remove assignments of useless yields

Game 32 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_148 <= qD suchthat defined(@2_m[@i_148], @2_kd[@i_148], @1_x_1092[@i_148], @2_r4_84[@i_148]) && otheruses(@1_x_1092[@i_148]) && ((Ystar_u = @2_m[@i_148]) && (pw = @2_kd[@i_148])) then
  (
    new r_278: hash1;
    out(c6[!_53], r_278);
    in(c9[!_53], ());
    new r_703: hash0;
    let sk_u: hash0 = r_703
  )
  orfind @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  orfind @i_141 <= NP suchthat defined(@2_r2_90[@i_141]) && otheruses(@2_r2_90[@i_141]) && (Ystar_u = @2_r2_90[@i_141]) then
  (
    new r_290: hash1;
    out(c6[!_53], r_290);
    in(c9[!_53], ());
    new r_727: hash0;
    let sk_u: hash0 = r_727
  )
  orfind @i_140 <= NS suchthat defined(@2_r2_93[@i_140]) && otheruses(@2_r2_93[@i_140]) && (Ystar_u = @2_r2_93[@i_140]) then
  (
    new r_296: hash1;
    out(c6[!_53], r_296);
    in(c9[!_53], ());
    if defined(j[@i_140], r_691[@i_140]) && otheruses(r_691[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
    (
      let sk_u: hash0 = r_691[@i_140]
    )
    else
    (
      new r_739: hash0;
      let sk_u: hash0 = r_739
    )
  )
  else
  (
    new @1_x_1271: exponent;
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ());
    new r_697: hash0;
    let sk_u: hash0 = r_697
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_140[j], r_296[j]) && otheruses(r_296[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
    if (auth_s = r_296[j]) then
    if defined(r_739[j]) && otheruses(r_739[j]) then
    (
      let sk_s: hash0 = r_739[j]
    )
    else
    (
      new r_691: hash0;
      let sk_s: hash0 = r_691
    )
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    event Auth
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  new @2_r2_90: G;
  new r_254: hash1;
  new r_679: hash0;
  let sk_p: hash0 = r_679 in
  out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@1_x_1092[@i_118], @2_kd[@i_118], @2_m[@i_118], @2_r4_84[@i_118]) && otheruses(@1_x_1092[@i_118]) && ((@2_x = @1_exp'(g, @1_x_1092[@i_118])) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = Yp[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@2_m[@i_108], @2_kd[@i_108], @1_x_1092[@i_108], @2_r4_84[@i_108]) && otheruses(@1_x_1092[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], @1_exp'(g, @1_x_1092[@i_108]))
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@2_r2_90[@i_101], Yp[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Yp[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_r2_93[@i_100], Y[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @1_x_1092: exponent;
    let @2_r4_84: G = cst_G in
    out(@2_c4[!_57], @1_exp'(g, @1_x_1092))
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  find [unique] @i_763 <= qH0 suchthat defined(x1_69[@i_763], x2_68[@i_763], x3_67[@i_763], x4_66[@i_763], x5_65[@i_763], r_673[@i_763]) && otheruses(r_673[@i_763]) && ((x1_69 = x1_69[@i_763]) && ((x2_68 = x2_68[@i_763]) && ((x3_67 = x3_67[@i_763]) && ((x4_66 = x4_66[@i_763]) && (x5_65 = x5_65[@i_763]))))) then
  (
    out(c20[!_58], r_673[@i_763])
  )
  else
  (
    new r_673: hash0;
    out(c20[!_58], r_673)
  )
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


RESULT Proved secrecy of sk_p excluding set(event Auth in game 4) U set(dist 4->5, proba <= (NS * NS + 2. * NP * NS + 2. * qE * NS + 2. * NU * NS + 2. * qD * NS + NP * NP + 2. * qE * NP + 2. * NU * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 2. * qD * qE + NU * NU + 2. * qD * NU + qD * qD + -1. * NS + -1. * NP + -1. * qE + -1. * NU + -1. * qD) / |G|) U set(dist 5->6, proba <= NP * NS / |exponent| + NP * qE / |exponent| + NP * NU / |exponent| + NP * qD / |exponent| + NS * NP / |exponent| + NS * qE / |exponent| + NS * NU / |exponent| + NS * qD / |exponent| + 0.5 * NP * NP / |exponent| + 0.5 * NS * NS / |exponent|) U set(event Encrypt in game 8) U set(dist 9->10, proba <= 1. / |exponent| * NP + 7. * 1. / |exponent| * NS + 9. * 1. / |exponent| * NU + 11. * NP * NU / |exponent| + 4. * NP * NS / |exponent| + 2. * NP * qH1 / |exponent| + 2. * NS / |hash1| + 2. * NS * NU / |exponent| + NS * qD / |exponent| + 4.5 * NU * NU / |G| + 3. * NU * NS / |G| + 2. * NU * NP / |G| + NU * qH1 / |G| + NP * qD / |exponent| + qD * NS / |G| + qD * NP / |G| + 1.5 * NP * NP / |exponent| + 2. * NS * NP / |exponent| + 0.5 * NU * NU / |exponent| + 2. * NU * NP / |exponent| + NU * qD / |G| + 0.5 * qD * qD / |G|) U set(dist 13->14, proba <= 1. / |exponent| * NP + 14. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + 19. * NP * NU / |exponent| + 4. * NP * NS / |exponent| + 2. * NP * qH0 / |exponent| + NS * NU / |exponent| + NS * qD / |exponent| + NU * NS / |G| + NU * NP / |G| + NP * qD / |exponent| + qD * NS / |G| + qD * NP / |G| + 0.5 * NS * NS / |G| + NU * qH1 / |hash1|) U set(dist 28->29, proba <= pCDH(time + time(context for game 28), NU + NP, NU + qD + NP + NS, 5. * NU * qH1 + NP * qH1 + 9. * NU * qH0 + 3. * NS * qH0 + NP * qH0 + qH1 * NS + qH0 + qH1, 0))
RESULT However, I could not bound the probability of set(event Auth in game 4)
RESULT Proved secrecy of sk_s excluding set(event Auth in game 4) U set(dist 4->5, proba <= (NS * NS + 2. * NP * NS + 2. * qE * NS + 2. * NU * NS + 2. * qD * NS + NP * NP + 2. * qE * NP + 2. * NU * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 2. * qD * qE + NU * NU + 2. * qD * NU + qD * qD + -1. * NS + -1. * NP + -1. * qE + -1. * NU + -1. * qD) / |G|) U set(dist 5->6, proba <= NP * NS / |exponent| + NP * qE / |exponent| + NP * NU / |exponent| + NP * qD / |exponent| + NS * NP / |exponent| + NS * qE / |exponent| + NS * NU / |exponent| + NS * qD / |exponent| + 0.5 * NP * NP / |exponent| + 0.5 * NS * NS / |exponent|) U set(event Encrypt in game 8) U set(dist 9->10, proba <= 1. / |exponent| * NP + 7. * 1. / |exponent| * NS + 9. * 1. / |exponent| * NU + 11. * NP * NU / |exponent| + 4. * NP * NS / |exponent| + 2. * NP * qH1 / |exponent| + 2. * NS / |hash1| + 2. * NS * NU / |exponent| + NS * qD / |exponent| + 4.5 * NU * NU / |G| + 3. * NU * NS / |G| + 2. * NU * NP / |G| + NU * qH1 / |G| + NP * qD / |exponent| + qD * NS / |G| + qD * NP / |G| + 1.5 * NP * NP / |exponent| + 2. * NS * NP / |exponent| + 0.5 * NU * NU / |exponent| + 2. * NU * NP / |exponent| + NU * qD / |G| + 0.5 * qD * qD / |G|) U set(dist 13->14, proba <= 1. / |exponent| * NP + 14. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + 19. * NP * NU / |exponent| + 4. * NP * NS / |exponent| + 2. * NP * qH0 / |exponent| + NS * NU / |exponent| + NS * qD / |exponent| + NU * NS / |G| + NU * NP / |G| + NP * qD / |exponent| + qD * NS / |G| + qD * NP / |G| + 0.5 * NS * NS / |G| + NU * qH1 / |hash1|) U set(dist 28->29, proba <= pCDH(time + time(context for game 28), NU + NP, NU + qD + NP + NS, 5. * NU * qH1 + NP * qH1 + 9. * NU * qH0 + 3. * NS * qH0 + NP * qH0 + qH1 * NS + qH0 + qH1, 0))
RESULT However, I could not bound the probability of set(event Auth in game 4)
RESULT Proved secrecy of sk_u excluding set(event Auth in game 4) U set(dist 4->5, proba <= (NS * NS + 2. * NP * NS + 2. * qE * NS + 2. * NU * NS + 2. * qD * NS + NP * NP + 2. * qE * NP + 2. * NU * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 2. * qD * qE + NU * NU + 2. * qD * NU + qD * qD + -1. * NS + -1. * NP + -1. * qE + -1. * NU + -1. * qD) / |G|) U set(dist 5->6, proba <= NP * NS / |exponent| + NP * qE / |exponent| + NP * NU / |exponent| + NP * qD / |exponent| + NS * NP / |exponent| + NS * qE / |exponent| + NS * NU / |exponent| + NS * qD / |exponent| + 0.5 * NP * NP / |exponent| + 0.5 * NS * NS / |exponent|) U set(event Encrypt in game 8) U set(dist 9->10, proba <= 1. / |exponent| * NP + 7. * 1. / |exponent| * NS + 9. * 1. / |exponent| * NU + 11. * NP * NU / |exponent| + 4. * NP * NS / |exponent| + 2. * NP * qH1 / |exponent| + 2. * NS / |hash1| + 2. * NS * NU / |exponent| + NS * qD / |exponent| + 4.5 * NU * NU / |G| + 3. * NU * NS / |G| + 2. * NU * NP / |G| + NU * qH1 / |G| + NP * qD / |exponent| + qD * NS / |G| + qD * NP / |G| + 1.5 * NP * NP / |exponent| + 2. * NS * NP / |exponent| + 0.5 * NU * NU / |exponent| + 2. * NU * NP / |exponent| + NU * qD / |G| + 0.5 * qD * qD / |G|) U set(dist 13->14, proba <= 1. / |exponent| * NP + 14. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + 19. * NP * NU / |exponent| + 4. * NP * NS / |exponent| + 2. * NP * qH0 / |exponent| + NS * NU / |exponent| + NS * qD / |exponent| + NU * NS / |G| + NU * NP / |G| + NP * qD / |exponent| + qD * NS / |G| + qD * NP / |G| + 0.5 * NS * NS / |G| + NU * qH1 / |hash1|) U set(dist 28->29, proba <= pCDH(time + time(context for game 28), NU + NP, NU + qD + NP + NS, 5. * NU * qH1 + NP * qH1 + 9. * NU * qH0 + 3. * NS * qH0 + NP * qH0 + qH1 * NS + qH0 + qH1, 0))
RESULT However, I could not bound the probability of set(event Auth in game 4)

Applying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; () -> @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; () -> @1_X
 yields

Game 33 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_148 <= qD suchthat defined(@1_X_4030[@i_148], @2_m[@i_148], @2_kd[@i_148], @1_x_1092[@i_148], @2_r4_84[@i_148]) && otheruses(@1_X_4030[@i_148]) && ((Ystar_u = @2_m[@i_148]) && (pw = @2_kd[@i_148])) then
  (
    new r_278: hash1;
    out(c6[!_53], r_278);
    in(c9[!_53], ());
    new r_703: hash0;
    let sk_u: hash0 = r_703
  )
  orfind @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  orfind @i_141 <= NP suchthat defined(@2_r2_90[@i_141]) && otheruses(@2_r2_90[@i_141]) && (Ystar_u = @2_r2_90[@i_141]) then
  (
    new r_290: hash1;
    out(c6[!_53], r_290);
    in(c9[!_53], ());
    new r_727: hash0;
    let sk_u: hash0 = r_727
  )
  orfind @i_140 <= NS suchthat defined(@2_r2_93[@i_140]) && otheruses(@2_r2_93[@i_140]) && (Ystar_u = @2_r2_93[@i_140]) then
  (
    new r_296: hash1;
    out(c6[!_53], r_296);
    in(c9[!_53], ());
    if defined(j[@i_140], r_691[@i_140]) && otheruses(r_691[@i_140]) && ((!_53 = j[@i_140]) && (!_53 = j[@i_140])) then
    (
      let sk_u: hash0 = r_691[@i_140]
    )
    else
    (
      new r_739: hash0;
      let sk_u: hash0 = r_739
    )
  )
  else
  (
    new @1_x_1271: exponent;
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ());
    new r_697: hash0;
    let sk_u: hash0 = r_697
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_140[j], r_296[j]) && otheruses(r_296[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
    if (auth_s = r_296[j]) then
    if defined(r_739[j]) && otheruses(r_739[j]) then
    (
      let sk_s: hash0 = r_739[j]
    )
    else
    (
      new r_691: hash0;
      let sk_s: hash0 = r_691
    )
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    event Auth
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  new @2_r2_90: G;
  new r_254: hash1;
  new r_679: hash0;
  let sk_p: hash0 = r_679 in
  out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@1_X_4030[@i_118], @1_x_1092[@i_118], @2_kd[@i_118], @2_m[@i_118], @2_r4_84[@i_118]) && otheruses(@1_X_4030[@i_118]) && ((@2_x = @1_X_4030[@i_118]) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = Yp[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@1_X_4030[@i_108], @2_m[@i_108], @2_kd[@i_108], @1_x_1092[@i_108], @2_r4_84[@i_108]) && otheruses(@1_X_4030[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], @1_X_4030[@i_108])
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@2_r2_90[@i_101], Yp[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Yp[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_r2_93[@i_100], Y[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @1_X_4030: G;
    let @1_x_1092: exponent = cst_exponent in
    let @2_r4_84: G = cst_G in
    out(@2_c4[!_57], @1_X_4030)
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  find [unique] @i_763 <= qH0 suchthat defined(x1_69[@i_763], x2_68[@i_763], x3_67[@i_763], x4_66[@i_763], x5_65[@i_763], r_673[@i_763]) && otheruses(r_673[@i_763]) && ((x1_69 = x1_69[@i_763]) && ((x2_68 = x2_68[@i_763]) && ((x3_67 = x3_67[@i_763]) && ((x4_66 = x4_66[@i_763]) && (x5_65 = x5_65[@i_763]))))) then
  (
    out(c20[!_58], r_673[@i_763])
  )
  else
  (
    new r_673: hash0;
    out(c20[!_58], r_673)
  )
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying simplify yields

Game 34 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  orfind @i_140 <= NS suchthat defined(@2_r2_93[@i_140]) && otheruses(@2_r2_93[@i_140]) && (Ystar_u = @2_r2_93[@i_140]) then
  (
    new r_296: hash1;
    out(c6[!_53], r_296);
    in(c9[!_53], ());
    new r_739: hash0
  )
  else
  (
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ())
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_140[j], r_296[j]) && otheruses(r_296[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
    if (auth_s = r_296[j]) then
    new r_691: hash0
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    event Auth
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  new @2_r2_90: G;
  new r_254: hash1;
  new r_679: hash0;
  let sk_p: hash0 = r_679 in
  out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@1_X_4030[@i_118], @2_kd[@i_118], @2_m[@i_118], @2_r4_84[@i_118]) && otheruses(@1_X_4030[@i_118]) && ((@2_x = @1_X_4030[@i_118]) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = Yp[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@2_m[@i_108], @2_kd[@i_108], @1_X_4030[@i_108], @2_r4_84[@i_108]) && otheruses(@1_X_4030[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], @1_X_4030[@i_108])
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@2_r2_90[@i_101], Yp[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Yp[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_r2_93[@i_100], Y[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @1_X_4030: G;
    let @1_x_1092: exponent = cst_exponent in
    let @2_r4_84: G = cst_G in
    out(@2_c4[!_57], @1_X_4030)
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  find [unique] @i_763 <= qH0 suchthat defined(x1_69[@i_763], x2_68[@i_763], x3_67[@i_763], x4_66[@i_763], x5_65[@i_763], r_673[@i_763]) && otheruses(r_673[@i_763]) && ((x1_69 = x1_69[@i_763]) && ((x2_68 = x2_68[@i_763]) && ((x3_67 = x3_67[@i_763]) && ((x4_66 = x4_66[@i_763]) && (x5_65 = x5_65[@i_763]))))) then
  (
    out(c20[!_58], r_673[@i_763])
  )
  else
  (
    new r_673: hash0;
    out(c20[!_58], r_673)
  )
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying remove assignments of useless yields

Game 35 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  orfind @i_140 <= NS suchthat defined(@2_r2_93[@i_140]) && otheruses(@2_r2_93[@i_140]) && (Ystar_u = @2_r2_93[@i_140]) then
  (
    new r_296: hash1;
    out(c6[!_53], r_296);
    in(c9[!_53], ());
    new r_739: hash0
  )
  else
  (
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ())
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_140[j], r_296[j]) && otheruses(r_296[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
    if (auth_s = r_296[j]) then
    new r_691: hash0
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    event Auth
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  new @2_r2_90: G;
  new r_254: hash1;
  new r_679: hash0;
  out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@1_X_4030[@i_118], @2_kd[@i_118], @2_m[@i_118], @2_r4_84[@i_118]) && otheruses(@1_X_4030[@i_118]) && ((@2_x = @1_X_4030[@i_118]) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = Yp[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@2_m[@i_108], @2_kd[@i_108], @1_X_4030[@i_108], @2_r4_84[@i_108]) && otheruses(@1_X_4030[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], @1_X_4030[@i_108])
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@2_r2_90[@i_101], Yp[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Yp[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_r2_93[@i_100], Y[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @1_X_4030: G;
    let @2_r4_84: G = cst_G in
    out(@2_c4[!_57], @1_X_4030)
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  find [unique] @i_763 <= qH0 suchthat defined(x1_69[@i_763], x2_68[@i_763], x3_67[@i_763], x4_66[@i_763], x5_65[@i_763], r_673[@i_763]) && otheruses(r_673[@i_763]) && ((x1_69 = x1_69[@i_763]) && ((x2_68 = x2_68[@i_763]) && ((x3_67 = x3_67[@i_763]) && ((x4_66 = x4_66[@i_763]) && (x5_65 = x5_65[@i_763]))))) then
  (
    out(c20[!_58], r_673[@i_763])
  )
  else
  (
    new r_673: hash0;
    out(c20[!_58], r_673)
  )
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; () -> @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; () -> @1_X
 yields

Game 36 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  orfind @i_140 <= NS suchthat defined(@2_r2_93[@i_140]) && otheruses(@2_r2_93[@i_140]) && (Ystar_u = @2_r2_93[@i_140]) then
  (
    new r_296: hash1;
    out(c6[!_53], r_296);
    in(c9[!_53], ());
    new r_739: hash0
  )
  else
  (
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ())
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_140[j], r_296[j]) && otheruses(r_296[j]) && ((!_54 = @i_140[j]) && (!_54 = @i_140[j])) then
    if (auth_s = r_296[j]) then
    new r_691: hash0
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    event Auth
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new @1_X_4146: G;
  let Yp: G = @1_X_4146 in
  new @2_r2_90: G;
  new r_254: hash1;
  new r_679: hash0;
  out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@1_X_4030[@i_118], @2_kd[@i_118], @2_m[@i_118], @2_r4_84[@i_118]) && otheruses(@1_X_4030[@i_118]) && ((@2_x = @1_X_4030[@i_118]) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = Yp[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@2_m[@i_108], @2_kd[@i_108], @1_X_4030[@i_108], @2_r4_84[@i_108]) && otheruses(@1_X_4030[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], @1_X_4030[@i_108])
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@2_r2_90[@i_101], Yp[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Yp[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_r2_93[@i_100], Y[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @1_X_4030: G;
    let @2_r4_84: G = cst_G in
    out(@2_c4[!_57], @1_X_4030)
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  find [unique] @i_763 <= qH0 suchthat defined(x1_69[@i_763], x2_68[@i_763], x3_67[@i_763], x4_66[@i_763], x5_65[@i_763], r_673[@i_763]) && otheruses(r_673[@i_763]) && ((x1_69 = x1_69[@i_763]) && ((x2_68 = x2_68[@i_763]) && ((x3_67 = x3_67[@i_763]) && ((x4_66 = x4_66[@i_763]) && (x5_65 = x5_65[@i_763]))))) then
  (
    out(c20[!_58], r_673[@i_763])
  )
  else
  (
    new r_673: hash0;
    out(c20[!_58], r_673)
  )
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying simplify yields

Game 37 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  else
  (
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ())
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    yield
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    event Auth
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new @1_X_4146: G;
  let Yp: G = @1_X_4146 in
  new @2_r2_90: G;
  new r_254: hash1;
  out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@1_X_4030[@i_118], @2_kd[@i_118], @2_m[@i_118], @2_r4_84[@i_118]) && otheruses(@1_X_4030[@i_118]) && ((@2_x = @1_X_4030[@i_118]) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = Yp[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@2_m[@i_108], @2_kd[@i_108], @1_X_4030[@i_108], @2_r4_84[@i_108]) && otheruses(@1_X_4030[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], @1_X_4030[@i_108])
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@2_r2_90[@i_101], Yp[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Yp[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_r2_93[@i_100], Y[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @1_X_4030: G;
    let @2_r4_84: G = cst_G in
    out(@2_c4[!_57], @1_X_4030)
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  find [unique] @i_763 <= qH0 suchthat defined(x1_69[@i_763], x2_68[@i_763], x3_67[@i_763], x4_66[@i_763], x5_65[@i_763], r_673[@i_763]) && otheruses(r_673[@i_763]) && ((x1_69 = x1_69[@i_763]) && ((x2_68 = x2_68[@i_763]) && ((x3_67 = x3_67[@i_763]) && ((x4_66 = x4_66[@i_763]) && (x5_65 = x5_65[@i_763]))))) then
  (
    out(c20[!_58], r_673[@i_763])
  )
  else
  (
    new r_673: hash0;
    out(c20[!_58], r_673)
  )
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying remove assignments of useless yields

Game 38 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  else
  (
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ())
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    yield
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    event Auth
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new @1_X_4146: G;
  let Yp: G = cst_G in
  new @2_r2_90: G;
  new r_254: hash1;
  out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@1_X_4030[@i_118], @2_kd[@i_118], @2_m[@i_118], @2_r4_84[@i_118]) && otheruses(@1_X_4030[@i_118]) && ((@2_x = @1_X_4030[@i_118]) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(@1_X_4146[@i_111], Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = @1_X_4146[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@2_m[@i_108], @2_kd[@i_108], @1_X_4030[@i_108], @2_r4_84[@i_108]) && otheruses(@1_X_4030[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], @1_X_4030[@i_108])
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@1_X_4146[@i_101], Yp[@i_101], @2_r2_90[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], @1_X_4146[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_r2_93[@i_100], Y[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @1_X_4030: G;
    let @2_r4_84: G = cst_G in
    out(@2_c4[!_57], @1_X_4030)
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  find [unique] @i_763 <= qH0 suchthat defined(x1_69[@i_763], x2_68[@i_763], x3_67[@i_763], x4_66[@i_763], x5_65[@i_763], r_673[@i_763]) && otheruses(r_673[@i_763]) && ((x1_69 = x1_69[@i_763]) && ((x2_68 = x2_68[@i_763]) && ((x3_67 = x3_67[@i_763]) && ((x4_66 = x4_66[@i_763]) && (x5_65 = x5_65[@i_763]))))) then
  (
    out(c20[!_58], r_673[@i_763])
  )
  else
  (
    new r_673: hash0;
    out(c20[!_58], r_673)
  )
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; () -> @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; () -> @1_X
 yields

Game 39 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  else
  (
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ())
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    yield
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    event Auth
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new @1_X_4255: G;
  let Xp: G = @1_X_4255 in
  new @1_X_4146: G;
  let Yp: G = cst_G in
  new @2_r2_90: G;
  new r_254: hash1;
  out(cp[!_55], (U, Xp, S, @2_r2_90, r_254))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@1_X_4030[@i_118], @2_kd[@i_118], @2_m[@i_118], @2_r4_84[@i_118]) && otheruses(@1_X_4030[@i_118]) && ((@2_x = @1_X_4030[@i_118]) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(@1_X_4146[@i_111], Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = @1_X_4146[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@2_m[@i_108], @2_kd[@i_108], @1_X_4030[@i_108], @2_r4_84[@i_108]) && otheruses(@1_X_4030[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], @1_X_4030[@i_108])
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@1_X_4146[@i_101], Yp[@i_101], @2_r2_90[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], @1_X_4146[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_r2_93[@i_100], Y[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @1_X_4030: G;
    let @2_r4_84: G = cst_G in
    out(@2_c4[!_57], @1_X_4030)
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  find [unique] @i_763 <= qH0 suchthat defined(x1_69[@i_763], x2_68[@i_763], x3_67[@i_763], x4_66[@i_763], x5_65[@i_763], r_673[@i_763]) && otheruses(r_673[@i_763]) && ((x1_69 = x1_69[@i_763]) && ((x2_68 = x2_68[@i_763]) && ((x3_67 = x3_67[@i_763]) && ((x4_66 = x4_66[@i_763]) && (x5_65 = x5_65[@i_763]))))) then
  (
    out(c20[!_58], r_673[@i_763])
  )
  else
  (
    new r_673: hash0;
    out(c20[!_58], r_673)
  )
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying remove assignments of useless yields

Game 40 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  else
  (
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ())
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    yield
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    event Auth
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new @1_X_4255: G;
  new @1_X_4146: G;
  let Yp: G = cst_G in
  new @2_r2_90: G;
  new r_254: hash1;
  out(cp[!_55], (U, @1_X_4255, S, @2_r2_90, r_254))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@1_X_4030[@i_118], @2_kd[@i_118], @2_m[@i_118], @2_r4_84[@i_118]) && otheruses(@1_X_4030[@i_118]) && ((@2_x = @1_X_4030[@i_118]) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(@1_X_4146[@i_111], Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = @1_X_4146[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@2_m[@i_108], @2_kd[@i_108], @1_X_4030[@i_108], @2_r4_84[@i_108]) && otheruses(@1_X_4030[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], @1_X_4030[@i_108])
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@1_X_4146[@i_101], Yp[@i_101], @2_r2_90[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], @1_X_4146[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_r2_93[@i_100], Y[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @1_X_4030: G;
    let @2_r4_84: G = cst_G in
    out(@2_c4[!_57], @1_X_4030)
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  find [unique] @i_763 <= qH0 suchthat defined(x1_69[@i_763], x2_68[@i_763], x3_67[@i_763], x4_66[@i_763], x5_65[@i_763], r_673[@i_763]) && otheruses(r_673[@i_763]) && ((x1_69 = x1_69[@i_763]) && ((x2_68 = x2_68[@i_763]) && ((x3_67 = x3_67[@i_763]) && ((x4_66 = x4_66[@i_763]) && (x5_65 = x5_65[@i_763]))))) then
  (
    out(c20[!_58], r_673[@i_763])
  )
  else
  (
    new r_673: hash0;
    out(c20[!_58], r_673)
  )
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; () -> @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; () -> @1_X
 yields

Game 41 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  else
  (
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ())
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new @1_X_4304: G;
  let Y: G = @1_X_4304 in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    yield
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (Y = x4_61[nj])))) then
    event Auth
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new @1_X_4255: G;
  new @1_X_4146: G;
  let Yp: G = cst_G in
  new @2_r2_90: G;
  new r_254: hash1;
  out(cp[!_55], (U, @1_X_4255, S, @2_r2_90, r_254))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@1_X_4030[@i_118], @2_kd[@i_118], @2_m[@i_118], @2_r4_84[@i_118]) && otheruses(@1_X_4030[@i_118]) && ((@2_x = @1_X_4030[@i_118]) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(@1_X_4146[@i_111], Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = @1_X_4146[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = Y[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@2_m[@i_108], @2_kd[@i_108], @1_X_4030[@i_108], @2_r4_84[@i_108]) && otheruses(@1_X_4030[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], @1_X_4030[@i_108])
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@1_X_4146[@i_101], Yp[@i_101], @2_r2_90[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], @1_X_4146[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@2_r2_93[@i_100], Y[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], Y[@i_100])
  )
  else
  (
    new @1_X_4030: G;
    let @2_r4_84: G = cst_G in
    out(@2_c4[!_57], @1_X_4030)
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  find [unique] @i_763 <= qH0 suchthat defined(x1_69[@i_763], x2_68[@i_763], x3_67[@i_763], x4_66[@i_763], x5_65[@i_763], r_673[@i_763]) && otheruses(r_673[@i_763]) && ((x1_69 = x1_69[@i_763]) && ((x2_68 = x2_68[@i_763]) && ((x3_67 = x3_67[@i_763]) && ((x4_66 = x4_66[@i_763]) && (x5_65 = x5_65[@i_763]))))) then
  (
    out(c20[!_58], r_673[@i_763])
  )
  else
  (
    new r_673: hash0;
    out(c20[!_58], r_673)
  )
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying remove assignments of useless yields

Game 42 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  else
  (
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ())
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new @1_X_4304: G;
  let Y: G = cst_G in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    yield
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (@1_X_4304 = x4_61[nj])))) then
    event Auth
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new @1_X_4255: G;
  new @1_X_4146: G;
  let Yp: G = cst_G in
  new @2_r2_90: G;
  new r_254: hash1;
  out(cp[!_55], (U, @1_X_4255, S, @2_r2_90, r_254))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@1_X_4030[@i_118], @2_kd[@i_118], @2_m[@i_118], @2_r4_84[@i_118]) && otheruses(@1_X_4030[@i_118]) && ((@2_x = @1_X_4030[@i_118]) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(@1_X_4146[@i_111], Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = @1_X_4146[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(@1_X_4304[@i_110], Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = @1_X_4304[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@2_m[@i_108], @2_kd[@i_108], @1_X_4030[@i_108], @2_r4_84[@i_108]) && otheruses(@1_X_4030[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], @1_X_4030[@i_108])
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@1_X_4146[@i_101], Yp[@i_101], @2_r2_90[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], @1_X_4146[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@1_X_4304[@i_100], Y[@i_100], @2_r2_93[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], @1_X_4304[@i_100])
  )
  else
  (
    new @1_X_4030: G;
    let @2_r4_84: G = cst_G in
    out(@2_c4[!_57], @1_X_4030)
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  find [unique] @i_763 <= qH0 suchthat defined(x1_69[@i_763], x2_68[@i_763], x3_67[@i_763], x4_66[@i_763], x5_65[@i_763], r_673[@i_763]) && otheruses(r_673[@i_763]) && ((x1_69 = x1_69[@i_763]) && ((x2_68 = x2_68[@i_763]) && ((x3_67 = x3_67[@i_763]) && ((x4_66 = x4_66[@i_763]) && (x5_65 = x5_65[@i_763]))))) then
  (
    out(c20[!_58], r_673[@i_763])
  )
  else
  (
    new r_673: hash0;
    out(c20[!_58], r_673)
  )
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; () -> @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; () -> @1_X
 yields

Game 43 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new @1_X_4353: G;
  let X: G = @1_X_4353 in
  out(c2[!_53], (U, X));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  else
  (
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ())
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new @1_X_4304: G;
  let Y: G = cst_G in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    yield
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (@1_X_4304 = x4_61[nj])))) then
    event Auth
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new @1_X_4255: G;
  new @1_X_4146: G;
  let Yp: G = cst_G in
  new @2_r2_90: G;
  new r_254: hash1;
  out(cp[!_55], (U, @1_X_4255, S, @2_r2_90, r_254))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@1_X_4030[@i_118], @2_kd[@i_118], @2_m[@i_118], @2_r4_84[@i_118]) && otheruses(@1_X_4030[@i_118]) && ((@2_x = @1_X_4030[@i_118]) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(@1_X_4146[@i_111], Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = @1_X_4146[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(@1_X_4304[@i_110], Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = @1_X_4304[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@2_m[@i_108], @2_kd[@i_108], @1_X_4030[@i_108], @2_r4_84[@i_108]) && otheruses(@1_X_4030[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], @1_X_4030[@i_108])
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@1_X_4146[@i_101], Yp[@i_101], @2_r2_90[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], @1_X_4146[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@1_X_4304[@i_100], Y[@i_100], @2_r2_93[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], @1_X_4304[@i_100])
  )
  else
  (
    new @1_X_4030: G;
    let @2_r4_84: G = cst_G in
    out(@2_c4[!_57], @1_X_4030)
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  find [unique] @i_763 <= qH0 suchthat defined(x1_69[@i_763], x2_68[@i_763], x3_67[@i_763], x4_66[@i_763], x5_65[@i_763], r_673[@i_763]) && otheruses(r_673[@i_763]) && ((x1_69 = x1_69[@i_763]) && ((x2_68 = x2_68[@i_763]) && ((x3_67 = x3_67[@i_763]) && ((x4_66 = x4_66[@i_763]) && (x5_65 = x5_65[@i_763]))))) then
  (
    out(c20[!_58], r_673[@i_763])
  )
  else
  (
    new r_673: hash0;
    out(c20[!_58], r_673)
  )
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)


Applying remove assignments of useless yields

Game 44 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new @1_X_4353: G;
  let X: G = cst_G in
  out(c2[!_53], (U, @1_X_4353));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  else
  (
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ())
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new @1_X_4304: G;
  let Y: G = cst_G in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(@1_X_4353[j], X[j]) && (@1_X_4353[j] = X_s) then
  (
    yield
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (@1_X_4304 = x4_61[nj])))) then
    event Auth
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new @1_X_4255: G;
  new @1_X_4146: G;
  let Yp: G = cst_G in
  new @2_r2_90: G;
  new r_254: hash1;
  out(cp[!_55], (U, @1_X_4255, S, @2_r2_90, r_254))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@1_X_4030[@i_118], @2_kd[@i_118], @2_m[@i_118], @2_r4_84[@i_118]) && otheruses(@1_X_4030[@i_118]) && ((@2_x = @1_X_4030[@i_118]) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(@1_X_4146[@i_111], Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = @1_X_4146[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(@1_X_4304[@i_110], Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = @1_X_4304[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@2_m[@i_108], @2_kd[@i_108], @1_X_4030[@i_108], @2_r4_84[@i_108]) && otheruses(@1_X_4030[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], @1_X_4030[@i_108])
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@1_X_4146[@i_101], Yp[@i_101], @2_r2_90[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], @1_X_4146[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@1_X_4304[@i_100], Y[@i_100], @2_r2_93[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], @1_X_4304[@i_100])
  )
  else
  (
    new @1_X_4030: G;
    let @2_r4_84: G = cst_G in
    out(@2_c4[!_57], @1_X_4030)
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  find [unique] @i_763 <= qH0 suchthat defined(x1_69[@i_763], x2_68[@i_763], x3_67[@i_763], x4_66[@i_763], x5_65[@i_763], r_673[@i_763]) && otheruses(r_673[@i_763]) && ((x1_69 = x1_69[@i_763]) && ((x2_68 = x2_68[@i_763]) && ((x3_67 = x3_67[@i_763]) && ((x4_66 = x4_66[@i_763]) && (x5_65 = x5_65[@i_763]))))) then
  (
    out(c20[!_58], r_673[@i_763])
  )
  else
  (
    new r_673: hash0;
    out(c20[!_58], r_673)
  )
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)

RESULT time(context for game 28) = NU * time(= host, maxlength(game 28: x2_63[!_59]), maxlength(game 28: x2_300[!_53])) * qH1 + NU * time(= host, maxlength(game 28: x1_64[!_59]), maxlength(game 28: x1_301[!_53])) * qH1 + NU * time(= host, maxlength(game 28: x2_63[!_59]), maxlength(game 28: x2_294[!_53])) * qH1 + NU * time(= host, maxlength(game 28: x1_64[!_59]), maxlength(game 28: x1_295[!_53])) * qH1 + NU * time(= host, maxlength(game 28: x2_63[!_59]), maxlength(game 28: x2_288[!_53])) * qH1 + NU * time(= host, maxlength(game 28: x1_64[!_59]), maxlength(game 28: x1_289[!_53])) * qH1 + NU * time(= host, maxlength(game 28: x2_63[!_59]), maxlength(game 28: x2_282[!_53])) * qH1 + NU * time(= host, maxlength(game 28: x1_64[!_59]), maxlength(game 28: x1_283[!_53])) * qH1 + 12. * NU * time(= G) * qH1 + NU * time(= host, maxlength(game 28: x2_63[!_59]), maxlength(game 28: x2_276[!_53])) * qH1 + NU * time(= host, maxlength(game 28: x1_64[!_59]), maxlength(game 28: x1_277[!_53])) * qH1 + 2. * NP * time(= G) * qH1 + NP * time(= host, maxlength(game 28: x2_63[!_59]), maxlength(game 28: x2_258[!_55])) * qH1 + NP * time(= host, maxlength(game 28: x1_64[!_59]), maxlength(game 28: x1_259[!_55])) * qH1 + 3. * qH1 * qH1 * time(= G) + qH1 * qH1 * time(= host, maxlength(game 28: x2_63[!_59]), maxlength(game 28: x2_63[!_59])) + qH1 * qH1 * time(= host, maxlength(game 28: x1_64[!_59]), maxlength(game 28: x1_64[!_59])) + NU * time(= host, maxlength(game 28: x2_68[!_58]), maxlength(game 28: x2_749[!_53])) * qH0 + NU * time(= host, maxlength(game 28: x1_69[!_58]), maxlength(game 28: x1_750[!_53])) * qH0 + NU * time(= host, maxlength(game 28: x2_68[!_58]), maxlength(game 28: x2_743[!_53])) * qH0 + NU * time(= host, maxlength(game 28: x1_69[!_58]), maxlength(game 28: x1_744[!_53])) * qH0 + NU * time(= host, maxlength(game 28: x2_68[!_58]), maxlength(game 28: x2_737[!_53])) * qH0 + NU * time(= host, maxlength(game 28: x1_69[!_58]), maxlength(game 28: x1_738[!_53])) * qH0 + NU * time(= host, maxlength(game 28: x2_68[!_58]), maxlength(game 28: x2_731[!_53])) * qH0 + NU * time(= host, maxlength(game 28: x1_69[!_58]), maxlength(game 28: x1_732[!_53])) * qH0 + NU * time(= host, maxlength(game 28: x2_68[!_58]), maxlength(game 28: x2_725[!_53])) * qH0 + NU * time(= host, maxlength(game 28: x1_69[!_58]), maxlength(game 28: x1_726[!_53])) * qH0 + NU * time(= host, maxlength(game 28: x2_68[!_58]), maxlength(game 28: x2_719[!_53])) * qH0 + NU * time(= host, maxlength(game 28: x1_69[!_58]), maxlength(game 28: x1_720[!_53])) * qH0 + NU * time(= host, maxlength(game 28: x2_68[!_58]), maxlength(game 28: x2_713[!_53])) * qH0 + NU * time(= host, maxlength(game 28: x1_69[!_58]), maxlength(game 28: x1_714[!_53])) * qH0 + NU * time(= host, maxlength(game 28: x2_68[!_58]), maxlength(game 28: x2_707[!_53])) * qH0 + NU * time(= host, maxlength(game 28: x1_69[!_58]), maxlength(game 28: x1_708[!_53])) * qH0 + 20. * NU * time(= G) * qH0 + NU * time(= host, maxlength(game 28: x2_68[!_58]), maxlength(game 28: x2_701[!_53])) * qH0 + NU * time(= host, maxlength(game 28: x1_69[!_58]), maxlength(game 28: x1_702[!_53])) * qH0 + NS * time(= host, maxlength(game 28: x2_68[!_58]), maxlength(game 28: x2_695[!_54])) * qH0 + NS * time(= host, maxlength(game 28: x1_69[!_58]), maxlength(game 28: x1_696[!_54])) * qH0 + 6. * NS * time(= G) * qH0 + NS * time(= host, maxlength(game 28: x2_68[!_58]), maxlength(game 28: x2_689[!_54])) * qH0 + NS * time(= host, maxlength(game 28: x1_69[!_58]), maxlength(game 28: x1_690[!_54])) * qH0 + 2. * NP * time(= G) * qH0 + NP * time(= host, maxlength(game 28: x2_68[!_58]), maxlength(game 28: x2_683[!_55])) * qH0 + NP * time(= host, maxlength(game 28: x1_69[!_58]), maxlength(game 28: x1_684[!_55])) * qH0 + 3. * qH0 * qH0 * time(= G) + qH0 * qH0 * time(= host, maxlength(game 28: x2_68[!_58]), maxlength(game 28: x2_68[!_58])) + qH0 * qH0 * time(= host, maxlength(game 28: x1_69[!_58]), maxlength(game 28: x1_69[!_58])) + NS * time(= passwd) * qD + NS * time(= G) * qD + NP * time(= passwd) * qD + NP * time(= G) * qD + 2. * qE * time(= passwd) * qD + 2. * qE * time(= G) * qD + 2. * NU * time(= passwd) * qD + 2. * NU * time(= G) * qD + qD * qD * time(= passwd) + qD * qD * time(= G) + NS * time(= passwd) * qE + NS * time(= G) * qE + NP * time(= passwd) * qE + NP * time(= G) * qE + qE * qE * time(= passwd) + qE * qE * time(= G) + 2. * NU * time(= passwd) * qE + 2. * NU * time(= G) * qE + 3. * time(U) * NP + 3. * time(S) * NP + time(= host, length(U)) * NS + qH0 * time(= host, maxlength(game 28: x2_689[!_54]), maxlength(game 28: x2_68[!_58])) * NS + qH0 * time(= host, maxlength(game 28: x1_690[!_54]), maxlength(game 28: x1_69[!_58])) * NS + time(= hash1) * NS + 3. * time(U) * NS + 3. * time(S) * NS + time(true) * NS + qH0 * time(= host, maxlength(game 28: x2_695[!_54]), maxlength(game 28: x2_68[!_58])) * NS + qH0 * time(= host, maxlength(game 28: x1_696[!_54]), maxlength(game 28: x1_69[!_58])) * NS + 6. * time(= [1,NS]) * NS + qH1 * time(= host, maxlength(game 28: x2_270[!_54]), maxlength(game 28: x2_63[!_59])) * NS + qH1 * time(= host, maxlength(game 28: x1_271[!_54]), maxlength(game 28: x1_64[!_59])) * NS + 2. * qH1 * time(= G) * NS + qH1 * time(= host, length(S), maxlength(game 28: x2_63[!_59])) * NS + qH1 * time(S) * NS + qH1 * time(= host, length(U), maxlength(game 28: x1_64[!_59])) * NS + qH1 * time(U) * NS + 2. * NU * time(= G) * NS + time(= host, length(S)) * NU + qH0 * time(= host, maxlength(game 28: x2_713[!_53]), maxlength(game 28: x2_68[!_58])) * NU + qH0 * time(= host, maxlength(game 28: x1_714[!_53]), maxlength(game 28: x1_69[!_58])) * NU + qH0 * time(= host, maxlength(game 28: x2_707[!_53]), maxlength(game 28: x2_68[!_58])) * NU + qH0 * time(= host, maxlength(game 28: x1_708[!_53]), maxlength(game 28: x1_69[!_58])) * NU + qH1 * time(= host, maxlength(game 28: x2_282[!_53]), maxlength(game 28: x2_63[!_59])) * NU + qH1 * time(= host, maxlength(game 28: x1_283[!_53]), maxlength(game 28: x1_64[!_59])) * NU + qH0 * time(= host, maxlength(game 28: x2_725[!_53]), maxlength(game 28: x2_68[!_58])) * NU + qH0 * time(= host, maxlength(game 28: x1_726[!_53]), maxlength(game 28: x1_69[!_58])) * NU + qH0 * time(= host, maxlength(game 28: x2_719[!_53]), maxlength(game 28: x2_68[!_58])) * NU + qH0 * time(= host, maxlength(game 28: x1_720[!_53]), maxlength(game 28: x1_69[!_58])) * NU + qH1 * time(= host, maxlength(game 28: x2_288[!_53]), maxlength(game 28: x2_63[!_59])) * NU + qH1 * time(= host, maxlength(game 28: x1_289[!_53]), maxlength(game 28: x1_64[!_59])) * NU + qH0 * time(= host, maxlength(game 28: x2_737[!_53]), maxlength(game 28: x2_68[!_58])) * NU + qH0 * time(= host, maxlength(game 28: x1_738[!_53]), maxlength(game 28: x1_69[!_58])) * NU + qH0 * time(= host, maxlength(game 28: x2_731[!_53]), maxlength(game 28: x2_68[!_58])) * NU + qH0 * time(= host, maxlength(game 28: x1_732[!_53]), maxlength(game 28: x1_69[!_58])) * NU + qH1 * time(= host, maxlength(game 28: x2_294[!_53]), maxlength(game 28: x2_63[!_59])) * NU + qH1 * time(= host, maxlength(game 28: x1_295[!_53]), maxlength(game 28: x1_64[!_59])) * NU + qH0 * time(= host, maxlength(game 28: x2_749[!_53]), maxlength(game 28: x2_68[!_58])) * NU + qH0 * time(= host, maxlength(game 28: x1_750[!_53]), maxlength(game 28: x1_69[!_58])) * NU + 4. * time(= [1,NU]) * NU + qH0 * time(= host, maxlength(game 28: x2_743[!_53]), maxlength(game 28: x2_68[!_58])) * NU + qH0 * time(= host, maxlength(game 28: x1_744[!_53]), maxlength(game 28: x1_69[!_58])) * NU + qH1 * time(= host, maxlength(game 28: x2_300[!_53]), maxlength(game 28: x2_63[!_59])) * NU + qH1 * time(= host, maxlength(game 28: x1_301[!_53]), maxlength(game 28: x1_64[!_59])) * NU + 3. * time(U) * NU + 3. * time(S) * NU + qH0 * time(= host, maxlength(game 28: x2_701[!_53]), maxlength(game 28: x2_68[!_58])) * NU + qH0 * time(= host, maxlength(game 28: x1_702[!_53]), maxlength(game 28: x1_69[!_58])) * NU + NP * time(= G) * NU + NU * NU * time(= G)
RESULT Could not prove event Encrypt ==> false in game 8, event Auth ==> false in game 4.
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_53 <= NU
  in(c1[!_53], ());
  new @1_X_4353: G;
  let X: G = cst_G in
  out(c2[!_53], (U, @1_X_4353));
  in(c5[!_53], (=S, Ystar_u: G));
  find [unique] @i_142 <= qE suchthat defined(@2_r2_87[@i_142], @2_ke[@i_142]) && otheruses(@2_r2_87[@i_142]) && ((Ystar_u = @2_r2_87[@i_142]) && (pw = @2_ke[@i_142])) then
  (
    event Encrypt
  )
  else
  (
    new r_272: hash1;
    out(c6[!_53], r_272);
    in(c9[!_53], ())
  )
) | (
  ! !_54 <= NS
  in(c3[!_54], (=U, X_s: G));
  new @1_X_4304: G;
  let Y: G = cst_G in
  new @2_r2_93: G;
  out(c4[!_54], (S, @2_r2_93));
  in(c7[!_54], auth_s: hash1);
  find j <= NU suchthat defined(@1_X_4353[j], X[j]) && (@1_X_4353[j] = X_s) then
  (
    yield
  )
  else
  (
    find nj <= qH1 suchthat defined(x1_64[nj], x2_63[nj], x3_62[nj], x4_61[nj]) && ((U = x1_64[nj]) && ((S = x2_63[nj]) && ((X_s = x3_62[nj]) && (@1_X_4304 = x4_61[nj])))) then
    event Auth
  )
) | (
  ! !_55 <= NP
  in(cp[!_55], ());
  new @1_X_4255: G;
  new @1_X_4146: G;
  let Yp: G = cst_G in
  new @2_r2_90: G;
  new r_254: hash1;
  out(cp[!_55], (U, @1_X_4255, S, @2_r2_90, r_254))
) | (
  ! !_56 <= qE
  in(@2_c1[!_56], (@2_x: G, @2_ke: passwd));
  find [unique] @i_118 <= qD suchthat defined(@1_X_4030[@i_118], @2_kd[@i_118], @2_m[@i_118], @2_r4_84[@i_118]) && otheruses(@1_X_4030[@i_118]) && ((@2_x = @1_X_4030[@i_118]) && (@2_ke = @2_kd[@i_118])) then
  (
    out(@2_c2[!_56], @2_m[@i_118])
  )
  orfind @i_112 <= qE suchthat defined(@2_x[@i_112], @2_ke[@i_112], @2_r2_87[@i_112]) && otheruses(@2_r2_87[@i_112]) && ((@2_x = @2_x[@i_112]) && (@2_ke = @2_ke[@i_112])) then
  (
    out(@2_c2[!_56], @2_r2_87[@i_112])
  )
  orfind @i_111 <= NP suchthat defined(@1_X_4146[@i_111], Yp[@i_111], @2_r2_90[@i_111]) && otheruses(@2_r2_90[@i_111]) && ((@2_x = @1_X_4146[@i_111]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_90[@i_111])
  )
  orfind @i_110 <= NS suchthat defined(@1_X_4304[@i_110], Y[@i_110], @2_r2_93[@i_110]) && otheruses(@2_r2_93[@i_110]) && ((@2_x = @1_X_4304[@i_110]) && (@2_ke = pw)) then
  (
    out(@2_c2[!_56], @2_r2_93[@i_110])
  )
  else
  (
    new @2_r2_87: G;
    out(@2_c2[!_56], @2_r2_87)
  )
) | (
  ! !_57 <= qD
  in(@2_c3[!_57], (@2_m: G, @2_kd: passwd));
  find [unique] @i_108 <= qD suchthat defined(@2_m[@i_108], @2_kd[@i_108], @1_X_4030[@i_108], @2_r4_84[@i_108]) && otheruses(@1_X_4030[@i_108]) && ((@2_m = @2_m[@i_108]) && (@2_kd = @2_kd[@i_108])) then
  (
    out(@2_c4[!_57], @1_X_4030[@i_108])
  )
  orfind @i_102 <= qE suchthat defined(@2_r2_87[@i_102], @2_ke[@i_102], @2_x[@i_102]) && otheruses(@2_r2_87[@i_102]) && ((@2_m = @2_r2_87[@i_102]) && (@2_kd = @2_ke[@i_102])) then
  (
    out(@2_c4[!_57], @2_x[@i_102])
  )
  orfind @i_101 <= NP suchthat defined(@1_X_4146[@i_101], Yp[@i_101], @2_r2_90[@i_101]) && otheruses(@2_r2_90[@i_101]) && ((@2_m = @2_r2_90[@i_101]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], @1_X_4146[@i_101])
  )
  orfind @i_100 <= NS suchthat defined(@1_X_4304[@i_100], Y[@i_100], @2_r2_93[@i_100]) && otheruses(@2_r2_93[@i_100]) && ((@2_m = @2_r2_93[@i_100]) && (@2_kd = pw)) then
  (
    out(@2_c4[!_57], @1_X_4304[@i_100])
  )
  else
  (
    new @1_X_4030: G;
    let @2_r4_84: G = cst_G in
    out(@2_c4[!_57], @1_X_4030)
  )
) | (
  ! !_58 <= qH0
  in(c10[!_58], (x1_69: host, x2_68: host, x3_67: G, x4_66: G, x5_65: G));
  find [unique] @i_763 <= qH0 suchthat defined(x1_69[@i_763], x2_68[@i_763], x3_67[@i_763], x4_66[@i_763], x5_65[@i_763], r_673[@i_763]) && otheruses(r_673[@i_763]) && ((x1_69 = x1_69[@i_763]) && ((x2_68 = x2_68[@i_763]) && ((x3_67 = x3_67[@i_763]) && ((x4_66 = x4_66[@i_763]) && (x5_65 = x5_65[@i_763]))))) then
  (
    out(c20[!_58], r_673[@i_763])
  )
  else
  (
    new r_673: hash0;
    out(c20[!_58], r_673)
  )
) | (
  ! !_59 <= qH1
  in(c11[!_59], (x1_64: host, x2_63: host, x3_62: G, x4_61: G, x5_60: G));
  find [unique] @i_310 <= qH1 suchthat defined(x1_64[@i_310], x2_63[@i_310], x3_62[@i_310], x4_61[@i_310], x5_60[@i_310], r_248[@i_310]) && otheruses(r_248[@i_310]) && ((x1_64 = x1_64[@i_310]) && ((x2_63 = x2_63[@i_310]) && ((x3_62 = x3_62[@i_310]) && ((x4_61 = x4_61[@i_310]) && (x5_60 = x5_60[@i_310]))))) then
  (
    out(c21[!_59], r_248[@i_310])
  )
  else
  (
    new r_248: hash1;
    out(c21[!_59], r_248)
  )
)

