Doing expand if, let, find
Doing simplify
Run simplify 2 time(s). Fixpoint reached.
Doing move new all binders
Doing remove assignments of useless
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)

Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)

Doing remove assignments of binder mSK_24
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK
Doing remove assignments of binder mAK_26
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK
Doing remove assignments of binder mKs
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmKs
Doing remove assignments of binder Pmkey
Doing SA rename Pmkey
Doing remove assignments of binder Pmkey
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmKs
Doing remove assignments of binder Pmkey_67
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmKs
Doing simplify
Run simplify 2 time(s). Fixpoint reached.
Doing move new all binders
Doing remove assignments of useless
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)

Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)

Doing remove assignments of binder mSK_24
Doing SA rename mSK_24
Doing remove assignments of binder mSK_24
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_73
Doing remove assignments of binder mSK_24
Doing SA rename mSK_24
Doing remove assignments of binder mSK_24
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_69
Doing remove assignments of binder mAK_26
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK
Doing remove assignments of binder mKt
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmKt
Doing remove assignments of binder Qmkey
Doing SA rename Qmkey
Doing remove assignments of binder Qmkey
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmKt
Doing remove assignments of binder Qmkey_132
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmKt
Doing simplify
Run simplify 2 time(s). Fixpoint reached.
Doing move new all binders
Doing remove assignments of useless
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)

Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)

Doing remove assignments of binder mSK_24
Doing SA rename mSK_24
Doing remove assignments of binder mSK_24
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_73
Doing remove assignments of binder mSK_24
Doing SA rename mSK_24
Doing remove assignments of binder mSK_24
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_69
Doing remove assignments of binder mAK_26
Doing SA rename mAK_26
Doing remove assignments of binder mAK_26
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK_138
Doing remove assignments of binder mAK_26
Doing SA rename mAK_26
Doing remove assignments of binder mAK_26
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK_134
Doing remove assignments of binder mKc
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmKc
Doing remove assignments of binder Rmkey
Doing SA rename Rmkey
Doing remove assignments of binder Rmkey
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmKc
Doing remove assignments of binder Rmkey_201
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmKc
Doing simplify
Run simplify 2 time(s). Fixpoint reached.
Doing move new all binders
Doing remove assignments of useless
Eliminated collisions between Nc and Nc Probability: 0.5 * N * N / |nonce|
Proved query event inj:fullCK(T, N, x, y) ==> inj:fullKC(C, T, N, z, y) Probability: 0.5 * N * N / |nonce|
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)

Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)

Doing remove assignments of binder mSK_24
Doing SA rename mSK_24
Doing remove assignments of binder mSK_24
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_73
Doing remove assignments of binder mSK_24
Doing SA rename mSK_24
Doing remove assignments of binder mSK_24
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_69
Doing remove assignments of binder mAK_26
Doing SA rename mAK_26
Doing remove assignments of binder mAK_26
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK_215
Doing remove assignments of binder mAK_26
Doing SA rename mAK_26
Doing remove assignments of binder mAK_26
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK_211
Doing remove assignments of binder mAK_26
Doing SA rename mAK_26
Doing remove assignments of binder mAK_26
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK_207
Doing remove assignments of binder mAK_26
Doing SA rename mAK_26
Doing remove assignments of binder mAK_26
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK_203
Doing remove assignments of binder SK_23
Doing SA rename SK_23
Doing remove assignments of binder SK_23
Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r16
Doing remove assignments of binder SK_375
Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r16
Doing remove assignments of binder AK_25
Doing SA rename AK_25
Doing remove assignments of binder AK_25
Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r11_75
Doing remove assignments of binder Pkey
Doing SA rename Pkey
Doing remove assignments of binder Pkey
Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r10_74
Doing remove assignments of binder Ks
Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r10_74
Doing simplify
Run simplify 2 time(s). Fixpoint reached.
Doing move new all binders
Doing remove assignments of useless
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)

Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)

Doing remove assignments of binder mSK_24
Doing SA rename mSK_24
Doing remove assignments of binder mSK_24
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_73
Doing remove assignments of binder mSK_24
Doing SA rename mSK_24
Doing remove assignments of binder mSK_24
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_69
Doing remove assignments of binder mAK_26
Doing SA rename mAK_26
Doing remove assignments of binder mAK_26
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK_215
Doing remove assignments of binder mAK_26
Doing SA rename mAK_26
Doing remove assignments of binder mAK_26
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK_211
Doing remove assignments of binder mAK_26
Doing SA rename mAK_26
Doing remove assignments of binder mAK_26
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK_207
Doing remove assignments of binder mAK_26
Doing SA rename mAK_26
Doing remove assignments of binder mAK_26
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK_203
Doing remove assignments of binder SK_23
Doing SA rename SK_23
Doing remove assignments of binder SK_23
Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r16
Doing remove assignments of binder SK_553
Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r16
Doing remove assignments of binder AK_25
Doing SA rename AK_25
Doing remove assignments of binder AK_25
Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r11_75
Doing remove assignments of binder SK_23
Doing SA rename SK_23
Doing remove assignments of binder SK_23
Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with rSK_72
Doing remove assignments of binder AK_25
Doing SA rename AK_25
Doing remove assignments of binder AK_25
Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r11_71
Doing remove assignments of binder Mkey
Doing remove assignments of binder SK_23
Doing SA rename SK_23
Doing remove assignments of binder SK_23
Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with rSK_68
Doing remove assignments of binder Rkey
Doing SA rename Rkey
Doing remove assignments of binder Rkey
Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r4_217
Doing remove assignments of binder Kc
Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r4_217
Doing simplify
Run simplify 2 time(s). Fixpoint reached.
Doing move new all binders
Doing remove assignments of useless
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)

Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)

Doing remove assignments of binder mSK_24
Doing SA rename mSK_24
Doing remove assignments of binder mSK_24
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_73
Doing remove assignments of binder mSK_24
Doing SA rename mSK_24
Doing remove assignments of binder mSK_24
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_69
Doing remove assignments of binder mAK_26
Doing SA rename mAK_26
Doing remove assignments of binder mAK_26
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK_215
Doing remove assignments of binder mAK_26
Doing SA rename mAK_26
Doing remove assignments of binder mAK_26
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK_211
Doing remove assignments of binder mAK_26
Doing SA rename mAK_26
Doing remove assignments of binder mAK_26
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK_207
Doing remove assignments of binder mAK_26
Doing SA rename mAK_26
Doing remove assignments of binder mAK_26
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK_203
Doing remove assignments of binder SK_23
Doing SA rename SK_23
Doing remove assignments of binder SK_23
Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r16
Doing remove assignments of binder SK_756
Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r16
Doing remove assignments of binder AK_25
Doing SA rename AK_25
Doing remove assignments of binder AK_25
Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r11_75
Doing remove assignments of binder SK_23
Doing SA rename SK_23
Doing remove assignments of binder SK_23
Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with rSK_72
Doing remove assignments of binder AK_25
Doing SA rename AK_25
Doing remove assignments of binder AK_25
Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r11_71
Doing remove assignments of binder Mkey
Doing remove assignments of binder SK_23
Doing SA rename SK_23
Doing remove assignments of binder SK_23
Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with rSK_68
Doing remove assignments of binder Qkey
Doing SA rename Qkey
Doing remove assignments of binder Qkey
Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r3_216
Doing remove assignments of binder Kt
Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r3_216
Doing simplify
Run simplify 2 time(s). Fixpoint reached.
Doing move new all binders
Doing remove assignments of useless
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)

Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)

Doing remove assignments of binder mSK_24
Doing SA rename mSK_24
Doing remove assignments of binder mSK_24
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_73
Doing remove assignments of binder mSK_24
Doing SA rename mSK_24
Doing remove assignments of binder mSK_24
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_69
Doing remove assignments of binder mAK_26
Doing SA rename mAK_26
Doing remove assignments of binder mAK_26
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK_215
Doing remove assignments of binder mAK_881
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK_215
Doing simplify
Run simplify 2 time(s). Maximum reached.
Eliminated collisions between Nc and Nc Probability: 0.5 * N * N / |nonce|
Eliminated collisions between concat3(?, ?, Nt_248[!_11], ?) and pad(C, ts_246[!_11]) Probability: N / |nonce|
(concat3(?, ?, Nt_248[!_11], ?) characterizes a part of Nt_248[!_11] of type(s) nonce;
 pad(C, ts_246[!_11]) does not depend on Nt_248[!_11])
Doing move new all binders
Doing remove assignments of useless
Proved query event partTC(C, x, y) ==> (partCT(T, x', y)&&fullKC(C, T, N, x, y'))
Proved query event fullCT(T, S, N, x, z, y) ==> (fullTC(C, S, N, x', z, y)&&fullKC(C, T, N', x', w))
Eliminated collisions between Nt_248 and Nt_248 Probability: 0.5 * N * N / |nonce|
Proved query event inj:fullCT(T, S, N, x, z, y) ==> inj:fullTC(C, S, N, x', z, y) Probability: 0.5 * N * N / |nonce|
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)

Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)

Doing remove assignments of binder mSK_24
Doing SA rename mSK_24
Doing remove assignments of binder mSK_24
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_895
Doing remove assignments of binder mSK_24
Doing SA rename mSK_24
Doing remove assignments of binder mSK_24
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_891
Doing remove assignments of binder mSK_24
Doing SA rename mSK_24
Doing remove assignments of binder mSK_24
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_887
Doing remove assignments of binder mSK_24
Doing SA rename mSK_24
Doing remove assignments of binder mSK_24
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_883
Doing remove assignments of binder SK_23
Doing SA rename SK_23
Doing remove assignments of binder SK_23
Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r16
Doing remove assignments of binder AK_25
Doing SA rename AK_25
Doing remove assignments of binder AK_25
Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r11_897
Doing remove assignments of binder AK_1026
Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r11_897
Doing simplify
Run simplify 2 time(s). Maximum reached.
Doing move new all binders
Doing remove assignments of useless
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)

Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)

Doing remove assignments of binder mSK_24
Doing SA rename mSK_24
Doing remove assignments of binder mSK_24
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_895
Doing remove assignments of binder mSK_1098
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_895
Doing simplify
Run simplify 2 time(s). Maximum reached.
Doing move new all binders
Doing remove assignments of useless
Proved query event fullCS(S, T, z, y, w) ==> fullSC(C, x, y, w)
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)

Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)

Doing remove assignments of binder SK_23
Doing SA rename SK_23
Doing remove assignments of binder SK_23
Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r16_1100
Doing remove assignments of binder SK_1173
Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r16_1100
Doing simplify
Run simplify 2 time(s). Maximum reached.
Doing move new all binders
Doing remove assignments of useless
Doing equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)

Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)

Doing remove assignments of binder SK_1171
Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r16_1099
Doing remove assignments of binder Mkey
Doing remove assignments of binder AK_1024
Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r11_889
Doing remove assignments of binder AK_1024
Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r11_885
Doing remove assignments of binder Mkey
Doing remove assignments of binder Lkey
Doing remove assignments of binder Kkey
Doing remove assignments of binder Kkey
Doing remove assignments of binder Lkey
Doing remove assignments of binder SK_1172
Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r2_952
Doing remove assignments of binder SK_31
Doing remove assignments of binder AK_1025
Doing equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r1_242
Initial state
Game 1 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
let mKt: mkey = mkgen(rmKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
let mKs: mkey = mkgen(rmKs) in
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new Nt: nonce;
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Khost[j1], Rkey[j1], Rmkey[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Lhost[j2], Qkey[j2], Qmkey[j2]) && (Lhost[j2] = ht) then
            new rAK: keyseed;
            let AK_25: key = kgen(rAK) in
            new rmAK: mkeyseed;
            let mAK_26: mkey = mkgen(rmAK) in
            new r3: seed;
            let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3) in
            let mac3: macs = mac(e3, Qmkey[j2]) in
            new r4: seed;
            let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4) in
            let mac4: macs = mac(e4, Rmkey[j1]) in
            event fullKC(hc, ht, n, e3, e4);
            out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          if check(m8, mKt, mac8) then
          let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Mhost1[j3], Mhost2[j3], Pmkey[j3], Pkey[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
          new rSK: keyseed;
          let SK_23: key = kgen(rSK) in
          new rmSK: mkeyseed;
          let mSK_24: mkey = mkgen(rmSK) in
          new r10: seed;
          let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10) in
          let mac10: macs = mac(e10, Pmkey[j3]) in
          new r11: seed;
          let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11) in
          let mac11: macs = mac(e11, mAK_20) in
          event fullTC(h4, h3, n2, m8, m9, e11);
          out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        if check(m14, mKs, mac14) then
        let injbot(concat2(SK_19: key, mSK_18: mkey, h5: client)) = dec(m14, Ks) in
        if check(m15, mSK_18, mac15) then
        let injbot(pad(=h5, ts3: timest)) = dec(m15, SK_19) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_19, r16) in
        let mac16: macs = mac(e16, mSK_18) in
        event partSC(h5, m14, m15);
        event fullSC(h5, m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h5)))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      let Rkey: key = if (Khost = C) then Kc else Kkey in
      let Rmkey: mkey = if (Khost = C) then mKc else Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    let Qkey: key = if (Lhost = T) then Kt else Lkey in
    let Qmkey: mkey = if (Lhost = T) then mKt else Lmkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  let Pkey: key = if ((Mhost1 = T) && (Mhost2 = S)) then Ks else Mkey in
  let Pmkey: mkey = if ((Mhost1 = T) && (Mhost2 = S)) then mKs else Mmkey
)


Applying expand if, let, find yields

Game 2 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
let mKt: mkey = mkgen(rmKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
let mKs: mkey = mkgen(rmKs) in
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new Nt: nonce;
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Khost[j1], Rkey[j1], Rmkey[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Lhost[j2], Qkey[j2], Qmkey[j2]) && (Lhost[j2] = ht) then
            new rAK: keyseed;
            let AK_25: key = kgen(rAK) in
            new rmAK: mkeyseed;
            let mAK_26: mkey = mkgen(rmAK) in
            new r3: seed;
            let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3) in
            let mac3: macs = mac(e3, Qmkey[j2]) in
            new r4: seed;
            let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4) in
            let mac4: macs = mac(e4, Rmkey[j1]) in
            event fullKC(hc, ht, n, e3, e4);
            out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          if check(m8, mKt, mac8) then
          let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Mhost1[j3], Mhost2[j3], Pmkey[j3], Pkey[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
          new rSK: keyseed;
          let SK_23: key = kgen(rSK) in
          new rmSK: mkeyseed;
          let mSK_24: mkey = mkgen(rmSK) in
          new r10: seed;
          let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10) in
          let mac10: macs = mac(e10, Pmkey[j3]) in
          new r11: seed;
          let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11) in
          let mac11: macs = mac(e11, mAK_20) in
          event fullTC(h4, h3, n2, m8, m9, e11);
          out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        if check(m14, mKs, mac14) then
        let injbot(concat2(SK_19: key, mSK_18: mkey, h5: client)) = dec(m14, Ks) in
        if check(m15, mSK_18, mac15) then
        let injbot(pad(=h5, ts3: timest)) = dec(m15, SK_19) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_19, r16) in
        let mac16: macs = mac(e16, mSK_18) in
        event partSC(h5, m14, m15);
        event fullSC(h5, m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h5)))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        if (Khost = C) then
          let Rmkey: mkey = mKc
        else
          let Rmkey: mkey = Kmkey
      else
        let Rkey: key = Kkey in
        if (Khost = C) then
          let Rmkey: mkey = mKc
        else
          let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      if (Lhost = T) then
        let Qmkey: mkey = mKt
      else
        let Qmkey: mkey = Lmkey
    else
      let Qkey: key = Lkey in
      if (Lhost = T) then
        let Qmkey: mkey = mKt
      else
        let Qmkey: mkey = Lmkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    if ((Mhost1 = T) && (Mhost2 = S)) then
      let Pmkey: mkey = mKs
    else
      let Pmkey: mkey = Mmkey
  else
    let Pkey: key = Mkey in
    if ((Mhost1 = T) && (Mhost2 = S)) then
      let Pmkey: mkey = mKs
    else
      let Pmkey: mkey = Mmkey
)


Applying simplify yields

Game 3 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
let mKt: mkey = mkgen(rmKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
let mKs: mkey = mkgen(rmKs) in
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new Nt: nonce;
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Qmkey[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
            new rAK: keyseed;
            let AK_25: key = kgen(rAK) in
            new rmAK: mkeyseed;
            let mAK_26: mkey = mkgen(rmAK) in
            new r3: seed;
            let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3) in
            let mac3: macs = mac(e3, Qmkey[j2]) in
            new r4: seed;
            let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4) in
            let mac4: macs = mac(e4, Rmkey[j1]) in
            event fullKC(hc, ht, n, e3, e4);
            out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          if check(m8, mKt, mac8) then
          let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Pmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
          new rSK: keyseed;
          let SK_23: key = kgen(rSK) in
          new rmSK: mkeyseed;
          let mSK_24: mkey = mkgen(rmSK) in
          new r10: seed;
          let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10) in
          let mac10: macs = mac(e10, Pmkey[j3]) in
          new r11: seed;
          let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11) in
          let mac11: macs = mac(e11, mAK_20) in
          event fullTC(h4, h3, n2, m8, m9, e11);
          out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        if check(m14, mKs, mac14) then
        let injbot(concat2(SK_19: key, mSK_18: mkey, h5: client)) = dec(m14, Ks) in
        if check(m15, mSK_18, mac15) then
        let injbot(pad(=h5, ts3: timest)) = dec(m15, SK_19) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_19, r16) in
        let mac16: macs = mac(e16, mSK_18) in
        event partSC(h5, m14, m15);
        event fullSC(h5, m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h5)))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey: mkey = mKt
    else
      let Qkey: key = Lkey in
      let Qmkey: mkey = Lmkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey: mkey = mKs
  else
    let Pkey: key = Mkey in
    let Pmkey: mkey = Mmkey
)


Applying move new all binders yields

Game 4 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
let mKt: mkey = mkgen(rmKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
let mKs: mkey = mkgen(rmKs) in
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new r1: seed;
            new ts_29: timest;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            new Nt: nonce;
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new r2: seed;
            new ts2: timest;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Qmkey[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
            new rAK: keyseed;
            let AK_25: key = kgen(rAK) in
            new rmAK: mkeyseed;
            let mAK_26: mkey = mkgen(rmAK) in
            new r3: seed;
            let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3) in
            let mac3: macs = mac(e3, Qmkey[j2]) in
            new r4: seed;
            let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4) in
            let mac4: macs = mac(e4, Rmkey[j1]) in
            event fullKC(hc, ht, n, e3, e4);
            out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          if check(m8, mKt, mac8) then
          let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Pmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
          new rSK: keyseed;
          let SK_23: key = kgen(rSK) in
          new rmSK: mkeyseed;
          let mSK_24: mkey = mkgen(rmSK) in
          new r10: seed;
          let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10) in
          let mac10: macs = mac(e10, Pmkey[j3]) in
          new r11: seed;
          let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11) in
          let mac11: macs = mac(e11, mAK_20) in
          event fullTC(h4, h3, n2, m8, m9, e11);
          out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        if check(m14, mKs, mac14) then
        let injbot(concat2(SK_19: key, mSK_18: mkey, h5: client)) = dec(m14, Ks) in
        if check(m15, mSK_18, mac15) then
        let injbot(pad(=h5, ts3: timest)) = dec(m15, SK_19) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_19, r16) in
        let mac16: macs = mac(e16, mSK_18) in
        event partSC(h5, m14, m15);
        event fullSC(h5, m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h5)))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey: mkey = mKt
    else
      let Qkey: key = Lkey in
      let Qmkey: mkey = Lmkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey: mkey = mKs
  else
    let Pkey: key = Mkey in
    let Pmkey: mkey = Mmkey
)


Applying remove assignments of binder mKs yields

Game 5 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
let mKt: mkey = mkgen(rmKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new r1: seed;
            new ts_29: timest;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            new Nt: nonce;
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new r2: seed;
            new ts2: timest;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Qmkey[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
            new rAK: keyseed;
            let AK_25: key = kgen(rAK) in
            new rmAK: mkeyseed;
            let mAK_26: mkey = mkgen(rmAK) in
            new r3: seed;
            let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3) in
            let mac3: macs = mac(e3, Qmkey[j2]) in
            new r4: seed;
            let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4) in
            let mac4: macs = mac(e4, Rmkey[j1]) in
            event fullKC(hc, ht, n, e3, e4);
            out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          if check(m8, mKt, mac8) then
          let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Pmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
          new rSK: keyseed;
          let SK_23: key = kgen(rSK) in
          new rmSK: mkeyseed;
          let mSK_24: mkey = mkgen(rmSK) in
          new r10: seed;
          let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10) in
          let mac10: macs = mac(e10, Pmkey[j3]) in
          new r11: seed;
          let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11) in
          let mac11: macs = mac(e11, mAK_20) in
          event fullTC(h4, h3, n2, m8, m9, e11);
          out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        if check(m14, mkgen(rmKs), mac14) then
        let injbot(concat2(SK_19: key, mSK_18: mkey, h5: client)) = dec(m14, Ks) in
        if check(m15, mSK_18, mac15) then
        let injbot(pad(=h5, ts3: timest)) = dec(m15, SK_19) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_19, r16) in
        let mac16: macs = mac(e16, mSK_18) in
        event partSC(h5, m14, m15);
        event fullSC(h5, m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h5)))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey: mkey = mKt
    else
      let Qkey: key = Lkey in
      let Qmkey: mkey = Lmkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey: mkey = mkgen(rmKs)
  else
    let Pkey: key = Mkey in
    let Pmkey: mkey = Mmkey
)


Applying SA rename Pmkey yields

Game 6 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
let mKt: mkey = mkgen(rmKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new r1: seed;
            new ts_29: timest;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            new Nt: nonce;
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new r2: seed;
            new ts2: timest;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Qmkey[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
            new rAK: keyseed;
            let AK_25: key = kgen(rAK) in
            new rmAK: mkeyseed;
            let mAK_26: mkey = mkgen(rmAK) in
            new r3: seed;
            let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3) in
            let mac3: macs = mac(e3, Qmkey[j2]) in
            new r4: seed;
            let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4) in
            let mac4: macs = mac(e4, Rmkey[j1]) in
            event fullKC(hc, ht, n, e3, e4);
            out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          if check(m8, mKt, mac8) then
          let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Pmkey_66[j3], Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK: keyseed;
            let SK_23: key = kgen(rSK) in
            new rmSK: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK) in
            new r10: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10) in
            let mac10: macs = mac(e10, Pmkey_66[j3]) in
            new r11: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
          orfind j3 <= N2 suchthat defined(Pmkey_67[j3], Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK: keyseed;
            let SK_23: key = kgen(rSK) in
            new rmSK: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK) in
            new r10: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10) in
            let mac10: macs = mac(e10, Pmkey_67[j3]) in
            new r11: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        if check(m14, mkgen(rmKs), mac14) then
        let injbot(concat2(SK_19: key, mSK_18: mkey, h5: client)) = dec(m14, Ks) in
        if check(m15, mSK_18, mac15) then
        let injbot(pad(=h5, ts3: timest)) = dec(m15, SK_19) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_19, r16) in
        let mac16: macs = mac(e16, mSK_18) in
        event partSC(h5, m14, m15);
        event fullSC(h5, m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h5)))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey: mkey = mKt
    else
      let Qkey: key = Lkey in
      let Qmkey: mkey = Lmkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_67: mkey = mkgen(rmKs)
  else
    let Pkey: key = Mkey in
    let Pmkey_66: mkey = Mmkey
)


Applying remove assignments of binder Pmkey yields

Game 7 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
let mKt: mkey = mkgen(rmKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new r1: seed;
            new ts_29: timest;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            new Nt: nonce;
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new r2: seed;
            new ts2: timest;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Qmkey[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
            new rAK: keyseed;
            let AK_25: key = kgen(rAK) in
            new rmAK: mkeyseed;
            let mAK_26: mkey = mkgen(rmAK) in
            new r3: seed;
            let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3) in
            let mac3: macs = mac(e3, Qmkey[j2]) in
            new r4: seed;
            let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4) in
            let mac4: macs = mac(e4, Rmkey[j1]) in
            event fullKC(hc, ht, n, e3, e4);
            out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          if check(m8, mKt, mac8) then
          let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pmkey_66[j3], Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_71) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
          orfind j3 <= N2 suchthat defined(Pmkey_67[j3], Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_74) in
            let mac10: macs = mac(e10, Pmkey_67[j3]) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_75) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        if check(m14, mkgen(rmKs), mac14) then
        let injbot(concat2(SK_19: key, mSK_18: mkey, h5: client)) = dec(m14, Ks) in
        if check(m15, mSK_18, mac15) then
        let injbot(pad(=h5, ts3: timest)) = dec(m15, SK_19) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_19, r16) in
        let mac16: macs = mac(e16, mSK_18) in
        event partSC(h5, m14, m15);
        event fullSC(h5, m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h5)))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey: mkey = mKt
    else
      let Qkey: key = Lkey in
      let Qmkey: mkey = Lmkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_67: mkey = mkgen(rmKs)
  else
    let Pkey: key = Mkey in
    let Pmkey_66: mkey = cst_mkey
)


Applying remove assignments of binder Pmkey_67 yields

Game 8 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
let mKt: mkey = mkgen(rmKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new r1: seed;
            new ts_29: timest;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            new Nt: nonce;
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new r2: seed;
            new ts2: timest;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Qmkey[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
            new rAK: keyseed;
            let AK_25: key = kgen(rAK) in
            new rmAK: mkeyseed;
            let mAK_26: mkey = mkgen(rmAK) in
            new r3: seed;
            let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3) in
            let mac3: macs = mac(e3, Qmkey[j2]) in
            new r4: seed;
            let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4) in
            let mac4: macs = mac(e4, Rmkey[j1]) in
            event fullKC(hc, ht, n, e3, e4);
            out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          if check(m8, mKt, mac8) then
          let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pmkey_66[j3], Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_71) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
          orfind j3 <= N2 suchthat defined(rmKs, Pmkey_67[j3], Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_74) in
            let mac10: macs = mac(e10, mkgen(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_75) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        if check(m14, mkgen(rmKs), mac14) then
        let injbot(concat2(SK_19: key, mSK_18: mkey, h5: client)) = dec(m14, Ks) in
        if check(m15, mSK_18, mac15) then
        let injbot(pad(=h5, ts3: timest)) = dec(m15, SK_19) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_19, r16) in
        let mac16: macs = mac(e16, mSK_18) in
        event partSC(h5, m14, m15);
        event fullSC(h5, m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h5)))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey: mkey = mKt
    else
      let Qkey: key = Lkey in
      let Qmkey: mkey = Lmkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_67: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_66: mkey = cst_mkey
)


Applying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmKs [Difference of probability Pmac(time + time(context for game 8), N, N)] yields

Game 9 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
let mKt: mkey = mkgen(rmKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new r1: seed;
            new ts_29: timest;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            new Nt: nonce;
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new r2: seed;
            new ts2: timest;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Qmkey[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
            new rAK: keyseed;
            let AK_25: key = kgen(rAK) in
            new rmAK: mkeyseed;
            let mAK_26: mkey = mkgen(rmAK) in
            new r3: seed;
            let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3) in
            let mac3: macs = mac(e3, Qmkey[j2]) in
            new r4: seed;
            let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4) in
            let mac4: macs = mac(e4, Rmkey[j1]) in
            event fullKC(hc, ht, n, e3, e4);
            out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          if check(m8, mKt, mac8) then
          let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pmkey_66[j3], Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_71) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
          orfind j3 <= N2 suchthat defined(rmKs, Pmkey_67[j3], Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_74) in
            let x_76: maxmac = e10 in
            let mac10: macs = mac2(x_76, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_75) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(x_76[@i_77]) && ((m14 = x_76[@i_77]) && check2(x_76[@i_77], mkgen2(rmKs), mac14)) then
          if true then
          let injbot(concat2(SK_19: key, mSK_18: mkey, h5: client)) = dec(m14, Ks) in
          if check(m15, mSK_18, mac15) then
          let injbot(pad(=h5, ts3: timest)) = dec(m15, SK_19) in
          new r16: seed;
          let e16: maxmac = enc(padts(ts3), SK_19, r16) in
          let mac16: macs = mac(e16, mSK_18) in
          event partSC(h5, m14, m15);
          event fullSC(h5, m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(h5)))
        else
          if false then
          let injbot(concat2(SK_19: key, mSK_18: mkey, h5: client)) = dec(m14, Ks) in
          if check(m15, mSK_18, mac15) then
          let injbot(pad(=h5, ts3: timest)) = dec(m15, SK_19) in
          new r16: seed;
          let e16: maxmac = enc(padts(ts3), SK_19, r16) in
          let mac16: macs = mac(e16, mSK_18) in
          event partSC(h5, m14, m15);
          event fullSC(h5, m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(h5)))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey: mkey = mKt
    else
      let Qkey: key = Lkey in
      let Qmkey: mkey = Lmkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_67: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_66: mkey = cst_mkey
)


Applying simplify yields

Game 10 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
let mKt: mkey = mkgen(rmKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new r1: seed;
            new ts_29: timest;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            new Nt: nonce;
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new r2: seed;
            new ts2: timest;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Qmkey[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
            new rAK: keyseed;
            let AK_25: key = kgen(rAK) in
            new rmAK: mkeyseed;
            let mAK_26: mkey = mkgen(rmAK) in
            new r3: seed;
            let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3) in
            let mac3: macs = mac(e3, Qmkey[j2]) in
            new r4: seed;
            let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4) in
            let mac4: macs = mac(e4, Rmkey[j1]) in
            event fullKC(hc, ht, n, e3, e4);
            out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          if check(m8, mKt, mac8) then
          let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_71) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_74) in
            let x_76: maxmac = e10 in
            let mac10: macs = mac2(x_76, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_75) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(h4[@i_77], mSK_24[@i_77], SK_23[@i_77], x_76[@i_77]) && ((m14 = x_76[@i_77]) && check2(x_76[@i_77], mkgen2(rmKs), mac14)) then
        let SK_19: key = SK_23[@i_77] in
        let mSK_18: mkey = mSK_24[@i_77] in
        let h5: client = h4[@i_77] in
        if check(m15, mSK_18, mac15) then
        let injbot(pad(=h5, ts3: timest)) = dec(m15, SK_19) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_19, r16) in
        let mac16: macs = mac(e16, mSK_18) in
        event partSC(h5, m14, m15);
        event fullSC(h5, m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h5)))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey: mkey = mKt
    else
      let Qkey: key = Lkey in
      let Qmkey: mkey = Lmkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_67: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_66: mkey = cst_mkey
)


Applying move new all binders yields

Game 11 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
let mKt: mkey = mkgen(rmKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            new Nt: nonce;
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Qmkey[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
            new rAK: keyseed;
            let AK_25: key = kgen(rAK) in
            new rmAK: mkeyseed;
            let mAK_26: mkey = mkgen(rmAK) in
            new r3: seed;
            let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3) in
            let mac3: macs = mac(e3, Qmkey[j2]) in
            new r4: seed;
            let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4) in
            let mac4: macs = mac(e4, Rmkey[j1]) in
            event fullKC(hc, ht, n, e3, e4);
            out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          if check(m8, mKt, mac8) then
          let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_71) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_74) in
            let x_76: maxmac = e10 in
            let mac10: macs = mac2(x_76, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_75) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(h4[@i_77], mSK_24[@i_77], SK_23[@i_77], x_76[@i_77]) && ((m14 = x_76[@i_77]) && check2(x_76[@i_77], mkgen2(rmKs), mac14)) then
        let SK_19: key = SK_23[@i_77] in
        let mSK_18: mkey = mSK_24[@i_77] in
        let h5: client = h4[@i_77] in
        if check(m15, mSK_18, mac15) then
        let injbot(pad(=h5, ts3: timest)) = dec(m15, SK_19) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_19, r16) in
        let mac16: macs = mac(e16, mSK_18) in
        event partSC(h5, m14, m15);
        event fullSC(h5, m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h5)))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey: mkey = mKt
    else
      let Qkey: key = Lkey in
      let Qmkey: mkey = Lmkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_67: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_66: mkey = cst_mkey
)


Applying remove assignments of useless yields

Game 12 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
let mKt: mkey = mkgen(rmKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            new Nt: nonce;
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Qmkey[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
            new rAK: keyseed;
            let AK_25: key = kgen(rAK) in
            new rmAK: mkeyseed;
            let mAK_26: mkey = mkgen(rmAK) in
            new r3: seed;
            let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3) in
            let mac3: macs = mac(e3, Qmkey[j2]) in
            new r4: seed;
            let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4) in
            let mac4: macs = mac(e4, Rmkey[j1]) in
            event fullKC(hc, ht, n, e3, e4);
            out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          if check(m8, mKt, mac8) then
          let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_71) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_75) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(e10[@i_77], x_76[@i_77], h4[@i_77], mSK_24[@i_77], SK_23[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=h4[@i_77], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(h4[@i_77], m14, m15);
        event fullSC(h4[@i_77], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h4[@i_77])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey: mkey = mKt
    else
      let Qkey: key = Lkey in
      let Qmkey: mkey = Lmkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_67: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_66: mkey = cst_mkey
)


Applying remove assignments of binder mKt yields

Game 13 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            new Nt: nonce;
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Qmkey[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
            new rAK: keyseed;
            let AK_25: key = kgen(rAK) in
            new rmAK: mkeyseed;
            let mAK_26: mkey = mkgen(rmAK) in
            new r3: seed;
            let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3) in
            let mac3: macs = mac(e3, Qmkey[j2]) in
            new r4: seed;
            let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4) in
            let mac4: macs = mac(e4, Rmkey[j1]) in
            event fullKC(hc, ht, n, e3, e4);
            out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          if check(m8, mkgen(rmKt), mac8) then
          let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_71) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_75) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(e10[@i_77], x_76[@i_77], h4[@i_77], mSK_24[@i_77], SK_23[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=h4[@i_77], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(h4[@i_77], m14, m15);
        event fullSC(h4[@i_77], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h4[@i_77])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey: mkey = mkgen(rmKt)
    else
      let Qkey: key = Lkey in
      let Qmkey: mkey = Lmkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_67: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_66: mkey = cst_mkey
)


Applying SA rename Qmkey yields

Game 14 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            new Nt: nonce;
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Qmkey_131[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
              new rAK: keyseed;
              let AK_25: key = kgen(rAK) in
              new rmAK: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK) in
              new r3: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3) in
              let mac3: macs = mac(e3, Qmkey_131[j2]) in
              new r4: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j2 <= N2 suchthat defined(Qmkey_132[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
              new rAK: keyseed;
              let AK_25: key = kgen(rAK) in
              new rmAK: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK) in
              new r3: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3) in
              let mac3: macs = mac(e3, Qmkey_132[j2]) in
              new r4: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          if check(m8, mkgen(rmKt), mac8) then
          let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_71) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_75) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(e10[@i_77], x_76[@i_77], h4[@i_77], mSK_24[@i_77], SK_23[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=h4[@i_77], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(h4[@i_77], m14, m15);
        event fullSC(h4[@i_77], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h4[@i_77])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_132: mkey = mkgen(rmKt)
    else
      let Qkey: key = Lkey in
      let Qmkey_131: mkey = Lmkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_67: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_66: mkey = cst_mkey
)


Applying remove assignments of binder Qmkey yields

Game 15 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            new Nt: nonce;
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Lmkey[j2], Qmkey_131[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
              new rAK_133: keyseed;
              let AK_25: key = kgen(rAK_133) in
              new rmAK_134: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK_134) in
              new r3_135: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_135) in
              let mac3: macs = mac(e3, Lmkey[j2]) in
              new r4_136: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_136) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j2 <= N2 suchthat defined(Qmkey_132[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
              new rAK_137: keyseed;
              let AK_25: key = kgen(rAK_137) in
              new rmAK_138: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK_138) in
              new r3_139: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_139) in
              let mac3: macs = mac(e3, Qmkey_132[j2]) in
              new r4_140: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_140) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          if check(m8, mkgen(rmKt), mac8) then
          let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_71) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_75) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(e10[@i_77], x_76[@i_77], h4[@i_77], mSK_24[@i_77], SK_23[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=h4[@i_77], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(h4[@i_77], m14, m15);
        event fullSC(h4[@i_77], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h4[@i_77])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_132: mkey = mkgen(rmKt)
    else
      let Qkey: key = Lkey in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_67: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_66: mkey = cst_mkey
)


Applying remove assignments of binder Qmkey_132 yields

Game 16 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            new Nt: nonce;
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Lmkey[j2], Qmkey_131[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
              new rAK_133: keyseed;
              let AK_25: key = kgen(rAK_133) in
              new rmAK_134: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK_134) in
              new r3_135: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_135) in
              let mac3: macs = mac(e3, Lmkey[j2]) in
              new r4_136: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_136) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j2 <= N2 suchthat defined(rmKt, Qmkey_132[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
              new rAK_137: keyseed;
              let AK_25: key = kgen(rAK_137) in
              new rmAK_138: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK_138) in
              new r3_139: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_139) in
              let mac3: macs = mac(e3, mkgen(rmKt)) in
              new r4_140: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_140) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          if check(m8, mkgen(rmKt), mac8) then
          let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_71) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_75) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(e10[@i_77], x_76[@i_77], h4[@i_77], mSK_24[@i_77], SK_23[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=h4[@i_77], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(h4[@i_77], m14, m15);
        event fullSC(h4[@i_77], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h4[@i_77])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_132: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_67: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_66: mkey = cst_mkey
)


Applying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmKt [Difference of probability Pmac(time + time(context for game 16), N, N)] yields

Game 17 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            new Nt: nonce;
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Lmkey[j2], Qmkey_131[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
              new rAK_133: keyseed;
              let AK_25: key = kgen(rAK_133) in
              new rmAK_134: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK_134) in
              new r3_135: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_135) in
              let mac3: macs = mac(e3, Lmkey[j2]) in
              new r4_136: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_136) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j2 <= N2 suchthat defined(rmKt, Qmkey_132[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
              new rAK_137: keyseed;
              let AK_25: key = kgen(rAK_137) in
              new rmAK_138: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK_138) in
              new r3_139: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_139) in
              let x_141: maxmac = e3 in
              let mac3: macs = mac2(x_141, mkgen2(rmKt)) in
              new r4_140: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_140) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(x_141[@i_142]) && ((m8 = x_141[@i_142]) && check2(x_141[@i_142], mkgen2(rmKt), mac8)) then
            if true then
            let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
            if check(m9, mAK_20, mac9) then
            let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
            event partTC(h4, m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_68: keyseed;
              let SK_23: key = kgen(rSK_68) in
              new rmSK_69: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_69) in
              new r10_70: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_70) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_71: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_71) in
              let mac11: macs = mac(e11, mAK_20) in
              event fullTC(h4, h3, n2, m8, m9, e11);
              out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
            orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_72: keyseed;
              let SK_23: key = kgen(rSK_72) in
              new rmSK_73: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_73) in
              new r10_74: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_74) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_75: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_75) in
              let mac11: macs = mac(e11, mAK_20) in
              event fullTC(h4, h3, n2, m8, m9, e11);
              out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
          else
            if false then
            let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
            if check(m9, mAK_20, mac9) then
            let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
            event partTC(h4, m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_68: keyseed;
              let SK_23: key = kgen(rSK_68) in
              new rmSK_69: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_69) in
              new r10_70: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_70) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_71: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_71) in
              let mac11: macs = mac(e11, mAK_20) in
              event fullTC(h4, h3, n2, m8, m9, e11);
              out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
            orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_72: keyseed;
              let SK_23: key = kgen(rSK_72) in
              new rmSK_73: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_73) in
              new r10_74: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_74) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_75: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_75) in
              let mac11: macs = mac(e11, mAK_20) in
              event fullTC(h4, h3, n2, m8, m9, e11);
              out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(e10[@i_77], x_76[@i_77], h4[@i_77], mSK_24[@i_77], SK_23[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=h4[@i_77], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(h4[@i_77], m14, m15);
        event fullSC(h4[@i_77], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h4[@i_77])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_132: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_67: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_66: mkey = cst_mkey
)


Applying simplify yields

Game 18 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            new Nt: nonce;
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
              new rAK_133: keyseed;
              let AK_25: key = kgen(rAK_133) in
              new rmAK_134: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK_134) in
              new r3_135: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_135) in
              let mac3: macs = mac(e3, Lmkey[j2]) in
              new r4_136: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_136) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
              new rAK_137: keyseed;
              let AK_25: key = kgen(rAK_137) in
              new rmAK_138: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK_138) in
              new r3_139: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_139) in
              let x_141: maxmac = e3 in
              let mac3: macs = mac2(x_141, mkgen2(rmKt)) in
              new r4_140: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_140) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(hc[@i_142], mAK_26[@i_142], AK_25[@i_142], x_141[@i_142]) && ((m8 = x_141[@i_142]) && check2(x_141[@i_142], mkgen2(rmKt), mac8)) then
          let AK_21: key = AK_25[@i_142] in
          let mAK_20: mkey = mAK_26[@i_142] in
          let h4: client = hc[@i_142] in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_71) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_75) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], h4[@i_77], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=h4[@i_77], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(h4[@i_77], m14, m15);
        event fullSC(h4[@i_77], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h4[@i_77])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_132: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_67: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_66: mkey = cst_mkey
)


Applying move new all binders yields

Game 19 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
new rmKt: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new r1: seed;
            new ts_29: timest;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            new Nt: nonce;
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new r2: seed;
            new ts2: timest;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
              new rAK_133: keyseed;
              let AK_25: key = kgen(rAK_133) in
              new rmAK_134: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK_134) in
              new r3_135: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_135) in
              let mac3: macs = mac(e3, Lmkey[j2]) in
              new r4_136: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_136) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
              new rAK_137: keyseed;
              let AK_25: key = kgen(rAK_137) in
              new rmAK_138: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK_138) in
              new r3_139: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_139) in
              let x_141: maxmac = e3 in
              let mac3: macs = mac2(x_141, mkgen2(rmKt)) in
              new r4_140: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_140) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(hc[@i_142], mAK_26[@i_142], AK_25[@i_142], x_141[@i_142]) && ((m8 = x_141[@i_142]) && check2(x_141[@i_142], mkgen2(rmKt), mac8)) then
          let AK_21: key = AK_25[@i_142] in
          let mAK_20: mkey = mAK_26[@i_142] in
          let h4: client = hc[@i_142] in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_71) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_75) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], h4[@i_77], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=h4[@i_77], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(h4[@i_77], m14, m15);
        event fullSC(h4[@i_77], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h4[@i_77])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_132: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_67: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_66: mkey = cst_mkey
)


Applying remove assignments of useless yields

Game 20 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
new rmKt: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new r1: seed;
            new ts_29: timest;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            new Nt: nonce;
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new r2: seed;
            new ts2: timest;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
              new rAK_133: keyseed;
              let AK_25: key = kgen(rAK_133) in
              new rmAK_134: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK_134) in
              new r3_135: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_135) in
              let mac3: macs = mac(e3, Lmkey[j2]) in
              new r4_136: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_136) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
              new rAK_137: keyseed;
              let AK_25: key = kgen(rAK_137) in
              new rmAK_138: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK_138) in
              new r3_139: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_139) in
              let x_141: maxmac = cst_maxmac in
              let mac3: macs = mac2(e3, mkgen2(rmKt)) in
              new r4_140: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_140) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(e3[@i_142], x_141[@i_142], hc[@i_142], mAK_26[@i_142], AK_25[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
          let h4: client = cst_client in
          if check(m9, mAK_26[@i_142], mac9) then
          let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
          event partTC(hc[@i_142], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Pkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_71) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Pkey[j3], r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_75) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(hc[@i_142[@i_77]], h4[@i_77], SK_23[@i_77], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_132: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_67: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_66: mkey = cst_mkey
)


Applying remove assignments of binder mKc yields

Game 21 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
new rmKt: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mkgen(rmKc), mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new r1: seed;
            new ts_29: timest;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            new Nt: nonce;
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new r2: seed;
            new ts2: timest;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
              new rAK_133: keyseed;
              let AK_25: key = kgen(rAK_133) in
              new rmAK_134: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK_134) in
              new r3_135: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_135) in
              let mac3: macs = mac(e3, Lmkey[j2]) in
              new r4_136: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_136) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
              new rAK_137: keyseed;
              let AK_25: key = kgen(rAK_137) in
              new rmAK_138: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK_138) in
              new r3_139: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_139) in
              let x_141: maxmac = cst_maxmac in
              let mac3: macs = mac2(e3, mkgen2(rmKt)) in
              new r4_140: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_140) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(e3[@i_142], x_141[@i_142], hc[@i_142], mAK_26[@i_142], AK_25[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
          let h4: client = cst_client in
          if check(m9, mAK_26[@i_142], mac9) then
          let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
          event partTC(hc[@i_142], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Pkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_71) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Pkey[j3], r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_75) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(hc[@i_142[@i_77]], h4[@i_77], SK_23[@i_77], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mkgen(rmKc)
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_132: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_67: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_66: mkey = cst_mkey
)


Applying SA rename Rmkey yields

Game 22 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
new rmKt: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mkgen(rmKc), mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new r1: seed;
            new ts_29: timest;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            new Nt: nonce;
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new r2: seed;
            new ts2: timest;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey_200[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_133: keyseed;
                let AK_25: key = kgen(rAK_133) in
                new rmAK_134: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_134) in
                new r3_135: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_135) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_136: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_136) in
                let mac4: macs = mac(e4, Rmkey_200[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_137: keyseed;
                let AK_25: key = kgen(rAK_137) in
                new rmAK_138: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_138) in
                new r3_139: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_139) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_140: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_140) in
                let mac4: macs = mac(e4, Rmkey_200[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Rmkey_201[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_133: keyseed;
                let AK_25: key = kgen(rAK_133) in
                new rmAK_134: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_134) in
                new r3_135: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_135) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_136: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_136) in
                let mac4: macs = mac(e4, Rmkey_201[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_137: keyseed;
                let AK_25: key = kgen(rAK_137) in
                new rmAK_138: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_138) in
                new r3_139: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_139) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_140: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_140) in
                let mac4: macs = mac(e4, Rmkey_201[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(e3[@i_142], x_141[@i_142], hc[@i_142], mAK_26[@i_142], AK_25[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
          let h4: client = cst_client in
          if check(m9, mAK_26[@i_142], mac9) then
          let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
          event partTC(hc[@i_142], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Pkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_71) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Pkey[j3], r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_75) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(hc[@i_142[@i_77]], h4[@i_77], SK_23[@i_77], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey_201: mkey = mkgen(rmKc)
      else
        let Rkey: key = Kkey in
        let Rmkey_200: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_132: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_67: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_66: mkey = cst_mkey
)


Applying remove assignments of binder Rmkey yields

Game 23 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
new rmKt: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mkgen(rmKc), mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new r1: seed;
            new ts_29: timest;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            new Nt: nonce;
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new r2: seed;
            new ts2: timest;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Rmkey_200[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new rmAK_203: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_203) in
                new r3_204: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Rmkey_201[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_213) in
                let mac4: macs = mac(e4, Rmkey_201[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_215) in
                new r3_216: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_217) in
                let mac4: macs = mac(e4, Rmkey_201[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(e3[@i_142], x_141[@i_142], hc[@i_142], mAK_26[@i_142], AK_25[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
          let h4: client = cst_client in
          if check(m9, mAK_26[@i_142], mac9) then
          let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
          event partTC(hc[@i_142], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Pkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_71) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Pkey[j3], r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_75) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(hc[@i_142[@i_77]], h4[@i_77], SK_23[@i_77], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey_201: mkey = mkgen(rmKc)
      else
        let Rkey: key = Kkey in
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_132: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_67: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_66: mkey = cst_mkey
)


Applying remove assignments of binder Rmkey_201 yields

Game 24 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
new rmKt: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mkgen(rmKc), mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new r1: seed;
            new ts_29: timest;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            new Nt: nonce;
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new r2: seed;
            new ts2: timest;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Rmkey_200[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new rmAK_203: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_203) in
                new r3_204: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(rmKc, Rmkey_201[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_213) in
                let mac4: macs = mac(e4, mkgen(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_215) in
                new r3_216: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_217) in
                let mac4: macs = mac(e4, mkgen(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(e3[@i_142], x_141[@i_142], hc[@i_142], mAK_26[@i_142], AK_25[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
          let h4: client = cst_client in
          if check(m9, mAK_26[@i_142], mac9) then
          let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
          event partTC(hc[@i_142], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Pkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_71) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Pkey[j3], r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_75) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(hc[@i_142[@i_77]], h4[@i_77], SK_23[@i_77], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey_201: mkey = cst_mkey
      else
        let Rkey: key = Kkey in
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_132: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_67: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_66: mkey = cst_mkey
)


Applying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmKc [Difference of probability Pmac(time + time(context for game 24), N, N)] yields

Game 25 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
new rmKt: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(x_218[@i_222]) && ((m2 = x_218[@i_222]) && check2(x_218[@i_222], mkgen2(rmKc), mac2)) then
              if true then
              let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
              event fullCK(h, Nc, m, m2);
              new r1: seed;
              new ts_29: timest;
              let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
              let mac5: macs = mac(e5, mAK_27) in
              event partCT(h, m, e5);
              new Nt: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_27, mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
              event fullCT(h, h2, Nt, m, e5, m7);
              new r2: seed;
              new ts2: timest;
              let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(x_219[@i_221]) && ((m2 = x_219[@i_221]) && check2(x_219[@i_221], mkgen2(rmKc), mac2)) then
              if true then
              let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
              event fullCK(h, Nc, m, m2);
              new r1: seed;
              new ts_29: timest;
              let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
              let mac5: macs = mac(e5, mAK_27) in
              event partCT(h, m, e5);
              new Nt: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_27, mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
              event fullCT(h, h2, Nt, m, e5, m7);
              new r2: seed;
              new ts2: timest;
              let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            else
              if false then
              let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
              event fullCK(h, Nc, m, m2);
              new r1: seed;
              new ts_29: timest;
              let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
              let mac5: macs = mac(e5, mAK_27) in
              event partCT(h, m, e5);
              new Nt: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_27, mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
              event fullCT(h, h2, Nt, m, e5, m7);
              new r2: seed;
              new ts2: timest;
              let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Rmkey_200[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new rmAK_203: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_203) in
                new r3_204: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(rmKc, Rmkey_201[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_213) in
                let x_218: maxmac = e4 in
                let mac4: macs = mac2(x_218, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_215) in
                new r3_216: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_217) in
                let x_219: maxmac = e4 in
                let mac4: macs = mac2(x_219, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(e3[@i_142], x_141[@i_142], hc[@i_142], mAK_26[@i_142], AK_25[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
          let h4: client = cst_client in
          if check(m9, mAK_26[@i_142], mac9) then
          let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
          event partTC(hc[@i_142], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Pkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_71) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Pkey[j3], r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_75) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(hc[@i_142[@i_77]], h4[@i_77], SK_23[@i_77], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey_201: mkey = cst_mkey
      else
        let Rkey: key = Kkey in
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_132: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_67: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_66: mkey = cst_mkey
)


Applying simplify yields

Game 26 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
new rmKt: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(ht[@i_222], n[@i_222], mAK_26[@i_222], AK_25[@i_222], x_218[@i_222]) && ((m2 = x_218[@i_222]) && check2(x_218[@i_222], mkgen2(rmKc), mac2)) then
              let AK_28: key = AK_25[@i_222] in
              let mAK_27: mkey = mAK_26[@i_222] in
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new r1: seed;
              new ts_29: timest;
              let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
              let mac5: macs = mac(e5, mAK_27) in
              event partCT(h, m, e5);
              new Nt: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_27, mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
              event fullCT(h, h2, Nt, m, e5, m7);
              new r2: seed;
              new ts2: timest;
              let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(ht[@i_221], n[@i_221], mAK_26[@i_221], AK_25[@i_221], x_219[@i_221]) && ((m2 = x_219[@i_221]) && check2(x_219[@i_221], mkgen2(rmKc), mac2)) then
              let AK_28: key = AK_25[@i_221] in
              let mAK_27: mkey = mAK_26[@i_221] in
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1: seed;
              new ts_29: timest;
              let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
              let mac5: macs = mac(e5, mAK_27) in
              event partCT(h, m, e5);
              new Nt: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_27, mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
              event fullCT(h, h2, Nt, m, e5, m7);
              new r2: seed;
              new ts2: timest;
              let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Rkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new rmAK_203: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_203) in
                new r3_204: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Rkey[j1], Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_213) in
                let x_218: maxmac = e4 in
                let mac4: macs = mac2(x_218, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_215) in
                new r3_216: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_217) in
                let x_219: maxmac = e4 in
                let mac4: macs = mac2(x_219, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_26[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
          let h4: client = cst_client in
          if check(m9, mAK_26[@i_142], mac9) then
          let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
          event partTC(hc[@i_142], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Pkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_71) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Pkey[j3], r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_75) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey_201: mkey = cst_mkey
      else
        let Rkey: key = Kkey in
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_132: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_67: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_66: mkey = cst_mkey
)


Applying move new all binders yields

Game 27 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKt: mkeyseed;
new rmKs: mkeyseed;
new rmKc: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(ht[@i_222], n[@i_222], mAK_26[@i_222], AK_25[@i_222], x_218[@i_222]) && ((m2 = x_218[@i_222]) && check2(x_218[@i_222], mkgen2(rmKc), mac2)) then
              let AK_28: key = AK_25[@i_222] in
              let mAK_27: mkey = mAK_26[@i_222] in
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new ts_29: timest;
              new r1: seed;
              let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
              let mac5: macs = mac(e5, mAK_27) in
              event partCT(h, m, e5);
              new Nt: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_27, mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
              event fullCT(h, h2, Nt, m, e5, m7);
              new ts2: timest;
              new r2: seed;
              let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(ht[@i_221], n[@i_221], mAK_26[@i_221], AK_25[@i_221], x_219[@i_221]) && ((m2 = x_219[@i_221]) && check2(x_219[@i_221], mkgen2(rmKc), mac2)) then
              let AK_28: key = AK_25[@i_221] in
              let mAK_27: mkey = mAK_26[@i_221] in
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new ts_29: timest;
              new r1: seed;
              let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
              let mac5: macs = mac(e5, mAK_27) in
              event partCT(h, m, e5);
              new Nt: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_27, mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
              event fullCT(h, h2, Nt, m, e5, m7);
              new ts2: timest;
              new r2: seed;
              let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Rkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new rmAK_203: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_203) in
                new r3_204: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Rkey[j1], Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_213) in
                let x_218: maxmac = e4 in
                let mac4: macs = mac2(x_218, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_215) in
                new r3_216: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_217) in
                let x_219: maxmac = e4 in
                let mac4: macs = mac2(x_219, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_26[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
          let h4: client = cst_client in
          if check(m9, mAK_26[@i_142], mac9) then
          let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
          event partTC(hc[@i_142], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Pkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_71) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Pkey[j3], r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_75) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey_201: mkey = cst_mkey
      else
        let Rkey: key = Kkey in
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_132: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_67: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_66: mkey = cst_mkey
)


Applying remove assignments of useless yields

Game 28 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKt: mkeyseed;
new rmKs: mkeyseed;
new rmKc: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(e4[@i_222], x_218[@i_222], ht[@i_222], n[@i_222], mAK_26[@i_222], AK_25[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new ts_241: timest;
              new r1_242: seed;
              let e5: maxmac = enc(pad(C, ts_241), AK_25[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_26[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_25[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new ts2_244: timest;
              new r2_245: seed;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(e4[@i_221], x_219[@i_221], ht[@i_221], n[@i_221], mAK_26[@i_221], AK_25[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new ts_246: timest;
              new r1_247: seed;
              let e5: maxmac = enc(pad(C, ts_246), AK_25[@i_221], r1_247) in
              let mac5: macs = mac(e5, mAK_26[@i_221]) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_221], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_248, =h2)) = dec(m7, AK_25[@i_221]) in
              event fullCT(h, h2, Nt_248, m, e5, m7);
              new ts2_249: timest;
              new r2_250: seed;
              let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Rkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new rmAK_203: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_203) in
                new r3_204: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Rkey[j1], Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_215) in
                new r3_216: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_26[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_142], mac9) then
          let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
          event partTC(hc[@i_142], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Pkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_71) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Pkey[j3], r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_75) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey_201: mkey = cst_mkey
      else
        let Rkey: key = Kkey in
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_132: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_67: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_66: mkey = cst_mkey
)


RESULT Proved event inj:fullCK(T, N, x, y) ==> inj:fullKC(C, T, N, z, y) with probability 0.5 * N * N / |nonce| + Pmac(time + time(context for game 24), N, N) + Pmac(time + time(context for game 16), N, N) + Pmac(time + time(context for game 8), N, N)

Applying SA rename Pkey yields

Game 30 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKt: mkeyseed;
new rmKs: mkeyseed;
new rmKc: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(e4[@i_222], x_218[@i_222], ht[@i_222], n[@i_222], mAK_26[@i_222], AK_25[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new ts_241: timest;
              new r1_242: seed;
              let e5: maxmac = enc(pad(C, ts_241), AK_25[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_26[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_25[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new ts2_244: timest;
              new r2_245: seed;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(e4[@i_221], x_219[@i_221], ht[@i_221], n[@i_221], mAK_26[@i_221], AK_25[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new ts_246: timest;
              new r1_247: seed;
              let e5: maxmac = enc(pad(C, ts_246), AK_25[@i_221], r1_247) in
              let mac5: macs = mac(e5, mAK_26[@i_221]) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_221], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_248, =h2)) = dec(m7, AK_25[@i_221]) in
              event fullCT(h, h2, Nt_248, m, e5, m7);
              new ts2_249: timest;
              new r2_250: seed;
              let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Rkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new rmAK_203: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_203) in
                new r3_204: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Rkey[j1], Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_215) in
                new r3_216: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_26[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_142], mac9) then
          let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
          event partTC(hc[@i_142], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey_397[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Pkey_397[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_71) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind j3 <= N2 suchthat defined(Pkey_398[j3], Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Pkey_398[j3], r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_75) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey_201: mkey = cst_mkey
      else
        let Rkey: key = Kkey in
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_132: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_398: key = Ks in
    let Pmkey_67: mkey = cst_mkey
  else
    let Pkey_397: key = Mkey in
    let Pmkey_66: mkey = cst_mkey
)


Applying remove assignments of binder Pkey yields

Game 31 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKt: mkeyseed;
new rmKs: mkeyseed;
new rmKc: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(e4[@i_222], x_218[@i_222], ht[@i_222], n[@i_222], mAK_26[@i_222], AK_25[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new ts_241: timest;
              new r1_242: seed;
              let e5: maxmac = enc(pad(C, ts_241), AK_25[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_26[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_25[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new ts2_244: timest;
              new r2_245: seed;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(e4[@i_221], x_219[@i_221], ht[@i_221], n[@i_221], mAK_26[@i_221], AK_25[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new ts_246: timest;
              new r1_247: seed;
              let e5: maxmac = enc(pad(C, ts_246), AK_25[@i_221], r1_247) in
              let mac5: macs = mac(e5, mAK_26[@i_221]) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_221], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_248, =h2)) = dec(m7, AK_25[@i_221]) in
              event fullCT(h, h2, Nt_248, m, e5, m7);
              new ts2_249: timest;
              new r2_250: seed;
              let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Rkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new rmAK_203: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_203) in
                new r3_204: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Rkey[j1], Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_215) in
                new r3_216: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_26[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_142], mac9) then
          let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
          event partTC(hc[@i_142], m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Pkey_397[j3], Mmkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_71) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind j3 <= N2 suchthat defined(Ks, Pkey_398[j3], Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Ks, r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_75) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey_201: mkey = cst_mkey
      else
        let Rkey: key = Kkey in
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_132: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_398: key = cst_key in
    let Pmkey_67: mkey = cst_mkey
  else
    let Pkey_397: key = cst_key in
    let Pmkey_66: mkey = cst_mkey
)


Applying remove assignments of binder Ks yields

Game 32 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rKs: keyseed;
let Ks: key = cst_key in
new rmKt: mkeyseed;
new rmKs: mkeyseed;
new rmKc: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(e4[@i_222], x_218[@i_222], ht[@i_222], n[@i_222], mAK_26[@i_222], AK_25[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new ts_241: timest;
              new r1_242: seed;
              let e5: maxmac = enc(pad(C, ts_241), AK_25[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_26[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_25[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new ts2_244: timest;
              new r2_245: seed;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(e4[@i_221], x_219[@i_221], ht[@i_221], n[@i_221], mAK_26[@i_221], AK_25[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new ts_246: timest;
              new r1_247: seed;
              let e5: maxmac = enc(pad(C, ts_246), AK_25[@i_221], r1_247) in
              let mac5: macs = mac(e5, mAK_26[@i_221]) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_221], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_248, =h2)) = dec(m7, AK_25[@i_221]) in
              event fullCT(h, h2, Nt_248, m, e5, m7);
              new ts2_249: timest;
              new r2_250: seed;
              let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Rkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new rmAK_203: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_203) in
                new r3_204: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Rkey[j1], Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_215) in
                new r3_216: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_26[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_142], mac9) then
          let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
          event partTC(hc[@i_142], m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Pkey_397[j3], Mmkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_71) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind j3 <= N2 suchthat defined(rKs, Ks, Pkey_398[j3], Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), kgen(rKs), r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_75) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey_201: mkey = cst_mkey
      else
        let Rkey: key = Kkey in
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_132: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_398: key = cst_key in
    let Pmkey_67: mkey = cst_mkey
  else
    let Pkey_397: key = cst_key in
    let Pmkey_66: mkey = cst_mkey
)


Applying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r10_74 [Difference of probability Penc(time + time(context for game 32), N)] yields

Game 33 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rKs: keyseed;
let Ks: key = cst_key in
new rmKt: mkeyseed;
new rmKs: mkeyseed;
new rmKc: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(e4[@i_222], x_218[@i_222], ht[@i_222], n[@i_222], mAK_26[@i_222], AK_25[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new ts_241: timest;
              new r1_242: seed;
              let e5: maxmac = enc(pad(C, ts_241), AK_25[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_26[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_25[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new ts2_244: timest;
              new r2_245: seed;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(e4[@i_221], x_219[@i_221], ht[@i_221], n[@i_221], mAK_26[@i_221], AK_25[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new ts_246: timest;
              new r1_247: seed;
              let e5: maxmac = enc(pad(C, ts_246), AK_25[@i_221], r1_247) in
              let mac5: macs = mac(e5, mAK_26[@i_221]) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_221], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_248, =h2)) = dec(m7, AK_25[@i_221]) in
              event fullCT(h, h2, Nt_248, m, e5, m7);
              new ts2_249: timest;
              new r2_250: seed;
              let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Rkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new rmAK_203: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_203) in
                new r3_204: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Rkey[j1], Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_215) in
                new r3_216: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_26[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_142], mac9) then
          let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
          event partTC(hc[@i_142], m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Pkey_397[j3], Mmkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_71) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind j3 <= N2 suchthat defined(rKs, Ks, Pkey_398[j3], Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc2(Z(concat2(SK_23, mSK_24, hc[@i_142])), kgen2(rKs), r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_75) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey_201: mkey = cst_mkey
      else
        let Rkey: key = Kkey in
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_132: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_398: key = cst_key in
    let Pmkey_67: mkey = cst_mkey
  else
    let Pkey_397: key = cst_key in
    let Pmkey_66: mkey = cst_mkey
)


Applying simplify yields

Game 34 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rKs: keyseed;
let Ks: key = cst_key in
new rmKt: mkeyseed;
new rmKs: mkeyseed;
new rmKc: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_26[@i_222], AK_25[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new ts_241: timest;
              new r1_242: seed;
              let e5: maxmac = enc(pad(C, ts_241), AK_25[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_26[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_25[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new ts2_244: timest;
              new r2_245: seed;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(mAK_26[@i_221], AK_25[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new ts_246: timest;
              new r1_247: seed;
              let e5: maxmac = enc(pad(C, ts_246), AK_25[@i_221], r1_247) in
              let mac5: macs = mac(e5, mAK_26[@i_221]) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_221], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_248, =h2)) = dec(m7, AK_25[@i_221]) in
              event fullCT(h, h2, Nt_248, m, e5, m7);
              new ts2_249: timest;
              new r2_250: seed;
              let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Rkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new rmAK_203: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_203) in
                new r3_204: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Rkey[j1], Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_215) in
                new r3_216: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_26[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_142], mac9) then
          let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
          event partTC(hc[@i_142], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_71) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_75) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey_201: mkey = cst_mkey
      else
        let Rkey: key = Kkey in
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_132: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_398: key = cst_key in
    let Pmkey_67: mkey = cst_mkey
  else
    let Pkey_397: key = cst_key in
    let Pmkey_66: mkey = cst_mkey
)


Applying move new all binders yields

Game 35 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
let Ks: key = cst_key in
new rmKc: mkeyseed;
new rmKs: mkeyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_26[@i_222], AK_25[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new r1_242: seed;
              new ts_241: timest;
              let e5: maxmac = enc(pad(C, ts_241), AK_25[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_26[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_25[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new r2_245: seed;
              new ts2_244: timest;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(mAK_26[@i_221], AK_25[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              new ts_246: timest;
              let e5: maxmac = enc(pad(C, ts_246), AK_25[@i_221], r1_247) in
              let mac5: macs = mac(e5, mAK_26[@i_221]) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_221], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_248, =h2)) = dec(m7, AK_25[@i_221]) in
              event fullCT(h, h2, Nt_248, m, e5, m7);
              new r2_250: seed;
              new ts2_249: timest;
              let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Rkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new rmAK_203: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_203) in
                new r3_204: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Rkey[j1], Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_215) in
                new r3_216: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_26[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_142], mac9) then
          let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
          event partTC(hc[@i_142], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_71) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_75) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey_201: mkey = cst_mkey
      else
        let Rkey: key = Kkey in
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_132: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_398: key = cst_key in
    let Pmkey_67: mkey = cst_mkey
  else
    let Pkey_397: key = cst_key in
    let Pmkey_66: mkey = cst_mkey
)


Applying remove assignments of useless yields

Game 36 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKc: mkeyseed;
new rmKs: mkeyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_26[@i_222], AK_25[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new r1_242: seed;
              new ts_241: timest;
              let e5: maxmac = enc(pad(C, ts_241), AK_25[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_26[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_25[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new r2_245: seed;
              new ts2_244: timest;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(mAK_26[@i_221], AK_25[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              new ts_246: timest;
              let e5: maxmac = enc(pad(C, ts_246), AK_25[@i_221], r1_247) in
              let mac5: macs = mac(e5, mAK_26[@i_221]) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_221], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_248, =h2)) = dec(m7, AK_25[@i_221]) in
              event fullCT(h, h2, Nt_248, m, e5, m7);
              new r2_250: seed;
              new ts2_249: timest;
              let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Rkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new rmAK_203: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_203) in
                new r3_204: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Rkey[j1], Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_215) in
                new r3_216: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_26[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_142], mac9) then
          let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
          event partTC(hc[@i_142], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_71) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_75) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey_201: mkey = cst_mkey
      else
        let Rkey: key = Kkey in
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_132: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying SA rename Rkey yields

Game 37 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKc: mkeyseed;
new rmKs: mkeyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_26[@i_222], AK_25[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new r1_242: seed;
              new ts_241: timest;
              let e5: maxmac = enc(pad(C, ts_241), AK_25[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_26[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_25[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new r2_245: seed;
              new ts2_244: timest;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(mAK_26[@i_221], AK_25[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              new ts_246: timest;
              let e5: maxmac = enc(pad(C, ts_246), AK_25[@i_221], r1_247) in
              let mac5: macs = mac(e5, mAK_26[@i_221]) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_221], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_248, =h2)) = dec(m7, AK_25[@i_221]) in
              event fullCT(h, h2, Nt_248, m, e5, m7);
              new r2_250: seed;
              new ts2_249: timest;
              let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Rkey_599[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new rmAK_203: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_203) in
                new r3_204: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey_599[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey_599[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Rkey_600[j1], Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey_600[j1], r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_215) in
                new r3_216: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey_600[j1], r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_26[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_142], mac9) then
          let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
          event partTC(hc[@i_142], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_71) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_75) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey_600: key = Kc in
        let Rmkey_201: mkey = cst_mkey
      else
        let Rkey_599: key = Kkey in
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_132: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying remove assignments of binder Rkey yields

Game 38 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKc: mkeyseed;
new rmKs: mkeyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_26[@i_222], AK_25[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new r1_242: seed;
              new ts_241: timest;
              let e5: maxmac = enc(pad(C, ts_241), AK_25[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_26[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_25[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new r2_245: seed;
              new ts2_244: timest;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(mAK_26[@i_221], AK_25[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              new ts_246: timest;
              let e5: maxmac = enc(pad(C, ts_246), AK_25[@i_221], r1_247) in
              let mac5: macs = mac(e5, mAK_26[@i_221]) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_221], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_248, =h2)) = dec(m7, AK_25[@i_221]) in
              event fullCT(h, h2, Nt_248, m, e5, m7);
              new r2_250: seed;
              new ts2_249: timest;
              let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kkey[j1], Rkey_599[j1], Kmkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new rmAK_203: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_203) in
                new r3_204: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Kc, Rkey_600[j1], Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kc, r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_215) in
                new r3_216: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kc, r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_26[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_142], mac9) then
          let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
          event partTC(hc[@i_142], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_71) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_75) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey_600: key = cst_key in
        let Rmkey_201: mkey = cst_mkey
      else
        let Rkey_599: key = cst_key in
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_132: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying remove assignments of binder Kc yields

Game 39 is
in(start, ());
new rKc: keyseed;
let Kc: key = cst_key in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKc: mkeyseed;
new rmKs: mkeyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_26[@i_222], AK_25[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new r1_242: seed;
              new ts_241: timest;
              let e5: maxmac = enc(pad(C, ts_241), AK_25[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_26[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_25[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new r2_245: seed;
              new ts2_244: timest;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(mAK_26[@i_221], AK_25[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              new ts_246: timest;
              let e5: maxmac = enc(pad(C, ts_246), AK_25[@i_221], r1_247) in
              let mac5: macs = mac(e5, mAK_26[@i_221]) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_221], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_248, =h2)) = dec(m7, AK_25[@i_221]) in
              event fullCT(h, h2, Nt_248, m, e5, m7);
              new r2_250: seed;
              new ts2_249: timest;
              let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kkey[j1], Rkey_599[j1], Kmkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new rmAK_203: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_203) in
                new r3_204: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(rKc, Kc, Rkey_600[j1], Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), kgen(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_215) in
                new r3_216: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), kgen(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_26[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_142], mac9) then
          let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
          event partTC(hc[@i_142], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_71) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_75) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey_600: key = cst_key in
        let Rmkey_201: mkey = cst_mkey
      else
        let Rkey_599: key = cst_key in
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_132: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r4_217 [Difference of probability Penc(time + time(context for game 39), N)] yields

Game 40 is
in(start, ());
new rKc: keyseed;
let Kc: key = cst_key in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKc: mkeyseed;
new rmKs: mkeyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_26[@i_222], AK_25[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new r1_242: seed;
              new ts_241: timest;
              let e5: maxmac = enc(pad(C, ts_241), AK_25[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_26[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_25[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new r2_245: seed;
              new ts2_244: timest;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(mAK_26[@i_221], AK_25[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              new ts_246: timest;
              let e5: maxmac = enc(pad(C, ts_246), AK_25[@i_221], r1_247) in
              let mac5: macs = mac(e5, mAK_26[@i_221]) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_221], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_248, =h2)) = dec(m7, AK_25[@i_221]) in
              event fullCT(h, h2, Nt_248, m, e5, m7);
              new r2_250: seed;
              new ts2_249: timest;
              let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kkey[j1], Rkey_599[j1], Kmkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new rmAK_203: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_203) in
                new r3_204: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(rKc, Kc, Rkey_600[j1], Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Z(concat1(AK_25, mAK_26, n, ht)), kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_215) in
                new r3_216: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Z(concat1(AK_25, mAK_26, n, ht)), kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_26[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_142], mac9) then
          let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
          event partTC(hc[@i_142], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_71) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_75) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey_600: key = cst_key in
        let Rmkey_201: mkey = cst_mkey
      else
        let Rkey_599: key = cst_key in
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_132: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying simplify yields

Game 41 is
in(start, ());
new rKc: keyseed;
let Kc: key = cst_key in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKc: mkeyseed;
new rmKs: mkeyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_26[@i_222], AK_25[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new r1_242: seed;
              new ts_241: timest;
              let e5: maxmac = enc(pad(C, ts_241), AK_25[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_26[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_25[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new r2_245: seed;
              new ts2_244: timest;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(mAK_26[@i_221], AK_25[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              new ts_246: timest;
              let e5: maxmac = enc(pad(C, ts_246), AK_25[@i_221], r1_247) in
              let mac5: macs = mac(e5, mAK_26[@i_221]) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_221], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_248, =h2)) = dec(m7, AK_25[@i_221]) in
              event fullCT(h, h2, Nt_248, m, e5, m7);
              new r2_250: seed;
              new ts2_249: timest;
              let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new rmAK_203: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_203) in
                new r3_204: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_215) in
                new r3_216: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_26[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_142], mac9) then
          let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
          event partTC(hc[@i_142], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_71) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_75) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey_600: key = cst_key in
        let Rmkey_201: mkey = cst_mkey
      else
        let Rkey_599: key = cst_key in
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_132: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying move new all binders yields

Game 42 is
in(start, ());
let Kc: key = cst_key in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rKs: keyseed;
new rmKt: mkeyseed;
new rmKs: mkeyseed;
new rmKc: mkeyseed;
new rKc: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_26[@i_222], AK_25[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new ts_241: timest;
              new r1_242: seed;
              let e5: maxmac = enc(pad(C, ts_241), AK_25[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_26[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_25[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new ts2_244: timest;
              new r2_245: seed;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(mAK_26[@i_221], AK_25[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new ts_246: timest;
              new r1_247: seed;
              let e5: maxmac = enc(pad(C, ts_246), AK_25[@i_221], r1_247) in
              let mac5: macs = mac(e5, mAK_26[@i_221]) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_221], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_248, =h2)) = dec(m7, AK_25[@i_221]) in
              event fullCT(h, h2, Nt_248, m, e5, m7);
              new ts2_249: timest;
              new r2_250: seed;
              let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new rmAK_203: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_203) in
                new r3_204: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_215) in
                new r3_216: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_26[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_142], mac9) then
          let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
          event partTC(hc[@i_142], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_71) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_75) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey_600: key = cst_key in
        let Rmkey_201: mkey = cst_mkey
      else
        let Rkey_599: key = cst_key in
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_132: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying remove assignments of useless yields

Game 43 is
in(start, ());
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rKs: keyseed;
new rmKt: mkeyseed;
new rmKs: mkeyseed;
new rmKc: mkeyseed;
new rKc: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_26[@i_222], AK_25[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new ts_241: timest;
              new r1_242: seed;
              let e5: maxmac = enc(pad(C, ts_241), AK_25[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_26[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_25[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new ts2_244: timest;
              new r2_245: seed;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(mAK_26[@i_221], AK_25[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new ts_246: timest;
              new r1_247: seed;
              let e5: maxmac = enc(pad(C, ts_246), AK_25[@i_221], r1_247) in
              let mac5: macs = mac(e5, mAK_26[@i_221]) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_221], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_248, =h2)) = dec(m7, AK_25[@i_221]) in
              event fullCT(h, h2, Nt_248, m, e5, m7);
              new ts2_249: timest;
              new r2_250: seed;
              let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new rmAK_203: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_203) in
                new r3_204: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_215) in
                new r3_216: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_26[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_142], mac9) then
          let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
          event partTC(hc[@i_142], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_71) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_75) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_132: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying SA rename Qkey yields

Game 44 is
in(start, ());
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rKs: keyseed;
new rmKt: mkeyseed;
new rmKs: mkeyseed;
new rmKc: mkeyseed;
new rKc: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_26[@i_222], AK_25[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new ts_241: timest;
              new r1_242: seed;
              let e5: maxmac = enc(pad(C, ts_241), AK_25[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_26[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_25[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new ts2_244: timest;
              new r2_245: seed;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(mAK_26[@i_221], AK_25[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new ts_246: timest;
              new r1_247: seed;
              let e5: maxmac = enc(pad(C, ts_246), AK_25[@i_221], r1_247) in
              let mac5: macs = mac(e5, mAK_26[@i_221]) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_221], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_248, =h2)) = dec(m7, AK_25[@i_221]) in
              event fullCT(h, h2, Nt_248, m, e5, m7);
              new ts2_249: timest;
              new r2_250: seed;
              let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey_802[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new rmAK_203: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_203) in
                new r3_204: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey_802[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey_803[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey_803[j2], r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey_802[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey_802[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey_803[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_215) in
                new r3_216: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey_803[j2], r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_26[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_142], mac9) then
          let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
          event partTC(hc[@i_142], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_71) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_75) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey_803: key = Kt in
      let Qmkey_132: mkey = cst_mkey
    else
      let Qkey_802: key = Lkey in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying remove assignments of binder Qkey yields

Game 45 is
in(start, ());
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rKs: keyseed;
new rmKt: mkeyseed;
new rmKs: mkeyseed;
new rmKc: mkeyseed;
new rKc: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_26[@i_222], AK_25[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new ts_241: timest;
              new r1_242: seed;
              let e5: maxmac = enc(pad(C, ts_241), AK_25[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_26[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_25[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new ts2_244: timest;
              new r2_245: seed;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(mAK_26[@i_221], AK_25[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new ts_246: timest;
              new r1_247: seed;
              let e5: maxmac = enc(pad(C, ts_246), AK_25[@i_221], r1_247) in
              let mac5: macs = mac(e5, mAK_26[@i_221]) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_221], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_248, =h2)) = dec(m7, AK_25[@i_221]) in
              event fullCT(h, h2, Nt_248, m, e5, m7);
              new ts2_249: timest;
              new r2_250: seed;
              let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lkey[j2], Qkey_802[j2], Lmkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new rmAK_203: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_203) in
                new r3_204: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Kt, Qkey_803[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Kt, r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lkey[j2], Qkey_802[j2], Lmkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Kt, Qkey_803[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_215) in
                new r3_216: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Kt, r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_26[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_142], mac9) then
          let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
          event partTC(hc[@i_142], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_71) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_75) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey_803: key = cst_key in
      let Qmkey_132: mkey = cst_mkey
    else
      let Qkey_802: key = cst_key in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying remove assignments of binder Kt yields

Game 46 is
in(start, ());
new rKt: keyseed;
let Kt: key = cst_key in
new rKs: keyseed;
new rmKt: mkeyseed;
new rmKs: mkeyseed;
new rmKc: mkeyseed;
new rKc: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_26[@i_222], AK_25[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new ts_241: timest;
              new r1_242: seed;
              let e5: maxmac = enc(pad(C, ts_241), AK_25[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_26[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_25[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new ts2_244: timest;
              new r2_245: seed;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(mAK_26[@i_221], AK_25[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new ts_246: timest;
              new r1_247: seed;
              let e5: maxmac = enc(pad(C, ts_246), AK_25[@i_221], r1_247) in
              let mac5: macs = mac(e5, mAK_26[@i_221]) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_221], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_248, =h2)) = dec(m7, AK_25[@i_221]) in
              event fullCT(h, h2, Nt_248, m, e5, m7);
              new ts2_249: timest;
              new r2_250: seed;
              let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lkey[j2], Qkey_802[j2], Lmkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new rmAK_203: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_203) in
                new r3_204: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(rKt, Kt, Qkey_803[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), kgen(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lkey[j2], Qkey_802[j2], Lmkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(rKt, Kt, Qkey_803[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_215) in
                new r3_216: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), kgen(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_26[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_142], mac9) then
          let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
          event partTC(hc[@i_142], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_71) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_75) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey_803: key = cst_key in
      let Qmkey_132: mkey = cst_mkey
    else
      let Qkey_802: key = cst_key in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r3_216 [Difference of probability Penc(time + time(context for game 46), N)] yields

Game 47 is
in(start, ());
new rKt: keyseed;
let Kt: key = cst_key in
new rKs: keyseed;
new rmKt: mkeyseed;
new rmKs: mkeyseed;
new rmKc: mkeyseed;
new rKc: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_26[@i_222], AK_25[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new ts_241: timest;
              new r1_242: seed;
              let e5: maxmac = enc(pad(C, ts_241), AK_25[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_26[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_25[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new ts2_244: timest;
              new r2_245: seed;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(mAK_26[@i_221], AK_25[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new ts_246: timest;
              new r1_247: seed;
              let e5: maxmac = enc(pad(C, ts_246), AK_25[@i_221], r1_247) in
              let mac5: macs = mac(e5, mAK_26[@i_221]) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_221], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_248, =h2)) = dec(m7, AK_25[@i_221]) in
              event fullCT(h, h2, Nt_248, m, e5, m7);
              new ts2_249: timest;
              new r2_250: seed;
              let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lkey[j2], Qkey_802[j2], Lmkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new rmAK_203: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_203) in
                new r3_204: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(rKt, Kt, Qkey_803[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Z(concat2(AK_25, mAK_26, hc)), kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lkey[j2], Qkey_802[j2], Lmkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(rKt, Kt, Qkey_803[j2], Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_215) in
                new r3_216: seed;
                let e3: maxmac = enc2(Z(concat2(AK_25, mAK_26, hc)), kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_26[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_142], mac9) then
          let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
          event partTC(hc[@i_142], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_71) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_75) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey_803: key = cst_key in
      let Qmkey_132: mkey = cst_mkey
    else
      let Qkey_802: key = cst_key in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying simplify yields

Game 48 is
in(start, ());
new rKt: keyseed;
let Kt: key = cst_key in
new rKs: keyseed;
new rmKt: mkeyseed;
new rmKs: mkeyseed;
new rmKc: mkeyseed;
new rKc: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_26[@i_222], AK_25[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new ts_241: timest;
              new r1_242: seed;
              let e5: maxmac = enc(pad(C, ts_241), AK_25[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_26[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_25[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new ts2_244: timest;
              new r2_245: seed;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(mAK_26[@i_221], AK_25[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new ts_246: timest;
              new r1_247: seed;
              let e5: maxmac = enc(pad(C, ts_246), AK_25[@i_221], r1_247) in
              let mac5: macs = mac(e5, mAK_26[@i_221]) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_221], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_248, =h2)) = dec(m7, AK_25[@i_221]) in
              event fullCT(h, h2, Nt_248, m, e5, m7);
              new ts2_249: timest;
              new r2_250: seed;
              let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new rmAK_203: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_203) in
                new r3_204: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_215) in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_26[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_142], mac9) then
          let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
          event partTC(hc[@i_142], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_71) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_75) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey_803: key = cst_key in
      let Qmkey_132: mkey = cst_mkey
    else
      let Qkey_802: key = cst_key in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying move new all binders yields

Game 49 is
in(start, ());
let Kt: key = cst_key in
new rKc: keyseed;
new rmKc: mkeyseed;
new rmKs: mkeyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rKt: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_26[@i_222], AK_25[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new r1_242: seed;
              new ts_241: timest;
              let e5: maxmac = enc(pad(C, ts_241), AK_25[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_26[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_25[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new r2_245: seed;
              new ts2_244: timest;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(mAK_26[@i_221], AK_25[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              new ts_246: timest;
              let e5: maxmac = enc(pad(C, ts_246), AK_25[@i_221], r1_247) in
              let mac5: macs = mac(e5, mAK_26[@i_221]) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_221], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_248, =h2)) = dec(m7, AK_25[@i_221]) in
              event fullCT(h, h2, Nt_248, m, e5, m7);
              new r2_250: seed;
              new ts2_249: timest;
              let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new rmAK_203: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_203) in
                new r3_204: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_215) in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_26[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_142], mac9) then
          let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
          event partTC(hc[@i_142], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_71) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_75) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey_803: key = cst_key in
      let Qmkey_132: mkey = cst_mkey
    else
      let Qkey_802: key = cst_key in
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying remove assignments of useless yields

Game 50 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rmKs: mkeyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rKt: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_26[@i_222], AK_25[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new r1_242: seed;
              new ts_241: timest;
              let e5: maxmac = enc(pad(C, ts_241), AK_25[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_26[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_25[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new r2_245: seed;
              new ts2_244: timest;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(mAK_26[@i_221], AK_25[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              new ts_246: timest;
              let e5: maxmac = enc(pad(C, ts_246), AK_25[@i_221], r1_247) in
              let mac5: macs = mac(e5, mAK_26[@i_221]) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_221], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_248, =h2)) = dec(m7, AK_25[@i_221]) in
              event fullCT(h, h2, Nt_248, m, e5, m7);
              new r2_250: seed;
              new ts2_249: timest;
              let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new rmAK_203: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_203) in
                new r3_204: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_215) in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_26[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_142], mac9) then
          let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
          event partTC(hc[@i_142], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_71) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_75) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_132: mkey = cst_mkey
    else
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying remove assignments of binder mAK_26 yields

Game 51 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rmKs: mkeyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rKt: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_26[@i_222], AK_25[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new r1_242: seed;
              new ts_241: timest;
              let e5: maxmac = enc(pad(C, ts_241), AK_25[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_26[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_25[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new r2_245: seed;
              new ts2_244: timest;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(mAK_26[@i_221], AK_25[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              new ts_246: timest;
              let e5: maxmac = enc(pad(C, ts_246), AK_25[@i_221], r1_247) in
              let mac5: macs = mac(e5, mAK_26[@i_221]) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_221], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_248, =h2)) = dec(m7, AK_25[@i_221]) in
              event fullCT(h, h2, Nt_248, m, e5, m7);
              new r2_250: seed;
              new ts2_249: timest;
              let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new rmAK_203: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_203) in
                new r3_204: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_203), hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_203), n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_207), n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_211), hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_215) in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_26[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_142], mac9) then
          let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
          event partTC(hc[@i_142], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_68: keyseed;
            let SK_23: key = kgen(rSK_68) in
            new rmSK_69: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_69) in
            new r10_70: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_70) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_71: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_71) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
            new rSK_72: keyseed;
            let SK_23: key = kgen(rSK_72) in
            new rmSK_73: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_73) in
            new r10_74: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_74) in
            let x_76: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_75: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_75) in
            let mac11: macs = mac(e11, mAK_26[@i_142]) in
            event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_132: mkey = cst_mkey
    else
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying SA rename mAK_26 yields

Game 52 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rmKs: mkeyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rKt: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_880[@i_222], AK_25[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new r1_242: seed;
              new ts_241: timest;
              let e5: maxmac = enc(pad(C, ts_241), AK_25[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_880[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_880[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_25[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new r2_245: seed;
              new ts2_244: timest;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(mAK_881[@i_221], AK_25[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              new ts_246: timest;
              let e5: maxmac = enc(pad(C, ts_246), AK_25[@i_221], r1_247) in
              let mac5: macs = mac(e5, mAK_881[@i_221]) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_881[@i_221], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_248, =h2)) = dec(m7, AK_25[@i_221]) in
              event fullCT(h, h2, Nt_248, m, e5, m7);
              new r2_250: seed;
              new ts2_249: timest;
              let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new rmAK_203: mkeyseed;
                let mAK_878: mkey = mkgen(rmAK_203) in
                new r3_204: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_203), hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_203), n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_879: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_207), n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_880: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_211), hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_881: mkey = mkgen(rmAK_215) in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_879[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_879[@i_142], mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_68: keyseed;
              let SK_23: key = kgen(rSK_68) in
              new rmSK_69: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_69) in
              new r10_70: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_70) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_71: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_71) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_72: keyseed;
              let SK_23: key = kgen(rSK_72) in
              new rmSK_73: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_73) in
              new r10_74: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_74) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_75: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_75) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_881[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_881[@i_142], mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_68: keyseed;
              let SK_23: key = kgen(rSK_68) in
              new rmSK_69: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_69) in
              new r10_70: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_70) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_71: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_71) in
              let mac11: macs = mac(e11, mAK_881[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_72: keyseed;
              let SK_23: key = kgen(rSK_72) in
              new rmSK_73: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_73) in
              new r10_74: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_74) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_75: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_75) in
              let mac11: macs = mac(e11, mAK_881[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_132: mkey = cst_mkey
    else
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying remove assignments of binder mAK_26 yields

Game 53 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rmKs: mkeyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rKt: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_880[@i_222], AK_25[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new r1_242: seed;
              new ts_241: timest;
              let e5: maxmac = enc(pad(C, ts_241), AK_25[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_880[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_880[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_25[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new r2_245: seed;
              new ts2_244: timest;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(mAK_881[@i_221], AK_25[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              new ts_246: timest;
              let e5: maxmac = enc(pad(C, ts_246), AK_25[@i_221], r1_247) in
              let mac5: macs = mac(e5, mAK_881[@i_221]) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_881[@i_221], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_248, =h2)) = dec(m7, AK_25[@i_221]) in
              event fullCT(h, h2, Nt_248, m, e5, m7);
              new r2_250: seed;
              new ts2_249: timest;
              let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new rmAK_203: mkeyseed;
                new r3_204: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_203), hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_203), n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_879: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_207), n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_880: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_211), hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_881: mkey = mkgen(rmAK_215) in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_879[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_879[@i_142], mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_882: keyseed;
              let SK_23: key = kgen(rSK_882) in
              new rmSK_883: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_883) in
              new r10_884: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_884) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_885: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_885) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_886: keyseed;
              let SK_23: key = kgen(rSK_886) in
              new rmSK_887: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_887) in
              new r10_888: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_888) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_889: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_889) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_881[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_881[@i_142], mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_890: keyseed;
              let SK_23: key = kgen(rSK_890) in
              new rmSK_891: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_891) in
              new r10_892: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_892) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_893: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_893) in
              let mac11: macs = mac(e11, mAK_881[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_894: keyseed;
              let SK_23: key = kgen(rSK_894) in
              new rmSK_895: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_895) in
              new r10_896: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_896) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_897: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_897) in
              let mac11: macs = mac(e11, mAK_881[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_132: mkey = cst_mkey
    else
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying remove assignments of binder mAK_881 yields

Game 54 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rmKs: mkeyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rKt: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_880[@i_222], AK_25[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new r1_242: seed;
              new ts_241: timest;
              let e5: maxmac = enc(pad(C, ts_241), AK_25[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_880[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_880[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_25[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new r2_245: seed;
              new ts2_244: timest;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(rmAK_215[@i_221], mAK_881[@i_221], AK_25[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              new ts_246: timest;
              let e5: maxmac = enc(pad(C, ts_246), AK_25[@i_221], r1_247) in
              let mac5: macs = mac(e5, mkgen(rmAK_215[@i_221])) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_215[@i_221]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_248, =h2)) = dec(m7, AK_25[@i_221]) in
              event fullCT(h, h2, Nt_248, m, e5, m7);
              new r2_250: seed;
              new ts2_249: timest;
              let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new rmAK_203: mkeyseed;
                new r3_204: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_203), hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_203), n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_879: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_207), n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_880: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_211), hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_881: mkey = cst_mkey in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_879[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_879[@i_142], mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_882: keyseed;
              let SK_23: key = kgen(rSK_882) in
              new rmSK_883: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_883) in
              new r10_884: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_884) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_885: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_885) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_886: keyseed;
              let SK_23: key = kgen(rSK_886) in
              new rmSK_887: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_887) in
              new r10_888: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_888) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_889: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_889) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind @i_142 <= N suchthat defined(rmAK_215[@i_142], mAK_881[@i_142], AK_25[@i_142], hc[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_215[@i_142]), mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_890: keyseed;
              let SK_23: key = kgen(rSK_890) in
              new rmSK_891: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_891) in
              new r10_892: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_892) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_893: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_893) in
              let mac11: macs = mac(e11, mkgen(rmAK_215[@i_142])) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_894: keyseed;
              let SK_23: key = kgen(rSK_894) in
              new rmSK_895: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_895) in
              new r10_896: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_896) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_897: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_897) in
              let mac11: macs = mac(e11, mkgen(rmAK_215[@i_142])) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_132: mkey = cst_mkey
    else
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK_215 [Difference of probability N * Pmac(time + time(context for game 54), 2. * N, 2. * N)] yields

Game 55 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rmKs: mkeyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rKt: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_880[@i_222], AK_25[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new r1_242: seed;
              new ts_241: timest;
              let e5: maxmac = enc(pad(C, ts_241), AK_25[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_880[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_880[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_25[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new r2_245: seed;
              new ts2_244: timest;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(rmAK_215[@i_221], mAK_881[@i_221], AK_25[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              new ts_246: timest;
              let e5: maxmac = enc(pad(C, ts_246), AK_25[@i_221], r1_247) in
              let x_900: maxmac = e5 in
              let mac5: macs = mac2(x_900, mkgen2(rmAK_215[@i_221])) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_910 <= N suchthat defined(x_898[@i_910]) && ((@i_142[@i_910] = @i_221) && ((m7 = x_898[@i_910]) && check2(x_898[@i_910], mkgen2(rmAK_215[@i_221]), mac7))) then
                if true then
                let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_248, =h2)) = dec(m7, AK_25[@i_221]) in
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new r2_250: seed;
                new ts2_249: timest;
                let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
                let mac12: macs = mac(e12, mSK_30) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_30, mac13) then
                if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_909 <= N suchthat defined(x_899[@i_909]) && ((@i_142[@i_909] = @i_221) && ((m7 = x_899[@i_909]) && check2(x_899[@i_909], mkgen2(rmAK_215[@i_221]), mac7))) then
                if true then
                let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_248, =h2)) = dec(m7, AK_25[@i_221]) in
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new r2_250: seed;
                new ts2_249: timest;
                let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
                let mac12: macs = mac(e12, mSK_30) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_30, mac13) then
                if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_906 <= N suchthat defined(x_900[@i_906]) && ((@i_221[@i_906] = @i_221) && ((m7 = x_900[@i_906]) && check2(x_900[@i_906], mkgen2(rmAK_215[@i_221]), mac7))) then
                if true then
                let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_248, =h2)) = dec(m7, AK_25[@i_221]) in
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new r2_250: seed;
                new ts2_249: timest;
                let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
                let mac12: macs = mac(e12, mSK_30) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_30, mac13) then
                if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              else
                if false then
                let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_248, =h2)) = dec(m7, AK_25[@i_221]) in
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new r2_250: seed;
                new ts2_249: timest;
                let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
                let mac12: macs = mac(e12, mSK_30) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_30, mac13) then
                if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new rmAK_203: mkeyseed;
                new r3_204: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_203), hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_203), n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_879: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_207), n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_880: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_211), hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_881: mkey = cst_mkey in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_879[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_879[@i_142], mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_882: keyseed;
              let SK_23: key = kgen(rSK_882) in
              new rmSK_883: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_883) in
              new r10_884: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_884) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_885: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_885) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_886: keyseed;
              let SK_23: key = kgen(rSK_886) in
              new rmSK_887: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_887) in
              new r10_888: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_888) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_889: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_889) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind @i_142 <= N suchthat defined(rmAK_215[@i_142], mAK_881[@i_142], AK_25[@i_142], hc[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            find @i_905 <= N suchthat defined(x_898[@i_905]) && ((@i_142[@i_905] = @i_142) && ((m9 = x_898[@i_905]) && check2(x_898[@i_905], mkgen2(rmAK_215[@i_142]), mac9))) then
              if true then
              let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
              event partTC(hc[@i_142], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_890: keyseed;
                let SK_23: key = kgen(rSK_890) in
                new rmSK_891: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_891) in
                new r10_892: seed;
                let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_892) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_893: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_893) in
                let x_898: maxmac = e11 in
                let mac11: macs = mac2(x_898, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
                new rSK_894: keyseed;
                let SK_23: key = kgen(rSK_894) in
                new rmSK_895: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_895) in
                new r10_896: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_896) in
                let x_76: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_897: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_897) in
                let x_899: maxmac = e11 in
                let mac11: macs = mac2(x_899, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind @i_904 <= N suchthat defined(x_899[@i_904]) && ((@i_142[@i_904] = @i_142) && ((m9 = x_899[@i_904]) && check2(x_899[@i_904], mkgen2(rmAK_215[@i_142]), mac9))) then
              if true then
              let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
              event partTC(hc[@i_142], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_890: keyseed;
                let SK_23: key = kgen(rSK_890) in
                new rmSK_891: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_891) in
                new r10_892: seed;
                let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_892) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_893: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_893) in
                let x_898: maxmac = e11 in
                let mac11: macs = mac2(x_898, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
                new rSK_894: keyseed;
                let SK_23: key = kgen(rSK_894) in
                new rmSK_895: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_895) in
                new r10_896: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_896) in
                let x_76: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_897: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_897) in
                let x_899: maxmac = e11 in
                let mac11: macs = mac2(x_899, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind @i_901 <= N suchthat defined(x_900[@i_901]) && ((@i_221[@i_901] = @i_142) && ((m9 = x_900[@i_901]) && check2(x_900[@i_901], mkgen2(rmAK_215[@i_142]), mac9))) then
              if true then
              let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
              event partTC(hc[@i_142], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_890: keyseed;
                let SK_23: key = kgen(rSK_890) in
                new rmSK_891: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_891) in
                new r10_892: seed;
                let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_892) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_893: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_893) in
                let x_898: maxmac = e11 in
                let mac11: macs = mac2(x_898, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
                new rSK_894: keyseed;
                let SK_23: key = kgen(rSK_894) in
                new rmSK_895: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_895) in
                new r10_896: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_896) in
                let x_76: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_897: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_897) in
                let x_899: maxmac = e11 in
                let mac11: macs = mac2(x_899, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            else
              if false then
              let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
              event partTC(hc[@i_142], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_890: keyseed;
                let SK_23: key = kgen(rSK_890) in
                new rmSK_891: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_891) in
                new r10_892: seed;
                let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_892) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_893: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_893) in
                let x_898: maxmac = e11 in
                let mac11: macs = mac2(x_898, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
                new rSK_894: keyseed;
                let SK_23: key = kgen(rSK_894) in
                new rmSK_895: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_895) in
                new r10_896: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_896) in
                let x_76: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_897: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_897) in
                let x_899: maxmac = e11 in
                let mac11: macs = mac2(x_899, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_132: mkey = cst_mkey
    else
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying simplify [Difference of probability N / |nonce| + 0.5 * N * N / |nonce|] yields

Game 56 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rmKs: mkeyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rKt: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_880[@i_222], AK_25[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new r1_242: seed;
              new ts_241: timest;
              let e5: maxmac = enc(pad(C, ts_241), AK_25[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_880[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_880[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_25[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new r2_245: seed;
              new ts2_244: timest;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(rmAK_215[@i_221], AK_25[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              new ts_246: timest;
              let e5: maxmac = enc(pad(C, ts_246), AK_25[@i_221], r1_247) in
              let x_900: maxmac = e5 in
              let mac5: macs = mac2(x_900, mkgen2(rmAK_215[@i_221])) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_910 <= N suchthat defined(h3[@i_910], n2[@i_910], mSK_24[@i_910], SK_23[@i_910], x_898[@i_910], @i_142[@i_910]) && ((@i_142[@i_910] = @i_221) && ((m7 = x_898[@i_910]) && check2(x_898[@i_910], mkgen2(rmAK_215[@i_221]), mac7))) then
                let SK_31: key = SK_23[@i_910] in
                let mSK_30: mkey = mSK_24[@i_910] in
                if (Nt_248 = n2[@i_910]) then
                if (h2 = h3[@i_910]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new r2_250: seed;
                new ts2_249: timest;
                let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
                let mac12: macs = mac(e12, mSK_30) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_30, mac13) then
                if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_909 <= N suchthat defined(h3[@i_909], n2[@i_909], mSK_24[@i_909], SK_23[@i_909], x_899[@i_909], @i_142[@i_909]) && ((@i_142[@i_909] = @i_221) && ((m7 = x_899[@i_909]) && check2(x_899[@i_909], mkgen2(rmAK_215[@i_221]), mac7))) then
                let SK_31: key = SK_23[@i_909] in
                let mSK_30: mkey = mSK_24[@i_909] in
                if (Nt_248 = n2[@i_909]) then
                if (h2 = h3[@i_909]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new r2_250: seed;
                new ts2_249: timest;
                let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
                let mac12: macs = mac(e12, mSK_30) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_30, mac13) then
                if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_215[@i_221]) && ((m7 = x_900) && check2(x_900, mkgen2(rmAK_215[@i_221]), mac7)) then
                let @i_906 <= N = !_11
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new rmAK_203: mkeyseed;
                new r3_204: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_203), hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_203), n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_879: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_207), n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_880: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_211), hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_881: mkey = cst_mkey in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_879[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_879[@i_142], mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_882: keyseed;
              let SK_23: key = kgen(rSK_882) in
              new rmSK_883: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_883) in
              new r10_884: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_884) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_885: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_885) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_886: keyseed;
              let SK_23: key = kgen(rSK_886) in
              new rmSK_887: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_887) in
              new r10_888: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_888) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_889: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_889) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], rmAK_215[@i_142], e3[@i_142], mAK_881[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            find @i_905 <= N suchthat defined(x_898[@i_905], @i_142[@i_905]) && ((@i_142[@i_905] = @i_142) && ((m9 = x_898[@i_905]) && check2(x_898[@i_905], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_904 <= N suchthat defined(x_899[@i_904], @i_142[@i_904]) && ((@i_142[@i_904] = @i_142) && ((m9 = x_899[@i_904]) && check2(x_899[@i_904], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_901 <= N suchthat defined(ts_246[@i_901], x_900[@i_901], @i_221[@i_901]) && ((@i_221[@i_901] = @i_142) && ((m9 = x_900[@i_901]) && check2(x_900[@i_901], mkgen2(rmAK_215[@i_142]), mac9))) then
              let ts_22: timest = ts_246[@i_901] in
              event partTC(hc[@i_142], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_890: keyseed;
                let SK_23: key = kgen(rSK_890) in
                new rmSK_891: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_891) in
                new r10_892: seed;
                let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_892) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_893: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_893) in
                let x_898: maxmac = e11 in
                let mac11: macs = mac2(x_898, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
                new rSK_894: keyseed;
                let SK_23: key = kgen(rSK_894) in
                new rmSK_895: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_895) in
                new r10_896: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_896) in
                let x_76: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_897: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_897) in
                let x_899: maxmac = e11 in
                let mac11: macs = mac2(x_899, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_132: mkey = cst_mkey
    else
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying move new all binders yields

Game 57 is
in(start, ());
new rKt: keyseed;
new rKs: keyseed;
new rmKt: mkeyseed;
new rmKs: mkeyseed;
new rmKc: mkeyseed;
new rKc: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_880[@i_222], AK_25[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new ts_241: timest;
              new r1_242: seed;
              let e5: maxmac = enc(pad(C, ts_241), AK_25[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_880[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_880[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_25[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new ts2_244: timest;
              new r2_245: seed;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(rmAK_215[@i_221], AK_25[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new ts_246: timest;
              new r1_247: seed;
              let e5: maxmac = enc(pad(C, ts_246), AK_25[@i_221], r1_247) in
              let x_900: maxmac = e5 in
              let mac5: macs = mac2(x_900, mkgen2(rmAK_215[@i_221])) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_910 <= N suchthat defined(h3[@i_910], n2[@i_910], mSK_24[@i_910], SK_23[@i_910], x_898[@i_910], @i_142[@i_910]) && ((@i_142[@i_910] = @i_221) && ((m7 = x_898[@i_910]) && check2(x_898[@i_910], mkgen2(rmAK_215[@i_221]), mac7))) then
                let SK_31: key = SK_23[@i_910] in
                let mSK_30: mkey = mSK_24[@i_910] in
                if (Nt_248 = n2[@i_910]) then
                if (h2 = h3[@i_910]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new ts2_249: timest;
                new r2_250: seed;
                let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
                let mac12: macs = mac(e12, mSK_30) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_30, mac13) then
                if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_909 <= N suchthat defined(h3[@i_909], n2[@i_909], mSK_24[@i_909], SK_23[@i_909], x_899[@i_909], @i_142[@i_909]) && ((@i_142[@i_909] = @i_221) && ((m7 = x_899[@i_909]) && check2(x_899[@i_909], mkgen2(rmAK_215[@i_221]), mac7))) then
                let SK_31: key = SK_23[@i_909] in
                let mSK_30: mkey = mSK_24[@i_909] in
                if (Nt_248 = n2[@i_909]) then
                if (h2 = h3[@i_909]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new ts2_249: timest;
                new r2_250: seed;
                let e12: maxmac = enc(pad(C, ts2_249), SK_31, r2_250) in
                let mac12: macs = mac(e12, mSK_30) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_30, mac13) then
                if (injbot(padts(ts2_249)) = dec(m13, SK_31)) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_215[@i_221]) && ((m7 = x_900) && check2(x_900, mkgen2(rmAK_215[@i_221]), mac7)) then
                let @i_906 <= N = !_11
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new r3_204: seed;
                new rmAK_203: mkeyseed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_203), hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_203), n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_879: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_207), n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_880: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_211), hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_881: mkey = cst_mkey in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_879[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_879[@i_142], mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_882: keyseed;
              let SK_23: key = kgen(rSK_882) in
              new rmSK_883: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_883) in
              new r10_884: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_884) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_885: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_885) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_886: keyseed;
              let SK_23: key = kgen(rSK_886) in
              new rmSK_887: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_887) in
              new r10_888: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_888) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_889: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_889) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], rmAK_215[@i_142], e3[@i_142], mAK_881[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            find @i_905 <= N suchthat defined(x_898[@i_905], @i_142[@i_905]) && ((@i_142[@i_905] = @i_142) && ((m9 = x_898[@i_905]) && check2(x_898[@i_905], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_904 <= N suchthat defined(x_899[@i_904], @i_142[@i_904]) && ((@i_142[@i_904] = @i_142) && ((m9 = x_899[@i_904]) && check2(x_899[@i_904], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_901 <= N suchthat defined(ts_246[@i_901], x_900[@i_901], @i_221[@i_901]) && ((@i_221[@i_901] = @i_142) && ((m9 = x_900[@i_901]) && check2(x_900[@i_901], mkgen2(rmAK_215[@i_142]), mac9))) then
              let ts_22: timest = ts_246[@i_901] in
              event partTC(hc[@i_142], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_890: keyseed;
                let SK_23: key = kgen(rSK_890) in
                new rmSK_891: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_891) in
                new r10_892: seed;
                let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_892) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_893: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_893) in
                let x_898: maxmac = e11 in
                let mac11: macs = mac2(x_898, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
                new rSK_894: keyseed;
                let SK_23: key = kgen(rSK_894) in
                new rmSK_895: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_895) in
                new r10_896: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_896) in
                let x_76: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_897: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_897) in
                let x_899: maxmac = e11 in
                let mac11: macs = mac2(x_899, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_132: mkey = cst_mkey
    else
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying remove assignments of useless yields

Game 58 is
in(start, ());
new rKt: keyseed;
new rKs: keyseed;
new rmKt: mkeyseed;
new rmKs: mkeyseed;
new rmKc: mkeyseed;
new rKc: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_880[@i_222], AK_25[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new ts_241: timest;
              new r1_242: seed;
              let e5: maxmac = enc(pad(C, ts_241), AK_25[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_880[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_880[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_25[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new ts2_244: timest;
              new r2_245: seed;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(rmAK_215[@i_221], AK_25[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new ts_246: timest;
              new r1_247: seed;
              let e5: maxmac = enc(pad(C, ts_246), AK_25[@i_221], r1_247) in
              let x_900: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_215[@i_221])) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_910 <= N suchthat defined(e11[@i_910], x_898[@i_910], h3[@i_910], n2[@i_910], mSK_24[@i_910], SK_23[@i_910], @i_142[@i_910]) && ((@i_142[@i_910] = @i_221) && ((m7 = e11[@i_910]) && check2(e11[@i_910], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_910]) then
                if (h2 = h3[@i_910]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new ts2_951: timest;
                new r2_952: seed;
                let e12: maxmac = enc(pad(C, ts2_951), SK_23[@i_910], r2_952) in
                let mac12: macs = mac(e12, mSK_24[@i_910]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_910], mac13) then
                if (injbot(padts(ts2_951)) = dec(m13, SK_23[@i_910])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_909 <= N suchthat defined(e11[@i_909], x_899[@i_909], h3[@i_909], n2[@i_909], mSK_24[@i_909], SK_23[@i_909], @i_142[@i_909]) && ((@i_142[@i_909] = @i_221) && ((m7 = e11[@i_909]) && check2(e11[@i_909], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_909]) then
                if (h2 = h3[@i_909]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new ts2_953: timest;
                new r2_954: seed;
                let e12: maxmac = enc(pad(C, ts2_953), SK_23[@i_909], r2_954) in
                let mac12: macs = mac(e12, mSK_24[@i_909]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_909], mac13) then
                if (injbot(padts(ts2_953)) = dec(m13, SK_23[@i_909])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_215[@i_221]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_215[@i_221]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new r3_204: seed;
                new rmAK_203: mkeyseed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_203), hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_203), n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_879: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_207), n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_880: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_211), hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_881: mkey = cst_mkey in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_879[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_879[@i_142], mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_882: keyseed;
              let SK_23: key = kgen(rSK_882) in
              new rmSK_883: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_883) in
              new r10_884: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_884) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_885: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_885) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_886: keyseed;
              let SK_23: key = kgen(rSK_886) in
              new rmSK_887: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_887) in
              new r10_888: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_888) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_889: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_889) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], rmAK_215[@i_142], e3[@i_142], mAK_881[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            find @i_905 <= N suchthat defined(e11[@i_905], x_898[@i_905], @i_142[@i_905]) && ((@i_142[@i_905] = @i_142) && ((m9 = e11[@i_905]) && check2(e11[@i_905], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_904 <= N suchthat defined(e11[@i_904], x_899[@i_904], @i_142[@i_904]) && ((@i_142[@i_904] = @i_142) && ((m9 = e11[@i_904]) && check2(e11[@i_904], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_901 <= N suchthat defined(e5[@i_901], x_900[@i_901], ts_246[@i_901], @i_221[@i_901]) && ((@i_221[@i_901] = @i_142) && ((m9 = e5[@i_901]) && check2(e5[@i_901], mkgen2(rmAK_215[@i_142]), mac9))) then
              event partTC(hc[@i_142], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_890: keyseed;
                let SK_23: key = kgen(rSK_890) in
                new rmSK_891: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_891) in
                new r10_892: seed;
                let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_892) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_893: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_893) in
                let x_898: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
                new rSK_894: keyseed;
                let SK_23: key = kgen(rSK_894) in
                new rmSK_895: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_895) in
                new r10_896: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_896) in
                let x_76: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_897: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_897) in
                let x_899: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_132: mkey = cst_mkey
    else
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


RESULT Proved event inj:fullCT(T, S, N, x, z, y) ==> inj:fullTC(C, S, N, x', z, y) with probability N * N / |nonce| + N / |nonce| + N * Pmac(time + time(context for game 54), 2. * N, 2. * N) + Penc(time + time(context for game 46), N) + Penc(time + time(context for game 39), N) + Penc(time + time(context for game 32), N) + Pmac(time + time(context for game 24), N, N) + Pmac(time + time(context for game 16), N, N) + Pmac(time + time(context for game 8), N, N)
RESULT Proved event fullCT(T, S, N, x, z, y) ==> (fullTC(C, S, N, x', z, y)&&fullKC(C, T, N', x', w)) with probability 0.5 * N * N / |nonce| + N / |nonce| + N * Pmac(time + time(context for game 54), 2. * N, 2. * N) + Penc(time + time(context for game 46), N) + Penc(time + time(context for game 39), N) + Penc(time + time(context for game 32), N) + Pmac(time + time(context for game 24), N, N) + Pmac(time + time(context for game 16), N, N) + Pmac(time + time(context for game 8), N, N)
RESULT Proved event partTC(C, x, y) ==> (partCT(T, x', y)&&fullKC(C, T, N, x, y')) with probability 0.5 * N * N / |nonce| + N / |nonce| + N * Pmac(time + time(context for game 54), 2. * N, 2. * N) + Penc(time + time(context for game 46), N) + Penc(time + time(context for game 39), N) + Penc(time + time(context for game 32), N) + Pmac(time + time(context for game 24), N, N) + Pmac(time + time(context for game 16), N, N) + Pmac(time + time(context for game 8), N, N)

Applying remove assignments of binder AK_25 yields

Game 60 is
in(start, ());
new rKt: keyseed;
new rKs: keyseed;
new rmKt: mkeyseed;
new rmKs: mkeyseed;
new rmKc: mkeyseed;
new rKc: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_880[@i_222], AK_25[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new ts_241: timest;
              new r1_242: seed;
              let e5: maxmac = enc(pad(C, ts_241), AK_25[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_880[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_880[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_25[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new ts2_244: timest;
              new r2_245: seed;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(rmAK_215[@i_221], AK_25[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new ts_246: timest;
              new r1_247: seed;
              let e5: maxmac = enc(pad(C, ts_246), AK_25[@i_221], r1_247) in
              let x_900: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_215[@i_221])) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_910 <= N suchthat defined(e11[@i_910], x_898[@i_910], h3[@i_910], n2[@i_910], mSK_24[@i_910], SK_23[@i_910], @i_142[@i_910]) && ((@i_142[@i_910] = @i_221) && ((m7 = e11[@i_910]) && check2(e11[@i_910], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_910]) then
                if (h2 = h3[@i_910]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new ts2_951: timest;
                new r2_952: seed;
                let e12: maxmac = enc(pad(C, ts2_951), SK_23[@i_910], r2_952) in
                let mac12: macs = mac(e12, mSK_24[@i_910]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_910], mac13) then
                if (injbot(padts(ts2_951)) = dec(m13, SK_23[@i_910])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_909 <= N suchthat defined(e11[@i_909], x_899[@i_909], h3[@i_909], n2[@i_909], mSK_24[@i_909], SK_23[@i_909], @i_142[@i_909]) && ((@i_142[@i_909] = @i_221) && ((m7 = e11[@i_909]) && check2(e11[@i_909], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_909]) then
                if (h2 = h3[@i_909]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new ts2_953: timest;
                new r2_954: seed;
                let e12: maxmac = enc(pad(C, ts2_953), SK_23[@i_909], r2_954) in
                let mac12: macs = mac(e12, mSK_24[@i_909]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_909], mac13) then
                if (injbot(padts(ts2_953)) = dec(m13, SK_23[@i_909])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_215[@i_221]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_215[@i_221]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_25: key = kgen(rAK_202) in
                new r3_204: seed;
                new rmAK_203: mkeyseed;
                let e3: maxmac = enc(concat2(kgen(rAK_202), mkgen(rmAK_203), hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_202), mkgen(rmAK_203), n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_25: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_879: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_206), mkgen(rmAK_207), n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_25: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_880: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_210), mkgen(rmAK_211), hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_25: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_881: mkey = cst_mkey in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], mAK_879[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_879[@i_142], mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_25[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_882: keyseed;
              let SK_23: key = kgen(rSK_882) in
              new rmSK_883: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_883) in
              new r10_884: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_884) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_885: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_885) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_886: keyseed;
              let SK_23: key = kgen(rSK_886) in
              new rmSK_887: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_887) in
              new r10_888: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_888) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_889: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_889) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind @i_142 <= N suchthat defined(AK_25[@i_142], hc[@i_142], rmAK_215[@i_142], e3[@i_142], mAK_881[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            find @i_905 <= N suchthat defined(e11[@i_905], x_898[@i_905], @i_142[@i_905]) && ((@i_142[@i_905] = @i_142) && ((m9 = e11[@i_905]) && check2(e11[@i_905], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_904 <= N suchthat defined(e11[@i_904], x_899[@i_904], @i_142[@i_904]) && ((@i_142[@i_904] = @i_142) && ((m9 = e11[@i_904]) && check2(e11[@i_904], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_901 <= N suchthat defined(e5[@i_901], x_900[@i_901], ts_246[@i_901], @i_221[@i_901]) && ((@i_221[@i_901] = @i_142) && ((m9 = e5[@i_901]) && check2(e5[@i_901], mkgen2(rmAK_215[@i_142]), mac9))) then
              event partTC(hc[@i_142], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_890: keyseed;
                let SK_23: key = kgen(rSK_890) in
                new rmSK_891: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_891) in
                new r10_892: seed;
                let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_892) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_893: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_893) in
                let x_898: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
                new rSK_894: keyseed;
                let SK_23: key = kgen(rSK_894) in
                new rmSK_895: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_895) in
                new r10_896: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_896) in
                let x_76: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_897: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_142], r11_897) in
                let x_899: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_132: mkey = cst_mkey
    else
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying SA rename AK_25 yields

Game 61 is
in(start, ());
new rKt: keyseed;
new rKs: keyseed;
new rmKt: mkeyseed;
new rmKs: mkeyseed;
new rmKc: mkeyseed;
new rKc: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_880[@i_222], AK_1025[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new ts_241: timest;
              new r1_242: seed;
              let e5: maxmac = enc(pad(C, ts_241), AK_1025[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_880[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_880[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_1025[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new ts2_244: timest;
              new r2_245: seed;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(rmAK_215[@i_221], AK_1026[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new ts_246: timest;
              new r1_247: seed;
              let e5: maxmac = enc(pad(C, ts_246), AK_1026[@i_221], r1_247) in
              let x_900: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_215[@i_221])) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_910 <= N suchthat defined(e11[@i_910], x_898[@i_910], h3[@i_910], n2[@i_910], mSK_24[@i_910], SK_23[@i_910], @i_142[@i_910]) && ((@i_142[@i_910] = @i_221) && ((m7 = e11[@i_910]) && check2(e11[@i_910], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_910]) then
                if (h2 = h3[@i_910]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new ts2_951: timest;
                new r2_952: seed;
                let e12: maxmac = enc(pad(C, ts2_951), SK_23[@i_910], r2_952) in
                let mac12: macs = mac(e12, mSK_24[@i_910]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_910], mac13) then
                if (injbot(padts(ts2_951)) = dec(m13, SK_23[@i_910])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_909 <= N suchthat defined(e11[@i_909], x_899[@i_909], h3[@i_909], n2[@i_909], mSK_24[@i_909], SK_23[@i_909], @i_142[@i_909]) && ((@i_142[@i_909] = @i_221) && ((m7 = e11[@i_909]) && check2(e11[@i_909], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_909]) then
                if (h2 = h3[@i_909]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new ts2_953: timest;
                new r2_954: seed;
                let e12: maxmac = enc(pad(C, ts2_953), SK_23[@i_909], r2_954) in
                let mac12: macs = mac(e12, mSK_24[@i_909]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_909], mac13) then
                if (injbot(padts(ts2_953)) = dec(m13, SK_23[@i_909])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_215[@i_221]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_215[@i_221]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                let AK_1023: key = kgen(rAK_202) in
                new r3_204: seed;
                new rmAK_203: mkeyseed;
                let e3: maxmac = enc(concat2(kgen(rAK_202), mkgen(rmAK_203), hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_202), mkgen(rmAK_203), n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_1024: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_879: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_206), mkgen(rmAK_207), n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_1025: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_880: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_210), mkgen(rmAK_211), hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_1026: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_881: mkey = cst_mkey in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_1024[@i_142], hc[@i_142], mAK_879[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_879[@i_142], mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_1024[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_882: keyseed;
              let SK_23: key = kgen(rSK_882) in
              new rmSK_883: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_883) in
              new r10_884: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_884) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_885: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_1024[@i_142], r11_885) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_886: keyseed;
              let SK_23: key = kgen(rSK_886) in
              new rmSK_887: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_887) in
              new r10_888: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_888) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_889: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_1024[@i_142], r11_889) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind @i_142 <= N suchthat defined(AK_1026[@i_142], hc[@i_142], rmAK_215[@i_142], e3[@i_142], mAK_881[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            find @i_905 <= N suchthat defined(e11[@i_905], x_898[@i_905], @i_142[@i_905]) && ((@i_142[@i_905] = @i_142) && ((m9 = e11[@i_905]) && check2(e11[@i_905], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_904 <= N suchthat defined(e11[@i_904], x_899[@i_904], @i_142[@i_904]) && ((@i_142[@i_904] = @i_142) && ((m9 = e11[@i_904]) && check2(e11[@i_904], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_901 <= N suchthat defined(e5[@i_901], x_900[@i_901], ts_246[@i_901], @i_221[@i_901]) && ((@i_221[@i_901] = @i_142) && ((m9 = e5[@i_901]) && check2(e5[@i_901], mkgen2(rmAK_215[@i_142]), mac9))) then
              event partTC(hc[@i_142], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_890: keyseed;
                let SK_23: key = kgen(rSK_890) in
                new rmSK_891: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_891) in
                new r10_892: seed;
                let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_892) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_893: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_1026[@i_142], r11_893) in
                let x_898: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
                new rSK_894: keyseed;
                let SK_23: key = kgen(rSK_894) in
                new rmSK_895: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_895) in
                new r10_896: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_896) in
                let x_76: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_897: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_1026[@i_142], r11_897) in
                let x_899: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_132: mkey = cst_mkey
    else
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying remove assignments of binder AK_25 yields

Game 62 is
in(start, ());
new rKt: keyseed;
new rKs: keyseed;
new rmKt: mkeyseed;
new rmKs: mkeyseed;
new rmKc: mkeyseed;
new rKc: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_880[@i_222], AK_1025[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new ts_241: timest;
              new r1_242: seed;
              let e5: maxmac = enc(pad(C, ts_241), AK_1025[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_880[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_880[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_1025[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new ts2_244: timest;
              new r2_245: seed;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(rmAK_215[@i_221], AK_1026[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new ts_246: timest;
              new r1_247: seed;
              let e5: maxmac = enc(pad(C, ts_246), AK_1026[@i_221], r1_247) in
              let x_900: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_215[@i_221])) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_910 <= N suchthat defined(e11[@i_910], x_898[@i_910], h3[@i_910], n2[@i_910], mSK_24[@i_910], SK_23[@i_910], @i_142[@i_910]) && ((@i_142[@i_910] = @i_221) && ((m7 = e11[@i_910]) && check2(e11[@i_910], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_910]) then
                if (h2 = h3[@i_910]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new ts2_951: timest;
                new r2_952: seed;
                let e12: maxmac = enc(pad(C, ts2_951), SK_23[@i_910], r2_952) in
                let mac12: macs = mac(e12, mSK_24[@i_910]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_910], mac13) then
                if (injbot(padts(ts2_951)) = dec(m13, SK_23[@i_910])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_909 <= N suchthat defined(e11[@i_909], x_899[@i_909], h3[@i_909], n2[@i_909], mSK_24[@i_909], SK_23[@i_909], @i_142[@i_909]) && ((@i_142[@i_909] = @i_221) && ((m7 = e11[@i_909]) && check2(e11[@i_909], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_909]) then
                if (h2 = h3[@i_909]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new ts2_953: timest;
                new r2_954: seed;
                let e12: maxmac = enc(pad(C, ts2_953), SK_23[@i_909], r2_954) in
                let mac12: macs = mac(e12, mSK_24[@i_909]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_909], mac13) then
                if (injbot(padts(ts2_953)) = dec(m13, SK_23[@i_909])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_215[@i_221]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_215[@i_221]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                new r3_204: seed;
                new rmAK_203: mkeyseed;
                let e3: maxmac = enc(concat2(kgen(rAK_202), mkgen(rmAK_203), hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_202), mkgen(rmAK_203), n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_1024: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_879: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_206), mkgen(rmAK_207), n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_1025: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_880: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_210), mkgen(rmAK_211), hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_1026: key = kgen(rAK_214) in
                new rmAK_215: mkeyseed;
                let mAK_881: mkey = cst_mkey in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_1024[@i_142], hc[@i_142], mAK_879[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_879[@i_142], mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_1024[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_882: keyseed;
              let SK_23: key = kgen(rSK_882) in
              new rmSK_883: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_883) in
              new r10_884: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_884) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_885: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_1024[@i_142], r11_885) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_886: keyseed;
              let SK_23: key = kgen(rSK_886) in
              new rmSK_887: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_887) in
              new r10_888: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_888) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_889: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_1024[@i_142], r11_889) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind @i_142 <= N suchthat defined(AK_1026[@i_142], hc[@i_142], rmAK_215[@i_142], e3[@i_142], mAK_881[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            find @i_905 <= N suchthat defined(e11[@i_905], x_898[@i_905], @i_142[@i_905]) && ((@i_142[@i_905] = @i_142) && ((m9 = e11[@i_905]) && check2(e11[@i_905], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_904 <= N suchthat defined(e11[@i_904], x_899[@i_904], @i_142[@i_904]) && ((@i_142[@i_904] = @i_142) && ((m9 = e11[@i_904]) && check2(e11[@i_904], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_901 <= N suchthat defined(e5[@i_901], x_900[@i_901], ts_246[@i_901], @i_221[@i_901]) && ((@i_221[@i_901] = @i_142) && ((m9 = e5[@i_901]) && check2(e5[@i_901], mkgen2(rmAK_215[@i_142]), mac9))) then
              event partTC(hc[@i_142], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_890: keyseed;
                let SK_23: key = kgen(rSK_890) in
                new rmSK_891: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_891) in
                new r10_892: seed;
                let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_892) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_893: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_1026[@i_142], r11_893) in
                let x_898: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
                new rSK_894: keyseed;
                let SK_23: key = kgen(rSK_894) in
                new rmSK_895: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_895) in
                new r10_896: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_896) in
                let x_76: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_897: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_1026[@i_142], r11_897) in
                let x_899: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_132: mkey = cst_mkey
    else
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying remove assignments of binder AK_1026 yields

Game 63 is
in(start, ());
new rKt: keyseed;
new rKs: keyseed;
new rmKt: mkeyseed;
new rmKs: mkeyseed;
new rmKc: mkeyseed;
new rKc: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_880[@i_222], AK_1025[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new ts_241: timest;
              new r1_242: seed;
              let e5: maxmac = enc(pad(C, ts_241), AK_1025[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_880[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_880[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_1025[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new ts2_244: timest;
              new r2_245: seed;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(rAK_214[@i_221], AK_1026[@i_221], rmAK_215[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new ts_246: timest;
              new r1_247: seed;
              let e5: maxmac = enc(pad(C, ts_246), kgen(rAK_214[@i_221]), r1_247) in
              let x_900: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_215[@i_221])) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_910 <= N suchthat defined(e11[@i_910], x_898[@i_910], h3[@i_910], n2[@i_910], mSK_24[@i_910], SK_23[@i_910], @i_142[@i_910]) && ((@i_142[@i_910] = @i_221) && ((m7 = e11[@i_910]) && check2(e11[@i_910], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_910]) then
                if (h2 = h3[@i_910]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new ts2_951: timest;
                new r2_952: seed;
                let e12: maxmac = enc(pad(C, ts2_951), SK_23[@i_910], r2_952) in
                let mac12: macs = mac(e12, mSK_24[@i_910]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_910], mac13) then
                if (injbot(padts(ts2_951)) = dec(m13, SK_23[@i_910])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_909 <= N suchthat defined(e11[@i_909], x_899[@i_909], h3[@i_909], n2[@i_909], mSK_24[@i_909], SK_23[@i_909], @i_142[@i_909]) && ((@i_142[@i_909] = @i_221) && ((m7 = e11[@i_909]) && check2(e11[@i_909], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_909]) then
                if (h2 = h3[@i_909]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new ts2_953: timest;
                new r2_954: seed;
                let e12: maxmac = enc(pad(C, ts2_953), SK_23[@i_909], r2_954) in
                let mac12: macs = mac(e12, mSK_24[@i_909]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_909], mac13) then
                if (injbot(padts(ts2_953)) = dec(m13, SK_23[@i_909])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_215[@i_221]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_215[@i_221]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                new r3_204: seed;
                new rmAK_203: mkeyseed;
                let e3: maxmac = enc(concat2(kgen(rAK_202), mkgen(rmAK_203), hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_202), mkgen(rmAK_203), n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_1024: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_879: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_206), mkgen(rmAK_207), n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_1025: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_880: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_210), mkgen(rmAK_211), hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_1026: key = cst_key in
                new rmAK_215: mkeyseed;
                let mAK_881: mkey = cst_mkey in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_1024[@i_142], hc[@i_142], mAK_879[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_879[@i_142], mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_1024[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_882: keyseed;
              let SK_23: key = kgen(rSK_882) in
              new rmSK_883: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_883) in
              new r10_884: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_884) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_885: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_1024[@i_142], r11_885) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_886: keyseed;
              let SK_23: key = kgen(rSK_886) in
              new rmSK_887: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_887) in
              new r10_888: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_888) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_889: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_1024[@i_142], r11_889) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind @i_142 <= N suchthat defined(rAK_214[@i_142], AK_1026[@i_142], hc[@i_142], rmAK_215[@i_142], e3[@i_142], mAK_881[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            find @i_905 <= N suchthat defined(e11[@i_905], x_898[@i_905], @i_142[@i_905]) && ((@i_142[@i_905] = @i_142) && ((m9 = e11[@i_905]) && check2(e11[@i_905], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_904 <= N suchthat defined(e11[@i_904], x_899[@i_904], @i_142[@i_904]) && ((@i_142[@i_904] = @i_142) && ((m9 = e11[@i_904]) && check2(e11[@i_904], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_901 <= N suchthat defined(e5[@i_901], x_900[@i_901], ts_246[@i_901], @i_221[@i_901]) && ((@i_221[@i_901] = @i_142) && ((m9 = e5[@i_901]) && check2(e5[@i_901], mkgen2(rmAK_215[@i_142]), mac9))) then
              event partTC(hc[@i_142], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_890: keyseed;
                let SK_23: key = kgen(rSK_890) in
                new rmSK_891: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_891) in
                new r10_892: seed;
                let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_892) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_893: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), kgen(rAK_214[@i_142]), r11_893) in
                let x_898: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
                new rSK_894: keyseed;
                let SK_23: key = kgen(rSK_894) in
                new rmSK_895: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_895) in
                new r10_896: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_896) in
                let x_76: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_897: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), kgen(rAK_214[@i_142]), r11_897) in
                let x_899: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_132: mkey = cst_mkey
    else
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r11_897 [Difference of probability N * Penc(time + time(context for game 63), 2. * N)] yields

Game 64 is
in(start, ());
new rKt: keyseed;
new rKs: keyseed;
new rmKt: mkeyseed;
new rmKs: mkeyseed;
new rmKc: mkeyseed;
new rKc: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_880[@i_222], AK_1025[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new ts_241: timest;
              new r1_242: seed;
              let e5: maxmac = enc(pad(C, ts_241), AK_1025[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_880[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_880[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_1025[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new ts2_244: timest;
              new r2_245: seed;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(rAK_214[@i_221], AK_1026[@i_221], rmAK_215[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new ts_246: timest;
              new r1_247: seed;
              let e5: maxmac = enc2(Z(pad(C, ts_246)), kgen2(rAK_214[@i_221]), r1_247) in
              let x_900: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_215[@i_221])) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_910 <= N suchthat defined(e11[@i_910], x_898[@i_910], h3[@i_910], n2[@i_910], mSK_24[@i_910], SK_23[@i_910], @i_142[@i_910]) && ((@i_142[@i_910] = @i_221) && ((m7 = e11[@i_910]) && check2(e11[@i_910], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_910]) then
                if (h2 = h3[@i_910]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new ts2_951: timest;
                new r2_952: seed;
                let e12: maxmac = enc(pad(C, ts2_951), SK_23[@i_910], r2_952) in
                let mac12: macs = mac(e12, mSK_24[@i_910]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_910], mac13) then
                if (injbot(padts(ts2_951)) = dec(m13, SK_23[@i_910])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_909 <= N suchthat defined(e11[@i_909], x_899[@i_909], h3[@i_909], n2[@i_909], mSK_24[@i_909], SK_23[@i_909], @i_142[@i_909]) && ((@i_142[@i_909] = @i_221) && ((m7 = e11[@i_909]) && check2(e11[@i_909], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_909]) then
                if (h2 = h3[@i_909]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new ts2_953: timest;
                new r2_954: seed;
                let e12: maxmac = enc(pad(C, ts2_953), SK_23[@i_909], r2_954) in
                let mac12: macs = mac(e12, mSK_24[@i_909]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_909], mac13) then
                if (injbot(padts(ts2_953)) = dec(m13, SK_23[@i_909])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_215[@i_221]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_215[@i_221]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                new r3_204: seed;
                new rmAK_203: mkeyseed;
                let e3: maxmac = enc(concat2(kgen(rAK_202), mkgen(rmAK_203), hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_202), mkgen(rmAK_203), n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_1024: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_879: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_206), mkgen(rmAK_207), n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_1025: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_880: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_210), mkgen(rmAK_211), hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_1026: key = cst_key in
                new rmAK_215: mkeyseed;
                let mAK_881: mkey = cst_mkey in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_1024[@i_142], hc[@i_142], mAK_879[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_879[@i_142], mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_1024[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_882: keyseed;
              let SK_23: key = kgen(rSK_882) in
              new rmSK_883: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_883) in
              new r10_884: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_884) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_885: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_1024[@i_142], r11_885) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_886: keyseed;
              let SK_23: key = kgen(rSK_886) in
              new rmSK_887: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_887) in
              new r10_888: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_888) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_889: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_1024[@i_142], r11_889) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind @i_142 <= N suchthat defined(rAK_214[@i_142], AK_1026[@i_142], hc[@i_142], rmAK_215[@i_142], e3[@i_142], mAK_881[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            find @i_905 <= N suchthat defined(e11[@i_905], x_898[@i_905], @i_142[@i_905]) && ((@i_142[@i_905] = @i_142) && ((m9 = e11[@i_905]) && check2(e11[@i_905], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_904 <= N suchthat defined(e11[@i_904], x_899[@i_904], @i_142[@i_904]) && ((@i_142[@i_904] = @i_142) && ((m9 = e11[@i_904]) && check2(e11[@i_904], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_901 <= N suchthat defined(e5[@i_901], x_900[@i_901], ts_246[@i_901], @i_221[@i_901]) && ((@i_221[@i_901] = @i_142) && ((m9 = e5[@i_901]) && check2(e5[@i_901], mkgen2(rmAK_215[@i_142]), mac9))) then
              event partTC(hc[@i_142], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_890: keyseed;
                let SK_23: key = kgen(rSK_890) in
                new rmSK_891: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_891) in
                new r10_892: seed;
                let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_892) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_893: seed;
                let e11: maxmac = enc2(Z(concat3(SK_23, mSK_24, n2, h3)), kgen2(rAK_214[@i_142]), r11_893) in
                let x_898: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
                new rSK_894: keyseed;
                let SK_23: key = kgen(rSK_894) in
                new rmSK_895: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_895) in
                new r10_896: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_896) in
                let x_76: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_897: seed;
                let e11: maxmac = enc2(Z(concat3(SK_23, mSK_24, n2, h3)), kgen2(rAK_214[@i_142]), r11_897) in
                let x_899: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_132: mkey = cst_mkey
    else
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying simplify yields

Game 65 is
in(start, ());
new rKt: keyseed;
new rKs: keyseed;
new rmKt: mkeyseed;
new rmKs: mkeyseed;
new rmKc: mkeyseed;
new rKc: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_880[@i_222], AK_1025[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new ts_241: timest;
              new r1_242: seed;
              let e5: maxmac = enc(pad(C, ts_241), AK_1025[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_880[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_880[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_1025[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new ts2_244: timest;
              new r2_245: seed;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(rmAK_215[@i_221], rAK_214[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_214[@i_221]), r1_247) in
              let x_900: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_215[@i_221])) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_910 <= N suchthat defined(mSK_24[@i_910], SK_23[@i_910], h3[@i_910], n2[@i_910], e11[@i_910], @i_142[@i_910], x_898[@i_910]) && ((@i_142[@i_910] = @i_221) && ((m7 = e11[@i_910]) && check2(e11[@i_910], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_910]) then
                if (h2 = h3[@i_910]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new ts2_951: timest;
                new r2_952: seed;
                let e12: maxmac = enc(pad(C, ts2_951), SK_23[@i_910], r2_952) in
                let mac12: macs = mac(e12, mSK_24[@i_910]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_910], mac13) then
                if (injbot(padts(ts2_951)) = dec(m13, SK_23[@i_910])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_909 <= N suchthat defined(mSK_24[@i_909], SK_23[@i_909], h3[@i_909], n2[@i_909], e11[@i_909], @i_142[@i_909], x_899[@i_909]) && ((@i_142[@i_909] = @i_221) && ((m7 = e11[@i_909]) && check2(e11[@i_909], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_909]) then
                if (h2 = h3[@i_909]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new ts2_953: timest;
                new r2_954: seed;
                let e12: maxmac = enc(pad(C, ts2_953), SK_23[@i_909], r2_954) in
                let mac12: macs = mac(e12, mSK_24[@i_909]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_909], mac13) then
                if (injbot(padts(ts2_953)) = dec(m13, SK_23[@i_909])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_215[@i_221]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_215[@i_221]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                new r3_204: seed;
                new rmAK_203: mkeyseed;
                let e3: maxmac = enc(concat2(kgen(rAK_202), mkgen(rmAK_203), hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_202), mkgen(rmAK_203), n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_1024: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_879: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_206), mkgen(rmAK_207), n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_1025: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_880: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_210), mkgen(rmAK_211), hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_1026: key = cst_key in
                new rmAK_215: mkeyseed;
                let mAK_881: mkey = cst_mkey in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_1024[@i_142], hc[@i_142], mAK_879[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_879[@i_142], mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_1024[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_882: keyseed;
              let SK_23: key = kgen(rSK_882) in
              new rmSK_883: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_883) in
              new r10_884: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_884) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_885: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_1024[@i_142], r11_885) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_886: keyseed;
              let SK_23: key = kgen(rSK_886) in
              new rmSK_887: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_887) in
              new r10_888: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_888) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_889: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_1024[@i_142], r11_889) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind @i_142 <= N suchthat defined(rAK_214[@i_142], hc[@i_142], rmAK_215[@i_142], e3[@i_142], mAK_881[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            find @i_905 <= N suchthat defined(e11[@i_905], @i_142[@i_905], x_898[@i_905]) && ((@i_142[@i_905] = @i_142) && ((m9 = e11[@i_905]) && check2(e11[@i_905], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_904 <= N suchthat defined(e11[@i_904], @i_142[@i_904], x_899[@i_904]) && ((@i_142[@i_904] = @i_142) && ((m9 = e11[@i_904]) && check2(e11[@i_904], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_901 <= N suchthat defined(e5[@i_901], @i_221[@i_901], x_900[@i_901]) && ((@i_221[@i_901] = @i_142) && ((m9 = e5[@i_901]) && check2(e5[@i_901], mkgen2(rmAK_215[@i_142]), mac9))) then
              event partTC(hc[@i_142], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_890: keyseed;
                let SK_23: key = kgen(rSK_890) in
                new rmSK_891: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_891) in
                new r10_892: seed;
                let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_892) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_893: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_893) in
                let x_898: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
                new rSK_894: keyseed;
                let SK_23: key = kgen(rSK_894) in
                new rmSK_895: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_895) in
                new r10_896: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_896) in
                let x_76: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_897: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_897) in
                let x_899: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_132: mkey = cst_mkey
    else
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying move new all binders yields

Game 66 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rmKs: mkeyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rKt: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_880[@i_222], AK_1025[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new r1_242: seed;
              new ts_241: timest;
              let e5: maxmac = enc(pad(C, ts_241), AK_1025[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_880[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_880[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_1025[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new r2_245: seed;
              new ts2_244: timest;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(rmAK_215[@i_221], rAK_214[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_214[@i_221]), r1_247) in
              let x_900: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_215[@i_221])) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_910 <= N suchthat defined(mSK_24[@i_910], SK_23[@i_910], h3[@i_910], n2[@i_910], e11[@i_910], @i_142[@i_910], x_898[@i_910]) && ((@i_142[@i_910] = @i_221) && ((m7 = e11[@i_910]) && check2(e11[@i_910], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_910]) then
                if (h2 = h3[@i_910]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new r2_952: seed;
                new ts2_951: timest;
                let e12: maxmac = enc(pad(C, ts2_951), SK_23[@i_910], r2_952) in
                let mac12: macs = mac(e12, mSK_24[@i_910]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_910], mac13) then
                if (injbot(padts(ts2_951)) = dec(m13, SK_23[@i_910])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_909 <= N suchthat defined(mSK_24[@i_909], SK_23[@i_909], h3[@i_909], n2[@i_909], e11[@i_909], @i_142[@i_909], x_899[@i_909]) && ((@i_142[@i_909] = @i_221) && ((m7 = e11[@i_909]) && check2(e11[@i_909], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_909]) then
                if (h2 = h3[@i_909]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new r2_954: seed;
                new ts2_953: timest;
                let e12: maxmac = enc(pad(C, ts2_953), SK_23[@i_909], r2_954) in
                let mac12: macs = mac(e12, mSK_24[@i_909]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_909], mac13) then
                if (injbot(padts(ts2_953)) = dec(m13, SK_23[@i_909])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_215[@i_221]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_215[@i_221]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rmAK_203: mkeyseed;
                new r3_204: seed;
                new rAK_202: keyseed;
                let e3: maxmac = enc(concat2(kgen(rAK_202), mkgen(rmAK_203), hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_202), mkgen(rmAK_203), n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_1024: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_879: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_206), mkgen(rmAK_207), n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_1025: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_880: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_210), mkgen(rmAK_211), hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                let AK_1026: key = cst_key in
                new rmAK_215: mkeyseed;
                let mAK_881: mkey = cst_mkey in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_1024[@i_142], hc[@i_142], mAK_879[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_879[@i_142], mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_1024[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_882: keyseed;
              let SK_23: key = kgen(rSK_882) in
              new rmSK_883: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_883) in
              new r10_884: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_884) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_885: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_1024[@i_142], r11_885) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_886: keyseed;
              let SK_23: key = kgen(rSK_886) in
              new rmSK_887: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_887) in
              new r10_888: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_888) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_889: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_1024[@i_142], r11_889) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind @i_142 <= N suchthat defined(rAK_214[@i_142], hc[@i_142], rmAK_215[@i_142], e3[@i_142], mAK_881[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            find @i_905 <= N suchthat defined(e11[@i_905], @i_142[@i_905], x_898[@i_905]) && ((@i_142[@i_905] = @i_142) && ((m9 = e11[@i_905]) && check2(e11[@i_905], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_904 <= N suchthat defined(e11[@i_904], @i_142[@i_904], x_899[@i_904]) && ((@i_142[@i_904] = @i_142) && ((m9 = e11[@i_904]) && check2(e11[@i_904], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_901 <= N suchthat defined(e5[@i_901], @i_221[@i_901], x_900[@i_901]) && ((@i_221[@i_901] = @i_142) && ((m9 = e5[@i_901]) && check2(e5[@i_901], mkgen2(rmAK_215[@i_142]), mac9))) then
              event partTC(hc[@i_142], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_890: keyseed;
                let SK_23: key = kgen(rSK_890) in
                new rmSK_891: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_891) in
                new r10_892: seed;
                let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_892) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_893: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_893) in
                let x_898: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
                new rSK_894: keyseed;
                let SK_23: key = kgen(rSK_894) in
                new rmSK_895: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_895) in
                new r10_896: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_896) in
                let x_76: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_897: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_897) in
                let x_899: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_132: mkey = cst_mkey
    else
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying remove assignments of useless yields

Game 67 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rmKs: mkeyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rKt: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_880[@i_222], AK_1025[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new r1_242: seed;
              new ts_241: timest;
              let e5: maxmac = enc(pad(C, ts_241), AK_1025[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_880[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_880[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_1025[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new r2_245: seed;
              new ts2_244: timest;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(rmAK_215[@i_221], rAK_214[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_214[@i_221]), r1_247) in
              let x_900: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_215[@i_221])) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_910 <= N suchthat defined(mSK_24[@i_910], SK_23[@i_910], h3[@i_910], n2[@i_910], e11[@i_910], @i_142[@i_910], x_898[@i_910]) && ((@i_142[@i_910] = @i_221) && ((m7 = e11[@i_910]) && check2(e11[@i_910], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_910]) then
                if (h2 = h3[@i_910]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new r2_952: seed;
                new ts2_951: timest;
                let e12: maxmac = enc(pad(C, ts2_951), SK_23[@i_910], r2_952) in
                let mac12: macs = mac(e12, mSK_24[@i_910]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_910], mac13) then
                if (injbot(padts(ts2_951)) = dec(m13, SK_23[@i_910])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_909 <= N suchthat defined(mSK_24[@i_909], SK_23[@i_909], h3[@i_909], n2[@i_909], e11[@i_909], @i_142[@i_909], x_899[@i_909]) && ((@i_142[@i_909] = @i_221) && ((m7 = e11[@i_909]) && check2(e11[@i_909], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_909]) then
                if (h2 = h3[@i_909]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new r2_954: seed;
                new ts2_953: timest;
                let e12: maxmac = enc(pad(C, ts2_953), SK_23[@i_909], r2_954) in
                let mac12: macs = mac(e12, mSK_24[@i_909]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_909], mac13) then
                if (injbot(padts(ts2_953)) = dec(m13, SK_23[@i_909])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_215[@i_221]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_215[@i_221]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rmAK_203: mkeyseed;
                new r3_204: seed;
                new rAK_202: keyseed;
                let e3: maxmac = enc(concat2(kgen(rAK_202), mkgen(rmAK_203), hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_202), mkgen(rmAK_203), n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_1024: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_879: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_206), mkgen(rmAK_207), n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_1025: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_880: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_210), mkgen(rmAK_211), hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                new rmAK_215: mkeyseed;
                let mAK_881: mkey = cst_mkey in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_1024[@i_142], hc[@i_142], mAK_879[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_879[@i_142], mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_1024[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_882: keyseed;
              let SK_23: key = kgen(rSK_882) in
              new rmSK_883: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_883) in
              new r10_884: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_884) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_885: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_1024[@i_142], r11_885) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_886: keyseed;
              let SK_23: key = kgen(rSK_886) in
              new rmSK_887: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_887) in
              new r10_888: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_888) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_889: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_1024[@i_142], r11_889) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind @i_142 <= N suchthat defined(rAK_214[@i_142], hc[@i_142], rmAK_215[@i_142], e3[@i_142], mAK_881[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            find @i_905 <= N suchthat defined(e11[@i_905], @i_142[@i_905], x_898[@i_905]) && ((@i_142[@i_905] = @i_142) && ((m9 = e11[@i_905]) && check2(e11[@i_905], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_904 <= N suchthat defined(e11[@i_904], @i_142[@i_904], x_899[@i_904]) && ((@i_142[@i_904] = @i_142) && ((m9 = e11[@i_904]) && check2(e11[@i_904], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_901 <= N suchthat defined(e5[@i_901], @i_221[@i_901], x_900[@i_901]) && ((@i_221[@i_901] = @i_142) && ((m9 = e5[@i_901]) && check2(e5[@i_901], mkgen2(rmAK_215[@i_142]), mac9))) then
              event partTC(hc[@i_142], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_890: keyseed;
                let SK_23: key = kgen(rSK_890) in
                new rmSK_891: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_891) in
                new r10_892: seed;
                let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_142]), Mkey[j3], r10_892) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_893: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_893) in
                let x_898: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
                new rSK_894: keyseed;
                let SK_23: key = kgen(rSK_894) in
                new rmSK_895: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_895) in
                new r10_896: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_896) in
                let x_76: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_897: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_897) in
                let x_899: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_132: mkey = cst_mkey
    else
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying remove assignments of binder mSK_24 yields

Game 68 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rmKs: mkeyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rKt: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_880[@i_222], AK_1025[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new r1_242: seed;
              new ts_241: timest;
              let e5: maxmac = enc(pad(C, ts_241), AK_1025[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_880[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_880[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_1025[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new r2_245: seed;
              new ts2_244: timest;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(rmAK_215[@i_221], rAK_214[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_214[@i_221]), r1_247) in
              let x_900: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_215[@i_221])) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_910 <= N suchthat defined(mSK_24[@i_910], SK_23[@i_910], h3[@i_910], n2[@i_910], e11[@i_910], @i_142[@i_910], x_898[@i_910]) && ((@i_142[@i_910] = @i_221) && ((m7 = e11[@i_910]) && check2(e11[@i_910], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_910]) then
                if (h2 = h3[@i_910]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new r2_952: seed;
                new ts2_951: timest;
                let e12: maxmac = enc(pad(C, ts2_951), SK_23[@i_910], r2_952) in
                let mac12: macs = mac(e12, mSK_24[@i_910]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_910], mac13) then
                if (injbot(padts(ts2_951)) = dec(m13, SK_23[@i_910])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_909 <= N suchthat defined(mSK_24[@i_909], SK_23[@i_909], h3[@i_909], n2[@i_909], e11[@i_909], @i_142[@i_909], x_899[@i_909]) && ((@i_142[@i_909] = @i_221) && ((m7 = e11[@i_909]) && check2(e11[@i_909], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_909]) then
                if (h2 = h3[@i_909]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new r2_954: seed;
                new ts2_953: timest;
                let e12: maxmac = enc(pad(C, ts2_953), SK_23[@i_909], r2_954) in
                let mac12: macs = mac(e12, mSK_24[@i_909]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_909], mac13) then
                if (injbot(padts(ts2_953)) = dec(m13, SK_23[@i_909])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_215[@i_221]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_215[@i_221]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rmAK_203: mkeyseed;
                new r3_204: seed;
                new rAK_202: keyseed;
                let e3: maxmac = enc(concat2(kgen(rAK_202), mkgen(rmAK_203), hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_202), mkgen(rmAK_203), n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_1024: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_879: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_206), mkgen(rmAK_207), n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_1025: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_880: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_210), mkgen(rmAK_211), hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                new rmAK_215: mkeyseed;
                let mAK_881: mkey = cst_mkey in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_1024[@i_142], hc[@i_142], mAK_879[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_879[@i_142], mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_1024[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_882: keyseed;
              let SK_23: key = kgen(rSK_882) in
              new rmSK_883: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_883) in
              new r10_884: seed;
              let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_883), hc[@i_142]), Mkey[j3], r10_884) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_885: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_883), n2, h3), AK_1024[@i_142], r11_885) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_886: keyseed;
              let SK_23: key = kgen(rSK_886) in
              new rmSK_887: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_887) in
              new r10_888: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_888) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_889: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_887), n2, h3), AK_1024[@i_142], r11_889) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind @i_142 <= N suchthat defined(rAK_214[@i_142], hc[@i_142], rmAK_215[@i_142], e3[@i_142], mAK_881[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            find @i_905 <= N suchthat defined(e11[@i_905], @i_142[@i_905], x_898[@i_905]) && ((@i_142[@i_905] = @i_142) && ((m9 = e11[@i_905]) && check2(e11[@i_905], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_904 <= N suchthat defined(e11[@i_904], @i_142[@i_904], x_899[@i_904]) && ((@i_142[@i_904] = @i_142) && ((m9 = e11[@i_904]) && check2(e11[@i_904], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_901 <= N suchthat defined(e5[@i_901], @i_221[@i_901], x_900[@i_901]) && ((@i_221[@i_901] = @i_142) && ((m9 = e5[@i_901]) && check2(e5[@i_901], mkgen2(rmAK_215[@i_142]), mac9))) then
              event partTC(hc[@i_142], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_890: keyseed;
                let SK_23: key = kgen(rSK_890) in
                new rmSK_891: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_891) in
                new r10_892: seed;
                let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_891), hc[@i_142]), Mkey[j3], r10_892) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_893: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_893) in
                let x_898: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
                new rSK_894: keyseed;
                let SK_23: key = kgen(rSK_894) in
                new rmSK_895: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_895) in
                new r10_896: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_896) in
                let x_76: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_897: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_897) in
                let x_899: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_24[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_77], mac15) then
        let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_77]) in
        event partSC(hc[@i_142[@i_77]], m14, m15);
        event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_132: mkey = cst_mkey
    else
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying SA rename mSK_24 yields

Game 69 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rmKs: mkeyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rKt: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_880[@i_222], AK_1025[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new r1_242: seed;
              new ts_241: timest;
              let e5: maxmac = enc(pad(C, ts_241), AK_1025[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_880[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_880[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_1025[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new r2_245: seed;
              new ts2_244: timest;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(rmAK_215[@i_221], rAK_214[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_214[@i_221]), r1_247) in
              let x_900: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_215[@i_221])) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_910 <= N suchthat defined(mSK_1097[@i_910], SK_23[@i_910], h3[@i_910], n2[@i_910], e11[@i_910], @i_142[@i_910], x_898[@i_910]) && ((@i_142[@i_910] = @i_221) && ((m7 = e11[@i_910]) && check2(e11[@i_910], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_910]) then
                if (h2 = h3[@i_910]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new r2_952: seed;
                new ts2_951: timest;
                let e12: maxmac = enc(pad(C, ts2_951), SK_23[@i_910], r2_952) in
                let mac12: macs = mac(e12, mSK_1097[@i_910]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_1097[@i_910], mac13) then
                if (injbot(padts(ts2_951)) = dec(m13, SK_23[@i_910])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_909 <= N suchthat defined(mSK_1098[@i_909], SK_23[@i_909], h3[@i_909], n2[@i_909], e11[@i_909], @i_142[@i_909], x_899[@i_909]) && ((@i_142[@i_909] = @i_221) && ((m7 = e11[@i_909]) && check2(e11[@i_909], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_909]) then
                if (h2 = h3[@i_909]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new r2_954: seed;
                new ts2_953: timest;
                let e12: maxmac = enc(pad(C, ts2_953), SK_23[@i_909], r2_954) in
                let mac12: macs = mac(e12, mSK_1098[@i_909]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_1098[@i_909], mac13) then
                if (injbot(padts(ts2_953)) = dec(m13, SK_23[@i_909])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_215[@i_221]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_215[@i_221]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rmAK_203: mkeyseed;
                new r3_204: seed;
                new rAK_202: keyseed;
                let e3: maxmac = enc(concat2(kgen(rAK_202), mkgen(rmAK_203), hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_202), mkgen(rmAK_203), n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_1024: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_879: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_206), mkgen(rmAK_207), n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_1025: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_880: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_210), mkgen(rmAK_211), hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                new rmAK_215: mkeyseed;
                let mAK_881: mkey = cst_mkey in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_1024[@i_142], hc[@i_142], mAK_879[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_879[@i_142], mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_1024[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_882: keyseed;
              let SK_23: key = kgen(rSK_882) in
              new rmSK_883: mkeyseed;
              let mSK_1095: mkey = mkgen(rmSK_883) in
              new r10_884: seed;
              let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_883), hc[@i_142]), Mkey[j3], r10_884) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_885: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_883), n2, h3), AK_1024[@i_142], r11_885) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_886: keyseed;
              let SK_23: key = kgen(rSK_886) in
              new rmSK_887: mkeyseed;
              let mSK_1096: mkey = mkgen(rmSK_887) in
              new r10_888: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_888) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_889: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_887), n2, h3), AK_1024[@i_142], r11_889) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind @i_142 <= N suchthat defined(rAK_214[@i_142], hc[@i_142], rmAK_215[@i_142], e3[@i_142], mAK_881[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            find @i_905 <= N suchthat defined(e11[@i_905], @i_142[@i_905], x_898[@i_905]) && ((@i_142[@i_905] = @i_142) && ((m9 = e11[@i_905]) && check2(e11[@i_905], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_904 <= N suchthat defined(e11[@i_904], @i_142[@i_904], x_899[@i_904]) && ((@i_142[@i_904] = @i_142) && ((m9 = e11[@i_904]) && check2(e11[@i_904], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_901 <= N suchthat defined(e5[@i_901], @i_221[@i_901], x_900[@i_901]) && ((@i_221[@i_901] = @i_142) && ((m9 = e5[@i_901]) && check2(e5[@i_901], mkgen2(rmAK_215[@i_142]), mac9))) then
              event partTC(hc[@i_142], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_890: keyseed;
                let SK_23: key = kgen(rSK_890) in
                new rmSK_891: mkeyseed;
                let mSK_1097: mkey = mkgen(rmSK_891) in
                new r10_892: seed;
                let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_891), hc[@i_142]), Mkey[j3], r10_892) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_893: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_893) in
                let x_898: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
                new rSK_894: keyseed;
                let SK_23: key = kgen(rSK_894) in
                new rmSK_895: mkeyseed;
                let mSK_1098: mkey = mkgen(rmSK_895) in
                new r10_896: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_896) in
                let x_76: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_897: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_897) in
                let x_899: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_1096[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
          if check(m15, mSK_1096[@i_77], mac15) then
          let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
          new r16: seed;
          let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
          let mac16: macs = mac(e16, mSK_1096[@i_77]) in
          event partSC(hc[@i_142[@i_77]], m14, m15);
          event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
        orfind @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_1098[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
          if check(m15, mSK_1098[@i_77], mac15) then
          let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
          new r16: seed;
          let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16) in
          let mac16: macs = mac(e16, mSK_1098[@i_77]) in
          event partSC(hc[@i_142[@i_77]], m14, m15);
          event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_132: mkey = cst_mkey
    else
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying remove assignments of binder mSK_24 yields

Game 70 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rmKs: mkeyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rKt: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_880[@i_222], AK_1025[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new r1_242: seed;
              new ts_241: timest;
              let e5: maxmac = enc(pad(C, ts_241), AK_1025[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_880[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_880[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_1025[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new r2_245: seed;
              new ts2_244: timest;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(rmAK_215[@i_221], rAK_214[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_214[@i_221]), r1_247) in
              let x_900: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_215[@i_221])) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_910 <= N suchthat defined(mSK_1097[@i_910], SK_23[@i_910], h3[@i_910], n2[@i_910], e11[@i_910], @i_142[@i_910], x_898[@i_910]) && ((@i_142[@i_910] = @i_221) && ((m7 = e11[@i_910]) && check2(e11[@i_910], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_910]) then
                if (h2 = h3[@i_910]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new r2_952: seed;
                new ts2_951: timest;
                let e12: maxmac = enc(pad(C, ts2_951), SK_23[@i_910], r2_952) in
                let mac12: macs = mac(e12, mSK_1097[@i_910]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_1097[@i_910], mac13) then
                if (injbot(padts(ts2_951)) = dec(m13, SK_23[@i_910])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_909 <= N suchthat defined(mSK_1098[@i_909], SK_23[@i_909], h3[@i_909], n2[@i_909], e11[@i_909], @i_142[@i_909], x_899[@i_909]) && ((@i_142[@i_909] = @i_221) && ((m7 = e11[@i_909]) && check2(e11[@i_909], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_909]) then
                if (h2 = h3[@i_909]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new r2_954: seed;
                new ts2_953: timest;
                let e12: maxmac = enc(pad(C, ts2_953), SK_23[@i_909], r2_954) in
                let mac12: macs = mac(e12, mSK_1098[@i_909]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_1098[@i_909], mac13) then
                if (injbot(padts(ts2_953)) = dec(m13, SK_23[@i_909])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_215[@i_221]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_215[@i_221]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rmAK_203: mkeyseed;
                new r3_204: seed;
                new rAK_202: keyseed;
                let e3: maxmac = enc(concat2(kgen(rAK_202), mkgen(rmAK_203), hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_202), mkgen(rmAK_203), n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_1024: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_879: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_206), mkgen(rmAK_207), n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_1025: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_880: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_210), mkgen(rmAK_211), hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                new rmAK_215: mkeyseed;
                let mAK_881: mkey = cst_mkey in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_1024[@i_142], hc[@i_142], mAK_879[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_879[@i_142], mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_1024[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_882: keyseed;
              let SK_23: key = kgen(rSK_882) in
              new rmSK_883: mkeyseed;
              new r10_884: seed;
              let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_883), hc[@i_142]), Mkey[j3], r10_884) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_885: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_883), n2, h3), AK_1024[@i_142], r11_885) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_886: keyseed;
              let SK_23: key = kgen(rSK_886) in
              new rmSK_887: mkeyseed;
              let mSK_1096: mkey = mkgen(rmSK_887) in
              new r10_888: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_888) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_889: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_887), n2, h3), AK_1024[@i_142], r11_889) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind @i_142 <= N suchthat defined(rAK_214[@i_142], hc[@i_142], rmAK_215[@i_142], e3[@i_142], mAK_881[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            find @i_905 <= N suchthat defined(e11[@i_905], @i_142[@i_905], x_898[@i_905]) && ((@i_142[@i_905] = @i_142) && ((m9 = e11[@i_905]) && check2(e11[@i_905], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_904 <= N suchthat defined(e11[@i_904], @i_142[@i_904], x_899[@i_904]) && ((@i_142[@i_904] = @i_142) && ((m9 = e11[@i_904]) && check2(e11[@i_904], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_901 <= N suchthat defined(e5[@i_901], @i_221[@i_901], x_900[@i_901]) && ((@i_221[@i_901] = @i_142) && ((m9 = e5[@i_901]) && check2(e5[@i_901], mkgen2(rmAK_215[@i_142]), mac9))) then
              event partTC(hc[@i_142], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_890: keyseed;
                let SK_23: key = kgen(rSK_890) in
                new rmSK_891: mkeyseed;
                let mSK_1097: mkey = mkgen(rmSK_891) in
                new r10_892: seed;
                let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_891), hc[@i_142]), Mkey[j3], r10_892) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_893: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_893) in
                let x_898: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
                new rSK_894: keyseed;
                let SK_23: key = kgen(rSK_894) in
                new rmSK_895: mkeyseed;
                let mSK_1098: mkey = mkgen(rmSK_895) in
                new r10_896: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_896) in
                let x_76: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_897: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_897) in
                let x_899: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_1096[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
          if check(m15, mSK_1096[@i_77], mac15) then
          let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
          new r16_1099: seed;
          let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16_1099) in
          let mac16: macs = mac(e16, mSK_1096[@i_77]) in
          event partSC(hc[@i_142[@i_77]], m14, m15);
          event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
        orfind @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_1098[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
          if check(m15, mSK_1098[@i_77], mac15) then
          let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
          new r16_1100: seed;
          let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16_1100) in
          let mac16: macs = mac(e16, mSK_1098[@i_77]) in
          event partSC(hc[@i_142[@i_77]], m14, m15);
          event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_132: mkey = cst_mkey
    else
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying remove assignments of binder mSK_1098 yields

Game 71 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rmKs: mkeyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rKt: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_880[@i_222], AK_1025[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new r1_242: seed;
              new ts_241: timest;
              let e5: maxmac = enc(pad(C, ts_241), AK_1025[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_880[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_880[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_1025[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new r2_245: seed;
              new ts2_244: timest;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(rmAK_215[@i_221], rAK_214[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_214[@i_221]), r1_247) in
              let x_900: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_215[@i_221])) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_910 <= N suchthat defined(mSK_1097[@i_910], SK_23[@i_910], h3[@i_910], n2[@i_910], e11[@i_910], @i_142[@i_910], x_898[@i_910]) && ((@i_142[@i_910] = @i_221) && ((m7 = e11[@i_910]) && check2(e11[@i_910], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_910]) then
                if (h2 = h3[@i_910]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new r2_952: seed;
                new ts2_951: timest;
                let e12: maxmac = enc(pad(C, ts2_951), SK_23[@i_910], r2_952) in
                let mac12: macs = mac(e12, mSK_1097[@i_910]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_1097[@i_910], mac13) then
                if (injbot(padts(ts2_951)) = dec(m13, SK_23[@i_910])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_909 <= N suchthat defined(rmSK_895[@i_909], mSK_1098[@i_909], SK_23[@i_909], h3[@i_909], n2[@i_909], e11[@i_909], @i_142[@i_909], x_899[@i_909]) && ((@i_142[@i_909] = @i_221) && ((m7 = e11[@i_909]) && check2(e11[@i_909], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_909]) then
                if (h2 = h3[@i_909]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new r2_954: seed;
                new ts2_953: timest;
                let e12: maxmac = enc(pad(C, ts2_953), SK_23[@i_909], r2_954) in
                let mac12: macs = mac(e12, mkgen(rmSK_895[@i_909])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mkgen(rmSK_895[@i_909]), mac13) then
                if (injbot(padts(ts2_953)) = dec(m13, SK_23[@i_909])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_215[@i_221]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_215[@i_221]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rmAK_203: mkeyseed;
                new r3_204: seed;
                new rAK_202: keyseed;
                let e3: maxmac = enc(concat2(kgen(rAK_202), mkgen(rmAK_203), hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_202), mkgen(rmAK_203), n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_1024: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_879: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_206), mkgen(rmAK_207), n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_1025: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_880: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_210), mkgen(rmAK_211), hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                new rmAK_215: mkeyseed;
                let mAK_881: mkey = cst_mkey in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_1024[@i_142], hc[@i_142], mAK_879[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_879[@i_142], mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_1024[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_882: keyseed;
              let SK_23: key = kgen(rSK_882) in
              new rmSK_883: mkeyseed;
              new r10_884: seed;
              let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_883), hc[@i_142]), Mkey[j3], r10_884) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_885: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_883), n2, h3), AK_1024[@i_142], r11_885) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_886: keyseed;
              let SK_23: key = kgen(rSK_886) in
              new rmSK_887: mkeyseed;
              let mSK_1096: mkey = mkgen(rmSK_887) in
              new r10_888: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_888) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_889: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_887), n2, h3), AK_1024[@i_142], r11_889) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind @i_142 <= N suchthat defined(rAK_214[@i_142], hc[@i_142], rmAK_215[@i_142], e3[@i_142], mAK_881[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            find @i_905 <= N suchthat defined(e11[@i_905], @i_142[@i_905], x_898[@i_905]) && ((@i_142[@i_905] = @i_142) && ((m9 = e11[@i_905]) && check2(e11[@i_905], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_904 <= N suchthat defined(e11[@i_904], @i_142[@i_904], x_899[@i_904]) && ((@i_142[@i_904] = @i_142) && ((m9 = e11[@i_904]) && check2(e11[@i_904], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_901 <= N suchthat defined(e5[@i_901], @i_221[@i_901], x_900[@i_901]) && ((@i_221[@i_901] = @i_142) && ((m9 = e5[@i_901]) && check2(e5[@i_901], mkgen2(rmAK_215[@i_142]), mac9))) then
              event partTC(hc[@i_142], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_890: keyseed;
                let SK_23: key = kgen(rSK_890) in
                new rmSK_891: mkeyseed;
                let mSK_1097: mkey = mkgen(rmSK_891) in
                new r10_892: seed;
                let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_891), hc[@i_142]), Mkey[j3], r10_892) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_893: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_893) in
                let x_898: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
                new rSK_894: keyseed;
                let SK_23: key = kgen(rSK_894) in
                new rmSK_895: mkeyseed;
                let mSK_1098: mkey = cst_mkey in
                new r10_896: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_896) in
                let x_76: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_897: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_897) in
                let x_899: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_1096[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
          if check(m15, mSK_1096[@i_77], mac15) then
          let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
          new r16_1099: seed;
          let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16_1099) in
          let mac16: macs = mac(e16, mSK_1096[@i_77]) in
          event partSC(hc[@i_142[@i_77]], m14, m15);
          event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
        orfind @i_77 <= N suchthat defined(rmSK_895[@i_77], mSK_1098[@i_77], SK_23[@i_77], hc[@i_142[@i_77]], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
          if check(m15, mkgen(rmSK_895[@i_77]), mac15) then
          let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
          new r16_1100: seed;
          let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16_1100) in
          let mac16: macs = mac(e16, mkgen(rmSK_895[@i_77])) in
          event partSC(hc[@i_142[@i_77]], m14, m15);
          event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_132: mkey = cst_mkey
    else
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_895 [Difference of probability N * Pmac(time + time(context for game 71), 2. * N, 2. * N)] yields

Game 72 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rmKs: mkeyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rKt: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_880[@i_222], AK_1025[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new r1_242: seed;
              new ts_241: timest;
              let e5: maxmac = enc(pad(C, ts_241), AK_1025[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_880[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_880[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_1025[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new r2_245: seed;
              new ts2_244: timest;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(rmAK_215[@i_221], rAK_214[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_214[@i_221]), r1_247) in
              let x_900: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_215[@i_221])) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_910 <= N suchthat defined(mSK_1097[@i_910], SK_23[@i_910], h3[@i_910], n2[@i_910], e11[@i_910], @i_142[@i_910], x_898[@i_910]) && ((@i_142[@i_910] = @i_221) && ((m7 = e11[@i_910]) && check2(e11[@i_910], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_910]) then
                if (h2 = h3[@i_910]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new r2_952: seed;
                new ts2_951: timest;
                let e12: maxmac = enc(pad(C, ts2_951), SK_23[@i_910], r2_952) in
                let mac12: macs = mac(e12, mSK_1097[@i_910]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_1097[@i_910], mac13) then
                if (injbot(padts(ts2_951)) = dec(m13, SK_23[@i_910])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_909 <= N suchthat defined(rmSK_895[@i_909], mSK_1098[@i_909], SK_23[@i_909], h3[@i_909], n2[@i_909], e11[@i_909], @i_142[@i_909], x_899[@i_909]) && ((@i_142[@i_909] = @i_221) && ((m7 = e11[@i_909]) && check2(e11[@i_909], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_909]) then
                if (h2 = h3[@i_909]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new r2_954: seed;
                new ts2_953: timest;
                let e12: maxmac = enc(pad(C, ts2_953), SK_23[@i_909], r2_954) in
                let x_1102: maxmac = e12 in
                let mac12: macs = mac2(x_1102, mkgen2(rmSK_895[@i_909])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                find @i_1110 <= N suchthat defined(x_1101[@i_1110]) && ((@i_77[@i_1110] = @i_909) && ((m13 = x_1101[@i_1110]) && check2(x_1101[@i_1110], mkgen2(rmSK_895[@i_909]), mac13))) then
                  if true then
                  if (injbot(padts(ts2_953)) = dec(m13, SK_23[@i_909])) then
                  event fullCS(h2, h, m7, e12, m13);
                  out(c10[!_11], acceptC(h, h2))
                orfind @i_1107 <= N suchthat defined(x_1102[@i_1107]) && ((@i_909[@i_1107] = @i_909) && ((m13 = x_1102[@i_1107]) && check2(x_1102[@i_1107], mkgen2(rmSK_895[@i_909]), mac13))) then
                  if true then
                  if (injbot(padts(ts2_953)) = dec(m13, SK_23[@i_909])) then
                  event fullCS(h2, h, m7, e12, m13);
                  out(c10[!_11], acceptC(h, h2))
                else
                  if false then
                  if (injbot(padts(ts2_953)) = dec(m13, SK_23[@i_909])) then
                  event fullCS(h2, h, m7, e12, m13);
                  out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_215[@i_221]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_215[@i_221]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rmAK_203: mkeyseed;
                new r3_204: seed;
                new rAK_202: keyseed;
                let e3: maxmac = enc(concat2(kgen(rAK_202), mkgen(rmAK_203), hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_202), mkgen(rmAK_203), n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_1024: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_879: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_206), mkgen(rmAK_207), n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_1025: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_880: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_210), mkgen(rmAK_211), hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                new rmAK_215: mkeyseed;
                let mAK_881: mkey = cst_mkey in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_1024[@i_142], hc[@i_142], mAK_879[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_879[@i_142], mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_1024[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_882: keyseed;
              let SK_23: key = kgen(rSK_882) in
              new rmSK_883: mkeyseed;
              new r10_884: seed;
              let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_883), hc[@i_142]), Mkey[j3], r10_884) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_885: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_883), n2, h3), AK_1024[@i_142], r11_885) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_886: keyseed;
              let SK_23: key = kgen(rSK_886) in
              new rmSK_887: mkeyseed;
              let mSK_1096: mkey = mkgen(rmSK_887) in
              new r10_888: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_888) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_889: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_887), n2, h3), AK_1024[@i_142], r11_889) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind @i_142 <= N suchthat defined(rAK_214[@i_142], hc[@i_142], rmAK_215[@i_142], e3[@i_142], mAK_881[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            find @i_905 <= N suchthat defined(e11[@i_905], @i_142[@i_905], x_898[@i_905]) && ((@i_142[@i_905] = @i_142) && ((m9 = e11[@i_905]) && check2(e11[@i_905], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_904 <= N suchthat defined(e11[@i_904], @i_142[@i_904], x_899[@i_904]) && ((@i_142[@i_904] = @i_142) && ((m9 = e11[@i_904]) && check2(e11[@i_904], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_901 <= N suchthat defined(e5[@i_901], @i_221[@i_901], x_900[@i_901]) && ((@i_221[@i_901] = @i_142) && ((m9 = e5[@i_901]) && check2(e5[@i_901], mkgen2(rmAK_215[@i_142]), mac9))) then
              event partTC(hc[@i_142], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_890: keyseed;
                let SK_23: key = kgen(rSK_890) in
                new rmSK_891: mkeyseed;
                let mSK_1097: mkey = mkgen(rmSK_891) in
                new r10_892: seed;
                let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_891), hc[@i_142]), Mkey[j3], r10_892) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_893: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_893) in
                let x_898: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
                new rSK_894: keyseed;
                let SK_23: key = kgen(rSK_894) in
                new rmSK_895: mkeyseed;
                let mSK_1098: mkey = cst_mkey in
                new r10_896: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_896) in
                let x_76: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_897: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_897) in
                let x_899: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_1096[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
          if check(m15, mSK_1096[@i_77], mac15) then
          let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
          new r16_1099: seed;
          let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16_1099) in
          let mac16: macs = mac(e16, mSK_1096[@i_77]) in
          event partSC(hc[@i_142[@i_77]], m14, m15);
          event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
        orfind @i_77 <= N suchthat defined(rmSK_895[@i_77], mSK_1098[@i_77], SK_23[@i_77], hc[@i_142[@i_77]], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
          find @i_1106 <= N suchthat defined(x_1101[@i_1106]) && ((@i_77[@i_1106] = @i_77) && ((m15 = x_1101[@i_1106]) && check2(x_1101[@i_1106], mkgen2(rmSK_895[@i_77]), mac15))) then
            if true then
            let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
            new r16_1100: seed;
            let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16_1100) in
            let x_1101: maxmac = e16 in
            let mac16: macs = mac2(x_1101, mkgen2(rmSK_895[@i_77])) in
            event partSC(hc[@i_142[@i_77]], m14, m15);
            event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
            out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
          orfind @i_1103 <= N suchthat defined(x_1102[@i_1103]) && ((@i_909[@i_1103] = @i_77) && ((m15 = x_1102[@i_1103]) && check2(x_1102[@i_1103], mkgen2(rmSK_895[@i_77]), mac15))) then
            if true then
            let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
            new r16_1100: seed;
            let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16_1100) in
            let x_1101: maxmac = e16 in
            let mac16: macs = mac2(x_1101, mkgen2(rmSK_895[@i_77])) in
            event partSC(hc[@i_142[@i_77]], m14, m15);
            event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
            out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
          else
            if false then
            let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
            new r16_1100: seed;
            let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16_1100) in
            let x_1101: maxmac = e16 in
            let mac16: macs = mac2(x_1101, mkgen2(rmSK_895[@i_77])) in
            event partSC(hc[@i_142[@i_77]], m14, m15);
            event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
            out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_132: mkey = cst_mkey
    else
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying simplify yields

Game 73 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rmKs: mkeyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rKt: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_880[@i_222], AK_1025[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new r1_242: seed;
              new ts_241: timest;
              let e5: maxmac = enc(pad(C, ts_241), AK_1025[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_880[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_880[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_1025[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new r2_245: seed;
              new ts2_244: timest;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(rmAK_215[@i_221], rAK_214[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_214[@i_221]), r1_247) in
              let x_900: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_215[@i_221])) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_910 <= N suchthat defined(mSK_1097[@i_910], SK_23[@i_910], h3[@i_910], n2[@i_910], e11[@i_910], @i_142[@i_910], x_898[@i_910]) && ((@i_142[@i_910] = @i_221) && ((m7 = e11[@i_910]) && check2(e11[@i_910], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_910]) then
                if (h2 = h3[@i_910]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new r2_952: seed;
                new ts2_951: timest;
                let e12: maxmac = enc(pad(C, ts2_951), SK_23[@i_910], r2_952) in
                let mac12: macs = mac(e12, mSK_1097[@i_910]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_1097[@i_910], mac13) then
                if (injbot(padts(ts2_951)) = dec(m13, SK_23[@i_910])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_909 <= N suchthat defined(rmSK_895[@i_909], SK_23[@i_909], h3[@i_909], n2[@i_909], e11[@i_909], @i_142[@i_909], x_899[@i_909]) && ((@i_142[@i_909] = @i_221) && ((m7 = e11[@i_909]) && check2(e11[@i_909], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_909]) then
                if (h2 = h3[@i_909]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new r2_954: seed;
                new ts2_953: timest;
                let e12: maxmac = enc(pad(C, ts2_953), SK_23[@i_909], r2_954) in
                let x_1102: maxmac = e12 in
                let mac12: macs = mac2(x_1102, mkgen2(rmSK_895[@i_909])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                find @i_1110 <= N suchthat defined(x_1101[@i_1110], @i_77[@i_1110]) && ((@i_77[@i_1110] = @i_909) && ((m13 = x_1101[@i_1110]) && check2(x_1101[@i_1110], mkgen2(rmSK_895[@i_909]), mac13))) then
                  event fullCS(h2, h, m7, e12, m13);
                  out(c10[!_11], acceptC(h, h2))
                orfind  suchthat defined(rmSK_895[@i_909]) && ((m13 = x_1102) && check2(x_1102, mkgen2(rmSK_895[@i_909]), mac13)) then
                  let @i_1107 <= N = !_11
              orfind  suchthat defined(rmAK_215[@i_221]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_215[@i_221]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rmAK_203: mkeyseed;
                new r3_204: seed;
                new rAK_202: keyseed;
                let e3: maxmac = enc(concat2(kgen(rAK_202), mkgen(rmAK_203), hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_202), mkgen(rmAK_203), n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_1024: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_879: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_206), mkgen(rmAK_207), n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_1025: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_880: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_210), mkgen(rmAK_211), hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                new rmAK_215: mkeyseed;
                let mAK_881: mkey = cst_mkey in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_1024[@i_142], hc[@i_142], mAK_879[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_879[@i_142], mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_1024[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_882: keyseed;
              let SK_23: key = kgen(rSK_882) in
              new rmSK_883: mkeyseed;
              new r10_884: seed;
              let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_883), hc[@i_142]), Mkey[j3], r10_884) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_885: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_883), n2, h3), AK_1024[@i_142], r11_885) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_886: keyseed;
              let SK_23: key = kgen(rSK_886) in
              new rmSK_887: mkeyseed;
              let mSK_1096: mkey = mkgen(rmSK_887) in
              new r10_888: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_888) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_889: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_887), n2, h3), AK_1024[@i_142], r11_889) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind @i_142 <= N suchthat defined(rAK_214[@i_142], hc[@i_142], rmAK_215[@i_142], e3[@i_142], mAK_881[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            find @i_905 <= N suchthat defined(e11[@i_905], @i_142[@i_905], x_898[@i_905]) && ((@i_142[@i_905] = @i_142) && ((m9 = e11[@i_905]) && check2(e11[@i_905], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_904 <= N suchthat defined(e11[@i_904], @i_142[@i_904], x_899[@i_904]) && ((@i_142[@i_904] = @i_142) && ((m9 = e11[@i_904]) && check2(e11[@i_904], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_901 <= N suchthat defined(e5[@i_901], @i_221[@i_901], x_900[@i_901]) && ((@i_221[@i_901] = @i_142) && ((m9 = e5[@i_901]) && check2(e5[@i_901], mkgen2(rmAK_215[@i_142]), mac9))) then
              event partTC(hc[@i_142], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_890: keyseed;
                let SK_23: key = kgen(rSK_890) in
                new rmSK_891: mkeyseed;
                let mSK_1097: mkey = mkgen(rmSK_891) in
                new r10_892: seed;
                let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_891), hc[@i_142]), Mkey[j3], r10_892) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_893: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_893) in
                let x_898: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
                new rSK_894: keyseed;
                let SK_23: key = kgen(rSK_894) in
                new rmSK_895: mkeyseed;
                let mSK_1098: mkey = cst_mkey in
                new r10_896: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_896) in
                let x_76: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_897: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_897) in
                let x_899: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_1096[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
          if check(m15, mSK_1096[@i_77], mac15) then
          let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
          new r16_1099: seed;
          let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16_1099) in
          let mac16: macs = mac(e16, mSK_1096[@i_77]) in
          event partSC(hc[@i_142[@i_77]], m14, m15);
          event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
        orfind @i_77 <= N suchthat defined(hc[@i_142[@i_77]], SK_23[@i_77], @i_901[@i_77], rmSK_895[@i_77], e10[@i_77], mSK_1098[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
          find @i_1106 <= N suchthat defined(x_1101[@i_1106], @i_77[@i_1106]) && ((@i_77[@i_1106] = @i_77) && ((m15 = x_1101[@i_1106]) && check2(x_1101[@i_1106], mkgen2(rmSK_895[@i_77]), mac15))) then
            yield
          orfind  suchthat defined(hc[@i_142[@i_77]], ts2_953[@i_901[@i_77]], x_1102[@i_901[@i_77]], @i_909[@i_901[@i_77]]) && ((@i_909[@i_901[@i_77]] = @i_77) && ((m15 = x_1102[@i_901[@i_77]]) && check2(x_1102[@i_901[@i_77]], mkgen2(rmSK_895[@i_77]), mac15))) then
            let @i_1103 <= N = @i_901[@i_77] in
            let ts3: timest = ts2_953[@i_901[@i_77]] in
            new r16_1100: seed;
            let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16_1100) in
            let x_1101: maxmac = e16 in
            let mac16: macs = mac2(x_1101, mkgen2(rmSK_895[@i_77])) in
            event partSC(hc[@i_142[@i_77]], m14, m15);
            event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
            out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_132: mkey = cst_mkey
    else
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying move new all binders yields

Game 74 is
in(start, ());
new rKt: keyseed;
new rKs: keyseed;
new rmKt: mkeyseed;
new rmKs: mkeyseed;
new rmKc: mkeyseed;
new rKc: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_880[@i_222], AK_1025[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new ts_241: timest;
              new r1_242: seed;
              let e5: maxmac = enc(pad(C, ts_241), AK_1025[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_880[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_880[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_1025[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new ts2_244: timest;
              new r2_245: seed;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(rmAK_215[@i_221], rAK_214[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_214[@i_221]), r1_247) in
              let x_900: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_215[@i_221])) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_910 <= N suchthat defined(mSK_1097[@i_910], SK_23[@i_910], h3[@i_910], n2[@i_910], e11[@i_910], @i_142[@i_910], x_898[@i_910]) && ((@i_142[@i_910] = @i_221) && ((m7 = e11[@i_910]) && check2(e11[@i_910], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_910]) then
                if (h2 = h3[@i_910]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new ts2_951: timest;
                new r2_952: seed;
                let e12: maxmac = enc(pad(C, ts2_951), SK_23[@i_910], r2_952) in
                let mac12: macs = mac(e12, mSK_1097[@i_910]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_1097[@i_910], mac13) then
                if (injbot(padts(ts2_951)) = dec(m13, SK_23[@i_910])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_909 <= N suchthat defined(rmSK_895[@i_909], SK_23[@i_909], h3[@i_909], n2[@i_909], e11[@i_909], @i_142[@i_909], x_899[@i_909]) && ((@i_142[@i_909] = @i_221) && ((m7 = e11[@i_909]) && check2(e11[@i_909], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_909]) then
                if (h2 = h3[@i_909]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new ts2_953: timest;
                new r2_954: seed;
                let e12: maxmac = enc(pad(C, ts2_953), SK_23[@i_909], r2_954) in
                let x_1102: maxmac = e12 in
                let mac12: macs = mac2(x_1102, mkgen2(rmSK_895[@i_909])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                find @i_1110 <= N suchthat defined(x_1101[@i_1110], @i_77[@i_1110]) && ((@i_77[@i_1110] = @i_909) && ((m13 = x_1101[@i_1110]) && check2(x_1101[@i_1110], mkgen2(rmSK_895[@i_909]), mac13))) then
                  event fullCS(h2, h, m7, e12, m13);
                  out(c10[!_11], acceptC(h, h2))
                orfind  suchthat defined(rmSK_895[@i_909]) && ((m13 = x_1102) && check2(x_1102, mkgen2(rmSK_895[@i_909]), mac13)) then
                  let @i_1107 <= N = !_11
              orfind  suchthat defined(rmAK_215[@i_221]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_215[@i_221]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                new r3_204: seed;
                new rmAK_203: mkeyseed;
                let e3: maxmac = enc(concat2(kgen(rAK_202), mkgen(rmAK_203), hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_202), mkgen(rmAK_203), n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_1024: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_879: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_206), mkgen(rmAK_207), n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_1025: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_880: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_210), mkgen(rmAK_211), hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                new rmAK_215: mkeyseed;
                let mAK_881: mkey = cst_mkey in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_1024[@i_142], hc[@i_142], mAK_879[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_879[@i_142], mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_1024[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_882: keyseed;
              let SK_23: key = kgen(rSK_882) in
              new r10_884: seed;
              new rmSK_883: mkeyseed;
              let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_883), hc[@i_142]), Mkey[j3], r10_884) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_885: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_883), n2, h3), AK_1024[@i_142], r11_885) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_886: keyseed;
              let SK_23: key = kgen(rSK_886) in
              new rmSK_887: mkeyseed;
              let mSK_1096: mkey = mkgen(rmSK_887) in
              new r10_888: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_888) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_889: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_887), n2, h3), AK_1024[@i_142], r11_889) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind @i_142 <= N suchthat defined(rAK_214[@i_142], hc[@i_142], rmAK_215[@i_142], e3[@i_142], mAK_881[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            find @i_905 <= N suchthat defined(e11[@i_905], @i_142[@i_905], x_898[@i_905]) && ((@i_142[@i_905] = @i_142) && ((m9 = e11[@i_905]) && check2(e11[@i_905], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_904 <= N suchthat defined(e11[@i_904], @i_142[@i_904], x_899[@i_904]) && ((@i_142[@i_904] = @i_142) && ((m9 = e11[@i_904]) && check2(e11[@i_904], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_901 <= N suchthat defined(e5[@i_901], @i_221[@i_901], x_900[@i_901]) && ((@i_221[@i_901] = @i_142) && ((m9 = e5[@i_901]) && check2(e5[@i_901], mkgen2(rmAK_215[@i_142]), mac9))) then
              event partTC(hc[@i_142], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_890: keyseed;
                let SK_23: key = kgen(rSK_890) in
                new rmSK_891: mkeyseed;
                let mSK_1097: mkey = mkgen(rmSK_891) in
                new r10_892: seed;
                let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_891), hc[@i_142]), Mkey[j3], r10_892) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_893: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_893) in
                let x_898: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
                new rSK_894: keyseed;
                let SK_23: key = kgen(rSK_894) in
                new rmSK_895: mkeyseed;
                let mSK_1098: mkey = cst_mkey in
                new r10_896: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_896) in
                let x_76: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_897: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_897) in
                let x_899: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_1096[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
          if check(m15, mSK_1096[@i_77], mac15) then
          let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
          new r16_1099: seed;
          let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16_1099) in
          let mac16: macs = mac(e16, mSK_1096[@i_77]) in
          event partSC(hc[@i_142[@i_77]], m14, m15);
          event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
        orfind @i_77 <= N suchthat defined(hc[@i_142[@i_77]], SK_23[@i_77], @i_901[@i_77], rmSK_895[@i_77], e10[@i_77], mSK_1098[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
          find @i_1106 <= N suchthat defined(x_1101[@i_1106], @i_77[@i_1106]) && ((@i_77[@i_1106] = @i_77) && ((m15 = x_1101[@i_1106]) && check2(x_1101[@i_1106], mkgen2(rmSK_895[@i_77]), mac15))) then
            yield
          orfind  suchthat defined(hc[@i_142[@i_77]], ts2_953[@i_901[@i_77]], x_1102[@i_901[@i_77]], @i_909[@i_901[@i_77]]) && ((@i_909[@i_901[@i_77]] = @i_77) && ((m15 = x_1102[@i_901[@i_77]]) && check2(x_1102[@i_901[@i_77]], mkgen2(rmSK_895[@i_77]), mac15))) then
            let @i_1103 <= N = @i_901[@i_77] in
            let ts3: timest = ts2_953[@i_901[@i_77]] in
            new r16_1100: seed;
            let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16_1100) in
            let x_1101: maxmac = e16 in
            let mac16: macs = mac2(x_1101, mkgen2(rmSK_895[@i_77])) in
            event partSC(hc[@i_142[@i_77]], m14, m15);
            event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
            out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_132: mkey = cst_mkey
    else
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying remove assignments of useless yields

Game 75 is
in(start, ());
new rKt: keyseed;
new rKs: keyseed;
new rmKt: mkeyseed;
new rmKs: mkeyseed;
new rmKc: mkeyseed;
new rKc: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_880[@i_222], AK_1025[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new ts_241: timest;
              new r1_242: seed;
              let e5: maxmac = enc(pad(C, ts_241), AK_1025[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_880[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_880[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_1025[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new ts2_244: timest;
              new r2_245: seed;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(rmAK_215[@i_221], rAK_214[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_214[@i_221]), r1_247) in
              let x_900: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_215[@i_221])) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_910 <= N suchthat defined(mSK_1097[@i_910], SK_23[@i_910], h3[@i_910], n2[@i_910], e11[@i_910], @i_142[@i_910], x_898[@i_910]) && ((@i_142[@i_910] = @i_221) && ((m7 = e11[@i_910]) && check2(e11[@i_910], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_910]) then
                if (h2 = h3[@i_910]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new ts2_951: timest;
                new r2_952: seed;
                let e12: maxmac = enc(pad(C, ts2_951), SK_23[@i_910], r2_952) in
                let mac12: macs = mac(e12, mSK_1097[@i_910]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_1097[@i_910], mac13) then
                if (injbot(padts(ts2_951)) = dec(m13, SK_23[@i_910])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_909 <= N suchthat defined(rmSK_895[@i_909], SK_23[@i_909], h3[@i_909], n2[@i_909], e11[@i_909], @i_142[@i_909], x_899[@i_909]) && ((@i_142[@i_909] = @i_221) && ((m7 = e11[@i_909]) && check2(e11[@i_909], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_909]) then
                if (h2 = h3[@i_909]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new ts2_953: timest;
                new r2_954: seed;
                let e12: maxmac = enc(pad(C, ts2_953), SK_23[@i_909], r2_954) in
                let x_1102: maxmac = cst_maxmac in
                let mac12: macs = mac2(e12, mkgen2(rmSK_895[@i_909])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                find @i_1110 <= N suchthat defined(e16[@i_1110], x_1101[@i_1110], @i_77[@i_1110]) && ((@i_77[@i_1110] = @i_909) && ((m13 = e16[@i_1110]) && check2(e16[@i_1110], mkgen2(rmSK_895[@i_909]), mac13))) then
                  event fullCS(h2, h, m7, e12, m13);
                  out(c10[!_11], acceptC(h, h2))
                orfind  suchthat defined(rmSK_895[@i_909]) && ((m13 = e12) && check2(e12, mkgen2(rmSK_895[@i_909]), mac13)) then
                  yield
              orfind  suchthat defined(rmAK_215[@i_221]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_215[@i_221]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                new r3_204: seed;
                new rmAK_203: mkeyseed;
                let e3: maxmac = enc(concat2(kgen(rAK_202), mkgen(rmAK_203), hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_202), mkgen(rmAK_203), n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_1024: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_879: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_206), mkgen(rmAK_207), n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_1025: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_880: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_210), mkgen(rmAK_211), hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                new rmAK_215: mkeyseed;
                let mAK_881: mkey = cst_mkey in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_1024[@i_142], hc[@i_142], mAK_879[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_879[@i_142], mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_1024[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_882: keyseed;
              let SK_23: key = kgen(rSK_882) in
              new r10_884: seed;
              new rmSK_883: mkeyseed;
              let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_883), hc[@i_142]), Mkey[j3], r10_884) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_885: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_883), n2, h3), AK_1024[@i_142], r11_885) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_886: keyseed;
              let SK_23: key = kgen(rSK_886) in
              new rmSK_887: mkeyseed;
              let mSK_1096: mkey = mkgen(rmSK_887) in
              new r10_888: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_888) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_889: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_887), n2, h3), AK_1024[@i_142], r11_889) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind @i_142 <= N suchthat defined(rAK_214[@i_142], hc[@i_142], rmAK_215[@i_142], e3[@i_142], mAK_881[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            find @i_905 <= N suchthat defined(e11[@i_905], @i_142[@i_905], x_898[@i_905]) && ((@i_142[@i_905] = @i_142) && ((m9 = e11[@i_905]) && check2(e11[@i_905], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_904 <= N suchthat defined(e11[@i_904], @i_142[@i_904], x_899[@i_904]) && ((@i_142[@i_904] = @i_142) && ((m9 = e11[@i_904]) && check2(e11[@i_904], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_901 <= N suchthat defined(e5[@i_901], @i_221[@i_901], x_900[@i_901]) && ((@i_221[@i_901] = @i_142) && ((m9 = e5[@i_901]) && check2(e5[@i_901], mkgen2(rmAK_215[@i_142]), mac9))) then
              event partTC(hc[@i_142], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_890: keyseed;
                let SK_23: key = kgen(rSK_890) in
                new rmSK_891: mkeyseed;
                let mSK_1097: mkey = mkgen(rmSK_891) in
                new r10_892: seed;
                let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_891), hc[@i_142]), Mkey[j3], r10_892) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_893: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_893) in
                let x_898: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
                new rSK_894: keyseed;
                let SK_23: key = kgen(rSK_894) in
                new rmSK_895: mkeyseed;
                let mSK_1098: mkey = cst_mkey in
                new r10_896: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_896) in
                let x_76: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_897: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_897) in
                let x_899: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_1096[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
          if check(m15, mSK_1096[@i_77], mac15) then
          let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
          new r16_1099: seed;
          let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16_1099) in
          let mac16: macs = mac(e16, mSK_1096[@i_77]) in
          event partSC(hc[@i_142[@i_77]], m14, m15);
          event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
        orfind @i_77 <= N suchthat defined(hc[@i_142[@i_77]], SK_23[@i_77], @i_901[@i_77], rmSK_895[@i_77], e10[@i_77], mSK_1098[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
          find @i_1106 <= N suchthat defined(e16[@i_1106], x_1101[@i_1106], @i_77[@i_1106]) && ((@i_77[@i_1106] = @i_77) && ((m15 = e16[@i_1106]) && check2(e16[@i_1106], mkgen2(rmSK_895[@i_77]), mac15))) then
            yield
          orfind  suchthat defined(e12[@i_901[@i_77]], x_1102[@i_901[@i_77]], hc[@i_142[@i_77]], ts2_953[@i_901[@i_77]], @i_909[@i_901[@i_77]]) && ((@i_909[@i_901[@i_77]] = @i_77) && ((m15 = e12[@i_901[@i_77]]) && check2(e12[@i_901[@i_77]], mkgen2(rmSK_895[@i_77]), mac15))) then
            new r16_1100: seed;
            let e16: maxmac = enc(padts(ts2_953[@i_901[@i_77]]), SK_23[@i_77], r16_1100) in
            let x_1101: maxmac = cst_maxmac in
            let mac16: macs = mac2(e16, mkgen2(rmSK_895[@i_77])) in
            event partSC(hc[@i_142[@i_77]], m14, m15);
            event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
            out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_132: mkey = cst_mkey
    else
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


RESULT Proved event fullCS(S, T, z, y, w) ==> fullSC(C, x, y, w) with probability N * Pmac(time + time(context for game 71), 2. * N, 2. * N) + N * Penc(time + time(context for game 63), 2. * N) + 0.5 * N * N / |nonce| + N / |nonce| + N * Pmac(time + time(context for game 54), 2. * N, 2. * N) + Penc(time + time(context for game 46), N) + Penc(time + time(context for game 39), N) + Penc(time + time(context for game 32), N) + Pmac(time + time(context for game 24), N, N) + Pmac(time + time(context for game 16), N, N) + Pmac(time + time(context for game 8), N, N)

Applying remove assignments of binder SK_23 yields

Game 77 is
in(start, ());
new rKt: keyseed;
new rKs: keyseed;
new rmKt: mkeyseed;
new rmKs: mkeyseed;
new rmKc: mkeyseed;
new rKc: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_880[@i_222], AK_1025[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new ts_241: timest;
              new r1_242: seed;
              let e5: maxmac = enc(pad(C, ts_241), AK_1025[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_880[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_880[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_1025[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new ts2_244: timest;
              new r2_245: seed;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(rmAK_215[@i_221], rAK_214[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_214[@i_221]), r1_247) in
              let x_900: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_215[@i_221])) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_910 <= N suchthat defined(mSK_1097[@i_910], SK_23[@i_910], h3[@i_910], n2[@i_910], e11[@i_910], @i_142[@i_910], x_898[@i_910]) && ((@i_142[@i_910] = @i_221) && ((m7 = e11[@i_910]) && check2(e11[@i_910], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_910]) then
                if (h2 = h3[@i_910]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new ts2_951: timest;
                new r2_952: seed;
                let e12: maxmac = enc(pad(C, ts2_951), SK_23[@i_910], r2_952) in
                let mac12: macs = mac(e12, mSK_1097[@i_910]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_1097[@i_910], mac13) then
                if (injbot(padts(ts2_951)) = dec(m13, SK_23[@i_910])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_909 <= N suchthat defined(rmSK_895[@i_909], SK_23[@i_909], h3[@i_909], n2[@i_909], e11[@i_909], @i_142[@i_909], x_899[@i_909]) && ((@i_142[@i_909] = @i_221) && ((m7 = e11[@i_909]) && check2(e11[@i_909], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_909]) then
                if (h2 = h3[@i_909]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new ts2_953: timest;
                new r2_954: seed;
                let e12: maxmac = enc(pad(C, ts2_953), SK_23[@i_909], r2_954) in
                let x_1102: maxmac = cst_maxmac in
                let mac12: macs = mac2(e12, mkgen2(rmSK_895[@i_909])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                find @i_1110 <= N suchthat defined(e16[@i_1110], x_1101[@i_1110], @i_77[@i_1110]) && ((@i_77[@i_1110] = @i_909) && ((m13 = e16[@i_1110]) && check2(e16[@i_1110], mkgen2(rmSK_895[@i_909]), mac13))) then
                  event fullCS(h2, h, m7, e12, m13);
                  out(c10[!_11], acceptC(h, h2))
                orfind  suchthat defined(rmSK_895[@i_909]) && ((m13 = e12) && check2(e12, mkgen2(rmSK_895[@i_909]), mac13)) then
                  yield
              orfind  suchthat defined(rmAK_215[@i_221]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_215[@i_221]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                new r3_204: seed;
                new rmAK_203: mkeyseed;
                let e3: maxmac = enc(concat2(kgen(rAK_202), mkgen(rmAK_203), hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_202), mkgen(rmAK_203), n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_1024: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_879: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_206), mkgen(rmAK_207), n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_1025: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_880: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_210), mkgen(rmAK_211), hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                new rmAK_215: mkeyseed;
                let mAK_881: mkey = cst_mkey in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_1024[@i_142], hc[@i_142], mAK_879[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_879[@i_142], mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_1024[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_882: keyseed;
              let SK_23: key = kgen(rSK_882) in
              new r10_884: seed;
              new rmSK_883: mkeyseed;
              let e10: maxmac = enc(concat2(kgen(rSK_882), mkgen(rmSK_883), hc[@i_142]), Mkey[j3], r10_884) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_885: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_882), mkgen(rmSK_883), n2, h3), AK_1024[@i_142], r11_885) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_886: keyseed;
              let SK_23: key = kgen(rSK_886) in
              new rmSK_887: mkeyseed;
              let mSK_1096: mkey = mkgen(rmSK_887) in
              new r10_888: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_888) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_889: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_886), mkgen(rmSK_887), n2, h3), AK_1024[@i_142], r11_889) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind @i_142 <= N suchthat defined(rAK_214[@i_142], hc[@i_142], rmAK_215[@i_142], e3[@i_142], mAK_881[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            find @i_905 <= N suchthat defined(e11[@i_905], @i_142[@i_905], x_898[@i_905]) && ((@i_142[@i_905] = @i_142) && ((m9 = e11[@i_905]) && check2(e11[@i_905], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_904 <= N suchthat defined(e11[@i_904], @i_142[@i_904], x_899[@i_904]) && ((@i_142[@i_904] = @i_142) && ((m9 = e11[@i_904]) && check2(e11[@i_904], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_901 <= N suchthat defined(e5[@i_901], @i_221[@i_901], x_900[@i_901]) && ((@i_221[@i_901] = @i_142) && ((m9 = e5[@i_901]) && check2(e5[@i_901], mkgen2(rmAK_215[@i_142]), mac9))) then
              event partTC(hc[@i_142], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_890: keyseed;
                let SK_23: key = kgen(rSK_890) in
                new rmSK_891: mkeyseed;
                let mSK_1097: mkey = mkgen(rmSK_891) in
                new r10_892: seed;
                let e10: maxmac = enc(concat2(kgen(rSK_890), mkgen(rmSK_891), hc[@i_142]), Mkey[j3], r10_892) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_893: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_893) in
                let x_898: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
                new rSK_894: keyseed;
                let SK_23: key = kgen(rSK_894) in
                new rmSK_895: mkeyseed;
                let mSK_1098: mkey = cst_mkey in
                new r10_896: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_896) in
                let x_76: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_897: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_897) in
                let x_899: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_23[@i_77], hc[@i_142[@i_77]], mSK_1096[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
          if check(m15, mSK_1096[@i_77], mac15) then
          let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_23[@i_77]) in
          new r16_1099: seed;
          let e16: maxmac = enc(padts(ts3), SK_23[@i_77], r16_1099) in
          let mac16: macs = mac(e16, mSK_1096[@i_77]) in
          event partSC(hc[@i_142[@i_77]], m14, m15);
          event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
        orfind @i_77 <= N suchthat defined(hc[@i_142[@i_77]], SK_23[@i_77], @i_901[@i_77], rmSK_895[@i_77], e10[@i_77], mSK_1098[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
          find @i_1106 <= N suchthat defined(e16[@i_1106], x_1101[@i_1106], @i_77[@i_1106]) && ((@i_77[@i_1106] = @i_77) && ((m15 = e16[@i_1106]) && check2(e16[@i_1106], mkgen2(rmSK_895[@i_77]), mac15))) then
            yield
          orfind  suchthat defined(e12[@i_901[@i_77]], x_1102[@i_901[@i_77]], hc[@i_142[@i_77]], ts2_953[@i_901[@i_77]], @i_909[@i_901[@i_77]]) && ((@i_909[@i_901[@i_77]] = @i_77) && ((m15 = e12[@i_901[@i_77]]) && check2(e12[@i_901[@i_77]], mkgen2(rmSK_895[@i_77]), mac15))) then
            new r16_1100: seed;
            let e16: maxmac = enc(padts(ts2_953[@i_901[@i_77]]), SK_23[@i_77], r16_1100) in
            let x_1101: maxmac = cst_maxmac in
            let mac16: macs = mac2(e16, mkgen2(rmSK_895[@i_77])) in
            event partSC(hc[@i_142[@i_77]], m14, m15);
            event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
            out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_132: mkey = cst_mkey
    else
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying SA rename SK_23 yields

Game 78 is
in(start, ());
new rKt: keyseed;
new rKs: keyseed;
new rmKt: mkeyseed;
new rmKs: mkeyseed;
new rmKc: mkeyseed;
new rKc: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_880[@i_222], AK_1025[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new ts_241: timest;
              new r1_242: seed;
              let e5: maxmac = enc(pad(C, ts_241), AK_1025[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_880[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_880[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_1025[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new ts2_244: timest;
              new r2_245: seed;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(rmAK_215[@i_221], rAK_214[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_214[@i_221]), r1_247) in
              let x_900: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_215[@i_221])) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_910 <= N suchthat defined(mSK_1097[@i_910], SK_1172[@i_910], h3[@i_910], n2[@i_910], e11[@i_910], @i_142[@i_910], x_898[@i_910]) && ((@i_142[@i_910] = @i_221) && ((m7 = e11[@i_910]) && check2(e11[@i_910], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_910]) then
                if (h2 = h3[@i_910]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new ts2_951: timest;
                new r2_952: seed;
                let e12: maxmac = enc(pad(C, ts2_951), SK_1172[@i_910], r2_952) in
                let mac12: macs = mac(e12, mSK_1097[@i_910]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_1097[@i_910], mac13) then
                if (injbot(padts(ts2_951)) = dec(m13, SK_1172[@i_910])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_909 <= N suchthat defined(rmSK_895[@i_909], SK_1173[@i_909], h3[@i_909], n2[@i_909], e11[@i_909], @i_142[@i_909], x_899[@i_909]) && ((@i_142[@i_909] = @i_221) && ((m7 = e11[@i_909]) && check2(e11[@i_909], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_909]) then
                if (h2 = h3[@i_909]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new ts2_953: timest;
                new r2_954: seed;
                let e12: maxmac = enc(pad(C, ts2_953), SK_1173[@i_909], r2_954) in
                let x_1102: maxmac = cst_maxmac in
                let mac12: macs = mac2(e12, mkgen2(rmSK_895[@i_909])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                find @i_1110 <= N suchthat defined(e16[@i_1110], x_1101[@i_1110], @i_77[@i_1110]) && ((@i_77[@i_1110] = @i_909) && ((m13 = e16[@i_1110]) && check2(e16[@i_1110], mkgen2(rmSK_895[@i_909]), mac13))) then
                  event fullCS(h2, h, m7, e12, m13);
                  out(c10[!_11], acceptC(h, h2))
                orfind  suchthat defined(rmSK_895[@i_909]) && ((m13 = e12) && check2(e12, mkgen2(rmSK_895[@i_909]), mac13)) then
                  yield
              orfind  suchthat defined(rmAK_215[@i_221]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_215[@i_221]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                new r3_204: seed;
                new rmAK_203: mkeyseed;
                let e3: maxmac = enc(concat2(kgen(rAK_202), mkgen(rmAK_203), hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_202), mkgen(rmAK_203), n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_1024: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_879: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_206), mkgen(rmAK_207), n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_1025: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_880: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_210), mkgen(rmAK_211), hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                new rmAK_215: mkeyseed;
                let mAK_881: mkey = cst_mkey in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_1024[@i_142], hc[@i_142], mAK_879[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_879[@i_142], mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_1024[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_882: keyseed;
              let SK_1170: key = kgen(rSK_882) in
              new r10_884: seed;
              new rmSK_883: mkeyseed;
              let e10: maxmac = enc(concat2(kgen(rSK_882), mkgen(rmSK_883), hc[@i_142]), Mkey[j3], r10_884) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_885: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_882), mkgen(rmSK_883), n2, h3), AK_1024[@i_142], r11_885) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_886: keyseed;
              let SK_1171: key = kgen(rSK_886) in
              new rmSK_887: mkeyseed;
              let mSK_1096: mkey = mkgen(rmSK_887) in
              new r10_888: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_888) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_889: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_886), mkgen(rmSK_887), n2, h3), AK_1024[@i_142], r11_889) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind @i_142 <= N suchthat defined(rAK_214[@i_142], hc[@i_142], rmAK_215[@i_142], e3[@i_142], mAK_881[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            find @i_905 <= N suchthat defined(e11[@i_905], @i_142[@i_905], x_898[@i_905]) && ((@i_142[@i_905] = @i_142) && ((m9 = e11[@i_905]) && check2(e11[@i_905], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_904 <= N suchthat defined(e11[@i_904], @i_142[@i_904], x_899[@i_904]) && ((@i_142[@i_904] = @i_142) && ((m9 = e11[@i_904]) && check2(e11[@i_904], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_901 <= N suchthat defined(e5[@i_901], @i_221[@i_901], x_900[@i_901]) && ((@i_221[@i_901] = @i_142) && ((m9 = e5[@i_901]) && check2(e5[@i_901], mkgen2(rmAK_215[@i_142]), mac9))) then
              event partTC(hc[@i_142], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_890: keyseed;
                let SK_1172: key = kgen(rSK_890) in
                new rmSK_891: mkeyseed;
                let mSK_1097: mkey = mkgen(rmSK_891) in
                new r10_892: seed;
                let e10: maxmac = enc(concat2(kgen(rSK_890), mkgen(rmSK_891), hc[@i_142]), Mkey[j3], r10_892) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_893: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_893) in
                let x_898: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
                new rSK_894: keyseed;
                let SK_1173: key = kgen(rSK_894) in
                new rmSK_895: mkeyseed;
                let mSK_1098: mkey = cst_mkey in
                new r10_896: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_896) in
                let x_76: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_897: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_897) in
                let x_899: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_1171[@i_77], hc[@i_142[@i_77]], mSK_1096[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
          if check(m15, mSK_1096[@i_77], mac15) then
          let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_1171[@i_77]) in
          new r16_1099: seed;
          let e16: maxmac = enc(padts(ts3), SK_1171[@i_77], r16_1099) in
          let mac16: macs = mac(e16, mSK_1096[@i_77]) in
          event partSC(hc[@i_142[@i_77]], m14, m15);
          event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
        orfind @i_77 <= N suchthat defined(hc[@i_142[@i_77]], SK_1173[@i_77], @i_901[@i_77], rmSK_895[@i_77], e10[@i_77], mSK_1098[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
          find @i_1106 <= N suchthat defined(e16[@i_1106], x_1101[@i_1106], @i_77[@i_1106]) && ((@i_77[@i_1106] = @i_77) && ((m15 = e16[@i_1106]) && check2(e16[@i_1106], mkgen2(rmSK_895[@i_77]), mac15))) then
            yield
          orfind  suchthat defined(e12[@i_901[@i_77]], x_1102[@i_901[@i_77]], hc[@i_142[@i_77]], ts2_953[@i_901[@i_77]], @i_909[@i_901[@i_77]]) && ((@i_909[@i_901[@i_77]] = @i_77) && ((m15 = e12[@i_901[@i_77]]) && check2(e12[@i_901[@i_77]], mkgen2(rmSK_895[@i_77]), mac15))) then
            new r16_1100: seed;
            let e16: maxmac = enc(padts(ts2_953[@i_901[@i_77]]), SK_1173[@i_77], r16_1100) in
            let x_1101: maxmac = cst_maxmac in
            let mac16: macs = mac2(e16, mkgen2(rmSK_895[@i_77])) in
            event partSC(hc[@i_142[@i_77]], m14, m15);
            event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
            out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_132: mkey = cst_mkey
    else
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying remove assignments of binder SK_23 yields

Game 79 is
in(start, ());
new rKt: keyseed;
new rKs: keyseed;
new rmKt: mkeyseed;
new rmKs: mkeyseed;
new rmKc: mkeyseed;
new rKc: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_880[@i_222], AK_1025[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new ts_241: timest;
              new r1_242: seed;
              let e5: maxmac = enc(pad(C, ts_241), AK_1025[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_880[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_880[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_1025[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new ts2_244: timest;
              new r2_245: seed;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(rmAK_215[@i_221], rAK_214[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_214[@i_221]), r1_247) in
              let x_900: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_215[@i_221])) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_910 <= N suchthat defined(mSK_1097[@i_910], SK_1172[@i_910], h3[@i_910], n2[@i_910], e11[@i_910], @i_142[@i_910], x_898[@i_910]) && ((@i_142[@i_910] = @i_221) && ((m7 = e11[@i_910]) && check2(e11[@i_910], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_910]) then
                if (h2 = h3[@i_910]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new ts2_951: timest;
                new r2_952: seed;
                let e12: maxmac = enc(pad(C, ts2_951), SK_1172[@i_910], r2_952) in
                let mac12: macs = mac(e12, mSK_1097[@i_910]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_1097[@i_910], mac13) then
                if (injbot(padts(ts2_951)) = dec(m13, SK_1172[@i_910])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_909 <= N suchthat defined(rmSK_895[@i_909], SK_1173[@i_909], h3[@i_909], n2[@i_909], e11[@i_909], @i_142[@i_909], x_899[@i_909]) && ((@i_142[@i_909] = @i_221) && ((m7 = e11[@i_909]) && check2(e11[@i_909], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_909]) then
                if (h2 = h3[@i_909]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new ts2_953: timest;
                new r2_954: seed;
                let e12: maxmac = enc(pad(C, ts2_953), SK_1173[@i_909], r2_954) in
                let x_1102: maxmac = cst_maxmac in
                let mac12: macs = mac2(e12, mkgen2(rmSK_895[@i_909])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                find @i_1110 <= N suchthat defined(e16[@i_1110], x_1101[@i_1110], @i_77[@i_1110]) && ((@i_77[@i_1110] = @i_909) && ((m13 = e16[@i_1110]) && check2(e16[@i_1110], mkgen2(rmSK_895[@i_909]), mac13))) then
                  event fullCS(h2, h, m7, e12, m13);
                  out(c10[!_11], acceptC(h, h2))
                orfind  suchthat defined(rmSK_895[@i_909]) && ((m13 = e12) && check2(e12, mkgen2(rmSK_895[@i_909]), mac13)) then
                  yield
              orfind  suchthat defined(rmAK_215[@i_221]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_215[@i_221]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                new r3_204: seed;
                new rmAK_203: mkeyseed;
                let e3: maxmac = enc(concat2(kgen(rAK_202), mkgen(rmAK_203), hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_202), mkgen(rmAK_203), n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_1024: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_879: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_206), mkgen(rmAK_207), n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_1025: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_880: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_210), mkgen(rmAK_211), hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                new rmAK_215: mkeyseed;
                let mAK_881: mkey = cst_mkey in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_1024[@i_142], hc[@i_142], mAK_879[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_879[@i_142], mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_1024[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_882: keyseed;
              new r10_884: seed;
              new rmSK_883: mkeyseed;
              let e10: maxmac = enc(concat2(kgen(rSK_882), mkgen(rmSK_883), hc[@i_142]), Mkey[j3], r10_884) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_885: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_882), mkgen(rmSK_883), n2, h3), AK_1024[@i_142], r11_885) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_886: keyseed;
              let SK_1171: key = kgen(rSK_886) in
              new rmSK_887: mkeyseed;
              let mSK_1096: mkey = mkgen(rmSK_887) in
              new r10_888: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_888) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_889: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_886), mkgen(rmSK_887), n2, h3), AK_1024[@i_142], r11_889) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind @i_142 <= N suchthat defined(rAK_214[@i_142], hc[@i_142], rmAK_215[@i_142], e3[@i_142], mAK_881[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            find @i_905 <= N suchthat defined(e11[@i_905], @i_142[@i_905], x_898[@i_905]) && ((@i_142[@i_905] = @i_142) && ((m9 = e11[@i_905]) && check2(e11[@i_905], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_904 <= N suchthat defined(e11[@i_904], @i_142[@i_904], x_899[@i_904]) && ((@i_142[@i_904] = @i_142) && ((m9 = e11[@i_904]) && check2(e11[@i_904], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_901 <= N suchthat defined(e5[@i_901], @i_221[@i_901], x_900[@i_901]) && ((@i_221[@i_901] = @i_142) && ((m9 = e5[@i_901]) && check2(e5[@i_901], mkgen2(rmAK_215[@i_142]), mac9))) then
              event partTC(hc[@i_142], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_890: keyseed;
                let SK_1172: key = kgen(rSK_890) in
                new rmSK_891: mkeyseed;
                let mSK_1097: mkey = mkgen(rmSK_891) in
                new r10_892: seed;
                let e10: maxmac = enc(concat2(kgen(rSK_890), mkgen(rmSK_891), hc[@i_142]), Mkey[j3], r10_892) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_893: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_893) in
                let x_898: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
                new rSK_894: keyseed;
                let SK_1173: key = kgen(rSK_894) in
                new rmSK_895: mkeyseed;
                let mSK_1098: mkey = cst_mkey in
                new r10_896: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_896) in
                let x_76: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_897: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_897) in
                let x_899: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_1171[@i_77], hc[@i_142[@i_77]], mSK_1096[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
          if check(m15, mSK_1096[@i_77], mac15) then
          let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_1171[@i_77]) in
          new r16_1099: seed;
          let e16: maxmac = enc(padts(ts3), SK_1171[@i_77], r16_1099) in
          let mac16: macs = mac(e16, mSK_1096[@i_77]) in
          event partSC(hc[@i_142[@i_77]], m14, m15);
          event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
        orfind @i_77 <= N suchthat defined(hc[@i_142[@i_77]], SK_1173[@i_77], @i_901[@i_77], rmSK_895[@i_77], e10[@i_77], mSK_1098[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
          find @i_1106 <= N suchthat defined(e16[@i_1106], x_1101[@i_1106], @i_77[@i_1106]) && ((@i_77[@i_1106] = @i_77) && ((m15 = e16[@i_1106]) && check2(e16[@i_1106], mkgen2(rmSK_895[@i_77]), mac15))) then
            yield
          orfind  suchthat defined(e12[@i_901[@i_77]], x_1102[@i_901[@i_77]], hc[@i_142[@i_77]], ts2_953[@i_901[@i_77]], @i_909[@i_901[@i_77]]) && ((@i_909[@i_901[@i_77]] = @i_77) && ((m15 = e12[@i_901[@i_77]]) && check2(e12[@i_901[@i_77]], mkgen2(rmSK_895[@i_77]), mac15))) then
            new r16_1100: seed;
            let e16: maxmac = enc(padts(ts2_953[@i_901[@i_77]]), SK_1173[@i_77], r16_1100) in
            let x_1101: maxmac = cst_maxmac in
            let mac16: macs = mac2(e16, mkgen2(rmSK_895[@i_77])) in
            event partSC(hc[@i_142[@i_77]], m14, m15);
            event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
            out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_132: mkey = cst_mkey
    else
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying remove assignments of binder SK_1173 yields

Game 80 is
in(start, ());
new rKt: keyseed;
new rKs: keyseed;
new rmKt: mkeyseed;
new rmKs: mkeyseed;
new rmKc: mkeyseed;
new rKc: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_880[@i_222], AK_1025[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new ts_241: timest;
              new r1_242: seed;
              let e5: maxmac = enc(pad(C, ts_241), AK_1025[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_880[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_880[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_1025[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new ts2_244: timest;
              new r2_245: seed;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(rmAK_215[@i_221], rAK_214[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_214[@i_221]), r1_247) in
              let x_900: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_215[@i_221])) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_910 <= N suchthat defined(mSK_1097[@i_910], SK_1172[@i_910], h3[@i_910], n2[@i_910], e11[@i_910], @i_142[@i_910], x_898[@i_910]) && ((@i_142[@i_910] = @i_221) && ((m7 = e11[@i_910]) && check2(e11[@i_910], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_910]) then
                if (h2 = h3[@i_910]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new ts2_951: timest;
                new r2_952: seed;
                let e12: maxmac = enc(pad(C, ts2_951), SK_1172[@i_910], r2_952) in
                let mac12: macs = mac(e12, mSK_1097[@i_910]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_1097[@i_910], mac13) then
                if (injbot(padts(ts2_951)) = dec(m13, SK_1172[@i_910])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_909 <= N suchthat defined(rSK_894[@i_909], SK_1173[@i_909], rmSK_895[@i_909], h3[@i_909], n2[@i_909], e11[@i_909], @i_142[@i_909], x_899[@i_909]) && ((@i_142[@i_909] = @i_221) && ((m7 = e11[@i_909]) && check2(e11[@i_909], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_909]) then
                if (h2 = h3[@i_909]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new ts2_953: timest;
                new r2_954: seed;
                let e12: maxmac = enc(pad(C, ts2_953), kgen(rSK_894[@i_909]), r2_954) in
                let x_1102: maxmac = cst_maxmac in
                let mac12: macs = mac2(e12, mkgen2(rmSK_895[@i_909])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                find @i_1110 <= N suchthat defined(e16[@i_1110], x_1101[@i_1110], @i_77[@i_1110]) && ((@i_77[@i_1110] = @i_909) && ((m13 = e16[@i_1110]) && check2(e16[@i_1110], mkgen2(rmSK_895[@i_909]), mac13))) then
                  event fullCS(h2, h, m7, e12, m13);
                  out(c10[!_11], acceptC(h, h2))
                orfind  suchthat defined(rmSK_895[@i_909]) && ((m13 = e12) && check2(e12, mkgen2(rmSK_895[@i_909]), mac13)) then
                  yield
              orfind  suchthat defined(rmAK_215[@i_221]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_215[@i_221]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                new r3_204: seed;
                new rmAK_203: mkeyseed;
                let e3: maxmac = enc(concat2(kgen(rAK_202), mkgen(rmAK_203), hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_202), mkgen(rmAK_203), n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_1024: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_879: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_206), mkgen(rmAK_207), n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_1025: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_880: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_210), mkgen(rmAK_211), hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                new rmAK_215: mkeyseed;
                let mAK_881: mkey = cst_mkey in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_1024[@i_142], hc[@i_142], mAK_879[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_879[@i_142], mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_1024[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_882: keyseed;
              new r10_884: seed;
              new rmSK_883: mkeyseed;
              let e10: maxmac = enc(concat2(kgen(rSK_882), mkgen(rmSK_883), hc[@i_142]), Mkey[j3], r10_884) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_885: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_882), mkgen(rmSK_883), n2, h3), AK_1024[@i_142], r11_885) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_886: keyseed;
              let SK_1171: key = kgen(rSK_886) in
              new rmSK_887: mkeyseed;
              let mSK_1096: mkey = mkgen(rmSK_887) in
              new r10_888: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_888) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_889: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_886), mkgen(rmSK_887), n2, h3), AK_1024[@i_142], r11_889) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind @i_142 <= N suchthat defined(rAK_214[@i_142], hc[@i_142], rmAK_215[@i_142], e3[@i_142], mAK_881[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            find @i_905 <= N suchthat defined(e11[@i_905], @i_142[@i_905], x_898[@i_905]) && ((@i_142[@i_905] = @i_142) && ((m9 = e11[@i_905]) && check2(e11[@i_905], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_904 <= N suchthat defined(e11[@i_904], @i_142[@i_904], x_899[@i_904]) && ((@i_142[@i_904] = @i_142) && ((m9 = e11[@i_904]) && check2(e11[@i_904], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_901 <= N suchthat defined(e5[@i_901], @i_221[@i_901], x_900[@i_901]) && ((@i_221[@i_901] = @i_142) && ((m9 = e5[@i_901]) && check2(e5[@i_901], mkgen2(rmAK_215[@i_142]), mac9))) then
              event partTC(hc[@i_142], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_890: keyseed;
                let SK_1172: key = kgen(rSK_890) in
                new rmSK_891: mkeyseed;
                let mSK_1097: mkey = mkgen(rmSK_891) in
                new r10_892: seed;
                let e10: maxmac = enc(concat2(kgen(rSK_890), mkgen(rmSK_891), hc[@i_142]), Mkey[j3], r10_892) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_893: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_893) in
                let x_898: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
                new rSK_894: keyseed;
                let SK_1173: key = cst_key in
                new rmSK_895: mkeyseed;
                let mSK_1098: mkey = cst_mkey in
                new r10_896: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_896) in
                let x_76: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_897: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_897) in
                let x_899: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_1171[@i_77], hc[@i_142[@i_77]], mSK_1096[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
          if check(m15, mSK_1096[@i_77], mac15) then
          let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_1171[@i_77]) in
          new r16_1099: seed;
          let e16: maxmac = enc(padts(ts3), SK_1171[@i_77], r16_1099) in
          let mac16: macs = mac(e16, mSK_1096[@i_77]) in
          event partSC(hc[@i_142[@i_77]], m14, m15);
          event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
        orfind @i_77 <= N suchthat defined(rSK_894[@i_77], SK_1173[@i_77], hc[@i_142[@i_77]], @i_901[@i_77], rmSK_895[@i_77], e10[@i_77], mSK_1098[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
          find @i_1106 <= N suchthat defined(e16[@i_1106], x_1101[@i_1106], @i_77[@i_1106]) && ((@i_77[@i_1106] = @i_77) && ((m15 = e16[@i_1106]) && check2(e16[@i_1106], mkgen2(rmSK_895[@i_77]), mac15))) then
            yield
          orfind  suchthat defined(e12[@i_901[@i_77]], x_1102[@i_901[@i_77]], hc[@i_142[@i_77]], ts2_953[@i_901[@i_77]], @i_909[@i_901[@i_77]]) && ((@i_909[@i_901[@i_77]] = @i_77) && ((m15 = e12[@i_901[@i_77]]) && check2(e12[@i_901[@i_77]], mkgen2(rmSK_895[@i_77]), mac15))) then
            new r16_1100: seed;
            let e16: maxmac = enc(padts(ts2_953[@i_901[@i_77]]), kgen(rSK_894[@i_77]), r16_1100) in
            let x_1101: maxmac = cst_maxmac in
            let mac16: macs = mac2(e16, mkgen2(rmSK_895[@i_77])) in
            event partSC(hc[@i_142[@i_77]], m14, m15);
            event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
            out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_132: mkey = cst_mkey
    else
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r16_1100 [Difference of probability N * Penc(time + time(context for game 80), 2. * N)] yields

Game 81 is
in(start, ());
new rKt: keyseed;
new rKs: keyseed;
new rmKt: mkeyseed;
new rmKs: mkeyseed;
new rmKc: mkeyseed;
new rKc: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_880[@i_222], AK_1025[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new ts_241: timest;
              new r1_242: seed;
              let e5: maxmac = enc(pad(C, ts_241), AK_1025[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_880[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_880[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_1025[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new ts2_244: timest;
              new r2_245: seed;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(rmAK_215[@i_221], rAK_214[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_214[@i_221]), r1_247) in
              let x_900: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_215[@i_221])) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_910 <= N suchthat defined(mSK_1097[@i_910], SK_1172[@i_910], h3[@i_910], n2[@i_910], e11[@i_910], @i_142[@i_910], x_898[@i_910]) && ((@i_142[@i_910] = @i_221) && ((m7 = e11[@i_910]) && check2(e11[@i_910], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_910]) then
                if (h2 = h3[@i_910]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new ts2_951: timest;
                new r2_952: seed;
                let e12: maxmac = enc(pad(C, ts2_951), SK_1172[@i_910], r2_952) in
                let mac12: macs = mac(e12, mSK_1097[@i_910]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_1097[@i_910], mac13) then
                if (injbot(padts(ts2_951)) = dec(m13, SK_1172[@i_910])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_909 <= N suchthat defined(rSK_894[@i_909], SK_1173[@i_909], rmSK_895[@i_909], h3[@i_909], n2[@i_909], e11[@i_909], @i_142[@i_909], x_899[@i_909]) && ((@i_142[@i_909] = @i_221) && ((m7 = e11[@i_909]) && check2(e11[@i_909], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_909]) then
                if (h2 = h3[@i_909]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new ts2_953: timest;
                new r2_954: seed;
                let e12: maxmac = enc2(Z(pad(C, ts2_953)), kgen2(rSK_894[@i_909]), r2_954) in
                let x_1102: maxmac = cst_maxmac in
                let mac12: macs = mac2(e12, mkgen2(rmSK_895[@i_909])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                find @i_1110 <= N suchthat defined(e16[@i_1110], x_1101[@i_1110], @i_77[@i_1110]) && ((@i_77[@i_1110] = @i_909) && ((m13 = e16[@i_1110]) && check2(e16[@i_1110], mkgen2(rmSK_895[@i_909]), mac13))) then
                  event fullCS(h2, h, m7, e12, m13);
                  out(c10[!_11], acceptC(h, h2))
                orfind  suchthat defined(rmSK_895[@i_909]) && ((m13 = e12) && check2(e12, mkgen2(rmSK_895[@i_909]), mac13)) then
                  yield
              orfind  suchthat defined(rmAK_215[@i_221]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_215[@i_221]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                new r3_204: seed;
                new rmAK_203: mkeyseed;
                let e3: maxmac = enc(concat2(kgen(rAK_202), mkgen(rmAK_203), hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_202), mkgen(rmAK_203), n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_1024: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_879: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_206), mkgen(rmAK_207), n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_1025: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_880: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_210), mkgen(rmAK_211), hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                new rmAK_215: mkeyseed;
                let mAK_881: mkey = cst_mkey in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_1024[@i_142], hc[@i_142], mAK_879[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_879[@i_142], mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_1024[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_882: keyseed;
              new r10_884: seed;
              new rmSK_883: mkeyseed;
              let e10: maxmac = enc(concat2(kgen(rSK_882), mkgen(rmSK_883), hc[@i_142]), Mkey[j3], r10_884) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_885: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_882), mkgen(rmSK_883), n2, h3), AK_1024[@i_142], r11_885) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_886: keyseed;
              let SK_1171: key = kgen(rSK_886) in
              new rmSK_887: mkeyseed;
              let mSK_1096: mkey = mkgen(rmSK_887) in
              new r10_888: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_888) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_889: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_886), mkgen(rmSK_887), n2, h3), AK_1024[@i_142], r11_889) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind @i_142 <= N suchthat defined(rAK_214[@i_142], hc[@i_142], rmAK_215[@i_142], e3[@i_142], mAK_881[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            find @i_905 <= N suchthat defined(e11[@i_905], @i_142[@i_905], x_898[@i_905]) && ((@i_142[@i_905] = @i_142) && ((m9 = e11[@i_905]) && check2(e11[@i_905], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_904 <= N suchthat defined(e11[@i_904], @i_142[@i_904], x_899[@i_904]) && ((@i_142[@i_904] = @i_142) && ((m9 = e11[@i_904]) && check2(e11[@i_904], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_901 <= N suchthat defined(e5[@i_901], @i_221[@i_901], x_900[@i_901]) && ((@i_221[@i_901] = @i_142) && ((m9 = e5[@i_901]) && check2(e5[@i_901], mkgen2(rmAK_215[@i_142]), mac9))) then
              event partTC(hc[@i_142], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_890: keyseed;
                let SK_1172: key = kgen(rSK_890) in
                new rmSK_891: mkeyseed;
                let mSK_1097: mkey = mkgen(rmSK_891) in
                new r10_892: seed;
                let e10: maxmac = enc(concat2(kgen(rSK_890), mkgen(rmSK_891), hc[@i_142]), Mkey[j3], r10_892) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_893: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_893) in
                let x_898: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
                new rSK_894: keyseed;
                let SK_1173: key = cst_key in
                new rmSK_895: mkeyseed;
                let mSK_1098: mkey = cst_mkey in
                new r10_896: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_896) in
                let x_76: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_897: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_897) in
                let x_899: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_1171[@i_77], hc[@i_142[@i_77]], mSK_1096[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
          if check(m15, mSK_1096[@i_77], mac15) then
          let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_1171[@i_77]) in
          new r16_1099: seed;
          let e16: maxmac = enc(padts(ts3), SK_1171[@i_77], r16_1099) in
          let mac16: macs = mac(e16, mSK_1096[@i_77]) in
          event partSC(hc[@i_142[@i_77]], m14, m15);
          event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
        orfind @i_77 <= N suchthat defined(rSK_894[@i_77], SK_1173[@i_77], hc[@i_142[@i_77]], @i_901[@i_77], rmSK_895[@i_77], e10[@i_77], mSK_1098[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
          find @i_1106 <= N suchthat defined(e16[@i_1106], x_1101[@i_1106], @i_77[@i_1106]) && ((@i_77[@i_1106] = @i_77) && ((m15 = e16[@i_1106]) && check2(e16[@i_1106], mkgen2(rmSK_895[@i_77]), mac15))) then
            yield
          orfind  suchthat defined(e12[@i_901[@i_77]], x_1102[@i_901[@i_77]], hc[@i_142[@i_77]], ts2_953[@i_901[@i_77]], @i_909[@i_901[@i_77]]) && ((@i_909[@i_901[@i_77]] = @i_77) && ((m15 = e12[@i_901[@i_77]]) && check2(e12[@i_901[@i_77]], mkgen2(rmSK_895[@i_77]), mac15))) then
            new r16_1100: seed;
            let e16: maxmac = enc2(Z(padts(ts2_953[@i_901[@i_77]])), kgen2(rSK_894[@i_77]), r16_1100) in
            let x_1101: maxmac = cst_maxmac in
            let mac16: macs = mac2(e16, mkgen2(rmSK_895[@i_77])) in
            event partSC(hc[@i_142[@i_77]], m14, m15);
            event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
            out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_132: mkey = cst_mkey
    else
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying simplify yields

Game 82 is
in(start, ());
new rKt: keyseed;
new rKs: keyseed;
new rmKt: mkeyseed;
new rmKs: mkeyseed;
new rmKc: mkeyseed;
new rKc: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_880[@i_222], AK_1025[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new ts_241: timest;
              new r1_242: seed;
              let e5: maxmac = enc(pad(C, ts_241), AK_1025[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_880[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_880[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_1025[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new ts2_244: timest;
              new r2_245: seed;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(rmAK_215[@i_221], rAK_214[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_214[@i_221]), r1_247) in
              let x_900: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_215[@i_221])) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_910 <= N suchthat defined(mSK_1097[@i_910], SK_1172[@i_910], h3[@i_910], n2[@i_910], e11[@i_910], @i_142[@i_910], x_898[@i_910]) && ((@i_142[@i_910] = @i_221) && ((m7 = e11[@i_910]) && check2(e11[@i_910], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_910]) then
                if (h2 = h3[@i_910]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new ts2_951: timest;
                new r2_952: seed;
                let e12: maxmac = enc(pad(C, ts2_951), SK_1172[@i_910], r2_952) in
                let mac12: macs = mac(e12, mSK_1097[@i_910]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_1097[@i_910], mac13) then
                if (injbot(padts(ts2_951)) = dec(m13, SK_1172[@i_910])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_909 <= N suchthat defined(rmSK_895[@i_909], rSK_894[@i_909], h3[@i_909], n2[@i_909], e11[@i_909], @i_142[@i_909], x_899[@i_909]) && ((@i_142[@i_909] = @i_221) && ((m7 = e11[@i_909]) && check2(e11[@i_909], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_909]) then
                if (h2 = h3[@i_909]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new r2_954: seed;
                let e12: maxmac = enc2(Zpad, kgen2(rSK_894[@i_909]), r2_954) in
                let x_1102: maxmac = cst_maxmac in
                let mac12: macs = mac2(e12, mkgen2(rmSK_895[@i_909])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                find @i_1110 <= N suchthat defined(e16[@i_1110], @i_77[@i_1110], x_1101[@i_1110]) && ((@i_77[@i_1110] = @i_909) && ((m13 = e16[@i_1110]) && check2(e16[@i_1110], mkgen2(rmSK_895[@i_909]), mac13))) then
                  event fullCS(h2, h, m7, e12, m13);
                  out(c10[!_11], acceptC(h, h2))
                orfind  suchthat defined(rmSK_895[@i_909]) && ((m13 = e12) && check2(e12, mkgen2(rmSK_895[@i_909]), mac13)) then
                  yield
              orfind  suchthat defined(rmAK_215[@i_221]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_215[@i_221]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_202: keyseed;
                new r3_204: seed;
                new rmAK_203: mkeyseed;
                let e3: maxmac = enc(concat2(kgen(rAK_202), mkgen(rmAK_203), hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_202), mkgen(rmAK_203), n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_1024: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_879: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_206), mkgen(rmAK_207), n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_1025: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_880: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_210), mkgen(rmAK_211), hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                new rmAK_215: mkeyseed;
                let mAK_881: mkey = cst_mkey in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_1024[@i_142], hc[@i_142], mAK_879[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_879[@i_142], mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_1024[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_882: keyseed;
              new r10_884: seed;
              new rmSK_883: mkeyseed;
              let e10: maxmac = enc(concat2(kgen(rSK_882), mkgen(rmSK_883), hc[@i_142]), Mkey[j3], r10_884) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_885: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_882), mkgen(rmSK_883), n2, h3), AK_1024[@i_142], r11_885) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_886: keyseed;
              let SK_1171: key = kgen(rSK_886) in
              new rmSK_887: mkeyseed;
              let mSK_1096: mkey = mkgen(rmSK_887) in
              new r10_888: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_888) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_889: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_886), mkgen(rmSK_887), n2, h3), AK_1024[@i_142], r11_889) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind @i_142 <= N suchthat defined(rAK_214[@i_142], hc[@i_142], rmAK_215[@i_142], e3[@i_142], mAK_881[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            find @i_905 <= N suchthat defined(e11[@i_905], @i_142[@i_905], x_898[@i_905]) && ((@i_142[@i_905] = @i_142) && ((m9 = e11[@i_905]) && check2(e11[@i_905], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_904 <= N suchthat defined(e11[@i_904], @i_142[@i_904], x_899[@i_904]) && ((@i_142[@i_904] = @i_142) && ((m9 = e11[@i_904]) && check2(e11[@i_904], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_901 <= N suchthat defined(e5[@i_901], @i_221[@i_901], x_900[@i_901]) && ((@i_221[@i_901] = @i_142) && ((m9 = e5[@i_901]) && check2(e5[@i_901], mkgen2(rmAK_215[@i_142]), mac9))) then
              event partTC(hc[@i_142], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_890: keyseed;
                let SK_1172: key = kgen(rSK_890) in
                new rmSK_891: mkeyseed;
                let mSK_1097: mkey = mkgen(rmSK_891) in
                new r10_892: seed;
                let e10: maxmac = enc(concat2(kgen(rSK_890), mkgen(rmSK_891), hc[@i_142]), Mkey[j3], r10_892) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_893: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_893) in
                let x_898: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
                new rSK_894: keyseed;
                let SK_1173: key = cst_key in
                new rmSK_895: mkeyseed;
                let mSK_1098: mkey = cst_mkey in
                new r10_896: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_896) in
                let x_76: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_897: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_897) in
                let x_899: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_1171[@i_77], hc[@i_142[@i_77]], mSK_1096[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
          if check(m15, mSK_1096[@i_77], mac15) then
          let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_1171[@i_77]) in
          new r16_1099: seed;
          let e16: maxmac = enc(padts(ts3), SK_1171[@i_77], r16_1099) in
          let mac16: macs = mac(e16, mSK_1096[@i_77]) in
          event partSC(hc[@i_142[@i_77]], m14, m15);
          event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
        orfind @i_77 <= N suchthat defined(hc[@i_142[@i_77]], rSK_894[@i_77], rmSK_895[@i_77], e10[@i_77], mSK_1098[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
          find @i_1106 <= N suchthat defined(e16[@i_1106], @i_77[@i_1106], x_1101[@i_1106]) && ((@i_77[@i_1106] = @i_77) && ((m15 = e16[@i_1106]) && check2(e16[@i_1106], mkgen2(rmSK_895[@i_77]), mac15))) then
            yield
          orfind  suchthat defined(hc[@i_142[@i_77]], e12[@i_901[@i_77]], @i_909[@i_901[@i_77]], x_1102[@i_901[@i_77]]) && ((@i_909[@i_901[@i_77]] = @i_77) && ((m15 = e12[@i_901[@i_77]]) && check2(e12[@i_901[@i_77]], mkgen2(rmSK_895[@i_77]), mac15))) then
            new r16_1100: seed;
            let e16: maxmac = enc2(Zpadts, kgen2(rSK_894[@i_77]), r16_1100) in
            let x_1101: maxmac = cst_maxmac in
            let mac16: macs = mac2(e16, mkgen2(rmSK_895[@i_77])) in
            event partSC(hc[@i_142[@i_77]], m14, m15);
            event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
            out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_132: mkey = cst_mkey
    else
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying move new all binders yields

Game 83 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rmKs: mkeyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rKt: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_880[@i_222], AK_1025[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new r1_242: seed;
              new ts_241: timest;
              let e5: maxmac = enc(pad(C, ts_241), AK_1025[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_880[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_880[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_1025[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new r2_245: seed;
              new ts2_244: timest;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(rmAK_215[@i_221], rAK_214[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_214[@i_221]), r1_247) in
              let x_900: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_215[@i_221])) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_910 <= N suchthat defined(mSK_1097[@i_910], SK_1172[@i_910], h3[@i_910], n2[@i_910], e11[@i_910], @i_142[@i_910], x_898[@i_910]) && ((@i_142[@i_910] = @i_221) && ((m7 = e11[@i_910]) && check2(e11[@i_910], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_910]) then
                if (h2 = h3[@i_910]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new r2_952: seed;
                new ts2_951: timest;
                let e12: maxmac = enc(pad(C, ts2_951), SK_1172[@i_910], r2_952) in
                let mac12: macs = mac(e12, mSK_1097[@i_910]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_1097[@i_910], mac13) then
                if (injbot(padts(ts2_951)) = dec(m13, SK_1172[@i_910])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_909 <= N suchthat defined(rmSK_895[@i_909], rSK_894[@i_909], h3[@i_909], n2[@i_909], e11[@i_909], @i_142[@i_909], x_899[@i_909]) && ((@i_142[@i_909] = @i_221) && ((m7 = e11[@i_909]) && check2(e11[@i_909], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_909]) then
                if (h2 = h3[@i_909]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new r2_954: seed;
                let e12: maxmac = enc2(Zpad, kgen2(rSK_894[@i_909]), r2_954) in
                let x_1102: maxmac = cst_maxmac in
                let mac12: macs = mac2(e12, mkgen2(rmSK_895[@i_909])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                find @i_1110 <= N suchthat defined(e16[@i_1110], @i_77[@i_1110], x_1101[@i_1110]) && ((@i_77[@i_1110] = @i_909) && ((m13 = e16[@i_1110]) && check2(e16[@i_1110], mkgen2(rmSK_895[@i_909]), mac13))) then
                  event fullCS(h2, h, m7, e12, m13);
                  out(c10[!_11], acceptC(h, h2))
                orfind  suchthat defined(rmSK_895[@i_909]) && ((m13 = e12) && check2(e12, mkgen2(rmSK_895[@i_909]), mac13)) then
                  yield
              orfind  suchthat defined(rmAK_215[@i_221]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_215[@i_221]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rmAK_203: mkeyseed;
                new r3_204: seed;
                new rAK_202: keyseed;
                let e3: maxmac = enc(concat2(kgen(rAK_202), mkgen(rmAK_203), hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_202), mkgen(rmAK_203), n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_1024: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_879: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_206), mkgen(rmAK_207), n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_1025: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_880: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_210), mkgen(rmAK_211), hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                new rmAK_215: mkeyseed;
                let mAK_881: mkey = cst_mkey in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_1024[@i_142], hc[@i_142], mAK_879[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_879[@i_142], mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_1024[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rmSK_883: mkeyseed;
              new r10_884: seed;
              new rSK_882: keyseed;
              let e10: maxmac = enc(concat2(kgen(rSK_882), mkgen(rmSK_883), hc[@i_142]), Mkey[j3], r10_884) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_885: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_882), mkgen(rmSK_883), n2, h3), AK_1024[@i_142], r11_885) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_886: keyseed;
              let SK_1171: key = kgen(rSK_886) in
              new rmSK_887: mkeyseed;
              let mSK_1096: mkey = mkgen(rmSK_887) in
              new r10_888: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_888) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_889: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_886), mkgen(rmSK_887), n2, h3), AK_1024[@i_142], r11_889) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind @i_142 <= N suchthat defined(rAK_214[@i_142], hc[@i_142], rmAK_215[@i_142], e3[@i_142], mAK_881[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            find @i_905 <= N suchthat defined(e11[@i_905], @i_142[@i_905], x_898[@i_905]) && ((@i_142[@i_905] = @i_142) && ((m9 = e11[@i_905]) && check2(e11[@i_905], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_904 <= N suchthat defined(e11[@i_904], @i_142[@i_904], x_899[@i_904]) && ((@i_142[@i_904] = @i_142) && ((m9 = e11[@i_904]) && check2(e11[@i_904], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_901 <= N suchthat defined(e5[@i_901], @i_221[@i_901], x_900[@i_901]) && ((@i_221[@i_901] = @i_142) && ((m9 = e5[@i_901]) && check2(e5[@i_901], mkgen2(rmAK_215[@i_142]), mac9))) then
              event partTC(hc[@i_142], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_890: keyseed;
                let SK_1172: key = kgen(rSK_890) in
                new rmSK_891: mkeyseed;
                let mSK_1097: mkey = mkgen(rmSK_891) in
                new r10_892: seed;
                let e10: maxmac = enc(concat2(kgen(rSK_890), mkgen(rmSK_891), hc[@i_142]), Mkey[j3], r10_892) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_893: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_893) in
                let x_898: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
                new rSK_894: keyseed;
                let SK_1173: key = cst_key in
                new rmSK_895: mkeyseed;
                let mSK_1098: mkey = cst_mkey in
                new r10_896: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_896) in
                let x_76: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_897: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_897) in
                let x_899: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_1171[@i_77], hc[@i_142[@i_77]], mSK_1096[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
          if check(m15, mSK_1096[@i_77], mac15) then
          let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_1171[@i_77]) in
          new r16_1099: seed;
          let e16: maxmac = enc(padts(ts3), SK_1171[@i_77], r16_1099) in
          let mac16: macs = mac(e16, mSK_1096[@i_77]) in
          event partSC(hc[@i_142[@i_77]], m14, m15);
          event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
        orfind @i_77 <= N suchthat defined(hc[@i_142[@i_77]], rSK_894[@i_77], rmSK_895[@i_77], e10[@i_77], mSK_1098[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
          find @i_1106 <= N suchthat defined(e16[@i_1106], @i_77[@i_1106], x_1101[@i_1106]) && ((@i_77[@i_1106] = @i_77) && ((m15 = e16[@i_1106]) && check2(e16[@i_1106], mkgen2(rmSK_895[@i_77]), mac15))) then
            yield
          orfind  suchthat defined(hc[@i_142[@i_77]], e12[@i_901[@i_77]], @i_909[@i_901[@i_77]], x_1102[@i_901[@i_77]]) && ((@i_909[@i_901[@i_77]] = @i_77) && ((m15 = e12[@i_901[@i_77]]) && check2(e12[@i_901[@i_77]], mkgen2(rmSK_895[@i_77]), mac15))) then
            new r16_1100: seed;
            let e16: maxmac = enc2(Zpadts, kgen2(rSK_894[@i_77]), r16_1100) in
            let x_1101: maxmac = cst_maxmac in
            let mac16: macs = mac2(e16, mkgen2(rmSK_895[@i_77])) in
            event partSC(hc[@i_142[@i_77]], m14, m15);
            event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
            out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_132: mkey = cst_mkey
    else
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)


Applying remove assignments of useless yields

Game 84 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rmKs: mkeyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rKt: keyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_222 <= N suchthat defined(mAK_880[@i_222], AK_1025[@i_222], ht[@i_222], n[@i_222], e4[@i_222], x_218[@i_222]) && ((m2 = e4[@i_222]) && check2(e4[@i_222], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_222]) then
              if (h = ht[@i_222]) then
              event fullCK(h, Nc, m, m2);
              new r1_242: seed;
              new ts_241: timest;
              let e5: maxmac = enc(pad(C, ts_241), AK_1025[@i_222], r1_242) in
              let mac5: macs = mac(e5, mAK_880[@i_222]) in
              event partCT(h, m, e5);
              new Nt_243: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_243));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_880[@i_222], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_243, =h2)) = dec(m7, AK_1025[@i_222]) in
              event fullCT(h, h2, Nt_243, m, e5, m7);
              new r2_245: seed;
              new ts2_244: timest;
              let e12: maxmac = enc(pad(C, ts2_244), SK_31, r2_245) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_244)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_221 <= N suchthat defined(rmAK_215[@i_221], rAK_214[@i_221], ht[@i_221], n[@i_221], e4[@i_221], x_219[@i_221]) && ((m2 = e4[@i_221]) && check2(e4[@i_221], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_221]) then
              if (h = ht[@i_221]) then
              event fullCK(h, Nc, m, m2);
              new r1_247: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_214[@i_221]), r1_247) in
              let x_900: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_215[@i_221])) in
              event partCT(h, m, e5);
              new Nt_248: nonce;
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_248));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_910 <= N suchthat defined(mSK_1097[@i_910], SK_1172[@i_910], h3[@i_910], n2[@i_910], e11[@i_910], @i_142[@i_910], x_898[@i_910]) && ((@i_142[@i_910] = @i_221) && ((m7 = e11[@i_910]) && check2(e11[@i_910], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_910]) then
                if (h2 = h3[@i_910]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new r2_952: seed;
                new ts2_951: timest;
                let e12: maxmac = enc(pad(C, ts2_951), SK_1172[@i_910], r2_952) in
                let mac12: macs = mac(e12, mSK_1097[@i_910]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_1097[@i_910], mac13) then
                if (injbot(padts(ts2_951)) = dec(m13, SK_1172[@i_910])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_909 <= N suchthat defined(rmSK_895[@i_909], rSK_894[@i_909], h3[@i_909], n2[@i_909], e11[@i_909], @i_142[@i_909], x_899[@i_909]) && ((@i_142[@i_909] = @i_221) && ((m7 = e11[@i_909]) && check2(e11[@i_909], mkgen2(rmAK_215[@i_221]), mac7))) then
                if (Nt_248 = n2[@i_909]) then
                if (h2 = h3[@i_909]) then
                event fullCT(h, h2, Nt_248, m, e5, m7);
                new r2_954: seed;
                let e12: maxmac = enc2(Zpad, kgen2(rSK_894[@i_909]), r2_954) in
                let x_1102: maxmac = cst_maxmac in
                let mac12: macs = mac2(e12, mkgen2(rmSK_895[@i_909])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                find @i_1110 <= N suchthat defined(e16[@i_1110], @i_77[@i_1110], x_1101[@i_1110]) && ((@i_77[@i_1110] = @i_909) && ((m13 = e16[@i_1110]) && check2(e16[@i_1110], mkgen2(rmSK_895[@i_909]), mac13))) then
                  event fullCS(h2, h, m7, e12, m13);
                  out(c10[!_11], acceptC(h, h2))
                orfind  suchthat defined(rmSK_895[@i_909]) && ((m13 = e12) && check2(e12, mkgen2(rmSK_895[@i_909]), mac13)) then
                  yield
              orfind  suchthat defined(rmAK_215[@i_221]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_215[@i_221]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_200[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rmAK_203: mkeyseed;
                new r3_204: seed;
                new rAK_202: keyseed;
                let e3: maxmac = enc(concat2(kgen(rAK_202), mkgen(rmAK_203), hc), Lkey[j2], r3_204) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_205: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_202), mkgen(rmAK_203), n, ht), Kkey[j1], r4_205) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_206: keyseed;
                let AK_1024: key = kgen(rAK_206) in
                new rmAK_207: mkeyseed;
                let mAK_879: mkey = mkgen(rmAK_207) in
                new r3_208: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_208) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_209: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_206), mkgen(rmAK_207), n, ht), Kkey[j1], r4_209) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_201[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_131[j2]) && (Lhost[j2] = ht) then
                new rAK_210: keyseed;
                let AK_1025: key = kgen(rAK_210) in
                new rmAK_211: mkeyseed;
                let mAK_880: mkey = mkgen(rmAK_211) in
                new r3_212: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_210), mkgen(rmAK_211), hc), Lkey[j2], r3_212) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_213: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_213) in
                let x_218: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_132[j2]) && (Lhost[j2] = ht) then
                new rAK_214: keyseed;
                new rmAK_215: mkeyseed;
                let mAK_881: mkey = cst_mkey in
                new r3_216: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_216) in
                let x_141: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_217: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_217) in
                let x_219: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_142 <= N suchthat defined(AK_1024[@i_142], hc[@i_142], mAK_879[@i_142], e3[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_879[@i_142], mac9) then
            let injbot(pad(=hc[@i_142], ts_22: timest)) = dec(m9, AK_1024[@i_142]) in
            event partTC(hc[@i_142], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rmSK_883: mkeyseed;
              new r10_884: seed;
              new rSK_882: keyseed;
              let e10: maxmac = enc(concat2(kgen(rSK_882), mkgen(rmSK_883), hc[@i_142]), Mkey[j3], r10_884) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_885: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_882), mkgen(rmSK_883), n2, h3), AK_1024[@i_142], r11_885) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
              new rSK_886: keyseed;
              let SK_1171: key = kgen(rSK_886) in
              new rmSK_887: mkeyseed;
              let mSK_1096: mkey = mkgen(rmSK_887) in
              new r10_888: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_888) in
              let x_76: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_889: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_886), mkgen(rmSK_887), n2, h3), AK_1024[@i_142], r11_889) in
              let mac11: macs = mac(e11, mAK_879[@i_142]) in
              event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
          orfind @i_142 <= N suchthat defined(rAK_214[@i_142], hc[@i_142], rmAK_215[@i_142], e3[@i_142], mAK_881[@i_142], x_141[@i_142]) && ((m8 = e3[@i_142]) && check2(e3[@i_142], mkgen2(rmKt), mac8)) then
            find @i_905 <= N suchthat defined(e11[@i_905], @i_142[@i_905], x_898[@i_905]) && ((@i_142[@i_905] = @i_142) && ((m9 = e11[@i_905]) && check2(e11[@i_905], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_904 <= N suchthat defined(e11[@i_904], @i_142[@i_904], x_899[@i_904]) && ((@i_142[@i_904] = @i_142) && ((m9 = e11[@i_904]) && check2(e11[@i_904], mkgen2(rmAK_215[@i_142]), mac9))) then
              yield
            orfind @i_901 <= N suchthat defined(e5[@i_901], @i_221[@i_901], x_900[@i_901]) && ((@i_221[@i_901] = @i_142) && ((m9 = e5[@i_901]) && check2(e5[@i_901], mkgen2(rmAK_215[@i_142]), mac9))) then
              event partTC(hc[@i_142], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_66[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_890: keyseed;
                let SK_1172: key = kgen(rSK_890) in
                new rmSK_891: mkeyseed;
                let mSK_1097: mkey = mkgen(rmSK_891) in
                new r10_892: seed;
                let e10: maxmac = enc(concat2(kgen(rSK_890), mkgen(rmSK_891), hc[@i_142]), Mkey[j3], r10_892) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_893: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_893) in
                let x_898: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_67[j3]) && (Mhost2[j3] = h3) then
                new rSK_894: keyseed;
                new rmSK_895: mkeyseed;
                let mSK_1098: mkey = cst_mkey in
                new r10_896: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_896) in
                let x_76: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_897: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_214[@i_142]), r11_897) in
                let x_899: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_215[@i_142])) in
                event fullTC(hc[@i_142], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_142], e10, mac10, e11, mac11, acceptT(hc[@i_142], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_77 <= N suchthat defined(SK_1171[@i_77], hc[@i_142[@i_77]], mSK_1096[@i_77], e10[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
          if check(m15, mSK_1096[@i_77], mac15) then
          let injbot(pad(=hc[@i_142[@i_77]], ts3: timest)) = dec(m15, SK_1171[@i_77]) in
          new r16_1099: seed;
          let e16: maxmac = enc(padts(ts3), SK_1171[@i_77], r16_1099) in
          let mac16: macs = mac(e16, mSK_1096[@i_77]) in
          event partSC(hc[@i_142[@i_77]], m14, m15);
          event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
        orfind @i_77 <= N suchthat defined(hc[@i_142[@i_77]], rSK_894[@i_77], rmSK_895[@i_77], e10[@i_77], mSK_1098[@i_77], x_76[@i_77]) && ((m14 = e10[@i_77]) && check2(e10[@i_77], mkgen2(rmKs), mac14)) then
          find @i_1106 <= N suchthat defined(e16[@i_1106], @i_77[@i_1106], x_1101[@i_1106]) && ((@i_77[@i_1106] = @i_77) && ((m15 = e16[@i_1106]) && check2(e16[@i_1106], mkgen2(rmSK_895[@i_77]), mac15))) then
            yield
          orfind  suchthat defined(hc[@i_142[@i_77]], e12[@i_901[@i_77]], @i_909[@i_901[@i_77]], x_1102[@i_901[@i_77]]) && ((@i_909[@i_901[@i_77]] = @i_77) && ((m15 = e12[@i_901[@i_77]]) && check2(e12[@i_901[@i_77]], mkgen2(rmSK_895[@i_77]), mac15))) then
            new r16_1100: seed;
            let e16: maxmac = enc2(Zpadts, kgen2(rSK_894[@i_77]), r16_1100) in
            let x_1101: maxmac = cst_maxmac in
            let mac16: macs = mac2(e16, mkgen2(rmSK_895[@i_77])) in
            event partSC(hc[@i_142[@i_77]], m14, m15);
            event fullSC(hc[@i_142[@i_77]], m14, m15, e16);
            out(c12[!_14], (e16, mac16, acceptS(hc[@i_142[@i_77]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_201: mkey = cst_mkey
      else
        let Rmkey_200: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_132: mkey = cst_mkey
    else
      let Qmkey_131: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_67: mkey = cst_mkey
  else
    let Pmkey_66: mkey = cst_mkey
)

RESULT time(context for game 8) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + time(C) * N2 + time(= client) * N2 + 2. * time(let concat2) * N + 6. * time(check) * N + 4. * time(= client) * N + 2. * time(let pad) * N + 6. * time(let injbot) * N + 7. * time(dec) * N + 2. * time(padts) * N + 7. * time(enc) * N + 7. * time(mac) * N + time(acceptS) * N + 2. * time(kgen) * N + 2. * time(mkgen) * N + 2. * time(concat2) * N + time(concat3) * N + time(acceptT) * N + 2. * N2 * time(= server) * N + 3. * N2 * time(= tgs) * N + 2. * N2 * time(T) * N + time(concat1) * N + N2 * time(= client) * N + time(= tgs) * N + time(let concat1) * N + 2. * time(= nonce) * N + time(= server) * N + time(let concat3) * N + 5. * time(C) * N + 2. * time(pad) * N + time(injbot) * N + time(= bitstringbot, length(injbot), length(dec)) * N + time(acceptC) * N + 3. * time(kgen) + 2. * time(mkgen)
RESULT time(context for game 16) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + time(C) * N2 + time(= client) * N2 + 5. * time(check) * N + 4. * time(= client) * N + 2. * time(let pad) * N + 5. * time(let injbot) * N + 6. * time(dec) * N + 2. * time(padts) * N + 7. * time(enc) * N + 7. * time(mac) * N + time(acceptS) * N + N * N * time(check2) + N * N * time(mkgen2) + N * N * time(= maxmac) + time(let concat2) * N + 2. * time(kgen) * N + 2. * time(mkgen) * N + 2. * time(concat2) * N + time(mkgen2) * N + time(mac2) * N + time(concat3) * N + time(acceptT) * N + 2. * N2 * time(= server) * N + 3. * N2 * time(= tgs) * N + N2 * time(T) * N + time(concat1) * N + N2 * time(= client) * N + time(= tgs) * N + time(let concat1) * N + 2. * time(= nonce) * N + time(= server) * N + time(let concat3) * N + 5. * time(C) * N + 2. * time(pad) * N + time(injbot) * N + time(= bitstringbot, length(injbot), length(dec)) * N + time(acceptC) * N + 3. * time(kgen) + time(mkgen)
RESULT time(context for game 24) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + time(C) * N2 + time(= client) * N2 + 4. * time(check) * N + 4. * time(= client) * N + 2. * time(let pad) * N + 4. * time(let injbot) * N + 5. * time(dec) * N + 2. * time(padts) * N + 7. * time(enc) * N + 7. * time(mac) * N + time(acceptS) * N + 2. * N * N * time(check2) + 2. * N * N * time(mkgen2) + 2. * N * N * time(= maxmac) + 2. * time(kgen) * N + 2. * time(mkgen) * N + 2. * time(concat2) * N + 2. * time(mkgen2) * N + 2. * time(mac2) * N + time(concat3) * N + time(acceptT) * N + 2. * N2 * time(= server) * N + 3. * N2 * time(= tgs) * N + N2 * time(T) * N + time(concat1) * N + 2. * N2 * time(= client) * N + time(= tgs) * N + time(let concat1) * N + 2. * time(= nonce) * N + time(= server) * N + time(let concat3) * N + 5. * time(C) * N + 2. * time(pad) * N + time(injbot) * N + time(= bitstringbot, length(injbot), length(dec)) * N + time(acceptC) * N + 3. * time(kgen)
RESULT time(context for game 32) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + time(C) * N2 + time(= client) * N2 + 4. * time(check) * N + 4. * time(= client) * N + 2. * time(let pad) * N + 3. * time(let injbot) * N + 4. * time(dec) * N + 2. * time(padts) * N + 7. * time(enc) * N + 7. * time(mac) * N + time(acceptS) * N + 4. * N * N * time(check2) + 4. * N * N * time(mkgen2) + 4. * N * N * time(= maxmac) + 2. * time(kgen) * N + 2. * time(mkgen) * N + 2. * time(concat2) * N + 3. * time(mkgen2) * N + 3. * time(mac2) * N + time(concat3) * N + time(acceptT) * N + 2. * N2 * time(= server) * N + 3. * N2 * time(= tgs) * N + N2 * time(T) * N + time(concat1) * N + 2. * N2 * time(= client) * N + time(= tgs) * N + 2. * time(= nonce) * N + time(= server) * N + time(let concat3) * N + 5. * time(C) * N + 2. * time(pad) * N + time(injbot) * N + time(= bitstringbot, length(injbot), length(dec)) * N + time(acceptC) * N + 2. * time(kgen)
RESULT time(context for game 39) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + time(C) * N2 + time(= client) * N2 + 4. * time(check) * N + 4. * time(= client) * N + 2. * time(let pad) * N + 3. * time(let injbot) * N + 4. * time(dec) * N + 2. * time(padts) * N + 7. * time(enc) * N + 7. * time(mac) * N + time(acceptS) * N + 4. * N * N * time(check2) + 4. * N * N * time(mkgen2) + 4. * N * N * time(= maxmac) + 2. * time(concat2) * N + 2. * time(kgen) * N + 2. * time(mkgen) * N + time(Zconcat2) * N + time(kgen2) * N + time(enc2) * N + 3. * time(mkgen2) * N + 3. * time(mac2) * N + time(concat3) * N + time(acceptT) * N + 2. * N2 * time(= server) * N + 3. * N2 * time(= tgs) * N + N2 * time(T) * N + time(concat1) * N + 2. * N2 * time(= client) * N + time(= tgs) * N + 2. * time(= nonce) * N + time(= server) * N + time(let concat3) * N + 5. * time(C) * N + 2. * time(pad) * N + time(injbot) * N + time(= bitstringbot, length(injbot), length(dec)) * N + time(acceptC) * N + time(kgen)
RESULT time(context for game 46) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + time(C) * N2 + time(= client) * N2 + 4. * time(check) * N + 4. * time(= client) * N + 2. * time(let pad) * N + 3. * time(let injbot) * N + 4. * time(dec) * N + 2. * time(padts) * N + 7. * time(enc) * N + 7. * time(mac) * N + time(acceptS) * N + 4. * N * N * time(check2) + 4. * N * N * time(mkgen2) + 4. * N * N * time(= maxmac) + 2. * time(concat2) * N + 2. * time(kgen) * N + 2. * time(mkgen) * N + time(Zconcat2) * N + 2. * time(kgen2) * N + 2. * time(enc2) * N + 3. * time(mkgen2) * N + 3. * time(mac2) * N + time(concat3) * N + time(acceptT) * N + 2. * N2 * time(= server) * N + 3. * N2 * time(= tgs) * N + N2 * time(T) * N + time(concat1) * N + time(Zconcat1) * N + 2. * N2 * time(= client) * N + time(= tgs) * N + 2. * time(= nonce) * N + time(= server) * N + time(let concat3) * N + 5. * time(C) * N + 2. * time(pad) * N + time(injbot) * N + time(= bitstringbot, length(injbot), length(dec)) * N + time(acceptC) * N
RESULT time(context for game 54) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + time(C) * N2 + time(= client) * N2 + 4. * time(check) * N + 4. * time(= client) * N + 2. * time(let pad) * N + 3. * time(let injbot) * N + 4. * time(dec) * N + 2. * time(padts) * N + 7. * time(enc) * N + 7. * time(mac) * N + time(acceptS) * N + 5. * N * N * time(check2) + 5. * N * N * time(mkgen2) + 5. * N * N * time(= maxmac) + 2. * time(concat2) * N + 2. * time(kgen) * N + 3. * time(mkgen) * N + 2. * time(Zconcat2) * N + 3. * time(kgen2) * N + 3. * time(enc2) * N + 3. * time(mkgen2) * N + 3. * time(mac2) * N + time(concat3) * N + time(acceptT) * N + 2. * N2 * time(= server) * N + 3. * N2 * time(= tgs) * N + N2 * time(T) * N + time(concat1) * N + time(Zconcat1) * N + 2. * N2 * time(= client) * N + time(= tgs) * N + 2. * time(= nonce) * N + time(= server) * N + time(let concat3) * N + 5. * time(C) * N + 2. * time(pad) * N + time(injbot) * N + time(= bitstringbot, length(injbot), length(dec)) * N + time(acceptC) * N
RESULT time(context for game 63) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + time(C) * N2 + time(= client) * N2 + 4. * time(check) * N + 4. * time(= client) * N + 2. * time(let pad) * N + 3. * time(let injbot) * N + 4. * time(dec) * N + 2. * time(padts) * N + 7. * time(enc) * N + 7. * time(mac) * N + time(acceptS) * N + 10. * N * N * time(check2) + 10. * N * N * time(mkgen2) + 10. * N * N * time(= maxmac) + 2. * time(concat2) * N + 3. * time(kgen) * N + 3. * time(mkgen) * N + 2. * time(Zconcat2) * N + 3. * time(kgen2) * N + 3. * time(enc2) * N + time(concat3) * N + 6. * time(mkgen2) * N + 5. * time(mac2) * N + time(acceptT) * N + 2. * N2 * time(= server) * N + 3. * N2 * time(= tgs) * N + N2 * time(T) * N + 5. * N * N * time(= [1,N]) + time(concat1) * N + time(Zconcat1) * N + 2. * N2 * time(= client) * N + time(let concat3) * N + time(= tgs) * N + 2. * time(= nonce) * N + time(= server) * N + 5. * time(C) * N + 2. * time(pad) * N + time(injbot) * N + time(= bitstringbot, length(injbot), length(dec)) * N + time(acceptC) * N + time(= maxmac) * N + time(check2) * N
RESULT time(context for game 71) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + time(C) * N2 + time(= client) * N2 + 4. * time(check) * N + 7. * time(mac) * N + 4. * time(= client) * N + 2. * time(let pad) * N + 3. * time(let injbot) * N + 4. * time(dec) * N + 2. * time(padts) * N + 7. * time(enc) * N + time(acceptS) * N + 11. * N * N * time(check2) + 11. * N * N * time(mkgen2) + 11. * N * N * time(= maxmac) + time(concat3) * N + 4. * time(mkgen) * N + 2. * time(concat2) * N + 3. * time(kgen) * N + 2. * time(Zconcat2) * N + time(Zconcat3) * N + 5. * time(kgen2) * N + 5. * time(enc2) * N + 6. * time(mkgen2) * N + 5. * time(mac2) * N + time(acceptT) * N + 2. * N2 * time(= server) * N + 3. * N2 * time(= tgs) * N + N2 * time(T) * N + 5. * N * N * time(= [1,N]) + time(concat1) * N + time(Zconcat1) * N + 2. * N2 * time(= client) * N + time(let concat3) * N + time(= tgs) * N + time(Zpad) * N + 2. * time(= nonce) * N + time(= server) * N + 5. * time(C) * N + 2. * time(pad) * N + time(injbot) * N + time(= bitstringbot, length(injbot), length(dec)) * N + time(acceptC) * N + time(= maxmac) * N + time(check2) * N
RESULT time(context for game 80) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + time(C) * N2 + time(= client) * N2 + 4. * time(check) * N + 4. * time(= client) * N + 2. * time(let pad) * N + 3. * time(let injbot) * N + 4. * time(dec) * N + 7. * time(enc) * N + 7. * time(mac) * N + 2. * time(padts) * N + 7. * time(mac2) * N + time(acceptS) * N + time(= [1,N]) * N + 3. * time(= maxmac) * N + 10. * time(mkgen2) * N + 3. * time(check2) * N + 7. * N * N * time(= [1,N]) + 13. * N * N * time(check2) + 13. * N * N * time(mkgen2) + 13. * N * N * time(= maxmac) + time(concat3) * N + 4. * time(kgen) * N + 4. * time(mkgen) * N + 2. * time(concat2) * N + 2. * time(Zconcat2) * N + time(Zconcat3) * N + 5. * time(kgen2) * N + 5. * time(enc2) * N + time(acceptT) * N + 2. * N2 * time(= server) * N + 3. * N2 * time(= tgs) * N + N2 * time(T) * N + time(concat1) * N + time(Zconcat1) * N + 2. * N2 * time(= client) * N + time(let concat3) * N + time(= tgs) * N + time(Zpad) * N + time(injbot) * N + time(= bitstringbot, length(injbot), length(dec)) * N + 2. * time(= nonce) * N + time(= server) * N + 5. * time(C) * N + 2. * time(pad) * N + time(acceptC) * N
RESULT Could not prove event partSC(C, z, y) ==> (partCS(S, T, x, y)&&fullTC(C, S, N, v, z, w)).
