PB: Missing defined condition @i_1785[@i_2182] (used in the condition of find)
in game 82

Doing expand if, let, find... Done.
Doing simplify... Run simplify 2 time(s). Fixpoint reached.
Done.
Doing move all binders... No change.
Doing remove assignments of useless... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
... Failed.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
... Failed.
Doing remove assignments of binder mSK_24... Done.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK... Failed.
Doing remove assignments of binder mAK_26... Done.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK... Failed.
Doing remove assignments of binder mKs... Done.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmKs... Failed.
Doing remove assignments of binder Pmkey... No change.
Doing SA rename Pmkey... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 2 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder Pmkey_97... Done.
Doing remove assignments of binder Pmkey_96... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmKs... Succeeded.
Doing simplify... Run simplify 2 time(s). Fixpoint reached.
Done.
Doing move all binders... Done.
Doing remove assignments of useless... Done.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
... Failed.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
... Failed.
Doing remove assignments of binder mSK_24... Done.
Doing SA rename mSK_24... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder mSK_176... Done.
Doing remove assignments of binder mSK_175... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_103... Failed.
Doing remove assignments of binder mSK_24... Done.
Doing SA rename mSK_24... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder mSK_188... Done.
Doing remove assignments of binder mSK_187... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_99... Failed.
Doing remove assignments of binder mAK_26... Done.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK... Failed.
Doing remove assignments of binder mKt... Done.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmKt... Failed.
Doing remove assignments of binder Qmkey... No change.
Doing SA rename Qmkey... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder Qmkey_199... Done.
Doing remove assignments of binder Qmkey_198... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmKt... Succeeded.
Doing simplify... Run simplify 2 time(s). Fixpoint reached.
Done.
Doing move all binders... Done.
Doing remove assignments of useless... Done.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
... Failed.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
... Failed.
Doing remove assignments of binder mSK_24... Done.
Doing SA rename mSK_24... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder mSK_269... Done.
Doing remove assignments of binder mSK_268... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_103... Failed.
Doing remove assignments of binder mSK_24... Done.
Doing SA rename mSK_24... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder mSK_281... Done.
Doing remove assignments of binder mSK_280... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_99... Failed.
Doing remove assignments of binder mAK_26... Done.
Doing SA rename mAK_26... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder mAK_292... Done.
Doing remove assignments of binder mAK_291... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK_205... Failed.
Doing remove assignments of binder mAK_26... Done.
Doing SA rename mAK_26... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder mAK_305... Done.
Doing remove assignments of binder mAK_304... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK_201... Failed.
Doing remove assignments of binder mKc... Done.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmKc... Failed.
Doing remove assignments of binder Rmkey... No change.
Doing SA rename Rmkey... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder Rmkey_316... Done.
Doing remove assignments of binder Rmkey_315... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmKc... Succeeded.
Doing simplify... Run simplify 2 time(s). Fixpoint reached.
Done.
Doing move all binders... Done.
Doing remove assignments of useless... Done.
Eliminated collisions between Nc and Nc Probability: 0.5 * N * N / |nonce|
Proved query event inj:fullCK(T, N, x, y) ==> inj:fullKC(C, T, N, z, y) Probability: 0.5 * N * N / |nonce|
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
... Failed.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
... Failed.
Doing remove assignments of binder mSK_24... Done.
Doing SA rename mSK_24... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder mSK_415... Done.
Doing remove assignments of binder mSK_414... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_103... Failed.
Doing remove assignments of binder mSK_24... Done.
Doing SA rename mSK_24... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder mSK_438... Done.
Doing remove assignments of binder mSK_437... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_99... Failed.
Doing remove assignments of binder mAK_26... Done.
Doing SA rename mAK_26... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder mAK_462... Done.
Doing remove assignments of binder mAK_461... Done.
Doing remove assignments of binder mAK_460... Done.
Doing remove assignments of binder mAK_459... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK_330... Failed.
Doing remove assignments of binder mAK_26... Done.
Doing SA rename mAK_26... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder mAK_504... Done.
Doing remove assignments of binder mAK_503... Done.
Doing remove assignments of binder mAK_502... Done.
Doing remove assignments of binder mAK_501... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK_326... Failed.
Doing remove assignments of binder mAK_26... Done.
Doing SA rename mAK_26... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder mAK_544... Done.
Doing remove assignments of binder mAK_543... Done.
Doing remove assignments of binder mAK_542... Done.
Doing remove assignments of binder mAK_541... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK_322... Failed.
Doing remove assignments of binder mAK_26... Done.
Doing SA rename mAK_26... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder mAK_586... Done.
Doing remove assignments of binder mAK_585... Done.
Doing remove assignments of binder mAK_584... Done.
Doing remove assignments of binder mAK_583... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK_318... Failed.
Doing remove assignments of binder SK_23... Done.
Doing SA rename SK_23... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder SK_624... Done.
Doing remove assignments of binder SK_623... No change.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r16... Failed.
Doing remove assignments of binder AK_25... Done.
Doing SA rename AK_25... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder AK_649... Done.
Doing remove assignments of binder AK_648... Done.
Doing remove assignments of binder AK_647... Done.
Doing remove assignments of binder AK_646... No change.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r11_665... Failed.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r11_657... Failed.
Doing remove assignments of binder Pkey... No change.
Doing SA rename Pkey... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder Pkey_689... Done.
Doing remove assignments of binder Pkey_688... No change.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r10_104... Failed.
Doing remove assignments of binder Ks... Done.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r10_104... Succeeded.
Doing simplify... Run simplify 2 time(s). Fixpoint reached.
Done.
Doing move all binders... No change.
Doing remove assignments of useless... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
... Failed.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
... Failed.
Doing remove assignments of binder mSK_24... Done.
Doing SA rename mSK_24... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder mSK_780... Done.
Doing remove assignments of binder mSK_779... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_103... Failed.
Doing remove assignments of binder mSK_24... Done.
Doing SA rename mSK_24... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder mSK_803... Done.
Doing remove assignments of binder mSK_802... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_99... Failed.
Doing remove assignments of binder mAK_26... Done.
Doing SA rename mAK_26... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder mAK_827... Done.
Doing remove assignments of binder mAK_826... Done.
Doing remove assignments of binder mAK_825... Done.
Doing remove assignments of binder mAK_824... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK_330... Failed.
Doing remove assignments of binder mAK_26... Done.
Doing SA rename mAK_26... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder mAK_869... Done.
Doing remove assignments of binder mAK_868... Done.
Doing remove assignments of binder mAK_867... Done.
Doing remove assignments of binder mAK_866... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK_326... Failed.
Doing remove assignments of binder mAK_26... Done.
Doing SA rename mAK_26... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder mAK_909... Done.
Doing remove assignments of binder mAK_908... Done.
Doing remove assignments of binder mAK_907... Done.
Doing remove assignments of binder mAK_906... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK_322... Failed.
Doing remove assignments of binder mAK_26... Done.
Doing SA rename mAK_26... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder mAK_951... Done.
Doing remove assignments of binder mAK_950... Done.
Doing remove assignments of binder mAK_949... Done.
Doing remove assignments of binder mAK_948... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK_318... Failed.
Doing remove assignments of binder SK_23... Done.
Doing SA rename SK_23... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder SK_989... Done.
Doing remove assignments of binder SK_988... No change.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r16... Failed.
Doing remove assignments of binder AK_25... Done.
Doing SA rename AK_25... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder AK_1014... Done.
Doing remove assignments of binder AK_1013... Done.
Doing remove assignments of binder AK_1012... Done.
Doing remove assignments of binder AK_1011... No change.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r11_1030... Failed.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r11_1022... Failed.
Doing remove assignments of binder SK_23... Done.
Doing SA rename SK_23... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder SK_1054... Done.
Doing remove assignments of binder SK_1053... No change.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with rSK_102... Failed.
Doing remove assignments of binder AK_25... Done.
Doing SA rename AK_25... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder AK_1079... Done.
Doing remove assignments of binder AK_1078... Done.
Doing remove assignments of binder AK_1077... Done.
Doing remove assignments of binder AK_1076... No change.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r11_1091... Failed.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r11_1083... Failed.
Doing remove assignments of binder SK_23... Done.
Doing SA rename SK_23... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder SK_1121... Done.
Doing remove assignments of binder SK_1120... No change.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with rSK_98... Failed.
Doing remove assignments of binder Rkey... No change.
Doing SA rename Rkey... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder Rkey_1143... Done.
Doing remove assignments of binder Rkey_1142... No change.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r4_332... Failed.
Doing remove assignments of binder Kc... Done.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r4_332... Succeeded.
Doing simplify... Run simplify 2 time(s). Fixpoint reached.
Done.
Doing move all binders... No change.
Doing remove assignments of useless... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
... Failed.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
... Failed.
Doing remove assignments of binder mSK_24... Done.
Doing SA rename mSK_24... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder mSK_1235... Done.
Doing remove assignments of binder mSK_1234... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_103... Failed.
Doing remove assignments of binder mSK_24... Done.
Doing SA rename mSK_24... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder mSK_1258... Done.
Doing remove assignments of binder mSK_1257... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_99... Failed.
Doing remove assignments of binder mAK_26... Done.
Doing SA rename mAK_26... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder mAK_1282... Done.
Doing remove assignments of binder mAK_1281... Done.
Doing remove assignments of binder mAK_1280... Done.
Doing remove assignments of binder mAK_1279... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK_330... Failed.
Doing remove assignments of binder mAK_26... Done.
Doing SA rename mAK_26... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder mAK_1324... Done.
Doing remove assignments of binder mAK_1323... Done.
Doing remove assignments of binder mAK_1322... Done.
Doing remove assignments of binder mAK_1321... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK_326... Failed.
Doing remove assignments of binder mAK_26... Done.
Doing SA rename mAK_26... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder mAK_1364... Done.
Doing remove assignments of binder mAK_1363... Done.
Doing remove assignments of binder mAK_1362... Done.
Doing remove assignments of binder mAK_1361... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK_322... Failed.
Doing remove assignments of binder mAK_26... Done.
Doing SA rename mAK_26... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder mAK_1406... Done.
Doing remove assignments of binder mAK_1405... Done.
Doing remove assignments of binder mAK_1404... Done.
Doing remove assignments of binder mAK_1403... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK_318... Failed.
Doing remove assignments of binder SK_23... Done.
Doing SA rename SK_23... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder SK_1444... Done.
Doing remove assignments of binder SK_1443... No change.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r16... Failed.
Doing remove assignments of binder AK_25... Done.
Doing SA rename AK_25... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder AK_1469... Done.
Doing remove assignments of binder AK_1468... Done.
Doing remove assignments of binder AK_1467... Done.
Doing remove assignments of binder AK_1466... No change.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r11_1485... Failed.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r11_1477... Failed.
Doing remove assignments of binder SK_23... Done.
Doing SA rename SK_23... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder SK_1509... Done.
Doing remove assignments of binder SK_1508... No change.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with rSK_102... Failed.
Doing remove assignments of binder AK_25... Done.
Doing SA rename AK_25... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder AK_1534... Done.
Doing remove assignments of binder AK_1533... Done.
Doing remove assignments of binder AK_1532... Done.
Doing remove assignments of binder AK_1531... No change.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r11_1546... Failed.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r11_1538... Failed.
Doing remove assignments of binder SK_23... Done.
Doing SA rename SK_23... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder SK_1576... Done.
Doing remove assignments of binder SK_1575... No change.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with rSK_98... Failed.
Doing remove assignments of binder Qkey... No change.
Doing SA rename Qkey... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder Qkey_1598... Done.
Doing remove assignments of binder Qkey_1597... No change.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r3_331... Failed.
Doing remove assignments of binder Kt... Done.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r3_331... Succeeded.
Doing simplify... Run simplify 2 time(s). Fixpoint reached.
Done.
Doing move all binders... No change.
Doing remove assignments of useless... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
... Failed.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
... Failed.
Doing remove assignments of binder mSK_24... Done.
Doing SA rename mSK_24... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder mSK_1690... Done.
Doing remove assignments of binder mSK_1689... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_103... Failed.
Doing remove assignments of binder mSK_24... Done.
Doing SA rename mSK_24... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder mSK_1713... Done.
Doing remove assignments of binder mSK_1712... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_99... Failed.
Doing remove assignments of binder mAK_26... Done.
Doing SA rename mAK_26... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder mAK_1737... Done.
Doing remove assignments of binder mAK_1736... Done.
Doing remove assignments of binder mAK_1735... Done.
Doing remove assignments of binder mAK_1734... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK_330... Succeeded.
Doing simplify... Run simplify 2 time(s). Maximum reached.
Eliminated collisions between Nc and Nc Probability: 0.5 * N * N / |nonce|
Eliminated collisions between concat3(?, ?, Nt_370[!_11], ?) and pad(C, ts_371[!_11]) Probability: N / |nonce|
(concat3(?, ?, Nt_370[!_11], ?) characterizes a part of Nt_370[!_11] of type(s) nonce;
 pad(C, ts_371[!_11]) does not depend on Nt_370[!_11])
Done.
Doing move all binders... Done.
Doing remove assignments of useless... Done.
Proved query event partTC(C, x, y) ==> (partCT(T, x', y)&&fullKC(C, T, N, x, y'))
Proved query event fullCT(T, S, N, x, z, y) ==> (fullTC(C, S, N, x', z, y)&&fullKC(C, T, N', x', w))
Eliminated collisions between Nt_370 and Nt_370 Probability: 0.5 * N * N / |nonce|
Proved query event inj:fullCT(T, S, N, x, z, y) ==> inj:fullTC(C, S, N, x', z, y) Probability: 0.5 * N * N / |nonce|
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
... Failed.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
... Failed.
Doing remove assignments of binder mSK_24... Done.
Doing SA rename mSK_24... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder mSK_1874... Done.
Doing remove assignments of binder mSK_1873... Done.
Doing remove assignments of binder mSK_1872... Done.
Doing remove assignments of binder mSK_1871... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_1751... Failed.
Doing remove assignments of binder mSK_24... Done.
Doing SA rename mSK_24... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder mSK_1908... Done.
Doing remove assignments of binder mSK_1907... Done.
Doing remove assignments of binder mSK_1906... Done.
Doing remove assignments of binder mSK_1905... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_1747... Failed.
Doing remove assignments of binder mSK_24... Done.
Doing SA rename mSK_24... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder mSK_1941... Done.
Doing remove assignments of binder mSK_1940... Done.
Doing remove assignments of binder mSK_1939... Done.
Doing remove assignments of binder mSK_1938... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_1743... Failed.
Doing remove assignments of binder mSK_24... Done.
Doing SA rename mSK_24... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder mSK_1975... Done.
Doing remove assignments of binder mSK_1974... Done.
Doing remove assignments of binder mSK_1973... Done.
Doing remove assignments of binder mSK_1972... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_1739... Failed.
Doing remove assignments of binder SK_23... Done.
Doing SA rename SK_23... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder SK_2008... Done.
Doing remove assignments of binder SK_2007... Done.
Doing remove assignments of binder SK_2006... Done.
Doing remove assignments of binder SK_2005... No change.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r16_2010... Failed.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r16_2009... Failed.
Doing remove assignments of binder AK_25... Done.
Doing SA rename AK_25... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder AK_2043... Done.
Doing remove assignments of binder AK_2042... Done.
Doing remove assignments of binder AK_2041... Done.
Doing remove assignments of binder AK_2040... No change.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r11_1753... Succeeded.
Doing simplify... Run simplify 2 time(s). Maximum reached.
Done.
Doing move all binders... No change.
Doing remove assignments of useless... Done.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
... Failed.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
... Failed.
Doing remove assignments of binder mSK_24... Done.
Doing SA rename mSK_24... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder mSK_2150... Done.
Doing remove assignments of binder mSK_2149... Done.
Doing remove assignments of binder mSK_2148... Done.
Doing remove assignments of binder mSK_2147... No change.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_1751... Succeeded.
Doing simplify... Run simplify 2 time(s). Maximum reached.
Done.
Doing move all binders... No change.
Doing remove assignments of useless... Done.
Proved query event fullCS(S, T, z, y, w) ==> fullSC(C, x, y, w)
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
... Failed.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
... Failed.
Doing remove assignments of binder SK_23... Done.
Doing SA rename SK_23... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
Done.
Doing remove assignments of binder SK_2261... Done.
Doing remove assignments of binder SK_2260... Done.
Doing remove assignments of binder SK_2259... Done.
Doing remove assignments of binder SK_2258... No change.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r16_2152... Succeeded.
Doing simplify... Run simplify 2 time(s). Maximum reached.
Done.
Doing move all binders... No change.
Doing remove assignments of useless... Done.
Trying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
... Failed.
Trying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
... Failed.
Doing remove assignments of binder SK_31... No change.
===================== Proof starts =======================
Initial state
Game 1 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
let mKt: mkey = mkgen(rmKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
let mKs: mkey = mkgen(rmKs) in
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new Nt: nonce;
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Khost[j1], Rkey[j1], Rmkey[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Lhost[j2], Qkey[j2], Qmkey[j2]) && (Lhost[j2] = ht) then
            new rAK: keyseed;
            let AK_25: key = kgen(rAK) in
            new rmAK: mkeyseed;
            let mAK_26: mkey = mkgen(rmAK) in
            new r3: seed;
            let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3) in
            let mac3: macs = mac(e3, Qmkey[j2]) in
            new r4: seed;
            let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4) in
            let mac4: macs = mac(e4, Rmkey[j1]) in
            event fullKC(hc, ht, n, e3, e4);
            out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          if check(m8, mKt, mac8) then
          let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Mhost1[j3], Mhost2[j3], Pmkey[j3], Pkey[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
          new rSK: keyseed;
          let SK_23: key = kgen(rSK) in
          new rmSK: mkeyseed;
          let mSK_24: mkey = mkgen(rmSK) in
          new r10: seed;
          let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10) in
          let mac10: macs = mac(e10, Pmkey[j3]) in
          new r11: seed;
          let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11) in
          let mac11: macs = mac(e11, mAK_20) in
          event fullTC(h4, h3, n2, m8, m9, e11);
          out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        if check(m14, mKs, mac14) then
        let injbot(concat2(SK_19: key, mSK_18: mkey, h5: client)) = dec(m14, Ks) in
        if check(m15, mSK_18, mac15) then
        let injbot(pad(=h5, ts3: timest)) = dec(m15, SK_19) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_19, r16) in
        let mac16: macs = mac(e16, mSK_18) in
        event partSC(h5, m14, m15);
        event fullSC(h5, m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h5)))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      let Rkey: key = if (Khost = C) then Kc else Kkey in
      let Rmkey: mkey = if (Khost = C) then mKc else Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    let Qkey: key = if (Lhost = T) then Kt else Lkey in
    let Qmkey: mkey = if (Lhost = T) then mKt else Lmkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  let Pkey: key = if ((Mhost1 = T) && (Mhost2 = S)) then Ks else Mkey in
  let Pmkey: mkey = if ((Mhost1 = T) && (Mhost2 = S)) then mKs else Mmkey
)


Applying expand if, let, find yields

Game 2 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
let mKt: mkey = mkgen(rmKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
let mKs: mkey = mkgen(rmKs) in
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new Nt: nonce;
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Khost[j1], Rkey[j1], Rmkey[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Lhost[j2], Qkey[j2], Qmkey[j2]) && (Lhost[j2] = ht) then
            new rAK: keyseed;
            let AK_25: key = kgen(rAK) in
            new rmAK: mkeyseed;
            let mAK_26: mkey = mkgen(rmAK) in
            new r3: seed;
            let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3) in
            let mac3: macs = mac(e3, Qmkey[j2]) in
            new r4: seed;
            let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4) in
            let mac4: macs = mac(e4, Rmkey[j1]) in
            event fullKC(hc, ht, n, e3, e4);
            out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          if check(m8, mKt, mac8) then
          let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Mhost1[j3], Mhost2[j3], Pmkey[j3], Pkey[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
          new rSK: keyseed;
          let SK_23: key = kgen(rSK) in
          new rmSK: mkeyseed;
          let mSK_24: mkey = mkgen(rmSK) in
          new r10: seed;
          let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10) in
          let mac10: macs = mac(e10, Pmkey[j3]) in
          new r11: seed;
          let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11) in
          let mac11: macs = mac(e11, mAK_20) in
          event fullTC(h4, h3, n2, m8, m9, e11);
          out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        if check(m14, mKs, mac14) then
        let injbot(concat2(SK_19: key, mSK_18: mkey, h5: client)) = dec(m14, Ks) in
        if check(m15, mSK_18, mac15) then
        let injbot(pad(=h5, ts3: timest)) = dec(m15, SK_19) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_19, r16) in
        let mac16: macs = mac(e16, mSK_18) in
        event partSC(h5, m14, m15);
        event fullSC(h5, m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h5)))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        if (Khost = C) then
          let Rmkey: mkey = mKc
        else
          let Rmkey: mkey = Kmkey
      else
        let Rkey: key = Kkey in
        if (Khost = C) then
          let Rmkey: mkey = mKc
        else
          let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      if (Lhost = T) then
        let Qmkey: mkey = mKt
      else
        let Qmkey: mkey = Lmkey
    else
      let Qkey: key = Lkey in
      if (Lhost = T) then
        let Qmkey: mkey = mKt
      else
        let Qmkey: mkey = Lmkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    if ((Mhost1 = T) && (Mhost2 = S)) then
      let Pmkey: mkey = mKs
    else
      let Pmkey: mkey = Mmkey
  else
    let Pkey: key = Mkey in
    if ((Mhost1 = T) && (Mhost2 = S)) then
      let Pmkey: mkey = mKs
    else
      let Pmkey: mkey = Mmkey
)


Applying simplify yields

Game 3 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
let mKt: mkey = mkgen(rmKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
let mKs: mkey = mkgen(rmKs) in
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new Nt: nonce;
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Qmkey[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
            new rAK: keyseed;
            let AK_25: key = kgen(rAK) in
            new rmAK: mkeyseed;
            let mAK_26: mkey = mkgen(rmAK) in
            new r3: seed;
            let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3) in
            let mac3: macs = mac(e3, Qmkey[j2]) in
            new r4: seed;
            let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4) in
            let mac4: macs = mac(e4, Rmkey[j1]) in
            event fullKC(hc, ht, n, e3, e4);
            out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          if check(m8, mKt, mac8) then
          let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Pmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
          new rSK: keyseed;
          let SK_23: key = kgen(rSK) in
          new rmSK: mkeyseed;
          let mSK_24: mkey = mkgen(rmSK) in
          new r10: seed;
          let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10) in
          let mac10: macs = mac(e10, Pmkey[j3]) in
          new r11: seed;
          let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11) in
          let mac11: macs = mac(e11, mAK_20) in
          event fullTC(h4, h3, n2, m8, m9, e11);
          out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        if check(m14, mKs, mac14) then
        let injbot(concat2(SK_19: key, mSK_18: mkey, h5: client)) = dec(m14, Ks) in
        if check(m15, mSK_18, mac15) then
        let injbot(pad(=h5, ts3: timest)) = dec(m15, SK_19) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_19, r16) in
        let mac16: macs = mac(e16, mSK_18) in
        event partSC(h5, m14, m15);
        event fullSC(h5, m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h5)))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey: mkey = mKt
    else
      let Qkey: key = Lkey in
      let Qmkey: mkey = Lmkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey: mkey = mKs
  else
    let Pkey: key = Mkey in
    let Pmkey: mkey = Mmkey
)


Applying remove assignments of binder mKs yields

Game 4 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
let mKt: mkey = mkgen(rmKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new Nt: nonce;
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Qmkey[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
            new rAK: keyseed;
            let AK_25: key = kgen(rAK) in
            new rmAK: mkeyseed;
            let mAK_26: mkey = mkgen(rmAK) in
            new r3: seed;
            let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3) in
            let mac3: macs = mac(e3, Qmkey[j2]) in
            new r4: seed;
            let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4) in
            let mac4: macs = mac(e4, Rmkey[j1]) in
            event fullKC(hc, ht, n, e3, e4);
            out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          if check(m8, mKt, mac8) then
          let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Pmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
          new rSK: keyseed;
          let SK_23: key = kgen(rSK) in
          new rmSK: mkeyseed;
          let mSK_24: mkey = mkgen(rmSK) in
          new r10: seed;
          let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10) in
          let mac10: macs = mac(e10, Pmkey[j3]) in
          new r11: seed;
          let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11) in
          let mac11: macs = mac(e11, mAK_20) in
          event fullTC(h4, h3, n2, m8, m9, e11);
          out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        if check(m14, mkgen(rmKs), mac14) then
        let injbot(concat2(SK_19: key, mSK_18: mkey, h5: client)) = dec(m14, Ks) in
        if check(m15, mSK_18, mac15) then
        let injbot(pad(=h5, ts3: timest)) = dec(m15, SK_19) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_19, r16) in
        let mac16: macs = mac(e16, mSK_18) in
        event partSC(h5, m14, m15);
        event fullSC(h5, m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h5)))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey: mkey = mKt
    else
      let Qkey: key = Lkey in
      let Qmkey: mkey = Lmkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey: mkey = mkgen(rmKs)
  else
    let Pkey: key = Mkey in
    let Pmkey: mkey = Mmkey
)


Applying SA rename Pmkey yields

Game 5 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
let mKt: mkey = mkgen(rmKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new Nt: nonce;
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Qmkey[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
            new rAK: keyseed;
            let AK_25: key = kgen(rAK) in
            new rmAK: mkeyseed;
            let mAK_26: mkey = mkgen(rmAK) in
            new r3: seed;
            let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3) in
            let mac3: macs = mac(e3, Qmkey[j2]) in
            new r4: seed;
            let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4) in
            let mac4: macs = mac(e4, Rmkey[j1]) in
            event fullKC(hc, ht, n, e3, e4);
            out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          if check(m8, mKt, mac8) then
          let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Pmkey_96[j3], Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK: keyseed;
            let SK_23: key = kgen(rSK) in
            new rmSK: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK) in
            new r10: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10) in
            let mac10: macs = mac(e10, Pmkey_96[j3]) in
            new r11: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
          orfind j3 <= N2 suchthat defined(Pmkey_97[j3], Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK: keyseed;
            let SK_23: key = kgen(rSK) in
            new rmSK: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK) in
            new r10: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10) in
            let mac10: macs = mac(e10, Pmkey_97[j3]) in
            new r11: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        if check(m14, mkgen(rmKs), mac14) then
        let injbot(concat2(SK_19: key, mSK_18: mkey, h5: client)) = dec(m14, Ks) in
        if check(m15, mSK_18, mac15) then
        let injbot(pad(=h5, ts3: timest)) = dec(m15, SK_19) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_19, r16) in
        let mac16: macs = mac(e16, mSK_18) in
        event partSC(h5, m14, m15);
        event fullSC(h5, m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h5)))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey: mkey = mKt
    else
      let Qkey: key = Lkey in
      let Qmkey: mkey = Lmkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_97: mkey = mkgen(rmKs)
  else
    let Pkey: key = Mkey in
    let Pmkey_96: mkey = Mmkey
)


Applying remove assignments of useless yields

Game 6 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
let mKt: mkey = mkgen(rmKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new Nt: nonce;
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Qmkey[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
            new rAK: keyseed;
            let AK_25: key = kgen(rAK) in
            new rmAK: mkeyseed;
            let mAK_26: mkey = mkgen(rmAK) in
            new r3: seed;
            let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3) in
            let mac3: macs = mac(e3, Qmkey[j2]) in
            new r4: seed;
            let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4) in
            let mac4: macs = mac(e4, Rmkey[j1]) in
            event fullKC(hc, ht, n, e3, e4);
            out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          if check(m8, mKt, mac8) then
          let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pmkey_96[j3], Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_101) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
          orfind j3 <= N2 suchthat defined(Pmkey_97[j3], Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_104) in
            let mac10: macs = mac(e10, Pmkey_97[j3]) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_105) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        if check(m14, mkgen(rmKs), mac14) then
        let injbot(concat2(SK_19: key, mSK_18: mkey, h5: client)) = dec(m14, Ks) in
        if check(m15, mSK_18, mac15) then
        let injbot(pad(=h5, ts3: timest)) = dec(m15, SK_19) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_19, r16) in
        let mac16: macs = mac(e16, mSK_18) in
        event partSC(h5, m14, m15);
        event fullSC(h5, m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h5)))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey: mkey = mKt
    else
      let Qkey: key = Lkey in
      let Qmkey: mkey = Lmkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_97: mkey = mkgen(rmKs)
  else
    let Pkey: key = Mkey in
    let Pmkey_96: mkey = cst_mkey
)


Applying simplify yields

Game 7 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
let mKt: mkey = mkgen(rmKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new Nt: nonce;
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Qmkey[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
            new rAK: keyseed;
            let AK_25: key = kgen(rAK) in
            new rmAK: mkeyseed;
            let mAK_26: mkey = mkgen(rmAK) in
            new r3: seed;
            let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3) in
            let mac3: macs = mac(e3, Qmkey[j2]) in
            new r4: seed;
            let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4) in
            let mac4: macs = mac(e4, Rmkey[j1]) in
            event fullKC(hc, ht, n, e3, e4);
            out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          if check(m8, mKt, mac8) then
          let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_101) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
          orfind j3 <= N2 suchthat defined(Pmkey_97[j3], Pkey[j3], Mhost2[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_104) in
            let mac10: macs = mac(e10, Pmkey_97[j3]) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_105) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        if check(m14, mkgen(rmKs), mac14) then
        let injbot(concat2(SK_19: key, mSK_18: mkey, h5: client)) = dec(m14, Ks) in
        if check(m15, mSK_18, mac15) then
        let injbot(pad(=h5, ts3: timest)) = dec(m15, SK_19) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_19, r16) in
        let mac16: macs = mac(e16, mSK_18) in
        event partSC(h5, m14, m15);
        event fullSC(h5, m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h5)))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey: mkey = mKt
    else
      let Qkey: key = Lkey in
      let Qmkey: mkey = Lmkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_97: mkey = mkgen(rmKs)
  else
    let Pkey: key = Mkey in
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of binder Pmkey_97 yields

Game 8 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
let mKt: mkey = mkgen(rmKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new Nt: nonce;
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Qmkey[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
            new rAK: keyseed;
            let AK_25: key = kgen(rAK) in
            new rmAK: mkeyseed;
            let mAK_26: mkey = mkgen(rmAK) in
            new r3: seed;
            let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3) in
            let mac3: macs = mac(e3, Qmkey[j2]) in
            new r4: seed;
            let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4) in
            let mac4: macs = mac(e4, Rmkey[j1]) in
            event fullKC(hc, ht, n, e3, e4);
            out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          if check(m8, mKt, mac8) then
          let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_101) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
          orfind j3 <= N2 suchthat defined(rmKs, Pmkey_97[j3], Pkey[j3], Mhost2[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_104) in
            let mac10: macs = mac(e10, mkgen(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_105) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        if check(m14, mkgen(rmKs), mac14) then
        let injbot(concat2(SK_19: key, mSK_18: mkey, h5: client)) = dec(m14, Ks) in
        if check(m15, mSK_18, mac15) then
        let injbot(pad(=h5, ts3: timest)) = dec(m15, SK_19) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_19, r16) in
        let mac16: macs = mac(e16, mSK_18) in
        event partSC(h5, m14, m15);
        event fullSC(h5, m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h5)))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey: mkey = mKt
    else
      let Qkey: key = Lkey in
      let Qmkey: mkey = Lmkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_97: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_96: mkey = cst_mkey
)


Applying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmKs [Difference of probability Pmac(time + time(context for game 8), N, N)] yields

Game 9 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
let mKt: mkey = mkgen(rmKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new Nt: nonce;
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Qmkey[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
            new rAK: keyseed;
            let AK_25: key = kgen(rAK) in
            new rmAK: mkeyseed;
            let mAK_26: mkey = mkgen(rmAK) in
            new r3: seed;
            let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3) in
            let mac3: macs = mac(e3, Qmkey[j2]) in
            new r4: seed;
            let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4) in
            let mac4: macs = mac(e4, Rmkey[j1]) in
            event fullKC(hc, ht, n, e3, e4);
            out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          if check(m8, mKt, mac8) then
          let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_101) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
          orfind j3 <= N2 suchthat defined(rmKs, Pmkey_97[j3], Pkey[j3], Mhost2[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_104) in
            let x_124: maxmac = e10 in
            let mac10: macs = mac2(x_124, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_105) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(x_124[@i_125]) && ((m14 = x_124[@i_125]) && check2(x_124[@i_125], mkgen2(rmKs), mac14)) then
          if true then
          let injbot(concat2(SK_19: key, mSK_18: mkey, h5: client)) = dec(m14, Ks) in
          if check(m15, mSK_18, mac15) then
          let injbot(pad(=h5, ts3: timest)) = dec(m15, SK_19) in
          new r16: seed;
          let e16: maxmac = enc(padts(ts3), SK_19, r16) in
          let mac16: macs = mac(e16, mSK_18) in
          event partSC(h5, m14, m15);
          event fullSC(h5, m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(h5)))
        else
          if false then
          let injbot(concat2(SK_19: key, mSK_18: mkey, h5: client)) = dec(m14, Ks) in
          if check(m15, mSK_18, mac15) then
          let injbot(pad(=h5, ts3: timest)) = dec(m15, SK_19) in
          new r16: seed;
          let e16: maxmac = enc(padts(ts3), SK_19, r16) in
          let mac16: macs = mac(e16, mSK_18) in
          event partSC(h5, m14, m15);
          event fullSC(h5, m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(h5)))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey: mkey = mKt
    else
      let Qkey: key = Lkey in
      let Qmkey: mkey = Lmkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_97: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_96: mkey = cst_mkey
)


Applying simplify yields

Game 10 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
let mKt: mkey = mkgen(rmKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new Nt: nonce;
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Qmkey[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
            new rAK: keyseed;
            let AK_25: key = kgen(rAK) in
            new rmAK: mkeyseed;
            let mAK_26: mkey = mkgen(rmAK) in
            new r3: seed;
            let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3) in
            let mac3: macs = mac(e3, Qmkey[j2]) in
            new r4: seed;
            let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4) in
            let mac4: macs = mac(e4, Rmkey[j1]) in
            event fullKC(hc, ht, n, e3, e4);
            out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          if check(m8, mKt, mac8) then
          let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_101) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_104) in
            let x_124: maxmac = e10 in
            let mac10: macs = mac2(x_124, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_105) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(h4[@i_125], mSK_24[@i_125], SK_23[@i_125], x_124[@i_125]) && ((m14 = x_124[@i_125]) && check2(x_124[@i_125], mkgen2(rmKs), mac14)) then
        let SK_19: key = SK_23[@i_125] in
        let mSK_18: mkey = mSK_24[@i_125] in
        let h5: client = h4[@i_125] in
        if check(m15, mSK_18, mac15) then
        let injbot(pad(=h5, ts3: timest)) = dec(m15, SK_19) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_19, r16) in
        let mac16: macs = mac(e16, mSK_18) in
        event partSC(h5, m14, m15);
        event fullSC(h5, m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h5)))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey: mkey = mKt
    else
      let Qkey: key = Lkey in
      let Qmkey: mkey = Lmkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_97: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_96: mkey = cst_mkey
)


Applying move all binders yields

Game 11 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
let mKt: mkey = mkgen(rmKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new Nt: nonce;
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Qmkey[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
            new rAK: keyseed;
            let AK_25: key = kgen(rAK) in
            new rmAK: mkeyseed;
            let mAK_26: mkey = mkgen(rmAK) in
            new r3: seed;
            let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3) in
            let mac3: macs = mac(e3, Qmkey[j2]) in
            new r4: seed;
            let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4) in
            let mac4: macs = mac(e4, Rmkey[j1]) in
            event fullKC(hc, ht, n, e3, e4);
            out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          if check(m8, mKt, mac8) then
          let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_101) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_104) in
            let x_124: maxmac = e10 in
            let mac10: macs = mac2(x_124, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_105) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(h4[@i_125], mSK_24[@i_125], SK_23[@i_125], x_124[@i_125]) && ((m14 = x_124[@i_125]) && check2(x_124[@i_125], mkgen2(rmKs), mac14)) then
        let mSK_18: mkey = mSK_24[@i_125] in
        if check(m15, mSK_18, mac15) then
        let h5: client = h4[@i_125] in
        let SK_19: key = SK_23[@i_125] in
        let injbot(pad(=h5, ts3: timest)) = dec(m15, SK_19) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_19, r16) in
        let mac16: macs = mac(e16, mSK_18) in
        event partSC(h5, m14, m15);
        event fullSC(h5, m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h5)))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey: mkey = mKt
    else
      let Qkey: key = Lkey in
      let Qmkey: mkey = Lmkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_97: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of useless yields

Game 12 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
let mKt: mkey = mkgen(rmKt) in
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new Nt: nonce;
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Qmkey[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
            new rAK: keyseed;
            let AK_25: key = kgen(rAK) in
            new rmAK: mkeyseed;
            let mAK_26: mkey = mkgen(rmAK) in
            new r3: seed;
            let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3) in
            let mac3: macs = mac(e3, Qmkey[j2]) in
            new r4: seed;
            let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4) in
            let mac4: macs = mac(e4, Rmkey[j1]) in
            event fullKC(hc, ht, n, e3, e4);
            out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          if check(m8, mKt, mac8) then
          let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_101) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_105) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(e10[@i_125], x_124[@i_125], h4[@i_125], mSK_24[@i_125], SK_23[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=h4[@i_125], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(h4[@i_125], m14, m15);
        event fullSC(h4[@i_125], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h4[@i_125])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey: mkey = mKt
    else
      let Qkey: key = Lkey in
      let Qmkey: mkey = Lmkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_97: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of binder mKt yields

Game 13 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new Nt: nonce;
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Qmkey[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
            new rAK: keyseed;
            let AK_25: key = kgen(rAK) in
            new rmAK: mkeyseed;
            let mAK_26: mkey = mkgen(rmAK) in
            new r3: seed;
            let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3) in
            let mac3: macs = mac(e3, Qmkey[j2]) in
            new r4: seed;
            let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4) in
            let mac4: macs = mac(e4, Rmkey[j1]) in
            event fullKC(hc, ht, n, e3, e4);
            out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          if check(m8, mkgen(rmKt), mac8) then
          let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_101) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_105) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(e10[@i_125], x_124[@i_125], h4[@i_125], mSK_24[@i_125], SK_23[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=h4[@i_125], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(h4[@i_125], m14, m15);
        event fullSC(h4[@i_125], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h4[@i_125])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey: mkey = mkgen(rmKt)
    else
      let Qkey: key = Lkey in
      let Qmkey: mkey = Lmkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_97: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_96: mkey = cst_mkey
)


Applying SA rename Qmkey yields

Game 14 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new Nt: nonce;
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Qmkey_198[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
              new rAK: keyseed;
              let AK_25: key = kgen(rAK) in
              new rmAK: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK) in
              new r3: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3) in
              let mac3: macs = mac(e3, Qmkey_198[j2]) in
              new r4: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j2 <= N2 suchthat defined(Qmkey_199[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
              new rAK: keyseed;
              let AK_25: key = kgen(rAK) in
              new rmAK: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK) in
              new r3: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3) in
              let mac3: macs = mac(e3, Qmkey_199[j2]) in
              new r4: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          if check(m8, mkgen(rmKt), mac8) then
          let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_101) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_105) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(e10[@i_125], x_124[@i_125], h4[@i_125], mSK_24[@i_125], SK_23[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=h4[@i_125], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(h4[@i_125], m14, m15);
        event fullSC(h4[@i_125], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h4[@i_125])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_199: mkey = mkgen(rmKt)
    else
      let Qkey: key = Lkey in
      let Qmkey_198: mkey = Lmkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_97: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of useless yields

Game 15 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new Nt: nonce;
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Lmkey[j2], Qmkey_198[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
              new rAK_200: keyseed;
              let AK_25: key = kgen(rAK_200) in
              new rmAK_201: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK_201) in
              new r3_202: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_202) in
              let mac3: macs = mac(e3, Lmkey[j2]) in
              new r4_203: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_203) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j2 <= N2 suchthat defined(Qmkey_199[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
              new rAK_204: keyseed;
              let AK_25: key = kgen(rAK_204) in
              new rmAK_205: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK_205) in
              new r3_206: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_206) in
              let mac3: macs = mac(e3, Qmkey_199[j2]) in
              new r4_207: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_207) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          if check(m8, mkgen(rmKt), mac8) then
          let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_101) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_105) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(e10[@i_125], x_124[@i_125], h4[@i_125], mSK_24[@i_125], SK_23[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=h4[@i_125], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(h4[@i_125], m14, m15);
        event fullSC(h4[@i_125], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h4[@i_125])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_199: mkey = mkgen(rmKt)
    else
      let Qkey: key = Lkey in
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_97: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_96: mkey = cst_mkey
)


Applying simplify yields

Game 16 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new Nt: nonce;
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
              new rAK_200: keyseed;
              let AK_25: key = kgen(rAK_200) in
              new rmAK_201: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK_201) in
              new r3_202: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_202) in
              let mac3: macs = mac(e3, Lmkey[j2]) in
              new r4_203: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_203) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j2 <= N2 suchthat defined(Qmkey_199[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
              new rAK_204: keyseed;
              let AK_25: key = kgen(rAK_204) in
              new rmAK_205: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK_205) in
              new r3_206: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_206) in
              let mac3: macs = mac(e3, Qmkey_199[j2]) in
              new r4_207: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_207) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          if check(m8, mkgen(rmKt), mac8) then
          let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_101) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_105) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], h4[@i_125], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=h4[@i_125], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(h4[@i_125], m14, m15);
        event fullSC(h4[@i_125], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h4[@i_125])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_199: mkey = mkgen(rmKt)
    else
      let Qkey: key = Lkey in
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_97: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of binder Qmkey_199 yields

Game 17 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new Nt: nonce;
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
              new rAK_200: keyseed;
              let AK_25: key = kgen(rAK_200) in
              new rmAK_201: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK_201) in
              new r3_202: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_202) in
              let mac3: macs = mac(e3, Lmkey[j2]) in
              new r4_203: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_203) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j2 <= N2 suchthat defined(rmKt, Qmkey_199[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
              new rAK_204: keyseed;
              let AK_25: key = kgen(rAK_204) in
              new rmAK_205: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK_205) in
              new r3_206: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_206) in
              let mac3: macs = mac(e3, mkgen(rmKt)) in
              new r4_207: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_207) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          if check(m8, mkgen(rmKt), mac8) then
          let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_101) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_105) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], h4[@i_125], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=h4[@i_125], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(h4[@i_125], m14, m15);
        event fullSC(h4[@i_125], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h4[@i_125])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_199: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_97: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_96: mkey = cst_mkey
)


Applying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmKt [Difference of probability Pmac(time + time(context for game 17), N, N)] yields

Game 18 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new Nt: nonce;
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
              new rAK_200: keyseed;
              let AK_25: key = kgen(rAK_200) in
              new rmAK_201: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK_201) in
              new r3_202: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_202) in
              let mac3: macs = mac(e3, Lmkey[j2]) in
              new r4_203: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_203) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j2 <= N2 suchthat defined(rmKt, Qmkey_199[j2], Qkey[j2], Lhost[j2]) && (Lhost[j2] = ht) then
              new rAK_204: keyseed;
              let AK_25: key = kgen(rAK_204) in
              new rmAK_205: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK_205) in
              new r3_206: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_206) in
              let x_217: maxmac = e3 in
              let mac3: macs = mac2(x_217, mkgen2(rmKt)) in
              new r4_207: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_207) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(x_217[@i_218]) && ((m8 = x_217[@i_218]) && check2(x_217[@i_218], mkgen2(rmKt), mac8)) then
            if true then
            let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
            if check(m9, mAK_20, mac9) then
            let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
            event partTC(h4, m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_98: keyseed;
              let SK_23: key = kgen(rSK_98) in
              new rmSK_99: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_99) in
              new r10_100: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_100) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_101: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_101) in
              let mac11: macs = mac(e11, mAK_20) in
              event fullTC(h4, h3, n2, m8, m9, e11);
              out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
            orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_102: keyseed;
              let SK_23: key = kgen(rSK_102) in
              new rmSK_103: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_103) in
              new r10_104: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_104) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_105: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_105) in
              let mac11: macs = mac(e11, mAK_20) in
              event fullTC(h4, h3, n2, m8, m9, e11);
              out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
          else
            if false then
            let injbot(concat2(AK_21: key, mAK_20: mkey, h4: client)) = dec(m8, Kt) in
            if check(m9, mAK_20, mac9) then
            let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
            event partTC(h4, m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_98: keyseed;
              let SK_23: key = kgen(rSK_98) in
              new rmSK_99: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_99) in
              new r10_100: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_100) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_101: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_101) in
              let mac11: macs = mac(e11, mAK_20) in
              event fullTC(h4, h3, n2, m8, m9, e11);
              out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
            orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_102: keyseed;
              let SK_23: key = kgen(rSK_102) in
              new rmSK_103: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_103) in
              new r10_104: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_104) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_105: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_105) in
              let mac11: macs = mac(e11, mAK_20) in
              event fullTC(h4, h3, n2, m8, m9, e11);
              out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], h4[@i_125], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=h4[@i_125], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(h4[@i_125], m14, m15);
        event fullSC(h4[@i_125], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h4[@i_125])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_199: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_97: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_96: mkey = cst_mkey
)


Applying simplify yields

Game 19 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new Nt: nonce;
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
              new rAK_200: keyseed;
              let AK_25: key = kgen(rAK_200) in
              new rmAK_201: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK_201) in
              new r3_202: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_202) in
              let mac3: macs = mac(e3, Lmkey[j2]) in
              new r4_203: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_203) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
              new rAK_204: keyseed;
              let AK_25: key = kgen(rAK_204) in
              new rmAK_205: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK_205) in
              new r3_206: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_206) in
              let x_217: maxmac = e3 in
              let mac3: macs = mac2(x_217, mkgen2(rmKt)) in
              new r4_207: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_207) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(hc[@i_218], mAK_26[@i_218], AK_25[@i_218], x_217[@i_218]) && ((m8 = x_217[@i_218]) && check2(x_217[@i_218], mkgen2(rmKt), mac8)) then
          let AK_21: key = AK_25[@i_218] in
          let mAK_20: mkey = mAK_26[@i_218] in
          let h4: client = hc[@i_218] in
          if check(m9, mAK_20, mac9) then
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_101) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_105) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], h4[@i_125], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=h4[@i_125], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(h4[@i_125], m14, m15);
        event fullSC(h4[@i_125], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h4[@i_125])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_199: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_97: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_96: mkey = cst_mkey
)


Applying move all binders yields

Game 20 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new Nt: nonce;
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
              new rAK_200: keyseed;
              let AK_25: key = kgen(rAK_200) in
              new rmAK_201: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK_201) in
              new r3_202: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_202) in
              let mac3: macs = mac(e3, Lmkey[j2]) in
              new r4_203: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_203) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
              new rAK_204: keyseed;
              let AK_25: key = kgen(rAK_204) in
              new rmAK_205: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK_205) in
              new r3_206: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_206) in
              let x_217: maxmac = e3 in
              let mac3: macs = mac2(x_217, mkgen2(rmKt)) in
              new r4_207: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_207) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(hc[@i_218], mAK_26[@i_218], AK_25[@i_218], x_217[@i_218]) && ((m8 = x_217[@i_218]) && check2(x_217[@i_218], mkgen2(rmKt), mac8)) then
          let mAK_20: mkey = mAK_26[@i_218] in
          let h4: client = hc[@i_218] in
          if check(m9, mAK_20, mac9) then
          let AK_21: key = AK_25[@i_218] in
          let injbot(pad(=h4, ts_22: timest)) = dec(m9, AK_21) in
          event partTC(h4, m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_101) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, h4), Pkey[j3], r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_21, r11_105) in
            let mac11: macs = mac(e11, mAK_20) in
            event fullTC(h4, h3, n2, m8, m9, e11);
            out(c8[!_13], (h4, e10, mac10, e11, mac11, acceptT(h4, h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], h4[@i_125], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=h4[@i_125], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(h4[@i_125], m14, m15);
        event fullSC(h4[@i_125], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(h4[@i_125])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_199: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_97: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of useless yields

Game 21 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
let mKc: mkey = mkgen(rmKc) in
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mKc, mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new Nt: nonce;
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
              new rAK_200: keyseed;
              let AK_25: key = kgen(rAK_200) in
              new rmAK_201: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK_201) in
              new r3_202: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_202) in
              let mac3: macs = mac(e3, Lmkey[j2]) in
              new r4_203: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_203) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
              new rAK_204: keyseed;
              let AK_25: key = kgen(rAK_204) in
              new rmAK_205: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK_205) in
              new r3_206: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_206) in
              let x_217: maxmac = cst_maxmac in
              let mac3: macs = mac2(e3, mkgen2(rmKt)) in
              new r4_207: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_207) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(e3[@i_218], x_217[@i_218], hc[@i_218], mAK_26[@i_218], AK_25[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
          let h4: client = cst_client in
          if check(m9, mAK_26[@i_218], mac9) then
          let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
          event partTC(hc[@i_218], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Pkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Pkey[j3], r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(hc[@i_218[@i_125]], h4[@i_125], SK_23[@i_125], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mKc
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_199: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_97: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of binder mKc yields

Game 22 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mkgen(rmKc), mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new Nt: nonce;
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
            find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
              new rAK_200: keyseed;
              let AK_25: key = kgen(rAK_200) in
              new rmAK_201: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK_201) in
              new r3_202: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_202) in
              let mac3: macs = mac(e3, Lmkey[j2]) in
              new r4_203: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_203) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
              new rAK_204: keyseed;
              let AK_25: key = kgen(rAK_204) in
              new rmAK_205: mkeyseed;
              let mAK_26: mkey = mkgen(rmAK_205) in
              new r3_206: seed;
              let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_206) in
              let x_217: maxmac = cst_maxmac in
              let mac3: macs = mac2(e3, mkgen2(rmKt)) in
              new r4_207: seed;
              let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_207) in
              let mac4: macs = mac(e4, Rmkey[j1]) in
              event fullKC(hc, ht, n, e3, e4);
              out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(e3[@i_218], x_217[@i_218], hc[@i_218], mAK_26[@i_218], AK_25[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
          let h4: client = cst_client in
          if check(m9, mAK_26[@i_218], mac9) then
          let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
          event partTC(hc[@i_218], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Pkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Pkey[j3], r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(hc[@i_218[@i_125]], h4[@i_125], SK_23[@i_125], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey: mkey = mkgen(rmKc)
      else
        let Rkey: key = Kkey in
        let Rmkey: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_199: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_97: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_96: mkey = cst_mkey
)


Applying SA rename Rmkey yields

Game 23 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mkgen(rmKc), mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new Nt: nonce;
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Rmkey_315[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_200: keyseed;
                let AK_25: key = kgen(rAK_200) in
                new rmAK_201: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_201) in
                new r3_202: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_202) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_203: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_203) in
                let mac4: macs = mac(e4, Rmkey_315[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_204: keyseed;
                let AK_25: key = kgen(rAK_204) in
                new rmAK_205: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_205) in
                new r3_206: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_206) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_207: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_207) in
                let mac4: macs = mac(e4, Rmkey_315[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Rmkey_316[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_200: keyseed;
                let AK_25: key = kgen(rAK_200) in
                new rmAK_201: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_201) in
                new r3_202: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_202) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_203: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_203) in
                let mac4: macs = mac(e4, Rmkey_316[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_204: keyseed;
                let AK_25: key = kgen(rAK_204) in
                new rmAK_205: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_205) in
                new r3_206: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_206) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_207: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_207) in
                let mac4: macs = mac(e4, Rmkey_316[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(e3[@i_218], x_217[@i_218], hc[@i_218], mAK_26[@i_218], AK_25[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
          let h4: client = cst_client in
          if check(m9, mAK_26[@i_218], mac9) then
          let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
          event partTC(hc[@i_218], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Pkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Pkey[j3], r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(hc[@i_218[@i_125]], h4[@i_125], SK_23[@i_125], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey_316: mkey = mkgen(rmKc)
      else
        let Rkey: key = Kkey in
        let Rmkey_315: mkey = Kmkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_199: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_97: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of useless yields

Game 24 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mkgen(rmKc), mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new Nt: nonce;
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Rmkey_315[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_318) in
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Rmkey_316[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_326) in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_328) in
                let mac4: macs = mac(e4, Rmkey_316[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_330) in
                new r3_331: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_332) in
                let mac4: macs = mac(e4, Rmkey_316[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(e3[@i_218], x_217[@i_218], hc[@i_218], mAK_26[@i_218], AK_25[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
          let h4: client = cst_client in
          if check(m9, mAK_26[@i_218], mac9) then
          let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
          event partTC(hc[@i_218], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Pkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Pkey[j3], r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(hc[@i_218[@i_125]], h4[@i_125], SK_23[@i_125], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey_316: mkey = mkgen(rmKc)
      else
        let Rkey: key = Kkey in
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_199: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_97: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_96: mkey = cst_mkey
)


Applying simplify yields

Game 25 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mkgen(rmKc), mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new Nt: nonce;
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Rkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_318) in
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Rmkey_316[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_326) in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_328) in
                let mac4: macs = mac(e4, Rmkey_316[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_330) in
                new r3_331: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_332) in
                let mac4: macs = mac(e4, Rmkey_316[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_26[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
          let h4: client = cst_client in
          if check(m9, mAK_26[@i_218], mac9) then
          let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
          event partTC(hc[@i_218], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Pkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Pkey[j3], r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey_316: mkey = mkgen(rmKc)
      else
        let Rkey: key = Kkey in
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_199: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_97: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of binder Rmkey_316 yields

Game 26 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            if check(m2, mkgen(rmKc), mac2) then
            let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
            event fullCK(h, Nc, m, m2);
            new Nt: nonce;
            new ts_29: timest;
            new r1: seed;
            let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
            let mac5: macs = mac(e5, mAK_27) in
            event partCT(h, m, e5);
            out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
            in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
            if check(m7, mAK_27, mac7) then
            let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
            event fullCT(h, h2, Nt, m, e5, m7);
            new ts2: timest;
            new r2: seed;
            let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
            let mac12: macs = mac(e12, mSK_30) in
            event partCS(h2, h, m7, e12);
            out(c6[!_11], (m6, mac6, e12, mac12));
            in(c9[!_11], (m13: maxmac, mac13: macs));
            if check(m13, mSK_30, mac13) then
            if (injbot(padts(ts2)) = dec(m13, SK_31)) then
            event fullCS(h2, h, m7, e12, m13);
            out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Rkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_318) in
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(rmKc, Rmkey_316[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_326) in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_328) in
                let mac4: macs = mac(e4, mkgen(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_330) in
                new r3_331: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_332) in
                let mac4: macs = mac(e4, mkgen(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_26[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_218], mac9) then
          let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
          event partTC(hc[@i_218], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Pkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Pkey[j3], r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey_316: mkey = cst_mkey
      else
        let Rkey: key = Kkey in
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_199: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_97: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_96: mkey = cst_mkey
)


Applying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmKc [Difference of probability Pmac(time + time(context for game 26), N, N)] yields

Game 27 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(x_342[@i_346]) && ((m2 = x_342[@i_346]) && check2(x_342[@i_346], mkgen2(rmKc), mac2)) then
              if true then
              let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
              event fullCK(h, Nc, m, m2);
              new Nt: nonce;
              new ts_29: timest;
              new r1: seed;
              let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
              let mac5: macs = mac(e5, mAK_27) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_27, mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
              event fullCT(h, h2, Nt, m, e5, m7);
              new ts2: timest;
              new r2: seed;
              let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(x_343[@i_345]) && ((m2 = x_343[@i_345]) && check2(x_343[@i_345], mkgen2(rmKc), mac2)) then
              if true then
              let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
              event fullCK(h, Nc, m, m2);
              new Nt: nonce;
              new ts_29: timest;
              new r1: seed;
              let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
              let mac5: macs = mac(e5, mAK_27) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_27, mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
              event fullCT(h, h2, Nt, m, e5, m7);
              new ts2: timest;
              new r2: seed;
              let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            else
              if false then
              let injbot(concat1(AK_28: key, mAK_27: mkey, =Nc, =h)) = dec(m2, Kc) in
              event fullCK(h, Nc, m, m2);
              new Nt: nonce;
              new ts_29: timest;
              new r1: seed;
              let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
              let mac5: macs = mac(e5, mAK_27) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_27, mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
              event fullCT(h, h2, Nt, m, e5, m7);
              new ts2: timest;
              new r2: seed;
              let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Rkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_318) in
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(rmKc, Rmkey_316[j1], Rkey[j1], Khost[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_326) in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_328) in
                let x_342: maxmac = e4 in
                let mac4: macs = mac2(x_342, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_330) in
                new r3_331: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_332) in
                let x_343: maxmac = e4 in
                let mac4: macs = mac2(x_343, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_26[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_218], mac9) then
          let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
          event partTC(hc[@i_218], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Pkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Pkey[j3], r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey_316: mkey = cst_mkey
      else
        let Rkey: key = Kkey in
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_199: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_97: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_96: mkey = cst_mkey
)


Applying simplify yields

Game 28 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(ht[@i_346], n[@i_346], mAK_26[@i_346], AK_25[@i_346], x_342[@i_346]) && ((m2 = x_342[@i_346]) && check2(x_342[@i_346], mkgen2(rmKc), mac2)) then
              let AK_28: key = AK_25[@i_346] in
              let mAK_27: mkey = mAK_26[@i_346] in
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt: nonce;
              new ts_29: timest;
              new r1: seed;
              let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
              let mac5: macs = mac(e5, mAK_27) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_27, mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
              event fullCT(h, h2, Nt, m, e5, m7);
              new ts2: timest;
              new r2: seed;
              let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(ht[@i_345], n[@i_345], mAK_26[@i_345], AK_25[@i_345], x_343[@i_345]) && ((m2 = x_343[@i_345]) && check2(x_343[@i_345], mkgen2(rmKc), mac2)) then
              let AK_28: key = AK_25[@i_345] in
              let mAK_27: mkey = mAK_26[@i_345] in
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt: nonce;
              new ts_29: timest;
              new r1: seed;
              let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
              let mac5: macs = mac(e5, mAK_27) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_27, mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
              event fullCT(h, h2, Nt, m, e5, m7);
              new ts2: timest;
              new r2: seed;
              let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Rkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_318) in
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Rkey[j1], Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_326) in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_328) in
                let x_342: maxmac = e4 in
                let mac4: macs = mac2(x_342, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_330) in
                new r3_331: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_332) in
                let x_343: maxmac = e4 in
                let mac4: macs = mac2(x_343, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_26[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_218], mac9) then
          let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
          event partTC(hc[@i_218], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Pkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Pkey[j3], r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey_316: mkey = cst_mkey
      else
        let Rkey: key = Kkey in
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_199: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_97: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_96: mkey = cst_mkey
)


Applying move all binders yields

Game 29 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(ht[@i_346], n[@i_346], mAK_26[@i_346], AK_25[@i_346], x_342[@i_346]) && ((m2 = x_342[@i_346]) && check2(x_342[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt: nonce;
              new ts_29: timest;
              new r1: seed;
              let AK_28: key = AK_25[@i_346] in
              let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
              let mAK_27: mkey = mAK_26[@i_346] in
              let mac5: macs = mac(e5, mAK_27) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_27, mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
              event fullCT(h, h2, Nt, m, e5, m7);
              new ts2: timest;
              new r2: seed;
              let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(ht[@i_345], n[@i_345], mAK_26[@i_345], AK_25[@i_345], x_343[@i_345]) && ((m2 = x_343[@i_345]) && check2(x_343[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt: nonce;
              new ts_29: timest;
              new r1: seed;
              let AK_28: key = AK_25[@i_345] in
              let e5: maxmac = enc(pad(C, ts_29), AK_28, r1) in
              let mAK_27: mkey = mAK_26[@i_345] in
              let mac5: macs = mac(e5, mAK_27) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_27, mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt, =h2)) = dec(m7, AK_28) in
              event fullCT(h, h2, Nt, m, e5, m7);
              new ts2: timest;
              new r2: seed;
              let e12: maxmac = enc(pad(C, ts2), SK_31, r2) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Rkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_318) in
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Rkey[j1], Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_326) in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_328) in
                let x_342: maxmac = e4 in
                let mac4: macs = mac2(x_342, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_330) in
                new r3_331: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_332) in
                let x_343: maxmac = e4 in
                let mac4: macs = mac2(x_343, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_26[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_218], mac9) then
          let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
          event partTC(hc[@i_218], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Pkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Pkey[j3], r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey_316: mkey = cst_mkey
      else
        let Rkey: key = Kkey in
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_199: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_97: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of useless yields

Game 30 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(e4[@i_346], x_342[@i_346], ht[@i_346], n[@i_346], mAK_26[@i_346], AK_25[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mAK_26[@i_346]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_346], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(e4[@i_345], x_343[@i_345], ht[@i_345], n[@i_345], mAK_26[@i_345], AK_25[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let mac5: macs = mac(e5, mAK_26[@i_345]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_345], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_370, =h2)) = dec(m7, AK_25[@i_345]) in
              event fullCT(h, h2, Nt_370, m, e5, m7);
              new ts2_373: timest;
              new r2_374: seed;
              let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Rkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_318) in
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Rkey[j1], Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_326) in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_330) in
                new r3_331: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_26[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_218], mac9) then
          let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
          event partTC(hc[@i_218], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Pkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Pkey[j3], r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey_316: mkey = cst_mkey
      else
        let Rkey: key = Kkey in
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_199: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks in
    let Pmkey_97: mkey = cst_mkey
  else
    let Pkey: key = Mkey in
    let Pmkey_96: mkey = cst_mkey
)


RESULT Proved event inj:fullCK(T, N, x, y) ==> inj:fullKC(C, T, N, z, y) with probability 0.5 * N * N / |nonce| + Pmac(time + time(context for game 26), N, N) + Pmac(time + time(context for game 17), N, N) + Pmac(time + time(context for game 8), N, N)

Applying SA rename Pkey yields

Game 32 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(e4[@i_346], x_342[@i_346], ht[@i_346], n[@i_346], mAK_26[@i_346], AK_25[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mAK_26[@i_346]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_346], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(e4[@i_345], x_343[@i_345], ht[@i_345], n[@i_345], mAK_26[@i_345], AK_25[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let mac5: macs = mac(e5, mAK_26[@i_345]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_345], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_370, =h2)) = dec(m7, AK_25[@i_345]) in
              event fullCT(h, h2, Nt_370, m, e5, m7);
              new ts2_373: timest;
              new r2_374: seed;
              let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Rkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_318) in
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Rkey[j1], Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_326) in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_330) in
                new r3_331: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_26[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_218], mac9) then
          let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
          event partTC(hc[@i_218], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Pkey_688[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Pkey_688[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind j3 <= N2 suchthat defined(Pkey_689[j3], Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Pkey_689[j3], r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey_316: mkey = cst_mkey
      else
        let Rkey: key = Kkey in
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_199: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_689: key = Ks in
    let Pmkey_97: mkey = cst_mkey
  else
    let Pkey_688: key = Mkey in
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of useless yields

Game 33 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(e4[@i_346], x_342[@i_346], ht[@i_346], n[@i_346], mAK_26[@i_346], AK_25[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mAK_26[@i_346]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_346], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(e4[@i_345], x_343[@i_345], ht[@i_345], n[@i_345], mAK_26[@i_345], AK_25[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let mac5: macs = mac(e5, mAK_26[@i_345]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_345], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_370, =h2)) = dec(m7, AK_25[@i_345]) in
              event fullCT(h, h2, Nt_370, m, e5, m7);
              new ts2_373: timest;
              new r2_374: seed;
              let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Rkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_318) in
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Rkey[j1], Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_326) in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_330) in
                new r3_331: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_26[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_218], mac9) then
          let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
          event partTC(hc[@i_218], m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Pkey_688[j3], Mmkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind j3 <= N2 suchthat defined(Ks, Pkey_689[j3], Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Ks, r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey_316: mkey = cst_mkey
      else
        let Rkey: key = Kkey in
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_199: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_689: key = cst_key in
    let Pmkey_97: mkey = cst_mkey
  else
    let Pkey_688: key = cst_key in
    let Pmkey_96: mkey = cst_mkey
)


Applying simplify yields

Game 34 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(mAK_26[@i_346], AK_25[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mAK_26[@i_346]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_346], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(mAK_26[@i_345], AK_25[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let mac5: macs = mac(e5, mAK_26[@i_345]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_345], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_370, =h2)) = dec(m7, AK_25[@i_345]) in
              event fullCT(h, h2, Nt_370, m, e5, m7);
              new ts2_373: timest;
              new r2_374: seed;
              let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Rkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_318) in
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Rkey[j1], Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_326) in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_330) in
                new r3_331: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_26[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_218], mac9) then
          let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
          event partTC(hc[@i_218], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Ks, r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey_316: mkey = cst_mkey
      else
        let Rkey: key = Kkey in
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_199: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_689: key = cst_key in
    let Pmkey_97: mkey = cst_mkey
  else
    let Pkey_688: key = cst_key in
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of binder Pkey_689 yields

Game 35 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
let Ks: key = kgen(rKs) in
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(mAK_26[@i_346], AK_25[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mAK_26[@i_346]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_346], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(mAK_26[@i_345], AK_25[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let mac5: macs = mac(e5, mAK_26[@i_345]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_345], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_370, =h2)) = dec(m7, AK_25[@i_345]) in
              event fullCT(h, h2, Nt_370, m, e5, m7);
              new ts2_373: timest;
              new r2_374: seed;
              let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Rkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_318) in
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Rkey[j1], Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_326) in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_330) in
                new r3_331: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_26[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_218], mac9) then
          let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
          event partTC(hc[@i_218], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Ks, r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey_316: mkey = cst_mkey
      else
        let Rkey: key = Kkey in
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_199: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of binder Ks yields

Game 36 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(mAK_26[@i_346], AK_25[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mAK_26[@i_346]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_346], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(mAK_26[@i_345], AK_25[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let mac5: macs = mac(e5, mAK_26[@i_345]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_345], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_370, =h2)) = dec(m7, AK_25[@i_345]) in
              event fullCT(h, h2, Nt_370, m, e5, m7);
              new ts2_373: timest;
              new r2_374: seed;
              let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Rkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_318) in
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Rkey[j1], Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_326) in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_330) in
                new r3_331: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_26[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_218], mac9) then
          let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
          event partTC(hc[@i_218], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), kgen(rKs), r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey_316: mkey = cst_mkey
      else
        let Rkey: key = Kkey in
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_199: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r10_104 [Difference of probability Penc(time + time(context for game 36), N)] yields

Game 37 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(mAK_26[@i_346], AK_25[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mAK_26[@i_346]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_346], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(mAK_26[@i_345], AK_25[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let mac5: macs = mac(e5, mAK_26[@i_345]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_345], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_370, =h2)) = dec(m7, AK_25[@i_345]) in
              event fullCT(h, h2, Nt_370, m, e5, m7);
              new ts2_373: timest;
              new r2_374: seed;
              let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Rkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_318) in
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Rkey[j1], Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_326) in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_330) in
                new r3_331: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_26[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_218], mac9) then
          let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
          event partTC(hc[@i_218], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc2(Z(concat2(SK_23, mSK_24, hc[@i_218])), kgen2(rKs), r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey_316: mkey = cst_mkey
      else
        let Rkey: key = Kkey in
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_199: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying simplify yields

Game 38 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(mAK_26[@i_346], AK_25[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mAK_26[@i_346]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_346], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(mAK_26[@i_345], AK_25[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let mac5: macs = mac(e5, mAK_26[@i_345]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_345], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_370, =h2)) = dec(m7, AK_25[@i_345]) in
              event fullCT(h, h2, Nt_370, m, e5, m7);
              new ts2_373: timest;
              new r2_374: seed;
              let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Rkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_318) in
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Rkey[j1], Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_326) in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_330) in
                new r3_331: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey[j1], r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_26[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_218], mac9) then
          let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
          event partTC(hc[@i_218], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey: key = Kc in
        let Rmkey_316: mkey = cst_mkey
      else
        let Rkey: key = Kkey in
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_199: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying SA rename Rkey yields

Game 39 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(mAK_26[@i_346], AK_25[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mAK_26[@i_346]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_346], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(mAK_26[@i_345], AK_25[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let mac5: macs = mac(e5, mAK_26[@i_345]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_345], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_370, =h2)) = dec(m7, AK_25[@i_345]) in
              event fullCT(h, h2, Nt_370, m, e5, m7);
              new ts2_373: timest;
              new r2_374: seed;
              let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Rkey_1142[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_318) in
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey_1142[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey_1142[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Rkey_1143[j1], Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_326) in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey_1143[j1], r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_330) in
                new r3_331: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Rkey_1143[j1], r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_26[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_218], mac9) then
          let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
          event partTC(hc[@i_218], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey_1143: key = Kc in
        let Rmkey_316: mkey = cst_mkey
      else
        let Rkey_1142: key = Kkey in
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_199: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of useless yields

Game 40 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(mAK_26[@i_346], AK_25[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mAK_26[@i_346]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_346], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(mAK_26[@i_345], AK_25[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let mac5: macs = mac(e5, mAK_26[@i_345]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_345], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_370, =h2)) = dec(m7, AK_25[@i_345]) in
              event fullCT(h, h2, Nt_370, m, e5, m7);
              new ts2_373: timest;
              new r2_374: seed;
              let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kkey[j1], Rkey_1142[j1], Kmkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_318) in
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Kc, Rkey_1143[j1], Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_326) in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kc, r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_330) in
                new r3_331: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kc, r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_26[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_218], mac9) then
          let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
          event partTC(hc[@i_218], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey_1143: key = cst_key in
        let Rmkey_316: mkey = cst_mkey
      else
        let Rkey_1142: key = cst_key in
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_199: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying simplify yields

Game 41 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(mAK_26[@i_346], AK_25[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mAK_26[@i_346]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_346], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(mAK_26[@i_345], AK_25[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let mac5: macs = mac(e5, mAK_26[@i_345]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_345], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_370, =h2)) = dec(m7, AK_25[@i_345]) in
              event fullCT(h, h2, Nt_370, m, e5, m7);
              new ts2_373: timest;
              new r2_374: seed;
              let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_318) in
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_326) in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kc, r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_330) in
                new r3_331: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kc, r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_26[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_218], mac9) then
          let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
          event partTC(hc[@i_218], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rkey_1143: key = cst_key in
        let Rmkey_316: mkey = cst_mkey
      else
        let Rkey_1142: key = cst_key in
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_199: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of binder Rkey_1143 yields

Game 42 is
in(start, ());
new rKc: keyseed;
let Kc: key = kgen(rKc) in
new rmKc: mkeyseed;
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(mAK_26[@i_346], AK_25[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mAK_26[@i_346]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_346], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(mAK_26[@i_345], AK_25[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let mac5: macs = mac(e5, mAK_26[@i_345]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_345], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_370, =h2)) = dec(m7, AK_25[@i_345]) in
              event fullCT(h, h2, Nt_370, m, e5, m7);
              new ts2_373: timest;
              new r2_374: seed;
              let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_318) in
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_326) in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kc, r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_330) in
                new r3_331: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kc, r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_26[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_218], mac9) then
          let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
          event partTC(hc[@i_218], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_199: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of binder Kc yields

Game 43 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(mAK_26[@i_346], AK_25[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mAK_26[@i_346]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_346], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(mAK_26[@i_345], AK_25[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let mac5: macs = mac(e5, mAK_26[@i_345]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_345], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_370, =h2)) = dec(m7, AK_25[@i_345]) in
              event fullCT(h, h2, Nt_370, m, e5, m7);
              new ts2_373: timest;
              new r2_374: seed;
              let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_318) in
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_326) in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), kgen(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_330) in
                new r3_331: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), kgen(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_26[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_218], mac9) then
          let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
          event partTC(hc[@i_218], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_199: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r4_332 [Difference of probability Penc(time + time(context for game 43), N)] yields

Game 44 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(mAK_26[@i_346], AK_25[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mAK_26[@i_346]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_346], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(mAK_26[@i_345], AK_25[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let mac5: macs = mac(e5, mAK_26[@i_345]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_345], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_370, =h2)) = dec(m7, AK_25[@i_345]) in
              event fullCT(h, h2, Nt_370, m, e5, m7);
              new ts2_373: timest;
              new r2_374: seed;
              let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_318) in
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_326) in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Z(concat1(AK_25, mAK_26, n, ht)), kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_330) in
                new r3_331: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Z(concat1(AK_25, mAK_26, n, ht)), kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_26[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_218], mac9) then
          let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
          event partTC(hc[@i_218], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_199: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying simplify yields

Game 45 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(mAK_26[@i_346], AK_25[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mAK_26[@i_346]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_346], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(mAK_26[@i_345], AK_25[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let mac5: macs = mac(e5, mAK_26[@i_345]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_345], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_370, =h2)) = dec(m7, AK_25[@i_345]) in
              event fullCT(h, h2, Nt_370, m, e5, m7);
              new ts2_373: timest;
              new r2_374: seed;
              let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_318) in
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_326) in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_330) in
                new r3_331: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey[j2], r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_26[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_218], mac9) then
          let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
          event partTC(hc[@i_218], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey: key = Kt in
      let Qmkey_199: mkey = cst_mkey
    else
      let Qkey: key = Lkey in
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying SA rename Qkey yields

Game 46 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(mAK_26[@i_346], AK_25[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mAK_26[@i_346]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_346], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(mAK_26[@i_345], AK_25[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let mac5: macs = mac(e5, mAK_26[@i_345]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_345], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_370, =h2)) = dec(m7, AK_25[@i_345]) in
              event fullCT(h, h2, Nt_370, m, e5, m7);
              new ts2_373: timest;
              new r2_374: seed;
              let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey_1597[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_318) in
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey_1597[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey_1598[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey_1598[j2], r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Qkey_1597[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_326) in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey_1597[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Qkey_1598[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_330) in
                new r3_331: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Qkey_1598[j2], r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_26[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_218], mac9) then
          let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
          event partTC(hc[@i_218], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey_1598: key = Kt in
      let Qmkey_199: mkey = cst_mkey
    else
      let Qkey_1597: key = Lkey in
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of useless yields

Game 47 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(mAK_26[@i_346], AK_25[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mAK_26[@i_346]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_346], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(mAK_26[@i_345], AK_25[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let mac5: macs = mac(e5, mAK_26[@i_345]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_345], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_370, =h2)) = dec(m7, AK_25[@i_345]) in
              event fullCT(h, h2, Nt_370, m, e5, m7);
              new ts2_373: timest;
              new r2_374: seed;
              let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lkey[j2], Qkey_1597[j2], Lmkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_318) in
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Kt, Qkey_1598[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Kt, r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lkey[j2], Qkey_1597[j2], Lmkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_326) in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Kt, Qkey_1598[j2], Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_330) in
                new r3_331: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Kt, r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_26[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_218], mac9) then
          let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
          event partTC(hc[@i_218], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey_1598: key = cst_key in
      let Qmkey_199: mkey = cst_mkey
    else
      let Qkey_1597: key = cst_key in
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying simplify yields

Game 48 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(mAK_26[@i_346], AK_25[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mAK_26[@i_346]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_346], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(mAK_26[@i_345], AK_25[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let mac5: macs = mac(e5, mAK_26[@i_345]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_345], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_370, =h2)) = dec(m7, AK_25[@i_345]) in
              event fullCT(h, h2, Nt_370, m, e5, m7);
              new ts2_373: timest;
              new r2_374: seed;
              let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_318) in
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Kt, r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_326) in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_330) in
                new r3_331: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Kt, r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_26[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_218], mac9) then
          let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
          event partTC(hc[@i_218], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qkey_1598: key = cst_key in
      let Qmkey_199: mkey = cst_mkey
    else
      let Qkey_1597: key = cst_key in
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of binder Qkey_1598 yields

Game 49 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
let Kt: key = kgen(rKt) in
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(mAK_26[@i_346], AK_25[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mAK_26[@i_346]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_346], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(mAK_26[@i_345], AK_25[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let mac5: macs = mac(e5, mAK_26[@i_345]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_345], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_370, =h2)) = dec(m7, AK_25[@i_345]) in
              event fullCT(h, h2, Nt_370, m, e5, m7);
              new ts2_373: timest;
              new r2_374: seed;
              let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_318) in
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Kt, r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_326) in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_330) in
                new r3_331: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Kt, r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_26[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_218], mac9) then
          let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
          event partTC(hc[@i_218], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of binder Kt yields

Game 50 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(mAK_26[@i_346], AK_25[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mAK_26[@i_346]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_346], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(mAK_26[@i_345], AK_25[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let mac5: macs = mac(e5, mAK_26[@i_345]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_345], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_370, =h2)) = dec(m7, AK_25[@i_345]) in
              event fullCT(h, h2, Nt_370, m, e5, m7);
              new ts2_373: timest;
              new r2_374: seed;
              let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_318) in
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), kgen(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_326) in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_330) in
                new r3_331: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), kgen(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_26[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_218], mac9) then
          let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
          event partTC(hc[@i_218], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r3_331 [Difference of probability Penc(time + time(context for game 50), N)] yields

Game 51 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(mAK_26[@i_346], AK_25[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mAK_26[@i_346]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_346], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(mAK_26[@i_345], AK_25[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let mac5: macs = mac(e5, mAK_26[@i_345]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_345], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_370, =h2)) = dec(m7, AK_25[@i_345]) in
              event fullCT(h, h2, Nt_370, m, e5, m7);
              new ts2_373: timest;
              new r2_374: seed;
              let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_318) in
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc2(Z(concat2(AK_25, mAK_26, hc)), kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_326) in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_330) in
                new r3_331: seed;
                let e3: maxmac = enc2(Z(concat2(AK_25, mAK_26, hc)), kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_26[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_218], mac9) then
          let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
          event partTC(hc[@i_218], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying simplify yields

Game 52 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(mAK_26[@i_346], AK_25[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mAK_26[@i_346]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_346], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(mAK_26[@i_345], AK_25[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let mac5: macs = mac(e5, mAK_26[@i_345]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_345], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_370, =h2)) = dec(m7, AK_25[@i_345]) in
              event fullCT(h, h2, Nt_370, m, e5, m7);
              new ts2_373: timest;
              new r2_374: seed;
              let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_318) in
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mAK_26, n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_326) in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mAK_26, hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_330) in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_26[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_218], mac9) then
          let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
          event partTC(hc[@i_218], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of binder mAK_26 yields

Game 53 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(mAK_26[@i_346], AK_25[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mAK_26[@i_346]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_346], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(mAK_26[@i_345], AK_25[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let mac5: macs = mac(e5, mAK_26[@i_345]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_26[@i_345], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_370, =h2)) = dec(m7, AK_25[@i_345]) in
              event fullCT(h, h2, Nt_370, m, e5, m7);
              new ts2_373: timest;
              new r2_374: seed;
              let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_318) in
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_326) in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_26: mkey = mkgen(rmAK_330) in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_26[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
          if check(m9, mAK_26[@i_218], mac9) then
          let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
          event partTC(hc[@i_218], m8, m9);
          find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
            new rSK_98: keyseed;
            let SK_23: key = kgen(rSK_98) in
            new rmSK_99: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_99) in
            new r10_100: seed;
            let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_100) in
            let mac10: macs = mac(e10, Mmkey[j3]) in
            new r11_101: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
            new rSK_102: keyseed;
            let SK_23: key = kgen(rSK_102) in
            new rmSK_103: mkeyseed;
            let mSK_24: mkey = mkgen(rmSK_103) in
            new r10_104: seed;
            let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_104) in
            let x_124: maxmac = cst_maxmac in
            let mac10: macs = mac2(e10, mkgen2(rmKs)) in
            new r11_105: seed;
            let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
            let mac11: macs = mac(e11, mAK_26[@i_218]) in
            event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
            out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying SA rename mAK_26 yields

Game 54 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(mAK_1736[@i_346], AK_25[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mAK_1736[@i_346]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_1736[@i_346], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(mAK_1737[@i_345], AK_25[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let mac5: macs = mac(e5, mAK_1737[@i_345]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_1737[@i_345], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_370, =h2)) = dec(m7, AK_25[@i_345]) in
              event fullCT(h, h2, Nt_370, m, e5, m7);
              new ts2_373: timest;
              new r2_374: seed;
              let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                let mAK_1734: mkey = mkgen(rmAK_318) in
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_1736: mkey = mkgen(rmAK_326) in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = mkgen(rmAK_330) in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_1735[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_1735[@i_218], mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_98: keyseed;
              let SK_23: key = kgen(rSK_98) in
              new rmSK_99: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_99) in
              new r10_100: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_100) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_101: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
              let mac11: macs = mac(e11, mAK_1735[@i_218]) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_102: keyseed;
              let SK_23: key = kgen(rSK_102) in
              new rmSK_103: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_103) in
              new r10_104: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_104) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_105: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
              let mac11: macs = mac(e11, mAK_1735[@i_218]) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_1737[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_1737[@i_218], mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_98: keyseed;
              let SK_23: key = kgen(rSK_98) in
              new rmSK_99: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_99) in
              new r10_100: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_100) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_101: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_101) in
              let mac11: macs = mac(e11, mAK_1737[@i_218]) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_102: keyseed;
              let SK_23: key = kgen(rSK_102) in
              new rmSK_103: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_103) in
              new r10_104: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_104) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_105: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_105) in
              let mac11: macs = mac(e11, mAK_1737[@i_218]) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of useless yields

Game 55 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(mAK_1736[@i_346], AK_25[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mAK_1736[@i_346]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_1736[@i_346], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(mAK_1737[@i_345], AK_25[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let mac5: macs = mac(e5, mAK_1737[@i_345]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_1737[@i_345], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_370, =h2)) = dec(m7, AK_25[@i_345]) in
              event fullCT(h, h2, Nt_370, m, e5, m7);
              new ts2_373: timest;
              new r2_374: seed;
              let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_1736: mkey = mkgen(rmAK_326) in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = mkgen(rmAK_330) in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_1735[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_1735[@i_218], mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              let SK_23: key = kgen(rSK_1738) in
              new rmSK_1739: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1739) in
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1741) in
              let mac11: macs = mac(e11, mAK_1735[@i_218]) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_23: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1743) in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1745) in
              let mac11: macs = mac(e11, mAK_1735[@i_218]) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_1737[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_1737[@i_218], mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1746: keyseed;
              let SK_23: key = kgen(rSK_1746) in
              new rmSK_1747: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1747) in
              new r10_1748: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1748) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1749: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1749) in
              let mac11: macs = mac(e11, mAK_1737[@i_218]) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1750: keyseed;
              let SK_23: key = kgen(rSK_1750) in
              new rmSK_1751: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1751) in
              new r10_1752: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1753: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1753) in
              let mac11: macs = mac(e11, mAK_1737[@i_218]) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying simplify yields

Game 56 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(mAK_1736[@i_346], AK_25[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mAK_1736[@i_346]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_1736[@i_346], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(mAK_1737[@i_345], AK_25[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let mac5: macs = mac(e5, mAK_1737[@i_345]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_1737[@i_345], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_370, =h2)) = dec(m7, AK_25[@i_345]) in
              event fullCT(h, h2, Nt_370, m, e5, m7);
              new ts2_373: timest;
              new r2_374: seed;
              let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_1736: mkey = mkgen(rmAK_326) in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = mkgen(rmAK_330) in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_1735[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_1735[@i_218], mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              let SK_23: key = kgen(rSK_1738) in
              new rmSK_1739: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1739) in
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1741) in
              let mac11: macs = mac(e11, mAK_1735[@i_218]) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_23: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1743) in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1745) in
              let mac11: macs = mac(e11, mAK_1735[@i_218]) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_1737[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_1737[@i_218], mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1746: keyseed;
              let SK_23: key = kgen(rSK_1746) in
              new rmSK_1747: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1747) in
              new r10_1748: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1748) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1749: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1749) in
              let mac11: macs = mac(e11, mAK_1737[@i_218]) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1750: keyseed;
              let SK_23: key = kgen(rSK_1750) in
              new rmSK_1751: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1751) in
              new r10_1752: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1753: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1753) in
              let mac11: macs = mac(e11, mAK_1737[@i_218]) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of binder mAK_1737 yields

Game 57 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(mAK_1736[@i_346], AK_25[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mAK_1736[@i_346]) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mAK_1736[@i_346], mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rmAK_330[@i_345], mAK_1737[@i_345], AK_25[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let mac5: macs = mac(e5, mkgen(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_330[@i_345]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_370, =h2)) = dec(m7, AK_25[@i_345]) in
              event fullCT(h, h2, Nt_370, m, e5, m7);
              new ts2_373: timest;
              new r2_374: seed;
              let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_1736: mkey = mkgen(rmAK_326) in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_1735[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_1735[@i_218], mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              let SK_23: key = kgen(rSK_1738) in
              new rmSK_1739: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1739) in
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1741) in
              let mac11: macs = mac(e11, mAK_1735[@i_218]) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_23: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1743) in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1745) in
              let mac11: macs = mac(e11, mAK_1735[@i_218]) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(rmAK_330[@i_218], mAK_1737[@i_218], AK_25[@i_218], hc[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_330[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1746: keyseed;
              let SK_23: key = kgen(rSK_1746) in
              new rmSK_1747: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1747) in
              new r10_1748: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1748) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1749: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1749) in
              let mac11: macs = mac(e11, mkgen(rmAK_330[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1750: keyseed;
              let SK_23: key = kgen(rSK_1750) in
              new rmSK_1751: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1751) in
              new r10_1752: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1753: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1753) in
              let mac11: macs = mac(e11, mkgen(rmAK_330[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of binder mAK_1736 yields

Game 58 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rmAK_326[@i_346], mAK_1736[@i_346], AK_25[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rmAK_330[@i_345], mAK_1737[@i_345], AK_25[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let mac5: macs = mac(e5, mkgen(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_330[@i_345]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_370, =h2)) = dec(m7, AK_25[@i_345]) in
              event fullCT(h, h2, Nt_370, m, e5, m7);
              new ts2_373: timest;
              new r2_374: seed;
              let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = mkgen(rmAK_322) in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_1736: mkey = cst_mkey in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], mAK_1735[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mAK_1735[@i_218], mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              let SK_23: key = kgen(rSK_1738) in
              new rmSK_1739: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1739) in
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1741) in
              let mac11: macs = mac(e11, mAK_1735[@i_218]) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_23: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1743) in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1745) in
              let mac11: macs = mac(e11, mAK_1735[@i_218]) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(rmAK_330[@i_218], mAK_1737[@i_218], AK_25[@i_218], hc[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_330[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1746: keyseed;
              let SK_23: key = kgen(rSK_1746) in
              new rmSK_1747: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1747) in
              new r10_1748: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1748) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1749: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1749) in
              let mac11: macs = mac(e11, mkgen(rmAK_330[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1750: keyseed;
              let SK_23: key = kgen(rSK_1750) in
              new rmSK_1751: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1751) in
              new r10_1752: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1753: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1753) in
              let mac11: macs = mac(e11, mkgen(rmAK_330[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of binder mAK_1735 yields

Game 59 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rmAK_326[@i_346], mAK_1736[@i_346], AK_25[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rmAK_330[@i_345], mAK_1737[@i_345], AK_25[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let mac5: macs = mac(e5, mkgen(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_330[@i_345]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_370, =h2)) = dec(m7, AK_25[@i_345]) in
              event fullCT(h, h2, Nt_370, m, e5, m7);
              new ts2_373: timest;
              new r2_374: seed;
              let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_1736: mkey = cst_mkey in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(rmAK_322[@i_218], mAK_1735[@i_218], AK_25[@i_218], hc[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              let SK_23: key = kgen(rSK_1738) in
              new rmSK_1739: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1739) in
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_23: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1743) in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(rmAK_330[@i_218], mAK_1737[@i_218], AK_25[@i_218], hc[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_330[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1746: keyseed;
              let SK_23: key = kgen(rSK_1746) in
              new rmSK_1747: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1747) in
              new r10_1748: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1748) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1749: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1749) in
              let mac11: macs = mac(e11, mkgen(rmAK_330[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1750: keyseed;
              let SK_23: key = kgen(rSK_1750) in
              new rmSK_1751: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1751) in
              new r10_1752: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1753: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1753) in
              let mac11: macs = mac(e11, mkgen(rmAK_330[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmAK_330 [Difference of probability N * Pmac(time + time(context for game 59), 2. * N, 2. * N)] yields

Game 60 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rmAK_326[@i_346], mAK_1736[@i_346], AK_25[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rmAK_330[@i_345], mAK_1737[@i_345], AK_25[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let x_1776: maxmac = e5 in
              let mac5: macs = mac2(x_1776, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(x_1774[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = x_1774[@i_1786]) && check2(x_1774[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                if true then
                let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_370, =h2)) = dec(m7, AK_25[@i_345]) in
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_373: timest;
                new r2_374: seed;
                let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
                let mac12: macs = mac(e12, mSK_30) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_30, mac13) then
                if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(x_1775[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = x_1775[@i_1785]) && check2(x_1775[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                if true then
                let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_370, =h2)) = dec(m7, AK_25[@i_345]) in
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_373: timest;
                new r2_374: seed;
                let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
                let mac12: macs = mac(e12, mSK_30) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_30, mac13) then
                if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1782 <= N suchthat defined(x_1776[@i_1782]) && ((@i_345[@i_1782] = @i_345) && ((m7 = x_1776[@i_1782]) && check2(x_1776[@i_1782], mkgen2(rmAK_330[@i_345]), mac7))) then
                if true then
                let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_370, =h2)) = dec(m7, AK_25[@i_345]) in
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_373: timest;
                new r2_374: seed;
                let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
                let mac12: macs = mac(e12, mSK_30) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_30, mac13) then
                if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              else
                if false then
                let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_370, =h2)) = dec(m7, AK_25[@i_345]) in
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_373: timest;
                new r2_374: seed;
                let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
                let mac12: macs = mac(e12, mSK_30) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_30, mac13) then
                if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_1736: mkey = cst_mkey in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(rmAK_322[@i_218], mAK_1735[@i_218], AK_25[@i_218], hc[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              let SK_23: key = kgen(rSK_1738) in
              new rmSK_1739: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1739) in
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_23: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1743) in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(rmAK_330[@i_218], mAK_1737[@i_218], AK_25[@i_218], hc[@i_218], e3[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(x_1774[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = x_1774[@i_1781]) && check2(x_1774[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              if true then
              let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_23: key = kgen(rSK_1746) in
                new rmSK_1747: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1747) in
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1749) in
                let x_1774: maxmac = e11 in
                let mac11: macs = mac2(x_1774, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_23: key = kgen(rSK_1750) in
                new rmSK_1751: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1751) in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1753) in
                let x_1775: maxmac = e11 in
                let mac11: macs = mac2(x_1775, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind @i_1780 <= N suchthat defined(x_1775[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = x_1775[@i_1780]) && check2(x_1775[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              if true then
              let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_23: key = kgen(rSK_1746) in
                new rmSK_1747: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1747) in
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1749) in
                let x_1774: maxmac = e11 in
                let mac11: macs = mac2(x_1774, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_23: key = kgen(rSK_1750) in
                new rmSK_1751: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1751) in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1753) in
                let x_1775: maxmac = e11 in
                let mac11: macs = mac2(x_1775, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind @i_1777 <= N suchthat defined(x_1776[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = x_1776[@i_1777]) && check2(x_1776[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              if true then
              let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_23: key = kgen(rSK_1746) in
                new rmSK_1747: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1747) in
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1749) in
                let x_1774: maxmac = e11 in
                let mac11: macs = mac2(x_1774, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_23: key = kgen(rSK_1750) in
                new rmSK_1751: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1751) in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1753) in
                let x_1775: maxmac = e11 in
                let mac11: macs = mac2(x_1775, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            else
              if false then
              let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_23: key = kgen(rSK_1746) in
                new rmSK_1747: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1747) in
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1749) in
                let x_1774: maxmac = e11 in
                let mac11: macs = mac2(x_1774, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_23: key = kgen(rSK_1750) in
                new rmSK_1751: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1751) in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1753) in
                let x_1775: maxmac = e11 in
                let mac11: macs = mac2(x_1775, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying simplify [Difference of probability N / |nonce| + 0.5 * N * N / |nonce|] yields

Game 61 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rmAK_326[@i_346], AK_25[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rmAK_330[@i_345], AK_25[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let x_1776: maxmac = e5 in
              let mac5: macs = mac2(x_1776, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(h3[@i_1786], n2[@i_1786], mSK_24[@i_1786], SK_23[@i_1786], x_1774[@i_1786], @i_218[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = x_1774[@i_1786]) && check2(x_1774[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                let SK_31: key = SK_23[@i_1786] in
                let mSK_30: mkey = mSK_24[@i_1786] in
                if (Nt_370 = n2[@i_1786]) then
                if (h2 = h3[@i_1786]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_373: timest;
                new r2_374: seed;
                let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
                let mac12: macs = mac(e12, mSK_30) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_30, mac13) then
                if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(h3[@i_1785], n2[@i_1785], mSK_24[@i_1785], SK_23[@i_1785], x_1775[@i_1785], @i_218[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = x_1775[@i_1785]) && check2(x_1775[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                let SK_31: key = SK_23[@i_1785] in
                let mSK_30: mkey = mSK_24[@i_1785] in
                if (Nt_370 = n2[@i_1785]) then
                if (h2 = h3[@i_1785]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_373: timest;
                new r2_374: seed;
                let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
                let mac12: macs = mac(e12, mSK_30) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_30, mac13) then
                if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_330[@i_345]) && ((m7 = x_1776) && check2(x_1776, mkgen2(rmAK_330[@i_345]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_1736: mkey = cst_mkey in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], rmAK_322[@i_218], e3[@i_218], mAK_1735[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              let SK_23: key = kgen(rSK_1738) in
              new rmSK_1739: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1739) in
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_23: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1743) in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], rmAK_330[@i_218], e3[@i_218], mAK_1737[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(x_1774[@i_1781], @i_218[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = x_1774[@i_1781]) && check2(x_1774[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1780 <= N suchthat defined(x_1775[@i_1780], @i_218[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = x_1775[@i_1780]) && check2(x_1775[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1777 <= N suchthat defined(ts_371[@i_1777], x_1776[@i_1777], @i_345[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = x_1776[@i_1777]) && check2(x_1776[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              let ts_22: timest = ts_371[@i_1777] in
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_23: key = kgen(rSK_1746) in
                new rmSK_1747: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1747) in
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1749) in
                let x_1774: maxmac = e11 in
                let mac11: macs = mac2(x_1774, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_23: key = kgen(rSK_1750) in
                new rmSK_1751: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1751) in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1753) in
                let x_1775: maxmac = e11 in
                let mac11: macs = mac2(x_1775, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying move all binders yields

Game 62 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rmAK_326[@i_346], AK_25[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rmAK_330[@i_345], AK_25[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let x_1776: maxmac = e5 in
              let mac5: macs = mac2(x_1776, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(h3[@i_1786], n2[@i_1786], mSK_24[@i_1786], SK_23[@i_1786], x_1774[@i_1786], @i_218[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = x_1774[@i_1786]) && check2(x_1774[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1786]) then
                if (h2 = h3[@i_1786]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_373: timest;
                new r2_374: seed;
                let SK_31: key = SK_23[@i_1786] in
                let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
                let mSK_30: mkey = mSK_24[@i_1786] in
                let mac12: macs = mac(e12, mSK_30) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_30, mac13) then
                if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(h3[@i_1785], n2[@i_1785], mSK_24[@i_1785], SK_23[@i_1785], x_1775[@i_1785], @i_218[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = x_1775[@i_1785]) && check2(x_1775[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1785]) then
                if (h2 = h3[@i_1785]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_373: timest;
                new r2_374: seed;
                let SK_31: key = SK_23[@i_1785] in
                let e12: maxmac = enc(pad(C, ts2_373), SK_31, r2_374) in
                let mSK_30: mkey = mSK_24[@i_1785] in
                let mac12: macs = mac(e12, mSK_30) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_30, mac13) then
                if (injbot(padts(ts2_373)) = dec(m13, SK_31)) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_330[@i_345]) && ((m7 = x_1776) && check2(x_1776, mkgen2(rmAK_330[@i_345]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                let mAK_1736: mkey = cst_mkey in
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], rmAK_322[@i_218], e3[@i_218], mAK_1735[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              let SK_23: key = kgen(rSK_1738) in
              new rmSK_1739: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1739) in
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_23: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1743) in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], rmAK_330[@i_218], e3[@i_218], mAK_1737[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(x_1774[@i_1781], @i_218[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = x_1774[@i_1781]) && check2(x_1774[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1780 <= N suchthat defined(x_1775[@i_1780], @i_218[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = x_1775[@i_1780]) && check2(x_1775[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1777 <= N suchthat defined(ts_371[@i_1777], x_1776[@i_1777], @i_345[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = x_1776[@i_1777]) && check2(x_1776[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_23: key = kgen(rSK_1746) in
                new rmSK_1747: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1747) in
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1749) in
                let x_1774: maxmac = e11 in
                let mac11: macs = mac2(x_1774, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_23: key = kgen(rSK_1750) in
                new rmSK_1751: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1751) in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1753) in
                let x_1775: maxmac = e11 in
                let mac11: macs = mac2(x_1775, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of useless yields

Game 63 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rmAK_326[@i_346], AK_25[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rmAK_330[@i_345], AK_25[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let x_1776: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(e11[@i_1786], x_1774[@i_1786], h3[@i_1786], n2[@i_1786], mSK_24[@i_1786], SK_23[@i_1786], @i_218[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = e11[@i_1786]) && check2(e11[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1786]) then
                if (h2 = h3[@i_1786]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1827: timest;
                new r2_1828: seed;
                let e12: maxmac = enc(pad(C, ts2_1827), SK_23[@i_1786], r2_1828) in
                let mac12: macs = mac(e12, mSK_24[@i_1786]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_1786], mac13) then
                if (injbot(padts(ts2_1827)) = dec(m13, SK_23[@i_1786])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(e11[@i_1785], x_1775[@i_1785], h3[@i_1785], n2[@i_1785], mSK_24[@i_1785], SK_23[@i_1785], @i_218[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = e11[@i_1785]) && check2(e11[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1785]) then
                if (h2 = h3[@i_1785]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1829: timest;
                new r2_1830: seed;
                let e12: maxmac = enc(pad(C, ts2_1829), SK_23[@i_1785], r2_1830) in
                let mac12: macs = mac(e12, mSK_24[@i_1785]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_1785], mac13) then
                if (injbot(padts(ts2_1829)) = dec(m13, SK_23[@i_1785])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_330[@i_345]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_330[@i_345]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(AK_25, mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                new r3_327: seed;
                let e3: maxmac = enc(concat2(AK_25, mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], rmAK_322[@i_218], e3[@i_218], mAK_1735[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              let SK_23: key = kgen(rSK_1738) in
              new rmSK_1739: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1739) in
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_23: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1743) in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], rmAK_330[@i_218], e3[@i_218], mAK_1737[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(e11[@i_1781], x_1774[@i_1781], @i_218[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = e11[@i_1781]) && check2(e11[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1780 <= N suchthat defined(e11[@i_1780], x_1775[@i_1780], @i_218[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = e11[@i_1780]) && check2(e11[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1777 <= N suchthat defined(e5[@i_1777], x_1776[@i_1777], ts_371[@i_1777], @i_345[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = e5[@i_1777]) && check2(e5[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_23: key = kgen(rSK_1746) in
                new rmSK_1747: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1747) in
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1749) in
                let x_1774: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_23: key = kgen(rSK_1750) in
                new rmSK_1751: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1751) in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1753) in
                let x_1775: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


RESULT Proved event inj:fullCT(T, S, N, x, z, y) ==> inj:fullTC(C, S, N, x', z, y) with probability N * N / |nonce| + N / |nonce| + N * Pmac(time + time(context for game 59), 2. * N, 2. * N) + Penc(time + time(context for game 50), N) + Penc(time + time(context for game 43), N) + Penc(time + time(context for game 36), N) + Pmac(time + time(context for game 26), N, N) + Pmac(time + time(context for game 17), N, N) + Pmac(time + time(context for game 8), N, N)
RESULT Proved event fullCT(T, S, N, x, z, y) ==> (fullTC(C, S, N, x', z, y)&&fullKC(C, T, N', x', w)) with probability 0.5 * N * N / |nonce| + N / |nonce| + N * Pmac(time + time(context for game 59), 2. * N, 2. * N) + Penc(time + time(context for game 50), N) + Penc(time + time(context for game 43), N) + Penc(time + time(context for game 36), N) + Pmac(time + time(context for game 26), N, N) + Pmac(time + time(context for game 17), N, N) + Pmac(time + time(context for game 8), N, N)
RESULT Proved event partTC(C, x, y) ==> (partCT(T, x', y)&&fullKC(C, T, N, x, y')) with probability 0.5 * N * N / |nonce| + N / |nonce| + N * Pmac(time + time(context for game 59), 2. * N, 2. * N) + Penc(time + time(context for game 50), N) + Penc(time + time(context for game 43), N) + Penc(time + time(context for game 36), N) + Pmac(time + time(context for game 26), N, N) + Pmac(time + time(context for game 17), N, N) + Pmac(time + time(context for game 8), N, N)

Applying remove assignments of binder AK_25 yields

Game 65 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rmAK_326[@i_346], AK_25[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_25[@i_346], r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_25[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rmAK_330[@i_345], AK_25[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_25[@i_345], r1_372) in
              let x_1776: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(e11[@i_1786], x_1774[@i_1786], h3[@i_1786], n2[@i_1786], mSK_24[@i_1786], SK_23[@i_1786], @i_218[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = e11[@i_1786]) && check2(e11[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1786]) then
                if (h2 = h3[@i_1786]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1827: timest;
                new r2_1828: seed;
                let e12: maxmac = enc(pad(C, ts2_1827), SK_23[@i_1786], r2_1828) in
                let mac12: macs = mac(e12, mSK_24[@i_1786]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_1786], mac13) then
                if (injbot(padts(ts2_1827)) = dec(m13, SK_23[@i_1786])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(e11[@i_1785], x_1775[@i_1785], h3[@i_1785], n2[@i_1785], mSK_24[@i_1785], SK_23[@i_1785], @i_218[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = e11[@i_1785]) && check2(e11[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1785]) then
                if (h2 = h3[@i_1785]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1829: timest;
                new r2_1830: seed;
                let e12: maxmac = enc(pad(C, ts2_1829), SK_23[@i_1785], r2_1830) in
                let mac12: macs = mac(e12, mSK_24[@i_1785]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_1785], mac13) then
                if (injbot(padts(ts2_1829)) = dec(m13, SK_23[@i_1785])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_330[@i_345]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_330[@i_345]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_25: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_317), mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_317), mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_25: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_321), mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_25: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                new r3_327: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_325), mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_25: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], rmAK_322[@i_218], e3[@i_218], mAK_1735[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_25[@i_218]) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              let SK_23: key = kgen(rSK_1738) in
              new rmSK_1739: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1739) in
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_23: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1743) in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(AK_25[@i_218], hc[@i_218], rmAK_330[@i_218], e3[@i_218], mAK_1737[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(e11[@i_1781], x_1774[@i_1781], @i_218[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = e11[@i_1781]) && check2(e11[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1780 <= N suchthat defined(e11[@i_1780], x_1775[@i_1780], @i_218[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = e11[@i_1780]) && check2(e11[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1777 <= N suchthat defined(e5[@i_1777], x_1776[@i_1777], ts_371[@i_1777], @i_345[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = e5[@i_1777]) && check2(e5[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_23: key = kgen(rSK_1746) in
                new rmSK_1747: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1747) in
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1749) in
                let x_1774: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_23: key = kgen(rSK_1750) in
                new rmSK_1751: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1751) in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_25[@i_218], r11_1753) in
                let x_1775: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying SA rename AK_25 yields

Game 66 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rmAK_326[@i_346], AK_2042[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_2042[@i_346], r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_2042[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rmAK_330[@i_345], AK_2043[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_2043[@i_345], r1_372) in
              let x_1776: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(e11[@i_1786], x_1774[@i_1786], h3[@i_1786], n2[@i_1786], mSK_24[@i_1786], SK_23[@i_1786], @i_218[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = e11[@i_1786]) && check2(e11[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1786]) then
                if (h2 = h3[@i_1786]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1827: timest;
                new r2_1828: seed;
                let e12: maxmac = enc(pad(C, ts2_1827), SK_23[@i_1786], r2_1828) in
                let mac12: macs = mac(e12, mSK_24[@i_1786]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_1786], mac13) then
                if (injbot(padts(ts2_1827)) = dec(m13, SK_23[@i_1786])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(e11[@i_1785], x_1775[@i_1785], h3[@i_1785], n2[@i_1785], mSK_24[@i_1785], SK_23[@i_1785], @i_218[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = e11[@i_1785]) && check2(e11[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1785]) then
                if (h2 = h3[@i_1785]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1829: timest;
                new r2_1830: seed;
                let e12: maxmac = enc(pad(C, ts2_1829), SK_23[@i_1785], r2_1830) in
                let mac12: macs = mac(e12, mSK_24[@i_1785]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_1785], mac13) then
                if (injbot(padts(ts2_1829)) = dec(m13, SK_23[@i_1785])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_330[@i_345]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_330[@i_345]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                let AK_2040: key = kgen(rAK_317) in
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_317), mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_317), mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_2041: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_321), mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_2042: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                new r3_327: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_325), mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_2043: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_2041[@i_218], hc[@i_218], rmAK_322[@i_218], e3[@i_218], mAK_1735[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_2041[@i_218]) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              let SK_23: key = kgen(rSK_1738) in
              new rmSK_1739: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1739) in
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_2041[@i_218], r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_23: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1743) in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_2041[@i_218], r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(AK_2043[@i_218], hc[@i_218], rmAK_330[@i_218], e3[@i_218], mAK_1737[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(e11[@i_1781], x_1774[@i_1781], @i_218[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = e11[@i_1781]) && check2(e11[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1780 <= N suchthat defined(e11[@i_1780], x_1775[@i_1780], @i_218[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = e11[@i_1780]) && check2(e11[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1777 <= N suchthat defined(e5[@i_1777], x_1776[@i_1777], ts_371[@i_1777], @i_345[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = e5[@i_1777]) && check2(e5[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_23: key = kgen(rSK_1746) in
                new rmSK_1747: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1747) in
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_2043[@i_218], r11_1749) in
                let x_1774: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_23: key = kgen(rSK_1750) in
                new rmSK_1751: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1751) in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_2043[@i_218], r11_1753) in
                let x_1775: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of useless yields

Game 67 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rmAK_326[@i_346], AK_2042[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_2042[@i_346], r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_2042[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rmAK_330[@i_345], AK_2043[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_2043[@i_345], r1_372) in
              let x_1776: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(e11[@i_1786], x_1774[@i_1786], h3[@i_1786], n2[@i_1786], mSK_24[@i_1786], SK_23[@i_1786], @i_218[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = e11[@i_1786]) && check2(e11[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1786]) then
                if (h2 = h3[@i_1786]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1827: timest;
                new r2_1828: seed;
                let e12: maxmac = enc(pad(C, ts2_1827), SK_23[@i_1786], r2_1828) in
                let mac12: macs = mac(e12, mSK_24[@i_1786]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_1786], mac13) then
                if (injbot(padts(ts2_1827)) = dec(m13, SK_23[@i_1786])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(e11[@i_1785], x_1775[@i_1785], h3[@i_1785], n2[@i_1785], mSK_24[@i_1785], SK_23[@i_1785], @i_218[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = e11[@i_1785]) && check2(e11[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1785]) then
                if (h2 = h3[@i_1785]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1829: timest;
                new r2_1830: seed;
                let e12: maxmac = enc(pad(C, ts2_1829), SK_23[@i_1785], r2_1830) in
                let mac12: macs = mac(e12, mSK_24[@i_1785]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_1785], mac13) then
                if (injbot(padts(ts2_1829)) = dec(m13, SK_23[@i_1785])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_330[@i_345]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_330[@i_345]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_317), mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_317), mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_2041: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_321), mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_2042: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                new r3_327: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_325), mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_2043: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_2041[@i_218], hc[@i_218], rmAK_322[@i_218], e3[@i_218], mAK_1735[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_2041[@i_218]) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              let SK_23: key = kgen(rSK_1738) in
              new rmSK_1739: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1739) in
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_2041[@i_218], r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_23: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1743) in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_2041[@i_218], r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(AK_2043[@i_218], hc[@i_218], rmAK_330[@i_218], e3[@i_218], mAK_1737[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(e11[@i_1781], x_1774[@i_1781], @i_218[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = e11[@i_1781]) && check2(e11[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1780 <= N suchthat defined(e11[@i_1780], x_1775[@i_1780], @i_218[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = e11[@i_1780]) && check2(e11[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1777 <= N suchthat defined(e5[@i_1777], x_1776[@i_1777], ts_371[@i_1777], @i_345[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = e5[@i_1777]) && check2(e5[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_23: key = kgen(rSK_1746) in
                new rmSK_1747: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1747) in
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_2043[@i_218], r11_1749) in
                let x_1774: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_23: key = kgen(rSK_1750) in
                new rmSK_1751: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1751) in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_2043[@i_218], r11_1753) in
                let x_1775: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying simplify yields

Game 68 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rmAK_326[@i_346], AK_2042[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_2042[@i_346], r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_2042[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rmAK_330[@i_345], AK_2043[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), AK_2043[@i_345], r1_372) in
              let x_1776: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(mSK_24[@i_1786], SK_23[@i_1786], h3[@i_1786], n2[@i_1786], e11[@i_1786], @i_218[@i_1786], x_1774[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = e11[@i_1786]) && check2(e11[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1786]) then
                if (h2 = h3[@i_1786]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1827: timest;
                new r2_1828: seed;
                let e12: maxmac = enc(pad(C, ts2_1827), SK_23[@i_1786], r2_1828) in
                let mac12: macs = mac(e12, mSK_24[@i_1786]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_1786], mac13) then
                if (injbot(padts(ts2_1827)) = dec(m13, SK_23[@i_1786])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(mSK_24[@i_1785], SK_23[@i_1785], h3[@i_1785], n2[@i_1785], e11[@i_1785], @i_218[@i_1785], x_1775[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = e11[@i_1785]) && check2(e11[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1785]) then
                if (h2 = h3[@i_1785]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1829: timest;
                new r2_1830: seed;
                let e12: maxmac = enc(pad(C, ts2_1829), SK_23[@i_1785], r2_1830) in
                let mac12: macs = mac(e12, mSK_24[@i_1785]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_1785], mac13) then
                if (injbot(padts(ts2_1829)) = dec(m13, SK_23[@i_1785])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_330[@i_345]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_330[@i_345]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_317), mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_317), mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_2041: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_321), mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_2042: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                new r3_327: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_325), mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_2043: key = kgen(rAK_329) in
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_2041[@i_218], hc[@i_218], rmAK_322[@i_218], e3[@i_218], x_217[@i_218], mAK_1735[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_2041[@i_218]) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              let SK_23: key = kgen(rSK_1738) in
              new rmSK_1739: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1739) in
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_2041[@i_218], r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_23: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1743) in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_2041[@i_218], r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(AK_2043[@i_218], hc[@i_218], rmAK_330[@i_218], e3[@i_218], x_217[@i_218], mAK_1737[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(e11[@i_1781], @i_218[@i_1781], x_1774[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = e11[@i_1781]) && check2(e11[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1780 <= N suchthat defined(e11[@i_1780], @i_218[@i_1780], x_1775[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = e11[@i_1780]) && check2(e11[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1777 <= N suchthat defined(e5[@i_1777], @i_345[@i_1777], x_1776[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = e5[@i_1777]) && check2(e5[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_23: key = kgen(rSK_1746) in
                new rmSK_1747: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1747) in
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_2043[@i_218], r11_1749) in
                let x_1774: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_23: key = kgen(rSK_1750) in
                new rmSK_1751: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1751) in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_2043[@i_218], r11_1753) in
                let x_1775: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of binder AK_2043 yields

Game 69 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rmAK_326[@i_346], AK_2042[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), AK_2042[@i_346], r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, AK_2042[@i_346]) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rAK_329[@i_345], AK_2043[@i_345], rmAK_330[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), kgen(rAK_329[@i_345]), r1_372) in
              let x_1776: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(mSK_24[@i_1786], SK_23[@i_1786], h3[@i_1786], n2[@i_1786], e11[@i_1786], @i_218[@i_1786], x_1774[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = e11[@i_1786]) && check2(e11[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1786]) then
                if (h2 = h3[@i_1786]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1827: timest;
                new r2_1828: seed;
                let e12: maxmac = enc(pad(C, ts2_1827), SK_23[@i_1786], r2_1828) in
                let mac12: macs = mac(e12, mSK_24[@i_1786]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_1786], mac13) then
                if (injbot(padts(ts2_1827)) = dec(m13, SK_23[@i_1786])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(mSK_24[@i_1785], SK_23[@i_1785], h3[@i_1785], n2[@i_1785], e11[@i_1785], @i_218[@i_1785], x_1775[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = e11[@i_1785]) && check2(e11[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1785]) then
                if (h2 = h3[@i_1785]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1829: timest;
                new r2_1830: seed;
                let e12: maxmac = enc(pad(C, ts2_1829), SK_23[@i_1785], r2_1830) in
                let mac12: macs = mac(e12, mSK_24[@i_1785]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_1785], mac13) then
                if (injbot(padts(ts2_1829)) = dec(m13, SK_23[@i_1785])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_330[@i_345]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_330[@i_345]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_317), mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_317), mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_2041: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_321), mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_2042: key = kgen(rAK_325) in
                new rmAK_326: mkeyseed;
                new r3_327: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_325), mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_2043: key = cst_key in
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_2041[@i_218], hc[@i_218], rmAK_322[@i_218], e3[@i_218], x_217[@i_218], mAK_1735[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_2041[@i_218]) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              let SK_23: key = kgen(rSK_1738) in
              new rmSK_1739: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1739) in
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_2041[@i_218], r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_23: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1743) in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_2041[@i_218], r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(rAK_329[@i_218], AK_2043[@i_218], hc[@i_218], rmAK_330[@i_218], e3[@i_218], x_217[@i_218], mAK_1737[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(e11[@i_1781], @i_218[@i_1781], x_1774[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = e11[@i_1781]) && check2(e11[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1780 <= N suchthat defined(e11[@i_1780], @i_218[@i_1780], x_1775[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = e11[@i_1780]) && check2(e11[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1777 <= N suchthat defined(e5[@i_1777], @i_345[@i_1777], x_1776[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = e5[@i_1777]) && check2(e5[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_23: key = kgen(rSK_1746) in
                new rmSK_1747: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1747) in
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), kgen(rAK_329[@i_218]), r11_1749) in
                let x_1774: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_23: key = kgen(rSK_1750) in
                new rmSK_1751: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1751) in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), kgen(rAK_329[@i_218]), r11_1753) in
                let x_1775: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of binder AK_2042 yields

Game 70 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rAK_325[@i_346], AK_2042[@i_346], rmAK_326[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), kgen(rAK_325[@i_346]), r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, kgen(rAK_325[@i_346])) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rAK_329[@i_345], AK_2043[@i_345], rmAK_330[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), kgen(rAK_329[@i_345]), r1_372) in
              let x_1776: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(mSK_24[@i_1786], SK_23[@i_1786], h3[@i_1786], n2[@i_1786], e11[@i_1786], @i_218[@i_1786], x_1774[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = e11[@i_1786]) && check2(e11[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1786]) then
                if (h2 = h3[@i_1786]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1827: timest;
                new r2_1828: seed;
                let e12: maxmac = enc(pad(C, ts2_1827), SK_23[@i_1786], r2_1828) in
                let mac12: macs = mac(e12, mSK_24[@i_1786]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_1786], mac13) then
                if (injbot(padts(ts2_1827)) = dec(m13, SK_23[@i_1786])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(mSK_24[@i_1785], SK_23[@i_1785], h3[@i_1785], n2[@i_1785], e11[@i_1785], @i_218[@i_1785], x_1775[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = e11[@i_1785]) && check2(e11[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1785]) then
                if (h2 = h3[@i_1785]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1829: timest;
                new r2_1830: seed;
                let e12: maxmac = enc(pad(C, ts2_1829), SK_23[@i_1785], r2_1830) in
                let mac12: macs = mac(e12, mSK_24[@i_1785]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_1785], mac13) then
                if (injbot(padts(ts2_1829)) = dec(m13, SK_23[@i_1785])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_330[@i_345]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_330[@i_345]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_317), mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_317), mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_2041: key = kgen(rAK_321) in
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_321), mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_2042: key = cst_key in
                new rmAK_326: mkeyseed;
                new r3_327: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_325), mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_2043: key = cst_key in
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(AK_2041[@i_218], hc[@i_218], rmAK_322[@i_218], e3[@i_218], x_217[@i_218], mAK_1735[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, AK_2041[@i_218]) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              let SK_23: key = kgen(rSK_1738) in
              new rmSK_1739: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1739) in
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_2041[@i_218], r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_23: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1743) in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), AK_2041[@i_218], r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(rAK_329[@i_218], AK_2043[@i_218], hc[@i_218], rmAK_330[@i_218], e3[@i_218], x_217[@i_218], mAK_1737[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(e11[@i_1781], @i_218[@i_1781], x_1774[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = e11[@i_1781]) && check2(e11[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1780 <= N suchthat defined(e11[@i_1780], @i_218[@i_1780], x_1775[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = e11[@i_1780]) && check2(e11[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1777 <= N suchthat defined(e5[@i_1777], @i_345[@i_1777], x_1776[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = e5[@i_1777]) && check2(e5[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_23: key = kgen(rSK_1746) in
                new rmSK_1747: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1747) in
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), kgen(rAK_329[@i_218]), r11_1749) in
                let x_1774: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_23: key = kgen(rSK_1750) in
                new rmSK_1751: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1751) in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), kgen(rAK_329[@i_218]), r11_1753) in
                let x_1775: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of binder AK_2041 yields

Game 71 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rAK_325[@i_346], AK_2042[@i_346], rmAK_326[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), kgen(rAK_325[@i_346]), r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, kgen(rAK_325[@i_346])) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rAK_329[@i_345], AK_2043[@i_345], rmAK_330[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc(pad(C, ts_371), kgen(rAK_329[@i_345]), r1_372) in
              let x_1776: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(mSK_24[@i_1786], SK_23[@i_1786], h3[@i_1786], n2[@i_1786], e11[@i_1786], @i_218[@i_1786], x_1774[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = e11[@i_1786]) && check2(e11[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1786]) then
                if (h2 = h3[@i_1786]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1827: timest;
                new r2_1828: seed;
                let e12: maxmac = enc(pad(C, ts2_1827), SK_23[@i_1786], r2_1828) in
                let mac12: macs = mac(e12, mSK_24[@i_1786]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_1786], mac13) then
                if (injbot(padts(ts2_1827)) = dec(m13, SK_23[@i_1786])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(mSK_24[@i_1785], SK_23[@i_1785], h3[@i_1785], n2[@i_1785], e11[@i_1785], @i_218[@i_1785], x_1775[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = e11[@i_1785]) && check2(e11[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1785]) then
                if (h2 = h3[@i_1785]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1829: timest;
                new r2_1830: seed;
                let e12: maxmac = enc(pad(C, ts2_1829), SK_23[@i_1785], r2_1830) in
                let mac12: macs = mac(e12, mSK_24[@i_1785]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_1785], mac13) then
                if (injbot(padts(ts2_1829)) = dec(m13, SK_23[@i_1785])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_330[@i_345]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_330[@i_345]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_317), mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_317), mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_2041: key = cst_key in
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_321), mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_2042: key = cst_key in
                new rmAK_326: mkeyseed;
                new r3_327: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_325), mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_2043: key = cst_key in
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(rAK_321[@i_218], AK_2041[@i_218], hc[@i_218], rmAK_322[@i_218], e3[@i_218], x_217[@i_218], mAK_1735[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, kgen(rAK_321[@i_218])) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              let SK_23: key = kgen(rSK_1738) in
              new rmSK_1739: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1739) in
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), kgen(rAK_321[@i_218]), r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_23: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1743) in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), kgen(rAK_321[@i_218]), r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(rAK_329[@i_218], AK_2043[@i_218], hc[@i_218], rmAK_330[@i_218], e3[@i_218], x_217[@i_218], mAK_1737[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(e11[@i_1781], @i_218[@i_1781], x_1774[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = e11[@i_1781]) && check2(e11[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1780 <= N suchthat defined(e11[@i_1780], @i_218[@i_1780], x_1775[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = e11[@i_1780]) && check2(e11[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1777 <= N suchthat defined(e5[@i_1777], @i_345[@i_1777], x_1776[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = e5[@i_1777]) && check2(e5[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_23: key = kgen(rSK_1746) in
                new rmSK_1747: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1747) in
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), kgen(rAK_329[@i_218]), r11_1749) in
                let x_1774: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_23: key = kgen(rSK_1750) in
                new rmSK_1751: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1751) in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), kgen(rAK_329[@i_218]), r11_1753) in
                let x_1775: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r11_1753 [Difference of probability N * Penc(time + time(context for game 71), 2. * N)] yields

Game 72 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rAK_325[@i_346], AK_2042[@i_346], rmAK_326[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), kgen(rAK_325[@i_346]), r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, kgen(rAK_325[@i_346])) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rAK_329[@i_345], AK_2043[@i_345], rmAK_330[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new ts_371: timest;
              new r1_372: seed;
              let e5: maxmac = enc2(Z(pad(C, ts_371)), kgen2(rAK_329[@i_345]), r1_372) in
              let x_1776: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(mSK_24[@i_1786], SK_23[@i_1786], h3[@i_1786], n2[@i_1786], e11[@i_1786], @i_218[@i_1786], x_1774[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = e11[@i_1786]) && check2(e11[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1786]) then
                if (h2 = h3[@i_1786]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1827: timest;
                new r2_1828: seed;
                let e12: maxmac = enc(pad(C, ts2_1827), SK_23[@i_1786], r2_1828) in
                let mac12: macs = mac(e12, mSK_24[@i_1786]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_1786], mac13) then
                if (injbot(padts(ts2_1827)) = dec(m13, SK_23[@i_1786])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(mSK_24[@i_1785], SK_23[@i_1785], h3[@i_1785], n2[@i_1785], e11[@i_1785], @i_218[@i_1785], x_1775[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = e11[@i_1785]) && check2(e11[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1785]) then
                if (h2 = h3[@i_1785]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1829: timest;
                new r2_1830: seed;
                let e12: maxmac = enc(pad(C, ts2_1829), SK_23[@i_1785], r2_1830) in
                let mac12: macs = mac(e12, mSK_24[@i_1785]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_1785], mac13) then
                if (injbot(padts(ts2_1829)) = dec(m13, SK_23[@i_1785])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_330[@i_345]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_330[@i_345]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_317), mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_317), mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_2041: key = cst_key in
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_321), mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_2042: key = cst_key in
                new rmAK_326: mkeyseed;
                new r3_327: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_325), mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_2043: key = cst_key in
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(rAK_321[@i_218], AK_2041[@i_218], hc[@i_218], rmAK_322[@i_218], e3[@i_218], x_217[@i_218], mAK_1735[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, kgen(rAK_321[@i_218])) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              let SK_23: key = kgen(rSK_1738) in
              new rmSK_1739: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1739) in
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), kgen(rAK_321[@i_218]), r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_23: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1743) in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), kgen(rAK_321[@i_218]), r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(rAK_329[@i_218], AK_2043[@i_218], hc[@i_218], rmAK_330[@i_218], e3[@i_218], x_217[@i_218], mAK_1737[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(e11[@i_1781], @i_218[@i_1781], x_1774[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = e11[@i_1781]) && check2(e11[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1780 <= N suchthat defined(e11[@i_1780], @i_218[@i_1780], x_1775[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = e11[@i_1780]) && check2(e11[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1777 <= N suchthat defined(e5[@i_1777], @i_345[@i_1777], x_1776[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = e5[@i_1777]) && check2(e5[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_23: key = kgen(rSK_1746) in
                new rmSK_1747: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1747) in
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc2(Z(concat3(SK_23, mSK_24, n2, h3)), kgen2(rAK_329[@i_218]), r11_1749) in
                let x_1774: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_23: key = kgen(rSK_1750) in
                new rmSK_1751: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1751) in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc2(Z(concat3(SK_23, mSK_24, n2, h3)), kgen2(rAK_329[@i_218]), r11_1753) in
                let x_1775: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying simplify yields

Game 73 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rmAK_326[@i_346], rAK_325[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), kgen(rAK_325[@i_346]), r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, kgen(rAK_325[@i_346])) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rmAK_330[@i_345], rAK_329[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new r1_372: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_329[@i_345]), r1_372) in
              let x_1776: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(mSK_24[@i_1786], SK_23[@i_1786], h3[@i_1786], n2[@i_1786], e11[@i_1786], @i_218[@i_1786], x_1774[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = e11[@i_1786]) && check2(e11[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1786]) then
                if (h2 = h3[@i_1786]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1827: timest;
                new r2_1828: seed;
                let e12: maxmac = enc(pad(C, ts2_1827), SK_23[@i_1786], r2_1828) in
                let mac12: macs = mac(e12, mSK_24[@i_1786]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_1786], mac13) then
                if (injbot(padts(ts2_1827)) = dec(m13, SK_23[@i_1786])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(mSK_24[@i_1785], SK_23[@i_1785], h3[@i_1785], n2[@i_1785], e11[@i_1785], @i_218[@i_1785], x_1775[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = e11[@i_1785]) && check2(e11[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1785]) then
                if (h2 = h3[@i_1785]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1829: timest;
                new r2_1830: seed;
                let e12: maxmac = enc(pad(C, ts2_1829), SK_23[@i_1785], r2_1830) in
                let mac12: macs = mac(e12, mSK_24[@i_1785]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_1785], mac13) then
                if (injbot(padts(ts2_1829)) = dec(m13, SK_23[@i_1785])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_330[@i_345]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_330[@i_345]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_317), mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_317), mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                let AK_2041: key = cst_key in
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_321), mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                let AK_2042: key = cst_key in
                new rmAK_326: mkeyseed;
                new r3_327: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_325), mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                let AK_2043: key = cst_key in
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(rAK_321[@i_218], hc[@i_218], rmAK_322[@i_218], e3[@i_218], x_217[@i_218], mAK_1735[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, kgen(rAK_321[@i_218])) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              let SK_23: key = kgen(rSK_1738) in
              new rmSK_1739: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1739) in
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), kgen(rAK_321[@i_218]), r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_23: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1743) in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), kgen(rAK_321[@i_218]), r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(rAK_329[@i_218], hc[@i_218], rmAK_330[@i_218], e3[@i_218], x_217[@i_218], mAK_1737[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(e11[@i_1781], @i_218[@i_1781], x_1774[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = e11[@i_1781]) && check2(e11[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1780 <= N suchthat defined(e11[@i_1780], @i_218[@i_1780], x_1775[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = e11[@i_1780]) && check2(e11[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1777 <= N suchthat defined(e5[@i_1777], @i_345[@i_1777], x_1776[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = e5[@i_1777]) && check2(e5[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_23: key = kgen(rSK_1746) in
                new rmSK_1747: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1747) in
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1749) in
                let x_1774: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_23: key = kgen(rSK_1750) in
                new rmSK_1751: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1751) in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1753) in
                let x_1775: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of useless yields

Game 74 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rmAK_326[@i_346], rAK_325[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), kgen(rAK_325[@i_346]), r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, kgen(rAK_325[@i_346])) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rmAK_330[@i_345], rAK_329[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new r1_372: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_329[@i_345]), r1_372) in
              let x_1776: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(mSK_24[@i_1786], SK_23[@i_1786], h3[@i_1786], n2[@i_1786], e11[@i_1786], @i_218[@i_1786], x_1774[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = e11[@i_1786]) && check2(e11[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1786]) then
                if (h2 = h3[@i_1786]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1827: timest;
                new r2_1828: seed;
                let e12: maxmac = enc(pad(C, ts2_1827), SK_23[@i_1786], r2_1828) in
                let mac12: macs = mac(e12, mSK_24[@i_1786]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_1786], mac13) then
                if (injbot(padts(ts2_1827)) = dec(m13, SK_23[@i_1786])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(mSK_24[@i_1785], SK_23[@i_1785], h3[@i_1785], n2[@i_1785], e11[@i_1785], @i_218[@i_1785], x_1775[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = e11[@i_1785]) && check2(e11[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1785]) then
                if (h2 = h3[@i_1785]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1829: timest;
                new r2_1830: seed;
                let e12: maxmac = enc(pad(C, ts2_1829), SK_23[@i_1785], r2_1830) in
                let mac12: macs = mac(e12, mSK_24[@i_1785]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_1785], mac13) then
                if (injbot(padts(ts2_1829)) = dec(m13, SK_23[@i_1785])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_330[@i_345]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_330[@i_345]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_317), mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_317), mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_321), mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                new rmAK_326: mkeyseed;
                new r3_327: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_325), mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(rAK_321[@i_218], hc[@i_218], rmAK_322[@i_218], e3[@i_218], x_217[@i_218], mAK_1735[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, kgen(rAK_321[@i_218])) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              let SK_23: key = kgen(rSK_1738) in
              new rmSK_1739: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1739) in
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), kgen(rAK_321[@i_218]), r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_23: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1743) in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(SK_23, mSK_24, n2, h3), kgen(rAK_321[@i_218]), r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(rAK_329[@i_218], hc[@i_218], rmAK_330[@i_218], e3[@i_218], x_217[@i_218], mAK_1737[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(e11[@i_1781], @i_218[@i_1781], x_1774[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = e11[@i_1781]) && check2(e11[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1780 <= N suchthat defined(e11[@i_1780], @i_218[@i_1780], x_1775[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = e11[@i_1780]) && check2(e11[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1777 <= N suchthat defined(e5[@i_1777], @i_345[@i_1777], x_1776[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = e5[@i_1777]) && check2(e5[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_23: key = kgen(rSK_1746) in
                new rmSK_1747: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1747) in
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(SK_23, mSK_24, hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1749) in
                let x_1774: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_23: key = kgen(rSK_1750) in
                new rmSK_1751: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1751) in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1753) in
                let x_1775: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of binder mSK_24 yields

Game 75 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rmAK_326[@i_346], rAK_325[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), kgen(rAK_325[@i_346]), r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, kgen(rAK_325[@i_346])) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rmAK_330[@i_345], rAK_329[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new r1_372: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_329[@i_345]), r1_372) in
              let x_1776: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(mSK_24[@i_1786], SK_23[@i_1786], h3[@i_1786], n2[@i_1786], e11[@i_1786], @i_218[@i_1786], x_1774[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = e11[@i_1786]) && check2(e11[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1786]) then
                if (h2 = h3[@i_1786]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1827: timest;
                new r2_1828: seed;
                let e12: maxmac = enc(pad(C, ts2_1827), SK_23[@i_1786], r2_1828) in
                let mac12: macs = mac(e12, mSK_24[@i_1786]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_1786], mac13) then
                if (injbot(padts(ts2_1827)) = dec(m13, SK_23[@i_1786])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(mSK_24[@i_1785], SK_23[@i_1785], h3[@i_1785], n2[@i_1785], e11[@i_1785], @i_218[@i_1785], x_1775[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = e11[@i_1785]) && check2(e11[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1785]) then
                if (h2 = h3[@i_1785]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1829: timest;
                new r2_1830: seed;
                let e12: maxmac = enc(pad(C, ts2_1829), SK_23[@i_1785], r2_1830) in
                let mac12: macs = mac(e12, mSK_24[@i_1785]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_24[@i_1785], mac13) then
                if (injbot(padts(ts2_1829)) = dec(m13, SK_23[@i_1785])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_330[@i_345]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_330[@i_345]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_317), mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_317), mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_321), mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                new rmAK_326: mkeyseed;
                new r3_327: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_325), mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(rAK_321[@i_218], hc[@i_218], rmAK_322[@i_218], e3[@i_218], x_217[@i_218], mAK_1735[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, kgen(rAK_321[@i_218])) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              let SK_23: key = kgen(rSK_1738) in
              new rmSK_1739: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1739) in
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_1739), hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_1739), n2, h3), kgen(rAK_321[@i_218]), r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_23: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_24: mkey = mkgen(rmSK_1743) in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_1743), n2, h3), kgen(rAK_321[@i_218]), r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(rAK_329[@i_218], hc[@i_218], rmAK_330[@i_218], e3[@i_218], x_217[@i_218], mAK_1737[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(e11[@i_1781], @i_218[@i_1781], x_1774[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = e11[@i_1781]) && check2(e11[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1780 <= N suchthat defined(e11[@i_1780], @i_218[@i_1780], x_1775[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = e11[@i_1780]) && check2(e11[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1777 <= N suchthat defined(e5[@i_1777], @i_345[@i_1777], x_1776[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = e5[@i_1777]) && check2(e5[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_23: key = kgen(rSK_1746) in
                new rmSK_1747: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1747) in
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_1747), hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1749) in
                let x_1774: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_23: key = kgen(rSK_1750) in
                new rmSK_1751: mkeyseed;
                let mSK_24: mkey = mkgen(rmSK_1751) in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1753) in
                let x_1775: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_24[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
        if check(m15, mSK_24[@i_125], mac15) then
        let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
        new r16: seed;
        let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
        let mac16: macs = mac(e16, mSK_24[@i_125]) in
        event partSC(hc[@i_218[@i_125]], m14, m15);
        event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
        out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying SA rename mSK_24 yields

Game 76 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rmAK_326[@i_346], rAK_325[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), kgen(rAK_325[@i_346]), r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, kgen(rAK_325[@i_346])) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rmAK_330[@i_345], rAK_329[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new r1_372: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_329[@i_345]), r1_372) in
              let x_1776: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(mSK_2149[@i_1786], SK_23[@i_1786], h3[@i_1786], n2[@i_1786], e11[@i_1786], @i_218[@i_1786], x_1774[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = e11[@i_1786]) && check2(e11[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1786]) then
                if (h2 = h3[@i_1786]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1827: timest;
                new r2_1828: seed;
                let e12: maxmac = enc(pad(C, ts2_1827), SK_23[@i_1786], r2_1828) in
                let mac12: macs = mac(e12, mSK_2149[@i_1786]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_2149[@i_1786], mac13) then
                if (injbot(padts(ts2_1827)) = dec(m13, SK_23[@i_1786])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(mSK_2150[@i_1785], SK_23[@i_1785], h3[@i_1785], n2[@i_1785], e11[@i_1785], @i_218[@i_1785], x_1775[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = e11[@i_1785]) && check2(e11[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1785]) then
                if (h2 = h3[@i_1785]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1829: timest;
                new r2_1830: seed;
                let e12: maxmac = enc(pad(C, ts2_1829), SK_23[@i_1785], r2_1830) in
                let mac12: macs = mac(e12, mSK_2150[@i_1785]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_2150[@i_1785], mac13) then
                if (injbot(padts(ts2_1829)) = dec(m13, SK_23[@i_1785])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_330[@i_345]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_330[@i_345]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_317), mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_317), mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_321), mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                new rmAK_326: mkeyseed;
                new r3_327: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_325), mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(rAK_321[@i_218], hc[@i_218], rmAK_322[@i_218], e3[@i_218], x_217[@i_218], mAK_1735[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, kgen(rAK_321[@i_218])) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              let SK_23: key = kgen(rSK_1738) in
              new rmSK_1739: mkeyseed;
              let mSK_2147: mkey = mkgen(rmSK_1739) in
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_1739), hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_1739), n2, h3), kgen(rAK_321[@i_218]), r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_23: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_2148: mkey = mkgen(rmSK_1743) in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_1743), n2, h3), kgen(rAK_321[@i_218]), r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(rAK_329[@i_218], hc[@i_218], rmAK_330[@i_218], e3[@i_218], x_217[@i_218], mAK_1737[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(e11[@i_1781], @i_218[@i_1781], x_1774[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = e11[@i_1781]) && check2(e11[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1780 <= N suchthat defined(e11[@i_1780], @i_218[@i_1780], x_1775[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = e11[@i_1780]) && check2(e11[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1777 <= N suchthat defined(e5[@i_1777], @i_345[@i_1777], x_1776[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = e5[@i_1777]) && check2(e5[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_23: key = kgen(rSK_1746) in
                new rmSK_1747: mkeyseed;
                let mSK_2149: mkey = mkgen(rmSK_1747) in
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_1747), hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1749) in
                let x_1774: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_23: key = kgen(rSK_1750) in
                new rmSK_1751: mkeyseed;
                let mSK_2150: mkey = mkgen(rmSK_1751) in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1753) in
                let x_1775: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_2148[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          if check(m15, mSK_2148[@i_125], mac15) then
          let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
          new r16: seed;
          let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
          let mac16: macs = mac(e16, mSK_2148[@i_125]) in
          event partSC(hc[@i_218[@i_125]], m14, m15);
          event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
        orfind @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_2150[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          if check(m15, mSK_2150[@i_125], mac15) then
          let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
          new r16: seed;
          let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16) in
          let mac16: macs = mac(e16, mSK_2150[@i_125]) in
          event partSC(hc[@i_218[@i_125]], m14, m15);
          event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of useless yields

Game 77 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rmAK_326[@i_346], rAK_325[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), kgen(rAK_325[@i_346]), r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, kgen(rAK_325[@i_346])) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rmAK_330[@i_345], rAK_329[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new r1_372: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_329[@i_345]), r1_372) in
              let x_1776: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(mSK_2149[@i_1786], SK_23[@i_1786], h3[@i_1786], n2[@i_1786], e11[@i_1786], @i_218[@i_1786], x_1774[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = e11[@i_1786]) && check2(e11[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1786]) then
                if (h2 = h3[@i_1786]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1827: timest;
                new r2_1828: seed;
                let e12: maxmac = enc(pad(C, ts2_1827), SK_23[@i_1786], r2_1828) in
                let mac12: macs = mac(e12, mSK_2149[@i_1786]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_2149[@i_1786], mac13) then
                if (injbot(padts(ts2_1827)) = dec(m13, SK_23[@i_1786])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(mSK_2150[@i_1785], SK_23[@i_1785], h3[@i_1785], n2[@i_1785], e11[@i_1785], @i_218[@i_1785], x_1775[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = e11[@i_1785]) && check2(e11[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1785]) then
                if (h2 = h3[@i_1785]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1829: timest;
                new r2_1830: seed;
                let e12: maxmac = enc(pad(C, ts2_1829), SK_23[@i_1785], r2_1830) in
                let mac12: macs = mac(e12, mSK_2150[@i_1785]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_2150[@i_1785], mac13) then
                if (injbot(padts(ts2_1829)) = dec(m13, SK_23[@i_1785])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_330[@i_345]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_330[@i_345]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_317), mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_317), mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_321), mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                new rmAK_326: mkeyseed;
                new r3_327: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_325), mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(rAK_321[@i_218], hc[@i_218], rmAK_322[@i_218], e3[@i_218], x_217[@i_218], mAK_1735[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, kgen(rAK_321[@i_218])) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              let SK_23: key = kgen(rSK_1738) in
              new rmSK_1739: mkeyseed;
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_1739), hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_1739), n2, h3), kgen(rAK_321[@i_218]), r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_23: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_2148: mkey = mkgen(rmSK_1743) in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_1743), n2, h3), kgen(rAK_321[@i_218]), r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(rAK_329[@i_218], hc[@i_218], rmAK_330[@i_218], e3[@i_218], x_217[@i_218], mAK_1737[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(e11[@i_1781], @i_218[@i_1781], x_1774[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = e11[@i_1781]) && check2(e11[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1780 <= N suchthat defined(e11[@i_1780], @i_218[@i_1780], x_1775[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = e11[@i_1780]) && check2(e11[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1777 <= N suchthat defined(e5[@i_1777], @i_345[@i_1777], x_1776[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = e5[@i_1777]) && check2(e5[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_23: key = kgen(rSK_1746) in
                new rmSK_1747: mkeyseed;
                let mSK_2149: mkey = mkgen(rmSK_1747) in
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_1747), hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1749) in
                let x_1774: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_23: key = kgen(rSK_1750) in
                new rmSK_1751: mkeyseed;
                let mSK_2150: mkey = mkgen(rmSK_1751) in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1753) in
                let x_1775: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_2148[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          if check(m15, mSK_2148[@i_125], mac15) then
          let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
          new r16_2151: seed;
          let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16_2151) in
          let mac16: macs = mac(e16, mSK_2148[@i_125]) in
          event partSC(hc[@i_218[@i_125]], m14, m15);
          event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
        orfind @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_2150[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          if check(m15, mSK_2150[@i_125], mac15) then
          let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
          new r16_2152: seed;
          let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16_2152) in
          let mac16: macs = mac(e16, mSK_2150[@i_125]) in
          event partSC(hc[@i_218[@i_125]], m14, m15);
          event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying simplify yields

Game 78 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rmAK_326[@i_346], rAK_325[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), kgen(rAK_325[@i_346]), r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, kgen(rAK_325[@i_346])) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rmAK_330[@i_345], rAK_329[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new r1_372: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_329[@i_345]), r1_372) in
              let x_1776: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(mSK_2149[@i_1786], SK_23[@i_1786], h3[@i_1786], n2[@i_1786], e11[@i_1786], @i_218[@i_1786], x_1774[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = e11[@i_1786]) && check2(e11[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1786]) then
                if (h2 = h3[@i_1786]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1827: timest;
                new r2_1828: seed;
                let e12: maxmac = enc(pad(C, ts2_1827), SK_23[@i_1786], r2_1828) in
                let mac12: macs = mac(e12, mSK_2149[@i_1786]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_2149[@i_1786], mac13) then
                if (injbot(padts(ts2_1827)) = dec(m13, SK_23[@i_1786])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(mSK_2150[@i_1785], SK_23[@i_1785], h3[@i_1785], n2[@i_1785], e11[@i_1785], @i_218[@i_1785], x_1775[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = e11[@i_1785]) && check2(e11[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1785]) then
                if (h2 = h3[@i_1785]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1829: timest;
                new r2_1830: seed;
                let e12: maxmac = enc(pad(C, ts2_1829), SK_23[@i_1785], r2_1830) in
                let mac12: macs = mac(e12, mSK_2150[@i_1785]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_2150[@i_1785], mac13) then
                if (injbot(padts(ts2_1829)) = dec(m13, SK_23[@i_1785])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_330[@i_345]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_330[@i_345]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_317), mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_317), mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_321), mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                new rmAK_326: mkeyseed;
                new r3_327: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_325), mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(rAK_321[@i_218], hc[@i_218], rmAK_322[@i_218], e3[@i_218], mAK_1735[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, kgen(rAK_321[@i_218])) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              let SK_23: key = kgen(rSK_1738) in
              new rmSK_1739: mkeyseed;
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_1739), hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_1739), n2, h3), kgen(rAK_321[@i_218]), r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_23: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_2148: mkey = mkgen(rmSK_1743) in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_1743), n2, h3), kgen(rAK_321[@i_218]), r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(rAK_329[@i_218], hc[@i_218], rmAK_330[@i_218], e3[@i_218], mAK_1737[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(e11[@i_1781], @i_218[@i_1781], x_1774[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = e11[@i_1781]) && check2(e11[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1780 <= N suchthat defined(e11[@i_1780], @i_218[@i_1780], x_1775[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = e11[@i_1780]) && check2(e11[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1777 <= N suchthat defined(e5[@i_1777], @i_345[@i_1777], x_1776[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = e5[@i_1777]) && check2(e5[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_23: key = kgen(rSK_1746) in
                new rmSK_1747: mkeyseed;
                let mSK_2149: mkey = mkgen(rmSK_1747) in
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_1747), hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1749) in
                let x_1774: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_23: key = kgen(rSK_1750) in
                new rmSK_1751: mkeyseed;
                let mSK_2150: mkey = mkgen(rmSK_1751) in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1753) in
                let x_1775: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_2148[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          if check(m15, mSK_2148[@i_125], mac15) then
          let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
          new r16_2151: seed;
          let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16_2151) in
          let mac16: macs = mac(e16, mSK_2148[@i_125]) in
          event partSC(hc[@i_218[@i_125]], m14, m15);
          event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
        orfind @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_2150[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          if check(m15, mSK_2150[@i_125], mac15) then
          let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
          new r16_2152: seed;
          let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16_2152) in
          let mac16: macs = mac(e16, mSK_2150[@i_125]) in
          event partSC(hc[@i_218[@i_125]], m14, m15);
          event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of binder mSK_2150 yields

Game 79 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rmAK_326[@i_346], rAK_325[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), kgen(rAK_325[@i_346]), r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, kgen(rAK_325[@i_346])) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rmAK_330[@i_345], rAK_329[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new r1_372: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_329[@i_345]), r1_372) in
              let x_1776: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(mSK_2149[@i_1786], SK_23[@i_1786], h3[@i_1786], n2[@i_1786], e11[@i_1786], @i_218[@i_1786], x_1774[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = e11[@i_1786]) && check2(e11[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1786]) then
                if (h2 = h3[@i_1786]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1827: timest;
                new r2_1828: seed;
                let e12: maxmac = enc(pad(C, ts2_1827), SK_23[@i_1786], r2_1828) in
                let mac12: macs = mac(e12, mSK_2149[@i_1786]) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mSK_2149[@i_1786], mac13) then
                if (injbot(padts(ts2_1827)) = dec(m13, SK_23[@i_1786])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(rmSK_1751[@i_1785], mSK_2150[@i_1785], SK_23[@i_1785], h3[@i_1785], n2[@i_1785], e11[@i_1785], @i_218[@i_1785], x_1775[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = e11[@i_1785]) && check2(e11[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1785]) then
                if (h2 = h3[@i_1785]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1829: timest;
                new r2_1830: seed;
                let e12: maxmac = enc(pad(C, ts2_1829), SK_23[@i_1785], r2_1830) in
                let mac12: macs = mac(e12, mkgen(rmSK_1751[@i_1785])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mkgen(rmSK_1751[@i_1785]), mac13) then
                if (injbot(padts(ts2_1829)) = dec(m13, SK_23[@i_1785])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_330[@i_345]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_330[@i_345]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_317), mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_317), mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_321), mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                new rmAK_326: mkeyseed;
                new r3_327: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_325), mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(rAK_321[@i_218], hc[@i_218], rmAK_322[@i_218], e3[@i_218], mAK_1735[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, kgen(rAK_321[@i_218])) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              let SK_23: key = kgen(rSK_1738) in
              new rmSK_1739: mkeyseed;
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_1739), hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_1739), n2, h3), kgen(rAK_321[@i_218]), r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_23: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_2148: mkey = mkgen(rmSK_1743) in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_1743), n2, h3), kgen(rAK_321[@i_218]), r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(rAK_329[@i_218], hc[@i_218], rmAK_330[@i_218], e3[@i_218], mAK_1737[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(e11[@i_1781], @i_218[@i_1781], x_1774[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = e11[@i_1781]) && check2(e11[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1780 <= N suchthat defined(e11[@i_1780], @i_218[@i_1780], x_1775[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = e11[@i_1780]) && check2(e11[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1777 <= N suchthat defined(e5[@i_1777], @i_345[@i_1777], x_1776[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = e5[@i_1777]) && check2(e5[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_23: key = kgen(rSK_1746) in
                new rmSK_1747: mkeyseed;
                let mSK_2149: mkey = mkgen(rmSK_1747) in
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_1747), hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1749) in
                let x_1774: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_23: key = kgen(rSK_1750) in
                new rmSK_1751: mkeyseed;
                let mSK_2150: mkey = cst_mkey in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1753) in
                let x_1775: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_2148[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          if check(m15, mSK_2148[@i_125], mac15) then
          let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
          new r16_2151: seed;
          let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16_2151) in
          let mac16: macs = mac(e16, mSK_2148[@i_125]) in
          event partSC(hc[@i_218[@i_125]], m14, m15);
          event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
        orfind @i_125 <= N suchthat defined(rmSK_1751[@i_125], mSK_2150[@i_125], SK_23[@i_125], hc[@i_218[@i_125]], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          if check(m15, mkgen(rmSK_1751[@i_125]), mac15) then
          let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
          new r16_2152: seed;
          let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16_2152) in
          let mac16: macs = mac(e16, mkgen(rmSK_1751[@i_125])) in
          event partSC(hc[@i_218[@i_125]], m14, m15);
          event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of binder mSK_2149 yields

Game 80 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rmAK_326[@i_346], rAK_325[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), kgen(rAK_325[@i_346]), r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, kgen(rAK_325[@i_346])) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rmAK_330[@i_345], rAK_329[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new r1_372: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_329[@i_345]), r1_372) in
              let x_1776: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(rmSK_1747[@i_1786], mSK_2149[@i_1786], SK_23[@i_1786], h3[@i_1786], n2[@i_1786], e11[@i_1786], @i_218[@i_1786], x_1774[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = e11[@i_1786]) && check2(e11[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1786]) then
                if (h2 = h3[@i_1786]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1827: timest;
                new r2_1828: seed;
                let e12: maxmac = enc(pad(C, ts2_1827), SK_23[@i_1786], r2_1828) in
                let mac12: macs = mac(e12, mkgen(rmSK_1747[@i_1786])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mkgen(rmSK_1747[@i_1786]), mac13) then
                if (injbot(padts(ts2_1827)) = dec(m13, SK_23[@i_1786])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(rmSK_1751[@i_1785], mSK_2150[@i_1785], SK_23[@i_1785], h3[@i_1785], n2[@i_1785], e11[@i_1785], @i_218[@i_1785], x_1775[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = e11[@i_1785]) && check2(e11[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1785]) then
                if (h2 = h3[@i_1785]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1829: timest;
                new r2_1830: seed;
                let e12: maxmac = enc(pad(C, ts2_1829), SK_23[@i_1785], r2_1830) in
                let mac12: macs = mac(e12, mkgen(rmSK_1751[@i_1785])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mkgen(rmSK_1751[@i_1785]), mac13) then
                if (injbot(padts(ts2_1829)) = dec(m13, SK_23[@i_1785])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_330[@i_345]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_330[@i_345]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_317), mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_317), mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_321), mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                new rmAK_326: mkeyseed;
                new r3_327: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_325), mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(rAK_321[@i_218], hc[@i_218], rmAK_322[@i_218], e3[@i_218], mAK_1735[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, kgen(rAK_321[@i_218])) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              let SK_23: key = kgen(rSK_1738) in
              new rmSK_1739: mkeyseed;
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_1739), hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_1739), n2, h3), kgen(rAK_321[@i_218]), r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_23: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_2148: mkey = mkgen(rmSK_1743) in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_1743), n2, h3), kgen(rAK_321[@i_218]), r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(rAK_329[@i_218], hc[@i_218], rmAK_330[@i_218], e3[@i_218], mAK_1737[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(e11[@i_1781], @i_218[@i_1781], x_1774[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = e11[@i_1781]) && check2(e11[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1780 <= N suchthat defined(e11[@i_1780], @i_218[@i_1780], x_1775[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = e11[@i_1780]) && check2(e11[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1777 <= N suchthat defined(e5[@i_1777], @i_345[@i_1777], x_1776[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = e5[@i_1777]) && check2(e5[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_23: key = kgen(rSK_1746) in
                new rmSK_1747: mkeyseed;
                let mSK_2149: mkey = cst_mkey in
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_1747), hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1749) in
                let x_1774: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_23: key = kgen(rSK_1750) in
                new rmSK_1751: mkeyseed;
                let mSK_2150: mkey = cst_mkey in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1753) in
                let x_1775: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], mSK_2148[@i_125], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          if check(m15, mSK_2148[@i_125], mac15) then
          let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
          new r16_2151: seed;
          let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16_2151) in
          let mac16: macs = mac(e16, mSK_2148[@i_125]) in
          event partSC(hc[@i_218[@i_125]], m14, m15);
          event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
        orfind @i_125 <= N suchthat defined(rmSK_1751[@i_125], mSK_2150[@i_125], SK_23[@i_125], hc[@i_218[@i_125]], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          if check(m15, mkgen(rmSK_1751[@i_125]), mac15) then
          let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
          new r16_2152: seed;
          let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16_2152) in
          let mac16: macs = mac(e16, mkgen(rmSK_1751[@i_125])) in
          event partSC(hc[@i_218[@i_125]], m14, m15);
          event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of binder mSK_2148 yields

Game 81 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rmAK_326[@i_346], rAK_325[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), kgen(rAK_325[@i_346]), r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, kgen(rAK_325[@i_346])) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rmAK_330[@i_345], rAK_329[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new r1_372: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_329[@i_345]), r1_372) in
              let x_1776: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(rmSK_1747[@i_1786], mSK_2149[@i_1786], SK_23[@i_1786], h3[@i_1786], n2[@i_1786], e11[@i_1786], @i_218[@i_1786], x_1774[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = e11[@i_1786]) && check2(e11[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1786]) then
                if (h2 = h3[@i_1786]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1827: timest;
                new r2_1828: seed;
                let e12: maxmac = enc(pad(C, ts2_1827), SK_23[@i_1786], r2_1828) in
                let mac12: macs = mac(e12, mkgen(rmSK_1747[@i_1786])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mkgen(rmSK_1747[@i_1786]), mac13) then
                if (injbot(padts(ts2_1827)) = dec(m13, SK_23[@i_1786])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(rmSK_1751[@i_1785], mSK_2150[@i_1785], SK_23[@i_1785], h3[@i_1785], n2[@i_1785], e11[@i_1785], @i_218[@i_1785], x_1775[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = e11[@i_1785]) && check2(e11[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1785]) then
                if (h2 = h3[@i_1785]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1829: timest;
                new r2_1830: seed;
                let e12: maxmac = enc(pad(C, ts2_1829), SK_23[@i_1785], r2_1830) in
                let mac12: macs = mac(e12, mkgen(rmSK_1751[@i_1785])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mkgen(rmSK_1751[@i_1785]), mac13) then
                if (injbot(padts(ts2_1829)) = dec(m13, SK_23[@i_1785])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_330[@i_345]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_330[@i_345]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_317), mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_317), mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_321), mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                new rmAK_326: mkeyseed;
                new r3_327: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_325), mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(rAK_321[@i_218], hc[@i_218], rmAK_322[@i_218], e3[@i_218], mAK_1735[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, kgen(rAK_321[@i_218])) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              let SK_23: key = kgen(rSK_1738) in
              new rmSK_1739: mkeyseed;
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_1739), hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_1739), n2, h3), kgen(rAK_321[@i_218]), r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_23: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_2148: mkey = cst_mkey in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_1743), n2, h3), kgen(rAK_321[@i_218]), r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(rAK_329[@i_218], hc[@i_218], rmAK_330[@i_218], e3[@i_218], mAK_1737[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(e11[@i_1781], @i_218[@i_1781], x_1774[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = e11[@i_1781]) && check2(e11[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1780 <= N suchthat defined(e11[@i_1780], @i_218[@i_1780], x_1775[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = e11[@i_1780]) && check2(e11[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1777 <= N suchthat defined(e5[@i_1777], @i_345[@i_1777], x_1776[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = e5[@i_1777]) && check2(e5[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_23: key = kgen(rSK_1746) in
                new rmSK_1747: mkeyseed;
                let mSK_2149: mkey = cst_mkey in
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_1747), hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1749) in
                let x_1774: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_23: key = kgen(rSK_1750) in
                new rmSK_1751: mkeyseed;
                let mSK_2150: mkey = cst_mkey in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1753) in
                let x_1775: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(rmSK_1743[@i_125], mSK_2148[@i_125], SK_23[@i_125], hc[@i_218[@i_125]], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          if check(m15, mkgen(rmSK_1743[@i_125]), mac15) then
          let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
          new r16_2151: seed;
          let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16_2151) in
          let mac16: macs = mac(e16, mkgen(rmSK_1743[@i_125])) in
          event partSC(hc[@i_218[@i_125]], m14, m15);
          event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
        orfind @i_125 <= N suchthat defined(rmSK_1751[@i_125], mSK_2150[@i_125], SK_23[@i_125], hc[@i_218[@i_125]], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          if check(m15, mkgen(rmSK_1751[@i_125]), mac15) then
          let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
          new r16_2152: seed;
          let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16_2152) in
          let mac16: macs = mac(e16, mkgen(rmSK_1751[@i_125])) in
          event partSC(hc[@i_218[@i_125]], m14, m15);
          event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying equivalence
equiv ! !_5 <= N3 new r: mkeyseed; (
  ! !_6 <= N (x: maxmac) -> mac(x, mkgen(r)),
  ! !_7 <= N2 (m: maxmac, ma: macs) -> check(m, mkgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_8 <= N3 new r: mkeyseed; (
  ! !_9 <= N (x_47: maxmac) -> let x: maxmac = x_47 in mac2(x, mkgen2(r)),
  ! !_10 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && check2(x[j], mkgen2(r), ma)) then true else false)
with rmSK_1751 [Difference of probability N * Pmac(time + time(context for game 81), 2. * N, 2. * N)] yields

Game 82 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rmAK_326[@i_346], rAK_325[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), kgen(rAK_325[@i_346]), r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, kgen(rAK_325[@i_346])) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rmAK_330[@i_345], rAK_329[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new r1_372: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_329[@i_345]), r1_372) in
              let x_1776: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(rmSK_1747[@i_1786], mSK_2149[@i_1786], SK_23[@i_1786], h3[@i_1786], n2[@i_1786], e11[@i_1786], @i_218[@i_1786], x_1774[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = e11[@i_1786]) && check2(e11[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1786]) then
                if (h2 = h3[@i_1786]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1827: timest;
                new r2_1828: seed;
                let e12: maxmac = enc(pad(C, ts2_1827), SK_23[@i_1786], r2_1828) in
                let mac12: macs = mac(e12, mkgen(rmSK_1747[@i_1786])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mkgen(rmSK_1747[@i_1786]), mac13) then
                if (injbot(padts(ts2_1827)) = dec(m13, SK_23[@i_1786])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(rmSK_1751[@i_1785], mSK_2150[@i_1785], SK_23[@i_1785], h3[@i_1785], n2[@i_1785], e11[@i_1785], @i_218[@i_1785], x_1775[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = e11[@i_1785]) && check2(e11[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1785]) then
                if (h2 = h3[@i_1785]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1829: timest;
                new r2_1830: seed;
                let e12: maxmac = enc(pad(C, ts2_1829), SK_23[@i_1785], r2_1830) in
                let x_2181: maxmac = e12 in
                let mac12: macs = mac2(x_2181, mkgen2(rmSK_1751[@i_1785])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                find @i_2189 <= N suchthat defined(x_2180[@i_2189]) && ((@i_125[@i_2189] = @i_1785) && ((m13 = x_2180[@i_2189]) && check2(x_2180[@i_2189], mkgen2(rmSK_1751[@i_1785]), mac13))) then
                  if true then
                  if (injbot(padts(ts2_1829)) = dec(m13, SK_23[@i_1785])) then
                  event fullCS(h2, h, m7, e12, m13);
                  out(c10[!_11], acceptC(h, h2))
                orfind @i_2186 <= N suchthat defined(x_2181[@i_2186]) && ((@i_1785[@i_2186] = @i_1785) && ((m13 = x_2181[@i_2186]) && check2(x_2181[@i_2186], mkgen2(rmSK_1751[@i_1785]), mac13))) then
                  if true then
                  if (injbot(padts(ts2_1829)) = dec(m13, SK_23[@i_1785])) then
                  event fullCS(h2, h, m7, e12, m13);
                  out(c10[!_11], acceptC(h, h2))
                else
                  if false then
                  if (injbot(padts(ts2_1829)) = dec(m13, SK_23[@i_1785])) then
                  event fullCS(h2, h, m7, e12, m13);
                  out(c10[!_11], acceptC(h, h2))
              orfind  suchthat defined(rmAK_330[@i_345]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_330[@i_345]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_317), mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_317), mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_321), mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                new rmAK_326: mkeyseed;
                new r3_327: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_325), mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(rAK_321[@i_218], hc[@i_218], rmAK_322[@i_218], e3[@i_218], mAK_1735[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, kgen(rAK_321[@i_218])) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              let SK_23: key = kgen(rSK_1738) in
              new rmSK_1739: mkeyseed;
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_1739), hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_1739), n2, h3), kgen(rAK_321[@i_218]), r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_23: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_2148: mkey = cst_mkey in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_1743), n2, h3), kgen(rAK_321[@i_218]), r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(rAK_329[@i_218], hc[@i_218], rmAK_330[@i_218], e3[@i_218], mAK_1737[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(e11[@i_1781], @i_218[@i_1781], x_1774[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = e11[@i_1781]) && check2(e11[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1780 <= N suchthat defined(e11[@i_1780], @i_218[@i_1780], x_1775[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = e11[@i_1780]) && check2(e11[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1777 <= N suchthat defined(e5[@i_1777], @i_345[@i_1777], x_1776[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = e5[@i_1777]) && check2(e5[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_23: key = kgen(rSK_1746) in
                new rmSK_1747: mkeyseed;
                let mSK_2149: mkey = cst_mkey in
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_1747), hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1749) in
                let x_1774: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_23: key = kgen(rSK_1750) in
                new rmSK_1751: mkeyseed;
                let mSK_2150: mkey = cst_mkey in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1753) in
                let x_1775: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(rmSK_1743[@i_125], mSK_2148[@i_125], SK_23[@i_125], hc[@i_218[@i_125]], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          if check(m15, mkgen(rmSK_1743[@i_125]), mac15) then
          let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
          new r16_2151: seed;
          let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16_2151) in
          let mac16: macs = mac(e16, mkgen(rmSK_1743[@i_125])) in
          event partSC(hc[@i_218[@i_125]], m14, m15);
          event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
        orfind @i_125 <= N suchthat defined(rmSK_1751[@i_125], mSK_2150[@i_125], SK_23[@i_125], hc[@i_218[@i_125]], e10[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          find @i_2185 <= N suchthat defined(x_2180[@i_2185]) && ((@i_125[@i_2185] = @i_125) && ((m15 = x_2180[@i_2185]) && check2(x_2180[@i_2185], mkgen2(rmSK_1751[@i_125]), mac15))) then
            if true then
            let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
            new r16_2152: seed;
            let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16_2152) in
            let x_2180: maxmac = e16 in
            let mac16: macs = mac2(x_2180, mkgen2(rmSK_1751[@i_125])) in
            event partSC(hc[@i_218[@i_125]], m14, m15);
            event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
            out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
          orfind @i_2182 <= N suchthat defined(x_2181[@i_2182]) && ((@i_1785[@i_2182] = @i_125) && ((m15 = x_2181[@i_2182]) && check2(x_2181[@i_2182], mkgen2(rmSK_1751[@i_125]), mac15))) then

PB: Missing defined condition @i_1785[@i_2182] (used in the condition of find)

            if true then
            let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
            new r16_2152: seed;
            let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16_2152) in
            let x_2180: maxmac = e16 in
            let mac16: macs = mac2(x_2180, mkgen2(rmSK_1751[@i_125])) in
            event partSC(hc[@i_218[@i_125]], m14, m15);
            event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
            out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
          else
            if false then
            let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
            new r16_2152: seed;
            let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16_2152) in
            let x_2180: maxmac = e16 in
            let mac16: macs = mac2(x_2180, mkgen2(rmSK_1751[@i_125])) in
            event partSC(hc[@i_218[@i_125]], m14, m15);
            event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
            out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying simplify yields

Game 83 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rmAK_326[@i_346], rAK_325[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), kgen(rAK_325[@i_346]), r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, kgen(rAK_325[@i_346])) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rmAK_330[@i_345], rAK_329[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new r1_372: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_329[@i_345]), r1_372) in
              let x_1776: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(rmSK_1747[@i_1786], SK_23[@i_1786], h3[@i_1786], n2[@i_1786], e11[@i_1786], @i_218[@i_1786], x_1774[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = e11[@i_1786]) && check2(e11[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1786]) then
                if (h2 = h3[@i_1786]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1827: timest;
                new r2_1828: seed;
                let e12: maxmac = enc(pad(C, ts2_1827), SK_23[@i_1786], r2_1828) in
                let mac12: macs = mac(e12, mkgen(rmSK_1747[@i_1786])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mkgen(rmSK_1747[@i_1786]), mac13) then
                if (injbot(padts(ts2_1827)) = dec(m13, SK_23[@i_1786])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(rmSK_1751[@i_1785], SK_23[@i_1785], h3[@i_1785], n2[@i_1785], e11[@i_1785], @i_218[@i_1785], x_1775[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = e11[@i_1785]) && check2(e11[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1785]) then
                if (h2 = h3[@i_1785]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1829: timest;
                new r2_1830: seed;
                let e12: maxmac = enc(pad(C, ts2_1829), SK_23[@i_1785], r2_1830) in
                let x_2181: maxmac = e12 in
                let mac12: macs = mac2(x_2181, mkgen2(rmSK_1751[@i_1785])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                find @i_2189 <= N suchthat defined(x_2180[@i_2189], @i_125[@i_2189]) && ((@i_125[@i_2189] = @i_1785) && ((m13 = x_2180[@i_2189]) && check2(x_2180[@i_2189], mkgen2(rmSK_1751[@i_1785]), mac13))) then
                  event fullCS(h2, h, m7, e12, m13);
                  out(c10[!_11], acceptC(h, h2))
                orfind  suchthat defined(rmSK_1751[@i_1785]) && ((m13 = x_2181) && check2(x_2181, mkgen2(rmSK_1751[@i_1785]), mac13)) then
                  yield
              orfind  suchthat defined(rmAK_330[@i_345]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_330[@i_345]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_317), mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_317), mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_321), mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                new rmAK_326: mkeyseed;
                new r3_327: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_325), mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(rAK_321[@i_218], hc[@i_218], rmAK_322[@i_218], e3[@i_218], mAK_1735[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, kgen(rAK_321[@i_218])) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              let SK_23: key = kgen(rSK_1738) in
              new rmSK_1739: mkeyseed;
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_1739), hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_1739), n2, h3), kgen(rAK_321[@i_218]), r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_23: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_2148: mkey = cst_mkey in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_1743), n2, h3), kgen(rAK_321[@i_218]), r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(rAK_329[@i_218], hc[@i_218], rmAK_330[@i_218], e3[@i_218], mAK_1737[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(e11[@i_1781], @i_218[@i_1781], x_1774[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = e11[@i_1781]) && check2(e11[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1780 <= N suchthat defined(e11[@i_1780], @i_218[@i_1780], x_1775[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = e11[@i_1780]) && check2(e11[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1777 <= N suchthat defined(e5[@i_1777], @i_345[@i_1777], x_1776[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = e5[@i_1777]) && check2(e5[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_23: key = kgen(rSK_1746) in
                new rmSK_1747: mkeyseed;
                let mSK_2149: mkey = cst_mkey in
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_1747), hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1749) in
                let x_1774: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_23: key = kgen(rSK_1750) in
                new rmSK_1751: mkeyseed;
                let mSK_2150: mkey = cst_mkey in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1753) in
                let x_1775: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], rmSK_1743[@i_125], e10[@i_125], mSK_2148[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          if check(m15, mkgen(rmSK_1743[@i_125]), mac15) then
          let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
          new r16_2151: seed;
          let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16_2151) in
          let mac16: macs = mac(e16, mkgen(rmSK_1743[@i_125])) in
          event partSC(hc[@i_218[@i_125]], m14, m15);
          event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
        orfind @i_125 <= N suchthat defined(hc[@i_218[@i_125]], SK_23[@i_125], @i_1777[@i_125], rmSK_1751[@i_125], e10[@i_125], mSK_2150[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          find @i_2185 <= N suchthat defined(x_2180[@i_2185], @i_125[@i_2185]) && ((@i_125[@i_2185] = @i_125) && ((m15 = x_2180[@i_2185]) && check2(x_2180[@i_2185], mkgen2(rmSK_1751[@i_125]), mac15))) then
            yield
          orfind  suchthat defined(hc[@i_218[@i_125]], ts2_1829[@i_1777[@i_125]], x_2181[@i_1777[@i_125]], @i_1785[@i_1777[@i_125]]) && ((@i_1785[@i_1777[@i_125]] = @i_125) && ((m15 = x_2181[@i_1777[@i_125]]) && check2(x_2181[@i_1777[@i_125]], mkgen2(rmSK_1751[@i_125]), mac15))) then
            let @i_2182 <= N = @i_1777[@i_125] in
            let ts3: timest = ts2_1829[@i_1777[@i_125]] in
            new r16_2152: seed;
            let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16_2152) in
            let x_2180: maxmac = e16 in
            let mac16: macs = mac2(x_2180, mkgen2(rmSK_1751[@i_125])) in
            event partSC(hc[@i_218[@i_125]], m14, m15);
            event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
            out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of useless yields

Game 84 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rmAK_326[@i_346], rAK_325[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), kgen(rAK_325[@i_346]), r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, kgen(rAK_325[@i_346])) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rmAK_330[@i_345], rAK_329[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new r1_372: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_329[@i_345]), r1_372) in
              let x_1776: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(rmSK_1747[@i_1786], SK_23[@i_1786], h3[@i_1786], n2[@i_1786], e11[@i_1786], @i_218[@i_1786], x_1774[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = e11[@i_1786]) && check2(e11[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1786]) then
                if (h2 = h3[@i_1786]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1827: timest;
                new r2_1828: seed;
                let e12: maxmac = enc(pad(C, ts2_1827), SK_23[@i_1786], r2_1828) in
                let mac12: macs = mac(e12, mkgen(rmSK_1747[@i_1786])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mkgen(rmSK_1747[@i_1786]), mac13) then
                if (injbot(padts(ts2_1827)) = dec(m13, SK_23[@i_1786])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(rmSK_1751[@i_1785], SK_23[@i_1785], h3[@i_1785], n2[@i_1785], e11[@i_1785], @i_218[@i_1785], x_1775[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = e11[@i_1785]) && check2(e11[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1785]) then
                if (h2 = h3[@i_1785]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1829: timest;
                new r2_1830: seed;
                let e12: maxmac = enc(pad(C, ts2_1829), SK_23[@i_1785], r2_1830) in
                let x_2181: maxmac = cst_maxmac in
                let mac12: macs = mac2(e12, mkgen2(rmSK_1751[@i_1785])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                find @i_2189 <= N suchthat defined(e16[@i_2189], x_2180[@i_2189], @i_125[@i_2189]) && ((@i_125[@i_2189] = @i_1785) && ((m13 = e16[@i_2189]) && check2(e16[@i_2189], mkgen2(rmSK_1751[@i_1785]), mac13))) then
                  event fullCS(h2, h, m7, e12, m13);
                  out(c10[!_11], acceptC(h, h2))
                orfind  suchthat defined(rmSK_1751[@i_1785]) && ((m13 = e12) && check2(e12, mkgen2(rmSK_1751[@i_1785]), mac13)) then
                  yield
              orfind  suchthat defined(rmAK_330[@i_345]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_330[@i_345]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_317), mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_317), mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_321), mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                new rmAK_326: mkeyseed;
                new r3_327: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_325), mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(rAK_321[@i_218], hc[@i_218], rmAK_322[@i_218], e3[@i_218], mAK_1735[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, kgen(rAK_321[@i_218])) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              let SK_23: key = kgen(rSK_1738) in
              new rmSK_1739: mkeyseed;
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_1739), hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_1739), n2, h3), kgen(rAK_321[@i_218]), r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_23: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_2148: mkey = cst_mkey in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(SK_23, mkgen(rmSK_1743), n2, h3), kgen(rAK_321[@i_218]), r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(rAK_329[@i_218], hc[@i_218], rmAK_330[@i_218], e3[@i_218], mAK_1737[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(e11[@i_1781], @i_218[@i_1781], x_1774[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = e11[@i_1781]) && check2(e11[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1780 <= N suchthat defined(e11[@i_1780], @i_218[@i_1780], x_1775[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = e11[@i_1780]) && check2(e11[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1777 <= N suchthat defined(e5[@i_1777], @i_345[@i_1777], x_1776[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = e5[@i_1777]) && check2(e5[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_23: key = kgen(rSK_1746) in
                new rmSK_1747: mkeyseed;
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(SK_23, mkgen(rmSK_1747), hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1749) in
                let x_1774: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_23: key = kgen(rSK_1750) in
                new rmSK_1751: mkeyseed;
                let mSK_2150: mkey = cst_mkey in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1753) in
                let x_1775: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], rmSK_1743[@i_125], e10[@i_125], mSK_2148[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          if check(m15, mkgen(rmSK_1743[@i_125]), mac15) then
          let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
          new r16_2151: seed;
          let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16_2151) in
          let mac16: macs = mac(e16, mkgen(rmSK_1743[@i_125])) in
          event partSC(hc[@i_218[@i_125]], m14, m15);
          event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
        orfind @i_125 <= N suchthat defined(hc[@i_218[@i_125]], SK_23[@i_125], @i_1777[@i_125], rmSK_1751[@i_125], e10[@i_125], mSK_2150[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          find @i_2185 <= N suchthat defined(e16[@i_2185], x_2180[@i_2185], @i_125[@i_2185]) && ((@i_125[@i_2185] = @i_125) && ((m15 = e16[@i_2185]) && check2(e16[@i_2185], mkgen2(rmSK_1751[@i_125]), mac15))) then
            yield
          orfind  suchthat defined(e12[@i_1777[@i_125]], x_2181[@i_1777[@i_125]], hc[@i_218[@i_125]], ts2_1829[@i_1777[@i_125]], @i_1785[@i_1777[@i_125]]) && ((@i_1785[@i_1777[@i_125]] = @i_125) && ((m15 = e12[@i_1777[@i_125]]) && check2(e12[@i_1777[@i_125]], mkgen2(rmSK_1751[@i_125]), mac15))) then
            new r16_2152: seed;
            let e16: maxmac = enc(padts(ts2_1829[@i_1777[@i_125]]), SK_23[@i_125], r16_2152) in
            let x_2180: maxmac = cst_maxmac in
            let mac16: macs = mac2(e16, mkgen2(rmSK_1751[@i_125])) in
            event partSC(hc[@i_218[@i_125]], m14, m15);
            event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
            out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


RESULT Proved event fullCS(S, T, z, y, w) ==> fullSC(C, x, y, w) with probability N * Pmac(time + time(context for game 81), 2. * N, 2. * N) + N * Penc(time + time(context for game 71), 2. * N) + 0.5 * N * N / |nonce| + N / |nonce| + N * Pmac(time + time(context for game 59), 2. * N, 2. * N) + Penc(time + time(context for game 50), N) + Penc(time + time(context for game 43), N) + Penc(time + time(context for game 36), N) + Pmac(time + time(context for game 26), N, N) + Pmac(time + time(context for game 17), N, N) + Pmac(time + time(context for game 8), N, N)

Applying remove assignments of binder SK_23 yields

Game 86 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rmAK_326[@i_346], rAK_325[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), kgen(rAK_325[@i_346]), r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, kgen(rAK_325[@i_346])) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rmAK_330[@i_345], rAK_329[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new r1_372: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_329[@i_345]), r1_372) in
              let x_1776: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(rmSK_1747[@i_1786], SK_23[@i_1786], h3[@i_1786], n2[@i_1786], e11[@i_1786], @i_218[@i_1786], x_1774[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = e11[@i_1786]) && check2(e11[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1786]) then
                if (h2 = h3[@i_1786]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1827: timest;
                new r2_1828: seed;
                let e12: maxmac = enc(pad(C, ts2_1827), SK_23[@i_1786], r2_1828) in
                let mac12: macs = mac(e12, mkgen(rmSK_1747[@i_1786])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mkgen(rmSK_1747[@i_1786]), mac13) then
                if (injbot(padts(ts2_1827)) = dec(m13, SK_23[@i_1786])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(rmSK_1751[@i_1785], SK_23[@i_1785], h3[@i_1785], n2[@i_1785], e11[@i_1785], @i_218[@i_1785], x_1775[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = e11[@i_1785]) && check2(e11[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1785]) then
                if (h2 = h3[@i_1785]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1829: timest;
                new r2_1830: seed;
                let e12: maxmac = enc(pad(C, ts2_1829), SK_23[@i_1785], r2_1830) in
                let x_2181: maxmac = cst_maxmac in
                let mac12: macs = mac2(e12, mkgen2(rmSK_1751[@i_1785])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                find @i_2189 <= N suchthat defined(e16[@i_2189], x_2180[@i_2189], @i_125[@i_2189]) && ((@i_125[@i_2189] = @i_1785) && ((m13 = e16[@i_2189]) && check2(e16[@i_2189], mkgen2(rmSK_1751[@i_1785]), mac13))) then
                  event fullCS(h2, h, m7, e12, m13);
                  out(c10[!_11], acceptC(h, h2))
                orfind  suchthat defined(rmSK_1751[@i_1785]) && ((m13 = e12) && check2(e12, mkgen2(rmSK_1751[@i_1785]), mac13)) then
                  yield
              orfind  suchthat defined(rmAK_330[@i_345]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_330[@i_345]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_317), mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_317), mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_321), mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                new rmAK_326: mkeyseed;
                new r3_327: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_325), mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(rAK_321[@i_218], hc[@i_218], rmAK_322[@i_218], e3[@i_218], mAK_1735[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, kgen(rAK_321[@i_218])) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              let SK_23: key = kgen(rSK_1738) in
              new rmSK_1739: mkeyseed;
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(kgen(rSK_1738), mkgen(rmSK_1739), hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_1738), mkgen(rmSK_1739), n2, h3), kgen(rAK_321[@i_218]), r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_23: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_2148: mkey = cst_mkey in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_1742), mkgen(rmSK_1743), n2, h3), kgen(rAK_321[@i_218]), r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(rAK_329[@i_218], hc[@i_218], rmAK_330[@i_218], e3[@i_218], mAK_1737[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(e11[@i_1781], @i_218[@i_1781], x_1774[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = e11[@i_1781]) && check2(e11[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1780 <= N suchthat defined(e11[@i_1780], @i_218[@i_1780], x_1775[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = e11[@i_1780]) && check2(e11[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1777 <= N suchthat defined(e5[@i_1777], @i_345[@i_1777], x_1776[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = e5[@i_1777]) && check2(e5[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_23: key = kgen(rSK_1746) in
                new rmSK_1747: mkeyseed;
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(kgen(rSK_1746), mkgen(rmSK_1747), hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1749) in
                let x_1774: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_23: key = kgen(rSK_1750) in
                new rmSK_1751: mkeyseed;
                let mSK_2150: mkey = cst_mkey in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1753) in
                let x_1775: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_23[@i_125], hc[@i_218[@i_125]], rmSK_1743[@i_125], e10[@i_125], mSK_2148[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          if check(m15, mkgen(rmSK_1743[@i_125]), mac15) then
          let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_23[@i_125]) in
          new r16_2151: seed;
          let e16: maxmac = enc(padts(ts3), SK_23[@i_125], r16_2151) in
          let mac16: macs = mac(e16, mkgen(rmSK_1743[@i_125])) in
          event partSC(hc[@i_218[@i_125]], m14, m15);
          event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
        orfind @i_125 <= N suchthat defined(hc[@i_218[@i_125]], SK_23[@i_125], @i_1777[@i_125], rmSK_1751[@i_125], e10[@i_125], mSK_2150[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          find @i_2185 <= N suchthat defined(e16[@i_2185], x_2180[@i_2185], @i_125[@i_2185]) && ((@i_125[@i_2185] = @i_125) && ((m15 = e16[@i_2185]) && check2(e16[@i_2185], mkgen2(rmSK_1751[@i_125]), mac15))) then
            yield
          orfind  suchthat defined(e12[@i_1777[@i_125]], x_2181[@i_1777[@i_125]], hc[@i_218[@i_125]], ts2_1829[@i_1777[@i_125]], @i_1785[@i_1777[@i_125]]) && ((@i_1785[@i_1777[@i_125]] = @i_125) && ((m15 = e12[@i_1777[@i_125]]) && check2(e12[@i_1777[@i_125]], mkgen2(rmSK_1751[@i_125]), mac15))) then
            new r16_2152: seed;
            let e16: maxmac = enc(padts(ts2_1829[@i_1777[@i_125]]), SK_23[@i_125], r16_2152) in
            let x_2180: maxmac = cst_maxmac in
            let mac16: macs = mac2(e16, mkgen2(rmSK_1751[@i_125])) in
            event partSC(hc[@i_218[@i_125]], m14, m15);
            event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
            out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying SA rename SK_23 yields

Game 87 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rmAK_326[@i_346], rAK_325[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), kgen(rAK_325[@i_346]), r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, kgen(rAK_325[@i_346])) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rmAK_330[@i_345], rAK_329[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new r1_372: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_329[@i_345]), r1_372) in
              let x_1776: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(rmSK_1747[@i_1786], SK_2260[@i_1786], h3[@i_1786], n2[@i_1786], e11[@i_1786], @i_218[@i_1786], x_1774[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = e11[@i_1786]) && check2(e11[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1786]) then
                if (h2 = h3[@i_1786]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1827: timest;
                new r2_1828: seed;
                let e12: maxmac = enc(pad(C, ts2_1827), SK_2260[@i_1786], r2_1828) in
                let mac12: macs = mac(e12, mkgen(rmSK_1747[@i_1786])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mkgen(rmSK_1747[@i_1786]), mac13) then
                if (injbot(padts(ts2_1827)) = dec(m13, SK_2260[@i_1786])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(rmSK_1751[@i_1785], SK_2261[@i_1785], h3[@i_1785], n2[@i_1785], e11[@i_1785], @i_218[@i_1785], x_1775[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = e11[@i_1785]) && check2(e11[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1785]) then
                if (h2 = h3[@i_1785]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1829: timest;
                new r2_1830: seed;
                let e12: maxmac = enc(pad(C, ts2_1829), SK_2261[@i_1785], r2_1830) in
                let x_2181: maxmac = cst_maxmac in
                let mac12: macs = mac2(e12, mkgen2(rmSK_1751[@i_1785])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                find @i_2189 <= N suchthat defined(e16[@i_2189], x_2180[@i_2189], @i_125[@i_2189]) && ((@i_125[@i_2189] = @i_1785) && ((m13 = e16[@i_2189]) && check2(e16[@i_2189], mkgen2(rmSK_1751[@i_1785]), mac13))) then
                  event fullCS(h2, h, m7, e12, m13);
                  out(c10[!_11], acceptC(h, h2))
                orfind  suchthat defined(rmSK_1751[@i_1785]) && ((m13 = e12) && check2(e12, mkgen2(rmSK_1751[@i_1785]), mac13)) then
                  yield
              orfind  suchthat defined(rmAK_330[@i_345]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_330[@i_345]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_317), mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_317), mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_321), mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                new rmAK_326: mkeyseed;
                new r3_327: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_325), mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(rAK_321[@i_218], hc[@i_218], rmAK_322[@i_218], e3[@i_218], mAK_1735[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, kgen(rAK_321[@i_218])) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              let SK_2258: key = kgen(rSK_1738) in
              new rmSK_1739: mkeyseed;
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(kgen(rSK_1738), mkgen(rmSK_1739), hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_1738), mkgen(rmSK_1739), n2, h3), kgen(rAK_321[@i_218]), r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_2259: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_2148: mkey = cst_mkey in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_1742), mkgen(rmSK_1743), n2, h3), kgen(rAK_321[@i_218]), r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(rAK_329[@i_218], hc[@i_218], rmAK_330[@i_218], e3[@i_218], mAK_1737[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(e11[@i_1781], @i_218[@i_1781], x_1774[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = e11[@i_1781]) && check2(e11[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1780 <= N suchthat defined(e11[@i_1780], @i_218[@i_1780], x_1775[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = e11[@i_1780]) && check2(e11[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1777 <= N suchthat defined(e5[@i_1777], @i_345[@i_1777], x_1776[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = e5[@i_1777]) && check2(e5[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_2260: key = kgen(rSK_1746) in
                new rmSK_1747: mkeyseed;
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(kgen(rSK_1746), mkgen(rmSK_1747), hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1749) in
                let x_1774: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_2261: key = kgen(rSK_1750) in
                new rmSK_1751: mkeyseed;
                let mSK_2150: mkey = cst_mkey in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1753) in
                let x_1775: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_2259[@i_125], hc[@i_218[@i_125]], rmSK_1743[@i_125], e10[@i_125], mSK_2148[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          if check(m15, mkgen(rmSK_1743[@i_125]), mac15) then
          let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_2259[@i_125]) in
          new r16_2151: seed;
          let e16: maxmac = enc(padts(ts3), SK_2259[@i_125], r16_2151) in
          let mac16: macs = mac(e16, mkgen(rmSK_1743[@i_125])) in
          event partSC(hc[@i_218[@i_125]], m14, m15);
          event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
        orfind @i_125 <= N suchthat defined(hc[@i_218[@i_125]], SK_2261[@i_125], @i_1777[@i_125], rmSK_1751[@i_125], e10[@i_125], mSK_2150[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          find @i_2185 <= N suchthat defined(e16[@i_2185], x_2180[@i_2185], @i_125[@i_2185]) && ((@i_125[@i_2185] = @i_125) && ((m15 = e16[@i_2185]) && check2(e16[@i_2185], mkgen2(rmSK_1751[@i_125]), mac15))) then
            yield
          orfind  suchthat defined(e12[@i_1777[@i_125]], x_2181[@i_1777[@i_125]], hc[@i_218[@i_125]], ts2_1829[@i_1777[@i_125]], @i_1785[@i_1777[@i_125]]) && ((@i_1785[@i_1777[@i_125]] = @i_125) && ((m15 = e12[@i_1777[@i_125]]) && check2(e12[@i_1777[@i_125]], mkgen2(rmSK_1751[@i_125]), mac15))) then
            new r16_2152: seed;
            let e16: maxmac = enc(padts(ts2_1829[@i_1777[@i_125]]), SK_2261[@i_125], r16_2152) in
            let x_2180: maxmac = cst_maxmac in
            let mac16: macs = mac2(e16, mkgen2(rmSK_1751[@i_125])) in
            event partSC(hc[@i_218[@i_125]], m14, m15);
            event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
            out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of useless yields

Game 88 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rmAK_326[@i_346], rAK_325[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), kgen(rAK_325[@i_346]), r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, kgen(rAK_325[@i_346])) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rmAK_330[@i_345], rAK_329[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new r1_372: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_329[@i_345]), r1_372) in
              let x_1776: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(rmSK_1747[@i_1786], SK_2260[@i_1786], h3[@i_1786], n2[@i_1786], e11[@i_1786], @i_218[@i_1786], x_1774[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = e11[@i_1786]) && check2(e11[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1786]) then
                if (h2 = h3[@i_1786]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1827: timest;
                new r2_1828: seed;
                let e12: maxmac = enc(pad(C, ts2_1827), SK_2260[@i_1786], r2_1828) in
                let mac12: macs = mac(e12, mkgen(rmSK_1747[@i_1786])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mkgen(rmSK_1747[@i_1786]), mac13) then
                if (injbot(padts(ts2_1827)) = dec(m13, SK_2260[@i_1786])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(rmSK_1751[@i_1785], SK_2261[@i_1785], h3[@i_1785], n2[@i_1785], e11[@i_1785], @i_218[@i_1785], x_1775[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = e11[@i_1785]) && check2(e11[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1785]) then
                if (h2 = h3[@i_1785]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1829: timest;
                new r2_1830: seed;
                let e12: maxmac = enc(pad(C, ts2_1829), SK_2261[@i_1785], r2_1830) in
                let x_2181: maxmac = cst_maxmac in
                let mac12: macs = mac2(e12, mkgen2(rmSK_1751[@i_1785])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                find @i_2189 <= N suchthat defined(e16[@i_2189], x_2180[@i_2189], @i_125[@i_2189]) && ((@i_125[@i_2189] = @i_1785) && ((m13 = e16[@i_2189]) && check2(e16[@i_2189], mkgen2(rmSK_1751[@i_1785]), mac13))) then
                  event fullCS(h2, h, m7, e12, m13);
                  out(c10[!_11], acceptC(h, h2))
                orfind  suchthat defined(rmSK_1751[@i_1785]) && ((m13 = e12) && check2(e12, mkgen2(rmSK_1751[@i_1785]), mac13)) then
                  yield
              orfind  suchthat defined(rmAK_330[@i_345]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_330[@i_345]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_317), mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_317), mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_321), mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                new rmAK_326: mkeyseed;
                new r3_327: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_325), mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(rAK_321[@i_218], hc[@i_218], rmAK_322[@i_218], e3[@i_218], mAK_1735[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, kgen(rAK_321[@i_218])) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              new rmSK_1739: mkeyseed;
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(kgen(rSK_1738), mkgen(rmSK_1739), hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_1738), mkgen(rmSK_1739), n2, h3), kgen(rAK_321[@i_218]), r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_2259: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_2148: mkey = cst_mkey in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_1742), mkgen(rmSK_1743), n2, h3), kgen(rAK_321[@i_218]), r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(rAK_329[@i_218], hc[@i_218], rmAK_330[@i_218], e3[@i_218], mAK_1737[@i_218], x_217[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(e11[@i_1781], @i_218[@i_1781], x_1774[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = e11[@i_1781]) && check2(e11[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1780 <= N suchthat defined(e11[@i_1780], @i_218[@i_1780], x_1775[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = e11[@i_1780]) && check2(e11[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1777 <= N suchthat defined(e5[@i_1777], @i_345[@i_1777], x_1776[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = e5[@i_1777]) && check2(e5[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_2260: key = kgen(rSK_1746) in
                new rmSK_1747: mkeyseed;
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(kgen(rSK_1746), mkgen(rmSK_1747), hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1749) in
                let x_1774: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_2261: key = kgen(rSK_1750) in
                new rmSK_1751: mkeyseed;
                let mSK_2150: mkey = cst_mkey in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1753) in
                let x_1775: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_2259[@i_125], hc[@i_218[@i_125]], rmSK_1743[@i_125], e10[@i_125], mSK_2148[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          if check(m15, mkgen(rmSK_1743[@i_125]), mac15) then
          let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_2259[@i_125]) in
          new r16_2151: seed;
          let e16: maxmac = enc(padts(ts3), SK_2259[@i_125], r16_2151) in
          let mac16: macs = mac(e16, mkgen(rmSK_1743[@i_125])) in
          event partSC(hc[@i_218[@i_125]], m14, m15);
          event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
        orfind @i_125 <= N suchthat defined(hc[@i_218[@i_125]], SK_2261[@i_125], @i_1777[@i_125], rmSK_1751[@i_125], e10[@i_125], mSK_2150[@i_125], x_124[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          find @i_2185 <= N suchthat defined(e16[@i_2185], x_2180[@i_2185], @i_125[@i_2185]) && ((@i_125[@i_2185] = @i_125) && ((m15 = e16[@i_2185]) && check2(e16[@i_2185], mkgen2(rmSK_1751[@i_125]), mac15))) then
            yield
          orfind  suchthat defined(e12[@i_1777[@i_125]], x_2181[@i_1777[@i_125]], hc[@i_218[@i_125]], ts2_1829[@i_1777[@i_125]], @i_1785[@i_1777[@i_125]]) && ((@i_1785[@i_1777[@i_125]] = @i_125) && ((m15 = e12[@i_1777[@i_125]]) && check2(e12[@i_1777[@i_125]], mkgen2(rmSK_1751[@i_125]), mac15))) then
            new r16_2152: seed;
            let e16: maxmac = enc(padts(ts2_1829[@i_1777[@i_125]]), SK_2261[@i_125], r16_2152) in
            let x_2180: maxmac = cst_maxmac in
            let mac16: macs = mac2(e16, mkgen2(rmSK_1751[@i_125])) in
            event partSC(hc[@i_218[@i_125]], m14, m15);
            event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
            out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying simplify yields

Game 89 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rmAK_326[@i_346], rAK_325[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), kgen(rAK_325[@i_346]), r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, kgen(rAK_325[@i_346])) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rmAK_330[@i_345], rAK_329[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new r1_372: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_329[@i_345]), r1_372) in
              let x_1776: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(rmSK_1747[@i_1786], SK_2260[@i_1786], h3[@i_1786], n2[@i_1786], e11[@i_1786], @i_218[@i_1786], x_1774[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = e11[@i_1786]) && check2(e11[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1786]) then
                if (h2 = h3[@i_1786]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1827: timest;
                new r2_1828: seed;
                let e12: maxmac = enc(pad(C, ts2_1827), SK_2260[@i_1786], r2_1828) in
                let mac12: macs = mac(e12, mkgen(rmSK_1747[@i_1786])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mkgen(rmSK_1747[@i_1786]), mac13) then
                if (injbot(padts(ts2_1827)) = dec(m13, SK_2260[@i_1786])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(rmSK_1751[@i_1785], SK_2261[@i_1785], h3[@i_1785], n2[@i_1785], e11[@i_1785], @i_218[@i_1785], x_1775[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = e11[@i_1785]) && check2(e11[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1785]) then
                if (h2 = h3[@i_1785]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1829: timest;
                new r2_1830: seed;
                let e12: maxmac = enc(pad(C, ts2_1829), SK_2261[@i_1785], r2_1830) in
                let x_2181: maxmac = cst_maxmac in
                let mac12: macs = mac2(e12, mkgen2(rmSK_1751[@i_1785])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                find @i_2189 <= N suchthat defined(e16[@i_2189], @i_125[@i_2189], x_2180[@i_2189]) && ((@i_125[@i_2189] = @i_1785) && ((m13 = e16[@i_2189]) && check2(e16[@i_2189], mkgen2(rmSK_1751[@i_1785]), mac13))) then
                  event fullCS(h2, h, m7, e12, m13);
                  out(c10[!_11], acceptC(h, h2))
                orfind  suchthat defined(rmSK_1751[@i_1785]) && ((m13 = e12) && check2(e12, mkgen2(rmSK_1751[@i_1785]), mac13)) then
                  yield
              orfind  suchthat defined(rmAK_330[@i_345]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_330[@i_345]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_317), mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_317), mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_321), mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                new rmAK_326: mkeyseed;
                new r3_327: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_325), mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(rAK_321[@i_218], hc[@i_218], rmAK_322[@i_218], e3[@i_218], x_217[@i_218], mAK_1735[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, kgen(rAK_321[@i_218])) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              new rmSK_1739: mkeyseed;
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(kgen(rSK_1738), mkgen(rmSK_1739), hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_1738), mkgen(rmSK_1739), n2, h3), kgen(rAK_321[@i_218]), r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_2259: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_2148: mkey = cst_mkey in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_1742), mkgen(rmSK_1743), n2, h3), kgen(rAK_321[@i_218]), r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(rAK_329[@i_218], hc[@i_218], rmAK_330[@i_218], e3[@i_218], x_217[@i_218], mAK_1737[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(e11[@i_1781], @i_218[@i_1781], x_1774[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = e11[@i_1781]) && check2(e11[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1780 <= N suchthat defined(e11[@i_1780], @i_218[@i_1780], x_1775[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = e11[@i_1780]) && check2(e11[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1777 <= N suchthat defined(e5[@i_1777], @i_345[@i_1777], x_1776[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = e5[@i_1777]) && check2(e5[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_2260: key = kgen(rSK_1746) in
                new rmSK_1747: mkeyseed;
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(kgen(rSK_1746), mkgen(rmSK_1747), hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1749) in
                let x_1774: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_2261: key = kgen(rSK_1750) in
                new rmSK_1751: mkeyseed;
                let mSK_2150: mkey = cst_mkey in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1753) in
                let x_1775: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_2259[@i_125], hc[@i_218[@i_125]], rmSK_1743[@i_125], e10[@i_125], x_124[@i_125], mSK_2148[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          if check(m15, mkgen(rmSK_1743[@i_125]), mac15) then
          let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_2259[@i_125]) in
          new r16_2151: seed;
          let e16: maxmac = enc(padts(ts3), SK_2259[@i_125], r16_2151) in
          let mac16: macs = mac(e16, mkgen(rmSK_1743[@i_125])) in
          event partSC(hc[@i_218[@i_125]], m14, m15);
          event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
        orfind @i_125 <= N suchthat defined(hc[@i_218[@i_125]], SK_2261[@i_125], rmSK_1751[@i_125], e10[@i_125], x_124[@i_125], mSK_2150[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          find @i_2185 <= N suchthat defined(e16[@i_2185], @i_125[@i_2185], x_2180[@i_2185]) && ((@i_125[@i_2185] = @i_125) && ((m15 = e16[@i_2185]) && check2(e16[@i_2185], mkgen2(rmSK_1751[@i_125]), mac15))) then
            yield
          orfind  suchthat defined(hc[@i_218[@i_125]], ts2_1829[@i_1777[@i_125]], e12[@i_1777[@i_125]], @i_1785[@i_1777[@i_125]], x_2181[@i_1777[@i_125]]) && ((@i_1785[@i_1777[@i_125]] = @i_125) && ((m15 = e12[@i_1777[@i_125]]) && check2(e12[@i_1777[@i_125]], mkgen2(rmSK_1751[@i_125]), mac15))) then
            new r16_2152: seed;
            let e16: maxmac = enc(padts(ts2_1829[@i_1777[@i_125]]), SK_2261[@i_125], r16_2152) in
            let x_2180: maxmac = cst_maxmac in
            let mac16: macs = mac2(e16, mkgen2(rmSK_1751[@i_125])) in
            event partSC(hc[@i_218[@i_125]], m14, m15);
            event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
            out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of binder SK_2261 yields

Game 90 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rmAK_326[@i_346], rAK_325[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), kgen(rAK_325[@i_346]), r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, kgen(rAK_325[@i_346])) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rmAK_330[@i_345], rAK_329[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new r1_372: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_329[@i_345]), r1_372) in
              let x_1776: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(rmSK_1747[@i_1786], SK_2260[@i_1786], h3[@i_1786], n2[@i_1786], e11[@i_1786], @i_218[@i_1786], x_1774[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = e11[@i_1786]) && check2(e11[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1786]) then
                if (h2 = h3[@i_1786]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1827: timest;
                new r2_1828: seed;
                let e12: maxmac = enc(pad(C, ts2_1827), SK_2260[@i_1786], r2_1828) in
                let mac12: macs = mac(e12, mkgen(rmSK_1747[@i_1786])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mkgen(rmSK_1747[@i_1786]), mac13) then
                if (injbot(padts(ts2_1827)) = dec(m13, SK_2260[@i_1786])) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(rSK_1750[@i_1785], SK_2261[@i_1785], rmSK_1751[@i_1785], h3[@i_1785], n2[@i_1785], e11[@i_1785], @i_218[@i_1785], x_1775[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = e11[@i_1785]) && check2(e11[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1785]) then
                if (h2 = h3[@i_1785]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1829: timest;
                new r2_1830: seed;
                let e12: maxmac = enc(pad(C, ts2_1829), kgen(rSK_1750[@i_1785]), r2_1830) in
                let x_2181: maxmac = cst_maxmac in
                let mac12: macs = mac2(e12, mkgen2(rmSK_1751[@i_1785])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                find @i_2189 <= N suchthat defined(e16[@i_2189], @i_125[@i_2189], x_2180[@i_2189]) && ((@i_125[@i_2189] = @i_1785) && ((m13 = e16[@i_2189]) && check2(e16[@i_2189], mkgen2(rmSK_1751[@i_1785]), mac13))) then
                  event fullCS(h2, h, m7, e12, m13);
                  out(c10[!_11], acceptC(h, h2))
                orfind  suchthat defined(rmSK_1751[@i_1785]) && ((m13 = e12) && check2(e12, mkgen2(rmSK_1751[@i_1785]), mac13)) then
                  yield
              orfind  suchthat defined(rmAK_330[@i_345]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_330[@i_345]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_317), mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_317), mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_321), mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                new rmAK_326: mkeyseed;
                new r3_327: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_325), mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(rAK_321[@i_218], hc[@i_218], rmAK_322[@i_218], e3[@i_218], x_217[@i_218], mAK_1735[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, kgen(rAK_321[@i_218])) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              new rmSK_1739: mkeyseed;
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(kgen(rSK_1738), mkgen(rmSK_1739), hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_1738), mkgen(rmSK_1739), n2, h3), kgen(rAK_321[@i_218]), r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_2259: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_2148: mkey = cst_mkey in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_1742), mkgen(rmSK_1743), n2, h3), kgen(rAK_321[@i_218]), r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(rAK_329[@i_218], hc[@i_218], rmAK_330[@i_218], e3[@i_218], x_217[@i_218], mAK_1737[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(e11[@i_1781], @i_218[@i_1781], x_1774[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = e11[@i_1781]) && check2(e11[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1780 <= N suchthat defined(e11[@i_1780], @i_218[@i_1780], x_1775[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = e11[@i_1780]) && check2(e11[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1777 <= N suchthat defined(e5[@i_1777], @i_345[@i_1777], x_1776[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = e5[@i_1777]) && check2(e5[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_2260: key = kgen(rSK_1746) in
                new rmSK_1747: mkeyseed;
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(kgen(rSK_1746), mkgen(rmSK_1747), hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1749) in
                let x_1774: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_2261: key = cst_key in
                new rmSK_1751: mkeyseed;
                let mSK_2150: mkey = cst_mkey in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1753) in
                let x_1775: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_2259[@i_125], hc[@i_218[@i_125]], rmSK_1743[@i_125], e10[@i_125], x_124[@i_125], mSK_2148[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          if check(m15, mkgen(rmSK_1743[@i_125]), mac15) then
          let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_2259[@i_125]) in
          new r16_2151: seed;
          let e16: maxmac = enc(padts(ts3), SK_2259[@i_125], r16_2151) in
          let mac16: macs = mac(e16, mkgen(rmSK_1743[@i_125])) in
          event partSC(hc[@i_218[@i_125]], m14, m15);
          event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
        orfind @i_125 <= N suchthat defined(rSK_1750[@i_125], SK_2261[@i_125], hc[@i_218[@i_125]], rmSK_1751[@i_125], e10[@i_125], x_124[@i_125], mSK_2150[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          find @i_2185 <= N suchthat defined(e16[@i_2185], @i_125[@i_2185], x_2180[@i_2185]) && ((@i_125[@i_2185] = @i_125) && ((m15 = e16[@i_2185]) && check2(e16[@i_2185], mkgen2(rmSK_1751[@i_125]), mac15))) then
            yield
          orfind  suchthat defined(hc[@i_218[@i_125]], ts2_1829[@i_1777[@i_125]], e12[@i_1777[@i_125]], @i_1785[@i_1777[@i_125]], x_2181[@i_1777[@i_125]]) && ((@i_1785[@i_1777[@i_125]] = @i_125) && ((m15 = e12[@i_1777[@i_125]]) && check2(e12[@i_1777[@i_125]], mkgen2(rmSK_1751[@i_125]), mac15))) then
            new r16_2152: seed;
            let e16: maxmac = enc(padts(ts2_1829[@i_1777[@i_125]]), kgen(rSK_1750[@i_125]), r16_2152) in
            let x_2180: maxmac = cst_maxmac in
            let mac16: macs = mac2(e16, mkgen2(rmSK_1751[@i_125])) in
            event partSC(hc[@i_218[@i_125]], m14, m15);
            event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
            out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of binder SK_2260 yields

Game 91 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rmAK_326[@i_346], rAK_325[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), kgen(rAK_325[@i_346]), r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, kgen(rAK_325[@i_346])) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rmAK_330[@i_345], rAK_329[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new r1_372: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_329[@i_345]), r1_372) in
              let x_1776: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(rSK_1746[@i_1786], SK_2260[@i_1786], rmSK_1747[@i_1786], h3[@i_1786], n2[@i_1786], e11[@i_1786], @i_218[@i_1786], x_1774[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = e11[@i_1786]) && check2(e11[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1786]) then
                if (h2 = h3[@i_1786]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1827: timest;
                new r2_1828: seed;
                let e12: maxmac = enc(pad(C, ts2_1827), kgen(rSK_1746[@i_1786]), r2_1828) in
                let mac12: macs = mac(e12, mkgen(rmSK_1747[@i_1786])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mkgen(rmSK_1747[@i_1786]), mac13) then
                if (injbot(padts(ts2_1827)) = dec(m13, kgen(rSK_1746[@i_1786]))) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(rSK_1750[@i_1785], SK_2261[@i_1785], rmSK_1751[@i_1785], h3[@i_1785], n2[@i_1785], e11[@i_1785], @i_218[@i_1785], x_1775[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = e11[@i_1785]) && check2(e11[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1785]) then
                if (h2 = h3[@i_1785]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1829: timest;
                new r2_1830: seed;
                let e12: maxmac = enc(pad(C, ts2_1829), kgen(rSK_1750[@i_1785]), r2_1830) in
                let x_2181: maxmac = cst_maxmac in
                let mac12: macs = mac2(e12, mkgen2(rmSK_1751[@i_1785])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                find @i_2189 <= N suchthat defined(e16[@i_2189], @i_125[@i_2189], x_2180[@i_2189]) && ((@i_125[@i_2189] = @i_1785) && ((m13 = e16[@i_2189]) && check2(e16[@i_2189], mkgen2(rmSK_1751[@i_1785]), mac13))) then
                  event fullCS(h2, h, m7, e12, m13);
                  out(c10[!_11], acceptC(h, h2))
                orfind  suchthat defined(rmSK_1751[@i_1785]) && ((m13 = e12) && check2(e12, mkgen2(rmSK_1751[@i_1785]), mac13)) then
                  yield
              orfind  suchthat defined(rmAK_330[@i_345]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_330[@i_345]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_317), mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_317), mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_321), mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                new rmAK_326: mkeyseed;
                new r3_327: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_325), mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(rAK_321[@i_218], hc[@i_218], rmAK_322[@i_218], e3[@i_218], x_217[@i_218], mAK_1735[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, kgen(rAK_321[@i_218])) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              new rmSK_1739: mkeyseed;
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(kgen(rSK_1738), mkgen(rmSK_1739), hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_1738), mkgen(rmSK_1739), n2, h3), kgen(rAK_321[@i_218]), r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_2259: key = kgen(rSK_1742) in
              new rmSK_1743: mkeyseed;
              let mSK_2148: mkey = cst_mkey in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_1742), mkgen(rmSK_1743), n2, h3), kgen(rAK_321[@i_218]), r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(rAK_329[@i_218], hc[@i_218], rmAK_330[@i_218], e3[@i_218], x_217[@i_218], mAK_1737[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(e11[@i_1781], @i_218[@i_1781], x_1774[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = e11[@i_1781]) && check2(e11[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1780 <= N suchthat defined(e11[@i_1780], @i_218[@i_1780], x_1775[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = e11[@i_1780]) && check2(e11[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1777 <= N suchthat defined(e5[@i_1777], @i_345[@i_1777], x_1776[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = e5[@i_1777]) && check2(e5[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_2260: key = cst_key in
                new rmSK_1747: mkeyseed;
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(kgen(rSK_1746), mkgen(rmSK_1747), hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1749) in
                let x_1774: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_2261: key = cst_key in
                new rmSK_1751: mkeyseed;
                let mSK_2150: mkey = cst_mkey in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1753) in
                let x_1775: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(SK_2259[@i_125], hc[@i_218[@i_125]], rmSK_1743[@i_125], e10[@i_125], x_124[@i_125], mSK_2148[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          if check(m15, mkgen(rmSK_1743[@i_125]), mac15) then
          let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, SK_2259[@i_125]) in
          new r16_2151: seed;
          let e16: maxmac = enc(padts(ts3), SK_2259[@i_125], r16_2151) in
          let mac16: macs = mac(e16, mkgen(rmSK_1743[@i_125])) in
          event partSC(hc[@i_218[@i_125]], m14, m15);
          event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
        orfind @i_125 <= N suchthat defined(rSK_1750[@i_125], SK_2261[@i_125], hc[@i_218[@i_125]], rmSK_1751[@i_125], e10[@i_125], x_124[@i_125], mSK_2150[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          find @i_2185 <= N suchthat defined(e16[@i_2185], @i_125[@i_2185], x_2180[@i_2185]) && ((@i_125[@i_2185] = @i_125) && ((m15 = e16[@i_2185]) && check2(e16[@i_2185], mkgen2(rmSK_1751[@i_125]), mac15))) then
            yield
          orfind  suchthat defined(hc[@i_218[@i_125]], ts2_1829[@i_1777[@i_125]], e12[@i_1777[@i_125]], @i_1785[@i_1777[@i_125]], x_2181[@i_1777[@i_125]]) && ((@i_1785[@i_1777[@i_125]] = @i_125) && ((m15 = e12[@i_1777[@i_125]]) && check2(e12[@i_1777[@i_125]], mkgen2(rmSK_1751[@i_125]), mac15))) then
            new r16_2152: seed;
            let e16: maxmac = enc(padts(ts2_1829[@i_1777[@i_125]]), kgen(rSK_1750[@i_125]), r16_2152) in
            let x_2180: maxmac = cst_maxmac in
            let mac16: macs = mac2(e16, mkgen2(rmSK_1751[@i_125])) in
            event partSC(hc[@i_218[@i_125]], m14, m15);
            event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
            out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of binder SK_2259 yields

Game 92 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rmAK_326[@i_346], rAK_325[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), kgen(rAK_325[@i_346]), r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, kgen(rAK_325[@i_346])) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rmAK_330[@i_345], rAK_329[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new r1_372: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_329[@i_345]), r1_372) in
              let x_1776: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(rSK_1746[@i_1786], SK_2260[@i_1786], rmSK_1747[@i_1786], h3[@i_1786], n2[@i_1786], e11[@i_1786], @i_218[@i_1786], x_1774[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = e11[@i_1786]) && check2(e11[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1786]) then
                if (h2 = h3[@i_1786]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1827: timest;
                new r2_1828: seed;
                let e12: maxmac = enc(pad(C, ts2_1827), kgen(rSK_1746[@i_1786]), r2_1828) in
                let mac12: macs = mac(e12, mkgen(rmSK_1747[@i_1786])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mkgen(rmSK_1747[@i_1786]), mac13) then
                if (injbot(padts(ts2_1827)) = dec(m13, kgen(rSK_1746[@i_1786]))) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(rSK_1750[@i_1785], SK_2261[@i_1785], rmSK_1751[@i_1785], h3[@i_1785], n2[@i_1785], e11[@i_1785], @i_218[@i_1785], x_1775[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = e11[@i_1785]) && check2(e11[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1785]) then
                if (h2 = h3[@i_1785]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1829: timest;
                new r2_1830: seed;
                let e12: maxmac = enc(pad(C, ts2_1829), kgen(rSK_1750[@i_1785]), r2_1830) in
                let x_2181: maxmac = cst_maxmac in
                let mac12: macs = mac2(e12, mkgen2(rmSK_1751[@i_1785])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                find @i_2189 <= N suchthat defined(e16[@i_2189], @i_125[@i_2189], x_2180[@i_2189]) && ((@i_125[@i_2189] = @i_1785) && ((m13 = e16[@i_2189]) && check2(e16[@i_2189], mkgen2(rmSK_1751[@i_1785]), mac13))) then
                  event fullCS(h2, h, m7, e12, m13);
                  out(c10[!_11], acceptC(h, h2))
                orfind  suchthat defined(rmSK_1751[@i_1785]) && ((m13 = e12) && check2(e12, mkgen2(rmSK_1751[@i_1785]), mac13)) then
                  yield
              orfind  suchthat defined(rmAK_330[@i_345]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_330[@i_345]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_317), mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_317), mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_321), mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                new rmAK_326: mkeyseed;
                new r3_327: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_325), mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(rAK_321[@i_218], hc[@i_218], rmAK_322[@i_218], e3[@i_218], x_217[@i_218], mAK_1735[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, kgen(rAK_321[@i_218])) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              new rmSK_1739: mkeyseed;
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(kgen(rSK_1738), mkgen(rmSK_1739), hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_1738), mkgen(rmSK_1739), n2, h3), kgen(rAK_321[@i_218]), r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_2259: key = cst_key in
              new rmSK_1743: mkeyseed;
              let mSK_2148: mkey = cst_mkey in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_1742), mkgen(rmSK_1743), n2, h3), kgen(rAK_321[@i_218]), r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(rAK_329[@i_218], hc[@i_218], rmAK_330[@i_218], e3[@i_218], x_217[@i_218], mAK_1737[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(e11[@i_1781], @i_218[@i_1781], x_1774[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = e11[@i_1781]) && check2(e11[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1780 <= N suchthat defined(e11[@i_1780], @i_218[@i_1780], x_1775[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = e11[@i_1780]) && check2(e11[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1777 <= N suchthat defined(e5[@i_1777], @i_345[@i_1777], x_1776[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = e5[@i_1777]) && check2(e5[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_2260: key = cst_key in
                new rmSK_1747: mkeyseed;
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(kgen(rSK_1746), mkgen(rmSK_1747), hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1749) in
                let x_1774: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_2261: key = cst_key in
                new rmSK_1751: mkeyseed;
                let mSK_2150: mkey = cst_mkey in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1753) in
                let x_1775: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(rSK_1742[@i_125], SK_2259[@i_125], hc[@i_218[@i_125]], rmSK_1743[@i_125], e10[@i_125], x_124[@i_125], mSK_2148[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          if check(m15, mkgen(rmSK_1743[@i_125]), mac15) then
          let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, kgen(rSK_1742[@i_125])) in
          new r16_2151: seed;
          let e16: maxmac = enc(padts(ts3), kgen(rSK_1742[@i_125]), r16_2151) in
          let mac16: macs = mac(e16, mkgen(rmSK_1743[@i_125])) in
          event partSC(hc[@i_218[@i_125]], m14, m15);
          event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
        orfind @i_125 <= N suchthat defined(rSK_1750[@i_125], SK_2261[@i_125], hc[@i_218[@i_125]], rmSK_1751[@i_125], e10[@i_125], x_124[@i_125], mSK_2150[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          find @i_2185 <= N suchthat defined(e16[@i_2185], @i_125[@i_2185], x_2180[@i_2185]) && ((@i_125[@i_2185] = @i_125) && ((m15 = e16[@i_2185]) && check2(e16[@i_2185], mkgen2(rmSK_1751[@i_125]), mac15))) then
            yield
          orfind  suchthat defined(hc[@i_218[@i_125]], ts2_1829[@i_1777[@i_125]], e12[@i_1777[@i_125]], @i_1785[@i_1777[@i_125]], x_2181[@i_1777[@i_125]]) && ((@i_1785[@i_1777[@i_125]] = @i_125) && ((m15 = e12[@i_1777[@i_125]]) && check2(e12[@i_1777[@i_125]], mkgen2(rmSK_1751[@i_125]), mac15))) then
            new r16_2152: seed;
            let e16: maxmac = enc(padts(ts2_1829[@i_1777[@i_125]]), kgen(rSK_1750[@i_125]), r16_2152) in
            let x_2180: maxmac = cst_maxmac in
            let mac16: macs = mac2(e16, mkgen2(rmSK_1751[@i_125])) in
            event partSC(hc[@i_218[@i_125]], m14, m15);
            event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
            out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying equivalence
equiv ! !_1 <= N2 new r: keyseed; ! !_2 <= N new r2: seed; (x: maxenc) -> enc(x, kgen(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_3 <= N2 new r: keyseed; ! !_4 <= N new r2: seed; (x: maxenc) -> enc2(Z(x), kgen2(r), r2)
with r16_2152 [Difference of probability N * Penc(time + time(context for game 92), 2. * N)] yields

Game 93 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rmAK_326[@i_346], rAK_325[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), kgen(rAK_325[@i_346]), r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, kgen(rAK_325[@i_346])) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rmAK_330[@i_345], rAK_329[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new r1_372: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_329[@i_345]), r1_372) in
              let x_1776: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(rSK_1746[@i_1786], SK_2260[@i_1786], rmSK_1747[@i_1786], h3[@i_1786], n2[@i_1786], e11[@i_1786], @i_218[@i_1786], x_1774[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = e11[@i_1786]) && check2(e11[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1786]) then
                if (h2 = h3[@i_1786]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1827: timest;
                new r2_1828: seed;
                let e12: maxmac = enc(pad(C, ts2_1827), kgen(rSK_1746[@i_1786]), r2_1828) in
                let mac12: macs = mac(e12, mkgen(rmSK_1747[@i_1786])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mkgen(rmSK_1747[@i_1786]), mac13) then
                if (injbot(padts(ts2_1827)) = dec(m13, kgen(rSK_1746[@i_1786]))) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(rSK_1750[@i_1785], SK_2261[@i_1785], rmSK_1751[@i_1785], h3[@i_1785], n2[@i_1785], e11[@i_1785], @i_218[@i_1785], x_1775[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = e11[@i_1785]) && check2(e11[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1785]) then
                if (h2 = h3[@i_1785]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1829: timest;
                new r2_1830: seed;
                let e12: maxmac = enc2(Z(pad(C, ts2_1829)), kgen2(rSK_1750[@i_1785]), r2_1830) in
                let x_2181: maxmac = cst_maxmac in
                let mac12: macs = mac2(e12, mkgen2(rmSK_1751[@i_1785])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                find @i_2189 <= N suchthat defined(e16[@i_2189], @i_125[@i_2189], x_2180[@i_2189]) && ((@i_125[@i_2189] = @i_1785) && ((m13 = e16[@i_2189]) && check2(e16[@i_2189], mkgen2(rmSK_1751[@i_1785]), mac13))) then
                  event fullCS(h2, h, m7, e12, m13);
                  out(c10[!_11], acceptC(h, h2))
                orfind  suchthat defined(rmSK_1751[@i_1785]) && ((m13 = e12) && check2(e12, mkgen2(rmSK_1751[@i_1785]), mac13)) then
                  yield
              orfind  suchthat defined(rmAK_330[@i_345]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_330[@i_345]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_317), mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_317), mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_321), mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                new rmAK_326: mkeyseed;
                new r3_327: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_325), mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(rAK_321[@i_218], hc[@i_218], rmAK_322[@i_218], e3[@i_218], x_217[@i_218], mAK_1735[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, kgen(rAK_321[@i_218])) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              new rmSK_1739: mkeyseed;
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(kgen(rSK_1738), mkgen(rmSK_1739), hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_1738), mkgen(rmSK_1739), n2, h3), kgen(rAK_321[@i_218]), r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_2259: key = cst_key in
              new rmSK_1743: mkeyseed;
              let mSK_2148: mkey = cst_mkey in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_1742), mkgen(rmSK_1743), n2, h3), kgen(rAK_321[@i_218]), r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(rAK_329[@i_218], hc[@i_218], rmAK_330[@i_218], e3[@i_218], x_217[@i_218], mAK_1737[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(e11[@i_1781], @i_218[@i_1781], x_1774[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = e11[@i_1781]) && check2(e11[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1780 <= N suchthat defined(e11[@i_1780], @i_218[@i_1780], x_1775[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = e11[@i_1780]) && check2(e11[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1777 <= N suchthat defined(e5[@i_1777], @i_345[@i_1777], x_1776[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = e5[@i_1777]) && check2(e5[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_2260: key = cst_key in
                new rmSK_1747: mkeyseed;
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(kgen(rSK_1746), mkgen(rmSK_1747), hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1749) in
                let x_1774: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_2261: key = cst_key in
                new rmSK_1751: mkeyseed;
                let mSK_2150: mkey = cst_mkey in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1753) in
                let x_1775: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(rSK_1742[@i_125], SK_2259[@i_125], hc[@i_218[@i_125]], rmSK_1743[@i_125], e10[@i_125], x_124[@i_125], mSK_2148[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          if check(m15, mkgen(rmSK_1743[@i_125]), mac15) then
          let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, kgen(rSK_1742[@i_125])) in
          new r16_2151: seed;
          let e16: maxmac = enc(padts(ts3), kgen(rSK_1742[@i_125]), r16_2151) in
          let mac16: macs = mac(e16, mkgen(rmSK_1743[@i_125])) in
          event partSC(hc[@i_218[@i_125]], m14, m15);
          event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
        orfind @i_125 <= N suchthat defined(rSK_1750[@i_125], SK_2261[@i_125], hc[@i_218[@i_125]], rmSK_1751[@i_125], e10[@i_125], x_124[@i_125], mSK_2150[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          find @i_2185 <= N suchthat defined(e16[@i_2185], @i_125[@i_2185], x_2180[@i_2185]) && ((@i_125[@i_2185] = @i_125) && ((m15 = e16[@i_2185]) && check2(e16[@i_2185], mkgen2(rmSK_1751[@i_125]), mac15))) then
            yield
          orfind  suchthat defined(hc[@i_218[@i_125]], ts2_1829[@i_1777[@i_125]], e12[@i_1777[@i_125]], @i_1785[@i_1777[@i_125]], x_2181[@i_1777[@i_125]]) && ((@i_1785[@i_1777[@i_125]] = @i_125) && ((m15 = e12[@i_1777[@i_125]]) && check2(e12[@i_1777[@i_125]], mkgen2(rmSK_1751[@i_125]), mac15))) then
            new r16_2152: seed;
            let e16: maxmac = enc2(Z(padts(ts2_1829[@i_1777[@i_125]])), kgen2(rSK_1750[@i_125]), r16_2152) in
            let x_2180: maxmac = cst_maxmac in
            let mac16: macs = mac2(e16, mkgen2(rmSK_1751[@i_125])) in
            event partSC(hc[@i_218[@i_125]], m14, m15);
            event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
            out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying simplify yields

Game 94 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rmAK_326[@i_346], rAK_325[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), kgen(rAK_325[@i_346]), r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, kgen(rAK_325[@i_346])) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rmAK_330[@i_345], rAK_329[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new r1_372: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_329[@i_345]), r1_372) in
              let x_1776: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(rmSK_1747[@i_1786], rSK_1746[@i_1786], h3[@i_1786], n2[@i_1786], e11[@i_1786], @i_218[@i_1786], x_1774[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = e11[@i_1786]) && check2(e11[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1786]) then
                if (h2 = h3[@i_1786]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1827: timest;
                new r2_1828: seed;
                let e12: maxmac = enc(pad(C, ts2_1827), kgen(rSK_1746[@i_1786]), r2_1828) in
                let mac12: macs = mac(e12, mkgen(rmSK_1747[@i_1786])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mkgen(rmSK_1747[@i_1786]), mac13) then
                if (injbot(padts(ts2_1827)) = dec(m13, kgen(rSK_1746[@i_1786]))) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(rmSK_1751[@i_1785], rSK_1750[@i_1785], h3[@i_1785], n2[@i_1785], e11[@i_1785], @i_218[@i_1785], x_1775[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = e11[@i_1785]) && check2(e11[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1785]) then
                if (h2 = h3[@i_1785]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new r2_1830: seed;
                let e12: maxmac = enc2(Zpad, kgen2(rSK_1750[@i_1785]), r2_1830) in
                let x_2181: maxmac = cst_maxmac in
                let mac12: macs = mac2(e12, mkgen2(rmSK_1751[@i_1785])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                find @i_2189 <= N suchthat defined(e16[@i_2189], @i_125[@i_2189], x_2180[@i_2189]) && ((@i_125[@i_2189] = @i_1785) && ((m13 = e16[@i_2189]) && check2(e16[@i_2189], mkgen2(rmSK_1751[@i_1785]), mac13))) then
                  event fullCS(h2, h, m7, e12, m13);
                  out(c10[!_11], acceptC(h, h2))
                orfind  suchthat defined(rmSK_1751[@i_1785]) && ((m13 = e12) && check2(e12, mkgen2(rmSK_1751[@i_1785]), mac13)) then
                  yield
              orfind  suchthat defined(rmAK_330[@i_345]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_330[@i_345]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_317), mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_317), mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_321), mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                new rmAK_326: mkeyseed;
                new r3_327: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_325), mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(rAK_321[@i_218], hc[@i_218], rmAK_322[@i_218], e3[@i_218], x_217[@i_218], mAK_1735[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, kgen(rAK_321[@i_218])) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              new rmSK_1739: mkeyseed;
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(kgen(rSK_1738), mkgen(rmSK_1739), hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_1738), mkgen(rmSK_1739), n2, h3), kgen(rAK_321[@i_218]), r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              let SK_2259: key = cst_key in
              new rmSK_1743: mkeyseed;
              let mSK_2148: mkey = cst_mkey in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_1742), mkgen(rmSK_1743), n2, h3), kgen(rAK_321[@i_218]), r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(rAK_329[@i_218], hc[@i_218], rmAK_330[@i_218], e3[@i_218], x_217[@i_218], mAK_1737[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(e11[@i_1781], @i_218[@i_1781], x_1774[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = e11[@i_1781]) && check2(e11[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1780 <= N suchthat defined(e11[@i_1780], @i_218[@i_1780], x_1775[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = e11[@i_1780]) && check2(e11[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1777 <= N suchthat defined(e5[@i_1777], @i_345[@i_1777], x_1776[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = e5[@i_1777]) && check2(e5[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                let SK_2260: key = cst_key in
                new rmSK_1747: mkeyseed;
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(kgen(rSK_1746), mkgen(rmSK_1747), hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1749) in
                let x_1774: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                let SK_2261: key = cst_key in
                new rmSK_1751: mkeyseed;
                let mSK_2150: mkey = cst_mkey in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1753) in
                let x_1775: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(rSK_1742[@i_125], hc[@i_218[@i_125]], rmSK_1743[@i_125], e10[@i_125], x_124[@i_125], mSK_2148[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          if check(m15, mkgen(rmSK_1743[@i_125]), mac15) then
          let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, kgen(rSK_1742[@i_125])) in
          new r16_2151: seed;
          let e16: maxmac = enc(padts(ts3), kgen(rSK_1742[@i_125]), r16_2151) in
          let mac16: macs = mac(e16, mkgen(rmSK_1743[@i_125])) in
          event partSC(hc[@i_218[@i_125]], m14, m15);
          event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
        orfind @i_125 <= N suchthat defined(hc[@i_218[@i_125]], rSK_1750[@i_125], rmSK_1751[@i_125], e10[@i_125], x_124[@i_125], mSK_2150[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          find @i_2185 <= N suchthat defined(e16[@i_2185], @i_125[@i_2185], x_2180[@i_2185]) && ((@i_125[@i_2185] = @i_125) && ((m15 = e16[@i_2185]) && check2(e16[@i_2185], mkgen2(rmSK_1751[@i_125]), mac15))) then
            yield
          orfind  suchthat defined(hc[@i_218[@i_125]], e12[@i_1777[@i_125]], @i_1785[@i_1777[@i_125]], x_2181[@i_1777[@i_125]]) && ((@i_1785[@i_1777[@i_125]] = @i_125) && ((m15 = e12[@i_1777[@i_125]]) && check2(e12[@i_1777[@i_125]], mkgen2(rmSK_1751[@i_125]), mac15))) then
            new r16_2152: seed;
            let e16: maxmac = enc2(Zpadts, kgen2(rSK_1750[@i_125]), r16_2152) in
            let x_2180: maxmac = cst_maxmac in
            let mac16: macs = mac2(e16, mkgen2(rmSK_1751[@i_125])) in
            event partSC(hc[@i_218[@i_125]], m14, m15);
            event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
            out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)


Applying remove assignments of useless yields

Game 95 is
in(start, ());
new rKc: keyseed;
new rmKc: mkeyseed;
new rKt: keyseed;
new rmKt: mkeyseed;
new rKs: keyseed;
new rmKs: mkeyseed;
out(c20, ());
(
  (
    (
      (
        (
          (
            ! !_11 <= N
            in(c1[!_11], (h: tgs, h2: server));
            new Nc: nonce;
            out(c2[!_11], (C, h, Nc));
            in(c3[!_11], (=C, m: maxmac, mac1: macs, m2: maxmac, mac2: macs));
            find @i_346 <= N suchthat defined(rmAK_326[@i_346], rAK_325[@i_346], ht[@i_346], n[@i_346], e4[@i_346], x_342[@i_346]) && ((m2 = e4[@i_346]) && check2(e4[@i_346], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_346]) then
              if (h = ht[@i_346]) then
              event fullCK(h, Nc, m, m2);
              new Nt_365: nonce;
              new ts_366: timest;
              new r1_367: seed;
              let e5: maxmac = enc(pad(C, ts_366), kgen(rAK_325[@i_346]), r1_367) in
              let mac5: macs = mac(e5, mkgen(rmAK_326[@i_346])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_365));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              if check(m7, mkgen(rmAK_326[@i_346]), mac7) then
              let injbot(concat3(SK_31: key, mSK_30: mkey, =Nt_365, =h2)) = dec(m7, kgen(rAK_325[@i_346])) in
              event fullCT(h, h2, Nt_365, m, e5, m7);
              new ts2_368: timest;
              new r2_369: seed;
              let e12: maxmac = enc(pad(C, ts2_368), SK_31, r2_369) in
              let mac12: macs = mac(e12, mSK_30) in
              event partCS(h2, h, m7, e12);
              out(c6[!_11], (m6, mac6, e12, mac12));
              in(c9[!_11], (m13: maxmac, mac13: macs));
              if check(m13, mSK_30, mac13) then
              if (injbot(padts(ts2_368)) = dec(m13, SK_31)) then
              event fullCS(h2, h, m7, e12, m13);
              out(c10[!_11], acceptC(h, h2))
            orfind @i_345 <= N suchthat defined(rmAK_330[@i_345], rAK_329[@i_345], ht[@i_345], n[@i_345], e4[@i_345], x_343[@i_345]) && ((m2 = e4[@i_345]) && check2(e4[@i_345], mkgen2(rmKc), mac2)) then
              if (Nc = n[@i_345]) then
              if (h = ht[@i_345]) then
              event fullCK(h, Nc, m, m2);
              new Nt_370: nonce;
              new r1_372: seed;
              let e5: maxmac = enc2(Zpad, kgen2(rAK_329[@i_345]), r1_372) in
              let x_1776: maxmac = cst_maxmac in
              let mac5: macs = mac2(e5, mkgen2(rmAK_330[@i_345])) in
              event partCT(h, m, e5);
              out(c4[!_11], (m, mac1, e5, mac5, h2, Nt_370));
              in(c5[!_11], (=C, m6: maxmac, mac6: macs, m7: maxmac, mac7: macs));
              find @i_1786 <= N suchthat defined(rmSK_1747[@i_1786], rSK_1746[@i_1786], h3[@i_1786], n2[@i_1786], e11[@i_1786], @i_218[@i_1786], x_1774[@i_1786]) && ((@i_218[@i_1786] = @i_345) && ((m7 = e11[@i_1786]) && check2(e11[@i_1786], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1786]) then
                if (h2 = h3[@i_1786]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new ts2_1827: timest;
                new r2_1828: seed;
                let e12: maxmac = enc(pad(C, ts2_1827), kgen(rSK_1746[@i_1786]), r2_1828) in
                let mac12: macs = mac(e12, mkgen(rmSK_1747[@i_1786])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                if check(m13, mkgen(rmSK_1747[@i_1786]), mac13) then
                if (injbot(padts(ts2_1827)) = dec(m13, kgen(rSK_1746[@i_1786]))) then
                event fullCS(h2, h, m7, e12, m13);
                out(c10[!_11], acceptC(h, h2))
              orfind @i_1785 <= N suchthat defined(rmSK_1751[@i_1785], rSK_1750[@i_1785], h3[@i_1785], n2[@i_1785], e11[@i_1785], @i_218[@i_1785], x_1775[@i_1785]) && ((@i_218[@i_1785] = @i_345) && ((m7 = e11[@i_1785]) && check2(e11[@i_1785], mkgen2(rmAK_330[@i_345]), mac7))) then
                if (Nt_370 = n2[@i_1785]) then
                if (h2 = h3[@i_1785]) then
                event fullCT(h, h2, Nt_370, m, e5, m7);
                new r2_1830: seed;
                let e12: maxmac = enc2(Zpad, kgen2(rSK_1750[@i_1785]), r2_1830) in
                let x_2181: maxmac = cst_maxmac in
                let mac12: macs = mac2(e12, mkgen2(rmSK_1751[@i_1785])) in
                event partCS(h2, h, m7, e12);
                out(c6[!_11], (m6, mac6, e12, mac12));
                in(c9[!_11], (m13: maxmac, mac13: macs));
                find @i_2189 <= N suchthat defined(e16[@i_2189], @i_125[@i_2189], x_2180[@i_2189]) && ((@i_125[@i_2189] = @i_1785) && ((m13 = e16[@i_2189]) && check2(e16[@i_2189], mkgen2(rmSK_1751[@i_1785]), mac13))) then
                  event fullCS(h2, h, m7, e12, m13);
                  out(c10[!_11], acceptC(h, h2))
                orfind  suchthat defined(rmSK_1751[@i_1785]) && ((m13 = e12) && check2(e12, mkgen2(rmSK_1751[@i_1785]), mac13)) then
                  yield
              orfind  suchthat defined(rmAK_330[@i_345]) && ((m7 = e5) && check2(e5, mkgen2(rmAK_330[@i_345]), mac7)) then
                yield
          |
            ! !_12 <= N
            in(c14[!_12], (hc: client, ht: tgs, n: nonce));
            find j1 <= N2 suchthat defined(Kmkey[j1], Kkey[j1], Khost[j1], Rmkey_315[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_317: keyseed;
                new rmAK_318: mkeyseed;
                new r3_319: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_317), mkgen(rmAK_318), hc), Lkey[j2], r3_319) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_320: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_317), mkgen(rmAK_318), n, ht), Kkey[j1], r4_320) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_321: keyseed;
                new rmAK_322: mkeyseed;
                let mAK_1735: mkey = cst_mkey in
                new r3_323: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_323) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_324: seed;
                let e4: maxmac = enc(concat1(kgen(rAK_321), mkgen(rmAK_322), n, ht), Kkey[j1], r4_324) in
                let mac4: macs = mac(e4, Kmkey[j1]) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
            orfind j1 <= N2 suchthat defined(Khost[j1], Rmkey_316[j1]) && (Khost[j1] = hc) then
              find j2 <= N2 suchthat defined(Lmkey[j2], Lkey[j2], Lhost[j2], Qmkey_198[j2]) && (Lhost[j2] = ht) then
                new rAK_325: keyseed;
                new rmAK_326: mkeyseed;
                new r3_327: seed;
                let e3: maxmac = enc(concat2(kgen(rAK_325), mkgen(rmAK_326), hc), Lkey[j2], r3_327) in
                let mac3: macs = mac(e3, Lmkey[j2]) in
                new r4_328: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_328) in
                let x_342: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
              orfind j2 <= N2 suchthat defined(Lhost[j2], Qmkey_199[j2]) && (Lhost[j2] = ht) then
                new rAK_329: keyseed;
                new rmAK_330: mkeyseed;
                let mAK_1737: mkey = cst_mkey in
                new r3_331: seed;
                let e3: maxmac = enc2(Zconcat2, kgen2(rKt), r3_331) in
                let x_217: maxmac = cst_maxmac in
                let mac3: macs = mac2(e3, mkgen2(rmKt)) in
                new r4_332: seed;
                let e4: maxmac = enc2(Zconcat1, kgen2(rKc), r4_332) in
                let x_343: maxmac = cst_maxmac in
                let mac4: macs = mac2(e4, mkgen2(rmKc)) in
                event fullKC(hc, ht, n, e3, e4);
                out(c15[!_12], (hc, e3, mac3, e4, mac4))
          )
        |
          ! !_13 <= N
          in(c7[!_13], (m8: maxmac, mac8: macs, m9: maxmac, mac9: macs, h3: server, n2: nonce));
          find @i_218 <= N suchthat defined(rAK_321[@i_218], hc[@i_218], rmAK_322[@i_218], e3[@i_218], x_217[@i_218], mAK_1735[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            if check(m9, mkgen(rmAK_322[@i_218]), mac9) then
            let injbot(pad(=hc[@i_218], ts_22: timest)) = dec(m9, kgen(rAK_321[@i_218])) in
            event partTC(hc[@i_218], m8, m9);
            find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
              new rSK_1738: keyseed;
              new rmSK_1739: mkeyseed;
              new r10_1740: seed;
              let e10: maxmac = enc(concat2(kgen(rSK_1738), mkgen(rmSK_1739), hc[@i_218]), Mkey[j3], r10_1740) in
              let mac10: macs = mac(e10, Mmkey[j3]) in
              new r11_1741: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_1738), mkgen(rmSK_1739), n2, h3), kgen(rAK_321[@i_218]), r11_1741) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
              new rSK_1742: keyseed;
              new rmSK_1743: mkeyseed;
              let mSK_2148: mkey = cst_mkey in
              new r10_1744: seed;
              let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1744) in
              let x_124: maxmac = cst_maxmac in
              let mac10: macs = mac2(e10, mkgen2(rmKs)) in
              new r11_1745: seed;
              let e11: maxmac = enc(concat3(kgen(rSK_1742), mkgen(rmSK_1743), n2, h3), kgen(rAK_321[@i_218]), r11_1745) in
              let mac11: macs = mac(e11, mkgen(rmAK_322[@i_218])) in
              event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
              out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
          orfind @i_218 <= N suchthat defined(rAK_329[@i_218], hc[@i_218], rmAK_330[@i_218], e3[@i_218], x_217[@i_218], mAK_1737[@i_218]) && ((m8 = e3[@i_218]) && check2(e3[@i_218], mkgen2(rmKt), mac8)) then
            find @i_1781 <= N suchthat defined(e11[@i_1781], @i_218[@i_1781], x_1774[@i_1781]) && ((@i_218[@i_1781] = @i_218) && ((m9 = e11[@i_1781]) && check2(e11[@i_1781], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1780 <= N suchthat defined(e11[@i_1780], @i_218[@i_1780], x_1775[@i_1780]) && ((@i_218[@i_1780] = @i_218) && ((m9 = e11[@i_1780]) && check2(e11[@i_1780], mkgen2(rmAK_330[@i_218]), mac9))) then
              yield
            orfind @i_1777 <= N suchthat defined(e5[@i_1777], @i_345[@i_1777], x_1776[@i_1777]) && ((@i_345[@i_1777] = @i_218) && ((m9 = e5[@i_1777]) && check2(e5[@i_1777], mkgen2(rmAK_330[@i_218]), mac9))) then
              event partTC(hc[@i_218], m8, m9);
              find j3 <= N2 suchthat defined(Mmkey[j3], Mkey[j3], Mhost2[j3], Mhost1[j3], Pmkey_96[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = h3)) then
                new rSK_1746: keyseed;
                new rmSK_1747: mkeyseed;
                new r10_1748: seed;
                let e10: maxmac = enc(concat2(kgen(rSK_1746), mkgen(rmSK_1747), hc[@i_218]), Mkey[j3], r10_1748) in
                let mac10: macs = mac(e10, Mmkey[j3]) in
                new r11_1749: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1749) in
                let x_1774: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
              orfind j3 <= N2 suchthat defined(Mhost2[j3], Pmkey_97[j3]) && (Mhost2[j3] = h3) then
                new rSK_1750: keyseed;
                new rmSK_1751: mkeyseed;
                let mSK_2150: mkey = cst_mkey in
                new r10_1752: seed;
                let e10: maxmac = enc2(Zconcat2, kgen2(rKs), r10_1752) in
                let x_124: maxmac = cst_maxmac in
                let mac10: macs = mac2(e10, mkgen2(rmKs)) in
                new r11_1753: seed;
                let e11: maxmac = enc2(Zconcat3, kgen2(rAK_329[@i_218]), r11_1753) in
                let x_1775: maxmac = cst_maxmac in
                let mac11: macs = mac2(e11, mkgen2(rmAK_330[@i_218])) in
                event fullTC(hc[@i_218], h3, n2, m8, m9, e11);
                out(c8[!_13], (hc[@i_218], e10, mac10, e11, mac11, acceptT(hc[@i_218], h3)))
        )
      |
        ! !_14 <= N
        in(c11[!_14], (m14: maxmac, mac14: macs, m15: maxmac, mac15: macs));
        find @i_125 <= N suchthat defined(rSK_1742[@i_125], hc[@i_218[@i_125]], rmSK_1743[@i_125], e10[@i_125], x_124[@i_125], mSK_2148[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          if check(m15, mkgen(rmSK_1743[@i_125]), mac15) then
          let injbot(pad(=hc[@i_218[@i_125]], ts3: timest)) = dec(m15, kgen(rSK_1742[@i_125])) in
          new r16_2151: seed;
          let e16: maxmac = enc(padts(ts3), kgen(rSK_1742[@i_125]), r16_2151) in
          let mac16: macs = mac(e16, mkgen(rmSK_1743[@i_125])) in
          event partSC(hc[@i_218[@i_125]], m14, m15);
          event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
          out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
        orfind @i_125 <= N suchthat defined(hc[@i_218[@i_125]], rSK_1750[@i_125], rmSK_1751[@i_125], e10[@i_125], x_124[@i_125], mSK_2150[@i_125]) && ((m14 = e10[@i_125]) && check2(e10[@i_125], mkgen2(rmKs), mac14)) then
          find @i_2185 <= N suchthat defined(e16[@i_2185], @i_125[@i_2185], x_2180[@i_2185]) && ((@i_125[@i_2185] = @i_125) && ((m15 = e16[@i_2185]) && check2(e16[@i_2185], mkgen2(rmSK_1751[@i_125]), mac15))) then
            yield
          orfind  suchthat defined(hc[@i_218[@i_125]], e12[@i_1777[@i_125]], @i_1785[@i_1777[@i_125]], x_2181[@i_1777[@i_125]]) && ((@i_1785[@i_1777[@i_125]] = @i_125) && ((m15 = e12[@i_1777[@i_125]]) && check2(e12[@i_1777[@i_125]], mkgen2(rmSK_1751[@i_125]), mac15))) then
            new r16_2152: seed;
            let e16: maxmac = enc2(Zpadts, kgen2(rSK_1750[@i_125]), r16_2152) in
            let x_2180: maxmac = cst_maxmac in
            let mac16: macs = mac2(e16, mkgen2(rmSK_1751[@i_125])) in
            event partSC(hc[@i_218[@i_125]], m14, m15);
            event fullSC(hc[@i_218[@i_125]], m14, m15, e16);
            out(c12[!_14], (e16, mac16, acceptS(hc[@i_218[@i_125]])))
      )
    |
      ! !_15 <= N2
      in(c13[!_15], (Khost: client, Kkey: key, Kmkey: mkey));
      if (Khost = C) then
        let Rmkey_316: mkey = cst_mkey
      else
        let Rmkey_315: mkey = cst_mkey
    )
  |
    ! !_16 <= N2
    in(c17[!_16], (Lhost: tgs, Lkey: key, Lmkey: mkey));
    if (Lhost = T) then
      let Qmkey_199: mkey = cst_mkey
    else
      let Qmkey_198: mkey = cst_mkey
  )
|
  ! !_17 <= N2
  in(c16[!_17], (Mhost1: tgs, Mhost2: server, Mkey: key, Mmkey: mkey));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pmkey_97: mkey = cst_mkey
  else
    let Pmkey_96: mkey = cst_mkey
)

RESULT time(context for game 8) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + time(C) * N2 + time(= client) * N2 + 2. * time(let concat2) * N + 6. * time(check) * N + 4. * time(= client) * N + 2. * time(let pad) * N + 6. * time(let injbot) * N + 7. * time(dec) * N + 2. * time(padts) * N + 7. * time(enc) * N + 7. * time(mac) * N + time(acceptS) * N + 2. * time(kgen) * N + 2. * time(mkgen) * N + 2. * time(concat2) * N + time(concat3) * N + time(acceptT) * N + 2. * N2 * time(= server) * N + 2. * N2 * time(= tgs) * N + N2 * time(T) * N + time(concat1) * N + N2 * time(= client) * N + time(= tgs) * N + time(let concat1) * N + 2. * time(= nonce) * N + time(= server) * N + time(let concat3) * N + 5. * time(C) * N + 2. * time(pad) * N + time(injbot) * N + time(= bitstringbot, length(injbot), length(dec)) * N + time(acceptC) * N + 3. * time(kgen) + 2. * time(mkgen)
RESULT time(context for game 17) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + time(C) * N2 + time(= client) * N2 + 5. * time(check) * N + 4. * time(= client) * N + 2. * time(let pad) * N + 5. * time(let injbot) * N + 6. * time(dec) * N + 2. * time(padts) * N + 7. * time(enc) * N + 7. * time(mac) * N + time(acceptS) * N + N * N * time(check2) + N * N * time(mkgen2) + N * N * time(= maxmac) + time(let concat2) * N + 2. * time(kgen) * N + 2. * time(mkgen) * N + 2. * time(concat2) * N + time(mkgen2) * N + time(mac2) * N + time(concat3) * N + time(acceptT) * N + 2. * N2 * time(= server) * N + 3. * N2 * time(= tgs) * N + N2 * time(T) * N + time(concat1) * N + N2 * time(= client) * N + time(= tgs) * N + time(let concat1) * N + 2. * time(= nonce) * N + time(= server) * N + time(let concat3) * N + 5. * time(C) * N + 2. * time(pad) * N + time(injbot) * N + time(= bitstringbot, length(injbot), length(dec)) * N + time(acceptC) * N + 3. * time(kgen) + time(mkgen)
RESULT time(context for game 26) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + time(C) * N2 + time(= client) * N2 + 4. * time(check) * N + 4. * time(= client) * N + 2. * time(let pad) * N + 4. * time(let injbot) * N + 5. * time(dec) * N + 2. * time(padts) * N + 7. * time(enc) * N + 7. * time(mac) * N + time(acceptS) * N + 2. * N * N * time(check2) + 2. * N * N * time(mkgen2) + 2. * N * N * time(= maxmac) + 2. * time(kgen) * N + 2. * time(mkgen) * N + 2. * time(concat2) * N + 2. * time(mkgen2) * N + 2. * time(mac2) * N + time(concat3) * N + time(acceptT) * N + 2. * N2 * time(= server) * N + 3. * N2 * time(= tgs) * N + N2 * time(T) * N + time(concat1) * N + 2. * N2 * time(= client) * N + time(= tgs) * N + time(let concat1) * N + 2. * time(= nonce) * N + time(= server) * N + time(let concat3) * N + 5. * time(C) * N + 2. * time(pad) * N + time(injbot) * N + time(= bitstringbot, length(injbot), length(dec)) * N + time(acceptC) * N + 3. * time(kgen)
RESULT time(context for game 36) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + time(C) * N2 + time(= client) * N2 + 4. * time(check) * N + 4. * time(= client) * N + 2. * time(let pad) * N + 3. * time(let injbot) * N + 4. * time(dec) * N + 2. * time(padts) * N + 7. * time(enc) * N + 7. * time(mac) * N + time(acceptS) * N + 4. * N * N * time(check2) + 4. * N * N * time(mkgen2) + 4. * N * N * time(= maxmac) + 2. * time(kgen) * N + 2. * time(mkgen) * N + 2. * time(concat2) * N + 3. * time(mkgen2) * N + 3. * time(mac2) * N + time(concat3) * N + time(acceptT) * N + 2. * N2 * time(= server) * N + 3. * N2 * time(= tgs) * N + N2 * time(T) * N + time(concat1) * N + 2. * N2 * time(= client) * N + time(= tgs) * N + 2. * time(= nonce) * N + time(= server) * N + time(let concat3) * N + 5. * time(C) * N + 2. * time(pad) * N + time(injbot) * N + time(= bitstringbot, length(injbot), length(dec)) * N + time(acceptC) * N + 2. * time(kgen)
RESULT time(context for game 43) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + time(C) * N2 + time(= client) * N2 + 4. * time(check) * N + 4. * time(= client) * N + 2. * time(let pad) * N + 3. * time(let injbot) * N + 4. * time(dec) * N + 2. * time(padts) * N + 7. * time(enc) * N + 7. * time(mac) * N + time(acceptS) * N + 4. * N * N * time(check2) + 4. * N * N * time(mkgen2) + 4. * N * N * time(= maxmac) + 2. * time(concat2) * N + 2. * time(kgen) * N + 2. * time(mkgen) * N + time(Zconcat2) * N + time(kgen2) * N + time(enc2) * N + 3. * time(mkgen2) * N + 3. * time(mac2) * N + time(concat3) * N + time(acceptT) * N + 2. * N2 * time(= server) * N + 3. * N2 * time(= tgs) * N + N2 * time(T) * N + time(concat1) * N + 2. * N2 * time(= client) * N + time(= tgs) * N + 2. * time(= nonce) * N + time(= server) * N + time(let concat3) * N + 5. * time(C) * N + 2. * time(pad) * N + time(injbot) * N + time(= bitstringbot, length(injbot), length(dec)) * N + time(acceptC) * N + time(kgen)
RESULT time(context for game 50) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + time(C) * N2 + time(= client) * N2 + 4. * time(check) * N + 4. * time(= client) * N + 2. * time(let pad) * N + 3. * time(let injbot) * N + 4. * time(dec) * N + 2. * time(padts) * N + 7. * time(enc) * N + 7. * time(mac) * N + time(acceptS) * N + 4. * N * N * time(check2) + 4. * N * N * time(mkgen2) + 4. * N * N * time(= maxmac) + 2. * time(concat2) * N + 2. * time(kgen) * N + 2. * time(mkgen) * N + time(Zconcat2) * N + 2. * time(kgen2) * N + 2. * time(enc2) * N + 3. * time(mkgen2) * N + 3. * time(mac2) * N + time(concat3) * N + time(acceptT) * N + 2. * N2 * time(= server) * N + 3. * N2 * time(= tgs) * N + N2 * time(T) * N + time(concat1) * N + time(Zconcat1) * N + 2. * N2 * time(= client) * N + time(= tgs) * N + 2. * time(= nonce) * N + time(= server) * N + time(let concat3) * N + 5. * time(C) * N + 2. * time(pad) * N + time(injbot) * N + time(= bitstringbot, length(injbot), length(dec)) * N + time(acceptC) * N
RESULT time(context for game 59) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + time(C) * N2 + time(= client) * N2 + 4. * time(check) * N + 4. * time(= client) * N + 2. * time(let pad) * N + 3. * time(let injbot) * N + 4. * time(dec) * N + 2. * time(padts) * N + 7. * time(enc) * N + 7. * time(mac) * N + time(acceptS) * N + 5. * N * N * time(check2) + 5. * N * N * time(mkgen2) + 5. * N * N * time(= maxmac) + 2. * time(concat2) * N + 2. * time(kgen) * N + 7. * time(mkgen) * N + 2. * time(Zconcat2) * N + 3. * time(kgen2) * N + 3. * time(enc2) * N + 3. * time(mkgen2) * N + 3. * time(mac2) * N + time(concat3) * N + time(acceptT) * N + 2. * N2 * time(= server) * N + 3. * N2 * time(= tgs) * N + N2 * time(T) * N + time(concat1) * N + time(Zconcat1) * N + 2. * N2 * time(= client) * N + time(= tgs) * N + 2. * time(= nonce) * N + time(= server) * N + time(let concat3) * N + 5. * time(C) * N + 2. * time(pad) * N + time(injbot) * N + time(= bitstringbot, length(injbot), length(dec)) * N + time(acceptC) * N
RESULT time(context for game 71) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + time(C) * N2 + time(= client) * N2 + 4. * time(check) * N + 4. * time(= client) * N + 2. * time(let pad) * N + 3. * time(let injbot) * N + 4. * time(dec) * N + 2. * time(padts) * N + 7. * time(enc) * N + 7. * time(mac) * N + time(acceptS) * N + 10. * N * N * time(check2) + 10. * N * N * time(mkgen2) + 10. * N * N * time(= maxmac) + 2. * time(concat2) * N + 7. * time(kgen) * N + 7. * time(mkgen) * N + 2. * time(Zconcat2) * N + 3. * time(kgen2) * N + 3. * time(enc2) * N + time(concat3) * N + 6. * time(mkgen2) * N + 5. * time(mac2) * N + time(acceptT) * N + 2. * N2 * time(= server) * N + 3. * N2 * time(= tgs) * N + N2 * time(T) * N + 5. * N * N * time(= [1,N]) + time(concat1) * N + time(Zconcat1) * N + 2. * N2 * time(= client) * N + time(let concat3) * N + time(= tgs) * N + 2. * time(= nonce) * N + time(= server) * N + 5. * time(C) * N + 2. * time(pad) * N + time(injbot) * N + time(= bitstringbot, length(injbot), length(dec)) * N + time(acceptC) * N + time(= maxmac) * N + time(check2) * N
RESULT time(context for game 81) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + time(C) * N2 + time(= client) * N2 + 4. * time(check) * N + 10. * time(mkgen) * N + 7. * time(mac) * N + 4. * time(= client) * N + 2. * time(let pad) * N + 3. * time(let injbot) * N + 4. * time(dec) * N + 2. * time(padts) * N + 7. * time(enc) * N + time(acceptS) * N + 11. * N * N * time(check2) + 11. * N * N * time(mkgen2) + 11. * N * N * time(= maxmac) + time(concat3) * N + 2. * time(concat2) * N + 7. * time(kgen) * N + 2. * time(Zconcat2) * N + time(Zconcat3) * N + 5. * time(kgen2) * N + 5. * time(enc2) * N + 6. * time(mkgen2) * N + 5. * time(mac2) * N + time(acceptT) * N + 2. * N2 * time(= server) * N + 3. * N2 * time(= tgs) * N + N2 * time(T) * N + 5. * N * N * time(= [1,N]) + time(concat1) * N + time(Zconcat1) * N + 2. * N2 * time(= client) * N + time(let concat3) * N + time(= tgs) * N + time(Zpad) * N + 2. * time(= nonce) * N + time(= server) * N + 5. * time(C) * N + 2. * time(pad) * N + time(injbot) * N + time(= bitstringbot, length(injbot), length(dec)) * N + time(acceptC) * N + time(= maxmac) * N + time(check2) * N
RESULT time(context for game 92) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + time(C) * N2 + time(= client) * N2 + 4. * time(check) * N + 4. * time(= client) * N + 2. * time(let pad) * N + 3. * time(let injbot) * N + 4. * time(dec) * N + 10. * time(kgen) * N + 7. * time(enc) * N + 10. * time(mkgen) * N + 7. * time(mac) * N + 2. * time(padts) * N + 7. * time(mac2) * N + time(acceptS) * N + time(= [1,N]) * N + 3. * time(= maxmac) * N + 10. * time(mkgen2) * N + 3. * time(check2) * N + 7. * N * N * time(= [1,N]) + 13. * N * N * time(check2) + 13. * N * N * time(mkgen2) + 13. * N * N * time(= maxmac) + time(concat3) * N + 2. * time(concat2) * N + 2. * time(Zconcat2) * N + time(Zconcat3) * N + 5. * time(kgen2) * N + 5. * time(enc2) * N + time(acceptT) * N + 2. * N2 * time(= server) * N + 3. * N2 * time(= tgs) * N + N2 * time(T) * N + time(concat1) * N + time(Zconcat1) * N + 2. * N2 * time(= client) * N + time(let concat3) * N + time(= tgs) * N + time(Zpad) * N + time(injbot) * N + time(= bitstringbot, length(injbot), length(dec)) * N + 2. * time(= nonce) * N + time(= server) * N + 5. * time(C) * N + 2. * time(pad) * N + time(acceptC) * N
RESULT Could not prove event partSC(C, z, y) ==> (partCS(S, T, x, y)&&fullTC(C, S, N, v, z, w)).
