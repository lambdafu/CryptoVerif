bash-3.1$ cd ..
bash-3.1$ prover examplesnd/JoeKaiTsayPublicKeyKerberos_fixed_071114
Doing expand if, let, find
Doing simplify
Run simplify 1 time(s). Fixpoint reached.
Doing move new all binders
Doing remove assignments of useless
Please enter a command: crypto sign rkCA
Doing equivalence
equiv ! !_7 <= N3 new r: skeyseed; (
  () -> spkgen(r),
  ! !_8 <= N2 new r2: sseed; (x: sblocksize) -> sign(x, sskgen(r), r2)), ! !_9 <= N4 (m: sblocksize, y: spkey, si: signature) -> check(m, y, si) [all]
<=(N3 * Psign(time, N2))=>
      ! !_10 <= N3 new r: skeyseed; (
  () -> spkgen2(r),
  ! !_11 <= N2 new r2: sseed; (x_80: sblocksize) -> let x: sblocksize = x_80 in sign2(x, sskgen2(r), r2)), ! !_12 <= N4 (m: sblocksize, y: spkey, si: signature) -> find j <= N2, k_14 <= N3 suchthat defined(x[j, k_14], r[k_14]) && ((y = spkgen2(r[k_14])) && ((m = x[j, k_14]) && check2(m, y, si))) then true else find k_13 <= N3 suchthat defined(r[k_13]) && (y = spkgen2(r[k_13])) then false else check(m, y, si)
with rkCA
Doing remove assignments of binder skCA
Doing equivalence
equiv ! !_7 <= N3 new r: skeyseed; (
  () -> spkgen(r),
  ! !_8 <= N2 new r2: sseed; (x: sblocksize) -> sign(x, sskgen(r), r2)), ! !_9 <= N4 (m: sblocksize, y: spkey, si: signature) -> check(m, y, si) [all]
<=(N3 * Psign(time, N2))=>
      ! !_10 <= N3 new r: skeyseed; (
  () -> spkgen2(r),
  ! !_11 <= N2 new r2: sseed; (x_80: sblocksize) -> let x: sblocksize = x_80 in sign2(x, sskgen2(r), r2)), ! !_12 <= N4 (m: sblocksize, y: spkey, si: signature) -> find j <= N2, k_14 <= N3 suchthat defined(x[j, k_14], r[k_14]) && ((y = spkgen2(r[k_14])) && ((m = x[j, k_14]) && check2(m, y, si))) then true else find k_13 <= N3 suchthat defined(r[k_13]) && (y = spkgen2(r[k_13])) then false else check(m, y, si)
with rkCA
Doing simplify
Run simplify 2 time(s). Maximum reached.
Doing move new all binders
Doing remove assignments of useless
Please enter a command: crypto sign rkCs
Doing equivalence
equiv ! !_7 <= N3 new r: skeyseed; (
  () -> spkgen(r),
  ! !_8 <= N2 new r2: sseed; (x: sblocksize) -> sign(x, sskgen(r), r2)), ! !_9 <= N4 (m: sblocksize, y: spkey, si: signature) -> check(m, y, si) [all]
<=(N3 * Psign(time, N2))=>
      ! !_10 <= N3 new r: skeyseed; (
  () -> spkgen2(r),
  ! !_11 <= N2 new r2: sseed; (x_80: sblocksize) -> let x: sblocksize = x_80 in sign2(x, sskgen2(r), r2)), ! !_12 <= N4 (m: sblocksize, y: spkey, si: signature) -> find j <= N2, k_14 <= N3 suchthat defined(x[j, k_14], r[k_14]) && ((y = spkgen2(r[k_14])) && ((m = x[j, k_14]) && check2(m, y, si))) then true else find k_13 <= N3 suchthat defined(r[k_13]) && (y = spkgen2(r[k_13])) then false else check(m, y, si)
with rkCs
Doing remove assignments of binder sskC
Doing equivalence
equiv ! !_7 <= N3 new r: skeyseed; (
  () -> spkgen(r),
  ! !_8 <= N2 new r2: sseed; (x: sblocksize) -> sign(x, sskgen(r), r2)), ! !_9 <= N4 (m: sblocksize, y: spkey, si: signature) -> check(m, y, si) [all]
<=(N3 * Psign(time, N2))=>
      ! !_10 <= N3 new r: skeyseed; (
  () -> spkgen2(r),
  ! !_11 <= N2 new r2: sseed; (x_80: sblocksize) -> let x: sblocksize = x_80 in sign2(x, sskgen2(r), r2)), ! !_12 <= N4 (m: sblocksize, y: spkey, si: signature) -> find j <= N2, k_14 <= N3 suchthat defined(x[j, k_14], r[k_14]) && ((y = spkgen2(r[k_14])) && ((m = x[j, k_14]) && check2(m, y, si))) then true else find k_13 <= N3 suchthat defined(r[k_13]) && (y = spkgen2(r[k_13])) then false else check(m, y, si)
with rkCs
Doing simplify
Run simplify 2 time(s). Fixpoint reached.
Eliminated collisions between rkCs and rkCA Probability: 1. / |skeyseed|
Reduced (spkgen2(rkCs) = spkgen2(rkCA)) to (rkCs = rkCA) Probability: Psigncoll
Doing move new all binders
Doing remove assignments of useless
Please enter a command: crypto enc rkC
Doing equivalence
equiv ! !_1 <= N3 new r: keyseed; (
  () -> pkgen(r),
  ! !_2 <= N2 (m: bitstring) -> dec(m, skgen(r))), ! !_3 <= N4 new r2: seed; (x: blocksize, y: pkey) -> enc(x, y, r2) [all]
<=(N3 * N4 * Penc(time, N2))=>
      ! !_4 <= N3 new r: keyseed; (
  () -> pkgen2(r),
  ! !_5 <= N2 (m: bitstring) -> find j <= N4 suchthat defined(m2[j], y[j], x[j]) && ((y[j] = pkgen2(r)) && (m = m2[j])) then injbot1(x[j]) else dec2(m, skgen2(r))), ! !_6 <= N4 new r2: seed; new r3: seed; (x_82: blocksize, y_81: pkey) -> let x: blocksize = x_82 in let y: pkey = y_81 in find k <= N3 suchthat defined(r[k]) && (y = pkgen2(r[k])) then let m2: bitstring = enc2(Z, y, r2) in m2 else enc(x, y, r3)
with rkC
Doing remove assignments of binder skC
Doing equivalence
equiv ! !_1 <= N3 new r: keyseed; (
  () -> pkgen(r),
  ! !_2 <= N2 (m: bitstring) -> dec(m, skgen(r))), ! !_3 <= N4 new r2: seed; (x: blocksize, y: pkey) -> enc(x, y, r2) [all]
<=(N3 * N4 * Penc(time, N2))=>
      ! !_4 <= N3 new r: keyseed; (
  () -> pkgen2(r),
  ! !_5 <= N2 (m: bitstring) -> find j <= N4 suchthat defined(m2[j], y[j], x[j]) && ((y[j] = pkgen2(r)) && (m = m2[j])) then injbot1(x[j]) else dec2(m, skgen2(r))), ! !_6 <= N4 new r2: seed; new r3: seed; (x_82: blocksize, y_81: pkey) -> let x: blocksize = x_82 in let y: pkey = y_81 in find k <= N3 suchthat defined(r[k]) && (y = pkgen2(r[k])) then let m2: bitstring = enc2(Z, y, r2) in m2 else enc(x, y, r3)
with r7_158, r7_151, rkC
Doing simplify
Run simplify 2 time(s). Maximum reached.
Doing move new all binders
Doing remove assignments of useless
Please enter a command: crypto sign rkKs
Doing equivalence
equiv ! !_7 <= N3 new r: skeyseed; (
  () -> spkgen(r),
  ! !_8 <= N2 new r2: sseed; (x: sblocksize) -> sign(x, sskgen(r), r2)), ! !_9 <= N4 (m: sblocksize, y: spkey, si: signature) -> check(m, y, si) [all]
<=(N3 * Psign(time, N2))=>
      ! !_10 <= N3 new r: skeyseed; (
  () -> spkgen2(r),
  ! !_11 <= N2 new r2: sseed; (x_80: sblocksize) -> let x: sblocksize = x_80 in sign2(x, sskgen2(r), r2)), ! !_12 <= N4 (m: sblocksize, y: spkey, si: signature) -> find j <= N2, k_14 <= N3 suchthat defined(x[j, k_14], r[k_14]) && ((y = spkgen2(r[k_14])) && ((m = x[j, k_14]) && check2(m, y, si))) then true else find k_13 <= N3 suchthat defined(r[k_13]) && (y = spkgen2(r[k_13])) then false else check(m, y, si)
with rkKs
Doing simplify
Run simplify 2 time(s). Fixpoint reached.
Eliminated collisions between rkKs and rkCs Probability: 1. / |skeyseed|
Eliminated collisions between rkKs and rkCA Probability: 1. / |skeyseed|
Reduced (spkgen2(rkKs) = spkgen2(rkCs)) to (rkKs = rkCs) Probability: Psigncoll
Reduced (spkgen2(rkKs) = spkgen2(rkCA)) to (rkKs = rkCA) Probability: Psigncoll
Doing move new all binders
Doing remove assignments of useless
Please enter a command: show_game
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkK: keyseed;
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(ck[@i_184], kp_146[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            let k1': key = keyderivation(kp_146[@i_184], un1) in
            let k2': key = keyderivation(kp_146[@i_184], un2) in
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if checkmac(y', k2', ck[@i_184]) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_207: symseed;
            new tc_206: timest;
            let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
            event partCT(hostT, TGT_58, e5);
            new n3_208: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_210: symseed;
            new tc'_209: timest;
            let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(ck[@i_183], kp_153[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            let k1': key = keyderivation(kp_153[@i_183], un1) in
            let k2': key = keyderivation(kp_153[@i_183], un2) in
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if checkmac(y', k2', ck[@i_183]) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_212: symseed;
            new tc_211: timest;
            let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
            event partCT(hostT, TGT_58, e5);
            new n3_213: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_215: symseed;
            new tc'_214: timest;
            let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new kp_146: protkey;
            let k1: key = keyderivation(kp_146, un1) in
            let k2: key = keyderivation(kp_146, un2) in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new kp_153: protkey;
            let k1: key = keyderivation(kp_153, un1) in
            let k2: key = keyderivation(kp_153, un2) in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)

Please enter a command: crypto keyderivation
Doing equivalence
equiv ! !_31 <= N2 new z: protkey; ! !_32 <= N (x: usenum) -> keyderivation(z, x)
<=(N2 * pPRF(time, N))=>
      ! !_33 <= N2 ! !_34 <= N (x_77: usenum) -> let x: usenum = x_77 in find u <= N suchthat defined(x[u], r[u]) && (x = x[u]) then r[u] else new s: symkeyseed; let r: key = kgen(s) in r

Doing simplify
Run simplify 2 time(s). Maximum reached.
Doing move new all binders
Doing remove assignments of useless
Please enter a command: show_game
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(ck[@i_184], kp_146[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            let k1': key = keyderivation(kp_146[@i_184], un1) in
            let k2': key = keyderivation(kp_146[@i_184], un2) in
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if checkmac(y', k2', ck[@i_184]) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_206: timest;
            new r7_207: symseed;
            let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
            event partCT(hostT, TGT_58, e5);
            new n3_208: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_209: timest;
            new r2_210: symseed;
            let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(ck[@i_183], r_249[@i_183], r_252[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            find  suchthat defined(ck[@i_183], r_249[@i_183], r_252[@i_183]) then
              find  suchthat defined(ck[@i_183], r_249[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', r_249[@i_183], ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_252[@i_183]) in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_309: timest;
                new r7_310: symseed;
                let e5: maxmac = encsym(pad(C, tc_309), AK_60, r7_310) in
                event partCT(hostT, TGT_58, e5);
                new n3_311: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_312: timest;
                new r2_313: symseed;
                let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_270 <= N suchthat defined(r_255[@i_270], @i_183[@i_270]) && (@i_183[@i_270] = @i_183) then
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', r_255[@i_270], ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_252[@i_183]) in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_314: timest;
                new r7_315: symseed;
                let e5: maxmac = encsym(pad(C, tc_314), AK_60, r7_315) in
                event partCT(hostT, TGT_58, e5);
                new n3_316: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_316));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_316, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_316, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_317: timest;
                new r2_318: symseed;
                let e12: maxmac = encsym(pad(C, tc'_317), SK_63, r2_318) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_317)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_273 <= N suchthat defined(r_258[@i_273], @i_183[@i_273]) && (@i_183[@i_273] = @i_183) then
              find  suchthat defined(ck[@i_183], r_249[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', r_249[@i_183], ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_258[@i_273]) in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_319: timest;
                new r7_320: symseed;
                let e5: maxmac = encsym(pad(C, tc_319), AK_60, r7_320) in
                event partCT(hostT, TGT_58, e5);
                new n3_321: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_321));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_321, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_321, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_322: timest;
                new r2_323: symseed;
                let e12: maxmac = encsym(pad(C, tc'_322), SK_63, r2_323) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_322)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_270 <= N suchthat defined(r_255[@i_270], @i_183[@i_270]) && (@i_183[@i_270] = @i_183) then
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', r_255[@i_270], ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_258[@i_273]) in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_324: timest;
                new r7_325: symseed;
                let e5: maxmac = encsym(pad(C, tc_324), AK_60, r7_325) in
                event partCT(hostT, TGT_58, e5);
                new n3_326: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_326));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_326, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_326, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_327: timest;
                new r2_328: symseed;
                let e12: maxmac = encsym(pad(C, tc'_327), SK_63, r2_328) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_327)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new kp_146: protkey;
            let k1: key = keyderivation(kp_146, un1) in
            let k2: key = keyderivation(kp_146, un2) in
            new tk_148: timest;
            new r4_147: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new s_253: symkeyseed;
            let r_252: key = kgen(s_253) in
            new s_250: symkeyseed;
            let r_249: key = kgen(s_250) in
            new tk_155: timest;
            new r4_154: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), r_252, r5_156) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, r_249) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new tt_51: timest;
        new r10: symseed;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)

Please enter a command: simplify
Doing simplify
Run simplify 2 time(s). Fixpoint reached.
Please enter a command: show_game
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(ck[@i_184], kp_146[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            let k1': key = keyderivation(kp_146[@i_184], un1) in
            let k2': key = keyderivation(kp_146[@i_184], un2) in
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if checkmac(y', k2', ck[@i_184]) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_206: timest;
            new r7_207: symseed;
            let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
            event partCT(hostT, TGT_58, e5);
            new n3_208: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_209: timest;
            new r2_210: symseed;
            let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(r_252[@i_183], ck[@i_183], r_249[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(r_252[@i_183], ck[@i_183], r_249[@i_183]) then
            if defined(r_252[@i_183], ck[@i_183], r_249[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if checkmac(y', r_249[@i_183], ck[@i_183]) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_252[@i_183]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_309: timest;
            new r7_310: symseed;
            let e5: maxmac = encsym(pad(C, tc_309), AK_60, r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_312: timest;
            new r2_313: symseed;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new kp_146: protkey;
            let k1: key = keyderivation(kp_146, un1) in
            let k2: key = keyderivation(kp_146, un2) in
            new tk_148: timest;
            new r4_147: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new s_253: symkeyseed;
            let r_252: key = kgen(s_253) in
            new s_250: symkeyseed;
            let r_249: key = kgen(s_250) in
            new tk_155: timest;
            new r4_154: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), r_252, r5_156) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, r_249) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new tt_51: timest;
        new r10: symseed;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)

Please enter a command: crypto keyderivation
Doing equivalence
equiv ! !_31 <= N2 new z: protkey; ! !_32 <= N (x: usenum) -> keyderivation(z, x)
<=(N2 * pPRF(time, N))=>
      ! !_33 <= N2 ! !_34 <= N (x_77: usenum) -> let x: usenum = x_77 in find u <= N suchthat defined(x[u], r[u]) && (x = x[u]) then r[u] else new s: symkeyseed; let r: key = kgen(s) in r

Doing simplify
Run simplify 2 time(s). Maximum reached.
Doing move new all binders
Doing remove assignments of useless
Please enter a command: simplify
Doing simplify
Run simplify 2 time(s). Fixpoint reached.
Please enter a command: show_game
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(r_364[@i_184], ck[@i_184], r_361[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(r_364[@i_184], ck[@i_184], r_361[@i_184]) then
            if defined(r_364[@i_184], ck[@i_184], r_361[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if checkmac(y', r_361[@i_184], ck[@i_184]) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_364[@i_184]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_549: symseed;
            new tc_550: timest;
            let e5: maxmac = encsym(pad(C, tc_550), AK_60, r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_552: symseed;
            new tc'_553: timest;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(r_252[@i_183], ck[@i_183], r_249[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(r_252[@i_183], ck[@i_183], r_249[@i_183]) then
            if defined(r_252[@i_183], ck[@i_183], r_249[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if checkmac(y', r_249[@i_183], ck[@i_183]) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_252[@i_183]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_310: symseed;
            new tc_309: timest;
            let e5: maxmac = encsym(pad(C, tc_309), AK_60, r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_313: symseed;
            new tc'_312: timest;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new s_365: symkeyseed;
            let r_364: key = kgen(s_365) in
            new s_362: symkeyseed;
            let r_361: key = kgen(s_362) in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), r_364, r5_149) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, r_361) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new s_253: symkeyseed;
            let r_252: key = kgen(s_253) in
            new s_250: symkeyseed;
            let r_249: key = kgen(s_250) in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), r_252, r5_156) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, r_249) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)

Please enter a command: auto
Doing equivalence
equiv ! !_31 <= N2 new z: protkey; ! !_32 <= N (x: usenum) -> keyderivation(z, x)
<=(N2 * pPRF(time, N))=>
      ! !_33 <= N2 ! !_34 <= N (x_77: usenum) -> let x: usenum = x_77 in find u <= N suchthat defined(x[u], r[u]) && (x = x[u]) then r[u] else new s: symkeyseed; let r: key = kgen(s) in r

Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)

Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)

Doing equivalence
equiv ! !_15 <= N2 new r: symkeyseed; ! !_16 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen2(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_17 <= N2 new r: symkeyseed; ! !_18 <= N new r2: symseed; (x: maxenc) -> encsym2(Z2(x), kgen2(r), r2)

Doing equivalence
equiv ! !_7 <= N3 new r: skeyseed; (
  () -> spkgen(r),
  ! !_8 <= N2 new r2: sseed; (x: sblocksize) -> sign(x, sskgen(r), r2)), ! !_9 <= N4 (m: sblocksize, y: spkey, si: signature) -> check(m, y, si) [all]
<=(N3 * Psign(time, N2))=>
      ! !_10 <= N3 new r: skeyseed; (
  () -> spkgen2(r),
  ! !_11 <= N2 new r2: sseed; (x_80: sblocksize) -> let x: sblocksize = x_80 in sign2(x, sskgen2(r), r2)), ! !_12 <= N4 (m: sblocksize, y: spkey, si: signature) -> find j <= N2, k_14 <= N3 suchthat defined(x[j, k_14], r[k_14]) && ((y = spkgen2(r[k_14])) && ((m = x[j, k_14]) && check2(m, y, si))) then true else find k_13 <= N3 suchthat defined(r[k_13]) && (y = spkgen2(r[k_13])) then false else check(m, y, si)

Doing equivalence
equiv ! !_1 <= N3 new r: keyseed; (
  () -> pkgen(r),
  ! !_2 <= N2 (m: bitstring) -> dec(m, skgen(r))), ! !_3 <= N4 new r2: seed; (x: blocksize, y: pkey) -> enc(x, y, r2) [all]
<=(N3 * N4 * Penc(time, N2))=>
      ! !_4 <= N3 new r: keyseed; (
  () -> pkgen2(r),
  ! !_5 <= N2 (m: bitstring) -> find j <= N4 suchthat defined(m2[j], y[j], x[j]) && ((y[j] = pkgen2(r)) && (m = m2[j])) then injbot1(x[j]) else dec2(m, skgen2(r))), ! !_6 <= N4 new r2: seed; new r3: seed; (x_82: blocksize, y_81: pkey) -> let x: blocksize = x_82 in let y: pkey = y_81 in find k <= N3 suchthat defined(r[k]) && (y = pkgen2(r[k])) then let m2: bitstring = enc2(Z, y, r2) in m2 else enc(x, y, r3)

Doing remove assignments of binder SK_50
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with rSK
Doing remove assignments of binder r_249
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with s_250
Doing simplify
Run simplify 2 time(s). Maximum reached.
Eliminated collisions between n2 and n2 Probability: 0.5 * N * N / |nonce|
Doing move new all binders
Doing remove assignments of useless
Doing equivalence
equiv ! !_31 <= N2 new z: protkey; ! !_32 <= N (x: usenum) -> keyderivation(z, x)
<=(N2 * pPRF(time, N))=>
      ! !_33 <= N2 ! !_34 <= N (x_77: usenum) -> let x: usenum = x_77 in find u <= N suchthat defined(x[u], r[u]) && (x = x[u]) then r[u] else new s: symkeyseed; let r: key = kgen(s) in r

Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)

Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)

Doing equivalence
equiv ! !_15 <= N2 new r: symkeyseed; ! !_16 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen2(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_17 <= N2 new r: symkeyseed; ! !_18 <= N new r2: symseed; (x: maxenc) -> encsym2(Z2(x), kgen2(r), r2)

Doing equivalence
equiv ! !_7 <= N3 new r: skeyseed; (
  () -> spkgen(r),
  ! !_8 <= N2 new r2: sseed; (x: sblocksize) -> sign(x, sskgen(r), r2)), ! !_9 <= N4 (m: sblocksize, y: spkey, si: signature) -> check(m, y, si) [all]
<=(N3 * Psign(time, N2))=>
      ! !_10 <= N3 new r: skeyseed; (
  () -> spkgen2(r),
  ! !_11 <= N2 new r2: sseed; (x_80: sblocksize) -> let x: sblocksize = x_80 in sign2(x, sskgen2(r), r2)), ! !_12 <= N4 (m: sblocksize, y: spkey, si: signature) -> find j <= N2, k_14 <= N3 suchthat defined(x[j, k_14], r[k_14]) && ((y = spkgen2(r[k_14])) && ((m = x[j, k_14]) && check2(m, y, si))) then true else find k_13 <= N3 suchthat defined(r[k_13]) && (y = spkgen2(r[k_13])) then false else check(m, y, si)

Doing equivalence
equiv ! !_1 <= N3 new r: keyseed; (
  () -> pkgen(r),
  ! !_2 <= N2 (m: bitstring) -> dec(m, skgen(r))), ! !_3 <= N4 new r2: seed; (x: blocksize, y: pkey) -> enc(x, y, r2) [all]
<=(N3 * N4 * Penc(time, N2))=>
      ! !_4 <= N3 new r: keyseed; (
  () -> pkgen2(r),
  ! !_5 <= N2 (m: bitstring) -> find j <= N4 suchthat defined(m2[j], y[j], x[j]) && ((y[j] = pkgen2(r)) && (m = m2[j])) then injbot1(x[j]) else dec2(m, skgen2(r))), ! !_6 <= N4 new r2: seed; new r3: seed; (x_82: blocksize, y_81: pkey) -> let x: blocksize = x_82 in let y: pkey = y_81 in find k <= N3 suchthat defined(r[k]) && (y = pkgen2(r[k])) then let m2: bitstring = enc2(Z, y, r2) in m2 else enc(x, y, r3)

Doing remove assignments of binder SK_50
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with rSK
Doing remove assignments of binder r_252
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with s_253
Doing remove assignments of binder AK_54
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with s3_152
Doing remove assignments of binder r_361
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with s_362
Doing simplify
Run simplify 2 time(s). Maximum reached.
Doing move new all binders
Doing remove assignments of useless
Doing equivalence
equiv ! !_31 <= N2 new z: protkey; ! !_32 <= N (x: usenum) -> keyderivation(z, x)
<=(N2 * pPRF(time, N))=>
      ! !_33 <= N2 ! !_34 <= N (x_77: usenum) -> let x: usenum = x_77 in find u <= N suchthat defined(x[u], r[u]) && (x = x[u]) then r[u] else new s: symkeyseed; let r: key = kgen(s) in r

Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)

Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)

Doing equivalence
equiv ! !_15 <= N2 new r: symkeyseed; ! !_16 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen2(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_17 <= N2 new r: symkeyseed; ! !_18 <= N new r2: symseed; (x: maxenc) -> encsym2(Z2(x), kgen2(r), r2)

Doing equivalence
equiv ! !_7 <= N3 new r: skeyseed; (
  () -> spkgen(r),
  ! !_8 <= N2 new r2: sseed; (x: sblocksize) -> sign(x, sskgen(r), r2)), ! !_9 <= N4 (m: sblocksize, y: spkey, si: signature) -> check(m, y, si) [all]
<=(N3 * Psign(time, N2))=>
      ! !_10 <= N3 new r: skeyseed; (
  () -> spkgen2(r),
  ! !_11 <= N2 new r2: sseed; (x_80: sblocksize) -> let x: sblocksize = x_80 in sign2(x, sskgen2(r), r2)), ! !_12 <= N4 (m: sblocksize, y: spkey, si: signature) -> find j <= N2, k_14 <= N3 suchthat defined(x[j, k_14], r[k_14]) && ((y = spkgen2(r[k_14])) && ((m = x[j, k_14]) && check2(m, y, si))) then true else find k_13 <= N3 suchthat defined(r[k_13]) && (y = spkgen2(r[k_13])) then false else check(m, y, si)

Doing equivalence
equiv ! !_1 <= N3 new r: keyseed; (
  () -> pkgen(r),
  ! !_2 <= N2 (m: bitstring) -> dec(m, skgen(r))), ! !_3 <= N4 new r2: seed; (x: blocksize, y: pkey) -> enc(x, y, r2) [all]
<=(N3 * N4 * Penc(time, N2))=>
      ! !_4 <= N3 new r: keyseed; (
  () -> pkgen2(r),
  ! !_5 <= N2 (m: bitstring) -> find j <= N4 suchthat defined(m2[j], y[j], x[j]) && ((y[j] = pkgen2(r)) && (m = m2[j])) then injbot1(x[j]) else dec2(m, skgen2(r))), ! !_6 <= N4 new r2: seed; new r3: seed; (x_82: blocksize, y_81: pkey) -> let x: blocksize = x_82 in let y: pkey = y_81 in find k <= N3 suchthat defined(r[k]) && (y = pkgen2(r[k])) then let m2: bitstring = enc2(Z, y, r2) in m2 else enc(x, y, r3)

Doing remove assignments of binder SK_50
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with rSK
Doing remove assignments of binder r_252
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with s_253
Doing remove assignments of binder AK_54
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with s3_152
Doing remove assignments of binder r_364
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with s_365
Doing remove assignments of binder AK_54
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with s3_145
Doing remove assignments of binder Ks
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with rKs
Doing remove assignments of binder Kt
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with rKt
Doing remove assignments of binder SK_44
Doing remove assignments of binder AK_49
Doing remove assignments of binder Pkey
Doing SA rename Pkey
Doing remove assignments of binder Pkey_744
Doing remove assignments of binder Pkey_743
Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with r10
Doing remove assignments of binder SK_50
Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with rSK
Doing remove assignments of binder r_252
Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with r5_156
Doing simplify
Run simplify 2 time(s). Fixpoint reached.
Eliminated collisions between injbot2(concat4(?, n1[!_35], ?, ?)) and bottom Probability: N / |nonce|
(injbot2(concat4(?, n1[!_35], ?, ?)) characterizes a part of n1[!_35] of type(s) nonce;
 bottom does not depend on n1[!_35])
Doing move new all binders
Doing remove assignments of useless
Doing equivalence
equiv ! !_31 <= N2 new z: protkey; ! !_32 <= N (x: usenum) -> keyderivation(z, x)
<=(N2 * pPRF(time, N))=>
      ! !_33 <= N2 ! !_34 <= N (x_77: usenum) -> let x: usenum = x_77 in find u <= N suchthat defined(x[u], r[u]) && (x = x[u]) then r[u] else new s: symkeyseed; let r: key = kgen(s) in r

Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)

Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)

Doing equivalence
equiv ! !_15 <= N2 new r: symkeyseed; ! !_16 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen2(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_17 <= N2 new r: symkeyseed; ! !_18 <= N new r2: symseed; (x: maxenc) -> encsym2(Z2(x), kgen2(r), r2)

Doing simplify
Run simplify 2 time(s). Fixpoint reached.
Doing move new all binders
Doing remove assignments of useless
Doing equivalence
equiv ! !_31 <= N2 new z: protkey; ! !_32 <= N (x: usenum) -> keyderivation(z, x)
<=(N2 * pPRF(time, N))=>
      ! !_33 <= N2 ! !_34 <= N (x_77: usenum) -> let x: usenum = x_77 in find u <= N suchthat defined(x[u], r[u]) && (x = x[u]) then r[u] else new s: symkeyseed; let r: key = kgen(s) in r

Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)

Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)

Doing equivalence
equiv ! !_15 <= N2 new r: symkeyseed; ! !_16 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen2(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_17 <= N2 new r: symkeyseed; ! !_18 <= N new r2: symseed; (x: maxenc) -> encsym2(Z2(x), kgen2(r), r2)

Doing equivalence
equiv ! !_7 <= N3 new r: skeyseed; (
  () -> spkgen(r),
  ! !_8 <= N2 new r2: sseed; (x: sblocksize) -> sign(x, sskgen(r), r2)), ! !_9 <= N4 (m: sblocksize, y: spkey, si: signature) -> check(m, y, si) [all]
<=(N3 * Psign(time, N2))=>
      ! !_10 <= N3 new r: skeyseed; (
  () -> spkgen2(r),
  ! !_11 <= N2 new r2: sseed; (x_80: sblocksize) -> let x: sblocksize = x_80 in sign2(x, sskgen2(r), r2)), ! !_12 <= N4 (m: sblocksize, y: spkey, si: signature) -> find j <= N2, k_14 <= N3 suchthat defined(x[j, k_14], r[k_14]) && ((y = spkgen2(r[k_14])) && ((m = x[j, k_14]) && check2(m, y, si))) then true else find k_13 <= N3 suchthat defined(r[k_13]) && (y = spkgen2(r[k_13])) then false else check(m, y, si)

Doing equivalence
equiv ! !_1 <= N3 new r: keyseed; (
  () -> pkgen(r),
  ! !_2 <= N2 (m: bitstring) -> dec(m, skgen(r))), ! !_3 <= N4 new r2: seed; (x: blocksize, y: pkey) -> enc(x, y, r2) [all]
<=(N3 * N4 * Penc(time, N2))=>
      ! !_4 <= N3 new r: keyseed; (
  () -> pkgen2(r),
  ! !_5 <= N2 (m: bitstring) -> find j <= N4 suchthat defined(m2[j], y[j], x[j]) && ((y[j] = pkgen2(r)) && (m = m2[j])) then injbot1(x[j]) else dec2(m, skgen2(r))), ! !_6 <= N4 new r2: seed; new r3: seed; (x_82: blocksize, y_81: pkey) -> let x: blocksize = x_82 in let y: pkey = y_81 in find k <= N3 suchthat defined(r[k]) && (y = pkgen2(r[k])) then let m2: bitstring = enc2(Z, y, r2) in m2 else enc(x, y, r3)

Doing remove assignments of binder SK_50
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with rSK
Doing remove assignments of binder AK_54
Doing SA rename AK_54
Doing remove assignments of binder AK_880
Doing remove assignments of binder AK_879
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with s3_152
Doing remove assignments of binder r_364
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with s_365
Doing remove assignments of binder AK_54
Doing SA rename AK_54
Doing remove assignments of binder AK_882
Doing remove assignments of binder AK_881
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with s3_145
Doing remove assignments of binder Ks
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with rKs
Doing remove assignments of binder Kt
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with rKt
Doing remove assignments of binder SK_44
Doing remove assignments of binder AK_49
Doing remove assignments of binder Pkey
Doing SA rename Pkey
Doing remove assignments of binder Pkey_884
Doing remove assignments of binder Pkey_883
Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with r10
Doing remove assignments of binder SK_50
Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with rSK
Doing remove assignments of binder Qkey
Doing SA rename Qkey
Doing remove assignments of binder Qkey_894
Doing remove assignments of binder Qkey_893
Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with r4_154
Doing remove assignments of binder AK_54
Doing SA rename AK_54
Doing remove assignments of binder AK_920
Doing remove assignments of binder AK_919
Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with s3_152
Doing remove assignments of binder r_364
Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with r5_149
Doing simplify
Run simplify 2 time(s). Fixpoint reached.
Eliminated collisions between injbot2(concat4(?, n1[!_35], ?, ?)) and bottom Probability: N / |nonce|
(injbot2(concat4(?, n1[!_35], ?, ?)) characterizes a part of n1[!_35] of type(s) nonce;
 bottom does not depend on n1[!_35])
Doing move new all binders
Doing remove assignments of useless
Eliminated collisions between n1 and n1 Probability: 0.5 * N * N / |nonce|
Proved query event inj:fullCK(K, T, N, w, x, y) ==> inj:fullKC(C, T, N, w, z, y) Probability: 0.5 * N * N / |nonce|
Doing equivalence
equiv ! !_31 <= N2 new z: protkey; ! !_32 <= N (x: usenum) -> keyderivation(z, x)
<=(N2 * pPRF(time, N))=>
      ! !_33 <= N2 ! !_34 <= N (x_77: usenum) -> let x: usenum = x_77 in find u <= N suchthat defined(x[u], r[u]) && (x = x[u]) then r[u] else new s: symkeyseed; let r: key = kgen(s) in r

Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)

Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)

Doing equivalence
equiv ! !_15 <= N2 new r: symkeyseed; ! !_16 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen2(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_17 <= N2 new r: symkeyseed; ! !_18 <= N new r2: symseed; (x: maxenc) -> encsym2(Z2(x), kgen2(r), r2)

Doing simplify
Run simplify 2 time(s). Fixpoint reached.
Doing move new all binders
Doing remove assignments of useless
Doing equivalence
equiv ! !_31 <= N2 new z: protkey; ! !_32 <= N (x: usenum) -> keyderivation(z, x)
<=(N2 * pPRF(time, N))=>
      ! !_33 <= N2 ! !_34 <= N (x_77: usenum) -> let x: usenum = x_77 in find u <= N suchthat defined(x[u], r[u]) && (x = x[u]) then r[u] else new s: symkeyseed; let r: key = kgen(s) in r

Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)

Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)

Doing equivalence
equiv ! !_15 <= N2 new r: symkeyseed; ! !_16 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen2(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_17 <= N2 new r: symkeyseed; ! !_18 <= N new r2: symseed; (x: maxenc) -> encsym2(Z2(x), kgen2(r), r2)

Doing equivalence
equiv ! !_7 <= N3 new r: skeyseed; (
  () -> spkgen(r),
  ! !_8 <= N2 new r2: sseed; (x: sblocksize) -> sign(x, sskgen(r), r2)), ! !_9 <= N4 (m: sblocksize, y: spkey, si: signature) -> check(m, y, si) [all]
<=(N3 * Psign(time, N2))=>
      ! !_10 <= N3 new r: skeyseed; (
  () -> spkgen2(r),
  ! !_11 <= N2 new r2: sseed; (x_80: sblocksize) -> let x: sblocksize = x_80 in sign2(x, sskgen2(r), r2)), ! !_12 <= N4 (m: sblocksize, y: spkey, si: signature) -> find j <= N2, k_14 <= N3 suchthat defined(x[j, k_14], r[k_14]) && ((y = spkgen2(r[k_14])) && ((m = x[j, k_14]) && check2(m, y, si))) then true else find k_13 <= N3 suchthat defined(r[k_13]) && (y = spkgen2(r[k_13])) then false else check(m, y, si)

Doing equivalence
equiv ! !_1 <= N3 new r: keyseed; (
  () -> pkgen(r),
  ! !_2 <= N2 (m: bitstring) -> dec(m, skgen(r))), ! !_3 <= N4 new r2: seed; (x: blocksize, y: pkey) -> enc(x, y, r2) [all]
<=(N3 * N4 * Penc(time, N2))=>
      ! !_4 <= N3 new r: keyseed; (
  () -> pkgen2(r),
  ! !_5 <= N2 (m: bitstring) -> find j <= N4 suchthat defined(m2[j], y[j], x[j]) && ((y[j] = pkgen2(r)) && (m = m2[j])) then injbot1(x[j]) else dec2(m, skgen2(r))), ! !_6 <= N4 new r2: seed; new r3: seed; (x_82: blocksize, y_81: pkey) -> let x: blocksize = x_82 in let y: pkey = y_81 in find k <= N3 suchthat defined(r[k]) && (y = pkgen2(r[k])) then let m2: bitstring = enc2(Z, y, r2) in m2 else enc(x, y, r3)

Doing remove assignments of binder SK_50
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with rSK
Doing remove assignments of binder AK_54
Doing SA rename AK_54
Doing remove assignments of binder AK_1059
Doing remove assignments of binder AK_1058
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with s3_152
Doing remove assignments of binder AK_54
Doing SA rename AK_54
Doing remove assignments of binder AK_1061
Doing remove assignments of binder AK_1060
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with s3_145
Doing remove assignments of binder Ks
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with rKs
Doing remove assignments of binder Kt
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with rKt
Doing remove assignments of binder SK_44
Doing remove assignments of binder AK_49
Doing remove assignments of binder Pkey
Doing SA rename Pkey
Doing remove assignments of binder Pkey_1063
Doing remove assignments of binder Pkey_1062
Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with r10
Doing remove assignments of binder SK_50
Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with rSK
Doing remove assignments of binder Qkey
Doing SA rename Qkey
Doing remove assignments of binder Qkey_1073
Doing remove assignments of binder Qkey_1072
Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with r4_154
Doing remove assignments of binder AK_54
Doing SA rename AK_54
Doing remove assignments of binder AK_1099
Doing remove assignments of binder AK_1098
Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with s3_152
Doing remove assignments of binder Qkey
Doing SA rename Qkey
Doing remove assignments of binder Qkey_1101
Doing remove assignments of binder Qkey_1100
Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with r4_147
Doing remove assignments of binder AK_54
Doing SA rename AK_54
Doing remove assignments of binder AK_1127
Doing remove assignments of binder AK_1126
Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with s3_145
Doing remove assignments of binder SK_63
Doing remove assignments of binder AK_54
Doing SA rename AK_54
Doing remove assignments of binder AK_1129
Doing remove assignments of binder AK_1128
Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with r7_310
Doing remove assignments of binder SK_63
Doing remove assignments of binder AK_54
Doing SA rename AK_54
Doing remove assignments of binder AK_1135
Doing remove assignments of binder AK_1134
Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with r7_549
Doing remove assignments of binder Ks
Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with rKs
Doing remove assignments of binder Pkey
Doing SA rename Pkey
Doing remove assignments of binder Pkey_1141
Doing remove assignments of binder Pkey_1140
Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with rKs
Doing simplify
Run simplify 2 time(s). Fixpoint reached.
Doing move new all binders
Doing remove assignments of useless
Doing equivalence
equiv ! !_31 <= N2 new z: protkey; ! !_32 <= N (x: usenum) -> keyderivation(z, x)
<=(N2 * pPRF(time, N))=>
      ! !_33 <= N2 ! !_34 <= N (x_77: usenum) -> let x: usenum = x_77 in find u <= N suchthat defined(x[u], r[u]) && (x = x[u]) then r[u] else new s: symkeyseed; let r: key = kgen(s) in r

Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)

Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)

Doing equivalence
equiv ! !_15 <= N2 new r: symkeyseed; ! !_16 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen2(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_17 <= N2 new r: symkeyseed; ! !_18 <= N new r2: symseed; (x: maxenc) -> encsym2(Z2(x), kgen2(r), r2)

Doing simplify
Run simplify 2 time(s). Fixpoint reached.
Doing move new all binders
Doing remove assignments of useless
Doing equivalence
equiv ! !_31 <= N2 new z: protkey; ! !_32 <= N (x: usenum) -> keyderivation(z, x)
<=(N2 * pPRF(time, N))=>
      ! !_33 <= N2 ! !_34 <= N (x_77: usenum) -> let x: usenum = x_77 in find u <= N suchthat defined(x[u], r[u]) && (x = x[u]) then r[u] else new s: symkeyseed; let r: key = kgen(s) in r

Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)

Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)

Doing equivalence
equiv ! !_15 <= N2 new r: symkeyseed; ! !_16 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen2(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_17 <= N2 new r: symkeyseed; ! !_18 <= N new r2: symseed; (x: maxenc) -> encsym2(Z2(x), kgen2(r), r2)

Doing equivalence
equiv ! !_7 <= N3 new r: skeyseed; (
  () -> spkgen(r),
  ! !_8 <= N2 new r2: sseed; (x: sblocksize) -> sign(x, sskgen(r), r2)), ! !_9 <= N4 (m: sblocksize, y: spkey, si: signature) -> check(m, y, si) [all]
<=(N3 * Psign(time, N2))=>
      ! !_10 <= N3 new r: skeyseed; (
  () -> spkgen2(r),
  ! !_11 <= N2 new r2: sseed; (x_80: sblocksize) -> let x: sblocksize = x_80 in sign2(x, sskgen2(r), r2)), ! !_12 <= N4 (m: sblocksize, y: spkey, si: signature) -> find j <= N2, k_14 <= N3 suchthat defined(x[j, k_14], r[k_14]) && ((y = spkgen2(r[k_14])) && ((m = x[j, k_14]) && check2(m, y, si))) then true else find k_13 <= N3 suchthat defined(r[k_13]) && (y = spkgen2(r[k_13])) then false else check(m, y, si)

Doing equivalence
equiv ! !_1 <= N3 new r: keyseed; (
  () -> pkgen(r),
  ! !_2 <= N2 (m: bitstring) -> dec(m, skgen(r))), ! !_3 <= N4 new r2: seed; (x: blocksize, y: pkey) -> enc(x, y, r2) [all]
<=(N3 * N4 * Penc(time, N2))=>
      ! !_4 <= N3 new r: keyseed; (
  () -> pkgen2(r),
  ! !_5 <= N2 (m: bitstring) -> find j <= N4 suchthat defined(m2[j], y[j], x[j]) && ((y[j] = pkgen2(r)) && (m = m2[j])) then injbot1(x[j]) else dec2(m, skgen2(r))), ! !_6 <= N4 new r2: seed; new r3: seed; (x_82: blocksize, y_81: pkey) -> let x: blocksize = x_82 in let y: pkey = y_81 in find k <= N3 suchthat defined(r[k]) && (y = pkgen2(r[k])) then let m2: bitstring = enc2(Z, y, r2) in m2 else enc(x, y, r3)

Doing remove assignments of binder SK_50
Doing SA rename SK_50
Doing remove assignments of binder SK_1265
Doing remove assignments of binder SK_1264
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with rSK_1146
Doing remove assignments of binder SK_50
Doing SA rename SK_50
Doing remove assignments of binder SK_1267
Doing remove assignments of binder SK_1266
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with rSK_1142
Doing remove assignments of binder AK_54
Doing SA rename AK_54
Doing remove assignments of binder AK_1269
Doing remove assignments of binder AK_1268
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with s3_152
Doing remove assignments of binder AK_54
Doing SA rename AK_54
Doing remove assignments of binder AK_1271
Doing remove assignments of binder AK_1270
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with s3_145
Doing remove assignments of binder Kt
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with rKt
Doing remove assignments of binder SK_50
Doing SA rename SK_50
Doing remove assignments of binder SK_1273
Doing remove assignments of binder SK_1272
Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with r16
Doing remove assignments of binder AK_49
Doing remove assignments of binder SK_50
Doing SA rename SK_50
Doing remove assignments of binder SK_1278
Doing remove assignments of binder SK_1277
Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with rSK_1146
Doing remove assignments of binder AK_49
Doing remove assignments of binder Mkey
Doing remove assignments of binder SK_50
Doing SA rename SK_50
Doing remove assignments of binder SK_1283
Doing remove assignments of binder SK_1282
Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with rSK_1142
Doing remove assignments of binder Qkey
Doing SA rename Qkey
Doing remove assignments of binder Qkey_1285
Doing remove assignments of binder Qkey_1284
Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with r4_154
Doing remove assignments of binder AK_54
Doing SA rename AK_54
Doing remove assignments of binder AK_1311
Doing remove assignments of binder AK_1310
Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with s3_152
Doing remove assignments of binder Qkey
Doing SA rename Qkey
Doing remove assignments of binder Qkey_1313
Doing remove assignments of binder Qkey_1312
Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with r4_147
Doing remove assignments of binder AK_54
Doing SA rename AK_54
Doing remove assignments of binder AK_1339
Doing remove assignments of binder AK_1338
Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with s3_145
Doing remove assignments of binder SK_63
Doing remove assignments of binder AK_54
Doing SA rename AK_54
Doing remove assignments of binder AK_1341
Doing remove assignments of binder AK_1340
Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with r7_310
Doing remove assignments of binder SK_63
Doing remove assignments of binder AK_54
Doing SA rename AK_54
Doing remove assignments of binder AK_1347
Doing remove assignments of binder AK_1346
Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with r7_549
Doing remove assignments of binder Kt
Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with rKt
Doing remove assignments of binder Qkey
Doing SA rename Qkey
Doing remove assignments of binder Qkey_1353
Doing remove assignments of binder Qkey_1352
Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with rKt
Doing simplify
Run simplify 2 time(s). Fixpoint reached.
Doing move new all binders
Doing remove assignments of useless
Doing equivalence
equiv ! !_31 <= N2 new z: protkey; ! !_32 <= N (x: usenum) -> keyderivation(z, x)
<=(N2 * pPRF(time, N))=>
      ! !_33 <= N2 ! !_34 <= N (x_77: usenum) -> let x: usenum = x_77 in find u <= N suchthat defined(x[u], r[u]) && (x = x[u]) then r[u] else new s: symkeyseed; let r: key = kgen(s) in r

Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)

Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)

Doing equivalence
equiv ! !_15 <= N2 new r: symkeyseed; ! !_16 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen2(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_17 <= N2 new r: symkeyseed; ! !_18 <= N new r2: symseed; (x: maxenc) -> encsym2(Z2(x), kgen2(r), r2)

Doing simplify
Run simplify 2 time(s). Fixpoint reached.
Doing move new all binders
Doing remove assignments of useless
Doing equivalence
equiv ! !_31 <= N2 new z: protkey; ! !_32 <= N (x: usenum) -> keyderivation(z, x)
<=(N2 * pPRF(time, N))=>
      ! !_33 <= N2 ! !_34 <= N (x_77: usenum) -> let x: usenum = x_77 in find u <= N suchthat defined(x[u], r[u]) && (x = x[u]) then r[u] else new s: symkeyseed; let r: key = kgen(s) in r

Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)

Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)

Doing equivalence
equiv ! !_15 <= N2 new r: symkeyseed; ! !_16 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen2(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_17 <= N2 new r: symkeyseed; ! !_18 <= N new r2: symseed; (x: maxenc) -> encsym2(Z2(x), kgen2(r), r2)

Doing equivalence
equiv ! !_7 <= N3 new r: skeyseed; (
  () -> spkgen(r),
  ! !_8 <= N2 new r2: sseed; (x: sblocksize) -> sign(x, sskgen(r), r2)), ! !_9 <= N4 (m: sblocksize, y: spkey, si: signature) -> check(m, y, si) [all]
<=(N3 * Psign(time, N2))=>
      ! !_10 <= N3 new r: skeyseed; (
  () -> spkgen2(r),
  ! !_11 <= N2 new r2: sseed; (x_80: sblocksize) -> let x: sblocksize = x_80 in sign2(x, sskgen2(r), r2)), ! !_12 <= N4 (m: sblocksize, y: spkey, si: signature) -> find j <= N2, k_14 <= N3 suchthat defined(x[j, k_14], r[k_14]) && ((y = spkgen2(r[k_14])) && ((m = x[j, k_14]) && check2(m, y, si))) then true else find k_13 <= N3 suchthat defined(r[k_13]) && (y = spkgen2(r[k_13])) then false else check(m, y, si)

Doing equivalence
equiv ! !_1 <= N3 new r: keyseed; (
  () -> pkgen(r),
  ! !_2 <= N2 (m: bitstring) -> dec(m, skgen(r))), ! !_3 <= N4 new r2: seed; (x: blocksize, y: pkey) -> enc(x, y, r2) [all]
<=(N3 * N4 * Penc(time, N2))=>
      ! !_4 <= N3 new r: keyseed; (
  () -> pkgen2(r),
  ! !_5 <= N2 (m: bitstring) -> find j <= N4 suchthat defined(m2[j], y[j], x[j]) && ((y[j] = pkgen2(r)) && (m = m2[j])) then injbot1(x[j]) else dec2(m, skgen2(r))), ! !_6 <= N4 new r2: seed; new r3: seed; (x_82: blocksize, y_81: pkey) -> let x: blocksize = x_82 in let y: pkey = y_81 in find k <= N3 suchthat defined(r[k]) && (y = pkgen2(r[k])) then let m2: bitstring = enc2(Z, y, r2) in m2 else enc(x, y, r3)

Doing remove assignments of binder SK_50
Doing SA rename SK_50
Doing remove assignments of binder SK_1516
Doing remove assignments of binder SK_1515
Doing remove assignments of binder SK_1514
Doing remove assignments of binder SK_1513
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with rSK_1431
Doing remove assignments of binder SK_50
Doing SA rename SK_50
Doing remove assignments of binder SK_1522
Doing remove assignments of binder SK_1521
Doing remove assignments of binder SK_1520
Doing remove assignments of binder SK_1519
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with rSK_1427
Doing remove assignments of binder SK_50
Doing SA rename SK_50
Doing remove assignments of binder SK_1528
Doing remove assignments of binder SK_1527
Doing remove assignments of binder SK_1526
Doing remove assignments of binder SK_1525
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with rSK_1423
Doing remove assignments of binder SK_50
Doing SA rename SK_50
Doing remove assignments of binder SK_1534
Doing remove assignments of binder SK_1533
Doing remove assignments of binder SK_1532
Doing remove assignments of binder SK_1531
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with rSK_1419
Doing remove assignments of binder AK_54
Doing SA rename AK_54
Doing remove assignments of binder AK_1540
Doing remove assignments of binder AK_1539
Doing remove assignments of binder AK_1538
Doing remove assignments of binder AK_1537
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with s3_1372
Doing remove assignments of binder AK_54
Doing SA rename AK_54
Doing remove assignments of binder AK_1864
Doing remove assignments of binder AK_1863
Doing remove assignments of binder AK_1862
Doing remove assignments of binder AK_1861
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with s3_1366
Doing remove assignments of binder AK_54
Doing SA rename AK_54
Doing remove assignments of binder AK_2188
Doing remove assignments of binder AK_2187
Doing remove assignments of binder AK_2186
Doing remove assignments of binder AK_2185
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with s3_1360
Doing remove assignments of binder AK_54
Doing SA rename AK_54
Doing remove assignments of binder AK_2512
Doing remove assignments of binder AK_2511
Doing remove assignments of binder AK_2510
Doing remove assignments of binder AK_2509
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with s3_1354
Doing remove assignments of binder SK_50
Doing SA rename SK_50
Doing remove assignments of binder SK_2836
Doing remove assignments of binder SK_2835
Doing remove assignments of binder SK_2834
Doing remove assignments of binder SK_2833
Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with r16
Doing remove assignments of binder AK_54
Doing SA rename AK_54
Doing remove assignments of binder AK_2842
Doing remove assignments of binder AK_2841
Doing remove assignments of binder AK_2840
Doing remove assignments of binder AK_2839
Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with r11_1433
Doing simplify
Run simplify 2 time(s). Maximum reached.
Eliminated collisions between injbot2(concat8(?, n3_3160[!_36, !_35], ?, ?)) and bottom Probability: N * N3 / |nonce|
(injbot2(concat8(?, n3_3160[!_36, !_35], ?, ?)) characterizes a part of n3_3160[!_36, !_35] of type(s) nonce;
 bottom does not depend on n3_3160[!_36, !_35])
Doing move new all binders
Doing remove assignments of useless
Doing equivalence
equiv ! !_31 <= N2 new z: protkey; ! !_32 <= N (x: usenum) -> keyderivation(z, x)
<=(N2 * pPRF(time, N))=>
      ! !_33 <= N2 ! !_34 <= N (x_77: usenum) -> let x: usenum = x_77 in find u <= N suchthat defined(x[u], r[u]) && (x = x[u]) then r[u] else new s: symkeyseed; let r: key = kgen(s) in r

Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)

Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)

Doing simplify
Run simplify 2 time(s). Maximum reached.
Eliminated collisions between n1 and n1 Probability: 0.5 * N * N / |nonce|
Eliminated collisions between injbot2(concat8(?, n3_3000[!_36, !_35], ?, ?)) and bottom Probability: N * N3 / |nonce|
(injbot2(concat8(?, n3_3000[!_36, !_35], ?, ?)) characterizes a part of n3_3000[!_36, !_35] of type(s) nonce;
 bottom does not depend on n3_3000[!_36, !_35])
Doing move new all binders
Doing remove assignments of useless
Proved query event partTC(C, x, y) ==> (partCT(T, x', y)&&fullKC(C, T, N, w, x, y'))
Eliminated collisions between n3_3160 and n3_3000 Probability: N3 * N * N3 * N / |nonce|
Eliminated collisions between n3_3160 and n3_3160 Probability: 0.5 * N3 * N * N3 * N / |nonce|
Eliminated collisions between n3_3000 and n3_3000 Probability: 0.5 * N3 * N * N3 * N / |nonce|
Proved query event inj:fullCT(T, S, N, x, z, y) ==> inj:fullTC(C, S, N, x', z', v, y) Probability: 2. * N3 * N * N3 * N / |nonce|
Doing equivalence
equiv ! !_31 <= N2 new z: protkey; ! !_32 <= N (x: usenum) -> keyderivation(z, x)
<=(N2 * pPRF(time, N))=>
      ! !_33 <= N2 ! !_34 <= N (x_77: usenum) -> let x: usenum = x_77 in find u <= N suchthat defined(x[u], r[u]) && (x = x[u]) then r[u] else new s: symkeyseed; let r: key = kgen(s) in r

Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)

Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)

Doing equivalence
equiv ! !_15 <= N2 new r: symkeyseed; ! !_16 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen2(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_17 <= N2 new r: symkeyseed; ! !_18 <= N new r2: symseed; (x: maxenc) -> encsym2(Z2(x), kgen2(r), r2)

Doing simplify
Run simplify 2 time(s). Fixpoint reached.
Doing move new all binders
Doing remove assignments of useless
Doing equivalence
equiv ! !_31 <= N2 new z: protkey; ! !_32 <= N (x: usenum) -> keyderivation(z, x)
<=(N2 * pPRF(time, N))=>
      ! !_33 <= N2 ! !_34 <= N (x_77: usenum) -> let x: usenum = x_77 in find u <= N suchthat defined(x[u], r[u]) && (x = x[u]) then r[u] else new s: symkeyseed; let r: key = kgen(s) in r

Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)

Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)

Doing equivalence
equiv ! !_15 <= N2 new r: symkeyseed; ! !_16 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen2(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_17 <= N2 new r: symkeyseed; ! !_18 <= N new r2: symseed; (x: maxenc) -> encsym2(Z2(x), kgen2(r), r2)

Doing simplify
Run simplify 2 time(s). Fixpoint reached.
Doing move new all binders
Doing remove assignments of useless
Doing equivalence
equiv ! !_31 <= N2 new z: protkey; ! !_32 <= N (x: usenum) -> keyderivation(z, x)
<=(N2 * pPRF(time, N))=>
      ! !_33 <= N2 ! !_34 <= N (x_77: usenum) -> let x: usenum = x_77 in find u <= N suchthat defined(x[u], r[u]) && (x = x[u]) then r[u] else new s: symkeyseed; let r: key = kgen(s) in r

Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)

Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)

Doing equivalence
equiv ! !_15 <= N2 new r: symkeyseed; ! !_16 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen2(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_17 <= N2 new r: symkeyseed; ! !_18 <= N new r2: symseed; (x: maxenc) -> encsym2(Z2(x), kgen2(r), r2)

Doing equivalence
equiv ! !_7 <= N3 new r: skeyseed; (
  () -> spkgen(r),
  ! !_8 <= N2 new r2: sseed; (x: sblocksize) -> sign(x, sskgen(r), r2)), ! !_9 <= N4 (m: sblocksize, y: spkey, si: signature) -> check(m, y, si) [all]
<=(N3 * Psign(time, N2))=>
      ! !_10 <= N3 new r: skeyseed; (
  () -> spkgen2(r),
  ! !_11 <= N2 new r2: sseed; (x_80: sblocksize) -> let x: sblocksize = x_80 in sign2(x, sskgen2(r), r2)), ! !_12 <= N4 (m: sblocksize, y: spkey, si: signature) -> find j <= N2, k_14 <= N3 suchthat defined(x[j, k_14], r[k_14]) && ((y = spkgen2(r[k_14])) && ((m = x[j, k_14]) && check2(m, y, si))) then true else find k_13 <= N3 suchthat defined(r[k_13]) && (y = spkgen2(r[k_13])) then false else check(m, y, si)

Doing equivalence
equiv ! !_1 <= N3 new r: keyseed; (
  () -> pkgen(r),
  ! !_2 <= N2 (m: bitstring) -> dec(m, skgen(r))), ! !_3 <= N4 new r2: seed; (x: blocksize, y: pkey) -> enc(x, y, r2) [all]
<=(N3 * N4 * Penc(time, N2))=>
      ! !_4 <= N3 new r: keyseed; (
  () -> pkgen2(r),
  ! !_5 <= N2 (m: bitstring) -> find j <= N4 suchthat defined(m2[j], y[j], x[j]) && ((y[j] = pkgen2(r)) && (m = m2[j])) then injbot1(x[j]) else dec2(m, skgen2(r))), ! !_6 <= N4 new r2: seed; new r3: seed; (x_82: blocksize, y_81: pkey) -> let x: blocksize = x_82 in let y: pkey = y_81 in find k <= N3 suchthat defined(r[k]) && (y = pkgen2(r[k])) then let m2: bitstring = enc2(Z, y, r2) in m2 else enc(x, y, r3)

Doing remove assignments of binder SK_50
Doing SA rename SK_50
Doing remove assignments of binder SK_5948
Doing remove assignments of binder SK_5947
Doing remove assignments of binder SK_5946
Doing remove assignments of binder SK_5945
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with rSK_1431
Doing remove assignments of binder SK_50
Doing SA rename SK_50
Doing remove assignments of binder SK_5954
Doing remove assignments of binder SK_5953
Doing remove assignments of binder SK_5952
Doing remove assignments of binder SK_5951
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with rSK_1427
Doing remove assignments of binder SK_50
Doing SA rename SK_50
Doing remove assignments of binder SK_5960
Doing remove assignments of binder SK_5959
Doing remove assignments of binder SK_5958
Doing remove assignments of binder SK_5957
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with rSK_1423
Doing remove assignments of binder SK_50
Doing SA rename SK_50
Doing remove assignments of binder SK_5966
Doing remove assignments of binder SK_5965
Doing remove assignments of binder SK_5964
Doing remove assignments of binder SK_5963
Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with rSK_1419
Doing remove assignments of binder SK_50
Doing SA rename SK_50
Doing remove assignments of binder SK_5972
Doing remove assignments of binder SK_5971
Doing remove assignments of binder SK_5970
Doing remove assignments of binder SK_5969
Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with r16
Doing remove assignments of binder SK_50
Doing SA rename SK_50
Doing remove assignments of binder SK_5978
Doing remove assignments of binder SK_5977
Doing remove assignments of binder SK_5976
Doing remove assignments of binder SK_5975
Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with rSK_1431
Doing simplify
Run simplify 2 time(s). Maximum reached.
Eliminated collisions between n3_3160 and n3_3160 Probability: 0.5 * N3 * N * N3 * N / |nonce|
Doing move new all binders
Doing remove assignments of useless
Doing equivalence
equiv ! !_31 <= N2 new z: protkey; ! !_32 <= N (x: usenum) -> keyderivation(z, x)
<=(N2 * pPRF(time, N))=>
      ! !_33 <= N2 ! !_34 <= N (x_77: usenum) -> let x: usenum = x_77 in find u <= N suchthat defined(x[u], r[u]) && (x = x[u]) then r[u] else new s: symkeyseed; let r: key = kgen(s) in r

Doing equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)

Doing equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)

Doing simplify
Run simplify 2 time(s). Maximum reached.
Eliminated collisions between n3_3000 and n3_3000 Probability: 0.5 * N3 * N * N3 * N / |nonce|
Doing move new all binders
Doing remove assignments of useless
Proved query event partSC(C, z, y) ==> (partCS(S, T, x, y)&&fullTC(C, S, N, v, v', z, w))
Proved query event fullCS(S, T, z, y, w) ==> fullSC(C, x, y', w)
Initial state
Game 1 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen(rkC) in
let skC: skey = skgen(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen(rkCs) in
let sskC: sskey = sskgen(rkCs) in
new rkK: keyseed;
let pkK: pkey = pkgen(rkK) in
let skK: skey = skgen(rkK) in
new rkKs: skeyseed;
let spkK: spkey = spkgen(rkKs) in
let sskK: sskey = sskgen(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen(rkCA) in
let skCA: sskey = sskgen(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
new q1: sseed;
new q2: sseed;
let certC: signature = sign(concat1(C, pkC, spkC), skCA, q1) in
let certK: signature = sign(concat7(K, pkK, spkK), skCA, q2) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n1: nonce;
          new n2: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign(padno(n2), sskC, r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          let injbot1(concat2(hostZ: kas, pkZ: pkey, spkZ: spkey, ms1: signature, k3: protkey, ck1: macs, ms2: signature)) = dec(m21, skC) in
          if check(concat7(hostZ, pkZ, spkZ), pkCA, ms1) then
          if check(concat3(k3, ck1), spkK, ms2) then
          let k1': key = keyderivation(k3, un1) in
          let k2': key = keyderivation(k3, un2) in
          let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign(padno(n2), sskC, r1), C, hostT, n1) in
          if checkmac(y', k2', ck1) then
          let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
          event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
          out(c18[!_35], acceptC1(hostZ, hostT));
          ! !_36 <= N3
          in(c17[!_36, !_35], (hosT': tgs, hostS: server));
          if (hosT' = hostT) then
          new n3: nonce;
          new tc: timest;
          new r7_61: symseed;
          let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
          event partCT(hostT, TGT_58, e5);
          out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
          in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
          let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
          event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
          out(c19[!_36, !_35], acceptC2(hostT, hostS));
          ! !_37 <= N4
          in(c20[!_37, !_36, !_35], hostS': server);
          if (hostS' = hostS) then
          new tc'_64: timest;
          new r2: symseed;
          let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
          event partCS(hostS, hostT, m7, e12);
          out(c6[!_37, !_36, !_35], (m6, e12));
          in(c9[!_37, !_36, !_35], (m13: maxmac));
          let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
          event fullCS(hostS, hostT, m7, e12, m13);
          out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          let m3: bitstring = (hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
          if check(concat1(hostY_53, pkY, spkY), pkCA, ms3) then
          if check(padno(n4), spkY, ms4) then
          find j1 <= N2 suchthat defined(Lhost[j1], Qkey[j1]) && (Lhost[j1] = hostW_52) then
          new s3: symkeyseed;
          let AK_54: key = kgen(s3) in
          new kp: protkey;
          let k1: key = keyderivation(kp, un1) in
          let k2: key = keyderivation(kp, un2) in
          new tk_55: timest;
          new r4: symseed;
          let TGT_56: maxmac = encsym(concat5(AK_54, tk_55, hostY_53), Qkey[j1], r4) in
          new r5: symseed;
          let e24: maxmac = encsym(concat4(AK_54, n5, tk_55, hostW_52), k1, r5) in
          new r6: sseed;
          let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
          let ck: macs = mac(y, k2) in
          let ms21: signature = sign(concat3(kp, ck), sskK, r6) in
          new r7_57: seed;
          let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp, ck, ms21), pkY, r7_57) in
          let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
          event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
          out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Mhost1[j3], Mhost2[j3], Pkey[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new tt_51: timest;
        new r10: symseed;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    let Qkey: key = if (Lhost = T) then Kt else Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  let Pkey: key = if ((Mhost1 = T) && (Mhost2 = S)) then Ks else Mkey
)


Applying expand if, let, find yields

Game 2 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen(rkC) in
let skC: skey = skgen(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen(rkCs) in
let sskC: sskey = sskgen(rkCs) in
new rkK: keyseed;
let pkK: pkey = pkgen(rkK) in
let skK: skey = skgen(rkK) in
new rkKs: skeyseed;
let spkK: spkey = spkgen(rkKs) in
let sskK: sskey = sskgen(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen(rkCA) in
let skCA: sskey = sskgen(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
new q1: sseed;
new q2: sseed;
let certC: signature = sign(concat1(C, pkC, spkC), skCA, q1) in
let certK: signature = sign(concat7(K, pkK, spkK), skCA, q2) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n1: nonce;
          new n2: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign(padno(n2), sskC, r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          let injbot1(concat2(hostZ: kas, pkZ: pkey, spkZ: spkey, ms1: signature, k3: protkey, ck1: macs, ms2: signature)) = dec(m21, skC) in
          if check(concat7(hostZ, pkZ, spkZ), pkCA, ms1) then
          if check(concat3(k3, ck1), spkK, ms2) then
          let k1': key = keyderivation(k3, un1) in
          let k2': key = keyderivation(k3, un2) in
          let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign(padno(n2), sskC, r1), C, hostT, n1) in
          if checkmac(y', k2', ck1) then
          let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
          event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
          out(c18[!_35], acceptC1(hostZ, hostT));
          ! !_36 <= N3
          in(c17[!_36, !_35], (hosT': tgs, hostS: server));
          if (hosT' = hostT) then
          new n3: nonce;
          new tc: timest;
          new r7_61: symseed;
          let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
          event partCT(hostT, TGT_58, e5);
          out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
          in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
          let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
          event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
          out(c19[!_36, !_35], acceptC2(hostT, hostS));
          ! !_37 <= N4
          in(c20[!_37, !_36, !_35], hostS': server);
          if (hostS' = hostS) then
          new tc'_64: timest;
          new r2: symseed;
          let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
          event partCS(hostS, hostT, m7, e12);
          out(c6[!_37, !_36, !_35], (m6, e12));
          in(c9[!_37, !_36, !_35], (m13: maxmac));
          let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
          event fullCS(hostS, hostT, m7, e12, m13);
          out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          let m3: bitstring = (hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
          if check(concat1(hostY_53, pkY, spkY), pkCA, ms3) then
          if check(padno(n4), spkY, ms4) then
          find j1 <= N2 suchthat defined(Lhost[j1], Qkey[j1]) && (Lhost[j1] = hostW_52) then
          new s3: symkeyseed;
          let AK_54: key = kgen(s3) in
          new kp: protkey;
          let k1: key = keyderivation(kp, un1) in
          let k2: key = keyderivation(kp, un2) in
          new tk_55: timest;
          new r4: symseed;
          let TGT_56: maxmac = encsym(concat5(AK_54, tk_55, hostY_53), Qkey[j1], r4) in
          new r5: symseed;
          let e24: maxmac = encsym(concat4(AK_54, n5, tk_55, hostW_52), k1, r5) in
          new r6: sseed;
          let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
          let ck: macs = mac(y, k2) in
          let ms21: signature = sign(concat3(kp, ck), sskK, r6) in
          new r7_57: seed;
          let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp, ck, ms21), pkY, r7_57) in
          let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
          event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
          out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Mhost1[j3], Mhost2[j3], Pkey[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new tt_51: timest;
        new r10: symseed;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying move new all binders yields

Game 3 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen(rkC) in
let skC: skey = skgen(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen(rkCs) in
let sskC: sskey = sskgen(rkCs) in
new rkK: keyseed;
let pkK: pkey = pkgen(rkK) in
let skK: skey = skgen(rkK) in
new rkKs: skeyseed;
let spkK: spkey = spkgen(rkKs) in
let sskK: sskey = sskgen(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen(rkCA) in
let skCA: sskey = sskgen(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
new q1: sseed;
let certC: signature = sign(concat1(C, pkC, spkC), skCA, q1) in
new q2: sseed;
let certK: signature = sign(concat7(K, pkK, spkK), skCA, q2) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new r1: sseed;
          new n2: nonce;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign(padno(n2), sskC, r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          let injbot1(concat2(hostZ: kas, pkZ: pkey, spkZ: spkey, ms1: signature, k3: protkey, ck1: macs, ms2: signature)) = dec(m21, skC) in
          if check(concat7(hostZ, pkZ, spkZ), pkCA, ms1) then
          if check(concat3(k3, ck1), spkK, ms2) then
          let k1': key = keyderivation(k3, un1) in
          let k2': key = keyderivation(k3, un2) in
          let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign(padno(n2), sskC, r1), C, hostT, n1) in
          if checkmac(y', k2', ck1) then
          let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
          event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
          out(c18[!_35], acceptC1(hostZ, hostT));
          ! !_36 <= N3
          in(c17[!_36, !_35], (hosT': tgs, hostS: server));
          if (hosT' = hostT) then
          new r7_61: symseed;
          new tc: timest;
          let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
          event partCT(hostT, TGT_58, e5);
          new n3: nonce;
          out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
          in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
          let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
          event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
          out(c19[!_36, !_35], acceptC2(hostT, hostS));
          ! !_37 <= N4
          in(c20[!_37, !_36, !_35], hostS': server);
          if (hostS' = hostS) then
          new r2: symseed;
          new tc'_64: timest;
          let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
          event partCS(hostS, hostT, m7, e12);
          out(c6[!_37, !_36, !_35], (m6, e12));
          in(c9[!_37, !_36, !_35], (m13: maxmac));
          let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
          event fullCS(hostS, hostT, m7, e12, m13);
          out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          let m3: bitstring = (hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
          if check(concat1(hostY_53, pkY, spkY), pkCA, ms3) then
          if check(padno(n4), spkY, ms4) then
          find j1 <= N2 suchthat defined(Lhost[j1], Qkey[j1]) && (Lhost[j1] = hostW_52) then
          new s3: symkeyseed;
          let AK_54: key = kgen(s3) in
          new kp: protkey;
          let k1: key = keyderivation(kp, un1) in
          let k2: key = keyderivation(kp, un2) in
          new r4: symseed;
          new tk_55: timest;
          let TGT_56: maxmac = encsym(concat5(AK_54, tk_55, hostY_53), Qkey[j1], r4) in
          new r5: symseed;
          let e24: maxmac = encsym(concat4(AK_54, n5, tk_55, hostW_52), k1, r5) in
          let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
          let ck: macs = mac(y, k2) in
          new r6: sseed;
          let ms21: signature = sign(concat3(kp, ck), sskK, r6) in
          new r7_57: seed;
          let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp, ck, ms21), pkY, r7_57) in
          let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
          event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
          out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Mhost1[j3], Mhost2[j3], Pkey[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying remove assignments of useless yields

Game 4 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen(rkC) in
let skC: skey = skgen(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen(rkCs) in
let sskC: sskey = sskgen(rkCs) in
new rkK: keyseed;
let pkK: pkey = pkgen(rkK) in
new rkKs: skeyseed;
let spkK: spkey = spkgen(rkKs) in
let sskK: sskey = sskgen(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen(rkCA) in
let skCA: sskey = sskgen(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
new q1: sseed;
let certC: signature = sign(concat1(C, pkC, spkC), skCA, q1) in
new q2: sseed;
let certK: signature = sign(concat7(K, pkK, spkK), skCA, q2) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new r1: sseed;
          new n2: nonce;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign(padno(n2), sskC, r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          let injbot1(concat2(hostZ: kas, pkZ: pkey, spkZ: spkey, ms1: signature, k3: protkey, ck1: macs, ms2: signature)) = dec(m21, skC) in
          if check(concat7(hostZ, pkZ, spkZ), pkCA, ms1) then
          if check(concat3(k3, ck1), spkK, ms2) then
          let k1': key = keyderivation(k3, un1) in
          let k2': key = keyderivation(k3, un2) in
          let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign(padno(n2), sskC, r1), C, hostT, n1) in
          if checkmac(y', k2', ck1) then
          let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
          event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
          out(c18[!_35], acceptC1(hostZ, hostT));
          ! !_36 <= N3
          in(c17[!_36, !_35], (hosT': tgs, hostS: server));
          if (hosT' = hostT) then
          new r7_61: symseed;
          new tc: timest;
          let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
          event partCT(hostT, TGT_58, e5);
          new n3: nonce;
          out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
          in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
          let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
          event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
          out(c19[!_36, !_35], acceptC2(hostT, hostS));
          ! !_37 <= N4
          in(c20[!_37, !_36, !_35], hostS': server);
          if (hostS' = hostS) then
          new r2: symseed;
          new tc'_64: timest;
          let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
          event partCS(hostS, hostT, m7, e12);
          out(c6[!_37, !_36, !_35], (m6, e12));
          in(c9[!_37, !_36, !_35], (m13: maxmac));
          let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
          event fullCS(hostS, hostT, m7, e12, m13);
          out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if check(concat1(hostY_53, pkY, spkY), pkCA, ms3) then
          if check(padno(n4), spkY, ms4) then
          find j1 <= N2 suchthat defined(Lhost[j1], Qkey[j1]) && (Lhost[j1] = hostW_52) then
          new s3: symkeyseed;
          let AK_54: key = kgen(s3) in
          new kp: protkey;
          let k1: key = keyderivation(kp, un1) in
          let k2: key = keyderivation(kp, un2) in
          new r4: symseed;
          new tk_55: timest;
          let TGT_56: maxmac = encsym(concat5(AK_54, tk_55, hostY_53), Qkey[j1], r4) in
          new r5: symseed;
          let e24: maxmac = encsym(concat4(AK_54, n5, tk_55, hostW_52), k1, r5) in
          let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
          let ck: macs = mac(y, k2) in
          new r6: sseed;
          let ms21: signature = sign(concat3(kp, ck), sskK, r6) in
          new r7_57: seed;
          let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp, ck, ms21), pkY, r7_57) in
          let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
          event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
          out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Mhost1[j3], Mhost2[j3], Pkey[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying remove assignments of binder skCA yields

Game 5 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen(rkC) in
let skC: skey = skgen(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen(rkCs) in
let sskC: sskey = sskgen(rkCs) in
new rkK: keyseed;
let pkK: pkey = pkgen(rkK) in
new rkKs: skeyseed;
let spkK: spkey = spkgen(rkKs) in
let sskK: sskey = sskgen(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
new q1: sseed;
let certC: signature = sign(concat1(C, pkC, spkC), sskgen(rkCA), q1) in
new q2: sseed;
let certK: signature = sign(concat7(K, pkK, spkK), sskgen(rkCA), q2) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new r1: sseed;
          new n2: nonce;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign(padno(n2), sskC, r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          let injbot1(concat2(hostZ: kas, pkZ: pkey, spkZ: spkey, ms1: signature, k3: protkey, ck1: macs, ms2: signature)) = dec(m21, skC) in
          if check(concat7(hostZ, pkZ, spkZ), pkCA, ms1) then
          if check(concat3(k3, ck1), spkK, ms2) then
          let k1': key = keyderivation(k3, un1) in
          let k2': key = keyderivation(k3, un2) in
          let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign(padno(n2), sskC, r1), C, hostT, n1) in
          if checkmac(y', k2', ck1) then
          let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
          event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
          out(c18[!_35], acceptC1(hostZ, hostT));
          ! !_36 <= N3
          in(c17[!_36, !_35], (hosT': tgs, hostS: server));
          if (hosT' = hostT) then
          new r7_61: symseed;
          new tc: timest;
          let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
          event partCT(hostT, TGT_58, e5);
          new n3: nonce;
          out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
          in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
          let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
          event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
          out(c19[!_36, !_35], acceptC2(hostT, hostS));
          ! !_37 <= N4
          in(c20[!_37, !_36, !_35], hostS': server);
          if (hostS' = hostS) then
          new r2: symseed;
          new tc'_64: timest;
          let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
          event partCS(hostS, hostT, m7, e12);
          out(c6[!_37, !_36, !_35], (m6, e12));
          in(c9[!_37, !_36, !_35], (m13: maxmac));
          let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
          event fullCS(hostS, hostT, m7, e12, m13);
          out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if check(concat1(hostY_53, pkY, spkY), pkCA, ms3) then
          if check(padno(n4), spkY, ms4) then
          find j1 <= N2 suchthat defined(Lhost[j1], Qkey[j1]) && (Lhost[j1] = hostW_52) then
          new s3: symkeyseed;
          let AK_54: key = kgen(s3) in
          new kp: protkey;
          let k1: key = keyderivation(kp, un1) in
          let k2: key = keyderivation(kp, un2) in
          new r4: symseed;
          new tk_55: timest;
          let TGT_56: maxmac = encsym(concat5(AK_54, tk_55, hostY_53), Qkey[j1], r4) in
          new r5: symseed;
          let e24: maxmac = encsym(concat4(AK_54, n5, tk_55, hostW_52), k1, r5) in
          let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
          let ck: macs = mac(y, k2) in
          new r6: sseed;
          let ms21: signature = sign(concat3(kp, ck), sskK, r6) in
          new r7_57: seed;
          let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp, ck, ms21), pkY, r7_57) in
          let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
          event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
          out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Mhost1[j3], Mhost2[j3], Pkey[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying equivalence
equiv ! !_7 <= N3 new r: skeyseed; (
  () -> spkgen(r),
  ! !_8 <= N2 new r2: sseed; (x: sblocksize) -> sign(x, sskgen(r), r2)), ! !_9 <= N4 (m: sblocksize, y: spkey, si: signature) -> check(m, y, si) [all]
<=(N3 * Psign(time, N2))=>
      ! !_10 <= N3 new r: skeyseed; (
  () -> spkgen2(r),
  ! !_11 <= N2 new r2: sseed; (x_80: sblocksize) -> let x: sblocksize = x_80 in sign2(x, sskgen2(r), r2)), ! !_12 <= N4 (m: sblocksize, y: spkey, si: signature) -> find j <= N2, k_14 <= N3 suchthat defined(x[j, k_14], r[k_14]) && ((y = spkgen2(r[k_14])) && ((m = x[j, k_14]) && check2(m, y, si))) then true else find k_13 <= N3 suchthat defined(r[k_13]) && (y = spkgen2(r[k_13])) then false else check(m, y, si)
with rkCA [Difference of probability Psign(time + time(context for game 5), 2. * 1.)] yields

Game 6 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen(rkC) in
let skC: skey = skgen(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen(rkCs) in
let sskC: sskey = sskgen(rkCs) in
new rkK: keyseed;
let pkK: pkey = pkgen(rkK) in
new rkKs: skeyseed;
let spkK: spkey = spkgen(rkKs) in
let sskK: sskey = sskgen(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
new q1: sseed;
let x_90: sblocksize = concat1(C, pkC, spkC) in
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new q2: sseed;
let x_89: sblocksize = concat7(K, pkK, spkK) in
let certK: signature = sign2(x_89, sskgen2(rkCA), q2) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new r1: sseed;
          new n2: nonce;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign(padno(n2), sskC, r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          let injbot1(concat2(hostZ: kas, pkZ: pkey, spkZ: spkey, ms1: signature, k3: protkey, ck1: macs, ms2: signature)) = dec(m21, skC) in
          find  suchthat defined(x_89, rkCA) && ((pkCA = spkgen2(rkCA)) && ((concat7(hostZ, pkZ, spkZ) = x_89) && check2(concat7(hostZ, pkZ, spkZ), pkCA, ms1))) then
            if true then
            find  suchthat defined(x_89, rkCA) && ((spkK = spkgen2(rkCA)) && ((concat3(k3, ck1) = x_89) && check2(concat3(k3, ck1), spkK, ms2))) then
              if true then
              let k1': key = keyderivation(k3, un1) in
              let k2': key = keyderivation(k3, un2) in
              let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign(padno(n2), sskC, r1), C, hostT, n1) in
              if checkmac(y', k2', ck1) then
              let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
              event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
              out(c18[!_35], acceptC1(hostZ, hostT));
              ! !_36 <= N3
              in(c17[!_36, !_35], (hosT': tgs, hostS: server));
              if (hosT' = hostT) then
              new r7_61: symseed;
              new tc: timest;
              let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
              event partCT(hostT, TGT_58, e5);
              new n3: nonce;
              out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
              in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
              let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
              event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2: symseed;
              new tc'_64: timest;
              let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind  suchthat defined(x_90, rkCA) && ((spkK = spkgen2(rkCA)) && ((concat3(k3, ck1) = x_90) && check2(concat3(k3, ck1), spkK, ms2))) then
              if true then
              let k1': key = keyderivation(k3, un1) in
              let k2': key = keyderivation(k3, un2) in
              let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign(padno(n2), sskC, r1), C, hostT, n1) in
              if checkmac(y', k2', ck1) then
              let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
              event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
              out(c18[!_35], acceptC1(hostZ, hostT));
              ! !_36 <= N3
              in(c17[!_36, !_35], (hosT': tgs, hostS: server));
              if (hosT' = hostT) then
              new r7_61: symseed;
              new tc: timest;
              let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
              event partCT(hostT, TGT_58, e5);
              new n3: nonce;
              out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
              in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
              let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
              event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2: symseed;
              new tc'_64: timest;
              let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            else
              if defined(rkCA) && (spkK = spkgen2(rkCA)) then
                if false then
                let k1': key = keyderivation(k3, un1) in
                let k2': key = keyderivation(k3, un2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign(padno(n2), sskC, r1), C, hostT, n1) in
                if checkmac(y', k2', ck1) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_61: symseed;
                new tc: timest;
                let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
                event partCT(hostT, TGT_58, e5);
                new n3: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2: symseed;
                new tc'_64: timest;
                let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              else
                if check(concat3(k3, ck1), spkK, ms2) then
                let k1': key = keyderivation(k3, un1) in
                let k2': key = keyderivation(k3, un2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign(padno(n2), sskC, r1), C, hostT, n1) in
                if checkmac(y', k2', ck1) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_61: symseed;
                new tc: timest;
                let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
                event partCT(hostT, TGT_58, e5);
                new n3: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2: symseed;
                new tc'_64: timest;
                let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind  suchthat defined(x_90, rkCA) && ((pkCA = spkgen2(rkCA)) && ((concat7(hostZ, pkZ, spkZ) = x_90) && check2(concat7(hostZ, pkZ, spkZ), pkCA, ms1))) then
            if true then
            find  suchthat defined(x_89, rkCA) && ((spkK = spkgen2(rkCA)) && ((concat3(k3, ck1) = x_89) && check2(concat3(k3, ck1), spkK, ms2))) then
              if true then
              let k1': key = keyderivation(k3, un1) in
              let k2': key = keyderivation(k3, un2) in
              let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign(padno(n2), sskC, r1), C, hostT, n1) in
              if checkmac(y', k2', ck1) then
              let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
              event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
              out(c18[!_35], acceptC1(hostZ, hostT));
              ! !_36 <= N3
              in(c17[!_36, !_35], (hosT': tgs, hostS: server));
              if (hosT' = hostT) then
              new r7_61: symseed;
              new tc: timest;
              let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
              event partCT(hostT, TGT_58, e5);
              new n3: nonce;
              out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
              in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
              let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
              event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2: symseed;
              new tc'_64: timest;
              let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind  suchthat defined(x_90, rkCA) && ((spkK = spkgen2(rkCA)) && ((concat3(k3, ck1) = x_90) && check2(concat3(k3, ck1), spkK, ms2))) then
              if true then
              let k1': key = keyderivation(k3, un1) in
              let k2': key = keyderivation(k3, un2) in
              let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign(padno(n2), sskC, r1), C, hostT, n1) in
              if checkmac(y', k2', ck1) then
              let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
              event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
              out(c18[!_35], acceptC1(hostZ, hostT));
              ! !_36 <= N3
              in(c17[!_36, !_35], (hosT': tgs, hostS: server));
              if (hosT' = hostT) then
              new r7_61: symseed;
              new tc: timest;
              let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
              event partCT(hostT, TGT_58, e5);
              new n3: nonce;
              out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
              in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
              let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
              event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2: symseed;
              new tc'_64: timest;
              let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            else
              if defined(rkCA) && (spkK = spkgen2(rkCA)) then
                if false then
                let k1': key = keyderivation(k3, un1) in
                let k2': key = keyderivation(k3, un2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign(padno(n2), sskC, r1), C, hostT, n1) in
                if checkmac(y', k2', ck1) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_61: symseed;
                new tc: timest;
                let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
                event partCT(hostT, TGT_58, e5);
                new n3: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2: symseed;
                new tc'_64: timest;
                let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              else
                if check(concat3(k3, ck1), spkK, ms2) then
                let k1': key = keyderivation(k3, un1) in
                let k2': key = keyderivation(k3, un2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign(padno(n2), sskC, r1), C, hostT, n1) in
                if checkmac(y', k2', ck1) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_61: symseed;
                new tc: timest;
                let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
                event partCT(hostT, TGT_58, e5);
                new n3: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2: symseed;
                new tc'_64: timest;
                let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          else
            if defined(rkCA) && (pkCA = spkgen2(rkCA)) then
              if false then
              find  suchthat defined(x_89, rkCA) && ((spkK = spkgen2(rkCA)) && ((concat3(k3, ck1) = x_89) && check2(concat3(k3, ck1), spkK, ms2))) then
                if true then
                let k1': key = keyderivation(k3, un1) in
                let k2': key = keyderivation(k3, un2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign(padno(n2), sskC, r1), C, hostT, n1) in
                if checkmac(y', k2', ck1) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_61: symseed;
                new tc: timest;
                let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
                event partCT(hostT, TGT_58, e5);
                new n3: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2: symseed;
                new tc'_64: timest;
                let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(x_90, rkCA) && ((spkK = spkgen2(rkCA)) && ((concat3(k3, ck1) = x_90) && check2(concat3(k3, ck1), spkK, ms2))) then
                if true then
                let k1': key = keyderivation(k3, un1) in
                let k2': key = keyderivation(k3, un2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign(padno(n2), sskC, r1), C, hostT, n1) in
                if checkmac(y', k2', ck1) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_61: symseed;
                new tc: timest;
                let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
                event partCT(hostT, TGT_58, e5);
                new n3: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2: symseed;
                new tc'_64: timest;
                let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              else
                if defined(rkCA) && (spkK = spkgen2(rkCA)) then
                  if false then
                  let k1': key = keyderivation(k3, un1) in
                  let k2': key = keyderivation(k3, un2) in
                  let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign(padno(n2), sskC, r1), C, hostT, n1) in
                  if checkmac(y', k2', ck1) then
                  let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                  event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                  out(c18[!_35], acceptC1(hostZ, hostT));
                  ! !_36 <= N3
                  in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                  if (hosT' = hostT) then
                  new r7_61: symseed;
                  new tc: timest;
                  let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
                  event partCT(hostT, TGT_58, e5);
                  new n3: nonce;
                  out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
                  in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                  let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                  event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
                  out(c19[!_36, !_35], acceptC2(hostT, hostS));
                  ! !_37 <= N4
                  in(c20[!_37, !_36, !_35], hostS': server);
                  if (hostS' = hostS) then
                  new r2: symseed;
                  new tc'_64: timest;
                  let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
                  event partCS(hostS, hostT, m7, e12);
                  out(c6[!_37, !_36, !_35], (m6, e12));
                  in(c9[!_37, !_36, !_35], (m13: maxmac));
                  let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
                  event fullCS(hostS, hostT, m7, e12, m13);
                  out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                else
                  if check(concat3(k3, ck1), spkK, ms2) then
                  let k1': key = keyderivation(k3, un1) in
                  let k2': key = keyderivation(k3, un2) in
                  let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign(padno(n2), sskC, r1), C, hostT, n1) in
                  if checkmac(y', k2', ck1) then
                  let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                  event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                  out(c18[!_35], acceptC1(hostZ, hostT));
                  ! !_36 <= N3
                  in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                  if (hosT' = hostT) then
                  new r7_61: symseed;
                  new tc: timest;
                  let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
                  event partCT(hostT, TGT_58, e5);
                  new n3: nonce;
                  out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
                  in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                  let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                  event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
                  out(c19[!_36, !_35], acceptC2(hostT, hostS));
                  ! !_37 <= N4
                  in(c20[!_37, !_36, !_35], hostS': server);
                  if (hostS' = hostS) then
                  new r2: symseed;
                  new tc'_64: timest;
                  let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
                  event partCS(hostS, hostT, m7, e12);
                  out(c6[!_37, !_36, !_35], (m6, e12));
                  in(c9[!_37, !_36, !_35], (m13: maxmac));
                  let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
                  event fullCS(hostS, hostT, m7, e12, m13);
                  out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            else
              if check(concat7(hostZ, pkZ, spkZ), pkCA, ms1) then
              find  suchthat defined(x_89, rkCA) && ((spkK = spkgen2(rkCA)) && ((concat3(k3, ck1) = x_89) && check2(concat3(k3, ck1), spkK, ms2))) then
                if true then
                let k1': key = keyderivation(k3, un1) in
                let k2': key = keyderivation(k3, un2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign(padno(n2), sskC, r1), C, hostT, n1) in
                if checkmac(y', k2', ck1) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_61: symseed;
                new tc: timest;
                let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
                event partCT(hostT, TGT_58, e5);
                new n3: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2: symseed;
                new tc'_64: timest;
                let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(x_90, rkCA) && ((spkK = spkgen2(rkCA)) && ((concat3(k3, ck1) = x_90) && check2(concat3(k3, ck1), spkK, ms2))) then
                if true then
                let k1': key = keyderivation(k3, un1) in
                let k2': key = keyderivation(k3, un2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign(padno(n2), sskC, r1), C, hostT, n1) in
                if checkmac(y', k2', ck1) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_61: symseed;
                new tc: timest;
                let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
                event partCT(hostT, TGT_58, e5);
                new n3: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2: symseed;
                new tc'_64: timest;
                let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              else
                if defined(rkCA) && (spkK = spkgen2(rkCA)) then
                  if false then
                  let k1': key = keyderivation(k3, un1) in
                  let k2': key = keyderivation(k3, un2) in
                  let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign(padno(n2), sskC, r1), C, hostT, n1) in
                  if checkmac(y', k2', ck1) then
                  let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                  event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                  out(c18[!_35], acceptC1(hostZ, hostT));
                  ! !_36 <= N3
                  in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                  if (hosT' = hostT) then
                  new r7_61: symseed;
                  new tc: timest;
                  let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
                  event partCT(hostT, TGT_58, e5);
                  new n3: nonce;
                  out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
                  in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                  let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                  event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
                  out(c19[!_36, !_35], acceptC2(hostT, hostS));
                  ! !_37 <= N4
                  in(c20[!_37, !_36, !_35], hostS': server);
                  if (hostS' = hostS) then
                  new r2: symseed;
                  new tc'_64: timest;
                  let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
                  event partCS(hostS, hostT, m7, e12);
                  out(c6[!_37, !_36, !_35], (m6, e12));
                  in(c9[!_37, !_36, !_35], (m13: maxmac));
                  let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
                  event fullCS(hostS, hostT, m7, e12, m13);
                  out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                else
                  if check(concat3(k3, ck1), spkK, ms2) then
                  let k1': key = keyderivation(k3, un1) in
                  let k2': key = keyderivation(k3, un2) in
                  let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign(padno(n2), sskC, r1), C, hostT, n1) in
                  if checkmac(y', k2', ck1) then
                  let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                  event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                  out(c18[!_35], acceptC1(hostZ, hostT));
                  ! !_36 <= N3
                  in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                  if (hosT' = hostT) then
                  new r7_61: symseed;
                  new tc: timest;
                  let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
                  event partCT(hostT, TGT_58, e5);
                  new n3: nonce;
                  out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
                  in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                  let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                  event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
                  out(c19[!_36, !_35], acceptC2(hostT, hostS));
                  ! !_37 <= N4
                  in(c20[!_37, !_36, !_35], hostS': server);
                  if (hostS' = hostS) then
                  new r2: symseed;
                  new tc'_64: timest;
                  let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
                  event partCS(hostS, hostT, m7, e12);
                  out(c6[!_37, !_36, !_35], (m6, e12));
                  in(c9[!_37, !_36, !_35], (m13: maxmac));
                  let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
                  event fullCS(hostS, hostT, m7, e12, m13);
                  out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          find  suchthat defined(x_89, rkCA) && ((pkCA = spkgen2(rkCA)) && ((concat1(hostY_53, pkY, spkY) = x_89) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3))) then
            if true then
            find  suchthat defined(x_89, rkCA) && ((spkY = spkgen2(rkCA)) && ((padno(n4) = x_89) && check2(padno(n4), spkY, ms4))) then
              if true then
              find j1 <= N2 suchthat defined(Lhost[j1], Qkey[j1]) && (Lhost[j1] = hostW_52) then
              new s3: symkeyseed;
              let AK_54: key = kgen(s3) in
              new kp: protkey;
              let k1: key = keyderivation(kp, un1) in
              let k2: key = keyderivation(kp, un2) in
              new r4: symseed;
              new tk_55: timest;
              let TGT_56: maxmac = encsym(concat5(AK_54, tk_55, hostY_53), Qkey[j1], r4) in
              new r5: symseed;
              let e24: maxmac = encsym(concat4(AK_54, n5, tk_55, hostW_52), k1, r5) in
              let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
              let ck: macs = mac(y, k2) in
              new r6: sseed;
              let ms21: signature = sign(concat3(kp, ck), sskK, r6) in
              new r7_57: seed;
              let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp, ck, ms21), pkY, r7_57) in
              let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
              event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
              out(c23[!_38], m5)
            orfind  suchthat defined(x_90, rkCA) && ((spkY = spkgen2(rkCA)) && ((padno(n4) = x_90) && check2(padno(n4), spkY, ms4))) then
              if true then
              find j1 <= N2 suchthat defined(Lhost[j1], Qkey[j1]) && (Lhost[j1] = hostW_52) then
              new s3: symkeyseed;
              let AK_54: key = kgen(s3) in
              new kp: protkey;
              let k1: key = keyderivation(kp, un1) in
              let k2: key = keyderivation(kp, un2) in
              new r4: symseed;
              new tk_55: timest;
              let TGT_56: maxmac = encsym(concat5(AK_54, tk_55, hostY_53), Qkey[j1], r4) in
              new r5: symseed;
              let e24: maxmac = encsym(concat4(AK_54, n5, tk_55, hostW_52), k1, r5) in
              let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
              let ck: macs = mac(y, k2) in
              new r6: sseed;
              let ms21: signature = sign(concat3(kp, ck), sskK, r6) in
              new r7_57: seed;
              let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp, ck, ms21), pkY, r7_57) in
              let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
              event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
              out(c23[!_38], m5)
            else
              if defined(rkCA) && (spkY = spkgen2(rkCA)) then
                if false then
                find j1 <= N2 suchthat defined(Lhost[j1], Qkey[j1]) && (Lhost[j1] = hostW_52) then
                new s3: symkeyseed;
                let AK_54: key = kgen(s3) in
                new kp: protkey;
                let k1: key = keyderivation(kp, un1) in
                let k2: key = keyderivation(kp, un2) in
                new r4: symseed;
                new tk_55: timest;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_55, hostY_53), Qkey[j1], r4) in
                new r5: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_55, hostW_52), k1, r5) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r6: sseed;
                let ms21: signature = sign(concat3(kp, ck), sskK, r6) in
                new r7_57: seed;
                let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp, ck, ms21), pkY, r7_57) in
                let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
                out(c23[!_38], m5)
              else
                if check(padno(n4), spkY, ms4) then
                find j1 <= N2 suchthat defined(Lhost[j1], Qkey[j1]) && (Lhost[j1] = hostW_52) then
                new s3: symkeyseed;
                let AK_54: key = kgen(s3) in
                new kp: protkey;
                let k1: key = keyderivation(kp, un1) in
                let k2: key = keyderivation(kp, un2) in
                new r4: symseed;
                new tk_55: timest;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_55, hostY_53), Qkey[j1], r4) in
                new r5: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_55, hostW_52), k1, r5) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r6: sseed;
                let ms21: signature = sign(concat3(kp, ck), sskK, r6) in
                new r7_57: seed;
                let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp, ck, ms21), pkY, r7_57) in
                let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
                out(c23[!_38], m5)
          orfind  suchthat defined(x_90, rkCA) && ((pkCA = spkgen2(rkCA)) && ((concat1(hostY_53, pkY, spkY) = x_90) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3))) then
            if true then
            find  suchthat defined(x_89, rkCA) && ((spkY = spkgen2(rkCA)) && ((padno(n4) = x_89) && check2(padno(n4), spkY, ms4))) then
              if true then
              find j1 <= N2 suchthat defined(Lhost[j1], Qkey[j1]) && (Lhost[j1] = hostW_52) then
              new s3: symkeyseed;
              let AK_54: key = kgen(s3) in
              new kp: protkey;
              let k1: key = keyderivation(kp, un1) in
              let k2: key = keyderivation(kp, un2) in
              new r4: symseed;
              new tk_55: timest;
              let TGT_56: maxmac = encsym(concat5(AK_54, tk_55, hostY_53), Qkey[j1], r4) in
              new r5: symseed;
              let e24: maxmac = encsym(concat4(AK_54, n5, tk_55, hostW_52), k1, r5) in
              let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
              let ck: macs = mac(y, k2) in
              new r6: sseed;
              let ms21: signature = sign(concat3(kp, ck), sskK, r6) in
              new r7_57: seed;
              let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp, ck, ms21), pkY, r7_57) in
              let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
              event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
              out(c23[!_38], m5)
            orfind  suchthat defined(x_90, rkCA) && ((spkY = spkgen2(rkCA)) && ((padno(n4) = x_90) && check2(padno(n4), spkY, ms4))) then
              if true then
              find j1 <= N2 suchthat defined(Lhost[j1], Qkey[j1]) && (Lhost[j1] = hostW_52) then
              new s3: symkeyseed;
              let AK_54: key = kgen(s3) in
              new kp: protkey;
              let k1: key = keyderivation(kp, un1) in
              let k2: key = keyderivation(kp, un2) in
              new r4: symseed;
              new tk_55: timest;
              let TGT_56: maxmac = encsym(concat5(AK_54, tk_55, hostY_53), Qkey[j1], r4) in
              new r5: symseed;
              let e24: maxmac = encsym(concat4(AK_54, n5, tk_55, hostW_52), k1, r5) in
              let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
              let ck: macs = mac(y, k2) in
              new r6: sseed;
              let ms21: signature = sign(concat3(kp, ck), sskK, r6) in
              new r7_57: seed;
              let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp, ck, ms21), pkY, r7_57) in
              let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
              event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
              out(c23[!_38], m5)
            else
              if defined(rkCA) && (spkY = spkgen2(rkCA)) then
                if false then
                find j1 <= N2 suchthat defined(Lhost[j1], Qkey[j1]) && (Lhost[j1] = hostW_52) then
                new s3: symkeyseed;
                let AK_54: key = kgen(s3) in
                new kp: protkey;
                let k1: key = keyderivation(kp, un1) in
                let k2: key = keyderivation(kp, un2) in
                new r4: symseed;
                new tk_55: timest;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_55, hostY_53), Qkey[j1], r4) in
                new r5: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_55, hostW_52), k1, r5) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r6: sseed;
                let ms21: signature = sign(concat3(kp, ck), sskK, r6) in
                new r7_57: seed;
                let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp, ck, ms21), pkY, r7_57) in
                let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
                out(c23[!_38], m5)
              else
                if check(padno(n4), spkY, ms4) then
                find j1 <= N2 suchthat defined(Lhost[j1], Qkey[j1]) && (Lhost[j1] = hostW_52) then
                new s3: symkeyseed;
                let AK_54: key = kgen(s3) in
                new kp: protkey;
                let k1: key = keyderivation(kp, un1) in
                let k2: key = keyderivation(kp, un2) in
                new r4: symseed;
                new tk_55: timest;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_55, hostY_53), Qkey[j1], r4) in
                new r5: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_55, hostW_52), k1, r5) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r6: sseed;
                let ms21: signature = sign(concat3(kp, ck), sskK, r6) in
                new r7_57: seed;
                let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp, ck, ms21), pkY, r7_57) in
                let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
                out(c23[!_38], m5)
          else
            if defined(rkCA) && (pkCA = spkgen2(rkCA)) then
              if false then
              find  suchthat defined(x_89, rkCA) && ((spkY = spkgen2(rkCA)) && ((padno(n4) = x_89) && check2(padno(n4), spkY, ms4))) then
                if true then
                find j1 <= N2 suchthat defined(Lhost[j1], Qkey[j1]) && (Lhost[j1] = hostW_52) then
                new s3: symkeyseed;
                let AK_54: key = kgen(s3) in
                new kp: protkey;
                let k1: key = keyderivation(kp, un1) in
                let k2: key = keyderivation(kp, un2) in
                new r4: symseed;
                new tk_55: timest;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_55, hostY_53), Qkey[j1], r4) in
                new r5: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_55, hostW_52), k1, r5) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r6: sseed;
                let ms21: signature = sign(concat3(kp, ck), sskK, r6) in
                new r7_57: seed;
                let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp, ck, ms21), pkY, r7_57) in
                let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
                out(c23[!_38], m5)
              orfind  suchthat defined(x_90, rkCA) && ((spkY = spkgen2(rkCA)) && ((padno(n4) = x_90) && check2(padno(n4), spkY, ms4))) then
                if true then
                find j1 <= N2 suchthat defined(Lhost[j1], Qkey[j1]) && (Lhost[j1] = hostW_52) then
                new s3: symkeyseed;
                let AK_54: key = kgen(s3) in
                new kp: protkey;
                let k1: key = keyderivation(kp, un1) in
                let k2: key = keyderivation(kp, un2) in
                new r4: symseed;
                new tk_55: timest;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_55, hostY_53), Qkey[j1], r4) in
                new r5: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_55, hostW_52), k1, r5) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r6: sseed;
                let ms21: signature = sign(concat3(kp, ck), sskK, r6) in
                new r7_57: seed;
                let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp, ck, ms21), pkY, r7_57) in
                let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
                out(c23[!_38], m5)
              else
                if defined(rkCA) && (spkY = spkgen2(rkCA)) then
                  if false then
                  find j1 <= N2 suchthat defined(Lhost[j1], Qkey[j1]) && (Lhost[j1] = hostW_52) then
                  new s3: symkeyseed;
                  let AK_54: key = kgen(s3) in
                  new kp: protkey;
                  let k1: key = keyderivation(kp, un1) in
                  let k2: key = keyderivation(kp, un2) in
                  new r4: symseed;
                  new tk_55: timest;
                  let TGT_56: maxmac = encsym(concat5(AK_54, tk_55, hostY_53), Qkey[j1], r4) in
                  new r5: symseed;
                  let e24: maxmac = encsym(concat4(AK_54, n5, tk_55, hostW_52), k1, r5) in
                  let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                  let ck: macs = mac(y, k2) in
                  new r6: sseed;
                  let ms21: signature = sign(concat3(kp, ck), sskK, r6) in
                  new r7_57: seed;
                  let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp, ck, ms21), pkY, r7_57) in
                  let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
                  event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
                  out(c23[!_38], m5)
                else
                  if check(padno(n4), spkY, ms4) then
                  find j1 <= N2 suchthat defined(Lhost[j1], Qkey[j1]) && (Lhost[j1] = hostW_52) then
                  new s3: symkeyseed;
                  let AK_54: key = kgen(s3) in
                  new kp: protkey;
                  let k1: key = keyderivation(kp, un1) in
                  let k2: key = keyderivation(kp, un2) in
                  new r4: symseed;
                  new tk_55: timest;
                  let TGT_56: maxmac = encsym(concat5(AK_54, tk_55, hostY_53), Qkey[j1], r4) in
                  new r5: symseed;
                  let e24: maxmac = encsym(concat4(AK_54, n5, tk_55, hostW_52), k1, r5) in
                  let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                  let ck: macs = mac(y, k2) in
                  new r6: sseed;
                  let ms21: signature = sign(concat3(kp, ck), sskK, r6) in
                  new r7_57: seed;
                  let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp, ck, ms21), pkY, r7_57) in
                  let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
                  event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
                  out(c23[!_38], m5)
            else
              if check(concat1(hostY_53, pkY, spkY), pkCA, ms3) then
              find  suchthat defined(x_89, rkCA) && ((spkY = spkgen2(rkCA)) && ((padno(n4) = x_89) && check2(padno(n4), spkY, ms4))) then
                if true then
                find j1 <= N2 suchthat defined(Lhost[j1], Qkey[j1]) && (Lhost[j1] = hostW_52) then
                new s3: symkeyseed;
                let AK_54: key = kgen(s3) in
                new kp: protkey;
                let k1: key = keyderivation(kp, un1) in
                let k2: key = keyderivation(kp, un2) in
                new r4: symseed;
                new tk_55: timest;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_55, hostY_53), Qkey[j1], r4) in
                new r5: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_55, hostW_52), k1, r5) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r6: sseed;
                let ms21: signature = sign(concat3(kp, ck), sskK, r6) in
                new r7_57: seed;
                let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp, ck, ms21), pkY, r7_57) in
                let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
                out(c23[!_38], m5)
              orfind  suchthat defined(x_90, rkCA) && ((spkY = spkgen2(rkCA)) && ((padno(n4) = x_90) && check2(padno(n4), spkY, ms4))) then
                if true then
                find j1 <= N2 suchthat defined(Lhost[j1], Qkey[j1]) && (Lhost[j1] = hostW_52) then
                new s3: symkeyseed;
                let AK_54: key = kgen(s3) in
                new kp: protkey;
                let k1: key = keyderivation(kp, un1) in
                let k2: key = keyderivation(kp, un2) in
                new r4: symseed;
                new tk_55: timest;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_55, hostY_53), Qkey[j1], r4) in
                new r5: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_55, hostW_52), k1, r5) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r6: sseed;
                let ms21: signature = sign(concat3(kp, ck), sskK, r6) in
                new r7_57: seed;
                let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp, ck, ms21), pkY, r7_57) in
                let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
                out(c23[!_38], m5)
              else
                if defined(rkCA) && (spkY = spkgen2(rkCA)) then
                  if false then
                  find j1 <= N2 suchthat defined(Lhost[j1], Qkey[j1]) && (Lhost[j1] = hostW_52) then
                  new s3: symkeyseed;
                  let AK_54: key = kgen(s3) in
                  new kp: protkey;
                  let k1: key = keyderivation(kp, un1) in
                  let k2: key = keyderivation(kp, un2) in
                  new r4: symseed;
                  new tk_55: timest;
                  let TGT_56: maxmac = encsym(concat5(AK_54, tk_55, hostY_53), Qkey[j1], r4) in
                  new r5: symseed;
                  let e24: maxmac = encsym(concat4(AK_54, n5, tk_55, hostW_52), k1, r5) in
                  let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                  let ck: macs = mac(y, k2) in
                  new r6: sseed;
                  let ms21: signature = sign(concat3(kp, ck), sskK, r6) in
                  new r7_57: seed;
                  let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp, ck, ms21), pkY, r7_57) in
                  let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
                  event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
                  out(c23[!_38], m5)
                else
                  if check(padno(n4), spkY, ms4) then
                  find j1 <= N2 suchthat defined(Lhost[j1], Qkey[j1]) && (Lhost[j1] = hostW_52) then
                  new s3: symkeyseed;
                  let AK_54: key = kgen(s3) in
                  new kp: protkey;
                  let k1: key = keyderivation(kp, un1) in
                  let k2: key = keyderivation(kp, un2) in
                  new r4: symseed;
                  new tk_55: timest;
                  let TGT_56: maxmac = encsym(concat5(AK_54, tk_55, hostY_53), Qkey[j1], r4) in
                  new r5: symseed;
                  let e24: maxmac = encsym(concat4(AK_54, n5, tk_55, hostW_52), k1, r5) in
                  let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                  let ck: macs = mac(y, k2) in
                  new r6: sseed;
                  let ms21: signature = sign(concat3(kp, ck), sskK, r6) in
                  new r7_57: seed;
                  let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp, ck, ms21), pkY, r7_57) in
                  let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
                  event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
                  out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Mhost1[j3], Mhost2[j3], Pkey[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying simplify yields

Game 7 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen(rkC) in
let skC: skey = skgen(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen(rkCs) in
let sskC: sskey = sskgen(rkCs) in
new rkK: keyseed;
let pkK: pkey = pkgen(rkK) in
new rkKs: skeyseed;
let spkK: spkey = spkgen(rkKs) in
let sskK: sskey = sskgen(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
new q1: sseed;
let x_90: sblocksize = concat1(C, pkC, spkC) in
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new q2: sseed;
let x_89: sblocksize = concat7(K, pkK, spkK) in
let certK: signature = sign2(x_89, sskgen2(rkCA), q2) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new r1: sseed;
          new n2: nonce;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign(padno(n2), sskC, r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          let injbot1(concat2(hostZ: kas, pkZ: pkey, spkZ: spkey, ms1: signature, k3: protkey, ck1: macs, ms2: signature)) = dec(m21, skC) in
          if (((hostZ = K) && ((pkZ = pkK) && (spkZ = spkK))) && check2(concat7(hostZ, pkZ, spkZ), pkCA, ms1)) then
          if (spkK = spkgen2(rkCA)) then
            yield
          else
            if check(concat3(k3, ck1), spkK, ms2) then
            let k1': key = keyderivation(k3, un1) in
            let k2': key = keyderivation(k3, un2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign(padno(n2), sskC, r1), C, hostT, n1) in
            if checkmac(y', k2', ck1) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_61: symseed;
            new tc: timest;
            let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
            event partCT(hostT, TGT_58, e5);
            new n3: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2: symseed;
            new tc'_64: timest;
            let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          if (spkY = spkgen2(rkCA)) then
            yield
          else
            if check(padno(n4), spkY, ms4) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3: symkeyseed;
            let AK_54: key = kgen(s3) in
            new kp: protkey;
            let k1: key = keyderivation(kp, un1) in
            let k2: key = keyderivation(kp, un2) in
            new r4: symseed;
            new tk_55: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_55, hostY_53), Qkey[j1], r4) in
            new r5: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_55, hostW_52), k1, r5) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r6: sseed;
            let ms21: signature = sign(concat3(kp, ck), sskK, r6) in
            new r7_57: seed;
            let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp, ck, ms21), pkY, r7_57) in
            let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying move new all binders yields

Game 8 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen(rkC) in
let skC: skey = skgen(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen(rkCs) in
let sskC: sskey = sskgen(rkCs) in
new rkK: keyseed;
let pkK: pkey = pkgen(rkK) in
new rkKs: skeyseed;
let spkK: spkey = spkgen(rkKs) in
let sskK: sskey = sskgen(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
let x_89: sblocksize = concat7(K, pkK, spkK) in
new q2: sseed;
let certK: signature = sign2(x_89, sskgen2(rkCA), q2) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n1: nonce;
          new n2: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign(padno(n2), sskC, r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          let injbot1(concat2(hostZ: kas, pkZ: pkey, spkZ: spkey, ms1: signature, k3: protkey, ck1: macs, ms2: signature)) = dec(m21, skC) in
          if (((hostZ = K) && ((pkZ = pkK) && (spkZ = spkK))) && check2(concat7(hostZ, pkZ, spkZ), pkCA, ms1)) then
          if (spkK = spkgen2(rkCA)) then
            yield
          else
            if check(concat3(k3, ck1), spkK, ms2) then
            let k1': key = keyderivation(k3, un1) in
            let k2': key = keyderivation(k3, un2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign(padno(n2), sskC, r1), C, hostT, n1) in
            if checkmac(y', k2', ck1) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc: timest;
            new r7_61: symseed;
            let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
            event partCT(hostT, TGT_58, e5);
            new n3: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_64: timest;
            new r2: symseed;
            let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          if (spkY = spkgen2(rkCA)) then
            yield
          else
            if check(padno(n4), spkY, ms4) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3: symkeyseed;
            let AK_54: key = kgen(s3) in
            new kp: protkey;
            let k1: key = keyderivation(kp, un1) in
            let k2: key = keyderivation(kp, un2) in
            new tk_55: timest;
            new r4: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_55, hostY_53), Qkey[j1], r4) in
            new r5: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_55, hostW_52), k1, r5) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r6: sseed;
            let ms21: signature = sign(concat3(kp, ck), sskK, r6) in
            new r7_57: seed;
            let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp, ck, ms21), pkY, r7_57) in
            let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new tt_51: timest;
        new r10: symseed;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying remove assignments of binder sskC yields

Game 9 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen(rkC) in
let skC: skey = skgen(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen(rkCs) in
new rkK: keyseed;
let pkK: pkey = pkgen(rkK) in
new rkKs: skeyseed;
let spkK: spkey = spkgen(rkKs) in
let sskK: sskey = sskgen(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
let x_89: sblocksize = concat7(K, pkK, spkK) in
new q2: sseed;
let certK: signature = sign2(x_89, sskgen2(rkCA), q2) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n1: nonce;
          new n2: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign(padno(n2), sskgen(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          let injbot1(concat2(hostZ: kas, pkZ: pkey, spkZ: spkey, ms1: signature, k3: protkey, ck1: macs, ms2: signature)) = dec(m21, skC) in
          if (((hostZ = K) && ((pkZ = pkK) && (spkZ = spkK))) && check2(concat7(hostZ, pkZ, spkZ), pkCA, ms1)) then
          if (spkK = spkgen2(rkCA)) then
            yield
          else
            if check(concat3(k3, ck1), spkK, ms2) then
            let k1': key = keyderivation(k3, un1) in
            let k2': key = keyderivation(k3, un2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign(padno(n2), sskgen(rkCs), r1), C, hostT, n1) in
            if checkmac(y', k2', ck1) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc: timest;
            new r7_61: symseed;
            let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
            event partCT(hostT, TGT_58, e5);
            new n3: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_64: timest;
            new r2: symseed;
            let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          if (spkY = spkgen2(rkCA)) then
            yield
          else
            if check(padno(n4), spkY, ms4) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3: symkeyseed;
            let AK_54: key = kgen(s3) in
            new kp: protkey;
            let k1: key = keyderivation(kp, un1) in
            let k2: key = keyderivation(kp, un2) in
            new tk_55: timest;
            new r4: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_55, hostY_53), Qkey[j1], r4) in
            new r5: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_55, hostW_52), k1, r5) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r6: sseed;
            let ms21: signature = sign(concat3(kp, ck), sskK, r6) in
            new r7_57: seed;
            let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp, ck, ms21), pkY, r7_57) in
            let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new tt_51: timest;
        new r10: symseed;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying equivalence
equiv ! !_7 <= N3 new r: skeyseed; (
  () -> spkgen(r),
  ! !_8 <= N2 new r2: sseed; (x: sblocksize) -> sign(x, sskgen(r), r2)), ! !_9 <= N4 (m: sblocksize, y: spkey, si: signature) -> check(m, y, si) [all]
<=(N3 * Psign(time, N2))=>
      ! !_10 <= N3 new r: skeyseed; (
  () -> spkgen2(r),
  ! !_11 <= N2 new r2: sseed; (x_80: sblocksize) -> let x: sblocksize = x_80 in sign2(x, sskgen2(r), r2)), ! !_12 <= N4 (m: sblocksize, y: spkey, si: signature) -> find j <= N2, k_14 <= N3 suchthat defined(x[j, k_14], r[k_14]) && ((y = spkgen2(r[k_14])) && ((m = x[j, k_14]) && check2(m, y, si))) then true else find k_13 <= N3 suchthat defined(r[k_13]) && (y = spkgen2(r[k_13])) then false else check(m, y, si)
with rkCs [Difference of probability Psign(time + time(context for game 9), N)] yields

Game 10 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen(rkC) in
let skC: skey = skgen(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkK: keyseed;
let pkK: pkey = pkgen(rkK) in
new rkKs: skeyseed;
let spkK: spkey = spkgen(rkKs) in
let sskK: sskey = sskgen(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
let x_89: sblocksize = concat7(K, pkK, spkK) in
new q2: sseed;
let certK: signature = sign2(x_89, sskgen2(rkCA), q2) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n1: nonce;
          new n2: nonce;
          new r1: sseed;
          let x_121: sblocksize = padno(n2) in
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          let injbot1(concat2(hostZ: kas, pkZ: pkey, spkZ: spkey, ms1: signature, k3: protkey, ck1: macs, ms2: signature)) = dec(m21, skC) in
          if (((hostZ = K) && ((pkZ = pkK) && (spkZ = spkK))) && check2(concat7(hostZ, pkZ, spkZ), pkCA, ms1)) then
          if (spkK = spkgen2(rkCA)) then
            yield
          else
            find @i_126 <= N suchthat defined(x_119[@i_126], rkCs) && ((spkK = spkgen2(rkCs)) && ((concat3(k3, ck1) = x_119[@i_126]) && check2(concat3(k3, ck1), spkK, ms2))) then
              if true then
              let k1': key = keyderivation(k3, un1) in
              let k2': key = keyderivation(k3, un2) in
              let x_119: sblocksize = padno(n2) in
              let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
              if checkmac(y', k2', ck1) then
              let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
              event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
              out(c18[!_35], acceptC1(hostZ, hostT));
              ! !_36 <= N3
              in(c17[!_36, !_35], (hosT': tgs, hostS: server));
              if (hosT' = hostT) then
              new tc: timest;
              new r7_61: symseed;
              let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
              event partCT(hostT, TGT_58, e5);
              new n3: nonce;
              out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
              in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
              let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
              event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_64: timest;
              new r2: symseed;
              let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_126 <= N suchthat defined(x_121[@i_126], rkCs) && ((spkK = spkgen2(rkCs)) && ((concat3(k3, ck1) = x_121[@i_126]) && check2(concat3(k3, ck1), spkK, ms2))) then
              if true then
              let k1': key = keyderivation(k3, un1) in
              let k2': key = keyderivation(k3, un2) in
              let x_119: sblocksize = padno(n2) in
              let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
              if checkmac(y', k2', ck1) then
              let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
              event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
              out(c18[!_35], acceptC1(hostZ, hostT));
              ! !_36 <= N3
              in(c17[!_36, !_35], (hosT': tgs, hostS: server));
              if (hosT' = hostT) then
              new tc: timest;
              new r7_61: symseed;
              let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
              event partCT(hostT, TGT_58, e5);
              new n3: nonce;
              out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
              in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
              let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
              event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_64: timest;
              new r2: symseed;
              let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            else
              if defined(rkCs) && (spkK = spkgen2(rkCs)) then
                if false then
                let k1': key = keyderivation(k3, un1) in
                let k2': key = keyderivation(k3, un2) in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck1) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc: timest;
                new r7_61: symseed;
                let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
                event partCT(hostT, TGT_58, e5);
                new n3: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_64: timest;
                new r2: symseed;
                let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              else
                if check(concat3(k3, ck1), spkK, ms2) then
                let k1': key = keyderivation(k3, un1) in
                let k2': key = keyderivation(k3, un2) in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck1) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc: timest;
                new r7_61: symseed;
                let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
                event partCT(hostT, TGT_58, e5);
                new n3: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_64: timest;
                new r2: symseed;
                let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          if (spkY = spkgen2(rkCA)) then
            yield
          else
            find @i_123 <= N suchthat defined(x_119[@i_123], rkCs) && ((spkY = spkgen2(rkCs)) && ((padno(n4) = x_119[@i_123]) && check2(padno(n4), spkY, ms4))) then
              if true then
              find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
              new s3: symkeyseed;
              let AK_54: key = kgen(s3) in
              new kp: protkey;
              let k1: key = keyderivation(kp, un1) in
              let k2: key = keyderivation(kp, un2) in
              new tk_55: timest;
              new r4: symseed;
              let TGT_56: maxmac = encsym(concat5(AK_54, tk_55, hostY_53), Qkey[j1], r4) in
              new r5: symseed;
              let e24: maxmac = encsym(concat4(AK_54, n5, tk_55, hostW_52), k1, r5) in
              let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
              let ck: macs = mac(y, k2) in
              new r6: sseed;
              let ms21: signature = sign(concat3(kp, ck), sskK, r6) in
              new r7_57: seed;
              let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp, ck, ms21), pkY, r7_57) in
              let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
              event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
              out(c23[!_38], m5)
            orfind @i_123 <= N suchthat defined(x_121[@i_123], rkCs) && ((spkY = spkgen2(rkCs)) && ((padno(n4) = x_121[@i_123]) && check2(padno(n4), spkY, ms4))) then
              if true then
              find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
              new s3: symkeyseed;
              let AK_54: key = kgen(s3) in
              new kp: protkey;
              let k1: key = keyderivation(kp, un1) in
              let k2: key = keyderivation(kp, un2) in
              new tk_55: timest;
              new r4: symseed;
              let TGT_56: maxmac = encsym(concat5(AK_54, tk_55, hostY_53), Qkey[j1], r4) in
              new r5: symseed;
              let e24: maxmac = encsym(concat4(AK_54, n5, tk_55, hostW_52), k1, r5) in
              let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
              let ck: macs = mac(y, k2) in
              new r6: sseed;
              let ms21: signature = sign(concat3(kp, ck), sskK, r6) in
              new r7_57: seed;
              let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp, ck, ms21), pkY, r7_57) in
              let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
              event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
              out(c23[!_38], m5)
            else
              if defined(rkCs) && (spkY = spkgen2(rkCs)) then
                if false then
                find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
                new s3: symkeyseed;
                let AK_54: key = kgen(s3) in
                new kp: protkey;
                let k1: key = keyderivation(kp, un1) in
                let k2: key = keyderivation(kp, un2) in
                new tk_55: timest;
                new r4: symseed;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_55, hostY_53), Qkey[j1], r4) in
                new r5: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_55, hostW_52), k1, r5) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r6: sseed;
                let ms21: signature = sign(concat3(kp, ck), sskK, r6) in
                new r7_57: seed;
                let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp, ck, ms21), pkY, r7_57) in
                let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
                out(c23[!_38], m5)
              else
                if check(padno(n4), spkY, ms4) then
                find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
                new s3: symkeyseed;
                let AK_54: key = kgen(s3) in
                new kp: protkey;
                let k1: key = keyderivation(kp, un1) in
                let k2: key = keyderivation(kp, un2) in
                new tk_55: timest;
                new r4: symseed;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_55, hostY_53), Qkey[j1], r4) in
                new r5: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_55, hostW_52), k1, r5) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r6: sseed;
                let ms21: signature = sign(concat3(kp, ck), sskK, r6) in
                new r7_57: seed;
                let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp, ck, ms21), pkY, r7_57) in
                let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
                out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new tt_51: timest;
        new r10: symseed;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying simplify [Difference of probability Psigncoll + 1. / |skeyseed|] yields

Game 11 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen(rkC) in
let skC: skey = skgen(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkK: keyseed;
let pkK: pkey = pkgen(rkK) in
new rkKs: skeyseed;
let spkK: spkey = spkgen(rkKs) in
let sskK: sskey = sskgen(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
let x_89: sblocksize = concat7(K, pkK, spkK) in
new q2: sseed;
let certK: signature = sign2(x_89, sskgen2(rkCA), q2) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n1: nonce;
          new n2: nonce;
          new r1: sseed;
          let x_121: sblocksize = padno(n2) in
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          let injbot1(concat2(hostZ: kas, pkZ: pkey, spkZ: spkey, ms1: signature, k3: protkey, ck1: macs, ms2: signature)) = dec(m21, skC) in
          if (((hostZ = K) && ((pkZ = pkK) && (spkZ = spkK))) && check2(concat7(hostZ, pkZ, spkZ), pkCA, ms1)) then
          if (spkK = spkgen2(rkCA)) then
            yield
          else
            if (spkK = spkgen2(rkCs)) then
              yield
            else
              if check(concat3(k3, ck1), spkK, ms2) then
              let k1': key = keyderivation(k3, un1) in
              let k2': key = keyderivation(k3, un2) in
              let x_119: sblocksize = padno(n2) in
              let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
              if checkmac(y', k2', ck1) then
              let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
              event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
              out(c18[!_35], acceptC1(hostZ, hostT));
              ! !_36 <= N3
              in(c17[!_36, !_35], (hosT': tgs, hostS: server));
              if (hosT' = hostT) then
              new tc: timest;
              new r7_61: symseed;
              let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
              event partCT(hostT, TGT_58, e5);
              new n3: nonce;
              out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
              in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
              let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
              event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_64: timest;
              new r2: symseed;
              let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3: symkeyseed;
            let AK_54: key = kgen(s3) in
            new kp: protkey;
            let k1: key = keyderivation(kp, un1) in
            let k2: key = keyderivation(kp, un2) in
            new tk_55: timest;
            new r4: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_55, hostY_53), Qkey[j1], r4) in
            new r5: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_55, hostW_52), k1, r5) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r6: sseed;
            let ms21: signature = sign(concat3(kp, ck), sskK, r6) in
            new r7_57: seed;
            let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp, ck, ms21), pkY, r7_57) in
            let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3: symkeyseed;
            let AK_54: key = kgen(s3) in
            new kp: protkey;
            let k1: key = keyderivation(kp, un1) in
            let k2: key = keyderivation(kp, un2) in
            new tk_55: timest;
            new r4: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_55, hostY_53), Qkey[j1], r4) in
            new r5: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_55, hostW_52), k1, r5) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r6: sseed;
            let ms21: signature = sign(concat3(kp, ck), sskK, r6) in
            new r7_57: seed;
            let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp, ck, ms21), pkY, r7_57) in
            let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new tt_51: timest;
        new r10: symseed;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying move new all binders yields

Game 12 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen(rkC) in
let skC: skey = skgen(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkK: keyseed;
let pkK: pkey = pkgen(rkK) in
new rkKs: skeyseed;
let spkK: spkey = spkgen(rkKs) in
let sskK: sskey = sskgen(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
let x_89: sblocksize = concat7(K, pkK, spkK) in
new q2: sseed;
let certK: signature = sign2(x_89, sskgen2(rkCA), q2) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          let injbot1(concat2(hostZ: kas, pkZ: pkey, spkZ: spkey, ms1: signature, k3: protkey, ck1: macs, ms2: signature)) = dec(m21, skC) in
          if (((hostZ = K) && ((pkZ = pkK) && (spkZ = spkK))) && check2(concat7(hostZ, pkZ, spkZ), pkCA, ms1)) then
          if (spkK = spkgen2(rkCA)) then
            yield
          else
            if (spkK = spkgen2(rkCs)) then
              yield
            else
              if check(concat3(k3, ck1), spkK, ms2) then
              let k1': key = keyderivation(k3, un1) in
              let k2': key = keyderivation(k3, un2) in
              let x_119: sblocksize = padno(n2) in
              let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
              if checkmac(y', k2', ck1) then
              let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
              event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
              out(c18[!_35], acceptC1(hostZ, hostT));
              ! !_36 <= N3
              in(c17[!_36, !_35], (hosT': tgs, hostS: server));
              if (hosT' = hostT) then
              new r7_61: symseed;
              new tc: timest;
              let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
              event partCT(hostT, TGT_58, e5);
              new n3: nonce;
              out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
              in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
              let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
              event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2: symseed;
              new tc'_64: timest;
              let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3: symkeyseed;
            let AK_54: key = kgen(s3) in
            new kp: protkey;
            let k1: key = keyderivation(kp, un1) in
            let k2: key = keyderivation(kp, un2) in
            new r4: symseed;
            new tk_55: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_55, hostY_53), Qkey[j1], r4) in
            new r5: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_55, hostW_52), k1, r5) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r6: sseed;
            let ms21: signature = sign(concat3(kp, ck), sskK, r6) in
            new r7_57: seed;
            let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp, ck, ms21), pkY, r7_57) in
            let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3: symkeyseed;
            let AK_54: key = kgen(s3) in
            new kp: protkey;
            let k1: key = keyderivation(kp, un1) in
            let k2: key = keyderivation(kp, un2) in
            new r4: symseed;
            new tk_55: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_55, hostY_53), Qkey[j1], r4) in
            new r5: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_55, hostW_52), k1, r5) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r6: sseed;
            let ms21: signature = sign(concat3(kp, ck), sskK, r6) in
            new r7_57: seed;
            let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp, ck, ms21), pkY, r7_57) in
            let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying remove assignments of useless yields

Game 13 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen(rkC) in
let skC: skey = skgen(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkK: keyseed;
let pkK: pkey = pkgen(rkK) in
new rkKs: skeyseed;
let spkK: spkey = spkgen(rkKs) in
let sskK: sskey = sskgen(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
let x_89: sblocksize = concat7(K, pkK, spkK) in
new q2: sseed;
let certK: signature = sign2(x_89, sskgen2(rkCA), q2) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          let injbot1(concat2(hostZ: kas, pkZ: pkey, spkZ: spkey, ms1: signature, k3: protkey, ck1: macs, ms2: signature)) = dec(m21, skC) in
          if (((hostZ = K) && ((pkZ = pkK) && (spkZ = spkK))) && check2(concat7(hostZ, pkZ, spkZ), pkCA, ms1)) then
          if (spkK = spkgen2(rkCA)) then
            yield
          else
            if (spkK = spkgen2(rkCs)) then
              yield
            else
              if check(concat3(k3, ck1), spkK, ms2) then
              let k1': key = keyderivation(k3, un1) in
              let k2': key = keyderivation(k3, un2) in
              let x_119: sblocksize = padno(n2) in
              let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
              if checkmac(y', k2', ck1) then
              let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
              event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
              out(c18[!_35], acceptC1(hostZ, hostT));
              ! !_36 <= N3
              in(c17[!_36, !_35], (hosT': tgs, hostS: server));
              if (hosT' = hostT) then
              new r7_61: symseed;
              new tc: timest;
              let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
              event partCT(hostT, TGT_58, e5);
              new n3: nonce;
              out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
              in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
              let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
              event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2: symseed;
              new tc'_64: timest;
              let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new kp_146: protkey;
            let k1: key = keyderivation(kp_146, un1) in
            let k2: key = keyderivation(kp_146, un2) in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r6_150: sseed;
            let ms21: signature = sign(concat3(kp_146, ck), sskK, r6_150) in
            new r7_151: seed;
            let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp_146, ck, ms21), pkY, r7_151) in
            let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new kp_153: protkey;
            let k1: key = keyderivation(kp_153, un1) in
            let k2: key = keyderivation(kp_153, un2) in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r6_157: sseed;
            let ms21: signature = sign(concat3(kp_153, ck), sskK, r6_157) in
            new r7_158: seed;
            let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp_153, ck, ms21), pkY, r7_158) in
            let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying remove assignments of binder skC yields

Game 14 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkK: keyseed;
let pkK: pkey = pkgen(rkK) in
new rkKs: skeyseed;
let spkK: spkey = spkgen(rkKs) in
let sskK: sskey = sskgen(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
let x_89: sblocksize = concat7(K, pkK, spkK) in
new q2: sseed;
let certK: signature = sign2(x_89, sskgen2(rkCA), q2) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          let injbot1(concat2(hostZ: kas, pkZ: pkey, spkZ: spkey, ms1: signature, k3: protkey, ck1: macs, ms2: signature)) = dec(m21, skgen(rkC)) in
          if (((hostZ = K) && ((pkZ = pkK) && (spkZ = spkK))) && check2(concat7(hostZ, pkZ, spkZ), pkCA, ms1)) then
          if (spkK = spkgen2(rkCA)) then
            yield
          else
            if (spkK = spkgen2(rkCs)) then
              yield
            else
              if check(concat3(k3, ck1), spkK, ms2) then
              let k1': key = keyderivation(k3, un1) in
              let k2': key = keyderivation(k3, un2) in
              let x_119: sblocksize = padno(n2) in
              let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
              if checkmac(y', k2', ck1) then
              let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
              event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
              out(c18[!_35], acceptC1(hostZ, hostT));
              ! !_36 <= N3
              in(c17[!_36, !_35], (hosT': tgs, hostS: server));
              if (hosT' = hostT) then
              new r7_61: symseed;
              new tc: timest;
              let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
              event partCT(hostT, TGT_58, e5);
              new n3: nonce;
              out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
              in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
              let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
              event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2: symseed;
              new tc'_64: timest;
              let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new kp_146: protkey;
            let k1: key = keyderivation(kp_146, un1) in
            let k2: key = keyderivation(kp_146, un2) in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r6_150: sseed;
            let ms21: signature = sign(concat3(kp_146, ck), sskK, r6_150) in
            new r7_151: seed;
            let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp_146, ck, ms21), pkY, r7_151) in
            let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new kp_153: protkey;
            let k1: key = keyderivation(kp_153, un1) in
            let k2: key = keyderivation(kp_153, un2) in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r6_157: sseed;
            let ms21: signature = sign(concat3(kp_153, ck), sskK, r6_157) in
            new r7_158: seed;
            let e21: bitstring = enc(concat2(K, pkK, spkK, certK, kp_153, ck, ms21), pkY, r7_158) in
            let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying equivalence
equiv ! !_1 <= N3 new r: keyseed; (
  () -> pkgen(r),
  ! !_2 <= N2 (m: bitstring) -> dec(m, skgen(r))), ! !_3 <= N4 new r2: seed; (x: blocksize, y: pkey) -> enc(x, y, r2) [all]
<=(N3 * N4 * Penc(time, N2))=>
      ! !_4 <= N3 new r: keyseed; (
  () -> pkgen2(r),
  ! !_5 <= N2 (m: bitstring) -> find j <= N4 suchthat defined(m2[j], y[j], x[j]) && ((y[j] = pkgen2(r)) && (m = m2[j])) then injbot1(x[j]) else dec2(m, skgen2(r))), ! !_6 <= N4 new r2: seed; new r3: seed; (x_82: blocksize, y_81: pkey) -> let x: blocksize = x_82 in let y: pkey = y_81 in find k <= N3 suchthat defined(r[k]) && (y = pkgen2(r[k])) then let m2: bitstring = enc2(Z, y, r2) in m2 else enc(x, y, r3)
with r7_158, r7_151, rkC [Difference of probability N * Penc(time + time(context for game 14), N)] yields

Game 15 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkK: keyseed;
let pkK: pkey = pkgen(rkK) in
new rkKs: skeyseed;
let spkK: spkey = spkgen(rkKs) in
let sskK: sskey = sskgen(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
let x_89: sblocksize = concat7(K, pkK, spkK) in
new q2: sseed;
let certK: signature = sign2(x_89, sskgen2(rkCA), q2) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(m2_169[@i_184], y_170[@i_184], x_171[@i_184]) && ((y_170[@i_184] = pkgen2(rkC)) && (m21 = m2_169[@i_184])) then
            let injbot1(concat2(hostZ: kas, pkZ: pkey, spkZ: spkey, ms1: signature, k3: protkey, ck1: macs, ms2: signature)) = injbot1(x_171[@i_184]) in
            if (((hostZ = K) && ((pkZ = pkK) && (spkZ = spkK))) && check2(concat7(hostZ, pkZ, spkZ), pkCA, ms1)) then
            if (spkK = spkgen2(rkCA)) then
              yield
            else
              if (spkK = spkgen2(rkCs)) then
                yield
              else
                if check(concat3(k3, ck1), spkK, ms2) then
                let k1': key = keyderivation(k3, un1) in
                let k2': key = keyderivation(k3, un2) in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck1) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_61: symseed;
                new tc: timest;
                let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
                event partCT(hostT, TGT_58, e5);
                new n3: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2: symseed;
                new tc'_64: timest;
                let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(m2_174[@i_183], y_175[@i_183], x_176[@i_183]) && ((y_175[@i_183] = pkgen2(rkC)) && (m21 = m2_174[@i_183])) then
            let injbot1(concat2(hostZ: kas, pkZ: pkey, spkZ: spkey, ms1: signature, k3: protkey, ck1: macs, ms2: signature)) = injbot1(x_176[@i_183]) in
            if (((hostZ = K) && ((pkZ = pkK) && (spkZ = spkK))) && check2(concat7(hostZ, pkZ, spkZ), pkCA, ms1)) then
            if (spkK = spkgen2(rkCA)) then
              yield
            else
              if (spkK = spkgen2(rkCs)) then
                yield
              else
                if check(concat3(k3, ck1), spkK, ms2) then
                let k1': key = keyderivation(k3, un1) in
                let k2': key = keyderivation(k3, un2) in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck1) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_61: symseed;
                new tc: timest;
                let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
                event partCT(hostT, TGT_58, e5);
                new n3: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2: symseed;
                new tc'_64: timest;
                let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          else
            let injbot1(concat2(hostZ: kas, pkZ: pkey, spkZ: spkey, ms1: signature, k3: protkey, ck1: macs, ms2: signature)) = dec2(m21, skgen2(rkC)) in
            if (((hostZ = K) && ((pkZ = pkK) && (spkZ = spkK))) && check2(concat7(hostZ, pkZ, spkZ), pkCA, ms1)) then
            if (spkK = spkgen2(rkCA)) then
              yield
            else
              if (spkK = spkgen2(rkCs)) then
                yield
              else
                if check(concat3(k3, ck1), spkK, ms2) then
                let k1': key = keyderivation(k3, un1) in
                let k2': key = keyderivation(k3, un2) in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck1) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_61: symseed;
                new tc: timest;
                let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
                event partCT(hostT, TGT_58, e5);
                new n3: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2: symseed;
                new tc'_64: timest;
                let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new kp_146: protkey;
            let k1: key = keyderivation(kp_146, un1) in
            let k2: key = keyderivation(kp_146, un2) in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r6_150: sseed;
            let ms21: signature = sign(concat3(kp_146, ck), sskK, r6_150) in
            new r7_151: seed;
            new r3_172: seed;
            let x_171: blocksize = concat2(K, pkK, spkK, certK, kp_146, ck, ms21) in
            let y_170: pkey = pkY in
            if defined(rkC) && (y_170 = pkgen2(rkC)) then
              let m2_169: bitstring = enc2(Z, y_170, r7_151) in
              let e21: bitstring = m2_169 in
              let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
              event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
              out(c23[!_38], m5)
            else
              let e21: bitstring = enc(x_171, y_170, r3_172) in
              let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
              event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new kp_153: protkey;
            let k1: key = keyderivation(kp_153, un1) in
            let k2: key = keyderivation(kp_153, un2) in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r6_157: sseed;
            let ms21: signature = sign(concat3(kp_153, ck), sskK, r6_157) in
            new r7_158: seed;
            new r3_177: seed;
            let x_176: blocksize = concat2(K, pkK, spkK, certK, kp_153, ck, ms21) in
            let y_175: pkey = pkY in
            if defined(rkC) && (y_175 = pkgen2(rkC)) then
              let m2_174: bitstring = enc2(Z, y_175, r7_158) in
              let e21: bitstring = m2_174 in
              let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
              event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
              out(c23[!_38], m5)
            else
              let e21: bitstring = enc(x_176, y_175, r3_177) in
              let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
              event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying simplify yields

Game 16 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkK: keyseed;
let pkK: pkey = pkgen(rkK) in
new rkKs: skeyseed;
let spkK: spkey = spkgen(rkKs) in
let sskK: sskey = sskgen(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
let x_89: sblocksize = concat7(K, pkK, spkK) in
new q2: sseed;
let certK: signature = sign2(x_89, sskgen2(rkCA), q2) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(ms21[@i_184], ck[@i_184], kp_146[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            let pkZ: pkey = pkK in
            let spkZ: spkey = spkK in
            let ms1: signature = certK in
            let k3: protkey = kp_146[@i_184] in
            let ck1: macs = ck[@i_184] in
            let ms2: signature = ms21[@i_184] in
            if (spkK = spkgen2(rkCA)) then
              yield
            else
              if (spkK = spkgen2(rkCs)) then
                yield
              else
                let k1': key = keyderivation(k3, un1) in
                let k2': key = keyderivation(k3, un2) in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck1) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_61: symseed;
                new tc: timest;
                let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
                event partCT(hostT, TGT_58, e5);
                new n3: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2: symseed;
                new tc'_64: timest;
                let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(ms21[@i_183], ck[@i_183], kp_153[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            let pkZ: pkey = pkK in
            let spkZ: spkey = spkK in
            let ms1: signature = certK in
            let k3: protkey = kp_153[@i_183] in
            let ck1: macs = ck[@i_183] in
            let ms2: signature = ms21[@i_183] in
            if (spkK = spkgen2(rkCA)) then
              yield
            else
              if (spkK = spkgen2(rkCs)) then
                yield
              else
                let k1': key = keyderivation(k3, un1) in
                let k2': key = keyderivation(k3, un2) in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck1) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_61: symseed;
                new tc: timest;
                let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
                event partCT(hostT, TGT_58, e5);
                new n3: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2: symseed;
                new tc'_64: timest;
                let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          else
            let injbot1(concat2(hostZ: kas, pkZ: pkey, spkZ: spkey, ms1: signature, k3: protkey, ck1: macs, ms2: signature)) = dec2(m21, skgen2(rkC)) in
            if (((hostZ = K) && ((pkZ = pkK) && (spkZ = spkK))) && check2(concat7(hostZ, pkZ, spkZ), pkCA, ms1)) then
            if (spkK = spkgen2(rkCA)) then
              yield
            else
              if (spkK = spkgen2(rkCs)) then
                yield
              else
                if check(concat3(k3, ck1), spkK, ms2) then
                let k1': key = keyderivation(k3, un1) in
                let k2': key = keyderivation(k3, un2) in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck1) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_61: symseed;
                new tc: timest;
                let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
                event partCT(hostT, TGT_58, e5);
                new n3: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2: symseed;
                new tc'_64: timest;
                let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new kp_146: protkey;
            let k1: key = keyderivation(kp_146, un1) in
            let k2: key = keyderivation(kp_146, un2) in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r6_150: sseed;
            let ms21: signature = sign(concat3(kp_146, ck), sskK, r6_150) in
            new r7_151: seed;
            let x_171: blocksize = concat2(K, pkK, spkK, certK, kp_146, ck, ms21) in
            let y_170: pkey = pkY in
            let m2_169: bitstring = enc2(Z, y_170, r7_151) in
            let e21: bitstring = m2_169 in
            let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new kp_153: protkey;
            let k1: key = keyderivation(kp_153, un1) in
            let k2: key = keyderivation(kp_153, un2) in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r6_157: sseed;
            let ms21: signature = sign(concat3(kp_153, ck), sskK, r6_157) in
            new r7_158: seed;
            let x_176: blocksize = concat2(K, pkK, spkK, certK, kp_153, ck, ms21) in
            let y_175: pkey = pkY in
            let m2_174: bitstring = enc2(Z, y_175, r7_158) in
            let e21: bitstring = m2_174 in
            let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying move new all binders yields

Game 17 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkK: keyseed;
let pkK: pkey = pkgen(rkK) in
new rkKs: skeyseed;
let spkK: spkey = spkgen(rkKs) in
let sskK: sskey = sskgen(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
let x_89: sblocksize = concat7(K, pkK, spkK) in
new q2: sseed;
let certK: signature = sign2(x_89, sskgen2(rkCA), q2) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(ms21[@i_184], ck[@i_184], kp_146[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            let pkZ: pkey = pkK in
            let spkZ: spkey = spkK in
            let ms1: signature = certK in
            let k3: protkey = kp_146[@i_184] in
            let ck1: macs = ck[@i_184] in
            let ms2: signature = ms21[@i_184] in
            if (spkK = spkgen2(rkCA)) then
              yield
            else
              if (spkK = spkgen2(rkCs)) then
                yield
              else
                let k1': key = keyderivation(k3, un1) in
                let k2': key = keyderivation(k3, un2) in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck1) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc: timest;
                new r7_61: symseed;
                let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
                event partCT(hostT, TGT_58, e5);
                new n3: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_64: timest;
                new r2: symseed;
                let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(ms21[@i_183], ck[@i_183], kp_153[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            let pkZ: pkey = pkK in
            let spkZ: spkey = spkK in
            let ms1: signature = certK in
            let k3: protkey = kp_153[@i_183] in
            let ck1: macs = ck[@i_183] in
            let ms2: signature = ms21[@i_183] in
            if (spkK = spkgen2(rkCA)) then
              yield
            else
              if (spkK = spkgen2(rkCs)) then
                yield
              else
                let k1': key = keyderivation(k3, un1) in
                let k2': key = keyderivation(k3, un2) in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck1) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc: timest;
                new r7_61: symseed;
                let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
                event partCT(hostT, TGT_58, e5);
                new n3: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_64: timest;
                new r2: symseed;
                let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          else
            let injbot1(concat2(hostZ: kas, pkZ: pkey, spkZ: spkey, ms1: signature, k3: protkey, ck1: macs, ms2: signature)) = dec2(m21, skgen2(rkC)) in
            if (((hostZ = K) && ((pkZ = pkK) && (spkZ = spkK))) && check2(concat7(hostZ, pkZ, spkZ), pkCA, ms1)) then
            if (spkK = spkgen2(rkCA)) then
              yield
            else
              if (spkK = spkgen2(rkCs)) then
                yield
              else
                if check(concat3(k3, ck1), spkK, ms2) then
                let k1': key = keyderivation(k3, un1) in
                let k2': key = keyderivation(k3, un2) in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck1) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc: timest;
                new r7_61: symseed;
                let e5: maxmac = encsym(pad(C, tc), AK_60, r7_61) in
                event partCT(hostT, TGT_58, e5);
                new n3: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_64: timest;
                new r2: symseed;
                let e12: maxmac = encsym(pad(C, tc'_64), SK_63, r2) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_64)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new kp_146: protkey;
            let k1: key = keyderivation(kp_146, un1) in
            let k2: key = keyderivation(kp_146, un2) in
            new tk_148: timest;
            new r4_147: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r6_150: sseed;
            let ms21: signature = sign(concat3(kp_146, ck), sskK, r6_150) in
            let x_171: blocksize = concat2(K, pkK, spkK, certK, kp_146, ck, ms21) in
            let y_170: pkey = pkY in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, y_170, r7_151) in
            let e21: bitstring = m2_169 in
            let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new kp_153: protkey;
            let k1: key = keyderivation(kp_153, un1) in
            let k2: key = keyderivation(kp_153, un2) in
            new tk_155: timest;
            new r4_154: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r6_157: sseed;
            let ms21: signature = sign(concat3(kp_153, ck), sskK, r6_157) in
            let x_176: blocksize = concat2(K, pkK, spkK, certK, kp_153, ck, ms21) in
            let y_175: pkey = pkY in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, y_175, r7_158) in
            let e21: bitstring = m2_174 in
            let m5: bitstring = (e21, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, e21, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new tt_51: timest;
        new r10: symseed;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying remove assignments of useless yields

Game 18 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkK: keyseed;
let pkK: pkey = pkgen(rkK) in
new rkKs: skeyseed;
let spkK: spkey = spkgen(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new q2: sseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(ms21[@i_184], ck[@i_184], kp_146[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if (spkK = spkgen2(rkCA)) then
              yield
            else
              if (spkK = spkgen2(rkCs)) then
                yield
              else
                let k1': key = keyderivation(kp_146[@i_184], un1) in
                let k2': key = keyderivation(kp_146[@i_184], un2) in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_206: timest;
                new r7_207: symseed;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_209: timest;
                new r2_210: symseed;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(ms21[@i_183], ck[@i_183], kp_153[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if (spkK = spkgen2(rkCA)) then
              yield
            else
              if (spkK = spkgen2(rkCs)) then
                yield
              else
                let k1': key = keyderivation(kp_153[@i_183], un1) in
                let k2': key = keyderivation(kp_153[@i_183], un2) in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_211: timest;
                new r7_212: symseed;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_214: timest;
                new r2_215: symseed;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          else
            let injbot1(concat2(hostZ: kas, pkZ: pkey, spkZ: spkey, ms1: signature, k3: protkey, ck1: macs, ms2: signature)) = dec2(m21, skgen2(rkC)) in
            if (((hostZ = K) && ((pkZ = pkK) && (spkZ = spkK))) && check2(concat7(hostZ, pkZ, spkZ), pkCA, ms1)) then
            if (spkK = spkgen2(rkCA)) then
              yield
            else
              if (spkK = spkgen2(rkCs)) then
                yield
              else
                if check(concat3(k3, ck1), spkK, ms2) then
                let k1': key = keyderivation(k3, un1) in
                let k2': key = keyderivation(k3, un2) in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck1) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_201: timest;
                new r7_202: symseed;
                let e5: maxmac = encsym(pad(C, tc_201), AK_60, r7_202) in
                event partCT(hostT, TGT_58, e5);
                new n3_203: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_203));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_203, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_203, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_204: timest;
                new r2_205: symseed;
                let e12: maxmac = encsym(pad(C, tc'_204), SK_63, r2_205) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_204)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new kp_146: protkey;
            let k1: key = keyderivation(kp_146, un1) in
            let k2: key = keyderivation(kp_146, un2) in
            new tk_148: timest;
            new r4_147: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r6_150: sseed;
            let ms21: signature = cst_signature in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new kp_153: protkey;
            let k1: key = keyderivation(kp_153, un1) in
            let k2: key = keyderivation(kp_153, un2) in
            new tk_155: timest;
            new r4_154: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r6_157: sseed;
            let ms21: signature = cst_signature in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new tt_51: timest;
        new r10: symseed;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying equivalence
equiv ! !_7 <= N3 new r: skeyseed; (
  () -> spkgen(r),
  ! !_8 <= N2 new r2: sseed; (x: sblocksize) -> sign(x, sskgen(r), r2)), ! !_9 <= N4 (m: sblocksize, y: spkey, si: signature) -> check(m, y, si) [all]
<=(N3 * Psign(time, N2))=>
      ! !_10 <= N3 new r: skeyseed; (
  () -> spkgen2(r),
  ! !_11 <= N2 new r2: sseed; (x_80: sblocksize) -> let x: sblocksize = x_80 in sign2(x, sskgen2(r), r2)), ! !_12 <= N4 (m: sblocksize, y: spkey, si: signature) -> find j <= N2, k_14 <= N3 suchthat defined(x[j, k_14], r[k_14]) && ((y = spkgen2(r[k_14])) && ((m = x[j, k_14]) && check2(m, y, si))) then true else find k_13 <= N3 suchthat defined(r[k_13]) && (y = spkgen2(r[k_13])) then false else check(m, y, si)
with rkKs [Difference of probability Psign(time + time(context for game 18), 0)] yields

Game 19 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkK: keyseed;
let pkK: pkey = pkgen(rkK) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new q2: sseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(ms21[@i_184], ck[@i_184], kp_146[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if (spkK = spkgen2(rkCA)) then
              yield
            else
              if (spkK = spkgen2(rkCs)) then
                yield
              else
                let k1': key = keyderivation(kp_146[@i_184], un1) in
                let k2': key = keyderivation(kp_146[@i_184], un2) in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_206: timest;
                new r7_207: symseed;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_209: timest;
                new r2_210: symseed;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(ms21[@i_183], ck[@i_183], kp_153[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if (spkK = spkgen2(rkCA)) then
              yield
            else
              if (spkK = spkgen2(rkCs)) then
                yield
              else
                let k1': key = keyderivation(kp_153[@i_183], un1) in
                let k2': key = keyderivation(kp_153[@i_183], un2) in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_211: timest;
                new r7_212: symseed;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_214: timest;
                new r2_215: symseed;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          else
            let injbot1(concat2(hostZ: kas, pkZ: pkey, spkZ: spkey, ms1: signature, k3: protkey, ck1: macs, ms2: signature)) = dec2(m21, skgen2(rkC)) in
            if (((hostZ = K) && ((pkZ = pkK) && (spkZ = spkK))) && check2(concat7(hostZ, pkZ, spkZ), pkCA, ms1)) then
            if (spkK = spkgen2(rkCA)) then
              yield
            else
              if (spkK = spkgen2(rkCs)) then
                yield
              else
                find                 else
                  if defined(rkKs) && (spkK = spkgen2(rkKs)) then
                    if false then
                    let k1': key = keyderivation(k3, un1) in
                    let k2': key = keyderivation(k3, un2) in
                    let x_119: sblocksize = padno(n2) in
                    let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                    if checkmac(y', k2', ck1) then
                    let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new tc_201: timest;
                    new r7_202: symseed;
                    let e5: maxmac = encsym(pad(C, tc_201), AK_60, r7_202) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_203: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_203));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_203, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                    event fullCT(hostT, hostS, n3_203, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new tc'_204: timest;
                    new r2_205: symseed;
                    let e12: maxmac = encsym(pad(C, tc'_204), SK_63, r2_205) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_204)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  else
                    if check(concat3(k3, ck1), spkK, ms2) then
                    let k1': key = keyderivation(k3, un1) in
                    let k2': key = keyderivation(k3, un2) in
                    let x_119: sblocksize = padno(n2) in
                    let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                    if checkmac(y', k2', ck1) then
                    let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new tc_201: timest;
                    new r7_202: symseed;
                    let e5: maxmac = encsym(pad(C, tc_201), AK_60, r7_202) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_203: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_203));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_203, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                    event fullCT(hostT, hostS, n3_203, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new tc'_204: timest;
                    new r2_205: symseed;
                    let e12: maxmac = encsym(pad(C, tc'_204), SK_63, r2_205) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_204)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new kp_146: protkey;
            let k1: key = keyderivation(kp_146, un1) in
            let k2: key = keyderivation(kp_146, un2) in
            new tk_148: timest;
            new r4_147: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r6_150: sseed;
            let ms21: signature = cst_signature in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new kp_153: protkey;
            let k1: key = keyderivation(kp_153, un1) in
            let k2: key = keyderivation(kp_153, un2) in
            new tk_155: timest;
            new r4_154: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r6_157: sseed;
            let ms21: signature = cst_signature in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new tt_51: timest;
        new r10: symseed;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying simplify [Difference of probability 2. * Psigncoll + 2. * 1. / |skeyseed|] yields

Game 20 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkK: keyseed;
let pkK: pkey = pkgen(rkK) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(ck[@i_184], kp_146[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            let k1': key = keyderivation(kp_146[@i_184], un1) in
            let k2': key = keyderivation(kp_146[@i_184], un2) in
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if checkmac(y', k2', ck[@i_184]) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_206: timest;
            new r7_207: symseed;
            let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
            event partCT(hostT, TGT_58, e5);
            new n3_208: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_209: timest;
            new r2_210: symseed;
            let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(ck[@i_183], kp_153[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            let k1': key = keyderivation(kp_153[@i_183], un1) in
            let k2': key = keyderivation(kp_153[@i_183], un2) in
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if checkmac(y', k2', ck[@i_183]) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_211: timest;
            new r7_212: symseed;
            let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
            event partCT(hostT, TGT_58, e5);
            new n3_213: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_214: timest;
            new r2_215: symseed;
            let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new kp_146: protkey;
            let k1: key = keyderivation(kp_146, un1) in
            let k2: key = keyderivation(kp_146, un2) in
            new tk_148: timest;
            new r4_147: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            let ms21: signature = cst_signature in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new kp_153: protkey;
            let k1: key = keyderivation(kp_153, un1) in
            let k2: key = keyderivation(kp_153, un2) in
            new tk_155: timest;
            new r4_154: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            let ms21: signature = cst_signature in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new tt_51: timest;
        new r10: symseed;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying move new all binders yields

Game 21 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkK: keyseed;
let pkK: pkey = pkgen(rkK) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(ck[@i_184], kp_146[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            let k1': key = keyderivation(kp_146[@i_184], un1) in
            let k2': key = keyderivation(kp_146[@i_184], un2) in
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if checkmac(y', k2', ck[@i_184]) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_207: symseed;
            new tc_206: timest;
            let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
            event partCT(hostT, TGT_58, e5);
            new n3_208: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_210: symseed;
            new tc'_209: timest;
            let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(ck[@i_183], kp_153[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            let k1': key = keyderivation(kp_153[@i_183], un1) in
            let k2': key = keyderivation(kp_153[@i_183], un2) in
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if checkmac(y', k2', ck[@i_183]) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_212: symseed;
            new tc_211: timest;
            let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
            event partCT(hostT, TGT_58, e5);
            new n3_213: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_215: symseed;
            new tc'_214: timest;
            let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new kp_146: protkey;
            let k1: key = keyderivation(kp_146, un1) in
            let k2: key = keyderivation(kp_146, un2) in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            let ms21: signature = cst_signature in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new kp_153: protkey;
            let k1: key = keyderivation(kp_153, un1) in
            let k2: key = keyderivation(kp_153, un2) in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            let ms21: signature = cst_signature in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying remove assignments of useless yields

Game 22 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkK: keyseed;
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(ck[@i_184], kp_146[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            let k1': key = keyderivation(kp_146[@i_184], un1) in
            let k2': key = keyderivation(kp_146[@i_184], un2) in
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if checkmac(y', k2', ck[@i_184]) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_207: symseed;
            new tc_206: timest;
            let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
            event partCT(hostT, TGT_58, e5);
            new n3_208: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_210: symseed;
            new tc'_209: timest;
            let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(ck[@i_183], kp_153[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            let k1': key = keyderivation(kp_153[@i_183], un1) in
            let k2': key = keyderivation(kp_153[@i_183], un2) in
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if checkmac(y', k2', ck[@i_183]) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_212: symseed;
            new tc_211: timest;
            let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
            event partCT(hostT, TGT_58, e5);
            new n3_213: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_215: symseed;
            new tc'_214: timest;
            let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new kp_146: protkey;
            let k1: key = keyderivation(kp_146, un1) in
            let k2: key = keyderivation(kp_146, un2) in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new kp_153: protkey;
            let k1: key = keyderivation(kp_153, un1) in
            let k2: key = keyderivation(kp_153, un2) in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying equivalence
equiv ! !_31 <= N2 new z: protkey; ! !_32 <= N (x: usenum) -> keyderivation(z, x)
<=(N2 * pPRF(time, N))=>
      ! !_33 <= N2 ! !_34 <= N (x_77: usenum) -> let x: usenum = x_77 in find u <= N suchthat defined(x[u], r[u]) && (x = x[u]) then r[u] else new s: symkeyseed; let r: key = kgen(s) in r
 [Difference of probability N * pPRF(time + time(context for game 22), 2. * 1. + 2. * N)] yields

Game 23 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkK: keyseed;
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(ck[@i_184], kp_146[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            let k1': key = keyderivation(kp_146[@i_184], un1) in
            let k2': key = keyderivation(kp_146[@i_184], un2) in
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if checkmac(y', k2', ck[@i_184]) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_207: symseed;
            new tc_206: timest;
            let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
            event partCT(hostT, TGT_58, e5);
            new n3_208: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_210: symseed;
            new tc'_209: timest;
            let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(ck[@i_183], kp_153[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            let x_260: usenum = un1 in
            find  suchthat defined(x_251[@i_183], r_249[@i_183]) && (x_260 = x_251[@i_183]) then
              let k1': key = r_249[@i_183] in
              let x_257: usenum = un2 in
              find  suchthat defined(x_251[@i_183], r_249[@i_183]) && (x_257 = x_251[@i_183]) then
                let k2': key = r_249[@i_183] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_212: symseed;
                new tc_211: timest;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_215: symseed;
                new tc'_214: timest;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(x_254[@i_183], r_252[@i_183]) && (x_257 = x_254[@i_183]) then
                let k2': key = r_252[@i_183] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_212: symseed;
                new tc_211: timest;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_215: symseed;
                new tc'_214: timest;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_270 <= N suchthat defined(x_257[@i_270], r_255[@i_270]) && ((@i_183[@i_270] = @i_183) && (x_257 = x_257[@i_270])) then
                let k2': key = r_255[@i_270] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_212: symseed;
                new tc_211: timest;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_215: symseed;
                new tc'_214: timest;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_269 <= N suchthat defined(x_260[@i_269], r_258[@i_269]) && ((@i_183[@i_269] = @i_183) && (x_257 = x_260[@i_269])) then
                let k2': key = r_258[@i_269] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_212: symseed;
                new tc_211: timest;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_215: symseed;
                new tc'_214: timest;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              else
                new s_256: symkeyseed;
                let r_255: key = kgen(s_256) in
                let k2': key = r_255 in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_212: symseed;
                new tc_211: timest;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_215: symseed;
                new tc'_214: timest;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind  suchthat defined(x_254[@i_183], r_252[@i_183]) && (x_260 = x_254[@i_183]) then
              let k1': key = r_252[@i_183] in
              let x_257: usenum = un2 in
              find  suchthat defined(x_251[@i_183], r_249[@i_183]) && (x_257 = x_251[@i_183]) then
                let k2': key = r_249[@i_183] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_212: symseed;
                new tc_211: timest;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_215: symseed;
                new tc'_214: timest;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(x_254[@i_183], r_252[@i_183]) && (x_257 = x_254[@i_183]) then
                let k2': key = r_252[@i_183] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_212: symseed;
                new tc_211: timest;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_215: symseed;
                new tc'_214: timest;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_270 <= N suchthat defined(x_257[@i_270], r_255[@i_270]) && ((@i_183[@i_270] = @i_183) && (x_257 = x_257[@i_270])) then
                let k2': key = r_255[@i_270] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_212: symseed;
                new tc_211: timest;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_215: symseed;
                new tc'_214: timest;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_269 <= N suchthat defined(x_260[@i_269], r_258[@i_269]) && ((@i_183[@i_269] = @i_183) && (x_257 = x_260[@i_269])) then
                let k2': key = r_258[@i_269] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_212: symseed;
                new tc_211: timest;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_215: symseed;
                new tc'_214: timest;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              else
                new s_256: symkeyseed;
                let r_255: key = kgen(s_256) in
                let k2': key = r_255 in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_212: symseed;
                new tc_211: timest;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_215: symseed;
                new tc'_214: timest;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_274 <= N suchthat defined(x_257[@i_274], r_255[@i_274]) && ((@i_183[@i_274] = @i_183) && (x_260 = x_257[@i_274])) then
              let k1': key = r_255[@i_274] in
              let x_257: usenum = un2 in
              find  suchthat defined(x_251[@i_183], r_249[@i_183]) && (x_257 = x_251[@i_183]) then
                let k2': key = r_249[@i_183] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_212: symseed;
                new tc_211: timest;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_215: symseed;
                new tc'_214: timest;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(x_254[@i_183], r_252[@i_183]) && (x_257 = x_254[@i_183]) then
                let k2': key = r_252[@i_183] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_212: symseed;
                new tc_211: timest;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_215: symseed;
                new tc'_214: timest;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_270 <= N suchthat defined(x_257[@i_270], r_255[@i_270]) && ((@i_183[@i_270] = @i_183) && (x_257 = x_257[@i_270])) then
                let k2': key = r_255[@i_270] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_212: symseed;
                new tc_211: timest;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_215: symseed;
                new tc'_214: timest;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_269 <= N suchthat defined(x_260[@i_269], r_258[@i_269]) && ((@i_183[@i_269] = @i_183) && (x_257 = x_260[@i_269])) then
                let k2': key = r_258[@i_269] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_212: symseed;
                new tc_211: timest;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_215: symseed;
                new tc'_214: timest;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              else
                new s_256: symkeyseed;
                let r_255: key = kgen(s_256) in
                let k2': key = r_255 in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_212: symseed;
                new tc_211: timest;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_215: symseed;
                new tc'_214: timest;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_273 <= N suchthat defined(x_260[@i_273], r_258[@i_273]) && ((@i_183[@i_273] = @i_183) && (x_260 = x_260[@i_273])) then
              let k1': key = r_258[@i_273] in
              let x_257: usenum = un2 in
              find  suchthat defined(x_251[@i_183], r_249[@i_183]) && (x_257 = x_251[@i_183]) then
                let k2': key = r_249[@i_183] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_212: symseed;
                new tc_211: timest;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_215: symseed;
                new tc'_214: timest;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(x_254[@i_183], r_252[@i_183]) && (x_257 = x_254[@i_183]) then
                let k2': key = r_252[@i_183] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_212: symseed;
                new tc_211: timest;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_215: symseed;
                new tc'_214: timest;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_270 <= N suchthat defined(x_257[@i_270], r_255[@i_270]) && ((@i_183[@i_270] = @i_183) && (x_257 = x_257[@i_270])) then
                let k2': key = r_255[@i_270] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_212: symseed;
                new tc_211: timest;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_215: symseed;
                new tc'_214: timest;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_269 <= N suchthat defined(x_260[@i_269], r_258[@i_269]) && ((@i_183[@i_269] = @i_183) && (x_257 = x_260[@i_269])) then
                let k2': key = r_258[@i_269] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_212: symseed;
                new tc_211: timest;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_215: symseed;
                new tc'_214: timest;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              else
                new s_256: symkeyseed;
                let r_255: key = kgen(s_256) in
                let k2': key = r_255 in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_212: symseed;
                new tc_211: timest;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_215: symseed;
                new tc'_214: timest;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            else
              new s_259: symkeyseed;
              let r_258: key = kgen(s_259) in
              let k1': key = r_258 in
              let x_257: usenum = un2 in
              find  suchthat defined(x_251[@i_183], r_249[@i_183]) && (x_257 = x_251[@i_183]) then
                let k2': key = r_249[@i_183] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_212: symseed;
                new tc_211: timest;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_215: symseed;
                new tc'_214: timest;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(x_254[@i_183], r_252[@i_183]) && (x_257 = x_254[@i_183]) then
                let k2': key = r_252[@i_183] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_212: symseed;
                new tc_211: timest;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_215: symseed;
                new tc'_214: timest;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_270 <= N suchthat defined(x_257[@i_270], r_255[@i_270]) && ((@i_183[@i_270] = @i_183) && (x_257 = x_257[@i_270])) then
                let k2': key = r_255[@i_270] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_212: symseed;
                new tc_211: timest;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_215: symseed;
                new tc'_214: timest;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_269 <= N suchthat defined(x_260[@i_269], r_258[@i_269]) && ((@i_183[@i_269] = @i_183) && (x_257 = x_260[@i_269])) then
                let k2': key = r_258[@i_269] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_212: symseed;
                new tc_211: timest;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_215: symseed;
                new tc'_214: timest;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              else
                new s_256: symkeyseed;
                let r_255: key = kgen(s_256) in
                let k2': key = r_255 in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_212: symseed;
                new tc_211: timest;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_215: symseed;
                new tc'_214: timest;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new kp_146: protkey;
            let k1: key = keyderivation(kp_146, un1) in
            let k2: key = keyderivation(kp_146, un2) in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            let kp_153: protkey = cst_protkey in
            let x_254: usenum = un1 in
            find  suchthat defined(x_251, r_249) && (x_254 = x_251) then
              let k1: key = r_249 in
              let x_251: usenum = un2 in
              find  suchthat defined(x_251, r_249) && (x_251 = x_251) then
                let k2: key = r_249 in
                new r4_154: symseed;
                new tk_155: timest;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
                new r5_156: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_158: seed;
                let m2_174: bitstring = enc2(Z, pkY, r7_158) in
                let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
                out(c23[!_38], m5)
              orfind  suchthat defined(x_254, r_252) && (x_251 = x_254) then
                let k2: key = r_252 in
                new r4_154: symseed;
                new tk_155: timest;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
                new r5_156: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_158: seed;
                let m2_174: bitstring = enc2(Z, pkY, r7_158) in
                let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
                out(c23[!_38], m5)
              orfind @i_262 <= N suchthat defined(x_257[@i_262], r_255[@i_262]) && ((@i_183[@i_262] = !_38) && (x_251 = x_257[@i_262])) then
                let k2: key = r_255[@i_262] in
                new r4_154: symseed;
                new tk_155: timest;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
                new r5_156: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_158: seed;
                let m2_174: bitstring = enc2(Z, pkY, r7_158) in
                let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
                out(c23[!_38], m5)
              orfind @i_261 <= N suchthat defined(x_260[@i_261], r_258[@i_261]) && ((@i_183[@i_261] = !_38) && (x_251 = x_260[@i_261])) then
                let k2: key = r_258[@i_261] in
                new r4_154: symseed;
                new tk_155: timest;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
                new r5_156: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_158: seed;
                let m2_174: bitstring = enc2(Z, pkY, r7_158) in
                let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
                out(c23[!_38], m5)
              else
                new s_250: symkeyseed;
                let r_249: key = kgen(s_250) in
                let k2: key = r_249 in
                new r4_154: symseed;
                new tk_155: timest;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
                new r5_156: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_158: seed;
                let m2_174: bitstring = enc2(Z, pkY, r7_158) in
                let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
                out(c23[!_38], m5)
            orfind  suchthat defined(x_254, r_252) && (x_254 = x_254) then
              let k1: key = r_252 in
              let x_251: usenum = un2 in
              find  suchthat defined(x_251, r_249) && (x_251 = x_251) then
                let k2: key = r_249 in
                new r4_154: symseed;
                new tk_155: timest;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
                new r5_156: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_158: seed;
                let m2_174: bitstring = enc2(Z, pkY, r7_158) in
                let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
                out(c23[!_38], m5)
              orfind  suchthat defined(x_254, r_252) && (x_251 = x_254) then
                let k2: key = r_252 in
                new r4_154: symseed;
                new tk_155: timest;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
                new r5_156: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_158: seed;
                let m2_174: bitstring = enc2(Z, pkY, r7_158) in
                let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
                out(c23[!_38], m5)
              orfind @i_262 <= N suchthat defined(x_257[@i_262], r_255[@i_262]) && ((@i_183[@i_262] = !_38) && (x_251 = x_257[@i_262])) then
                let k2: key = r_255[@i_262] in
                new r4_154: symseed;
                new tk_155: timest;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
                new r5_156: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_158: seed;
                let m2_174: bitstring = enc2(Z, pkY, r7_158) in
                let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
                out(c23[!_38], m5)
              orfind @i_261 <= N suchthat defined(x_260[@i_261], r_258[@i_261]) && ((@i_183[@i_261] = !_38) && (x_251 = x_260[@i_261])) then
                let k2: key = r_258[@i_261] in
                new r4_154: symseed;
                new tk_155: timest;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
                new r5_156: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_158: seed;
                let m2_174: bitstring = enc2(Z, pkY, r7_158) in
                let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
                out(c23[!_38], m5)
              else
                new s_250: symkeyseed;
                let r_249: key = kgen(s_250) in
                let k2: key = r_249 in
                new r4_154: symseed;
                new tk_155: timest;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
                new r5_156: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_158: seed;
                let m2_174: bitstring = enc2(Z, pkY, r7_158) in
                let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
                out(c23[!_38], m5)
            orfind @i_266 <= N suchthat defined(x_257[@i_266], r_255[@i_266]) && ((@i_183[@i_266] = !_38) && (x_254 = x_257[@i_266])) then
              let k1: key = r_255[@i_266] in
              let x_251: usenum = un2 in
              find  suchthat defined(x_251, r_249) && (x_251 = x_251) then
                let k2: key = r_249 in
                new r4_154: symseed;
                new tk_155: timest;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
                new r5_156: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_158: seed;
                let m2_174: bitstring = enc2(Z, pkY, r7_158) in
                let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
                out(c23[!_38], m5)
              orfind  suchthat defined(x_254, r_252) && (x_251 = x_254) then
                let k2: key = r_252 in
                new r4_154: symseed;
                new tk_155: timest;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
                new r5_156: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_158: seed;
                let m2_174: bitstring = enc2(Z, pkY, r7_158) in
                let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
                out(c23[!_38], m5)
              orfind @i_262 <= N suchthat defined(x_257[@i_262], r_255[@i_262]) && ((@i_183[@i_262] = !_38) && (x_251 = x_257[@i_262])) then
                let k2: key = r_255[@i_262] in
                new r4_154: symseed;
                new tk_155: timest;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
                new r5_156: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_158: seed;
                let m2_174: bitstring = enc2(Z, pkY, r7_158) in
                let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
                out(c23[!_38], m5)
              orfind @i_261 <= N suchthat defined(x_260[@i_261], r_258[@i_261]) && ((@i_183[@i_261] = !_38) && (x_251 = x_260[@i_261])) then
                let k2: key = r_258[@i_261] in
                new r4_154: symseed;
                new tk_155: timest;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
                new r5_156: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_158: seed;
                let m2_174: bitstring = enc2(Z, pkY, r7_158) in
                let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
                out(c23[!_38], m5)
              else
                new s_250: symkeyseed;
                let r_249: key = kgen(s_250) in
                let k2: key = r_249 in
                new r4_154: symseed;
                new tk_155: timest;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
                new r5_156: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_158: seed;
                let m2_174: bitstring = enc2(Z, pkY, r7_158) in
                let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
                out(c23[!_38], m5)
            orfind @i_265 <= N suchthat defined(x_260[@i_265], r_258[@i_265]) && ((@i_183[@i_265] = !_38) && (x_254 = x_260[@i_265])) then
              let k1: key = r_258[@i_265] in
              let x_251: usenum = un2 in
              find  suchthat defined(x_251, r_249) && (x_251 = x_251) then
                let k2: key = r_249 in
                new r4_154: symseed;
                new tk_155: timest;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
                new r5_156: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_158: seed;
                let m2_174: bitstring = enc2(Z, pkY, r7_158) in
                let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
                out(c23[!_38], m5)
              orfind  suchthat defined(x_254, r_252) && (x_251 = x_254) then
                let k2: key = r_252 in
                new r4_154: symseed;
                new tk_155: timest;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
                new r5_156: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_158: seed;
                let m2_174: bitstring = enc2(Z, pkY, r7_158) in
                let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
                out(c23[!_38], m5)
              orfind @i_262 <= N suchthat defined(x_257[@i_262], r_255[@i_262]) && ((@i_183[@i_262] = !_38) && (x_251 = x_257[@i_262])) then
                let k2: key = r_255[@i_262] in
                new r4_154: symseed;
                new tk_155: timest;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
                new r5_156: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_158: seed;
                let m2_174: bitstring = enc2(Z, pkY, r7_158) in
                let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
                out(c23[!_38], m5)
              orfind @i_261 <= N suchthat defined(x_260[@i_261], r_258[@i_261]) && ((@i_183[@i_261] = !_38) && (x_251 = x_260[@i_261])) then
                let k2: key = r_258[@i_261] in
                new r4_154: symseed;
                new tk_155: timest;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
                new r5_156: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_158: seed;
                let m2_174: bitstring = enc2(Z, pkY, r7_158) in
                let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
                out(c23[!_38], m5)
              else
                new s_250: symkeyseed;
                let r_249: key = kgen(s_250) in
                let k2: key = r_249 in
                new r4_154: symseed;
                new tk_155: timest;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
                new r5_156: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_158: seed;
                let m2_174: bitstring = enc2(Z, pkY, r7_158) in
                let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
                out(c23[!_38], m5)
            else
              new s_253: symkeyseed;
              let r_252: key = kgen(s_253) in
              let k1: key = r_252 in
              let x_251: usenum = un2 in
              find  suchthat defined(x_251, r_249) && (x_251 = x_251) then
                let k2: key = r_249 in
                new r4_154: symseed;
                new tk_155: timest;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
                new r5_156: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_158: seed;
                let m2_174: bitstring = enc2(Z, pkY, r7_158) in
                let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
                out(c23[!_38], m5)
              orfind  suchthat defined(x_254, r_252) && (x_251 = x_254) then
                let k2: key = r_252 in
                new r4_154: symseed;
                new tk_155: timest;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
                new r5_156: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_158: seed;
                let m2_174: bitstring = enc2(Z, pkY, r7_158) in
                let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
                out(c23[!_38], m5)
              orfind @i_262 <= N suchthat defined(x_257[@i_262], r_255[@i_262]) && ((@i_183[@i_262] = !_38) && (x_251 = x_257[@i_262])) then
                let k2: key = r_255[@i_262] in
                new r4_154: symseed;
                new tk_155: timest;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
                new r5_156: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_158: seed;
                let m2_174: bitstring = enc2(Z, pkY, r7_158) in
                let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
                out(c23[!_38], m5)
              orfind @i_261 <= N suchthat defined(x_260[@i_261], r_258[@i_261]) && ((@i_183[@i_261] = !_38) && (x_251 = x_260[@i_261])) then
                let k2: key = r_258[@i_261] in
                new r4_154: symseed;
                new tk_155: timest;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
                new r5_156: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_158: seed;
                let m2_174: bitstring = enc2(Z, pkY, r7_158) in
                let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
                out(c23[!_38], m5)
              else
                new s_250: symkeyseed;
                let r_249: key = kgen(s_250) in
                let k2: key = r_249 in
                new r4_154: symseed;
                new tk_155: timest;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
                new r5_156: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_158: seed;
                let m2_174: bitstring = enc2(Z, pkY, r7_158) in
                let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
                out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying simplify yields

Game 24 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(ck[@i_184], kp_146[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            let k1': key = keyderivation(kp_146[@i_184], un1) in
            let k2': key = keyderivation(kp_146[@i_184], un2) in
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if checkmac(y', k2', ck[@i_184]) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_207: symseed;
            new tc_206: timest;
            let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
            event partCT(hostT, TGT_58, e5);
            new n3_208: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_210: symseed;
            new tc'_209: timest;
            let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(ck[@i_183], r_249[@i_183], r_252[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            let x_260: usenum = un1 in
            find  suchthat defined(ck[@i_183], r_249[@i_183], r_252[@i_183]) then
              let k1': key = r_252[@i_183] in
              let x_257: usenum = un2 in
              find  suchthat defined(ck[@i_183], r_249[@i_183]) then
                let k2': key = r_249[@i_183] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_212: symseed;
                new tc_211: timest;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_215: symseed;
                new tc'_214: timest;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_270 <= N suchthat defined(r_255[@i_270], @i_183[@i_270]) && (@i_183[@i_270] = @i_183) then
                let k2': key = r_255[@i_270] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_212: symseed;
                new tc_211: timest;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_215: symseed;
                new tc'_214: timest;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_273 <= N suchthat defined(r_258[@i_273], @i_183[@i_273]) && (@i_183[@i_273] = @i_183) then
              let k1': key = r_258[@i_273] in
              let x_257: usenum = un2 in
              find  suchthat defined(ck[@i_183], r_249[@i_183]) then
                let k2': key = r_249[@i_183] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_212: symseed;
                new tc_211: timest;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_215: symseed;
                new tc'_214: timest;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_270 <= N suchthat defined(r_255[@i_270], @i_183[@i_270]) && (@i_183[@i_270] = @i_183) then
                let k2': key = r_255[@i_270] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_212: symseed;
                new tc_211: timest;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_215: symseed;
                new tc'_214: timest;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new kp_146: protkey;
            let k1: key = keyderivation(kp_146, un1) in
            let k2: key = keyderivation(kp_146, un2) in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            let kp_153: protkey = cst_protkey in
            let x_254: usenum = un1 in
            new s_253: symkeyseed;
            let r_252: key = kgen(s_253) in
            let k1: key = r_252 in
            let x_251: usenum = un2 in
            new s_250: symkeyseed;
            let r_249: key = kgen(s_250) in
            let k2: key = r_249 in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying move new all binders yields

Game 25 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(ck[@i_184], kp_146[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            let k1': key = keyderivation(kp_146[@i_184], un1) in
            let k2': key = keyderivation(kp_146[@i_184], un2) in
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if checkmac(y', k2', ck[@i_184]) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_206: timest;
            new r7_207: symseed;
            let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
            event partCT(hostT, TGT_58, e5);
            new n3_208: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_209: timest;
            new r2_210: symseed;
            let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(ck[@i_183], r_249[@i_183], r_252[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            let x_260: usenum = un1 in
            find  suchthat defined(ck[@i_183], r_249[@i_183], r_252[@i_183]) then
              let k1': key = r_252[@i_183] in
              let x_257: usenum = un2 in
              find  suchthat defined(ck[@i_183], r_249[@i_183]) then
                let k2': key = r_249[@i_183] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_211: timest;
                new r7_212: symseed;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_214: timest;
                new r2_215: symseed;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_270 <= N suchthat defined(r_255[@i_270], @i_183[@i_270]) && (@i_183[@i_270] = @i_183) then
                let k2': key = r_255[@i_270] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_211: timest;
                new r7_212: symseed;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_214: timest;
                new r2_215: symseed;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_273 <= N suchthat defined(r_258[@i_273], @i_183[@i_273]) && (@i_183[@i_273] = @i_183) then
              let k1': key = r_258[@i_273] in
              let x_257: usenum = un2 in
              find  suchthat defined(ck[@i_183], r_249[@i_183]) then
                let k2': key = r_249[@i_183] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_211: timest;
                new r7_212: symseed;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_214: timest;
                new r2_215: symseed;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_270 <= N suchthat defined(r_255[@i_270], @i_183[@i_270]) && (@i_183[@i_270] = @i_183) then
                let k2': key = r_255[@i_270] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_211: timest;
                new r7_212: symseed;
                let e5: maxmac = encsym(pad(C, tc_211), AK_60, r7_212) in
                event partCT(hostT, TGT_58, e5);
                new n3_213: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_213));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_213, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_213, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_214: timest;
                new r2_215: symseed;
                let e12: maxmac = encsym(pad(C, tc'_214), SK_63, r2_215) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_214)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new kp_146: protkey;
            let k1: key = keyderivation(kp_146, un1) in
            let k2: key = keyderivation(kp_146, un2) in
            new tk_148: timest;
            new r4_147: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            let kp_153: protkey = cst_protkey in
            let x_254: usenum = un1 in
            new s_253: symkeyseed;
            let r_252: key = kgen(s_253) in
            let k1: key = r_252 in
            let x_251: usenum = un2 in
            new s_250: symkeyseed;
            let r_249: key = kgen(s_250) in
            let k2: key = r_249 in
            new tk_155: timest;
            new r4_154: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), k1, r5_156) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new tt_51: timest;
        new r10: symseed;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying remove assignments of useless yields

Game 26 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(ck[@i_184], kp_146[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            let k1': key = keyderivation(kp_146[@i_184], un1) in
            let k2': key = keyderivation(kp_146[@i_184], un2) in
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if checkmac(y', k2', ck[@i_184]) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_206: timest;
            new r7_207: symseed;
            let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
            event partCT(hostT, TGT_58, e5);
            new n3_208: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_209: timest;
            new r2_210: symseed;
            let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(ck[@i_183], r_249[@i_183], r_252[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            find  suchthat defined(ck[@i_183], r_249[@i_183], r_252[@i_183]) then
              find  suchthat defined(ck[@i_183], r_249[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', r_249[@i_183], ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_252[@i_183]) in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_309: timest;
                new r7_310: symseed;
                let e5: maxmac = encsym(pad(C, tc_309), AK_60, r7_310) in
                event partCT(hostT, TGT_58, e5);
                new n3_311: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_312: timest;
                new r2_313: symseed;
                let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_270 <= N suchthat defined(r_255[@i_270], @i_183[@i_270]) && (@i_183[@i_270] = @i_183) then
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', r_255[@i_270], ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_252[@i_183]) in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_314: timest;
                new r7_315: symseed;
                let e5: maxmac = encsym(pad(C, tc_314), AK_60, r7_315) in
                event partCT(hostT, TGT_58, e5);
                new n3_316: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_316));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_316, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_316, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_317: timest;
                new r2_318: symseed;
                let e12: maxmac = encsym(pad(C, tc'_317), SK_63, r2_318) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_317)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_273 <= N suchthat defined(r_258[@i_273], @i_183[@i_273]) && (@i_183[@i_273] = @i_183) then
              find  suchthat defined(ck[@i_183], r_249[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', r_249[@i_183], ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_258[@i_273]) in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_319: timest;
                new r7_320: symseed;
                let e5: maxmac = encsym(pad(C, tc_319), AK_60, r7_320) in
                event partCT(hostT, TGT_58, e5);
                new n3_321: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_321));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_321, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_321, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_322: timest;
                new r2_323: symseed;
                let e12: maxmac = encsym(pad(C, tc'_322), SK_63, r2_323) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_322)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_270 <= N suchthat defined(r_255[@i_270], @i_183[@i_270]) && (@i_183[@i_270] = @i_183) then
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', r_255[@i_270], ck[@i_183]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_258[@i_273]) in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_324: timest;
                new r7_325: symseed;
                let e5: maxmac = encsym(pad(C, tc_324), AK_60, r7_325) in
                event partCT(hostT, TGT_58, e5);
                new n3_326: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_326));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_326, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_326, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_327: timest;
                new r2_328: symseed;
                let e12: maxmac = encsym(pad(C, tc'_327), SK_63, r2_328) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_327)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new kp_146: protkey;
            let k1: key = keyderivation(kp_146, un1) in
            let k2: key = keyderivation(kp_146, un2) in
            new tk_148: timest;
            new r4_147: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new s_253: symkeyseed;
            let r_252: key = kgen(s_253) in
            new s_250: symkeyseed;
            let r_249: key = kgen(s_250) in
            new tk_155: timest;
            new r4_154: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), r_252, r5_156) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, r_249) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new tt_51: timest;
        new r10: symseed;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying simplify yields

Game 27 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(ck[@i_184], kp_146[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            let k1': key = keyderivation(kp_146[@i_184], un1) in
            let k2': key = keyderivation(kp_146[@i_184], un2) in
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if checkmac(y', k2', ck[@i_184]) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_206: timest;
            new r7_207: symseed;
            let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
            event partCT(hostT, TGT_58, e5);
            new n3_208: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_209: timest;
            new r2_210: symseed;
            let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(r_252[@i_183], ck[@i_183], r_249[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(r_252[@i_183], ck[@i_183], r_249[@i_183]) then
            if defined(r_252[@i_183], ck[@i_183], r_249[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if checkmac(y', r_249[@i_183], ck[@i_183]) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_252[@i_183]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_309: timest;
            new r7_310: symseed;
            let e5: maxmac = encsym(pad(C, tc_309), AK_60, r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_312: timest;
            new r2_313: symseed;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new kp_146: protkey;
            let k1: key = keyderivation(kp_146, un1) in
            let k2: key = keyderivation(kp_146, un2) in
            new tk_148: timest;
            new r4_147: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new s_253: symkeyseed;
            let r_252: key = kgen(s_253) in
            new s_250: symkeyseed;
            let r_249: key = kgen(s_250) in
            new tk_155: timest;
            new r4_154: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), r_252, r5_156) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, r_249) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new tt_51: timest;
        new r10: symseed;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying equivalence
equiv ! !_31 <= N2 new z: protkey; ! !_32 <= N (x: usenum) -> keyderivation(z, x)
<=(N2 * pPRF(time, N))=>
      ! !_33 <= N2 ! !_34 <= N (x_77: usenum) -> let x: usenum = x_77 in find u <= N suchthat defined(x[u], r[u]) && (x = x[u]) then r[u] else new s: symkeyseed; let r: key = kgen(s) in r
 [Difference of probability N * pPRF(time + time(context for game 27), 2. * 1. + 2. * N)] yields

Game 28 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(ck[@i_184], kp_146[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            let x_372: usenum = un1 in
            find  suchthat defined(x_363[@i_184], r_361[@i_184]) && (x_372 = x_363[@i_184]) then
              let k1': key = r_361[@i_184] in
              let x_369: usenum = un2 in
              find  suchthat defined(x_363[@i_184], r_361[@i_184]) && (x_369 = x_363[@i_184]) then
                let k2': key = r_361[@i_184] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_206: timest;
                new r7_207: symseed;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_209: timest;
                new r2_210: symseed;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(x_366[@i_184], r_364[@i_184]) && (x_369 = x_366[@i_184]) then
                let k2': key = r_364[@i_184] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_206: timest;
                new r7_207: symseed;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_209: timest;
                new r2_210: symseed;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_382 <= N suchthat defined(x_369[@i_382], r_367[@i_382]) && ((@i_184[@i_382] = @i_184) && (x_369 = x_369[@i_382])) then
                let k2': key = r_367[@i_382] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_206: timest;
                new r7_207: symseed;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_209: timest;
                new r2_210: symseed;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_381 <= N suchthat defined(x_372[@i_381], r_370[@i_381]) && ((@i_184[@i_381] = @i_184) && (x_369 = x_372[@i_381])) then
                let k2': key = r_370[@i_381] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_206: timest;
                new r7_207: symseed;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_209: timest;
                new r2_210: symseed;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              else
                new s_368: symkeyseed;
                let r_367: key = kgen(s_368) in
                let k2': key = r_367 in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_206: timest;
                new r7_207: symseed;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_209: timest;
                new r2_210: symseed;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind  suchthat defined(x_366[@i_184], r_364[@i_184]) && (x_372 = x_366[@i_184]) then
              let k1': key = r_364[@i_184] in
              let x_369: usenum = un2 in
              find  suchthat defined(x_363[@i_184], r_361[@i_184]) && (x_369 = x_363[@i_184]) then
                let k2': key = r_361[@i_184] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_206: timest;
                new r7_207: symseed;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_209: timest;
                new r2_210: symseed;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(x_366[@i_184], r_364[@i_184]) && (x_369 = x_366[@i_184]) then
                let k2': key = r_364[@i_184] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_206: timest;
                new r7_207: symseed;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_209: timest;
                new r2_210: symseed;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_382 <= N suchthat defined(x_369[@i_382], r_367[@i_382]) && ((@i_184[@i_382] = @i_184) && (x_369 = x_369[@i_382])) then
                let k2': key = r_367[@i_382] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_206: timest;
                new r7_207: symseed;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_209: timest;
                new r2_210: symseed;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_381 <= N suchthat defined(x_372[@i_381], r_370[@i_381]) && ((@i_184[@i_381] = @i_184) && (x_369 = x_372[@i_381])) then
                let k2': key = r_370[@i_381] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_206: timest;
                new r7_207: symseed;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_209: timest;
                new r2_210: symseed;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              else
                new s_368: symkeyseed;
                let r_367: key = kgen(s_368) in
                let k2': key = r_367 in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_206: timest;
                new r7_207: symseed;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_209: timest;
                new r2_210: symseed;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_386 <= N suchthat defined(x_369[@i_386], r_367[@i_386]) && ((@i_184[@i_386] = @i_184) && (x_372 = x_369[@i_386])) then
              let k1': key = r_367[@i_386] in
              let x_369: usenum = un2 in
              find  suchthat defined(x_363[@i_184], r_361[@i_184]) && (x_369 = x_363[@i_184]) then
                let k2': key = r_361[@i_184] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_206: timest;
                new r7_207: symseed;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_209: timest;
                new r2_210: symseed;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(x_366[@i_184], r_364[@i_184]) && (x_369 = x_366[@i_184]) then
                let k2': key = r_364[@i_184] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_206: timest;
                new r7_207: symseed;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_209: timest;
                new r2_210: symseed;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_382 <= N suchthat defined(x_369[@i_382], r_367[@i_382]) && ((@i_184[@i_382] = @i_184) && (x_369 = x_369[@i_382])) then
                let k2': key = r_367[@i_382] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_206: timest;
                new r7_207: symseed;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_209: timest;
                new r2_210: symseed;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_381 <= N suchthat defined(x_372[@i_381], r_370[@i_381]) && ((@i_184[@i_381] = @i_184) && (x_369 = x_372[@i_381])) then
                let k2': key = r_370[@i_381] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_206: timest;
                new r7_207: symseed;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_209: timest;
                new r2_210: symseed;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              else
                new s_368: symkeyseed;
                let r_367: key = kgen(s_368) in
                let k2': key = r_367 in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_206: timest;
                new r7_207: symseed;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_209: timest;
                new r2_210: symseed;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_385 <= N suchthat defined(x_372[@i_385], r_370[@i_385]) && ((@i_184[@i_385] = @i_184) && (x_372 = x_372[@i_385])) then
              let k1': key = r_370[@i_385] in
              let x_369: usenum = un2 in
              find  suchthat defined(x_363[@i_184], r_361[@i_184]) && (x_369 = x_363[@i_184]) then
                let k2': key = r_361[@i_184] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_206: timest;
                new r7_207: symseed;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_209: timest;
                new r2_210: symseed;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(x_366[@i_184], r_364[@i_184]) && (x_369 = x_366[@i_184]) then
                let k2': key = r_364[@i_184] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_206: timest;
                new r7_207: symseed;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_209: timest;
                new r2_210: symseed;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_382 <= N suchthat defined(x_369[@i_382], r_367[@i_382]) && ((@i_184[@i_382] = @i_184) && (x_369 = x_369[@i_382])) then
                let k2': key = r_367[@i_382] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_206: timest;
                new r7_207: symseed;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_209: timest;
                new r2_210: symseed;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_381 <= N suchthat defined(x_372[@i_381], r_370[@i_381]) && ((@i_184[@i_381] = @i_184) && (x_369 = x_372[@i_381])) then
                let k2': key = r_370[@i_381] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_206: timest;
                new r7_207: symseed;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_209: timest;
                new r2_210: symseed;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              else
                new s_368: symkeyseed;
                let r_367: key = kgen(s_368) in
                let k2': key = r_367 in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_206: timest;
                new r7_207: symseed;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_209: timest;
                new r2_210: symseed;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            else
              new s_371: symkeyseed;
              let r_370: key = kgen(s_371) in
              let k1': key = r_370 in
              let x_369: usenum = un2 in
              find  suchthat defined(x_363[@i_184], r_361[@i_184]) && (x_369 = x_363[@i_184]) then
                let k2': key = r_361[@i_184] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_206: timest;
                new r7_207: symseed;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_209: timest;
                new r2_210: symseed;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(x_366[@i_184], r_364[@i_184]) && (x_369 = x_366[@i_184]) then
                let k2': key = r_364[@i_184] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_206: timest;
                new r7_207: symseed;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_209: timest;
                new r2_210: symseed;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_382 <= N suchthat defined(x_369[@i_382], r_367[@i_382]) && ((@i_184[@i_382] = @i_184) && (x_369 = x_369[@i_382])) then
                let k2': key = r_367[@i_382] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_206: timest;
                new r7_207: symseed;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_209: timest;
                new r2_210: symseed;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_381 <= N suchthat defined(x_372[@i_381], r_370[@i_381]) && ((@i_184[@i_381] = @i_184) && (x_369 = x_372[@i_381])) then
                let k2': key = r_370[@i_381] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_206: timest;
                new r7_207: symseed;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_209: timest;
                new r2_210: symseed;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              else
                new s_368: symkeyseed;
                let r_367: key = kgen(s_368) in
                let k2': key = r_367 in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_206: timest;
                new r7_207: symseed;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_209: timest;
                new r2_210: symseed;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(r_252[@i_183], ck[@i_183], r_249[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(r_252[@i_183], ck[@i_183], r_249[@i_183]) then
            if defined(r_252[@i_183], ck[@i_183], r_249[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if checkmac(y', r_249[@i_183], ck[@i_183]) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_252[@i_183]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_309: timest;
            new r7_310: symseed;
            let e5: maxmac = encsym(pad(C, tc_309), AK_60, r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_312: timest;
            new r2_313: symseed;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            let kp_146: protkey = cst_protkey in
            let x_366: usenum = un1 in
            find  suchthat defined(x_363, r_361) && (x_366 = x_363) then
              let k1: key = r_361 in
              let x_363: usenum = un2 in
              find  suchthat defined(x_363, r_361) && (x_363 = x_363) then
                let k2: key = r_361 in
                new tk_148: timest;
                new r4_147: symseed;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
                new r5_149: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_151: seed;
                let m2_169: bitstring = enc2(Z, pkY, r7_151) in
                let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
                out(c23[!_38], m5)
              orfind  suchthat defined(x_366, r_364) && (x_363 = x_366) then
                let k2: key = r_364 in
                new tk_148: timest;
                new r4_147: symseed;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
                new r5_149: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_151: seed;
                let m2_169: bitstring = enc2(Z, pkY, r7_151) in
                let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
                out(c23[!_38], m5)
              orfind @i_374 <= N suchthat defined(x_369[@i_374], r_367[@i_374]) && ((@i_184[@i_374] = !_38) && (x_363 = x_369[@i_374])) then
                let k2: key = r_367[@i_374] in
                new tk_148: timest;
                new r4_147: symseed;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
                new r5_149: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_151: seed;
                let m2_169: bitstring = enc2(Z, pkY, r7_151) in
                let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
                out(c23[!_38], m5)
              orfind @i_373 <= N suchthat defined(x_372[@i_373], r_370[@i_373]) && ((@i_184[@i_373] = !_38) && (x_363 = x_372[@i_373])) then
                let k2: key = r_370[@i_373] in
                new tk_148: timest;
                new r4_147: symseed;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
                new r5_149: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_151: seed;
                let m2_169: bitstring = enc2(Z, pkY, r7_151) in
                let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
                out(c23[!_38], m5)
              else
                new s_362: symkeyseed;
                let r_361: key = kgen(s_362) in
                let k2: key = r_361 in
                new tk_148: timest;
                new r4_147: symseed;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
                new r5_149: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_151: seed;
                let m2_169: bitstring = enc2(Z, pkY, r7_151) in
                let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
                out(c23[!_38], m5)
            orfind  suchthat defined(x_366, r_364) && (x_366 = x_366) then
              let k1: key = r_364 in
              let x_363: usenum = un2 in
              find  suchthat defined(x_363, r_361) && (x_363 = x_363) then
                let k2: key = r_361 in
                new tk_148: timest;
                new r4_147: symseed;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
                new r5_149: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_151: seed;
                let m2_169: bitstring = enc2(Z, pkY, r7_151) in
                let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
                out(c23[!_38], m5)
              orfind  suchthat defined(x_366, r_364) && (x_363 = x_366) then
                let k2: key = r_364 in
                new tk_148: timest;
                new r4_147: symseed;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
                new r5_149: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_151: seed;
                let m2_169: bitstring = enc2(Z, pkY, r7_151) in
                let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
                out(c23[!_38], m5)
              orfind @i_374 <= N suchthat defined(x_369[@i_374], r_367[@i_374]) && ((@i_184[@i_374] = !_38) && (x_363 = x_369[@i_374])) then
                let k2: key = r_367[@i_374] in
                new tk_148: timest;
                new r4_147: symseed;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
                new r5_149: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_151: seed;
                let m2_169: bitstring = enc2(Z, pkY, r7_151) in
                let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
                out(c23[!_38], m5)
              orfind @i_373 <= N suchthat defined(x_372[@i_373], r_370[@i_373]) && ((@i_184[@i_373] = !_38) && (x_363 = x_372[@i_373])) then
                let k2: key = r_370[@i_373] in
                new tk_148: timest;
                new r4_147: symseed;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
                new r5_149: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_151: seed;
                let m2_169: bitstring = enc2(Z, pkY, r7_151) in
                let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
                out(c23[!_38], m5)
              else
                new s_362: symkeyseed;
                let r_361: key = kgen(s_362) in
                let k2: key = r_361 in
                new tk_148: timest;
                new r4_147: symseed;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
                new r5_149: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_151: seed;
                let m2_169: bitstring = enc2(Z, pkY, r7_151) in
                let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
                out(c23[!_38], m5)
            orfind @i_378 <= N suchthat defined(x_369[@i_378], r_367[@i_378]) && ((@i_184[@i_378] = !_38) && (x_366 = x_369[@i_378])) then
              let k1: key = r_367[@i_378] in
              let x_363: usenum = un2 in
              find  suchthat defined(x_363, r_361) && (x_363 = x_363) then
                let k2: key = r_361 in
                new tk_148: timest;
                new r4_147: symseed;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
                new r5_149: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_151: seed;
                let m2_169: bitstring = enc2(Z, pkY, r7_151) in
                let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
                out(c23[!_38], m5)
              orfind  suchthat defined(x_366, r_364) && (x_363 = x_366) then
                let k2: key = r_364 in
                new tk_148: timest;
                new r4_147: symseed;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
                new r5_149: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_151: seed;
                let m2_169: bitstring = enc2(Z, pkY, r7_151) in
                let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
                out(c23[!_38], m5)
              orfind @i_374 <= N suchthat defined(x_369[@i_374], r_367[@i_374]) && ((@i_184[@i_374] = !_38) && (x_363 = x_369[@i_374])) then
                let k2: key = r_367[@i_374] in
                new tk_148: timest;
                new r4_147: symseed;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
                new r5_149: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_151: seed;
                let m2_169: bitstring = enc2(Z, pkY, r7_151) in
                let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
                out(c23[!_38], m5)
              orfind @i_373 <= N suchthat defined(x_372[@i_373], r_370[@i_373]) && ((@i_184[@i_373] = !_38) && (x_363 = x_372[@i_373])) then
                let k2: key = r_370[@i_373] in
                new tk_148: timest;
                new r4_147: symseed;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
                new r5_149: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_151: seed;
                let m2_169: bitstring = enc2(Z, pkY, r7_151) in
                let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
                out(c23[!_38], m5)
              else
                new s_362: symkeyseed;
                let r_361: key = kgen(s_362) in
                let k2: key = r_361 in
                new tk_148: timest;
                new r4_147: symseed;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
                new r5_149: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_151: seed;
                let m2_169: bitstring = enc2(Z, pkY, r7_151) in
                let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
                out(c23[!_38], m5)
            orfind @i_377 <= N suchthat defined(x_372[@i_377], r_370[@i_377]) && ((@i_184[@i_377] = !_38) && (x_366 = x_372[@i_377])) then
              let k1: key = r_370[@i_377] in
              let x_363: usenum = un2 in
              find  suchthat defined(x_363, r_361) && (x_363 = x_363) then
                let k2: key = r_361 in
                new tk_148: timest;
                new r4_147: symseed;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
                new r5_149: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_151: seed;
                let m2_169: bitstring = enc2(Z, pkY, r7_151) in
                let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
                out(c23[!_38], m5)
              orfind  suchthat defined(x_366, r_364) && (x_363 = x_366) then
                let k2: key = r_364 in
                new tk_148: timest;
                new r4_147: symseed;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
                new r5_149: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_151: seed;
                let m2_169: bitstring = enc2(Z, pkY, r7_151) in
                let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
                out(c23[!_38], m5)
              orfind @i_374 <= N suchthat defined(x_369[@i_374], r_367[@i_374]) && ((@i_184[@i_374] = !_38) && (x_363 = x_369[@i_374])) then
                let k2: key = r_367[@i_374] in
                new tk_148: timest;
                new r4_147: symseed;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
                new r5_149: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_151: seed;
                let m2_169: bitstring = enc2(Z, pkY, r7_151) in
                let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
                out(c23[!_38], m5)
              orfind @i_373 <= N suchthat defined(x_372[@i_373], r_370[@i_373]) && ((@i_184[@i_373] = !_38) && (x_363 = x_372[@i_373])) then
                let k2: key = r_370[@i_373] in
                new tk_148: timest;
                new r4_147: symseed;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
                new r5_149: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_151: seed;
                let m2_169: bitstring = enc2(Z, pkY, r7_151) in
                let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
                out(c23[!_38], m5)
              else
                new s_362: symkeyseed;
                let r_361: key = kgen(s_362) in
                let k2: key = r_361 in
                new tk_148: timest;
                new r4_147: symseed;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
                new r5_149: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_151: seed;
                let m2_169: bitstring = enc2(Z, pkY, r7_151) in
                let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
                out(c23[!_38], m5)
            else
              new s_365: symkeyseed;
              let r_364: key = kgen(s_365) in
              let k1: key = r_364 in
              let x_363: usenum = un2 in
              find  suchthat defined(x_363, r_361) && (x_363 = x_363) then
                let k2: key = r_361 in
                new tk_148: timest;
                new r4_147: symseed;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
                new r5_149: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_151: seed;
                let m2_169: bitstring = enc2(Z, pkY, r7_151) in
                let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
                out(c23[!_38], m5)
              orfind  suchthat defined(x_366, r_364) && (x_363 = x_366) then
                let k2: key = r_364 in
                new tk_148: timest;
                new r4_147: symseed;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
                new r5_149: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_151: seed;
                let m2_169: bitstring = enc2(Z, pkY, r7_151) in
                let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
                out(c23[!_38], m5)
              orfind @i_374 <= N suchthat defined(x_369[@i_374], r_367[@i_374]) && ((@i_184[@i_374] = !_38) && (x_363 = x_369[@i_374])) then
                let k2: key = r_367[@i_374] in
                new tk_148: timest;
                new r4_147: symseed;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
                new r5_149: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_151: seed;
                let m2_169: bitstring = enc2(Z, pkY, r7_151) in
                let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
                out(c23[!_38], m5)
              orfind @i_373 <= N suchthat defined(x_372[@i_373], r_370[@i_373]) && ((@i_184[@i_373] = !_38) && (x_363 = x_372[@i_373])) then
                let k2: key = r_370[@i_373] in
                new tk_148: timest;
                new r4_147: symseed;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
                new r5_149: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_151: seed;
                let m2_169: bitstring = enc2(Z, pkY, r7_151) in
                let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
                out(c23[!_38], m5)
              else
                new s_362: symkeyseed;
                let r_361: key = kgen(s_362) in
                let k2: key = r_361 in
                new tk_148: timest;
                new r4_147: symseed;
                let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
                new r5_149: symseed;
                let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
                let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
                let ck: macs = mac(y, k2) in
                new r7_151: seed;
                let m2_169: bitstring = enc2(Z, pkY, r7_151) in
                let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
                event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
                out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new s_253: symkeyseed;
            let r_252: key = kgen(s_253) in
            new s_250: symkeyseed;
            let r_249: key = kgen(s_250) in
            new tk_155: timest;
            new r4_154: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), r_252, r5_156) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, r_249) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new tt_51: timest;
        new r10: symseed;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying simplify yields

Game 29 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(ck[@i_184], r_361[@i_184], r_364[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            let x_372: usenum = un1 in
            find  suchthat defined(ck[@i_184], r_361[@i_184], r_364[@i_184]) then
              let k1': key = r_364[@i_184] in
              let x_369: usenum = un2 in
              find  suchthat defined(ck[@i_184], r_361[@i_184]) then
                let k2': key = r_361[@i_184] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_206: timest;
                new r7_207: symseed;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_209: timest;
                new r2_210: symseed;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_382 <= N suchthat defined(r_367[@i_382], @i_184[@i_382]) && (@i_184[@i_382] = @i_184) then
                let k2': key = r_367[@i_382] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_206: timest;
                new r7_207: symseed;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_209: timest;
                new r2_210: symseed;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_385 <= N suchthat defined(r_370[@i_385], @i_184[@i_385]) && (@i_184[@i_385] = @i_184) then
              let k1': key = r_370[@i_385] in
              let x_369: usenum = un2 in
              find  suchthat defined(ck[@i_184], r_361[@i_184]) then
                let k2': key = r_361[@i_184] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_206: timest;
                new r7_207: symseed;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_209: timest;
                new r2_210: symseed;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_382 <= N suchthat defined(r_367[@i_382], @i_184[@i_382]) && (@i_184[@i_382] = @i_184) then
                let k2': key = r_367[@i_382] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new tc_206: timest;
                new r7_207: symseed;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new tc'_209: timest;
                new r2_210: symseed;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(r_252[@i_183], ck[@i_183], r_249[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(r_252[@i_183], ck[@i_183], r_249[@i_183]) then
            if defined(r_252[@i_183], ck[@i_183], r_249[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if checkmac(y', r_249[@i_183], ck[@i_183]) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_252[@i_183]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_309: timest;
            new r7_310: symseed;
            let e5: maxmac = encsym(pad(C, tc_309), AK_60, r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_312: timest;
            new r2_313: symseed;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            let kp_146: protkey = cst_protkey in
            let x_366: usenum = un1 in
            new s_365: symkeyseed;
            let r_364: key = kgen(s_365) in
            let k1: key = r_364 in
            let x_363: usenum = un2 in
            new s_362: symkeyseed;
            let r_361: key = kgen(s_362) in
            let k2: key = r_361 in
            new tk_148: timest;
            new r4_147: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new s_253: symkeyseed;
            let r_252: key = kgen(s_253) in
            new s_250: symkeyseed;
            let r_249: key = kgen(s_250) in
            new tk_155: timest;
            new r4_154: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), r_252, r5_156) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, r_249) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new tt_51: timest;
        new r10: symseed;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying move new all binders yields

Game 30 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(ck[@i_184], r_361[@i_184], r_364[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            let x_372: usenum = un1 in
            find  suchthat defined(ck[@i_184], r_361[@i_184], r_364[@i_184]) then
              let k1': key = r_364[@i_184] in
              let x_369: usenum = un2 in
              find  suchthat defined(ck[@i_184], r_361[@i_184]) then
                let k2': key = r_361[@i_184] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_207: symseed;
                new tc_206: timest;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_210: symseed;
                new tc'_209: timest;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_382 <= N suchthat defined(r_367[@i_382], @i_184[@i_382]) && (@i_184[@i_382] = @i_184) then
                let k2': key = r_367[@i_382] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_207: symseed;
                new tc_206: timest;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_210: symseed;
                new tc'_209: timest;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_385 <= N suchthat defined(r_370[@i_385], @i_184[@i_385]) && (@i_184[@i_385] = @i_184) then
              let k1': key = r_370[@i_385] in
              let x_369: usenum = un2 in
              find  suchthat defined(ck[@i_184], r_361[@i_184]) then
                let k2': key = r_361[@i_184] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_207: symseed;
                new tc_206: timest;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_210: symseed;
                new tc'_209: timest;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_382 <= N suchthat defined(r_367[@i_382], @i_184[@i_382]) && (@i_184[@i_382] = @i_184) then
                let k2': key = r_367[@i_382] in
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', k2', ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, k1') in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_207: symseed;
                new tc_206: timest;
                let e5: maxmac = encsym(pad(C, tc_206), AK_60, r7_207) in
                event partCT(hostT, TGT_58, e5);
                new n3_208: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_208));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_208, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_208, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_210: symseed;
                new tc'_209: timest;
                let e12: maxmac = encsym(pad(C, tc'_209), SK_63, r2_210) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_209)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(r_252[@i_183], ck[@i_183], r_249[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(r_252[@i_183], ck[@i_183], r_249[@i_183]) then
            if defined(r_252[@i_183], ck[@i_183], r_249[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if checkmac(y', r_249[@i_183], ck[@i_183]) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_252[@i_183]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_310: symseed;
            new tc_309: timest;
            let e5: maxmac = encsym(pad(C, tc_309), AK_60, r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_313: symseed;
            new tc'_312: timest;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            let kp_146: protkey = cst_protkey in
            let x_366: usenum = un1 in
            new s_365: symkeyseed;
            let r_364: key = kgen(s_365) in
            let k1: key = r_364 in
            let x_363: usenum = un2 in
            new s_362: symkeyseed;
            let r_361: key = kgen(s_362) in
            let k2: key = r_361 in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), k1, r5_149) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, k2) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new s_253: symkeyseed;
            let r_252: key = kgen(s_253) in
            new s_250: symkeyseed;
            let r_249: key = kgen(s_250) in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), r_252, r5_156) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, r_249) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying remove assignments of useless yields

Game 31 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(ck[@i_184], r_361[@i_184], r_364[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            find  suchthat defined(ck[@i_184], r_361[@i_184], r_364[@i_184]) then
              find  suchthat defined(ck[@i_184], r_361[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', r_361[@i_184], ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_364[@i_184]) in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_549: symseed;
                new tc_550: timest;
                let e5: maxmac = encsym(pad(C, tc_550), AK_60, r7_549) in
                event partCT(hostT, TGT_58, e5);
                new n3_551: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_552: symseed;
                new tc'_553: timest;
                let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_382 <= N suchthat defined(r_367[@i_382], @i_184[@i_382]) && (@i_184[@i_382] = @i_184) then
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', r_367[@i_382], ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_364[@i_184]) in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_554: symseed;
                new tc_555: timest;
                let e5: maxmac = encsym(pad(C, tc_555), AK_60, r7_554) in
                event partCT(hostT, TGT_58, e5);
                new n3_556: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_556));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_556, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_556, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_557: symseed;
                new tc'_558: timest;
                let e12: maxmac = encsym(pad(C, tc'_558), SK_63, r2_557) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_558)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_385 <= N suchthat defined(r_370[@i_385], @i_184[@i_385]) && (@i_184[@i_385] = @i_184) then
              find  suchthat defined(ck[@i_184], r_361[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', r_361[@i_184], ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_370[@i_385]) in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_559: symseed;
                new tc_560: timest;
                let e5: maxmac = encsym(pad(C, tc_560), AK_60, r7_559) in
                event partCT(hostT, TGT_58, e5);
                new n3_561: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_561));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_561, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_561, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_562: symseed;
                new tc'_563: timest;
                let e12: maxmac = encsym(pad(C, tc'_563), SK_63, r2_562) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_563)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_382 <= N suchthat defined(r_367[@i_382], @i_184[@i_382]) && (@i_184[@i_382] = @i_184) then
                let x_119: sblocksize = padno(n2) in
                let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
                if checkmac(y', r_367[@i_382], ck[@i_184]) then
                let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_370[@i_385]) in
                event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                out(c18[!_35], acceptC1(hostZ, hostT));
                ! !_36 <= N3
                in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                if (hosT' = hostT) then
                new r7_564: symseed;
                new tc_565: timest;
                let e5: maxmac = encsym(pad(C, tc_565), AK_60, r7_564) in
                event partCT(hostT, TGT_58, e5);
                new n3_566: nonce;
                out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_566));
                in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                let injbot2(concat8(SK_63: key, =n3_566, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
                event fullCT(hostT, hostS, n3_566, TGT_58, e5, m7);
                out(c19[!_36, !_35], acceptC2(hostT, hostS));
                ! !_37 <= N4
                in(c20[!_37, !_36, !_35], hostS': server);
                if (hostS' = hostS) then
                new r2_567: symseed;
                new tc'_568: timest;
                let e12: maxmac = encsym(pad(C, tc'_568), SK_63, r2_567) in
                event partCS(hostS, hostT, m7, e12);
                out(c6[!_37, !_36, !_35], (m6, e12));
                in(c9[!_37, !_36, !_35], (m13: maxmac));
                let injbot2(padts(=tc'_568)) = decsym(m13, SK_63) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(r_252[@i_183], ck[@i_183], r_249[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(r_252[@i_183], ck[@i_183], r_249[@i_183]) then
            if defined(r_252[@i_183], ck[@i_183], r_249[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if checkmac(y', r_249[@i_183], ck[@i_183]) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_252[@i_183]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_310: symseed;
            new tc_309: timest;
            let e5: maxmac = encsym(pad(C, tc_309), AK_60, r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_313: symseed;
            new tc'_312: timest;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new s_365: symkeyseed;
            let r_364: key = kgen(s_365) in
            new s_362: symkeyseed;
            let r_361: key = kgen(s_362) in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), r_364, r5_149) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, r_361) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new s_253: symkeyseed;
            let r_252: key = kgen(s_253) in
            new s_250: symkeyseed;
            let r_249: key = kgen(s_250) in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), r_252, r5_156) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, r_249) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying simplify yields

Game 32 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(r_364[@i_184], ck[@i_184], r_361[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(r_364[@i_184], ck[@i_184], r_361[@i_184]) then
            if defined(r_364[@i_184], ck[@i_184], r_361[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if checkmac(y', r_361[@i_184], ck[@i_184]) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_364[@i_184]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_549: symseed;
            new tc_550: timest;
            let e5: maxmac = encsym(pad(C, tc_550), AK_60, r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_552: symseed;
            new tc'_553: timest;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(r_252[@i_183], ck[@i_183], r_249[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(r_252[@i_183], ck[@i_183], r_249[@i_183]) then
            if defined(r_252[@i_183], ck[@i_183], r_249[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if checkmac(y', r_249[@i_183], ck[@i_183]) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_252[@i_183]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_310: symseed;
            new tc_309: timest;
            let e5: maxmac = encsym(pad(C, tc_309), AK_60, r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_313: symseed;
            new tc'_312: timest;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new s_365: symkeyseed;
            let r_364: key = kgen(s_365) in
            new s_362: symkeyseed;
            let r_361: key = kgen(s_362) in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), r_364, r5_149) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, r_361) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new s_253: symkeyseed;
            let r_252: key = kgen(s_253) in
            new s_250: symkeyseed;
            let r_249: key = kgen(s_250) in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), r_252, r5_156) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, r_249) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying remove assignments of binder r_249 yields

Game 33 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(r_364[@i_184], ck[@i_184], r_361[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(r_364[@i_184], ck[@i_184], r_361[@i_184]) then
            if defined(r_364[@i_184], ck[@i_184], r_361[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if checkmac(y', r_361[@i_184], ck[@i_184]) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_364[@i_184]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_549: symseed;
            new tc_550: timest;
            let e5: maxmac = encsym(pad(C, tc_550), AK_60, r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_552: symseed;
            new tc'_553: timest;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s_250[@i_183], r_249[@i_183], r_252[@i_183], ck[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s_250[@i_183], r_249[@i_183], r_252[@i_183], ck[@i_183]) then
            if defined(s_250[@i_183], r_249[@i_183], r_252[@i_183], ck[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if checkmac(y', kgen(s_250[@i_183]), ck[@i_183]) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_252[@i_183]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_310: symseed;
            new tc_309: timest;
            let e5: maxmac = encsym(pad(C, tc_309), AK_60, r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_313: symseed;
            new tc'_312: timest;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new s_365: symkeyseed;
            let r_364: key = kgen(s_365) in
            new s_362: symkeyseed;
            let r_361: key = kgen(s_362) in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), r_364, r5_149) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, r_361) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new s_253: symkeyseed;
            let r_252: key = kgen(s_253) in
            new s_250: symkeyseed;
            let r_249: key = cst_key in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), r_252, r5_156) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, kgen(s_250)) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with s_250 [Difference of probability N * Pmac(time + time(context for game 33), 1., N)] yields

Game 34 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(r_364[@i_184], ck[@i_184], r_361[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(r_364[@i_184], ck[@i_184], r_361[@i_184]) then
            if defined(r_364[@i_184], ck[@i_184], r_361[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if checkmac(y', r_361[@i_184], ck[@i_184]) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_364[@i_184]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_549: symseed;
            new tc_550: timest;
            let e5: maxmac = encsym(pad(C, tc_550), AK_60, r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_552: symseed;
            new tc'_553: timest;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s_250[@i_183], r_249[@i_183], r_252[@i_183], ck[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s_250[@i_183], r_249[@i_183], r_252[@i_183], ck[@i_183]) then
            if defined(s_250[@i_183], r_249[@i_183], r_252[@i_183], ck[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if defined(x_613[@i_183]) && ((y' = x_613[@i_183]) && checkmac2(x_613[@i_183], kgen2(s_250[@i_183]), ck[@i_183])) then
              if true then
              let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_252[@i_183]) in
              event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
              out(c18[!_35], acceptC1(hostZ, hostT));
              ! !_36 <= N3
              in(c17[!_36, !_35], (hosT': tgs, hostS: server));
              if (hosT' = hostT) then
              new r7_310: symseed;
              new tc_309: timest;
              let e5: maxmac = encsym(pad(C, tc_309), AK_60, r7_310) in
              event partCT(hostT, TGT_58, e5);
              new n3_311: nonce;
              out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
              in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
              let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
              event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_313: symseed;
              new tc'_312: timest;
              let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            else
              if false then
              let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_252[@i_183]) in
              event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
              out(c18[!_35], acceptC1(hostZ, hostT));
              ! !_36 <= N3
              in(c17[!_36, !_35], (hosT': tgs, hostS: server));
              if (hosT' = hostT) then
              new r7_310: symseed;
              new tc_309: timest;
              let e5: maxmac = encsym(pad(C, tc_309), AK_60, r7_310) in
              event partCT(hostT, TGT_58, e5);
              new n3_311: nonce;
              out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
              in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
              let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
              event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_313: symseed;
              new tc'_312: timest;
              let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new s_365: symkeyseed;
            let r_364: key = kgen(s_365) in
            new s_362: symkeyseed;
            let r_361: key = kgen(s_362) in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), r_364, r5_149) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, r_361) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new s_253: symkeyseed;
            let r_252: key = kgen(s_253) in
            new s_250: symkeyseed;
            let r_249: key = cst_key in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), r_252, r5_156) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let x_613: maxmac = y in
            let ck: macs = mac2(x_613, kgen2(s_250)) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying simplify [Difference of probability 0.5 * N * N / |nonce|] yields

Game 35 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(r_364[@i_184], ck[@i_184], r_361[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(r_364[@i_184], ck[@i_184], r_361[@i_184]) then
            if defined(r_364[@i_184], ck[@i_184], r_361[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if checkmac(y', r_361[@i_184], ck[@i_184]) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_364[@i_184]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_549: symseed;
            new tc_550: timest;
            let e5: maxmac = encsym(pad(C, tc_550), AK_60, r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_552: symseed;
            new tc'_553: timest;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if defined(r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_252[@i_183]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_310: symseed;
            new tc_309: timest;
            let e5: maxmac = encsym(pad(C, tc_309), AK_60, r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_313: symseed;
            new tc'_312: timest;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new s_365: symkeyseed;
            let r_364: key = kgen(s_365) in
            new s_362: symkeyseed;
            let r_361: key = kgen(s_362) in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), r_364, r5_149) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, r_361) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new s_253: symkeyseed;
            let r_252: key = kgen(s_253) in
            new s_250: symkeyseed;
            let r_249: key = cst_key in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), r_252, r5_156) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let x_613: maxmac = y in
            let ck: macs = mac2(x_613, kgen2(s_250)) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying move new all binders yields

Game 36 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(r_364[@i_184], ck[@i_184], r_361[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(r_364[@i_184], ck[@i_184], r_361[@i_184]) then
            if defined(r_364[@i_184], ck[@i_184], r_361[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if checkmac(y', r_361[@i_184], ck[@i_184]) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_364[@i_184]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_550: timest;
            new r7_549: symseed;
            let e5: maxmac = encsym(pad(C, tc_550), AK_60, r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_553: timest;
            new r2_552: symseed;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if defined(r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_252[@i_183]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_309: timest;
            new r7_310: symseed;
            let e5: maxmac = encsym(pad(C, tc_309), AK_60, r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_312: timest;
            new r2_313: symseed;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new s_365: symkeyseed;
            let r_364: key = kgen(s_365) in
            new s_362: symkeyseed;
            let r_361: key = kgen(s_362) in
            new tk_148: timest;
            new r4_147: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), r_364, r5_149) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, r_361) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new s_253: symkeyseed;
            let r_252: key = kgen(s_253) in
            let r_249: key = cst_key in
            new tk_155: timest;
            new r4_154: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), r_252, r5_156) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let x_613: maxmac = y in
            new s_250: symkeyseed;
            let ck: macs = mac2(x_613, kgen2(s_250)) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new tt_51: timest;
        new r10: symseed;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying remove assignments of useless yields

Game 37 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(r_364[@i_184], ck[@i_184], r_361[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(r_364[@i_184], ck[@i_184], r_361[@i_184]) then
            if defined(r_364[@i_184], ck[@i_184], r_361[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if checkmac(y', r_361[@i_184], ck[@i_184]) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_364[@i_184]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_550: timest;
            new r7_549: symseed;
            let e5: maxmac = encsym(pad(C, tc_550), AK_60, r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_553: timest;
            new r2_552: symseed;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_252[@i_183]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_309: timest;
            new r7_310: symseed;
            let e5: maxmac = encsym(pad(C, tc_309), AK_60, r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_312: timest;
            new r2_313: symseed;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new s_365: symkeyseed;
            let r_364: key = kgen(s_365) in
            new s_362: symkeyseed;
            let r_361: key = kgen(s_362) in
            new tk_148: timest;
            new r4_147: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), r_364, r5_149) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, r_361) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new s_253: symkeyseed;
            let r_252: key = kgen(s_253) in
            new tk_155: timest;
            new r4_154: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), r_252, r5_156) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            new s_250: symkeyseed;
            let ck: macs = mac2(y, kgen2(s_250)) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new tt_51: timest;
        new r10: symseed;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying remove assignments of binder r_361 yields

Game 38 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s_362[@i_184], r_361[@i_184], r_364[@i_184], ck[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s_362[@i_184], r_361[@i_184], r_364[@i_184], ck[@i_184]) then
            if defined(s_362[@i_184], r_361[@i_184], r_364[@i_184], ck[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if checkmac(y', kgen(s_362[@i_184]), ck[@i_184]) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_364[@i_184]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_550: timest;
            new r7_549: symseed;
            let e5: maxmac = encsym(pad(C, tc_550), AK_60, r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_553: timest;
            new r2_552: symseed;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_252[@i_183]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_309: timest;
            new r7_310: symseed;
            let e5: maxmac = encsym(pad(C, tc_309), AK_60, r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_312: timest;
            new r2_313: symseed;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new s_365: symkeyseed;
            let r_364: key = kgen(s_365) in
            new s_362: symkeyseed;
            let r_361: key = cst_key in
            new tk_148: timest;
            new r4_147: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), r_364, r5_149) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let ck: macs = mac(y, kgen(s_362)) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new s_253: symkeyseed;
            let r_252: key = kgen(s_253) in
            new tk_155: timest;
            new r4_154: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), r_252, r5_156) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            new s_250: symkeyseed;
            let ck: macs = mac2(y, kgen2(s_250)) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new tt_51: timest;
        new r10: symseed;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying equivalence
equiv ! !_25 <= N3 new r: symkeyseed; (
  ! !_26 <= N (x: maxmac) -> mac(x, kgen(r)),
  ! !_27 <= N2 (m: maxmac, ma: macs) -> checkmac(m, kgen(r), ma))
<=(N3 * Pmac(time, N, N2))=>
      ! !_28 <= N3 new r: symkeyseed; (
  ! !_29 <= N (x_78: maxmac) -> let x: maxmac = x_78 in mac2(x, kgen2(r)),
  ! !_30 <= N2 (m: maxmac, ma: macs) -> find j <= N suchthat defined(x[j]) && ((m = x[j]) && checkmac2(x[j], kgen2(r), ma)) then true else false)
with s_362 [Difference of probability N * Pmac(time + time(context for game 38), 1., N)] yields

Game 39 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s_362[@i_184], r_361[@i_184], r_364[@i_184], ck[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s_362[@i_184], r_361[@i_184], r_364[@i_184], ck[@i_184]) then
            if defined(s_362[@i_184], r_361[@i_184], r_364[@i_184], ck[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if defined(x_676[@i_184]) && ((y' = x_676[@i_184]) && checkmac2(x_676[@i_184], kgen2(s_362[@i_184]), ck[@i_184])) then
              if true then
              let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_364[@i_184]) in
              event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
              out(c18[!_35], acceptC1(hostZ, hostT));
              ! !_36 <= N3
              in(c17[!_36, !_35], (hosT': tgs, hostS: server));
              if (hosT' = hostT) then
              new tc_550: timest;
              new r7_549: symseed;
              let e5: maxmac = encsym(pad(C, tc_550), AK_60, r7_549) in
              event partCT(hostT, TGT_58, e5);
              new n3_551: nonce;
              out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
              in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
              let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
              event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_553: timest;
              new r2_552: symseed;
              let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            else
              if false then
              let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_364[@i_184]) in
              event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
              out(c18[!_35], acceptC1(hostZ, hostT));
              ! !_36 <= N3
              in(c17[!_36, !_35], (hosT': tgs, hostS: server));
              if (hosT' = hostT) then
              new tc_550: timest;
              new r7_549: symseed;
              let e5: maxmac = encsym(pad(C, tc_550), AK_60, r7_549) in
              event partCT(hostT, TGT_58, e5);
              new n3_551: nonce;
              out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
              in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
              let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
              event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_553: timest;
              new r2_552: symseed;
              let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_252[@i_183]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_309: timest;
            new r7_310: symseed;
            let e5: maxmac = encsym(pad(C, tc_309), AK_60, r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_312: timest;
            new r2_313: symseed;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new s_365: symkeyseed;
            let r_364: key = kgen(s_365) in
            new s_362: symkeyseed;
            let r_361: key = cst_key in
            new tk_148: timest;
            new r4_147: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), r_364, r5_149) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let x_676: maxmac = y in
            let ck: macs = mac2(x_676, kgen2(s_362)) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new s_253: symkeyseed;
            let r_252: key = kgen(s_253) in
            new tk_155: timest;
            new r4_154: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), r_252, r5_156) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            new s_250: symkeyseed;
            let ck: macs = mac2(y, kgen2(s_250)) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new tt_51: timest;
        new r10: symseed;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying simplify yields

Game 40 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_364[@i_184]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_550: timest;
            new r7_549: symseed;
            let e5: maxmac = encsym(pad(C, tc_550), AK_60, r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_553: timest;
            new r2_552: symseed;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_252[@i_183]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_309: timest;
            new r7_310: symseed;
            let e5: maxmac = encsym(pad(C, tc_309), AK_60, r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_312: timest;
            new r2_313: symseed;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new s_365: symkeyseed;
            let r_364: key = kgen(s_365) in
            new s_362: symkeyseed;
            let r_361: key = cst_key in
            new tk_148: timest;
            new r4_147: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), r_364, r5_149) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let x_676: maxmac = y in
            let ck: macs = mac2(x_676, kgen2(s_362)) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new s_253: symkeyseed;
            let r_252: key = kgen(s_253) in
            new tk_155: timest;
            new r4_154: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), r_252, r5_156) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            new s_250: symkeyseed;
            let ck: macs = mac2(y, kgen2(s_250)) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new tt_51: timest;
        new r10: symseed;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying move new all binders yields

Game 41 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            let y': maxmac = concat6(C, pkC, spkC, certC, n2, sign2(x_119, sskgen2(rkCs), r1), C, hostT, n1) in
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_364[@i_184]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_549: symseed;
            new tc_550: timest;
            let e5: maxmac = encsym(pad(C, tc_550), AK_60, r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_552: symseed;
            new tc'_553: timest;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_252[@i_183]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_310: symseed;
            new tc_309: timest;
            let e5: maxmac = encsym(pad(C, tc_309), AK_60, r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_313: symseed;
            new tc'_312: timest;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new s_365: symkeyseed;
            let r_364: key = kgen(s_365) in
            let r_361: key = cst_key in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), r_364, r5_149) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            let x_676: maxmac = y in
            new s_362: symkeyseed;
            let ck: macs = mac2(x_676, kgen2(s_362)) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new s_253: symkeyseed;
            let r_252: key = kgen(s_253) in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), r_252, r5_156) in
            let y: maxmac = concat6(hostY_53, pkY, spkY, ms3, n4, ms4, hostY_53, hostW_52, n5) in
            new s_250: symkeyseed;
            let ck: macs = mac2(y, kgen2(s_250)) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying remove assignments of useless yields

Game 42 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_364[@i_184]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_549: symseed;
            new tc_550: timest;
            let e5: maxmac = encsym(pad(C, tc_550), AK_60, r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_552: symseed;
            new tc'_553: timest;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_252[@i_183]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_310: symseed;
            new tc_309: timest;
            let e5: maxmac = encsym(pad(C, tc_309), AK_60, r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_313: symseed;
            new tc'_312: timest;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new s_365: symkeyseed;
            let r_364: key = kgen(s_365) in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), r_364, r5_149) in
            new s_362: symkeyseed;
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new s_253: symkeyseed;
            let r_252: key = kgen(s_253) in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), r_252, r5_156) in
            new s_250: symkeyseed;
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying remove assignments of binder r_252 yields

Game 43 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_364[@i_184]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_549: symseed;
            new tc_550: timest;
            let e5: maxmac = encsym(pad(C, tc_550), AK_60, r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_552: symseed;
            new tc'_553: timest;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s_253[@i_183], r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s_253[@i_183], r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(s_253[@i_183], r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s_253[@i_183], r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, kgen(s_253[@i_183])) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_310: symseed;
            new tc_309: timest;
            let e5: maxmac = encsym(pad(C, tc_309), AK_60, r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_313: symseed;
            new tc'_312: timest;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new s_365: symkeyseed;
            let r_364: key = kgen(s_365) in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), r_364, r5_149) in
            new s_362: symkeyseed;
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new s_253: symkeyseed;
            let r_252: key = cst_key in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_155, hostW_52), kgen(s_253), r5_156) in
            new s_250: symkeyseed;
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with r5_156 [Difference of probability N * Pencctxt(time + time(context for game 43), 1., N)] yields

Game 44 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_364[@i_184]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_549: symseed;
            new tc_550: timest;
            let e5: maxmac = encsym(pad(C, tc_550), AK_60, r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_552: symseed;
            new tc'_553: timest;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s_253[@i_183], r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s_253[@i_183], r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(s_253[@i_183], r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s_253[@i_183], r_252[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(x_754[@i_183], r5_156[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
              let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = injbot2(x_754[@i_183]) in
              event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
              out(c18[!_35], acceptC1(hostZ, hostT));
              ! !_36 <= N3
              in(c17[!_36, !_35], (hosT': tgs, hostS: server));
              if (hosT' = hostT) then
              new r7_310: symseed;
              new tc_309: timest;
              let e5: maxmac = encsym(pad(C, tc_309), AK_60, r7_310) in
              event partCT(hostT, TGT_58, e5);
              new n3_311: nonce;
              out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
              in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
              let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
              event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_313: symseed;
              new tc'_312: timest;
              let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            else
              let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = bottom in
              event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
              out(c18[!_35], acceptC1(hostZ, hostT));
              ! !_36 <= N3
              in(c17[!_36, !_35], (hosT': tgs, hostS: server));
              if (hosT' = hostT) then
              new r7_310: symseed;
              new tc_309: timest;
              let e5: maxmac = encsym(pad(C, tc_309), AK_60, r7_310) in
              event partCT(hostT, TGT_58, e5);
              new n3_311: nonce;
              out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
              in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
              let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
              event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_313: symseed;
              new tc'_312: timest;
              let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new s_365: symkeyseed;
            let r_364: key = kgen(s_365) in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), r_364, r5_149) in
            new s_362: symkeyseed;
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new s_253: symkeyseed;
            let r_252: key = cst_key in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let x_754: maxenc = concat4(AK_54, n5, tk_155, hostW_52) in
            let z_753: maxmac = encsym(x_754, kgen2(s_253), r5_156) in
            let e24: maxmac = z_753 in
            new s_250: symkeyseed;
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying simplify [Difference of probability N / |nonce|] yields

Game 45 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_364[@i_184]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_549: symseed;
            new tc_550: timest;
            let e5: maxmac = encsym(pad(C, tc_550), AK_60, r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_552: symseed;
            new tc'_553: timest;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(tk_155[@i_183], AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(tk_155[@i_183], AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(tk_155[@i_183], AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(tk_155[@i_183], AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(tk_155[@i_183], AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            let AK_60: key = AK_54[@i_183] in
            let tk_59: timest = tk_155[@i_183] in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_310: symseed;
            new tc_309: timest;
            let e5: maxmac = encsym(pad(C, tc_309), AK_60, r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_313: symseed;
            new tc'_312: timest;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new s_365: symkeyseed;
            let r_364: key = kgen(s_365) in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), r_364, r5_149) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new s_253: symkeyseed;
            let r_252: key = cst_key in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            let x_754: maxenc = concat4(AK_54, n5, tk_155, hostW_52) in
            let z_753: maxmac = encsym(x_754, kgen2(s_253), r5_156) in
            let e24: maxmac = z_753 in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying move new all binders yields

Game 46 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_364[@i_184]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_550: timest;
            new r7_549: symseed;
            let e5: maxmac = encsym(pad(C, tc_550), AK_60, r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_553: timest;
            new r2_552: symseed;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(tk_155[@i_183], AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(tk_155[@i_183], AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(tk_155[@i_183], AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(tk_155[@i_183], AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(tk_155[@i_183], AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            let AK_60: key = AK_54[@i_183] in
            let tk_59: timest = tk_155[@i_183] in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_309: timest;
            new r7_310: symseed;
            let e5: maxmac = encsym(pad(C, tc_309), AK_60, r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_312: timest;
            new r2_313: symseed;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new s_365: symkeyseed;
            let r_364: key = kgen(s_365) in
            new tk_148: timest;
            new r4_147: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), r_364, r5_149) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            let r_252: key = cst_key in
            new tk_155: timest;
            new r4_154: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            let x_754: maxenc = concat4(AK_54, n5, tk_155, hostW_52) in
            new r5_156: symseed;
            new s_253: symkeyseed;
            let z_753: maxmac = encsym(x_754, kgen2(s_253), r5_156) in
            let e24: maxmac = z_753 in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, e24);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new tt_51: timest;
        new r10: symseed;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying remove assignments of useless yields

Game 47 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_364[@i_184]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_550: timest;
            new r7_549: symseed;
            let e5: maxmac = encsym(pad(C, tc_550), AK_60, r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_553: timest;
            new r2_552: symseed;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(tk_155[@i_183], AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(tk_155[@i_183], AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(tk_155[@i_183], AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(tk_155[@i_183], AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(tk_155[@i_183], AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_309: timest;
            new r7_310: symseed;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_312: timest;
            new r2_313: symseed;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new s_365: symkeyseed;
            let r_364: key = kgen(s_365) in
            new tk_148: timest;
            new r4_147: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), r_364, r5_149) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new tk_155: timest;
            new r4_154: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            let x_754: maxenc = concat4(AK_54, n5, tk_155, hostW_52) in
            new r5_156: symseed;
            new s_253: symkeyseed;
            let z_753: maxmac = encsym(x_754, kgen2(s_253), r5_156) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new tt_51: timest;
        new r10: symseed;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying equivalence
equiv ! !_15 <= N2 new r: symkeyseed; ! !_16 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen2(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_17 <= N2 new r: symkeyseed; ! !_18 <= N new r2: symseed; (x: maxenc) -> encsym2(Z2(x), kgen2(r), r2)
 [Difference of probability N * Penc(time + time(context for game 47), 1.)] yields

Game 48 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_364[@i_184]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_550: timest;
            new r7_549: symseed;
            let e5: maxmac = encsym(pad(C, tc_550), AK_60, r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_553: timest;
            new r2_552: symseed;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(tk_155[@i_183], AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(tk_155[@i_183], AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(tk_155[@i_183], AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(tk_155[@i_183], AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(tk_155[@i_183], AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_309: timest;
            new r7_310: symseed;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_312: timest;
            new r2_313: symseed;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new s_365: symkeyseed;
            let r_364: key = kgen(s_365) in
            new tk_148: timest;
            new r4_147: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), r_364, r5_149) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new tk_155: timest;
            new r4_154: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            let x_754: maxenc = concat4(AK_54, n5, tk_155, hostW_52) in
            new r5_156: symseed;
            new s_253: symkeyseed;
            let z_753: maxmac = encsym2(Z2(x_754), kgen2(s_253), r5_156) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new tt_51: timest;
        new r10: symseed;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying simplify yields

Game 49 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_364[@i_184]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_550: timest;
            new r7_549: symseed;
            let e5: maxmac = encsym(pad(C, tc_550), AK_60, r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_553: timest;
            new r2_552: symseed;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_309: timest;
            new r7_310: symseed;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_312: timest;
            new r2_313: symseed;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new s_365: symkeyseed;
            let r_364: key = kgen(s_365) in
            new tk_148: timest;
            new r4_147: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), r_364, r5_149) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new tk_155: timest;
            new r4_154: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            let x_754: maxenc = concat4(AK_54, n5, tk_155, hostW_52) in
            new r5_156: symseed;
            new s_253: symkeyseed;
            let z_753: maxmac = encsym2(Zconcat4, kgen2(s_253), r5_156) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new tt_51: timest;
        new r10: symseed;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying move new all binders yields

Game 50 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_364[@i_184]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_549: symseed;
            new tc_550: timest;
            let e5: maxmac = encsym(pad(C, tc_550), AK_60, r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_552: symseed;
            new tc'_553: timest;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_310: symseed;
            new tc_309: timest;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_313: symseed;
            new tc'_312: timest;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new s_365: symkeyseed;
            let r_364: key = kgen(s_365) in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), r_364, r5_149) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            let x_754: maxenc = concat4(AK_54, n5, tk_155, hostW_52) in
            new s_253: symkeyseed;
            new r5_156: symseed;
            let z_753: maxmac = encsym2(Zconcat4, kgen2(s_253), r5_156) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying remove assignments of useless yields

Game 51 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, r_364[@i_184]) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_549: symseed;
            new tc_550: timest;
            let e5: maxmac = encsym(pad(C, tc_550), AK_60, r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_552: symseed;
            new tc'_553: timest;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_310: symseed;
            new tc_309: timest;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_313: symseed;
            new tc'_312: timest;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new s_365: symkeyseed;
            let r_364: key = kgen(s_365) in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), r_364, r5_149) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new s_253: symkeyseed;
            new r5_156: symseed;
            let z_753: maxmac = encsym2(Zconcat4, kgen2(s_253), r5_156) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying remove assignments of binder r_364 yields

Game 52 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s_365[@i_184], r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s_365[@i_184], r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(s_365[@i_184], r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s_365[@i_184], r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = decsym(m24, kgen(s_365[@i_184])) in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_549: symseed;
            new tc_550: timest;
            let e5: maxmac = encsym(pad(C, tc_550), AK_60, r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_552: symseed;
            new tc'_553: timest;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_310: symseed;
            new tc_309: timest;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_313: symseed;
            new tc'_312: timest;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new s_365: symkeyseed;
            let r_364: key = cst_key in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let e24: maxmac = encsym(concat4(AK_54, n5, tk_148, hostW_52), kgen(s_365), r5_149) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new s_253: symkeyseed;
            new r5_156: symseed;
            let z_753: maxmac = encsym2(Zconcat4, kgen2(s_253), r5_156) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with r5_149 [Difference of probability N * Pencctxt(time + time(context for game 52), 1., N)] yields

Game 53 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s_365[@i_184], r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s_365[@i_184], r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(s_365[@i_184], r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s_365[@i_184], r_364[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(x_922[@i_184], r5_149[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
              let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = injbot2(x_922[@i_184]) in
              event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
              out(c18[!_35], acceptC1(hostZ, hostT));
              ! !_36 <= N3
              in(c17[!_36, !_35], (hosT': tgs, hostS: server));
              if (hosT' = hostT) then
              new r7_549: symseed;
              new tc_550: timest;
              let e5: maxmac = encsym(pad(C, tc_550), AK_60, r7_549) in
              event partCT(hostT, TGT_58, e5);
              new n3_551: nonce;
              out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
              in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
              let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
              event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_552: symseed;
              new tc'_553: timest;
              let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            else
              let injbot2(concat4(AK_60: key, =n1, tk_59: timest, =hostT)) = bottom in
              event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
              out(c18[!_35], acceptC1(hostZ, hostT));
              ! !_36 <= N3
              in(c17[!_36, !_35], (hosT': tgs, hostS: server));
              if (hosT' = hostT) then
              new r7_549: symseed;
              new tc_550: timest;
              let e5: maxmac = encsym(pad(C, tc_550), AK_60, r7_549) in
              event partCT(hostT, TGT_58, e5);
              new n3_551: nonce;
              out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
              in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
              let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
              event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_552: symseed;
              new tc'_553: timest;
              let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_310: symseed;
            new tc_309: timest;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_313: symseed;
            new tc'_312: timest;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new s_365: symkeyseed;
            let r_364: key = cst_key in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let x_922: maxenc = concat4(AK_54, n5, tk_148, hostW_52) in
            let z_921: maxmac = encsym(x_922, kgen2(s_365), r5_149) in
            let e24: maxmac = z_921 in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new s_253: symkeyseed;
            new r5_156: symseed;
            let z_753: maxmac = encsym2(Zconcat4, kgen2(s_253), r5_156) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying simplify [Difference of probability N / |nonce|] yields

Game 54 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(tk_148[@i_184], AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(tk_148[@i_184], AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(tk_148[@i_184], AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(tk_148[@i_184], AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(tk_148[@i_184], AK_54[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
            let AK_60: key = AK_54[@i_184] in
            let tk_59: timest = tk_148[@i_184] in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_549: symseed;
            new tc_550: timest;
            let e5: maxmac = encsym(pad(C, tc_550), AK_60, r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_552: symseed;
            new tc'_553: timest;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_310: symseed;
            new tc_309: timest;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_313: symseed;
            new tc'_312: timest;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new s_365: symkeyseed;
            let r_364: key = cst_key in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            let x_922: maxenc = concat4(AK_54, n5, tk_148, hostW_52) in
            let z_921: maxmac = encsym(x_922, kgen2(s_365), r5_149) in
            let e24: maxmac = z_921 in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new s_253: symkeyseed;
            new r5_156: symseed;
            let z_753: maxmac = encsym2(Zconcat4, kgen2(s_253), r5_156) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying move new all binders yields

Game 55 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(tk_148[@i_184], AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(tk_148[@i_184], AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(tk_148[@i_184], AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(tk_148[@i_184], AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(tk_148[@i_184], AK_54[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
            let AK_60: key = AK_54[@i_184] in
            let tk_59: timest = tk_148[@i_184] in
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_550: timest;
            new r7_549: symseed;
            let e5: maxmac = encsym(pad(C, tc_550), AK_60, r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_60) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_553: timest;
            new r2_552: symseed;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_309: timest;
            new r7_310: symseed;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_312: timest;
            new r2_313: symseed;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            let r_364: key = cst_key in
            new tk_148: timest;
            new r4_147: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            let x_922: maxenc = concat4(AK_54, n5, tk_148, hostW_52) in
            new r5_149: symseed;
            new s_365: symkeyseed;
            let z_921: maxmac = encsym(x_922, kgen2(s_365), r5_149) in
            let e24: maxmac = z_921 in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, e24) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, e24);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new tk_155: timest;
            new r4_154: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            new s_253: symkeyseed;
            let z_753: maxmac = encsym2(Zconcat4, kgen2(s_253), r5_156) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new tt_51: timest;
        new r10: symseed;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying remove assignments of useless yields

Game 56 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(tk_148[@i_184], AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(tk_148[@i_184], AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(tk_148[@i_184], AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(tk_148[@i_184], AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(tk_148[@i_184], AK_54[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_550: timest;
            new r7_549: symseed;
            let e5: maxmac = encsym(pad(C, tc_550), AK_54[@i_184], r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_184]) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_553: timest;
            new r2_552: symseed;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_309: timest;
            new r7_310: symseed;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_312: timest;
            new r2_313: symseed;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new tk_148: timest;
            new r4_147: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            let x_922: maxenc = concat4(AK_54, n5, tk_148, hostW_52) in
            new r5_149: symseed;
            new s_365: symkeyseed;
            let z_921: maxmac = encsym(x_922, kgen2(s_365), r5_149) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new tk_155: timest;
            new r4_154: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            new s_253: symkeyseed;
            let z_753: maxmac = encsym2(Zconcat4, kgen2(s_253), r5_156) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new tt_51: timest;
        new r10: symseed;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


RESULT Proved event inj:fullCK(K, T, N, w, x, y) ==> inj:fullKC(C, T, N, w, z, y) with probability N * N / |nonce| + 2. * N / |nonce| + N * Pencctxt(time + time(context for game 52), 1., N) + N * Penc(time + time(context for game 47), 1.) + N * Pencctxt(time + time(context for game 43), 1., N) + N * Pmac(time + time(context for game 38), 1., N) + N * Pmac(time + time(context for game 33), 1., N) + N * pPRF(time + time(context for game 27), 2. * 1. + 2. * N) + N * pPRF(time + time(context for game 22), 2. * 1. + 2. * N) + 3. * 1. / |skeyseed| + 3. * Psigncoll + Psign(time + time(context for game 18), 0) + N * Penc(time + time(context for game 14), N) + Psign(time + time(context for game 9), N) + Psign(time + time(context for game 5), 2. * 1.)

Applying equivalence
equiv ! !_15 <= N2 new r: symkeyseed; ! !_16 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen2(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_17 <= N2 new r: symkeyseed; ! !_18 <= N new r2: symseed; (x: maxenc) -> encsym2(Z2(x), kgen2(r), r2)
 [Difference of probability N * Penc(time + time(context for game 57), 1.)] yields

Game 58 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(tk_148[@i_184], AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(tk_148[@i_184], AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(tk_148[@i_184], AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(tk_148[@i_184], AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(tk_148[@i_184], AK_54[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_550: timest;
            new r7_549: symseed;
            let e5: maxmac = encsym(pad(C, tc_550), AK_54[@i_184], r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_184]) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_553: timest;
            new r2_552: symseed;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_309: timest;
            new r7_310: symseed;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_312: timest;
            new r2_313: symseed;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new tk_148: timest;
            new r4_147: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            let x_922: maxenc = concat4(AK_54, n5, tk_148, hostW_52) in
            new r5_149: symseed;
            new s_365: symkeyseed;
            let z_921: maxmac = encsym2(Z2(x_922), kgen2(s_365), r5_149) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new tk_155: timest;
            new r4_154: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            new s_253: symkeyseed;
            let z_753: maxmac = encsym2(Zconcat4, kgen2(s_253), r5_156) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new tt_51: timest;
        new r10: symseed;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying simplify yields

Game 59 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(AK_54[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_550: timest;
            new r7_549: symseed;
            let e5: maxmac = encsym(pad(C, tc_550), AK_54[@i_184], r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_184]) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_553: timest;
            new r2_552: symseed;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_309: timest;
            new r7_310: symseed;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_312: timest;
            new r2_313: symseed;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new tk_148: timest;
            new r4_147: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            let x_922: maxenc = concat4(AK_54, n5, tk_148, hostW_52) in
            new r5_149: symseed;
            new s_365: symkeyseed;
            let z_921: maxmac = encsym2(Zconcat4, kgen2(s_365), r5_149) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new tk_155: timest;
            new r4_154: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            new s_253: symkeyseed;
            let z_753: maxmac = encsym2(Zconcat4, kgen2(s_253), r5_156) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new tt_51: timest;
        new r10: symseed;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying move new all binders yields

Game 60 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(AK_54[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_549: symseed;
            new tc_550: timest;
            let e5: maxmac = encsym(pad(C, tc_550), AK_54[@i_184], r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_184]) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_552: symseed;
            new tc'_553: timest;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_310: symseed;
            new tc_309: timest;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_313: symseed;
            new tc'_312: timest;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            let x_922: maxenc = concat4(AK_54, n5, tk_148, hostW_52) in
            new s_365: symkeyseed;
            new r5_149: symseed;
            let z_921: maxmac = encsym2(Zconcat4, kgen2(s_365), r5_149) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new s_253: symkeyseed;
            new r5_156: symseed;
            let z_753: maxmac = encsym2(Zconcat4, kgen2(s_253), r5_156) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying remove assignments of useless yields

Game 61 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let Ks: key = kgen(rKs) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(AK_54[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_549: symseed;
            new tc_550: timest;
            let e5: maxmac = encsym(pad(C, tc_550), AK_54[@i_184], r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_184]) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_552: symseed;
            new tc'_553: timest;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_310: symseed;
            new tc_309: timest;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_313: symseed;
            new tc'_312: timest;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new s_365: symkeyseed;
            new r5_149: symseed;
            let z_921: maxmac = encsym2(Zconcat4, kgen2(s_365), r5_149) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new s_253: symkeyseed;
            new r5_156: symseed;
            let z_753: maxmac = encsym2(Zconcat4, kgen2(s_253), r5_156) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, Ks) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = Ks
  else
    let Pkey: key = Mkey
)


Applying remove assignments of binder Ks yields

Game 62 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(AK_54[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_549: symseed;
            new tc_550: timest;
            let e5: maxmac = encsym(pad(C, tc_550), AK_54[@i_184], r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_184]) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_552: symseed;
            new tc'_553: timest;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_310: symseed;
            new tc_309: timest;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_313: symseed;
            new tc'_312: timest;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new s_365: symkeyseed;
            new r5_149: symseed;
            let z_921: maxmac = encsym2(Zconcat4, kgen2(s_365), r5_149) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new s_253: symkeyseed;
            new r5_156: symseed;
            let z_753: maxmac = encsym2(Zconcat4, kgen2(s_253), r5_156) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
        new rSK: symkeyseed;
        let SK_50: key = kgen(rSK) in
        new r10: symseed;
        new tt_51: timest;
        let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey[j3], r10) in
        new r11: symseed;
        let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
        event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
        out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, kgen(rKs)) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey: key = kgen(rKs)
  else
    let Pkey: key = Mkey
)


Applying SA rename Pkey yields

Game 63 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(AK_54[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_549: symseed;
            new tc_550: timest;
            let e5: maxmac = encsym(pad(C, tc_550), AK_54[@i_184], r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_184]) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_552: symseed;
            new tc'_553: timest;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_310: symseed;
            new tc_309: timest;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_313: symseed;
            new tc'_312: timest;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new s_365: symkeyseed;
            new r5_149: symseed;
            let z_921: maxmac = encsym2(Zconcat4, kgen2(s_365), r5_149) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new s_253: symkeyseed;
            new r5_156: symseed;
            let z_753: maxmac = encsym2(Zconcat4, kgen2(s_253), r5_156) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Pkey_1140[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
          new rSK: symkeyseed;
          let SK_50: key = kgen(rSK) in
          new r10: symseed;
          new tt_51: timest;
          let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey_1140[j3], r10) in
          new r11: symseed;
          let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
          event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
          out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
        orfind j3 <= N2 suchthat defined(Pkey_1141[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
          new rSK: symkeyseed;
          let SK_50: key = kgen(rSK) in
          new r10: symseed;
          new tt_51: timest;
          let e10: maxmac = encsym(concat5(SK_50, tt_51, hostY_47), Pkey_1141[j3], r10) in
          new r11: symseed;
          let e11: maxmac = encsym(concat8(SK_50, n', tt_51, hostW_46), AK_49, r11) in
          event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
          out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, kgen(rKs)) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = kgen(rKs)
  else
    let Pkey_1140: key = Mkey
)


Applying remove assignments of binder Pkey_1141 yields

Game 64 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(AK_54[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_549: symseed;
            new tc_550: timest;
            let e5: maxmac = encsym(pad(C, tc_550), AK_54[@i_184], r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_184]) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_552: symseed;
            new tc'_553: timest;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_310: symseed;
            new tc_309: timest;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_313: symseed;
            new tc'_312: timest;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new s_365: symkeyseed;
            new r5_149: symseed;
            let z_921: maxmac = encsym2(Zconcat4, kgen2(s_365), r5_149) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new s_253: symkeyseed;
            new r5_156: symseed;
            let z_753: maxmac = encsym2(Zconcat4, kgen2(s_253), r5_156) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Mkey[j3], Pkey_1140[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
          new rSK_1142: symkeyseed;
          let SK_50: key = kgen(rSK_1142) in
          new r10_1143: symseed;
          new tt_1144: timest;
          let e10: maxmac = encsym(concat5(SK_50, tt_1144, hostY_47), Mkey[j3], r10_1143) in
          new r11_1145: symseed;
          let e11: maxmac = encsym(concat8(SK_50, n', tt_1144, hostW_46), AK_49, r11_1145) in
          event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
          out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
        orfind j3 <= N2 suchthat defined(rKs, Pkey_1141[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
          new rSK_1146: symkeyseed;
          let SK_50: key = kgen(rSK_1146) in
          new r10_1147: symseed;
          new tt_1148: timest;
          let e10: maxmac = encsym(concat5(SK_50, tt_1148, hostY_47), kgen(rKs), r10_1147) in
          new r11_1149: symseed;
          let e11: maxmac = encsym(concat8(SK_50, n', tt_1148, hostW_46), AK_49, r11_1149) in
          event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
          out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = decsym(m14, kgen(rKs)) in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with rKs [Difference of probability Pencctxt(time + time(context for game 64), N, N)] yields

Game 65 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(AK_54[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_549: symseed;
            new tc_550: timest;
            let e5: maxmac = encsym(pad(C, tc_550), AK_54[@i_184], r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_184]) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_552: symseed;
            new tc'_553: timest;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_310: symseed;
            new tc_309: timest;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_313: symseed;
            new tc'_312: timest;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new s_365: symkeyseed;
            new r5_149: symseed;
            let z_921: maxmac = encsym2(Zconcat4, kgen2(s_365), r5_149) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new s_253: symkeyseed;
            new r5_156: symseed;
            let z_753: maxmac = encsym2(Zconcat4, kgen2(s_253), r5_156) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Mkey[j3], Pkey_1140[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
          new rSK_1142: symkeyseed;
          let SK_50: key = kgen(rSK_1142) in
          new r10_1143: symseed;
          new tt_1144: timest;
          let e10: maxmac = encsym(concat5(SK_50, tt_1144, hostY_47), Mkey[j3], r10_1143) in
          new r11_1145: symseed;
          let e11: maxmac = encsym(concat8(SK_50, n', tt_1144, hostW_46), AK_49, r11_1145) in
          event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
          out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
        orfind j3 <= N2 suchthat defined(rKs, Pkey_1141[j3], Mhost2[j3], Mhost1[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
          new rSK_1146: symkeyseed;
          let SK_50: key = kgen(rSK_1146) in
          new r10_1147: symseed;
          new tt_1148: timest;
          let x_1151: maxenc = concat5(SK_50, tt_1148, hostY_47) in
          let z_1150: maxmac = encsym(x_1151, kgen2(rKs), r10_1147) in
          let e10: maxmac = z_1150 in
          new r11_1149: symseed;
          let e11: maxmac = encsym(concat8(SK_50, n', tt_1148, hostW_46), AK_49, r11_1149) in
          event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
          out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(x_1151[@i_1153], r10_1147[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
        let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = injbot2(x_1151[@i_1153]) in
        let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
        new r16: symseed;
        let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
        event partSC(hostC, m14, m15);
        event fullSC(hostC, m14, m15, e16);
        out(c12[!_40], (e16, acceptS(hostC)))
      else
        let injbot2(concat5(SK_44: key, tt_43: timest, hostC: client)) = bottom in
        let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
        new r16: symseed;
        let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
        event partSC(hostC, m14, m15);
        event fullSC(hostC, m14, m15, e16);
        out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying simplify yields

Game 66 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
new rKs: symkeyseed;
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(AK_54[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_549: symseed;
            new tc_550: timest;
            let e5: maxmac = encsym(pad(C, tc_550), AK_54[@i_184], r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_184]) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_552: symseed;
            new tc'_553: timest;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_310: symseed;
            new tc_309: timest;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_313: symseed;
            new tc'_312: timest;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new s_365: symkeyseed;
            new r5_149: symseed;
            let z_921: maxmac = encsym2(Zconcat4, kgen2(s_365), r5_149) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new s_253: symkeyseed;
            new r5_156: symseed;
            let z_753: maxmac = encsym2(Zconcat4, kgen2(s_253), r5_156) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
          new rSK_1142: symkeyseed;
          let SK_50: key = kgen(rSK_1142) in
          new r10_1143: symseed;
          new tt_1144: timest;
          let e10: maxmac = encsym(concat5(SK_50, tt_1144, hostY_47), Mkey[j3], r10_1143) in
          new r11_1145: symseed;
          let e11: maxmac = encsym(concat8(SK_50, n', tt_1144, hostW_46), AK_49, r11_1145) in
          event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
          out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
        orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
          new rSK_1146: symkeyseed;
          let SK_50: key = kgen(rSK_1146) in
          new r10_1147: symseed;
          new tt_1148: timest;
          let x_1151: maxenc = concat5(SK_50, tt_1148, hostY_47) in
          let z_1150: maxmac = encsym(x_1151, kgen2(rKs), r10_1147) in
          let e10: maxmac = z_1150 in
          new r11_1149: symseed;
          let e11: maxmac = encsym(concat8(SK_50, n', tt_1148, hostW_46), AK_49, r11_1149) in
          event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
          out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(hostY_47[@i_1153], tt_1148[@i_1153], SK_50[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let SK_44: key = SK_50[@i_1153] in
      let tt_43: timest = tt_1148[@i_1153] in
      let hostC: client = hostY_47[@i_1153] in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying move new all binders yields

Game 67 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(AK_54[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_550: timest;
            new r7_549: symseed;
            let e5: maxmac = encsym(pad(C, tc_550), AK_54[@i_184], r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_184]) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_553: timest;
            new r2_552: symseed;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_309: timest;
            new r7_310: symseed;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_312: timest;
            new r2_313: symseed;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new tk_148: timest;
            new r4_147: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            new s_365: symkeyseed;
            let z_921: maxmac = encsym2(Zconcat4, kgen2(s_365), r5_149) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new tk_155: timest;
            new r4_154: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            new s_253: symkeyseed;
            let z_753: maxmac = encsym2(Zconcat4, kgen2(s_253), r5_156) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
          new rSK_1142: symkeyseed;
          let SK_50: key = kgen(rSK_1142) in
          new tt_1144: timest;
          new r10_1143: symseed;
          let e10: maxmac = encsym(concat5(SK_50, tt_1144, hostY_47), Mkey[j3], r10_1143) in
          new r11_1145: symseed;
          let e11: maxmac = encsym(concat8(SK_50, n', tt_1144, hostW_46), AK_49, r11_1145) in
          event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
          out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
        orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
          new rSK_1146: symkeyseed;
          let SK_50: key = kgen(rSK_1146) in
          new tt_1148: timest;
          let x_1151: maxenc = concat5(SK_50, tt_1148, hostY_47) in
          new r10_1147: symseed;
          let z_1150: maxmac = encsym(x_1151, kgen2(rKs), r10_1147) in
          let e10: maxmac = z_1150 in
          new r11_1149: symseed;
          let e11: maxmac = encsym(concat8(SK_50, n', tt_1148, hostW_46), AK_49, r11_1149) in
          event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
          out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(hostY_47[@i_1153], tt_1148[@i_1153], SK_50[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let SK_44: key = SK_50[@i_1153] in
      let tt_43: timest = tt_1148[@i_1153] in
      let hostC: client = hostY_47[@i_1153] in
      let injbot2(pad(=hostC, tc'_45: timest)) = decsym(m15, SK_44) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_44, r16) in
      event partSC(hostC, m14, m15);
      event fullSC(hostC, m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostC)))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying remove assignments of useless yields

Game 68 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(AK_54[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_550: timest;
            new r7_549: symseed;
            let e5: maxmac = encsym(pad(C, tc_550), AK_54[@i_184], r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_184]) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_553: timest;
            new r2_552: symseed;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_309: timest;
            new r7_310: symseed;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_312: timest;
            new r2_313: symseed;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new tk_148: timest;
            new r4_147: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            new s_365: symkeyseed;
            let z_921: maxmac = encsym2(Zconcat4, kgen2(s_365), r5_149) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new tk_155: timest;
            new r4_154: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            new s_253: symkeyseed;
            let z_753: maxmac = encsym2(Zconcat4, kgen2(s_253), r5_156) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
          new rSK_1142: symkeyseed;
          let SK_50: key = kgen(rSK_1142) in
          new tt_1144: timest;
          new r10_1143: symseed;
          let e10: maxmac = encsym(concat5(SK_50, tt_1144, hostY_47), Mkey[j3], r10_1143) in
          new r11_1145: symseed;
          let e11: maxmac = encsym(concat8(SK_50, n', tt_1144, hostW_46), AK_49, r11_1145) in
          event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
          out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
        orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
          new rSK_1146: symkeyseed;
          let SK_50: key = kgen(rSK_1146) in
          new tt_1148: timest;
          let x_1151: maxenc = concat5(SK_50, tt_1148, hostY_47) in
          new r10_1147: symseed;
          let z_1150: maxmac = encsym(x_1151, kgen2(rKs), r10_1147) in
          new r11_1149: symseed;
          let e11: maxmac = encsym(concat8(SK_50, n', tt_1148, hostW_46), AK_49, r11_1149) in
          event fullTC(hostY_47, hostW_46, n', m8, m9, z_1150, e11);
          out(c8[!_39], (hostY_47, z_1150, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(hostY_47[@i_1153], tt_1148[@i_1153], SK_50[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying equivalence
equiv ! !_15 <= N2 new r: symkeyseed; ! !_16 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen2(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_17 <= N2 new r: symkeyseed; ! !_18 <= N new r2: symseed; (x: maxenc) -> encsym2(Z2(x), kgen2(r), r2)
 [Difference of probability Penc(time + time(context for game 68), N)] yields

Game 69 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(AK_54[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_550: timest;
            new r7_549: symseed;
            let e5: maxmac = encsym(pad(C, tc_550), AK_54[@i_184], r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_184]) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_553: timest;
            new r2_552: symseed;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_309: timest;
            new r7_310: symseed;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_312: timest;
            new r2_313: symseed;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new tk_148: timest;
            new r4_147: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            new s_365: symkeyseed;
            let z_921: maxmac = encsym2(Zconcat4, kgen2(s_365), r5_149) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new tk_155: timest;
            new r4_154: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            new s_253: symkeyseed;
            let z_753: maxmac = encsym2(Zconcat4, kgen2(s_253), r5_156) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
          new rSK_1142: symkeyseed;
          let SK_50: key = kgen(rSK_1142) in
          new tt_1144: timest;
          new r10_1143: symseed;
          let e10: maxmac = encsym(concat5(SK_50, tt_1144, hostY_47), Mkey[j3], r10_1143) in
          new r11_1145: symseed;
          let e11: maxmac = encsym(concat8(SK_50, n', tt_1144, hostW_46), AK_49, r11_1145) in
          event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
          out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
        orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
          new rSK_1146: symkeyseed;
          let SK_50: key = kgen(rSK_1146) in
          new tt_1148: timest;
          let x_1151: maxenc = concat5(SK_50, tt_1148, hostY_47) in
          new r10_1147: symseed;
          let z_1150: maxmac = encsym2(Z2(x_1151), kgen2(rKs), r10_1147) in
          new r11_1149: symseed;
          let e11: maxmac = encsym(concat8(SK_50, n', tt_1148, hostW_46), AK_49, r11_1149) in
          event fullTC(hostY_47, hostW_46, n', m8, m9, z_1150, e11);
          out(c8[!_39], (hostY_47, z_1150, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(hostY_47[@i_1153], tt_1148[@i_1153], SK_50[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying simplify yields

Game 70 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(AK_54[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_550: timest;
            new r7_549: symseed;
            let e5: maxmac = encsym(pad(C, tc_550), AK_54[@i_184], r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_184]) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_553: timest;
            new r2_552: symseed;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_309: timest;
            new r7_310: symseed;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_312: timest;
            new r2_313: symseed;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new tk_148: timest;
            new r4_147: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new r5_149: symseed;
            new s_365: symkeyseed;
            let z_921: maxmac = encsym2(Zconcat4, kgen2(s_365), r5_149) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new tk_155: timest;
            new r4_154: symseed;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new r5_156: symseed;
            new s_253: symkeyseed;
            let z_753: maxmac = encsym2(Zconcat4, kgen2(s_253), r5_156) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
          new rSK_1142: symkeyseed;
          let SK_50: key = kgen(rSK_1142) in
          new tt_1144: timest;
          new r10_1143: symseed;
          let e10: maxmac = encsym(concat5(SK_50, tt_1144, hostY_47), Mkey[j3], r10_1143) in
          new r11_1145: symseed;
          let e11: maxmac = encsym(concat8(SK_50, n', tt_1144, hostW_46), AK_49, r11_1145) in
          event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
          out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
        orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
          new rSK_1146: symkeyseed;
          let SK_50: key = kgen(rSK_1146) in
          new tt_1148: timest;
          let x_1151: maxenc = concat5(SK_50, tt_1148, hostY_47) in
          new r10_1147: symseed;
          let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1147) in
          new r11_1149: symseed;
          let e11: maxmac = encsym(concat8(SK_50, n', tt_1148, hostW_46), AK_49, r11_1149) in
          event fullTC(hostY_47, hostW_46, n', m8, m9, z_1150, e11);
          out(c8[!_39], (hostY_47, z_1150, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying move new all binders yields

Game 71 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(AK_54[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_549: symseed;
            new tc_550: timest;
            let e5: maxmac = encsym(pad(C, tc_550), AK_54[@i_184], r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_184]) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_552: symseed;
            new tc'_553: timest;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_310: symseed;
            new tc_309: timest;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_313: symseed;
            new tc'_312: timest;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new s_365: symkeyseed;
            new r5_149: symseed;
            let z_921: maxmac = encsym2(Zconcat4, kgen2(s_365), r5_149) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new s_253: symkeyseed;
            new r5_156: symseed;
            let z_753: maxmac = encsym2(Zconcat4, kgen2(s_253), r5_156) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
          new rSK_1142: symkeyseed;
          let SK_50: key = kgen(rSK_1142) in
          new r10_1143: symseed;
          new tt_1144: timest;
          let e10: maxmac = encsym(concat5(SK_50, tt_1144, hostY_47), Mkey[j3], r10_1143) in
          new r11_1145: symseed;
          let e11: maxmac = encsym(concat8(SK_50, n', tt_1144, hostW_46), AK_49, r11_1145) in
          event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
          out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
        orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
          new rSK_1146: symkeyseed;
          let SK_50: key = kgen(rSK_1146) in
          new tt_1148: timest;
          let x_1151: maxenc = concat5(SK_50, tt_1148, hostY_47) in
          new r10_1147: symseed;
          let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1147) in
          new r11_1149: symseed;
          let e11: maxmac = encsym(concat8(SK_50, n', tt_1148, hostW_46), AK_49, r11_1149) in
          event fullTC(hostY_47, hostW_46, n', m8, m9, z_1150, e11);
          out(c8[!_39], (hostY_47, z_1150, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying remove assignments of useless yields

Game 72 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let Kt: key = kgen(rKt) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(AK_54[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_549: symseed;
            new tc_550: timest;
            let e5: maxmac = encsym(pad(C, tc_550), AK_54[@i_184], r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_184]) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_552: symseed;
            new tc'_553: timest;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_310: symseed;
            new tc_309: timest;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_313: symseed;
            new tc'_312: timest;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new s_365: symkeyseed;
            new r5_149: symseed;
            let z_921: maxmac = encsym2(Zconcat4, kgen2(s_365), r5_149) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new s_253: symkeyseed;
            new r5_156: symseed;
            let z_753: maxmac = encsym2(Zconcat4, kgen2(s_253), r5_156) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, Kt) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
          new rSK_1142: symkeyseed;
          let SK_50: key = kgen(rSK_1142) in
          new r10_1143: symseed;
          new tt_1144: timest;
          let e10: maxmac = encsym(concat5(SK_50, tt_1144, hostY_47), Mkey[j3], r10_1143) in
          new r11_1145: symseed;
          let e11: maxmac = encsym(concat8(SK_50, n', tt_1144, hostW_46), AK_49, r11_1145) in
          event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
          out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
        orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
          new rSK_1146: symkeyseed;
          let SK_50: key = kgen(rSK_1146) in
          new tt_1148: timest;
          new r10_1147: symseed;
          let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1147) in
          new r11_1149: symseed;
          let e11: maxmac = encsym(concat8(SK_50, n', tt_1148, hostW_46), AK_49, r11_1149) in
          event fullTC(hostY_47, hostW_46, n', m8, m9, z_1150, e11);
          out(c8[!_39], (hostY_47, z_1150, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = Kt
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying remove assignments of binder Kt yields

Game 73 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(AK_54[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_549: symseed;
            new tc_550: timest;
            let e5: maxmac = encsym(pad(C, tc_550), AK_54[@i_184], r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_184]) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_552: symseed;
            new tc'_553: timest;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_310: symseed;
            new tc_309: timest;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_313: symseed;
            new tc'_312: timest;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_145: symkeyseed;
            let AK_54: key = kgen(s3_145) in
            new r4_147: symseed;
            new tk_148: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey[j1], r4_147) in
            new s_365: symkeyseed;
            new r5_149: symseed;
            let z_921: maxmac = encsym2(Zconcat4, kgen2(s_365), r5_149) in
            new r7_151: seed;
            let m2_169: bitstring = enc2(Z, pkY, r7_151) in
            let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
            event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
            out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
            new s3_152: symkeyseed;
            let AK_54: key = kgen(s3_152) in
            new r4_154: symseed;
            new tk_155: timest;
            let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey[j1], r4_154) in
            new s_253: symkeyseed;
            new r5_156: symseed;
            let z_753: maxmac = encsym2(Zconcat4, kgen2(s_253), r5_156) in
            new r7_158: seed;
            let m2_174: bitstring = enc2(Z, pkY, r7_158) in
            let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
            event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
            out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, kgen(rKt)) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
          new rSK_1142: symkeyseed;
          let SK_50: key = kgen(rSK_1142) in
          new r10_1143: symseed;
          new tt_1144: timest;
          let e10: maxmac = encsym(concat5(SK_50, tt_1144, hostY_47), Mkey[j3], r10_1143) in
          new r11_1145: symseed;
          let e11: maxmac = encsym(concat8(SK_50, n', tt_1144, hostW_46), AK_49, r11_1145) in
          event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
          out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
        orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
          new rSK_1146: symkeyseed;
          let SK_50: key = kgen(rSK_1146) in
          new tt_1148: timest;
          new r10_1147: symseed;
          let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1147) in
          new r11_1149: symseed;
          let e11: maxmac = encsym(concat8(SK_50, n', tt_1148, hostW_46), AK_49, r11_1149) in
          event fullTC(hostY_47, hostW_46, n', m8, m9, z_1150, e11);
          out(c8[!_39], (hostY_47, z_1150, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey: key = kgen(rKt)
    else
      let Qkey: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying SA rename Qkey yields

Game 74 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(AK_54[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_549: symseed;
            new tc_550: timest;
            let e5: maxmac = encsym(pad(C, tc_550), AK_54[@i_184], r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_184]) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_552: symseed;
            new tc'_553: timest;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_310: symseed;
            new tc_309: timest;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_313: symseed;
            new tc'_312: timest;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey_1352[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
              new s3_145: symkeyseed;
              let AK_54: key = kgen(s3_145) in
              new r4_147: symseed;
              new tk_148: timest;
              let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey_1352[j1], r4_147) in
              new s_365: symkeyseed;
              new r5_149: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_365), r5_149) in
              new r7_151: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_151) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Qkey_1353[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
              new s3_145: symkeyseed;
              let AK_54: key = kgen(s3_145) in
              new r4_147: symseed;
              new tk_148: timest;
              let TGT_56: maxmac = encsym(concat5(AK_54, tk_148, hostY_53), Qkey_1353[j1], r4_147) in
              new s_365: symkeyseed;
              new r5_149: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_365), r5_149) in
              new r7_151: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_151) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Qkey_1352[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
              new s3_152: symkeyseed;
              let AK_54: key = kgen(s3_152) in
              new r4_154: symseed;
              new tk_155: timest;
              let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey_1352[j1], r4_154) in
              new s_253: symkeyseed;
              new r5_156: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_253), r5_156) in
              new r7_158: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_158) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Qkey_1353[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
              new s3_152: symkeyseed;
              let AK_54: key = kgen(s3_152) in
              new r4_154: symseed;
              new tk_155: timest;
              let TGT_56: maxmac = encsym(concat5(AK_54, tk_155, hostY_53), Qkey_1353[j1], r4_154) in
              new s_253: symkeyseed;
              new r5_156: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_253), r5_156) in
              new r7_158: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_158) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, kgen(rKt)) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
          new rSK_1142: symkeyseed;
          let SK_50: key = kgen(rSK_1142) in
          new r10_1143: symseed;
          new tt_1144: timest;
          let e10: maxmac = encsym(concat5(SK_50, tt_1144, hostY_47), Mkey[j3], r10_1143) in
          new r11_1145: symseed;
          let e11: maxmac = encsym(concat8(SK_50, n', tt_1144, hostW_46), AK_49, r11_1145) in
          event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
          out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
        orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
          new rSK_1146: symkeyseed;
          let SK_50: key = kgen(rSK_1146) in
          new tt_1148: timest;
          new r10_1147: symseed;
          let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1147) in
          new r11_1149: symseed;
          let e11: maxmac = encsym(concat8(SK_50, n', tt_1148, hostW_46), AK_49, r11_1149) in
          event fullTC(hostY_47, hostW_46, n', m8, m9, z_1150, e11);
          out(c8[!_39], (hostY_47, z_1150, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = kgen(rKt)
    else
      let Qkey_1352: key = Lkey
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying remove assignments of binder Qkey_1353 yields

Game 75 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(AK_54[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_549: symseed;
            new tc_550: timest;
            let e5: maxmac = encsym(pad(C, tc_550), AK_54[@i_184], r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_184]) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_552: symseed;
            new tc'_553: timest;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_310: symseed;
            new tc_309: timest;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_313: symseed;
            new tc'_312: timest;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Qkey_1352[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_54: key = kgen(s3_1354) in
              new r4_1355: symseed;
              new tk_1356: timest;
              let TGT_56: maxmac = encsym(concat5(AK_54, tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new s_1357: symkeyseed;
              new r5_1358: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(rKt, Qkey_1353[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_54: key = kgen(s3_1360) in
              new r4_1361: symseed;
              new tk_1362: timest;
              let TGT_56: maxmac = encsym(concat5(AK_54, tk_1362, hostY_53), kgen(rKt), r4_1361) in
              new s_1363: symkeyseed;
              new r5_1364: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Qkey_1352[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_54: key = kgen(s3_1366) in
              new r4_1367: symseed;
              new tk_1368: timest;
              let TGT_56: maxmac = encsym(concat5(AK_54, tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new s_1369: symkeyseed;
              new r5_1370: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(rKt, Qkey_1353[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_54: key = kgen(s3_1372) in
              new r4_1373: symseed;
              new tk_1374: timest;
              let TGT_56: maxmac = encsym(concat5(AK_54, tk_1374, hostY_53), kgen(rKt), r4_1373) in
              new s_1375: symkeyseed;
              new r5_1376: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = decsym(m8, kgen(rKt)) in
        let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
        event partTC(hostY_47, m8, m9);
        find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
          new rSK_1142: symkeyseed;
          let SK_50: key = kgen(rSK_1142) in
          new r10_1143: symseed;
          new tt_1144: timest;
          let e10: maxmac = encsym(concat5(SK_50, tt_1144, hostY_47), Mkey[j3], r10_1143) in
          new r11_1145: symseed;
          let e11: maxmac = encsym(concat8(SK_50, n', tt_1144, hostW_46), AK_49, r11_1145) in
          event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
          out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
        orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
          new rSK_1146: symkeyseed;
          let SK_50: key = kgen(rSK_1146) in
          new tt_1148: timest;
          new r10_1147: symseed;
          let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1147) in
          new r11_1149: symseed;
          let e11: maxmac = encsym(concat8(SK_50, n', tt_1148, hostW_46), AK_49, r11_1149) in
          event fullTC(hostY_47, hostW_46, n', m8, m9, z_1150, e11);
          out(c8[!_39], (hostY_47, z_1150, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with rKt [Difference of probability Pencctxt(time + time(context for game 75), N, N)] yields

Game 76 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(AK_54[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_549: symseed;
            new tc_550: timest;
            let e5: maxmac = encsym(pad(C, tc_550), AK_54[@i_184], r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_184]) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_552: symseed;
            new tc'_553: timest;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_310: symseed;
            new tc_309: timest;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_313: symseed;
            new tc'_312: timest;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Qkey_1352[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_54: key = kgen(s3_1354) in
              new r4_1355: symseed;
              new tk_1356: timest;
              let TGT_56: maxmac = encsym(concat5(AK_54, tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new s_1357: symkeyseed;
              new r5_1358: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(rKt, Qkey_1353[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_54: key = kgen(s3_1360) in
              new r4_1361: symseed;
              new tk_1362: timest;
              let x_1379: maxenc = concat5(AK_54, tk_1362, hostY_53) in
              let z_1378: maxmac = encsym(x_1379, kgen2(rKt), r4_1361) in
              let TGT_56: maxmac = z_1378 in
              new s_1363: symkeyseed;
              new r5_1364: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Qkey_1352[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_54: key = kgen(s3_1366) in
              new r4_1367: symseed;
              new tk_1368: timest;
              let TGT_56: maxmac = encsym(concat5(AK_54, tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new s_1369: symkeyseed;
              new r5_1370: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(rKt, Qkey_1353[j1], Lhost[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_54: key = kgen(s3_1372) in
              new r4_1373: symseed;
              new tk_1374: timest;
              let x_1382: maxenc = concat5(AK_54, tk_1374, hostY_53) in
              let z_1381: maxmac = encsym(x_1382, kgen2(rKt), r4_1373) in
              let TGT_56: maxmac = z_1381 in
              new s_1375: symkeyseed;
              new r5_1376: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(x_1379[@i_1385], r4_1361[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = injbot2(x_1379[@i_1385]) in
          let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
          event partTC(hostY_47, m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
            new rSK_1142: symkeyseed;
            let SK_50: key = kgen(rSK_1142) in
            new r10_1143: symseed;
            new tt_1144: timest;
            let e10: maxmac = encsym(concat5(SK_50, tt_1144, hostY_47), Mkey[j3], r10_1143) in
            new r11_1145: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1144, hostW_46), AK_49, r11_1145) in
            event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
            out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
            new rSK_1146: symkeyseed;
            let SK_50: key = kgen(rSK_1146) in
            new tt_1148: timest;
            new r10_1147: symseed;
            let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1147) in
            new r11_1149: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1148, hostW_46), AK_49, r11_1149) in
            event fullTC(hostY_47, hostW_46, n', m8, m9, z_1150, e11);
            out(c8[!_39], (hostY_47, z_1150, e11, acceptT(hostY_47, hostW_46)))
        orfind @i_1384 <= N suchthat defined(x_1382[@i_1384], r4_1373[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = injbot2(x_1382[@i_1384]) in
          let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
          event partTC(hostY_47, m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
            new rSK_1142: symkeyseed;
            let SK_50: key = kgen(rSK_1142) in
            new r10_1143: symseed;
            new tt_1144: timest;
            let e10: maxmac = encsym(concat5(SK_50, tt_1144, hostY_47), Mkey[j3], r10_1143) in
            new r11_1145: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1144, hostW_46), AK_49, r11_1145) in
            event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
            out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
            new rSK_1146: symkeyseed;
            let SK_50: key = kgen(rSK_1146) in
            new tt_1148: timest;
            new r10_1147: symseed;
            let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1147) in
            new r11_1149: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1148, hostW_46), AK_49, r11_1149) in
            event fullTC(hostY_47, hostW_46, n', m8, m9, z_1150, e11);
            out(c8[!_39], (hostY_47, z_1150, e11, acceptT(hostY_47, hostW_46)))
        else
          let injbot2(concat5(AK_49: key, tk_48: timest, hostY_47: client)) = bottom in
          let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
          event partTC(hostY_47, m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
            new rSK_1142: symkeyseed;
            let SK_50: key = kgen(rSK_1142) in
            new r10_1143: symseed;
            new tt_1144: timest;
            let e10: maxmac = encsym(concat5(SK_50, tt_1144, hostY_47), Mkey[j3], r10_1143) in
            new r11_1145: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1144, hostW_46), AK_49, r11_1145) in
            event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
            out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
            new rSK_1146: symkeyseed;
            let SK_50: key = kgen(rSK_1146) in
            new tt_1148: timest;
            new r10_1147: symseed;
            let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1147) in
            new r11_1149: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1148, hostW_46), AK_49, r11_1149) in
            event fullTC(hostY_47, hostW_46, n', m8, m9, z_1150, e11);
            out(c8[!_39], (hostY_47, z_1150, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying simplify yields

Game 77 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
new rKt: symkeyseed;
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(AK_54[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_549: symseed;
            new tc_550: timest;
            let e5: maxmac = encsym(pad(C, tc_550), AK_54[@i_184], r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_184]) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_552: symseed;
            new tc'_553: timest;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_310: symseed;
            new tc_309: timest;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_313: symseed;
            new tc'_312: timest;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_54: key = kgen(s3_1354) in
              new r4_1355: symseed;
              new tk_1356: timest;
              let TGT_56: maxmac = encsym(concat5(AK_54, tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new s_1357: symkeyseed;
              new r5_1358: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_54: key = kgen(s3_1360) in
              new r4_1361: symseed;
              new tk_1362: timest;
              let x_1379: maxenc = concat5(AK_54, tk_1362, hostY_53) in
              let z_1378: maxmac = encsym(x_1379, kgen2(rKt), r4_1361) in
              let TGT_56: maxmac = z_1378 in
              new s_1363: symkeyseed;
              new r5_1364: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_54: key = kgen(s3_1366) in
              new r4_1367: symseed;
              new tk_1368: timest;
              let TGT_56: maxmac = encsym(concat5(AK_54, tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new s_1369: symkeyseed;
              new r5_1370: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_54: key = kgen(s3_1372) in
              new r4_1373: symseed;
              new tk_1374: timest;
              let x_1382: maxenc = concat5(AK_54, tk_1374, hostY_53) in
              let z_1381: maxmac = encsym(x_1382, kgen2(rKt), r4_1373) in
              let TGT_56: maxmac = z_1381 in
              new s_1375: symkeyseed;
              new r5_1376: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(hostY_53[@i_1385], tk_1362[@i_1385], AK_54[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let AK_49: key = AK_54[@i_1385] in
          let tk_48: timest = tk_1362[@i_1385] in
          let hostY_47: client = hostY_53[@i_1385] in
          let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
          event partTC(hostY_47, m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
            new rSK_1142: symkeyseed;
            let SK_50: key = kgen(rSK_1142) in
            new r10_1143: symseed;
            new tt_1144: timest;
            let e10: maxmac = encsym(concat5(SK_50, tt_1144, hostY_47), Mkey[j3], r10_1143) in
            new r11_1145: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1144, hostW_46), AK_49, r11_1145) in
            event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
            out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
            new rSK_1146: symkeyseed;
            let SK_50: key = kgen(rSK_1146) in
            new tt_1148: timest;
            new r10_1147: symseed;
            let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1147) in
            new r11_1149: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1148, hostW_46), AK_49, r11_1149) in
            event fullTC(hostY_47, hostW_46, n', m8, m9, z_1150, e11);
            out(c8[!_39], (hostY_47, z_1150, e11, acceptT(hostY_47, hostW_46)))
        orfind @i_1384 <= N suchthat defined(hostY_53[@i_1384], tk_1374[@i_1384], AK_54[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let AK_49: key = AK_54[@i_1384] in
          let tk_48: timest = tk_1374[@i_1384] in
          let hostY_47: client = hostY_53[@i_1384] in
          let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
          event partTC(hostY_47, m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
            new rSK_1142: symkeyseed;
            let SK_50: key = kgen(rSK_1142) in
            new r10_1143: symseed;
            new tt_1144: timest;
            let e10: maxmac = encsym(concat5(SK_50, tt_1144, hostY_47), Mkey[j3], r10_1143) in
            new r11_1145: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1144, hostW_46), AK_49, r11_1145) in
            event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
            out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
            new rSK_1146: symkeyseed;
            let SK_50: key = kgen(rSK_1146) in
            new tt_1148: timest;
            new r10_1147: symseed;
            let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1147) in
            new r11_1149: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1148, hostW_46), AK_49, r11_1149) in
            event fullTC(hostY_47, hostW_46, n', m8, m9, z_1150, e11);
            out(c8[!_39], (hostY_47, z_1150, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying move new all binders yields

Game 78 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKs: symkeyseed;
new rKt: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(AK_54[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_550: timest;
            new r7_549: symseed;
            let e5: maxmac = encsym(pad(C, tc_550), AK_54[@i_184], r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_184]) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_553: timest;
            new r2_552: symseed;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_309: timest;
            new r7_310: symseed;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_312: timest;
            new r2_313: symseed;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_54: key = kgen(s3_1354) in
              new tk_1356: timest;
              new r4_1355: symseed;
              let TGT_56: maxmac = encsym(concat5(AK_54, tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new r5_1358: symseed;
              new s_1357: symkeyseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_54: key = kgen(s3_1360) in
              new tk_1362: timest;
              let x_1379: maxenc = concat5(AK_54, tk_1362, hostY_53) in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym(x_1379, kgen2(rKt), r4_1361) in
              let TGT_56: maxmac = z_1378 in
              new r5_1364: symseed;
              new s_1363: symkeyseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_54: key = kgen(s3_1366) in
              new tk_1368: timest;
              new r4_1367: symseed;
              let TGT_56: maxmac = encsym(concat5(AK_54, tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new r5_1370: symseed;
              new s_1369: symkeyseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_54: key = kgen(s3_1372) in
              new tk_1374: timest;
              let x_1382: maxenc = concat5(AK_54, tk_1374, hostY_53) in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym(x_1382, kgen2(rKt), r4_1373) in
              let TGT_56: maxmac = z_1381 in
              new r5_1376: symseed;
              new s_1375: symkeyseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(hostY_53[@i_1385], tk_1362[@i_1385], AK_54[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let AK_49: key = AK_54[@i_1385] in
          let tk_48: timest = tk_1362[@i_1385] in
          let hostY_47: client = hostY_53[@i_1385] in
          let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
          event partTC(hostY_47, m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
            new rSK_1142: symkeyseed;
            let SK_50: key = kgen(rSK_1142) in
            new tt_1144: timest;
            new r10_1143: symseed;
            let e10: maxmac = encsym(concat5(SK_50, tt_1144, hostY_47), Mkey[j3], r10_1143) in
            new r11_1145: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1144, hostW_46), AK_49, r11_1145) in
            event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
            out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
            new rSK_1146: symkeyseed;
            let SK_50: key = kgen(rSK_1146) in
            new r10_1147: symseed;
            let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1147) in
            new r11_1149: symseed;
            new tt_1148: timest;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1148, hostW_46), AK_49, r11_1149) in
            event fullTC(hostY_47, hostW_46, n', m8, m9, z_1150, e11);
            out(c8[!_39], (hostY_47, z_1150, e11, acceptT(hostY_47, hostW_46)))
        orfind @i_1384 <= N suchthat defined(hostY_53[@i_1384], tk_1374[@i_1384], AK_54[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let AK_49: key = AK_54[@i_1384] in
          let tk_48: timest = tk_1374[@i_1384] in
          let hostY_47: client = hostY_53[@i_1384] in
          let injbot2(pad(=hostY_47, ts: timest)) = decsym(m9, AK_49) in
          event partTC(hostY_47, m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
            new rSK_1142: symkeyseed;
            let SK_50: key = kgen(rSK_1142) in
            new tt_1144: timest;
            new r10_1143: symseed;
            let e10: maxmac = encsym(concat5(SK_50, tt_1144, hostY_47), Mkey[j3], r10_1143) in
            new r11_1145: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1144, hostW_46), AK_49, r11_1145) in
            event fullTC(hostY_47, hostW_46, n', m8, m9, e10, e11);
            out(c8[!_39], (hostY_47, e10, e11, acceptT(hostY_47, hostW_46)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
            new rSK_1146: symkeyseed;
            let SK_50: key = kgen(rSK_1146) in
            new r10_1147: symseed;
            let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1147) in
            new r11_1149: symseed;
            new tt_1148: timest;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1148, hostW_46), AK_49, r11_1149) in
            event fullTC(hostY_47, hostW_46, n', m8, m9, z_1150, e11);
            out(c8[!_39], (hostY_47, z_1150, e11, acceptT(hostY_47, hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying remove assignments of useless yields

Game 79 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKs: symkeyseed;
new rKt: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(AK_54[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_550: timest;
            new r7_549: symseed;
            let e5: maxmac = encsym(pad(C, tc_550), AK_54[@i_184], r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_184]) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_553: timest;
            new r2_552: symseed;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_309: timest;
            new r7_310: symseed;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_312: timest;
            new r2_313: symseed;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_54: key = kgen(s3_1354) in
              new tk_1356: timest;
              new r4_1355: symseed;
              let TGT_56: maxmac = encsym(concat5(AK_54, tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new r5_1358: symseed;
              new s_1357: symkeyseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_54: key = kgen(s3_1360) in
              new tk_1362: timest;
              let x_1379: maxenc = concat5(AK_54, tk_1362, hostY_53) in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym(x_1379, kgen2(rKt), r4_1361) in
              new r5_1364: symseed;
              new s_1363: symkeyseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_54: key = kgen(s3_1366) in
              new tk_1368: timest;
              new r4_1367: symseed;
              let TGT_56: maxmac = encsym(concat5(AK_54, tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new r5_1370: symseed;
              new s_1369: symkeyseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_54: key = kgen(s3_1372) in
              new tk_1374: timest;
              let x_1382: maxenc = concat5(AK_54, tk_1374, hostY_53) in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym(x_1382, kgen2(rKt), r4_1373) in
              new r5_1376: symseed;
              new s_1375: symkeyseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(hostY_53[@i_1385], tk_1362[@i_1385], AK_54[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          let injbot2(pad(=hostY_53[@i_1385], ts: timest)) = decsym(m9, AK_54[@i_1385]) in
          event partTC(hostY_53[@i_1385], m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
            new rSK_1419: symkeyseed;
            let SK_50: key = kgen(rSK_1419) in
            new tt_1420: timest;
            new r10_1421: symseed;
            let e10: maxmac = encsym(concat5(SK_50, tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
            new r11_1422: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1420, hostW_46), AK_54[@i_1385], r11_1422) in
            event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, e11);
            out(c8[!_39], (hostY_53[@i_1385], e10, e11, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
            new rSK_1423: symkeyseed;
            let SK_50: key = kgen(rSK_1423) in
            new r10_1424: symseed;
            let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
            new r11_1425: symseed;
            new tt_1426: timest;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1426, hostW_46), AK_54[@i_1385], r11_1425) in
            event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, e11);
            out(c8[!_39], (hostY_53[@i_1385], z_1150, e11, acceptT(hostY_53[@i_1385], hostW_46)))
        orfind @i_1384 <= N suchthat defined(hostY_53[@i_1384], tk_1374[@i_1384], AK_54[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          let injbot2(pad(=hostY_53[@i_1384], ts: timest)) = decsym(m9, AK_54[@i_1384]) in
          event partTC(hostY_53[@i_1384], m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
            new rSK_1427: symkeyseed;
            let SK_50: key = kgen(rSK_1427) in
            new tt_1428: timest;
            new r10_1429: symseed;
            let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
            new r11_1430: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1428, hostW_46), AK_54[@i_1384], r11_1430) in
            event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, e11);
            out(c8[!_39], (hostY_53[@i_1384], e10, e11, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
            new rSK_1431: symkeyseed;
            let SK_50: key = kgen(rSK_1431) in
            new r10_1432: symseed;
            let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
            new r11_1433: symseed;
            new tt_1434: timest;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1434, hostW_46), AK_54[@i_1384], r11_1433) in
            event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, e11);
            out(c8[!_39], (hostY_53[@i_1384], z_1150, e11, acceptT(hostY_53[@i_1384], hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying equivalence
equiv ! !_15 <= N2 new r: symkeyseed; ! !_16 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen2(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_17 <= N2 new r: symkeyseed; ! !_18 <= N new r2: symseed; (x: maxenc) -> encsym2(Z2(x), kgen2(r), r2)
 [Difference of probability Penc(time + time(context for game 79), N)] yields

Game 80 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKs: symkeyseed;
new rKt: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(AK_54[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_550: timest;
            new r7_549: symseed;
            let e5: maxmac = encsym(pad(C, tc_550), AK_54[@i_184], r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_184]) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_553: timest;
            new r2_552: symseed;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_309: timest;
            new r7_310: symseed;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_312: timest;
            new r2_313: symseed;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_54: key = kgen(s3_1354) in
              new tk_1356: timest;
              new r4_1355: symseed;
              let TGT_56: maxmac = encsym(concat5(AK_54, tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new r5_1358: symseed;
              new s_1357: symkeyseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_54: key = kgen(s3_1360) in
              new tk_1362: timest;
              let x_1379: maxenc = concat5(AK_54, tk_1362, hostY_53) in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Z2(x_1379), kgen2(rKt), r4_1361) in
              new r5_1364: symseed;
              new s_1363: symkeyseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_54: key = kgen(s3_1366) in
              new tk_1368: timest;
              new r4_1367: symseed;
              let TGT_56: maxmac = encsym(concat5(AK_54, tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new r5_1370: symseed;
              new s_1369: symkeyseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_54: key = kgen(s3_1372) in
              new tk_1374: timest;
              let x_1382: maxenc = concat5(AK_54, tk_1374, hostY_53) in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Z2(x_1382), kgen2(rKt), r4_1373) in
              new r5_1376: symseed;
              new s_1375: symkeyseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(hostY_53[@i_1385], tk_1362[@i_1385], AK_54[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          let injbot2(pad(=hostY_53[@i_1385], ts: timest)) = decsym(m9, AK_54[@i_1385]) in
          event partTC(hostY_53[@i_1385], m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
            new rSK_1419: symkeyseed;
            let SK_50: key = kgen(rSK_1419) in
            new tt_1420: timest;
            new r10_1421: symseed;
            let e10: maxmac = encsym(concat5(SK_50, tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
            new r11_1422: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1420, hostW_46), AK_54[@i_1385], r11_1422) in
            event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, e11);
            out(c8[!_39], (hostY_53[@i_1385], e10, e11, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
            new rSK_1423: symkeyseed;
            let SK_50: key = kgen(rSK_1423) in
            new r10_1424: symseed;
            let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
            new r11_1425: symseed;
            new tt_1426: timest;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1426, hostW_46), AK_54[@i_1385], r11_1425) in
            event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, e11);
            out(c8[!_39], (hostY_53[@i_1385], z_1150, e11, acceptT(hostY_53[@i_1385], hostW_46)))
        orfind @i_1384 <= N suchthat defined(hostY_53[@i_1384], tk_1374[@i_1384], AK_54[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          let injbot2(pad(=hostY_53[@i_1384], ts: timest)) = decsym(m9, AK_54[@i_1384]) in
          event partTC(hostY_53[@i_1384], m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
            new rSK_1427: symkeyseed;
            let SK_50: key = kgen(rSK_1427) in
            new tt_1428: timest;
            new r10_1429: symseed;
            let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
            new r11_1430: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1428, hostW_46), AK_54[@i_1384], r11_1430) in
            event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, e11);
            out(c8[!_39], (hostY_53[@i_1384], e10, e11, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
            new rSK_1431: symkeyseed;
            let SK_50: key = kgen(rSK_1431) in
            new r10_1432: symseed;
            let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
            new r11_1433: symseed;
            new tt_1434: timest;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1434, hostW_46), AK_54[@i_1384], r11_1433) in
            event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, e11);
            out(c8[!_39], (hostY_53[@i_1384], z_1150, e11, acceptT(hostY_53[@i_1384], hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying simplify yields

Game 81 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKs: symkeyseed;
new rKt: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(AK_54[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_550: timest;
            new r7_549: symseed;
            let e5: maxmac = encsym(pad(C, tc_550), AK_54[@i_184], r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_184]) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_553: timest;
            new r2_552: symseed;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_309: timest;
            new r7_310: symseed;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_312: timest;
            new r2_313: symseed;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_54: key = kgen(s3_1354) in
              new tk_1356: timest;
              new r4_1355: symseed;
              let TGT_56: maxmac = encsym(concat5(AK_54, tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new r5_1358: symseed;
              new s_1357: symkeyseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_54: key = kgen(s3_1360) in
              new tk_1362: timest;
              let x_1379: maxenc = concat5(AK_54, tk_1362, hostY_53) in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new r5_1364: symseed;
              new s_1363: symkeyseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_54: key = kgen(s3_1366) in
              new tk_1368: timest;
              new r4_1367: symseed;
              let TGT_56: maxmac = encsym(concat5(AK_54, tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new r5_1370: symseed;
              new s_1369: symkeyseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_54: key = kgen(s3_1372) in
              new tk_1374: timest;
              let x_1382: maxenc = concat5(AK_54, tk_1374, hostY_53) in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new r5_1376: symseed;
              new s_1375: symkeyseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(AK_54[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          let injbot2(pad(=hostY_53[@i_1385], ts: timest)) = decsym(m9, AK_54[@i_1385]) in
          event partTC(hostY_53[@i_1385], m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
            new rSK_1419: symkeyseed;
            let SK_50: key = kgen(rSK_1419) in
            new tt_1420: timest;
            new r10_1421: symseed;
            let e10: maxmac = encsym(concat5(SK_50, tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
            new r11_1422: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1420, hostW_46), AK_54[@i_1385], r11_1422) in
            event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, e11);
            out(c8[!_39], (hostY_53[@i_1385], e10, e11, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
            new rSK_1423: symkeyseed;
            let SK_50: key = kgen(rSK_1423) in
            new r10_1424: symseed;
            let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
            new r11_1425: symseed;
            new tt_1426: timest;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1426, hostW_46), AK_54[@i_1385], r11_1425) in
            event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, e11);
            out(c8[!_39], (hostY_53[@i_1385], z_1150, e11, acceptT(hostY_53[@i_1385], hostW_46)))
        orfind @i_1384 <= N suchthat defined(AK_54[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          let injbot2(pad(=hostY_53[@i_1384], ts: timest)) = decsym(m9, AK_54[@i_1384]) in
          event partTC(hostY_53[@i_1384], m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
            new rSK_1427: symkeyseed;
            let SK_50: key = kgen(rSK_1427) in
            new tt_1428: timest;
            new r10_1429: symseed;
            let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
            new r11_1430: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1428, hostW_46), AK_54[@i_1384], r11_1430) in
            event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, e11);
            out(c8[!_39], (hostY_53[@i_1384], e10, e11, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
            new rSK_1431: symkeyseed;
            let SK_50: key = kgen(rSK_1431) in
            new r10_1432: symseed;
            let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
            new r11_1433: symseed;
            new tt_1434: timest;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1434, hostW_46), AK_54[@i_1384], r11_1433) in
            event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, e11);
            out(c8[!_39], (hostY_53[@i_1384], z_1150, e11, acceptT(hostY_53[@i_1384], hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying move new all binders yields

Game 82 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKt: symkeyseed;
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(AK_54[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_549: symseed;
            new tc_550: timest;
            let e5: maxmac = encsym(pad(C, tc_550), AK_54[@i_184], r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_184]) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_552: symseed;
            new tc'_553: timest;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_310: symseed;
            new tc_309: timest;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_313: symseed;
            new tc'_312: timest;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_54: key = kgen(s3_1354) in
              new r4_1355: symseed;
              new tk_1356: timest;
              let TGT_56: maxmac = encsym(concat5(AK_54, tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new s_1357: symkeyseed;
              new r5_1358: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_54: key = kgen(s3_1360) in
              new tk_1362: timest;
              let x_1379: maxenc = concat5(AK_54, tk_1362, hostY_53) in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new s_1363: symkeyseed;
              new r5_1364: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_54: key = kgen(s3_1366) in
              new r4_1367: symseed;
              new tk_1368: timest;
              let TGT_56: maxmac = encsym(concat5(AK_54, tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new s_1369: symkeyseed;
              new r5_1370: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_54: key = kgen(s3_1372) in
              new tk_1374: timest;
              let x_1382: maxenc = concat5(AK_54, tk_1374, hostY_53) in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new s_1375: symkeyseed;
              new r5_1376: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(AK_54[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          let injbot2(pad(=hostY_53[@i_1385], ts: timest)) = decsym(m9, AK_54[@i_1385]) in
          event partTC(hostY_53[@i_1385], m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
            new rSK_1419: symkeyseed;
            let SK_50: key = kgen(rSK_1419) in
            new r10_1421: symseed;
            new tt_1420: timest;
            let e10: maxmac = encsym(concat5(SK_50, tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
            new r11_1422: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1420, hostW_46), AK_54[@i_1385], r11_1422) in
            event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, e11);
            out(c8[!_39], (hostY_53[@i_1385], e10, e11, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
            new rSK_1423: symkeyseed;
            let SK_50: key = kgen(rSK_1423) in
            new r10_1424: symseed;
            let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
            new tt_1426: timest;
            new r11_1425: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1426, hostW_46), AK_54[@i_1385], r11_1425) in
            event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, e11);
            out(c8[!_39], (hostY_53[@i_1385], z_1150, e11, acceptT(hostY_53[@i_1385], hostW_46)))
        orfind @i_1384 <= N suchthat defined(AK_54[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          let injbot2(pad(=hostY_53[@i_1384], ts: timest)) = decsym(m9, AK_54[@i_1384]) in
          event partTC(hostY_53[@i_1384], m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
            new rSK_1427: symkeyseed;
            let SK_50: key = kgen(rSK_1427) in
            new r10_1429: symseed;
            new tt_1428: timest;
            let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
            new r11_1430: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1428, hostW_46), AK_54[@i_1384], r11_1430) in
            event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, e11);
            out(c8[!_39], (hostY_53[@i_1384], e10, e11, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
            new rSK_1431: symkeyseed;
            let SK_50: key = kgen(rSK_1431) in
            new r10_1432: symseed;
            let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
            new tt_1434: timest;
            new r11_1433: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1434, hostW_46), AK_54[@i_1384], r11_1433) in
            event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, e11);
            out(c8[!_39], (hostY_53[@i_1384], z_1150, e11, acceptT(hostY_53[@i_1384], hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying remove assignments of useless yields

Game 83 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKt: symkeyseed;
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(AK_54[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_549: symseed;
            new tc_550: timest;
            let e5: maxmac = encsym(pad(C, tc_550), AK_54[@i_184], r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_184]) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_552: symseed;
            new tc'_553: timest;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_310: symseed;
            new tc_309: timest;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_313: symseed;
            new tc'_312: timest;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_54: key = kgen(s3_1354) in
              new r4_1355: symseed;
              new tk_1356: timest;
              let TGT_56: maxmac = encsym(concat5(AK_54, tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new s_1357: symkeyseed;
              new r5_1358: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_54: key = kgen(s3_1360) in
              new tk_1362: timest;
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new s_1363: symkeyseed;
              new r5_1364: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_54: key = kgen(s3_1366) in
              new r4_1367: symseed;
              new tk_1368: timest;
              let TGT_56: maxmac = encsym(concat5(AK_54, tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new s_1369: symkeyseed;
              new r5_1370: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_54: key = kgen(s3_1372) in
              new tk_1374: timest;
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new s_1375: symkeyseed;
              new r5_1376: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(AK_54[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          let injbot2(pad(=hostY_53[@i_1385], ts: timest)) = decsym(m9, AK_54[@i_1385]) in
          event partTC(hostY_53[@i_1385], m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
            new rSK_1419: symkeyseed;
            let SK_50: key = kgen(rSK_1419) in
            new r10_1421: symseed;
            new tt_1420: timest;
            let e10: maxmac = encsym(concat5(SK_50, tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
            new r11_1422: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1420, hostW_46), AK_54[@i_1385], r11_1422) in
            event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, e11);
            out(c8[!_39], (hostY_53[@i_1385], e10, e11, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
            new rSK_1423: symkeyseed;
            let SK_50: key = kgen(rSK_1423) in
            new r10_1424: symseed;
            let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
            new tt_1426: timest;
            new r11_1425: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1426, hostW_46), AK_54[@i_1385], r11_1425) in
            event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, e11);
            out(c8[!_39], (hostY_53[@i_1385], z_1150, e11, acceptT(hostY_53[@i_1385], hostW_46)))
        orfind @i_1384 <= N suchthat defined(AK_54[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          let injbot2(pad(=hostY_53[@i_1384], ts: timest)) = decsym(m9, AK_54[@i_1384]) in
          event partTC(hostY_53[@i_1384], m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
            new rSK_1427: symkeyseed;
            let SK_50: key = kgen(rSK_1427) in
            new r10_1429: symseed;
            new tt_1428: timest;
            let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
            new r11_1430: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1428, hostW_46), AK_54[@i_1384], r11_1430) in
            event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, e11);
            out(c8[!_39], (hostY_53[@i_1384], e10, e11, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
            new rSK_1431: symkeyseed;
            let SK_50: key = kgen(rSK_1431) in
            new r10_1432: symseed;
            let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
            new tt_1434: timest;
            new r11_1433: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1434, hostW_46), AK_54[@i_1384], r11_1433) in
            event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, e11);
            out(c8[!_39], (hostY_53[@i_1384], z_1150, e11, acceptT(hostY_53[@i_1384], hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying remove assignments of binder AK_54 yields

Game 84 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKt: symkeyseed;
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(AK_54[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_549: symseed;
            new tc_550: timest;
            let e5: maxmac = encsym(pad(C, tc_550), AK_54[@i_184], r7_549) in
            event partCT(hostT, TGT_58, e5);
            new n3_551: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_184]) in
            event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_552: symseed;
            new tc'_553: timest;
            let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(AK_54[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(AK_54[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_310: symseed;
            new tc_309: timest;
            let e5: maxmac = encsym(pad(C, tc_309), AK_54[@i_183], r7_310) in
            event partCT(hostT, TGT_58, e5);
            new n3_311: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_54[@i_183]) in
            event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_313: symseed;
            new tc'_312: timest;
            let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_54: key = kgen(s3_1354) in
              new r4_1355: symseed;
              new tk_1356: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new s_1357: symkeyseed;
              new r5_1358: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_54: key = kgen(s3_1360) in
              new tk_1362: timest;
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new s_1363: symkeyseed;
              new r5_1364: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_54: key = kgen(s3_1366) in
              new r4_1367: symseed;
              new tk_1368: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new s_1369: symkeyseed;
              new r5_1370: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_54: key = kgen(s3_1372) in
              new tk_1374: timest;
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new s_1375: symkeyseed;
              new r5_1376: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(AK_54[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          let injbot2(pad(=hostY_53[@i_1385], ts: timest)) = decsym(m9, AK_54[@i_1385]) in
          event partTC(hostY_53[@i_1385], m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
            new rSK_1419: symkeyseed;
            let SK_50: key = kgen(rSK_1419) in
            new r10_1421: symseed;
            new tt_1420: timest;
            let e10: maxmac = encsym(concat5(SK_50, tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
            new r11_1422: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1420, hostW_46), AK_54[@i_1385], r11_1422) in
            event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, e11);
            out(c8[!_39], (hostY_53[@i_1385], e10, e11, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
            new rSK_1423: symkeyseed;
            let SK_50: key = kgen(rSK_1423) in
            new r10_1424: symseed;
            let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
            new tt_1426: timest;
            new r11_1425: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1426, hostW_46), AK_54[@i_1385], r11_1425) in
            event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, e11);
            out(c8[!_39], (hostY_53[@i_1385], z_1150, e11, acceptT(hostY_53[@i_1385], hostW_46)))
        orfind @i_1384 <= N suchthat defined(AK_54[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          let injbot2(pad(=hostY_53[@i_1384], ts: timest)) = decsym(m9, AK_54[@i_1384]) in
          event partTC(hostY_53[@i_1384], m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
            new rSK_1427: symkeyseed;
            let SK_50: key = kgen(rSK_1427) in
            new r10_1429: symseed;
            new tt_1428: timest;
            let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
            new r11_1430: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1428, hostW_46), AK_54[@i_1384], r11_1430) in
            event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, e11);
            out(c8[!_39], (hostY_53[@i_1384], e10, e11, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
            new rSK_1431: symkeyseed;
            let SK_50: key = kgen(rSK_1431) in
            new r10_1432: symseed;
            let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
            new tt_1434: timest;
            new r11_1433: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1434, hostW_46), AK_54[@i_1384], r11_1433) in
            event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, e11);
            out(c8[!_39], (hostY_53[@i_1384], z_1150, e11, acceptT(hostY_53[@i_1384], hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying SA rename AK_54 yields

Game 85 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKt: symkeyseed;
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
              find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_549: symseed;
                    new tc_550: timest;
                    let e5: maxmac = encsym(pad(C, tc_550), AK_2839[@i_184], r7_549) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_551: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_552: symseed;
                    new tc'_553: timest;
                    let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_549: symseed;
                    new tc_550: timest;
                    let e5: maxmac = encsym(pad(C, tc_550), AK_2840[@i_184], r7_549) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_551: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_552: symseed;
                    new tc'_553: timest;
                    let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_549: symseed;
                    new tc_550: timest;
                    let e5: maxmac = encsym(pad(C, tc_550), AK_2839[@i_184], r7_549) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_551: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_552: symseed;
                    new tc'_553: timest;
                    let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_549: symseed;
                    new tc_550: timest;
                    let e5: maxmac = encsym(pad(C, tc_550), AK_2840[@i_184], r7_549) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_551: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_552: symseed;
                    new tc'_553: timest;
                    let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_549: symseed;
                    new tc_550: timest;
                    let e5: maxmac = encsym(pad(C, tc_550), AK_2839[@i_184], r7_549) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_551: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_552: symseed;
                    new tc'_553: timest;
                    let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_549: symseed;
                    new tc_550: timest;
                    let e5: maxmac = encsym(pad(C, tc_550), AK_2840[@i_184], r7_549) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_551: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_552: symseed;
                    new tc'_553: timest;
                    let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_549: symseed;
                    new tc_550: timest;
                    let e5: maxmac = encsym(pad(C, tc_550), AK_2839[@i_184], r7_549) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_551: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_552: symseed;
                    new tc'_553: timest;
                    let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_549: symseed;
                    new tc_550: timest;
                    let e5: maxmac = encsym(pad(C, tc_550), AK_2840[@i_184], r7_549) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_551: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_552: symseed;
                    new tc'_553: timest;
                    let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
              find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_549: symseed;
                    new tc_550: timest;
                    let e5: maxmac = encsym(pad(C, tc_550), AK_2839[@i_184], r7_549) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_551: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_552: symseed;
                    new tc'_553: timest;
                    let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_549: symseed;
                    new tc_550: timest;
                    let e5: maxmac = encsym(pad(C, tc_550), AK_2840[@i_184], r7_549) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_551: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_552: symseed;
                    new tc'_553: timest;
                    let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_549: symseed;
                    new tc_550: timest;
                    let e5: maxmac = encsym(pad(C, tc_550), AK_2839[@i_184], r7_549) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_551: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_552: symseed;
                    new tc'_553: timest;
                    let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_549: symseed;
                    new tc_550: timest;
                    let e5: maxmac = encsym(pad(C, tc_550), AK_2840[@i_184], r7_549) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_551: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_552: symseed;
                    new tc'_553: timest;
                    let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_549: symseed;
                    new tc_550: timest;
                    let e5: maxmac = encsym(pad(C, tc_550), AK_2839[@i_184], r7_549) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_551: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_552: symseed;
                    new tc'_553: timest;
                    let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_549: symseed;
                    new tc_550: timest;
                    let e5: maxmac = encsym(pad(C, tc_550), AK_2840[@i_184], r7_549) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_551: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_552: symseed;
                    new tc'_553: timest;
                    let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_549: symseed;
                    new tc_550: timest;
                    let e5: maxmac = encsym(pad(C, tc_550), AK_2839[@i_184], r7_549) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_551: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_552: symseed;
                    new tc'_553: timest;
                    let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_549: symseed;
                    new tc_550: timest;
                    let e5: maxmac = encsym(pad(C, tc_550), AK_2840[@i_184], r7_549) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_551: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_552: symseed;
                    new tc'_553: timest;
                    let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
              find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_549: symseed;
                    new tc_550: timest;
                    let e5: maxmac = encsym(pad(C, tc_550), AK_2839[@i_184], r7_549) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_551: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_552: symseed;
                    new tc'_553: timest;
                    let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_549: symseed;
                    new tc_550: timest;
                    let e5: maxmac = encsym(pad(C, tc_550), AK_2840[@i_184], r7_549) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_551: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_552: symseed;
                    new tc'_553: timest;
                    let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_549: symseed;
                    new tc_550: timest;
                    let e5: maxmac = encsym(pad(C, tc_550), AK_2839[@i_184], r7_549) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_551: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_552: symseed;
                    new tc'_553: timest;
                    let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_549: symseed;
                    new tc_550: timest;
                    let e5: maxmac = encsym(pad(C, tc_550), AK_2840[@i_184], r7_549) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_551: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_552: symseed;
                    new tc'_553: timest;
                    let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_549: symseed;
                    new tc_550: timest;
                    let e5: maxmac = encsym(pad(C, tc_550), AK_2839[@i_184], r7_549) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_551: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_552: symseed;
                    new tc'_553: timest;
                    let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_549: symseed;
                    new tc_550: timest;
                    let e5: maxmac = encsym(pad(C, tc_550), AK_2840[@i_184], r7_549) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_551: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_552: symseed;
                    new tc'_553: timest;
                    let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_549: symseed;
                    new tc_550: timest;
                    let e5: maxmac = encsym(pad(C, tc_550), AK_2839[@i_184], r7_549) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_551: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_552: symseed;
                    new tc'_553: timest;
                    let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_549: symseed;
                    new tc_550: timest;
                    let e5: maxmac = encsym(pad(C, tc_550), AK_2840[@i_184], r7_549) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_551: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_552: symseed;
                    new tc'_553: timest;
                    let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
              find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_549: symseed;
                    new tc_550: timest;
                    let e5: maxmac = encsym(pad(C, tc_550), AK_2839[@i_184], r7_549) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_551: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_552: symseed;
                    new tc'_553: timest;
                    let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_549: symseed;
                    new tc_550: timest;
                    let e5: maxmac = encsym(pad(C, tc_550), AK_2840[@i_184], r7_549) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_551: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_552: symseed;
                    new tc'_553: timest;
                    let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_549: symseed;
                    new tc_550: timest;
                    let e5: maxmac = encsym(pad(C, tc_550), AK_2839[@i_184], r7_549) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_551: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_552: symseed;
                    new tc'_553: timest;
                    let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_549: symseed;
                    new tc_550: timest;
                    let e5: maxmac = encsym(pad(C, tc_550), AK_2840[@i_184], r7_549) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_551: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_552: symseed;
                    new tc'_553: timest;
                    let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_549: symseed;
                    new tc_550: timest;
                    let e5: maxmac = encsym(pad(C, tc_550), AK_2839[@i_184], r7_549) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_551: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_552: symseed;
                    new tc'_553: timest;
                    let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_549: symseed;
                    new tc_550: timest;
                    let e5: maxmac = encsym(pad(C, tc_550), AK_2840[@i_184], r7_549) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_551: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_552: symseed;
                    new tc'_553: timest;
                    let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_549: symseed;
                    new tc_550: timest;
                    let e5: maxmac = encsym(pad(C, tc_550), AK_2839[@i_184], r7_549) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_551: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_552: symseed;
                    new tc'_553: timest;
                    let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_549: symseed;
                    new tc_550: timest;
                    let e5: maxmac = encsym(pad(C, tc_550), AK_2840[@i_184], r7_549) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_551: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_551));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_551, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_551, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_552: symseed;
                    new tc'_553: timest;
                    let e12: maxmac = encsym(pad(C, tc'_553), SK_63, r2_552) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_553)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            find  suchthat defined(AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
              find  suchthat defined(AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_310: symseed;
                    new tc_309: timest;
                    let e5: maxmac = encsym(pad(C, tc_309), AK_2841[@i_183], r7_310) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_311: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_2841[@i_183]) in
                    event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_313: symseed;
                    new tc'_312: timest;
                    let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_310: symseed;
                    new tc_309: timest;
                    let e5: maxmac = encsym(pad(C, tc_309), AK_2842[@i_183], r7_310) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_311: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_2842[@i_183]) in
                    event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_313: symseed;
                    new tc'_312: timest;
                    let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_310: symseed;
                    new tc_309: timest;
                    let e5: maxmac = encsym(pad(C, tc_309), AK_2841[@i_183], r7_310) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_311: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_2841[@i_183]) in
                    event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_313: symseed;
                    new tc'_312: timest;
                    let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_310: symseed;
                    new tc_309: timest;
                    let e5: maxmac = encsym(pad(C, tc_309), AK_2842[@i_183], r7_310) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_311: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_2842[@i_183]) in
                    event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_313: symseed;
                    new tc'_312: timest;
                    let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_310: symseed;
                    new tc_309: timest;
                    let e5: maxmac = encsym(pad(C, tc_309), AK_2841[@i_183], r7_310) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_311: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_2841[@i_183]) in
                    event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_313: symseed;
                    new tc'_312: timest;
                    let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_310: symseed;
                    new tc_309: timest;
                    let e5: maxmac = encsym(pad(C, tc_309), AK_2842[@i_183], r7_310) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_311: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_2842[@i_183]) in
                    event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_313: symseed;
                    new tc'_312: timest;
                    let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_310: symseed;
                    new tc_309: timest;
                    let e5: maxmac = encsym(pad(C, tc_309), AK_2841[@i_183], r7_310) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_311: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_2841[@i_183]) in
                    event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_313: symseed;
                    new tc'_312: timest;
                    let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_310: symseed;
                    new tc_309: timest;
                    let e5: maxmac = encsym(pad(C, tc_309), AK_2842[@i_183], r7_310) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_311: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_2842[@i_183]) in
                    event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_313: symseed;
                    new tc'_312: timest;
                    let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind  suchthat defined(AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
              find  suchthat defined(AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_310: symseed;
                    new tc_309: timest;
                    let e5: maxmac = encsym(pad(C, tc_309), AK_2841[@i_183], r7_310) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_311: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_2841[@i_183]) in
                    event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_313: symseed;
                    new tc'_312: timest;
                    let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_310: symseed;
                    new tc_309: timest;
                    let e5: maxmac = encsym(pad(C, tc_309), AK_2842[@i_183], r7_310) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_311: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_2842[@i_183]) in
                    event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_313: symseed;
                    new tc'_312: timest;
                    let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_310: symseed;
                    new tc_309: timest;
                    let e5: maxmac = encsym(pad(C, tc_309), AK_2841[@i_183], r7_310) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_311: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_2841[@i_183]) in
                    event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_313: symseed;
                    new tc'_312: timest;
                    let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_310: symseed;
                    new tc_309: timest;
                    let e5: maxmac = encsym(pad(C, tc_309), AK_2842[@i_183], r7_310) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_311: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_2842[@i_183]) in
                    event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_313: symseed;
                    new tc'_312: timest;
                    let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_310: symseed;
                    new tc_309: timest;
                    let e5: maxmac = encsym(pad(C, tc_309), AK_2841[@i_183], r7_310) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_311: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_2841[@i_183]) in
                    event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_313: symseed;
                    new tc'_312: timest;
                    let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_310: symseed;
                    new tc_309: timest;
                    let e5: maxmac = encsym(pad(C, tc_309), AK_2842[@i_183], r7_310) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_311: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_2842[@i_183]) in
                    event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_313: symseed;
                    new tc'_312: timest;
                    let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_310: symseed;
                    new tc_309: timest;
                    let e5: maxmac = encsym(pad(C, tc_309), AK_2841[@i_183], r7_310) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_311: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_2841[@i_183]) in
                    event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_313: symseed;
                    new tc'_312: timest;
                    let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_310: symseed;
                    new tc_309: timest;
                    let e5: maxmac = encsym(pad(C, tc_309), AK_2842[@i_183], r7_310) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_311: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_2842[@i_183]) in
                    event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_313: symseed;
                    new tc'_312: timest;
                    let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            find  suchthat defined(AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
              find  suchthat defined(AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_310: symseed;
                    new tc_309: timest;
                    let e5: maxmac = encsym(pad(C, tc_309), AK_2841[@i_183], r7_310) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_311: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_2841[@i_183]) in
                    event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_313: symseed;
                    new tc'_312: timest;
                    let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_310: symseed;
                    new tc_309: timest;
                    let e5: maxmac = encsym(pad(C, tc_309), AK_2842[@i_183], r7_310) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_311: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_2842[@i_183]) in
                    event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_313: symseed;
                    new tc'_312: timest;
                    let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_310: symseed;
                    new tc_309: timest;
                    let e5: maxmac = encsym(pad(C, tc_309), AK_2841[@i_183], r7_310) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_311: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_2841[@i_183]) in
                    event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_313: symseed;
                    new tc'_312: timest;
                    let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_310: symseed;
                    new tc_309: timest;
                    let e5: maxmac = encsym(pad(C, tc_309), AK_2842[@i_183], r7_310) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_311: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_2842[@i_183]) in
                    event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_313: symseed;
                    new tc'_312: timest;
                    let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_310: symseed;
                    new tc_309: timest;
                    let e5: maxmac = encsym(pad(C, tc_309), AK_2841[@i_183], r7_310) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_311: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_2841[@i_183]) in
                    event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_313: symseed;
                    new tc'_312: timest;
                    let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_310: symseed;
                    new tc_309: timest;
                    let e5: maxmac = encsym(pad(C, tc_309), AK_2842[@i_183], r7_310) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_311: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_2842[@i_183]) in
                    event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_313: symseed;
                    new tc'_312: timest;
                    let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_310: symseed;
                    new tc_309: timest;
                    let e5: maxmac = encsym(pad(C, tc_309), AK_2841[@i_183], r7_310) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_311: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_2841[@i_183]) in
                    event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_313: symseed;
                    new tc'_312: timest;
                    let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_310: symseed;
                    new tc_309: timest;
                    let e5: maxmac = encsym(pad(C, tc_309), AK_2842[@i_183], r7_310) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_311: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_2842[@i_183]) in
                    event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_313: symseed;
                    new tc'_312: timest;
                    let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind  suchthat defined(AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
              find  suchthat defined(AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_310: symseed;
                    new tc_309: timest;
                    let e5: maxmac = encsym(pad(C, tc_309), AK_2841[@i_183], r7_310) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_311: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_2841[@i_183]) in
                    event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_313: symseed;
                    new tc'_312: timest;
                    let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_310: symseed;
                    new tc_309: timest;
                    let e5: maxmac = encsym(pad(C, tc_309), AK_2842[@i_183], r7_310) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_311: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_2842[@i_183]) in
                    event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_313: symseed;
                    new tc'_312: timest;
                    let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_310: symseed;
                    new tc_309: timest;
                    let e5: maxmac = encsym(pad(C, tc_309), AK_2841[@i_183], r7_310) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_311: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_2841[@i_183]) in
                    event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_313: symseed;
                    new tc'_312: timest;
                    let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_310: symseed;
                    new tc_309: timest;
                    let e5: maxmac = encsym(pad(C, tc_309), AK_2842[@i_183], r7_310) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_311: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_2842[@i_183]) in
                    event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_313: symseed;
                    new tc'_312: timest;
                    let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_310: symseed;
                    new tc_309: timest;
                    let e5: maxmac = encsym(pad(C, tc_309), AK_2841[@i_183], r7_310) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_311: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_2841[@i_183]) in
                    event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_313: symseed;
                    new tc'_312: timest;
                    let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_310: symseed;
                    new tc_309: timest;
                    let e5: maxmac = encsym(pad(C, tc_309), AK_2842[@i_183], r7_310) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_311: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_2842[@i_183]) in
                    event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_313: symseed;
                    new tc'_312: timest;
                    let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_310: symseed;
                    new tc_309: timest;
                    let e5: maxmac = encsym(pad(C, tc_309), AK_2841[@i_183], r7_310) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_311: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_2841[@i_183]) in
                    event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_313: symseed;
                    new tc'_312: timest;
                    let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_310: symseed;
                    new tc_309: timest;
                    let e5: maxmac = encsym(pad(C, tc_309), AK_2842[@i_183], r7_310) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_311: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_311));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_311, tt_62: timest, =hostS)) = decsym(m7, AK_2842[@i_183]) in
                    event fullCT(hostT, hostS, n3_311, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_313: symseed;
                    new tc'_312: timest;
                    let e12: maxmac = encsym(pad(C, tc'_312), SK_63, r2_313) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_312)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = kgen(s3_1354) in
              new r4_1355: symseed;
              new tk_1356: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new s_1357: symkeyseed;
              new r5_1358: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = kgen(s3_1360) in
              new tk_1362: timest;
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new s_1363: symkeyseed;
              new r5_1364: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = kgen(s3_1366) in
              new r4_1367: symseed;
              new tk_1368: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new s_1369: symkeyseed;
              new r5_1370: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = kgen(s3_1372) in
              new tk_1374: timest;
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new s_1375: symkeyseed;
              new r5_1376: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(AK_2840[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          let injbot2(pad(=hostY_53[@i_1385], ts: timest)) = decsym(m9, AK_2840[@i_1385]) in
          event partTC(hostY_53[@i_1385], m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
            new rSK_1419: symkeyseed;
            let SK_50: key = kgen(rSK_1419) in
            new r10_1421: symseed;
            new tt_1420: timest;
            let e10: maxmac = encsym(concat5(SK_50, tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
            new r11_1422: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1420, hostW_46), AK_2840[@i_1385], r11_1422) in
            event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, e11);
            out(c8[!_39], (hostY_53[@i_1385], e10, e11, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
            new rSK_1423: symkeyseed;
            let SK_50: key = kgen(rSK_1423) in
            new r10_1424: symseed;
            let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
            new tt_1426: timest;
            new r11_1425: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1426, hostW_46), AK_2840[@i_1385], r11_1425) in
            event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, e11);
            out(c8[!_39], (hostY_53[@i_1385], z_1150, e11, acceptT(hostY_53[@i_1385], hostW_46)))
        orfind @i_1384 <= N suchthat defined(AK_2842[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          let injbot2(pad(=hostY_53[@i_1384], ts: timest)) = decsym(m9, AK_2842[@i_1384]) in
          event partTC(hostY_53[@i_1384], m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
            new rSK_1427: symkeyseed;
            let SK_50: key = kgen(rSK_1427) in
            new r10_1429: symseed;
            new tt_1428: timest;
            let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
            new r11_1430: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1428, hostW_46), AK_2842[@i_1384], r11_1430) in
            event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, e11);
            out(c8[!_39], (hostY_53[@i_1384], e10, e11, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
            new rSK_1431: symkeyseed;
            let SK_50: key = kgen(rSK_1431) in
            new r10_1432: symseed;
            let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
            new tt_1434: timest;
            new r11_1433: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1434, hostW_46), AK_2842[@i_1384], r11_1433) in
            event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, e11);
            out(c8[!_39], (hostY_53[@i_1384], z_1150, e11, acceptT(hostY_53[@i_1384], hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying remove assignments of binder AK_2842 yields

Game 86 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKt: symkeyseed;
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
              find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2843: symseed;
                    new tc_2844: timest;
                    let e5: maxmac = encsym(pad(C, tc_2844), AK_2839[@i_184], r7_2843) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2845: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2846: symseed;
                    new tc'_2847: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2848: symseed;
                    new tc_2849: timest;
                    let e5: maxmac = encsym(pad(C, tc_2849), AK_2840[@i_184], r7_2848) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2850: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2850));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2850, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_2850, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2851: symseed;
                    new tc'_2852: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2852), SK_63, r2_2851) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2852)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2853: symseed;
                    new tc_2854: timest;
                    let e5: maxmac = encsym(pad(C, tc_2854), AK_2839[@i_184], r7_2853) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2855: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2855));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2855, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2855, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2856: symseed;
                    new tc'_2857: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2857), SK_63, r2_2856) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2857)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2858: symseed;
                    new tc_2859: timest;
                    let e5: maxmac = encsym(pad(C, tc_2859), AK_2840[@i_184], r7_2858) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2860: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2860));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2860, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_2860, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2861: symseed;
                    new tc'_2862: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2862), SK_63, r2_2861) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2862)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2863: symseed;
                    new tc_2864: timest;
                    let e5: maxmac = encsym(pad(C, tc_2864), AK_2839[@i_184], r7_2863) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2865: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2865));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2865, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2865, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2866: symseed;
                    new tc'_2867: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2867), SK_63, r2_2866) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2867)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2868: symseed;
                    new tc_2869: timest;
                    let e5: maxmac = encsym(pad(C, tc_2869), AK_2840[@i_184], r7_2868) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2870: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2870));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2870, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_2870, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2871: symseed;
                    new tc'_2872: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2872), SK_63, r2_2871) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2872)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2873: symseed;
                    new tc_2874: timest;
                    let e5: maxmac = encsym(pad(C, tc_2874), AK_2839[@i_184], r7_2873) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2875: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2875));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2875, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2875, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2876: symseed;
                    new tc'_2877: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2877), SK_63, r2_2876) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2877)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2878: symseed;
                    new tc_2879: timest;
                    let e5: maxmac = encsym(pad(C, tc_2879), AK_2840[@i_184], r7_2878) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2880: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2880));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2880, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_2880, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2881: symseed;
                    new tc'_2882: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2882), SK_63, r2_2881) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2882)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
              find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2883: symseed;
                    new tc_2884: timest;
                    let e5: maxmac = encsym(pad(C, tc_2884), AK_2839[@i_184], r7_2883) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2885: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2885));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2885, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2885, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2886: symseed;
                    new tc'_2887: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2887), SK_63, r2_2886) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2887)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2888: symseed;
                    new tc_2889: timest;
                    let e5: maxmac = encsym(pad(C, tc_2889), AK_2840[@i_184], r7_2888) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2890: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2890));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2890, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_2890, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2891: symseed;
                    new tc'_2892: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2892), SK_63, r2_2891) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2892)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2893: symseed;
                    new tc_2894: timest;
                    let e5: maxmac = encsym(pad(C, tc_2894), AK_2839[@i_184], r7_2893) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2895: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2895));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2895, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2895, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2896: symseed;
                    new tc'_2897: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2897), SK_63, r2_2896) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2897)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2898: symseed;
                    new tc_2899: timest;
                    let e5: maxmac = encsym(pad(C, tc_2899), AK_2840[@i_184], r7_2898) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2900: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2900));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2900, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_2900, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2901: symseed;
                    new tc'_2902: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2902), SK_63, r2_2901) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2902)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2903: symseed;
                    new tc_2904: timest;
                    let e5: maxmac = encsym(pad(C, tc_2904), AK_2839[@i_184], r7_2903) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2905: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2905));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2905, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2905, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2906: symseed;
                    new tc'_2907: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2907), SK_63, r2_2906) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2907)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2908: symseed;
                    new tc_2909: timest;
                    let e5: maxmac = encsym(pad(C, tc_2909), AK_2840[@i_184], r7_2908) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2910: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2910));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2910, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_2910, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2911: symseed;
                    new tc'_2912: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2912), SK_63, r2_2911) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2912)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2913: symseed;
                    new tc_2914: timest;
                    let e5: maxmac = encsym(pad(C, tc_2914), AK_2839[@i_184], r7_2913) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2915: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2915));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2915, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2915, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2916: symseed;
                    new tc'_2917: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2917), SK_63, r2_2916) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2917)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2918: symseed;
                    new tc_2919: timest;
                    let e5: maxmac = encsym(pad(C, tc_2919), AK_2840[@i_184], r7_2918) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2920: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2920));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2920, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_2920, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2921: symseed;
                    new tc'_2922: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2922), SK_63, r2_2921) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2922)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
              find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2923: symseed;
                    new tc_2924: timest;
                    let e5: maxmac = encsym(pad(C, tc_2924), AK_2839[@i_184], r7_2923) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2925: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2925));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2925, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2925, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2926: symseed;
                    new tc'_2927: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2927), SK_63, r2_2926) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2927)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2928: symseed;
                    new tc_2929: timest;
                    let e5: maxmac = encsym(pad(C, tc_2929), AK_2840[@i_184], r7_2928) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2930: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2930));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2930, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_2930, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2931: symseed;
                    new tc'_2932: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2932), SK_63, r2_2931) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2932)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2933: symseed;
                    new tc_2934: timest;
                    let e5: maxmac = encsym(pad(C, tc_2934), AK_2839[@i_184], r7_2933) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2935: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2935));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2935, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2935, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2936: symseed;
                    new tc'_2937: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2937), SK_63, r2_2936) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2937)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2938: symseed;
                    new tc_2939: timest;
                    let e5: maxmac = encsym(pad(C, tc_2939), AK_2840[@i_184], r7_2938) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2940: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2940));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2940, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_2940, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2941: symseed;
                    new tc'_2942: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2942), SK_63, r2_2941) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2942)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2943: symseed;
                    new tc_2944: timest;
                    let e5: maxmac = encsym(pad(C, tc_2944), AK_2839[@i_184], r7_2943) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2945: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2945));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2945, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2945, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2946: symseed;
                    new tc'_2947: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2947), SK_63, r2_2946) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2947)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2948: symseed;
                    new tc_2949: timest;
                    let e5: maxmac = encsym(pad(C, tc_2949), AK_2840[@i_184], r7_2948) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2950: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2950));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2950, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_2950, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2951: symseed;
                    new tc'_2952: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2952), SK_63, r2_2951) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2952)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2953: symseed;
                    new tc_2954: timest;
                    let e5: maxmac = encsym(pad(C, tc_2954), AK_2839[@i_184], r7_2953) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2955: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2955));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2955, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2955, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2956: symseed;
                    new tc'_2957: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2957), SK_63, r2_2956) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2957)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2958: symseed;
                    new tc_2959: timest;
                    let e5: maxmac = encsym(pad(C, tc_2959), AK_2840[@i_184], r7_2958) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2960: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2960));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2960, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_2960, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2961: symseed;
                    new tc'_2962: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2962), SK_63, r2_2961) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2962)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
              find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2963: symseed;
                    new tc_2964: timest;
                    let e5: maxmac = encsym(pad(C, tc_2964), AK_2839[@i_184], r7_2963) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2965: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2965));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2965, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2965, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2966: symseed;
                    new tc'_2967: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2967), SK_63, r2_2966) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2967)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2968: symseed;
                    new tc_2969: timest;
                    let e5: maxmac = encsym(pad(C, tc_2969), AK_2840[@i_184], r7_2968) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2970: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2970));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2970, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_2970, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2971: symseed;
                    new tc'_2972: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2972), SK_63, r2_2971) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2972)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2973: symseed;
                    new tc_2974: timest;
                    let e5: maxmac = encsym(pad(C, tc_2974), AK_2839[@i_184], r7_2973) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2975: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2975));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2975, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2975, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2976: symseed;
                    new tc'_2977: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2977), SK_63, r2_2976) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2977)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2978: symseed;
                    new tc_2979: timest;
                    let e5: maxmac = encsym(pad(C, tc_2979), AK_2840[@i_184], r7_2978) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2980: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2980));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2980, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_2980, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2981: symseed;
                    new tc'_2982: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2982), SK_63, r2_2981) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2982)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2983: symseed;
                    new tc_2984: timest;
                    let e5: maxmac = encsym(pad(C, tc_2984), AK_2839[@i_184], r7_2983) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2985: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2985));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2985, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2985, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2986: symseed;
                    new tc'_2987: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2987), SK_63, r2_2986) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2987)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2988: symseed;
                    new tc_2989: timest;
                    let e5: maxmac = encsym(pad(C, tc_2989), AK_2840[@i_184], r7_2988) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2990: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2990));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2990, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_2990, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2991: symseed;
                    new tc'_2992: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2992), SK_63, r2_2991) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2992)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2993: symseed;
                    new tc_2994: timest;
                    let e5: maxmac = encsym(pad(C, tc_2994), AK_2839[@i_184], r7_2993) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2995: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2995));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2995, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2995, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2996: symseed;
                    new tc'_2997: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2997), SK_63, r2_2996) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2997)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2998: symseed;
                    new tc_2999: timest;
                    let e5: maxmac = encsym(pad(C, tc_2999), AK_2840[@i_184], r7_2998) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3000: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3000));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3000, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_3000, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3001: symseed;
                    new tc'_3002: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3002), SK_63, r2_3001) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3002)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            find  suchthat defined(AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
              find  suchthat defined(AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3003: symseed;
                    new tc_3004: timest;
                    let e5: maxmac = encsym(pad(C, tc_3004), AK_2841[@i_183], r7_3003) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3005: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, AK_2841[@i_183]) in
                    event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3006: symseed;
                    new tc'_3007: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3008: symseed;
                    new tc_3009: timest;
                    let e5: maxmac = encsym(pad(C, tc_3009), kgen(s3_1372[@i_183]), r7_3008) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3010: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3010));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3010, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3010, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3011: symseed;
                    new tc'_3012: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3012), SK_63, r2_3011) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3012)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3013: symseed;
                    new tc_3014: timest;
                    let e5: maxmac = encsym(pad(C, tc_3014), AK_2841[@i_183], r7_3013) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3015: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3015));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3015, tt_62: timest, =hostS)) = decsym(m7, AK_2841[@i_183]) in
                    event fullCT(hostT, hostS, n3_3015, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3016: symseed;
                    new tc'_3017: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3017), SK_63, r2_3016) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3017)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3018: symseed;
                    new tc_3019: timest;
                    let e5: maxmac = encsym(pad(C, tc_3019), kgen(s3_1372[@i_183]), r7_3018) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3020: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3020));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3020, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3020, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3021: symseed;
                    new tc'_3022: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3022), SK_63, r2_3021) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3022)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3023: symseed;
                    new tc_3024: timest;
                    let e5: maxmac = encsym(pad(C, tc_3024), AK_2841[@i_183], r7_3023) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3025: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3025));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3025, tt_62: timest, =hostS)) = decsym(m7, AK_2841[@i_183]) in
                    event fullCT(hostT, hostS, n3_3025, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3026: symseed;
                    new tc'_3027: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3027), SK_63, r2_3026) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3027)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3028: symseed;
                    new tc_3029: timest;
                    let e5: maxmac = encsym(pad(C, tc_3029), kgen(s3_1372[@i_183]), r7_3028) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3030: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3030));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3030, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3030, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3031: symseed;
                    new tc'_3032: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3032), SK_63, r2_3031) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3032)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3033: symseed;
                    new tc_3034: timest;
                    let e5: maxmac = encsym(pad(C, tc_3034), AK_2841[@i_183], r7_3033) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3035: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3035));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3035, tt_62: timest, =hostS)) = decsym(m7, AK_2841[@i_183]) in
                    event fullCT(hostT, hostS, n3_3035, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3036: symseed;
                    new tc'_3037: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3037), SK_63, r2_3036) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3037)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3038: symseed;
                    new tc_3039: timest;
                    let e5: maxmac = encsym(pad(C, tc_3039), kgen(s3_1372[@i_183]), r7_3038) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3040: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3040));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3040, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3040, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3041: symseed;
                    new tc'_3042: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3042), SK_63, r2_3041) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3042)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
              find  suchthat defined(AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3043: symseed;
                    new tc_3044: timest;
                    let e5: maxmac = encsym(pad(C, tc_3044), AK_2841[@i_183], r7_3043) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3045: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3045));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3045, tt_62: timest, =hostS)) = decsym(m7, AK_2841[@i_183]) in
                    event fullCT(hostT, hostS, n3_3045, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3046: symseed;
                    new tc'_3047: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3047), SK_63, r2_3046) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3047)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3048: symseed;
                    new tc_3049: timest;
                    let e5: maxmac = encsym(pad(C, tc_3049), kgen(s3_1372[@i_183]), r7_3048) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3050: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3050));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3050, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3050, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3051: symseed;
                    new tc'_3052: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3052), SK_63, r2_3051) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3052)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3053: symseed;
                    new tc_3054: timest;
                    let e5: maxmac = encsym(pad(C, tc_3054), AK_2841[@i_183], r7_3053) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3055: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3055));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3055, tt_62: timest, =hostS)) = decsym(m7, AK_2841[@i_183]) in
                    event fullCT(hostT, hostS, n3_3055, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3056: symseed;
                    new tc'_3057: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3057), SK_63, r2_3056) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3057)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3058: symseed;
                    new tc_3059: timest;
                    let e5: maxmac = encsym(pad(C, tc_3059), kgen(s3_1372[@i_183]), r7_3058) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3060: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3060));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3060, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3060, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3061: symseed;
                    new tc'_3062: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3062), SK_63, r2_3061) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3062)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3063: symseed;
                    new tc_3064: timest;
                    let e5: maxmac = encsym(pad(C, tc_3064), AK_2841[@i_183], r7_3063) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3065: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3065));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3065, tt_62: timest, =hostS)) = decsym(m7, AK_2841[@i_183]) in
                    event fullCT(hostT, hostS, n3_3065, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3066: symseed;
                    new tc'_3067: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3067), SK_63, r2_3066) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3067)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3068: symseed;
                    new tc_3069: timest;
                    let e5: maxmac = encsym(pad(C, tc_3069), kgen(s3_1372[@i_183]), r7_3068) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3070: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3070));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3070, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3070, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3071: symseed;
                    new tc'_3072: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3072), SK_63, r2_3071) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3072)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3073: symseed;
                    new tc_3074: timest;
                    let e5: maxmac = encsym(pad(C, tc_3074), AK_2841[@i_183], r7_3073) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3075: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3075));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3075, tt_62: timest, =hostS)) = decsym(m7, AK_2841[@i_183]) in
                    event fullCT(hostT, hostS, n3_3075, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3076: symseed;
                    new tc'_3077: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3077), SK_63, r2_3076) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3077)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3078: symseed;
                    new tc_3079: timest;
                    let e5: maxmac = encsym(pad(C, tc_3079), kgen(s3_1372[@i_183]), r7_3078) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3080: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3080));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3080, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3080, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3081: symseed;
                    new tc'_3082: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3082), SK_63, r2_3081) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3082)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            find  suchthat defined(AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
              find  suchthat defined(AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3083: symseed;
                    new tc_3084: timest;
                    let e5: maxmac = encsym(pad(C, tc_3084), AK_2841[@i_183], r7_3083) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3085: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3085));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3085, tt_62: timest, =hostS)) = decsym(m7, AK_2841[@i_183]) in
                    event fullCT(hostT, hostS, n3_3085, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3086: symseed;
                    new tc'_3087: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3087), SK_63, r2_3086) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3087)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3088: symseed;
                    new tc_3089: timest;
                    let e5: maxmac = encsym(pad(C, tc_3089), kgen(s3_1372[@i_183]), r7_3088) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3090: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3090));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3090, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3090, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3091: symseed;
                    new tc'_3092: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3092), SK_63, r2_3091) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3092)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3093: symseed;
                    new tc_3094: timest;
                    let e5: maxmac = encsym(pad(C, tc_3094), AK_2841[@i_183], r7_3093) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3095: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3095));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3095, tt_62: timest, =hostS)) = decsym(m7, AK_2841[@i_183]) in
                    event fullCT(hostT, hostS, n3_3095, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3096: symseed;
                    new tc'_3097: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3097), SK_63, r2_3096) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3097)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3098: symseed;
                    new tc_3099: timest;
                    let e5: maxmac = encsym(pad(C, tc_3099), kgen(s3_1372[@i_183]), r7_3098) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3100: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3100));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3100, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3100, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3101: symseed;
                    new tc'_3102: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3102), SK_63, r2_3101) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3102)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3103: symseed;
                    new tc_3104: timest;
                    let e5: maxmac = encsym(pad(C, tc_3104), AK_2841[@i_183], r7_3103) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3105: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3105));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3105, tt_62: timest, =hostS)) = decsym(m7, AK_2841[@i_183]) in
                    event fullCT(hostT, hostS, n3_3105, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3106: symseed;
                    new tc'_3107: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3107), SK_63, r2_3106) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3107)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3108: symseed;
                    new tc_3109: timest;
                    let e5: maxmac = encsym(pad(C, tc_3109), kgen(s3_1372[@i_183]), r7_3108) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3110: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3110));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3110, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3110, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3111: symseed;
                    new tc'_3112: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3112), SK_63, r2_3111) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3112)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3113: symseed;
                    new tc_3114: timest;
                    let e5: maxmac = encsym(pad(C, tc_3114), AK_2841[@i_183], r7_3113) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3115: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3115));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3115, tt_62: timest, =hostS)) = decsym(m7, AK_2841[@i_183]) in
                    event fullCT(hostT, hostS, n3_3115, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3116: symseed;
                    new tc'_3117: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3117), SK_63, r2_3116) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3117)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3118: symseed;
                    new tc_3119: timest;
                    let e5: maxmac = encsym(pad(C, tc_3119), kgen(s3_1372[@i_183]), r7_3118) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3120: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3120));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3120, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3120, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3121: symseed;
                    new tc'_3122: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3122), SK_63, r2_3121) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3122)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
              find  suchthat defined(AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3123: symseed;
                    new tc_3124: timest;
                    let e5: maxmac = encsym(pad(C, tc_3124), AK_2841[@i_183], r7_3123) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3125: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3125));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3125, tt_62: timest, =hostS)) = decsym(m7, AK_2841[@i_183]) in
                    event fullCT(hostT, hostS, n3_3125, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3126: symseed;
                    new tc'_3127: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3127), SK_63, r2_3126) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3127)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3128: symseed;
                    new tc_3129: timest;
                    let e5: maxmac = encsym(pad(C, tc_3129), kgen(s3_1372[@i_183]), r7_3128) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3130: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3130));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3130, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3130, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3131: symseed;
                    new tc'_3132: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3132), SK_63, r2_3131) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3132)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3133: symseed;
                    new tc_3134: timest;
                    let e5: maxmac = encsym(pad(C, tc_3134), AK_2841[@i_183], r7_3133) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3135: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3135));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3135, tt_62: timest, =hostS)) = decsym(m7, AK_2841[@i_183]) in
                    event fullCT(hostT, hostS, n3_3135, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3136: symseed;
                    new tc'_3137: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3137), SK_63, r2_3136) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3137)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3138: symseed;
                    new tc_3139: timest;
                    let e5: maxmac = encsym(pad(C, tc_3139), kgen(s3_1372[@i_183]), r7_3138) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3140: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3140));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3140, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3140, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3141: symseed;
                    new tc'_3142: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3142), SK_63, r2_3141) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3142)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3143: symseed;
                    new tc_3144: timest;
                    let e5: maxmac = encsym(pad(C, tc_3144), AK_2841[@i_183], r7_3143) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3145: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3145));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3145, tt_62: timest, =hostS)) = decsym(m7, AK_2841[@i_183]) in
                    event fullCT(hostT, hostS, n3_3145, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3146: symseed;
                    new tc'_3147: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3147), SK_63, r2_3146) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3147)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3148: symseed;
                    new tc_3149: timest;
                    let e5: maxmac = encsym(pad(C, tc_3149), kgen(s3_1372[@i_183]), r7_3148) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3150: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3150));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3150, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3150, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3151: symseed;
                    new tc'_3152: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3152), SK_63, r2_3151) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3152)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3153: symseed;
                    new tc_3154: timest;
                    let e5: maxmac = encsym(pad(C, tc_3154), AK_2841[@i_183], r7_3153) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3155: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3155));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3155, tt_62: timest, =hostS)) = decsym(m7, AK_2841[@i_183]) in
                    event fullCT(hostT, hostS, n3_3155, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3156: symseed;
                    new tc'_3157: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3157), SK_63, r2_3156) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3157)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3158: symseed;
                    new tc_3159: timest;
                    let e5: maxmac = encsym(pad(C, tc_3159), kgen(s3_1372[@i_183]), r7_3158) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3160: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3160));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3160, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3160, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3161: symseed;
                    new tc'_3162: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3162), SK_63, r2_3161) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3162)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = kgen(s3_1354) in
              new r4_1355: symseed;
              new tk_1356: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new s_1357: symkeyseed;
              new r5_1358: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = kgen(s3_1360) in
              new tk_1362: timest;
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new s_1363: symkeyseed;
              new r5_1364: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = kgen(s3_1366) in
              new r4_1367: symseed;
              new tk_1368: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new s_1369: symkeyseed;
              new r5_1370: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new tk_1374: timest;
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new s_1375: symkeyseed;
              new r5_1376: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(AK_2840[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          let injbot2(pad(=hostY_53[@i_1385], ts: timest)) = decsym(m9, AK_2840[@i_1385]) in
          event partTC(hostY_53[@i_1385], m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
            new rSK_1419: symkeyseed;
            let SK_50: key = kgen(rSK_1419) in
            new r10_1421: symseed;
            new tt_1420: timest;
            let e10: maxmac = encsym(concat5(SK_50, tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
            new r11_1422: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1420, hostW_46), AK_2840[@i_1385], r11_1422) in
            event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, e11);
            out(c8[!_39], (hostY_53[@i_1385], e10, e11, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
            new rSK_1423: symkeyseed;
            let SK_50: key = kgen(rSK_1423) in
            new r10_1424: symseed;
            let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
            new tt_1426: timest;
            new r11_1425: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1426, hostW_46), AK_2840[@i_1385], r11_1425) in
            event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, e11);
            out(c8[!_39], (hostY_53[@i_1385], z_1150, e11, acceptT(hostY_53[@i_1385], hostW_46)))
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], AK_2842[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          let injbot2(pad(=hostY_53[@i_1384], ts: timest)) = decsym(m9, kgen(s3_1372[@i_1384])) in
          event partTC(hostY_53[@i_1384], m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
            new rSK_1427: symkeyseed;
            let SK_50: key = kgen(rSK_1427) in
            new r10_1429: symseed;
            new tt_1428: timest;
            let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
            new r11_1430: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1428, hostW_46), kgen(s3_1372[@i_1384]), r11_1430) in
            event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, e11);
            out(c8[!_39], (hostY_53[@i_1384], e10, e11, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
            new rSK_1431: symkeyseed;
            let SK_50: key = kgen(rSK_1431) in
            new r10_1432: symseed;
            let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
            new tt_1434: timest;
            new r11_1433: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1434, hostW_46), kgen(s3_1372[@i_1384]), r11_1433) in
            event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, e11);
            out(c8[!_39], (hostY_53[@i_1384], z_1150, e11, acceptT(hostY_53[@i_1384], hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying remove assignments of binder AK_2841 yields

Game 87 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKt: symkeyseed;
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
              find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2843: symseed;
                    new tc_2844: timest;
                    let e5: maxmac = encsym(pad(C, tc_2844), AK_2839[@i_184], r7_2843) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2845: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2846: symseed;
                    new tc'_2847: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2848: symseed;
                    new tc_2849: timest;
                    let e5: maxmac = encsym(pad(C, tc_2849), AK_2840[@i_184], r7_2848) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2850: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2850));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2850, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_2850, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2851: symseed;
                    new tc'_2852: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2852), SK_63, r2_2851) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2852)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2853: symseed;
                    new tc_2854: timest;
                    let e5: maxmac = encsym(pad(C, tc_2854), AK_2839[@i_184], r7_2853) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2855: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2855));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2855, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2855, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2856: symseed;
                    new tc'_2857: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2857), SK_63, r2_2856) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2857)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2858: symseed;
                    new tc_2859: timest;
                    let e5: maxmac = encsym(pad(C, tc_2859), AK_2840[@i_184], r7_2858) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2860: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2860));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2860, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_2860, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2861: symseed;
                    new tc'_2862: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2862), SK_63, r2_2861) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2862)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2863: symseed;
                    new tc_2864: timest;
                    let e5: maxmac = encsym(pad(C, tc_2864), AK_2839[@i_184], r7_2863) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2865: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2865));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2865, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2865, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2866: symseed;
                    new tc'_2867: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2867), SK_63, r2_2866) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2867)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2868: symseed;
                    new tc_2869: timest;
                    let e5: maxmac = encsym(pad(C, tc_2869), AK_2840[@i_184], r7_2868) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2870: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2870));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2870, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_2870, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2871: symseed;
                    new tc'_2872: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2872), SK_63, r2_2871) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2872)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2873: symseed;
                    new tc_2874: timest;
                    let e5: maxmac = encsym(pad(C, tc_2874), AK_2839[@i_184], r7_2873) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2875: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2875));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2875, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2875, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2876: symseed;
                    new tc'_2877: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2877), SK_63, r2_2876) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2877)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2878: symseed;
                    new tc_2879: timest;
                    let e5: maxmac = encsym(pad(C, tc_2879), AK_2840[@i_184], r7_2878) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2880: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2880));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2880, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_2880, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2881: symseed;
                    new tc'_2882: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2882), SK_63, r2_2881) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2882)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
              find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2883: symseed;
                    new tc_2884: timest;
                    let e5: maxmac = encsym(pad(C, tc_2884), AK_2839[@i_184], r7_2883) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2885: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2885));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2885, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2885, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2886: symseed;
                    new tc'_2887: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2887), SK_63, r2_2886) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2887)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2888: symseed;
                    new tc_2889: timest;
                    let e5: maxmac = encsym(pad(C, tc_2889), AK_2840[@i_184], r7_2888) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2890: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2890));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2890, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_2890, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2891: symseed;
                    new tc'_2892: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2892), SK_63, r2_2891) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2892)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2893: symseed;
                    new tc_2894: timest;
                    let e5: maxmac = encsym(pad(C, tc_2894), AK_2839[@i_184], r7_2893) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2895: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2895));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2895, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2895, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2896: symseed;
                    new tc'_2897: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2897), SK_63, r2_2896) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2897)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2898: symseed;
                    new tc_2899: timest;
                    let e5: maxmac = encsym(pad(C, tc_2899), AK_2840[@i_184], r7_2898) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2900: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2900));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2900, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_2900, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2901: symseed;
                    new tc'_2902: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2902), SK_63, r2_2901) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2902)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2903: symseed;
                    new tc_2904: timest;
                    let e5: maxmac = encsym(pad(C, tc_2904), AK_2839[@i_184], r7_2903) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2905: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2905));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2905, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2905, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2906: symseed;
                    new tc'_2907: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2907), SK_63, r2_2906) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2907)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2908: symseed;
                    new tc_2909: timest;
                    let e5: maxmac = encsym(pad(C, tc_2909), AK_2840[@i_184], r7_2908) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2910: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2910));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2910, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_2910, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2911: symseed;
                    new tc'_2912: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2912), SK_63, r2_2911) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2912)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2913: symseed;
                    new tc_2914: timest;
                    let e5: maxmac = encsym(pad(C, tc_2914), AK_2839[@i_184], r7_2913) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2915: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2915));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2915, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2915, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2916: symseed;
                    new tc'_2917: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2917), SK_63, r2_2916) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2917)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2918: symseed;
                    new tc_2919: timest;
                    let e5: maxmac = encsym(pad(C, tc_2919), AK_2840[@i_184], r7_2918) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2920: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2920));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2920, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_2920, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2921: symseed;
                    new tc'_2922: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2922), SK_63, r2_2921) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2922)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
              find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2923: symseed;
                    new tc_2924: timest;
                    let e5: maxmac = encsym(pad(C, tc_2924), AK_2839[@i_184], r7_2923) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2925: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2925));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2925, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2925, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2926: symseed;
                    new tc'_2927: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2927), SK_63, r2_2926) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2927)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2928: symseed;
                    new tc_2929: timest;
                    let e5: maxmac = encsym(pad(C, tc_2929), AK_2840[@i_184], r7_2928) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2930: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2930));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2930, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_2930, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2931: symseed;
                    new tc'_2932: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2932), SK_63, r2_2931) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2932)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2933: symseed;
                    new tc_2934: timest;
                    let e5: maxmac = encsym(pad(C, tc_2934), AK_2839[@i_184], r7_2933) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2935: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2935));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2935, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2935, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2936: symseed;
                    new tc'_2937: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2937), SK_63, r2_2936) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2937)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2938: symseed;
                    new tc_2939: timest;
                    let e5: maxmac = encsym(pad(C, tc_2939), AK_2840[@i_184], r7_2938) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2940: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2940));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2940, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_2940, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2941: symseed;
                    new tc'_2942: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2942), SK_63, r2_2941) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2942)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2943: symseed;
                    new tc_2944: timest;
                    let e5: maxmac = encsym(pad(C, tc_2944), AK_2839[@i_184], r7_2943) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2945: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2945));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2945, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2945, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2946: symseed;
                    new tc'_2947: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2947), SK_63, r2_2946) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2947)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2948: symseed;
                    new tc_2949: timest;
                    let e5: maxmac = encsym(pad(C, tc_2949), AK_2840[@i_184], r7_2948) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2950: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2950));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2950, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_2950, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2951: symseed;
                    new tc'_2952: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2952), SK_63, r2_2951) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2952)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2953: symseed;
                    new tc_2954: timest;
                    let e5: maxmac = encsym(pad(C, tc_2954), AK_2839[@i_184], r7_2953) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2955: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2955));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2955, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2955, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2956: symseed;
                    new tc'_2957: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2957), SK_63, r2_2956) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2957)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2958: symseed;
                    new tc_2959: timest;
                    let e5: maxmac = encsym(pad(C, tc_2959), AK_2840[@i_184], r7_2958) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2960: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2960));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2960, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_2960, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2961: symseed;
                    new tc'_2962: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2962), SK_63, r2_2961) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2962)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
              find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2963: symseed;
                    new tc_2964: timest;
                    let e5: maxmac = encsym(pad(C, tc_2964), AK_2839[@i_184], r7_2963) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2965: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2965));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2965, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2965, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2966: symseed;
                    new tc'_2967: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2967), SK_63, r2_2966) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2967)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2968: symseed;
                    new tc_2969: timest;
                    let e5: maxmac = encsym(pad(C, tc_2969), AK_2840[@i_184], r7_2968) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2970: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2970));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2970, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_2970, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2971: symseed;
                    new tc'_2972: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2972), SK_63, r2_2971) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2972)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2973: symseed;
                    new tc_2974: timest;
                    let e5: maxmac = encsym(pad(C, tc_2974), AK_2839[@i_184], r7_2973) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2975: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2975));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2975, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2975, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2976: symseed;
                    new tc'_2977: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2977), SK_63, r2_2976) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2977)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2978: symseed;
                    new tc_2979: timest;
                    let e5: maxmac = encsym(pad(C, tc_2979), AK_2840[@i_184], r7_2978) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2980: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2980));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2980, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_2980, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2981: symseed;
                    new tc'_2982: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2982), SK_63, r2_2981) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2982)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2983: symseed;
                    new tc_2984: timest;
                    let e5: maxmac = encsym(pad(C, tc_2984), AK_2839[@i_184], r7_2983) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2985: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2985));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2985, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2985, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2986: symseed;
                    new tc'_2987: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2987), SK_63, r2_2986) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2987)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2988: symseed;
                    new tc_2989: timest;
                    let e5: maxmac = encsym(pad(C, tc_2989), AK_2840[@i_184], r7_2988) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2990: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2990));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2990, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_2990, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2991: symseed;
                    new tc'_2992: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2992), SK_63, r2_2991) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2992)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2993: symseed;
                    new tc_2994: timest;
                    let e5: maxmac = encsym(pad(C, tc_2994), AK_2839[@i_184], r7_2993) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2995: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2995));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2995, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2995, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2996: symseed;
                    new tc'_2997: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2997), SK_63, r2_2996) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2997)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2998: symseed;
                    new tc_2999: timest;
                    let e5: maxmac = encsym(pad(C, tc_2999), AK_2840[@i_184], r7_2998) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3000: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3000));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3000, tt_62: timest, =hostS)) = decsym(m7, AK_2840[@i_184]) in
                    event fullCT(hostT, hostS, n3_3000, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3001: symseed;
                    new tc'_3002: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3002), SK_63, r2_3001) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3002)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
              find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3003: symseed;
                    new tc_3004: timest;
                    let e5: maxmac = encsym(pad(C, tc_3004), kgen(s3_1366[@i_183]), r7_3003) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3005: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3006: symseed;
                    new tc'_3007: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3008: symseed;
                    new tc_3009: timest;
                    let e5: maxmac = encsym(pad(C, tc_3009), kgen(s3_1372[@i_183]), r7_3008) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3010: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3010));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3010, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3010, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3011: symseed;
                    new tc'_3012: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3012), SK_63, r2_3011) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3012)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3013: symseed;
                    new tc_3014: timest;
                    let e5: maxmac = encsym(pad(C, tc_3014), kgen(s3_1366[@i_183]), r7_3013) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3015: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3015));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3015, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3015, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3016: symseed;
                    new tc'_3017: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3017), SK_63, r2_3016) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3017)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3018: symseed;
                    new tc_3019: timest;
                    let e5: maxmac = encsym(pad(C, tc_3019), kgen(s3_1372[@i_183]), r7_3018) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3020: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3020));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3020, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3020, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3021: symseed;
                    new tc'_3022: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3022), SK_63, r2_3021) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3022)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3023: symseed;
                    new tc_3024: timest;
                    let e5: maxmac = encsym(pad(C, tc_3024), kgen(s3_1366[@i_183]), r7_3023) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3025: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3025));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3025, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3025, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3026: symseed;
                    new tc'_3027: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3027), SK_63, r2_3026) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3027)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3028: symseed;
                    new tc_3029: timest;
                    let e5: maxmac = encsym(pad(C, tc_3029), kgen(s3_1372[@i_183]), r7_3028) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3030: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3030));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3030, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3030, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3031: symseed;
                    new tc'_3032: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3032), SK_63, r2_3031) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3032)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3033: symseed;
                    new tc_3034: timest;
                    let e5: maxmac = encsym(pad(C, tc_3034), kgen(s3_1366[@i_183]), r7_3033) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3035: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3035));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3035, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3035, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3036: symseed;
                    new tc'_3037: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3037), SK_63, r2_3036) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3037)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3038: symseed;
                    new tc_3039: timest;
                    let e5: maxmac = encsym(pad(C, tc_3039), kgen(s3_1372[@i_183]), r7_3038) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3040: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3040));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3040, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3040, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3041: symseed;
                    new tc'_3042: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3042), SK_63, r2_3041) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3042)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
              find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3043: symseed;
                    new tc_3044: timest;
                    let e5: maxmac = encsym(pad(C, tc_3044), kgen(s3_1366[@i_183]), r7_3043) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3045: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3045));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3045, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3045, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3046: symseed;
                    new tc'_3047: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3047), SK_63, r2_3046) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3047)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3048: symseed;
                    new tc_3049: timest;
                    let e5: maxmac = encsym(pad(C, tc_3049), kgen(s3_1372[@i_183]), r7_3048) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3050: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3050));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3050, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3050, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3051: symseed;
                    new tc'_3052: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3052), SK_63, r2_3051) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3052)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3053: symseed;
                    new tc_3054: timest;
                    let e5: maxmac = encsym(pad(C, tc_3054), kgen(s3_1366[@i_183]), r7_3053) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3055: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3055));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3055, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3055, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3056: symseed;
                    new tc'_3057: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3057), SK_63, r2_3056) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3057)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3058: symseed;
                    new tc_3059: timest;
                    let e5: maxmac = encsym(pad(C, tc_3059), kgen(s3_1372[@i_183]), r7_3058) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3060: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3060));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3060, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3060, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3061: symseed;
                    new tc'_3062: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3062), SK_63, r2_3061) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3062)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3063: symseed;
                    new tc_3064: timest;
                    let e5: maxmac = encsym(pad(C, tc_3064), kgen(s3_1366[@i_183]), r7_3063) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3065: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3065));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3065, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3065, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3066: symseed;
                    new tc'_3067: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3067), SK_63, r2_3066) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3067)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3068: symseed;
                    new tc_3069: timest;
                    let e5: maxmac = encsym(pad(C, tc_3069), kgen(s3_1372[@i_183]), r7_3068) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3070: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3070));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3070, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3070, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3071: symseed;
                    new tc'_3072: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3072), SK_63, r2_3071) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3072)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3073: symseed;
                    new tc_3074: timest;
                    let e5: maxmac = encsym(pad(C, tc_3074), kgen(s3_1366[@i_183]), r7_3073) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3075: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3075));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3075, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3075, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3076: symseed;
                    new tc'_3077: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3077), SK_63, r2_3076) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3077)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3078: symseed;
                    new tc_3079: timest;
                    let e5: maxmac = encsym(pad(C, tc_3079), kgen(s3_1372[@i_183]), r7_3078) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3080: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3080));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3080, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3080, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3081: symseed;
                    new tc'_3082: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3082), SK_63, r2_3081) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3082)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
              find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3083: symseed;
                    new tc_3084: timest;
                    let e5: maxmac = encsym(pad(C, tc_3084), kgen(s3_1366[@i_183]), r7_3083) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3085: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3085));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3085, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3085, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3086: symseed;
                    new tc'_3087: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3087), SK_63, r2_3086) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3087)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3088: symseed;
                    new tc_3089: timest;
                    let e5: maxmac = encsym(pad(C, tc_3089), kgen(s3_1372[@i_183]), r7_3088) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3090: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3090));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3090, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3090, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3091: symseed;
                    new tc'_3092: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3092), SK_63, r2_3091) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3092)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3093: symseed;
                    new tc_3094: timest;
                    let e5: maxmac = encsym(pad(C, tc_3094), kgen(s3_1366[@i_183]), r7_3093) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3095: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3095));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3095, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3095, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3096: symseed;
                    new tc'_3097: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3097), SK_63, r2_3096) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3097)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3098: symseed;
                    new tc_3099: timest;
                    let e5: maxmac = encsym(pad(C, tc_3099), kgen(s3_1372[@i_183]), r7_3098) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3100: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3100));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3100, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3100, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3101: symseed;
                    new tc'_3102: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3102), SK_63, r2_3101) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3102)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3103: symseed;
                    new tc_3104: timest;
                    let e5: maxmac = encsym(pad(C, tc_3104), kgen(s3_1366[@i_183]), r7_3103) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3105: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3105));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3105, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3105, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3106: symseed;
                    new tc'_3107: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3107), SK_63, r2_3106) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3107)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3108: symseed;
                    new tc_3109: timest;
                    let e5: maxmac = encsym(pad(C, tc_3109), kgen(s3_1372[@i_183]), r7_3108) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3110: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3110));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3110, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3110, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3111: symseed;
                    new tc'_3112: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3112), SK_63, r2_3111) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3112)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3113: symseed;
                    new tc_3114: timest;
                    let e5: maxmac = encsym(pad(C, tc_3114), kgen(s3_1366[@i_183]), r7_3113) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3115: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3115));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3115, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3115, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3116: symseed;
                    new tc'_3117: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3117), SK_63, r2_3116) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3117)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3118: symseed;
                    new tc_3119: timest;
                    let e5: maxmac = encsym(pad(C, tc_3119), kgen(s3_1372[@i_183]), r7_3118) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3120: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3120));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3120, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3120, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3121: symseed;
                    new tc'_3122: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3122), SK_63, r2_3121) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3122)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
              find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3123: symseed;
                    new tc_3124: timest;
                    let e5: maxmac = encsym(pad(C, tc_3124), kgen(s3_1366[@i_183]), r7_3123) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3125: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3125));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3125, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3125, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3126: symseed;
                    new tc'_3127: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3127), SK_63, r2_3126) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3127)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3128: symseed;
                    new tc_3129: timest;
                    let e5: maxmac = encsym(pad(C, tc_3129), kgen(s3_1372[@i_183]), r7_3128) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3130: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3130));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3130, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3130, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3131: symseed;
                    new tc'_3132: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3132), SK_63, r2_3131) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3132)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3133: symseed;
                    new tc_3134: timest;
                    let e5: maxmac = encsym(pad(C, tc_3134), kgen(s3_1366[@i_183]), r7_3133) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3135: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3135));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3135, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3135, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3136: symseed;
                    new tc'_3137: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3137), SK_63, r2_3136) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3137)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3138: symseed;
                    new tc_3139: timest;
                    let e5: maxmac = encsym(pad(C, tc_3139), kgen(s3_1372[@i_183]), r7_3138) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3140: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3140));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3140, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3140, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3141: symseed;
                    new tc'_3142: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3142), SK_63, r2_3141) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3142)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3143: symseed;
                    new tc_3144: timest;
                    let e5: maxmac = encsym(pad(C, tc_3144), kgen(s3_1366[@i_183]), r7_3143) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3145: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3145));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3145, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3145, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3146: symseed;
                    new tc'_3147: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3147), SK_63, r2_3146) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3147)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3148: symseed;
                    new tc_3149: timest;
                    let e5: maxmac = encsym(pad(C, tc_3149), kgen(s3_1372[@i_183]), r7_3148) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3150: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3150));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3150, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3150, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3151: symseed;
                    new tc'_3152: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3152), SK_63, r2_3151) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3152)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3153: symseed;
                    new tc_3154: timest;
                    let e5: maxmac = encsym(pad(C, tc_3154), kgen(s3_1366[@i_183]), r7_3153) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3155: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3155));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3155, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3155, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3156: symseed;
                    new tc'_3157: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3157), SK_63, r2_3156) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3157)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3158: symseed;
                    new tc_3159: timest;
                    let e5: maxmac = encsym(pad(C, tc_3159), kgen(s3_1372[@i_183]), r7_3158) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3160: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3160));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3160, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3160, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3161: symseed;
                    new tc'_3162: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3162), SK_63, r2_3161) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3162)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = kgen(s3_1354) in
              new r4_1355: symseed;
              new tk_1356: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new s_1357: symkeyseed;
              new r5_1358: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = kgen(s3_1360) in
              new tk_1362: timest;
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new s_1363: symkeyseed;
              new r5_1364: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = cst_key in
              new r4_1367: symseed;
              new tk_1368: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new s_1369: symkeyseed;
              new r5_1370: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new tk_1374: timest;
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new s_1375: symkeyseed;
              new r5_1376: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(AK_2840[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          let injbot2(pad(=hostY_53[@i_1385], ts: timest)) = decsym(m9, AK_2840[@i_1385]) in
          event partTC(hostY_53[@i_1385], m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
            new rSK_1419: symkeyseed;
            let SK_50: key = kgen(rSK_1419) in
            new r10_1421: symseed;
            new tt_1420: timest;
            let e10: maxmac = encsym(concat5(SK_50, tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
            new r11_1422: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1420, hostW_46), AK_2840[@i_1385], r11_1422) in
            event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, e11);
            out(c8[!_39], (hostY_53[@i_1385], e10, e11, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
            new rSK_1423: symkeyseed;
            let SK_50: key = kgen(rSK_1423) in
            new r10_1424: symseed;
            let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
            new tt_1426: timest;
            new r11_1425: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1426, hostW_46), AK_2840[@i_1385], r11_1425) in
            event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, e11);
            out(c8[!_39], (hostY_53[@i_1385], z_1150, e11, acceptT(hostY_53[@i_1385], hostW_46)))
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], AK_2842[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          let injbot2(pad(=hostY_53[@i_1384], ts: timest)) = decsym(m9, kgen(s3_1372[@i_1384])) in
          event partTC(hostY_53[@i_1384], m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
            new rSK_1427: symkeyseed;
            let SK_50: key = kgen(rSK_1427) in
            new r10_1429: symseed;
            new tt_1428: timest;
            let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
            new r11_1430: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1428, hostW_46), kgen(s3_1372[@i_1384]), r11_1430) in
            event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, e11);
            out(c8[!_39], (hostY_53[@i_1384], e10, e11, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
            new rSK_1431: symkeyseed;
            let SK_50: key = kgen(rSK_1431) in
            new r10_1432: symseed;
            let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
            new tt_1434: timest;
            new r11_1433: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1434, hostW_46), kgen(s3_1372[@i_1384]), r11_1433) in
            event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, e11);
            out(c8[!_39], (hostY_53[@i_1384], z_1150, e11, acceptT(hostY_53[@i_1384], hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying remove assignments of binder AK_2840 yields

Game 88 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKt: symkeyseed;
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
              find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2843: symseed;
                    new tc_2844: timest;
                    let e5: maxmac = encsym(pad(C, tc_2844), AK_2839[@i_184], r7_2843) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2845: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2846: symseed;
                    new tc'_2847: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2848: symseed;
                    new tc_2849: timest;
                    let e5: maxmac = encsym(pad(C, tc_2849), kgen(s3_1360[@i_184]), r7_2848) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2850: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2850));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2850, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2850, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2851: symseed;
                    new tc'_2852: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2852), SK_63, r2_2851) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2852)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2853: symseed;
                    new tc_2854: timest;
                    let e5: maxmac = encsym(pad(C, tc_2854), AK_2839[@i_184], r7_2853) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2855: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2855));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2855, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2855, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2856: symseed;
                    new tc'_2857: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2857), SK_63, r2_2856) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2857)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2858: symseed;
                    new tc_2859: timest;
                    let e5: maxmac = encsym(pad(C, tc_2859), kgen(s3_1360[@i_184]), r7_2858) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2860: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2860));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2860, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2860, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2861: symseed;
                    new tc'_2862: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2862), SK_63, r2_2861) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2862)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2863: symseed;
                    new tc_2864: timest;
                    let e5: maxmac = encsym(pad(C, tc_2864), AK_2839[@i_184], r7_2863) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2865: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2865));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2865, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2865, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2866: symseed;
                    new tc'_2867: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2867), SK_63, r2_2866) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2867)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2868: symseed;
                    new tc_2869: timest;
                    let e5: maxmac = encsym(pad(C, tc_2869), kgen(s3_1360[@i_184]), r7_2868) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2870: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2870));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2870, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2870, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2871: symseed;
                    new tc'_2872: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2872), SK_63, r2_2871) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2872)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2873: symseed;
                    new tc_2874: timest;
                    let e5: maxmac = encsym(pad(C, tc_2874), AK_2839[@i_184], r7_2873) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2875: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2875));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2875, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2875, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2876: symseed;
                    new tc'_2877: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2877), SK_63, r2_2876) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2877)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2878: symseed;
                    new tc_2879: timest;
                    let e5: maxmac = encsym(pad(C, tc_2879), kgen(s3_1360[@i_184]), r7_2878) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2880: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2880));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2880, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2880, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2881: symseed;
                    new tc'_2882: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2882), SK_63, r2_2881) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2882)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
              find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2883: symseed;
                    new tc_2884: timest;
                    let e5: maxmac = encsym(pad(C, tc_2884), AK_2839[@i_184], r7_2883) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2885: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2885));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2885, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2885, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2886: symseed;
                    new tc'_2887: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2887), SK_63, r2_2886) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2887)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2888: symseed;
                    new tc_2889: timest;
                    let e5: maxmac = encsym(pad(C, tc_2889), kgen(s3_1360[@i_184]), r7_2888) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2890: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2890));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2890, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2890, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2891: symseed;
                    new tc'_2892: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2892), SK_63, r2_2891) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2892)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2893: symseed;
                    new tc_2894: timest;
                    let e5: maxmac = encsym(pad(C, tc_2894), AK_2839[@i_184], r7_2893) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2895: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2895));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2895, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2895, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2896: symseed;
                    new tc'_2897: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2897), SK_63, r2_2896) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2897)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2898: symseed;
                    new tc_2899: timest;
                    let e5: maxmac = encsym(pad(C, tc_2899), kgen(s3_1360[@i_184]), r7_2898) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2900: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2900));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2900, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2900, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2901: symseed;
                    new tc'_2902: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2902), SK_63, r2_2901) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2902)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2903: symseed;
                    new tc_2904: timest;
                    let e5: maxmac = encsym(pad(C, tc_2904), AK_2839[@i_184], r7_2903) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2905: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2905));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2905, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2905, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2906: symseed;
                    new tc'_2907: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2907), SK_63, r2_2906) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2907)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2908: symseed;
                    new tc_2909: timest;
                    let e5: maxmac = encsym(pad(C, tc_2909), kgen(s3_1360[@i_184]), r7_2908) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2910: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2910));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2910, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2910, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2911: symseed;
                    new tc'_2912: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2912), SK_63, r2_2911) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2912)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2913: symseed;
                    new tc_2914: timest;
                    let e5: maxmac = encsym(pad(C, tc_2914), AK_2839[@i_184], r7_2913) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2915: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2915));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2915, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2915, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2916: symseed;
                    new tc'_2917: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2917), SK_63, r2_2916) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2917)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2918: symseed;
                    new tc_2919: timest;
                    let e5: maxmac = encsym(pad(C, tc_2919), kgen(s3_1360[@i_184]), r7_2918) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2920: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2920));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2920, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2920, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2921: symseed;
                    new tc'_2922: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2922), SK_63, r2_2921) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2922)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
              find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2923: symseed;
                    new tc_2924: timest;
                    let e5: maxmac = encsym(pad(C, tc_2924), AK_2839[@i_184], r7_2923) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2925: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2925));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2925, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2925, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2926: symseed;
                    new tc'_2927: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2927), SK_63, r2_2926) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2927)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2928: symseed;
                    new tc_2929: timest;
                    let e5: maxmac = encsym(pad(C, tc_2929), kgen(s3_1360[@i_184]), r7_2928) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2930: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2930));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2930, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2930, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2931: symseed;
                    new tc'_2932: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2932), SK_63, r2_2931) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2932)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2933: symseed;
                    new tc_2934: timest;
                    let e5: maxmac = encsym(pad(C, tc_2934), AK_2839[@i_184], r7_2933) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2935: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2935));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2935, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2935, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2936: symseed;
                    new tc'_2937: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2937), SK_63, r2_2936) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2937)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2938: symseed;
                    new tc_2939: timest;
                    let e5: maxmac = encsym(pad(C, tc_2939), kgen(s3_1360[@i_184]), r7_2938) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2940: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2940));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2940, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2940, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2941: symseed;
                    new tc'_2942: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2942), SK_63, r2_2941) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2942)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2943: symseed;
                    new tc_2944: timest;
                    let e5: maxmac = encsym(pad(C, tc_2944), AK_2839[@i_184], r7_2943) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2945: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2945));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2945, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2945, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2946: symseed;
                    new tc'_2947: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2947), SK_63, r2_2946) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2947)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2948: symseed;
                    new tc_2949: timest;
                    let e5: maxmac = encsym(pad(C, tc_2949), kgen(s3_1360[@i_184]), r7_2948) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2950: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2950));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2950, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2950, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2951: symseed;
                    new tc'_2952: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2952), SK_63, r2_2951) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2952)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2953: symseed;
                    new tc_2954: timest;
                    let e5: maxmac = encsym(pad(C, tc_2954), AK_2839[@i_184], r7_2953) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2955: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2955));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2955, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2955, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2956: symseed;
                    new tc'_2957: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2957), SK_63, r2_2956) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2957)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2958: symseed;
                    new tc_2959: timest;
                    let e5: maxmac = encsym(pad(C, tc_2959), kgen(s3_1360[@i_184]), r7_2958) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2960: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2960));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2960, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2960, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2961: symseed;
                    new tc'_2962: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2962), SK_63, r2_2961) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2962)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
              find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2963: symseed;
                    new tc_2964: timest;
                    let e5: maxmac = encsym(pad(C, tc_2964), AK_2839[@i_184], r7_2963) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2965: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2965));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2965, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2965, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2966: symseed;
                    new tc'_2967: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2967), SK_63, r2_2966) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2967)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2968: symseed;
                    new tc_2969: timest;
                    let e5: maxmac = encsym(pad(C, tc_2969), kgen(s3_1360[@i_184]), r7_2968) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2970: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2970));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2970, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2970, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2971: symseed;
                    new tc'_2972: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2972), SK_63, r2_2971) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2972)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2973: symseed;
                    new tc_2974: timest;
                    let e5: maxmac = encsym(pad(C, tc_2974), AK_2839[@i_184], r7_2973) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2975: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2975));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2975, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2975, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2976: symseed;
                    new tc'_2977: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2977), SK_63, r2_2976) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2977)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2978: symseed;
                    new tc_2979: timest;
                    let e5: maxmac = encsym(pad(C, tc_2979), kgen(s3_1360[@i_184]), r7_2978) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2980: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2980));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2980, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2980, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2981: symseed;
                    new tc'_2982: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2982), SK_63, r2_2981) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2982)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2983: symseed;
                    new tc_2984: timest;
                    let e5: maxmac = encsym(pad(C, tc_2984), AK_2839[@i_184], r7_2983) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2985: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2985));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2985, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2985, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2986: symseed;
                    new tc'_2987: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2987), SK_63, r2_2986) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2987)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2988: symseed;
                    new tc_2989: timest;
                    let e5: maxmac = encsym(pad(C, tc_2989), kgen(s3_1360[@i_184]), r7_2988) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2990: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2990));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2990, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2990, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2991: symseed;
                    new tc'_2992: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2992), SK_63, r2_2991) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2992)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2993: symseed;
                    new tc_2994: timest;
                    let e5: maxmac = encsym(pad(C, tc_2994), AK_2839[@i_184], r7_2993) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2995: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2995));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2995, tt_62: timest, =hostS)) = decsym(m7, AK_2839[@i_184]) in
                    event fullCT(hostT, hostS, n3_2995, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2996: symseed;
                    new tc'_2997: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2997), SK_63, r2_2996) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2997)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2998: symseed;
                    new tc_2999: timest;
                    let e5: maxmac = encsym(pad(C, tc_2999), kgen(s3_1360[@i_184]), r7_2998) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3000: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3000));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3000, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_3000, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3001: symseed;
                    new tc'_3002: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3002), SK_63, r2_3001) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3002)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
              find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3003: symseed;
                    new tc_3004: timest;
                    let e5: maxmac = encsym(pad(C, tc_3004), kgen(s3_1366[@i_183]), r7_3003) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3005: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3006: symseed;
                    new tc'_3007: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3008: symseed;
                    new tc_3009: timest;
                    let e5: maxmac = encsym(pad(C, tc_3009), kgen(s3_1372[@i_183]), r7_3008) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3010: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3010));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3010, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3010, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3011: symseed;
                    new tc'_3012: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3012), SK_63, r2_3011) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3012)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3013: symseed;
                    new tc_3014: timest;
                    let e5: maxmac = encsym(pad(C, tc_3014), kgen(s3_1366[@i_183]), r7_3013) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3015: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3015));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3015, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3015, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3016: symseed;
                    new tc'_3017: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3017), SK_63, r2_3016) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3017)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3018: symseed;
                    new tc_3019: timest;
                    let e5: maxmac = encsym(pad(C, tc_3019), kgen(s3_1372[@i_183]), r7_3018) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3020: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3020));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3020, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3020, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3021: symseed;
                    new tc'_3022: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3022), SK_63, r2_3021) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3022)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3023: symseed;
                    new tc_3024: timest;
                    let e5: maxmac = encsym(pad(C, tc_3024), kgen(s3_1366[@i_183]), r7_3023) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3025: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3025));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3025, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3025, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3026: symseed;
                    new tc'_3027: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3027), SK_63, r2_3026) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3027)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3028: symseed;
                    new tc_3029: timest;
                    let e5: maxmac = encsym(pad(C, tc_3029), kgen(s3_1372[@i_183]), r7_3028) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3030: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3030));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3030, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3030, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3031: symseed;
                    new tc'_3032: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3032), SK_63, r2_3031) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3032)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3033: symseed;
                    new tc_3034: timest;
                    let e5: maxmac = encsym(pad(C, tc_3034), kgen(s3_1366[@i_183]), r7_3033) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3035: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3035));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3035, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3035, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3036: symseed;
                    new tc'_3037: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3037), SK_63, r2_3036) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3037)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3038: symseed;
                    new tc_3039: timest;
                    let e5: maxmac = encsym(pad(C, tc_3039), kgen(s3_1372[@i_183]), r7_3038) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3040: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3040));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3040, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3040, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3041: symseed;
                    new tc'_3042: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3042), SK_63, r2_3041) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3042)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
              find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3043: symseed;
                    new tc_3044: timest;
                    let e5: maxmac = encsym(pad(C, tc_3044), kgen(s3_1366[@i_183]), r7_3043) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3045: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3045));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3045, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3045, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3046: symseed;
                    new tc'_3047: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3047), SK_63, r2_3046) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3047)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3048: symseed;
                    new tc_3049: timest;
                    let e5: maxmac = encsym(pad(C, tc_3049), kgen(s3_1372[@i_183]), r7_3048) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3050: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3050));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3050, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3050, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3051: symseed;
                    new tc'_3052: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3052), SK_63, r2_3051) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3052)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3053: symseed;
                    new tc_3054: timest;
                    let e5: maxmac = encsym(pad(C, tc_3054), kgen(s3_1366[@i_183]), r7_3053) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3055: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3055));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3055, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3055, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3056: symseed;
                    new tc'_3057: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3057), SK_63, r2_3056) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3057)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3058: symseed;
                    new tc_3059: timest;
                    let e5: maxmac = encsym(pad(C, tc_3059), kgen(s3_1372[@i_183]), r7_3058) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3060: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3060));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3060, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3060, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3061: symseed;
                    new tc'_3062: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3062), SK_63, r2_3061) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3062)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3063: symseed;
                    new tc_3064: timest;
                    let e5: maxmac = encsym(pad(C, tc_3064), kgen(s3_1366[@i_183]), r7_3063) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3065: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3065));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3065, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3065, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3066: symseed;
                    new tc'_3067: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3067), SK_63, r2_3066) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3067)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3068: symseed;
                    new tc_3069: timest;
                    let e5: maxmac = encsym(pad(C, tc_3069), kgen(s3_1372[@i_183]), r7_3068) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3070: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3070));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3070, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3070, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3071: symseed;
                    new tc'_3072: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3072), SK_63, r2_3071) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3072)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3073: symseed;
                    new tc_3074: timest;
                    let e5: maxmac = encsym(pad(C, tc_3074), kgen(s3_1366[@i_183]), r7_3073) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3075: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3075));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3075, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3075, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3076: symseed;
                    new tc'_3077: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3077), SK_63, r2_3076) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3077)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3078: symseed;
                    new tc_3079: timest;
                    let e5: maxmac = encsym(pad(C, tc_3079), kgen(s3_1372[@i_183]), r7_3078) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3080: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3080));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3080, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3080, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3081: symseed;
                    new tc'_3082: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3082), SK_63, r2_3081) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3082)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
              find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3083: symseed;
                    new tc_3084: timest;
                    let e5: maxmac = encsym(pad(C, tc_3084), kgen(s3_1366[@i_183]), r7_3083) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3085: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3085));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3085, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3085, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3086: symseed;
                    new tc'_3087: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3087), SK_63, r2_3086) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3087)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3088: symseed;
                    new tc_3089: timest;
                    let e5: maxmac = encsym(pad(C, tc_3089), kgen(s3_1372[@i_183]), r7_3088) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3090: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3090));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3090, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3090, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3091: symseed;
                    new tc'_3092: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3092), SK_63, r2_3091) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3092)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3093: symseed;
                    new tc_3094: timest;
                    let e5: maxmac = encsym(pad(C, tc_3094), kgen(s3_1366[@i_183]), r7_3093) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3095: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3095));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3095, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3095, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3096: symseed;
                    new tc'_3097: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3097), SK_63, r2_3096) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3097)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3098: symseed;
                    new tc_3099: timest;
                    let e5: maxmac = encsym(pad(C, tc_3099), kgen(s3_1372[@i_183]), r7_3098) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3100: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3100));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3100, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3100, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3101: symseed;
                    new tc'_3102: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3102), SK_63, r2_3101) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3102)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3103: symseed;
                    new tc_3104: timest;
                    let e5: maxmac = encsym(pad(C, tc_3104), kgen(s3_1366[@i_183]), r7_3103) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3105: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3105));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3105, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3105, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3106: symseed;
                    new tc'_3107: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3107), SK_63, r2_3106) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3107)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3108: symseed;
                    new tc_3109: timest;
                    let e5: maxmac = encsym(pad(C, tc_3109), kgen(s3_1372[@i_183]), r7_3108) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3110: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3110));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3110, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3110, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3111: symseed;
                    new tc'_3112: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3112), SK_63, r2_3111) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3112)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3113: symseed;
                    new tc_3114: timest;
                    let e5: maxmac = encsym(pad(C, tc_3114), kgen(s3_1366[@i_183]), r7_3113) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3115: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3115));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3115, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3115, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3116: symseed;
                    new tc'_3117: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3117), SK_63, r2_3116) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3117)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3118: symseed;
                    new tc_3119: timest;
                    let e5: maxmac = encsym(pad(C, tc_3119), kgen(s3_1372[@i_183]), r7_3118) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3120: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3120));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3120, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3120, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3121: symseed;
                    new tc'_3122: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3122), SK_63, r2_3121) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3122)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
              find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3123: symseed;
                    new tc_3124: timest;
                    let e5: maxmac = encsym(pad(C, tc_3124), kgen(s3_1366[@i_183]), r7_3123) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3125: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3125));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3125, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3125, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3126: symseed;
                    new tc'_3127: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3127), SK_63, r2_3126) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3127)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3128: symseed;
                    new tc_3129: timest;
                    let e5: maxmac = encsym(pad(C, tc_3129), kgen(s3_1372[@i_183]), r7_3128) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3130: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3130));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3130, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3130, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3131: symseed;
                    new tc'_3132: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3132), SK_63, r2_3131) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3132)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3133: symseed;
                    new tc_3134: timest;
                    let e5: maxmac = encsym(pad(C, tc_3134), kgen(s3_1366[@i_183]), r7_3133) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3135: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3135));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3135, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3135, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3136: symseed;
                    new tc'_3137: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3137), SK_63, r2_3136) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3137)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3138: symseed;
                    new tc_3139: timest;
                    let e5: maxmac = encsym(pad(C, tc_3139), kgen(s3_1372[@i_183]), r7_3138) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3140: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3140));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3140, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3140, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3141: symseed;
                    new tc'_3142: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3142), SK_63, r2_3141) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3142)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3143: symseed;
                    new tc_3144: timest;
                    let e5: maxmac = encsym(pad(C, tc_3144), kgen(s3_1366[@i_183]), r7_3143) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3145: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3145));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3145, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3145, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3146: symseed;
                    new tc'_3147: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3147), SK_63, r2_3146) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3147)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3148: symseed;
                    new tc_3149: timest;
                    let e5: maxmac = encsym(pad(C, tc_3149), kgen(s3_1372[@i_183]), r7_3148) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3150: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3150));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3150, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3150, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3151: symseed;
                    new tc'_3152: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3152), SK_63, r2_3151) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3152)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3153: symseed;
                    new tc_3154: timest;
                    let e5: maxmac = encsym(pad(C, tc_3154), kgen(s3_1366[@i_183]), r7_3153) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3155: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3155));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3155, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3155, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3156: symseed;
                    new tc'_3157: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3157), SK_63, r2_3156) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3157)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3158: symseed;
                    new tc_3159: timest;
                    let e5: maxmac = encsym(pad(C, tc_3159), kgen(s3_1372[@i_183]), r7_3158) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3160: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3160));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3160, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3160, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3161: symseed;
                    new tc'_3162: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3162), SK_63, r2_3161) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3162)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = kgen(s3_1354) in
              new r4_1355: symseed;
              new tk_1356: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new s_1357: symkeyseed;
              new r5_1358: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = cst_key in
              new tk_1362: timest;
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new s_1363: symkeyseed;
              new r5_1364: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = cst_key in
              new r4_1367: symseed;
              new tk_1368: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new s_1369: symkeyseed;
              new r5_1370: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new tk_1374: timest;
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new s_1375: symkeyseed;
              new r5_1376: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(s3_1360[@i_1385], AK_2840[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          let injbot2(pad(=hostY_53[@i_1385], ts: timest)) = decsym(m9, kgen(s3_1360[@i_1385])) in
          event partTC(hostY_53[@i_1385], m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
            new rSK_1419: symkeyseed;
            let SK_50: key = kgen(rSK_1419) in
            new r10_1421: symseed;
            new tt_1420: timest;
            let e10: maxmac = encsym(concat5(SK_50, tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
            new r11_1422: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1420, hostW_46), kgen(s3_1360[@i_1385]), r11_1422) in
            event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, e11);
            out(c8[!_39], (hostY_53[@i_1385], e10, e11, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
            new rSK_1423: symkeyseed;
            let SK_50: key = kgen(rSK_1423) in
            new r10_1424: symseed;
            let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
            new tt_1426: timest;
            new r11_1425: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1426, hostW_46), kgen(s3_1360[@i_1385]), r11_1425) in
            event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, e11);
            out(c8[!_39], (hostY_53[@i_1385], z_1150, e11, acceptT(hostY_53[@i_1385], hostW_46)))
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], AK_2842[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          let injbot2(pad(=hostY_53[@i_1384], ts: timest)) = decsym(m9, kgen(s3_1372[@i_1384])) in
          event partTC(hostY_53[@i_1384], m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
            new rSK_1427: symkeyseed;
            let SK_50: key = kgen(rSK_1427) in
            new r10_1429: symseed;
            new tt_1428: timest;
            let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
            new r11_1430: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1428, hostW_46), kgen(s3_1372[@i_1384]), r11_1430) in
            event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, e11);
            out(c8[!_39], (hostY_53[@i_1384], e10, e11, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
            new rSK_1431: symkeyseed;
            let SK_50: key = kgen(rSK_1431) in
            new r10_1432: symseed;
            let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
            new tt_1434: timest;
            new r11_1433: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1434, hostW_46), kgen(s3_1372[@i_1384]), r11_1433) in
            event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, e11);
            out(c8[!_39], (hostY_53[@i_1384], z_1150, e11, acceptT(hostY_53[@i_1384], hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying remove assignments of binder AK_2839 yields

Game 89 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKt: symkeyseed;
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
              find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2843: symseed;
                    new tc_2844: timest;
                    let e5: maxmac = encsym(pad(C, tc_2844), kgen(s3_1354[@i_184]), r7_2843) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2845: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
                    event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2846: symseed;
                    new tc'_2847: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2848: symseed;
                    new tc_2849: timest;
                    let e5: maxmac = encsym(pad(C, tc_2849), kgen(s3_1360[@i_184]), r7_2848) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2850: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2850));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2850, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2850, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2851: symseed;
                    new tc'_2852: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2852), SK_63, r2_2851) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2852)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2853: symseed;
                    new tc_2854: timest;
                    let e5: maxmac = encsym(pad(C, tc_2854), kgen(s3_1354[@i_184]), r7_2853) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2855: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2855));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2855, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
                    event fullCT(hostT, hostS, n3_2855, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2856: symseed;
                    new tc'_2857: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2857), SK_63, r2_2856) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2857)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2858: symseed;
                    new tc_2859: timest;
                    let e5: maxmac = encsym(pad(C, tc_2859), kgen(s3_1360[@i_184]), r7_2858) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2860: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2860));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2860, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2860, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2861: symseed;
                    new tc'_2862: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2862), SK_63, r2_2861) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2862)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2863: symseed;
                    new tc_2864: timest;
                    let e5: maxmac = encsym(pad(C, tc_2864), kgen(s3_1354[@i_184]), r7_2863) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2865: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2865));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2865, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
                    event fullCT(hostT, hostS, n3_2865, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2866: symseed;
                    new tc'_2867: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2867), SK_63, r2_2866) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2867)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2868: symseed;
                    new tc_2869: timest;
                    let e5: maxmac = encsym(pad(C, tc_2869), kgen(s3_1360[@i_184]), r7_2868) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2870: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2870));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2870, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2870, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2871: symseed;
                    new tc'_2872: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2872), SK_63, r2_2871) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2872)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2873: symseed;
                    new tc_2874: timest;
                    let e5: maxmac = encsym(pad(C, tc_2874), kgen(s3_1354[@i_184]), r7_2873) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2875: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2875));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2875, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
                    event fullCT(hostT, hostS, n3_2875, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2876: symseed;
                    new tc'_2877: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2877), SK_63, r2_2876) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2877)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2878: symseed;
                    new tc_2879: timest;
                    let e5: maxmac = encsym(pad(C, tc_2879), kgen(s3_1360[@i_184]), r7_2878) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2880: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2880));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2880, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2880, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2881: symseed;
                    new tc'_2882: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2882), SK_63, r2_2881) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2882)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
              find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2883: symseed;
                    new tc_2884: timest;
                    let e5: maxmac = encsym(pad(C, tc_2884), kgen(s3_1354[@i_184]), r7_2883) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2885: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2885));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2885, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
                    event fullCT(hostT, hostS, n3_2885, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2886: symseed;
                    new tc'_2887: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2887), SK_63, r2_2886) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2887)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2888: symseed;
                    new tc_2889: timest;
                    let e5: maxmac = encsym(pad(C, tc_2889), kgen(s3_1360[@i_184]), r7_2888) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2890: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2890));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2890, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2890, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2891: symseed;
                    new tc'_2892: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2892), SK_63, r2_2891) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2892)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2893: symseed;
                    new tc_2894: timest;
                    let e5: maxmac = encsym(pad(C, tc_2894), kgen(s3_1354[@i_184]), r7_2893) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2895: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2895));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2895, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
                    event fullCT(hostT, hostS, n3_2895, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2896: symseed;
                    new tc'_2897: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2897), SK_63, r2_2896) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2897)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2898: symseed;
                    new tc_2899: timest;
                    let e5: maxmac = encsym(pad(C, tc_2899), kgen(s3_1360[@i_184]), r7_2898) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2900: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2900));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2900, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2900, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2901: symseed;
                    new tc'_2902: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2902), SK_63, r2_2901) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2902)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2903: symseed;
                    new tc_2904: timest;
                    let e5: maxmac = encsym(pad(C, tc_2904), kgen(s3_1354[@i_184]), r7_2903) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2905: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2905));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2905, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
                    event fullCT(hostT, hostS, n3_2905, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2906: symseed;
                    new tc'_2907: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2907), SK_63, r2_2906) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2907)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2908: symseed;
                    new tc_2909: timest;
                    let e5: maxmac = encsym(pad(C, tc_2909), kgen(s3_1360[@i_184]), r7_2908) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2910: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2910));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2910, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2910, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2911: symseed;
                    new tc'_2912: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2912), SK_63, r2_2911) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2912)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2913: symseed;
                    new tc_2914: timest;
                    let e5: maxmac = encsym(pad(C, tc_2914), kgen(s3_1354[@i_184]), r7_2913) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2915: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2915));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2915, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
                    event fullCT(hostT, hostS, n3_2915, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2916: symseed;
                    new tc'_2917: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2917), SK_63, r2_2916) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2917)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2918: symseed;
                    new tc_2919: timest;
                    let e5: maxmac = encsym(pad(C, tc_2919), kgen(s3_1360[@i_184]), r7_2918) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2920: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2920));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2920, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2920, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2921: symseed;
                    new tc'_2922: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2922), SK_63, r2_2921) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2922)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
              find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2923: symseed;
                    new tc_2924: timest;
                    let e5: maxmac = encsym(pad(C, tc_2924), kgen(s3_1354[@i_184]), r7_2923) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2925: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2925));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2925, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
                    event fullCT(hostT, hostS, n3_2925, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2926: symseed;
                    new tc'_2927: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2927), SK_63, r2_2926) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2927)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2928: symseed;
                    new tc_2929: timest;
                    let e5: maxmac = encsym(pad(C, tc_2929), kgen(s3_1360[@i_184]), r7_2928) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2930: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2930));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2930, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2930, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2931: symseed;
                    new tc'_2932: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2932), SK_63, r2_2931) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2932)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2933: symseed;
                    new tc_2934: timest;
                    let e5: maxmac = encsym(pad(C, tc_2934), kgen(s3_1354[@i_184]), r7_2933) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2935: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2935));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2935, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
                    event fullCT(hostT, hostS, n3_2935, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2936: symseed;
                    new tc'_2937: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2937), SK_63, r2_2936) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2937)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2938: symseed;
                    new tc_2939: timest;
                    let e5: maxmac = encsym(pad(C, tc_2939), kgen(s3_1360[@i_184]), r7_2938) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2940: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2940));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2940, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2940, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2941: symseed;
                    new tc'_2942: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2942), SK_63, r2_2941) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2942)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2943: symseed;
                    new tc_2944: timest;
                    let e5: maxmac = encsym(pad(C, tc_2944), kgen(s3_1354[@i_184]), r7_2943) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2945: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2945));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2945, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
                    event fullCT(hostT, hostS, n3_2945, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2946: symseed;
                    new tc'_2947: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2947), SK_63, r2_2946) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2947)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2948: symseed;
                    new tc_2949: timest;
                    let e5: maxmac = encsym(pad(C, tc_2949), kgen(s3_1360[@i_184]), r7_2948) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2950: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2950));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2950, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2950, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2951: symseed;
                    new tc'_2952: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2952), SK_63, r2_2951) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2952)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2953: symseed;
                    new tc_2954: timest;
                    let e5: maxmac = encsym(pad(C, tc_2954), kgen(s3_1354[@i_184]), r7_2953) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2955: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2955));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2955, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
                    event fullCT(hostT, hostS, n3_2955, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2956: symseed;
                    new tc'_2957: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2957), SK_63, r2_2956) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2957)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2958: symseed;
                    new tc_2959: timest;
                    let e5: maxmac = encsym(pad(C, tc_2959), kgen(s3_1360[@i_184]), r7_2958) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2960: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2960));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2960, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2960, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2961: symseed;
                    new tc'_2962: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2962), SK_63, r2_2961) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2962)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
              find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2963: symseed;
                    new tc_2964: timest;
                    let e5: maxmac = encsym(pad(C, tc_2964), kgen(s3_1354[@i_184]), r7_2963) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2965: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2965));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2965, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
                    event fullCT(hostT, hostS, n3_2965, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2966: symseed;
                    new tc'_2967: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2967), SK_63, r2_2966) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2967)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2968: symseed;
                    new tc_2969: timest;
                    let e5: maxmac = encsym(pad(C, tc_2969), kgen(s3_1360[@i_184]), r7_2968) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2970: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2970));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2970, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2970, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2971: symseed;
                    new tc'_2972: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2972), SK_63, r2_2971) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2972)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2973: symseed;
                    new tc_2974: timest;
                    let e5: maxmac = encsym(pad(C, tc_2974), kgen(s3_1354[@i_184]), r7_2973) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2975: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2975));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2975, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
                    event fullCT(hostT, hostS, n3_2975, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2976: symseed;
                    new tc'_2977: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2977), SK_63, r2_2976) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2977)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2978: symseed;
                    new tc_2979: timest;
                    let e5: maxmac = encsym(pad(C, tc_2979), kgen(s3_1360[@i_184]), r7_2978) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2980: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2980));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2980, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2980, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2981: symseed;
                    new tc'_2982: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2982), SK_63, r2_2981) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2982)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2983: symseed;
                    new tc_2984: timest;
                    let e5: maxmac = encsym(pad(C, tc_2984), kgen(s3_1354[@i_184]), r7_2983) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2985: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2985));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2985, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
                    event fullCT(hostT, hostS, n3_2985, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2986: symseed;
                    new tc'_2987: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2987), SK_63, r2_2986) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2987)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2988: symseed;
                    new tc_2989: timest;
                    let e5: maxmac = encsym(pad(C, tc_2989), kgen(s3_1360[@i_184]), r7_2988) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2990: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2990));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2990, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2990, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2991: symseed;
                    new tc'_2992: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2992), SK_63, r2_2991) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2992)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2993: symseed;
                    new tc_2994: timest;
                    let e5: maxmac = encsym(pad(C, tc_2994), kgen(s3_1354[@i_184]), r7_2993) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2995: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2995));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2995, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
                    event fullCT(hostT, hostS, n3_2995, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2996: symseed;
                    new tc'_2997: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2997), SK_63, r2_2996) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2997)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2998: symseed;
                    new tc_2999: timest;
                    let e5: maxmac = encsym(pad(C, tc_2999), kgen(s3_1360[@i_184]), r7_2998) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3000: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3000));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3000, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_3000, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3001: symseed;
                    new tc'_3002: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3002), SK_63, r2_3001) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3002)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
              find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3003: symseed;
                    new tc_3004: timest;
                    let e5: maxmac = encsym(pad(C, tc_3004), kgen(s3_1366[@i_183]), r7_3003) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3005: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3006: symseed;
                    new tc'_3007: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3008: symseed;
                    new tc_3009: timest;
                    let e5: maxmac = encsym(pad(C, tc_3009), kgen(s3_1372[@i_183]), r7_3008) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3010: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3010));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3010, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3010, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3011: symseed;
                    new tc'_3012: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3012), SK_63, r2_3011) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3012)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3013: symseed;
                    new tc_3014: timest;
                    let e5: maxmac = encsym(pad(C, tc_3014), kgen(s3_1366[@i_183]), r7_3013) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3015: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3015));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3015, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3015, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3016: symseed;
                    new tc'_3017: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3017), SK_63, r2_3016) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3017)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3018: symseed;
                    new tc_3019: timest;
                    let e5: maxmac = encsym(pad(C, tc_3019), kgen(s3_1372[@i_183]), r7_3018) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3020: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3020));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3020, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3020, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3021: symseed;
                    new tc'_3022: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3022), SK_63, r2_3021) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3022)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3023: symseed;
                    new tc_3024: timest;
                    let e5: maxmac = encsym(pad(C, tc_3024), kgen(s3_1366[@i_183]), r7_3023) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3025: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3025));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3025, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3025, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3026: symseed;
                    new tc'_3027: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3027), SK_63, r2_3026) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3027)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3028: symseed;
                    new tc_3029: timest;
                    let e5: maxmac = encsym(pad(C, tc_3029), kgen(s3_1372[@i_183]), r7_3028) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3030: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3030));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3030, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3030, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3031: symseed;
                    new tc'_3032: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3032), SK_63, r2_3031) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3032)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3033: symseed;
                    new tc_3034: timest;
                    let e5: maxmac = encsym(pad(C, tc_3034), kgen(s3_1366[@i_183]), r7_3033) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3035: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3035));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3035, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3035, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3036: symseed;
                    new tc'_3037: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3037), SK_63, r2_3036) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3037)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3038: symseed;
                    new tc_3039: timest;
                    let e5: maxmac = encsym(pad(C, tc_3039), kgen(s3_1372[@i_183]), r7_3038) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3040: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3040));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3040, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3040, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3041: symseed;
                    new tc'_3042: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3042), SK_63, r2_3041) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3042)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
              find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3043: symseed;
                    new tc_3044: timest;
                    let e5: maxmac = encsym(pad(C, tc_3044), kgen(s3_1366[@i_183]), r7_3043) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3045: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3045));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3045, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3045, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3046: symseed;
                    new tc'_3047: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3047), SK_63, r2_3046) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3047)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3048: symseed;
                    new tc_3049: timest;
                    let e5: maxmac = encsym(pad(C, tc_3049), kgen(s3_1372[@i_183]), r7_3048) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3050: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3050));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3050, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3050, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3051: symseed;
                    new tc'_3052: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3052), SK_63, r2_3051) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3052)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3053: symseed;
                    new tc_3054: timest;
                    let e5: maxmac = encsym(pad(C, tc_3054), kgen(s3_1366[@i_183]), r7_3053) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3055: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3055));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3055, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3055, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3056: symseed;
                    new tc'_3057: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3057), SK_63, r2_3056) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3057)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3058: symseed;
                    new tc_3059: timest;
                    let e5: maxmac = encsym(pad(C, tc_3059), kgen(s3_1372[@i_183]), r7_3058) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3060: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3060));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3060, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3060, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3061: symseed;
                    new tc'_3062: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3062), SK_63, r2_3061) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3062)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3063: symseed;
                    new tc_3064: timest;
                    let e5: maxmac = encsym(pad(C, tc_3064), kgen(s3_1366[@i_183]), r7_3063) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3065: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3065));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3065, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3065, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3066: symseed;
                    new tc'_3067: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3067), SK_63, r2_3066) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3067)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3068: symseed;
                    new tc_3069: timest;
                    let e5: maxmac = encsym(pad(C, tc_3069), kgen(s3_1372[@i_183]), r7_3068) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3070: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3070));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3070, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3070, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3071: symseed;
                    new tc'_3072: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3072), SK_63, r2_3071) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3072)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3073: symseed;
                    new tc_3074: timest;
                    let e5: maxmac = encsym(pad(C, tc_3074), kgen(s3_1366[@i_183]), r7_3073) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3075: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3075));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3075, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3075, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3076: symseed;
                    new tc'_3077: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3077), SK_63, r2_3076) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3077)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3078: symseed;
                    new tc_3079: timest;
                    let e5: maxmac = encsym(pad(C, tc_3079), kgen(s3_1372[@i_183]), r7_3078) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3080: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3080));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3080, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3080, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3081: symseed;
                    new tc'_3082: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3082), SK_63, r2_3081) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3082)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
              find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3083: symseed;
                    new tc_3084: timest;
                    let e5: maxmac = encsym(pad(C, tc_3084), kgen(s3_1366[@i_183]), r7_3083) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3085: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3085));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3085, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3085, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3086: symseed;
                    new tc'_3087: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3087), SK_63, r2_3086) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3087)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3088: symseed;
                    new tc_3089: timest;
                    let e5: maxmac = encsym(pad(C, tc_3089), kgen(s3_1372[@i_183]), r7_3088) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3090: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3090));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3090, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3090, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3091: symseed;
                    new tc'_3092: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3092), SK_63, r2_3091) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3092)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3093: symseed;
                    new tc_3094: timest;
                    let e5: maxmac = encsym(pad(C, tc_3094), kgen(s3_1366[@i_183]), r7_3093) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3095: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3095));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3095, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3095, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3096: symseed;
                    new tc'_3097: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3097), SK_63, r2_3096) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3097)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3098: symseed;
                    new tc_3099: timest;
                    let e5: maxmac = encsym(pad(C, tc_3099), kgen(s3_1372[@i_183]), r7_3098) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3100: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3100));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3100, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3100, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3101: symseed;
                    new tc'_3102: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3102), SK_63, r2_3101) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3102)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3103: symseed;
                    new tc_3104: timest;
                    let e5: maxmac = encsym(pad(C, tc_3104), kgen(s3_1366[@i_183]), r7_3103) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3105: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3105));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3105, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3105, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3106: symseed;
                    new tc'_3107: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3107), SK_63, r2_3106) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3107)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3108: symseed;
                    new tc_3109: timest;
                    let e5: maxmac = encsym(pad(C, tc_3109), kgen(s3_1372[@i_183]), r7_3108) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3110: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3110));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3110, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3110, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3111: symseed;
                    new tc'_3112: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3112), SK_63, r2_3111) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3112)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3113: symseed;
                    new tc_3114: timest;
                    let e5: maxmac = encsym(pad(C, tc_3114), kgen(s3_1366[@i_183]), r7_3113) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3115: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3115));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3115, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3115, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3116: symseed;
                    new tc'_3117: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3117), SK_63, r2_3116) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3117)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3118: symseed;
                    new tc_3119: timest;
                    let e5: maxmac = encsym(pad(C, tc_3119), kgen(s3_1372[@i_183]), r7_3118) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3120: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3120));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3120, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3120, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3121: symseed;
                    new tc'_3122: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3122), SK_63, r2_3121) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3122)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
              find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3123: symseed;
                    new tc_3124: timest;
                    let e5: maxmac = encsym(pad(C, tc_3124), kgen(s3_1366[@i_183]), r7_3123) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3125: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3125));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3125, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3125, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3126: symseed;
                    new tc'_3127: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3127), SK_63, r2_3126) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3127)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3128: symseed;
                    new tc_3129: timest;
                    let e5: maxmac = encsym(pad(C, tc_3129), kgen(s3_1372[@i_183]), r7_3128) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3130: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3130));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3130, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3130, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3131: symseed;
                    new tc'_3132: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3132), SK_63, r2_3131) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3132)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3133: symseed;
                    new tc_3134: timest;
                    let e5: maxmac = encsym(pad(C, tc_3134), kgen(s3_1366[@i_183]), r7_3133) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3135: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3135));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3135, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3135, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3136: symseed;
                    new tc'_3137: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3137), SK_63, r2_3136) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3137)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3138: symseed;
                    new tc_3139: timest;
                    let e5: maxmac = encsym(pad(C, tc_3139), kgen(s3_1372[@i_183]), r7_3138) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3140: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3140));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3140, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3140, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3141: symseed;
                    new tc'_3142: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3142), SK_63, r2_3141) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3142)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3143: symseed;
                    new tc_3144: timest;
                    let e5: maxmac = encsym(pad(C, tc_3144), kgen(s3_1366[@i_183]), r7_3143) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3145: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3145));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3145, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3145, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3146: symseed;
                    new tc'_3147: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3147), SK_63, r2_3146) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3147)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3148: symseed;
                    new tc_3149: timest;
                    let e5: maxmac = encsym(pad(C, tc_3149), kgen(s3_1372[@i_183]), r7_3148) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3150: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3150));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3150, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3150, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3151: symseed;
                    new tc'_3152: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3152), SK_63, r2_3151) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3152)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3153: symseed;
                    new tc_3154: timest;
                    let e5: maxmac = encsym(pad(C, tc_3154), kgen(s3_1366[@i_183]), r7_3153) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3155: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3155));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3155, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3155, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3156: symseed;
                    new tc'_3157: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3157), SK_63, r2_3156) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3157)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3158: symseed;
                    new tc_3159: timest;
                    let e5: maxmac = encsym(pad(C, tc_3159), kgen(s3_1372[@i_183]), r7_3158) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3160: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3160));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3160, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1372[@i_183])) in
                    event fullCT(hostT, hostS, n3_3160, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3161: symseed;
                    new tc'_3162: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3162), SK_63, r2_3161) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3162)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = cst_key in
              new r4_1355: symseed;
              new tk_1356: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new s_1357: symkeyseed;
              new r5_1358: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = cst_key in
              new tk_1362: timest;
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new s_1363: symkeyseed;
              new r5_1364: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = cst_key in
              new r4_1367: symseed;
              new tk_1368: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new s_1369: symkeyseed;
              new r5_1370: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new tk_1374: timest;
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new s_1375: symkeyseed;
              new r5_1376: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(s3_1360[@i_1385], AK_2840[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          let injbot2(pad(=hostY_53[@i_1385], ts: timest)) = decsym(m9, kgen(s3_1360[@i_1385])) in
          event partTC(hostY_53[@i_1385], m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
            new rSK_1419: symkeyseed;
            let SK_50: key = kgen(rSK_1419) in
            new r10_1421: symseed;
            new tt_1420: timest;
            let e10: maxmac = encsym(concat5(SK_50, tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
            new r11_1422: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1420, hostW_46), kgen(s3_1360[@i_1385]), r11_1422) in
            event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, e11);
            out(c8[!_39], (hostY_53[@i_1385], e10, e11, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
            new rSK_1423: symkeyseed;
            let SK_50: key = kgen(rSK_1423) in
            new r10_1424: symseed;
            let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
            new tt_1426: timest;
            new r11_1425: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1426, hostW_46), kgen(s3_1360[@i_1385]), r11_1425) in
            event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, e11);
            out(c8[!_39], (hostY_53[@i_1385], z_1150, e11, acceptT(hostY_53[@i_1385], hostW_46)))
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], AK_2842[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          let injbot2(pad(=hostY_53[@i_1384], ts: timest)) = decsym(m9, kgen(s3_1372[@i_1384])) in
          event partTC(hostY_53[@i_1384], m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
            new rSK_1427: symkeyseed;
            let SK_50: key = kgen(rSK_1427) in
            new r10_1429: symseed;
            new tt_1428: timest;
            let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
            new r11_1430: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1428, hostW_46), kgen(s3_1372[@i_1384]), r11_1430) in
            event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, e11);
            out(c8[!_39], (hostY_53[@i_1384], e10, e11, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
            new rSK_1431: symkeyseed;
            let SK_50: key = kgen(rSK_1431) in
            new r10_1432: symseed;
            let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
            new tt_1434: timest;
            new r11_1433: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1434, hostW_46), kgen(s3_1372[@i_1384]), r11_1433) in
            event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, e11);
            out(c8[!_39], (hostY_53[@i_1384], z_1150, e11, acceptT(hostY_53[@i_1384], hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with r11_1433 [Difference of probability N * Pencctxt(time + time(context for game 89), N + N3 * N, N + N3 * N)] yields

Game 90 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKt: symkeyseed;
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
              find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2843: symseed;
                    new tc_2844: timest;
                    let e5: maxmac = encsym(pad(C, tc_2844), kgen(s3_1354[@i_184]), r7_2843) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2845: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
                    event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2846: symseed;
                    new tc'_2847: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2848: symseed;
                    new tc_2849: timest;
                    let e5: maxmac = encsym(pad(C, tc_2849), kgen(s3_1360[@i_184]), r7_2848) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2850: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2850));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2850, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2850, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2851: symseed;
                    new tc'_2852: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2852), SK_63, r2_2851) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2852)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2853: symseed;
                    new tc_2854: timest;
                    let e5: maxmac = encsym(pad(C, tc_2854), kgen(s3_1354[@i_184]), r7_2853) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2855: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2855));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2855, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
                    event fullCT(hostT, hostS, n3_2855, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2856: symseed;
                    new tc'_2857: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2857), SK_63, r2_2856) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2857)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2858: symseed;
                    new tc_2859: timest;
                    let e5: maxmac = encsym(pad(C, tc_2859), kgen(s3_1360[@i_184]), r7_2858) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2860: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2860));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2860, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2860, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2861: symseed;
                    new tc'_2862: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2862), SK_63, r2_2861) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2862)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2863: symseed;
                    new tc_2864: timest;
                    let e5: maxmac = encsym(pad(C, tc_2864), kgen(s3_1354[@i_184]), r7_2863) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2865: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2865));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2865, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
                    event fullCT(hostT, hostS, n3_2865, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2866: symseed;
                    new tc'_2867: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2867), SK_63, r2_2866) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2867)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2868: symseed;
                    new tc_2869: timest;
                    let e5: maxmac = encsym(pad(C, tc_2869), kgen(s3_1360[@i_184]), r7_2868) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2870: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2870));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2870, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2870, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2871: symseed;
                    new tc'_2872: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2872), SK_63, r2_2871) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2872)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2873: symseed;
                    new tc_2874: timest;
                    let e5: maxmac = encsym(pad(C, tc_2874), kgen(s3_1354[@i_184]), r7_2873) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2875: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2875));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2875, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
                    event fullCT(hostT, hostS, n3_2875, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2876: symseed;
                    new tc'_2877: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2877), SK_63, r2_2876) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2877)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2878: symseed;
                    new tc_2879: timest;
                    let e5: maxmac = encsym(pad(C, tc_2879), kgen(s3_1360[@i_184]), r7_2878) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2880: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2880));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2880, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2880, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2881: symseed;
                    new tc'_2882: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2882), SK_63, r2_2881) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2882)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
              find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2883: symseed;
                    new tc_2884: timest;
                    let e5: maxmac = encsym(pad(C, tc_2884), kgen(s3_1354[@i_184]), r7_2883) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2885: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2885));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2885, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
                    event fullCT(hostT, hostS, n3_2885, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2886: symseed;
                    new tc'_2887: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2887), SK_63, r2_2886) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2887)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2888: symseed;
                    new tc_2889: timest;
                    let e5: maxmac = encsym(pad(C, tc_2889), kgen(s3_1360[@i_184]), r7_2888) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2890: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2890));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2890, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2890, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2891: symseed;
                    new tc'_2892: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2892), SK_63, r2_2891) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2892)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2893: symseed;
                    new tc_2894: timest;
                    let e5: maxmac = encsym(pad(C, tc_2894), kgen(s3_1354[@i_184]), r7_2893) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2895: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2895));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2895, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
                    event fullCT(hostT, hostS, n3_2895, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2896: symseed;
                    new tc'_2897: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2897), SK_63, r2_2896) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2897)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2898: symseed;
                    new tc_2899: timest;
                    let e5: maxmac = encsym(pad(C, tc_2899), kgen(s3_1360[@i_184]), r7_2898) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2900: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2900));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2900, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2900, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2901: symseed;
                    new tc'_2902: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2902), SK_63, r2_2901) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2902)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2903: symseed;
                    new tc_2904: timest;
                    let e5: maxmac = encsym(pad(C, tc_2904), kgen(s3_1354[@i_184]), r7_2903) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2905: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2905));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2905, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
                    event fullCT(hostT, hostS, n3_2905, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2906: symseed;
                    new tc'_2907: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2907), SK_63, r2_2906) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2907)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2908: symseed;
                    new tc_2909: timest;
                    let e5: maxmac = encsym(pad(C, tc_2909), kgen(s3_1360[@i_184]), r7_2908) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2910: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2910));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2910, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2910, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2911: symseed;
                    new tc'_2912: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2912), SK_63, r2_2911) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2912)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2913: symseed;
                    new tc_2914: timest;
                    let e5: maxmac = encsym(pad(C, tc_2914), kgen(s3_1354[@i_184]), r7_2913) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2915: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2915));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2915, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
                    event fullCT(hostT, hostS, n3_2915, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2916: symseed;
                    new tc'_2917: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2917), SK_63, r2_2916) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2917)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2918: symseed;
                    new tc_2919: timest;
                    let e5: maxmac = encsym(pad(C, tc_2919), kgen(s3_1360[@i_184]), r7_2918) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2920: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2920));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2920, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2920, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2921: symseed;
                    new tc'_2922: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2922), SK_63, r2_2921) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2922)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
              find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2923: symseed;
                    new tc_2924: timest;
                    let e5: maxmac = encsym(pad(C, tc_2924), kgen(s3_1354[@i_184]), r7_2923) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2925: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2925));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2925, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
                    event fullCT(hostT, hostS, n3_2925, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2926: symseed;
                    new tc'_2927: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2927), SK_63, r2_2926) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2927)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2928: symseed;
                    new tc_2929: timest;
                    let e5: maxmac = encsym(pad(C, tc_2929), kgen(s3_1360[@i_184]), r7_2928) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2930: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2930));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2930, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2930, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2931: symseed;
                    new tc'_2932: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2932), SK_63, r2_2931) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2932)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2933: symseed;
                    new tc_2934: timest;
                    let e5: maxmac = encsym(pad(C, tc_2934), kgen(s3_1354[@i_184]), r7_2933) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2935: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2935));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2935, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
                    event fullCT(hostT, hostS, n3_2935, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2936: symseed;
                    new tc'_2937: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2937), SK_63, r2_2936) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2937)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2938: symseed;
                    new tc_2939: timest;
                    let e5: maxmac = encsym(pad(C, tc_2939), kgen(s3_1360[@i_184]), r7_2938) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2940: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2940));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2940, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2940, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2941: symseed;
                    new tc'_2942: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2942), SK_63, r2_2941) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2942)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2943: symseed;
                    new tc_2944: timest;
                    let e5: maxmac = encsym(pad(C, tc_2944), kgen(s3_1354[@i_184]), r7_2943) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2945: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2945));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2945, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
                    event fullCT(hostT, hostS, n3_2945, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2946: symseed;
                    new tc'_2947: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2947), SK_63, r2_2946) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2947)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2948: symseed;
                    new tc_2949: timest;
                    let e5: maxmac = encsym(pad(C, tc_2949), kgen(s3_1360[@i_184]), r7_2948) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2950: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2950));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2950, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2950, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2951: symseed;
                    new tc'_2952: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2952), SK_63, r2_2951) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2952)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2953: symseed;
                    new tc_2954: timest;
                    let e5: maxmac = encsym(pad(C, tc_2954), kgen(s3_1354[@i_184]), r7_2953) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2955: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2955));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2955, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
                    event fullCT(hostT, hostS, n3_2955, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2956: symseed;
                    new tc'_2957: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2957), SK_63, r2_2956) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2957)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2958: symseed;
                    new tc_2959: timest;
                    let e5: maxmac = encsym(pad(C, tc_2959), kgen(s3_1360[@i_184]), r7_2958) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2960: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2960));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2960, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2960, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2961: symseed;
                    new tc'_2962: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2962), SK_63, r2_2961) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2962)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
              find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2963: symseed;
                    new tc_2964: timest;
                    let e5: maxmac = encsym(pad(C, tc_2964), kgen(s3_1354[@i_184]), r7_2963) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2965: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2965));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2965, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
                    event fullCT(hostT, hostS, n3_2965, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2966: symseed;
                    new tc'_2967: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2967), SK_63, r2_2966) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2967)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2968: symseed;
                    new tc_2969: timest;
                    let e5: maxmac = encsym(pad(C, tc_2969), kgen(s3_1360[@i_184]), r7_2968) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2970: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2970));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2970, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2970, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2971: symseed;
                    new tc'_2972: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2972), SK_63, r2_2971) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2972)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2973: symseed;
                    new tc_2974: timest;
                    let e5: maxmac = encsym(pad(C, tc_2974), kgen(s3_1354[@i_184]), r7_2973) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2975: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2975));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2975, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
                    event fullCT(hostT, hostS, n3_2975, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2976: symseed;
                    new tc'_2977: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2977), SK_63, r2_2976) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2977)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2978: symseed;
                    new tc_2979: timest;
                    let e5: maxmac = encsym(pad(C, tc_2979), kgen(s3_1360[@i_184]), r7_2978) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2980: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2980));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2980, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2980, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2981: symseed;
                    new tc'_2982: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2982), SK_63, r2_2981) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2982)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2983: symseed;
                    new tc_2984: timest;
                    let e5: maxmac = encsym(pad(C, tc_2984), kgen(s3_1354[@i_184]), r7_2983) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2985: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2985));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2985, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
                    event fullCT(hostT, hostS, n3_2985, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2986: symseed;
                    new tc'_2987: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2987), SK_63, r2_2986) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2987)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2988: symseed;
                    new tc_2989: timest;
                    let e5: maxmac = encsym(pad(C, tc_2989), kgen(s3_1360[@i_184]), r7_2988) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2990: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2990));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2990, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_2990, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2991: symseed;
                    new tc'_2992: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2992), SK_63, r2_2991) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2992)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
                  find  suchthat defined(s3_1354[@i_184], AK_2839[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2993: symseed;
                    new tc_2994: timest;
                    let e5: maxmac = encsym(pad(C, tc_2994), kgen(s3_1354[@i_184]), r7_2993) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_2995: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2995));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_2995, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
                    event fullCT(hostT, hostS, n3_2995, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_2996: symseed;
                    new tc'_2997: timest;
                    let e12: maxmac = encsym(pad(C, tc'_2997), SK_63, r2_2996) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_2997)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1360[@i_184], AK_2840[@i_184], z_921[@i_184]) && (z_921[@i_184] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_2998: symseed;
                    new tc_2999: timest;
                    let e5: maxmac = encsym(pad(C, tc_2999), kgen(s3_1360[@i_184]), r7_2998) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3000: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3000));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3000, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
                    event fullCT(hostT, hostS, n3_3000, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3001: symseed;
                    new tc'_3002: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3002), SK_63, r2_3001) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3002)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
              find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3003: symseed;
                    new tc_3004: timest;
                    let e5: maxmac = encsym(pad(C, tc_3004), kgen(s3_1366[@i_183]), r7_3003) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3005: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3006: symseed;
                    new tc'_3007: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3008: symseed;
                    new tc_3009: timest;
                    let x_3167: maxenc = pad(C, tc_3009) in
                    let z_3166: maxmac = encsym(x_3167, kgen2(s3_1372[@i_183]), r7_3008) in
                    let e5: maxmac = z_3166 in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3010: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3010));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    find @i_3366 <= N suchthat defined(x_3164[@i_3366], r11_1433[@i_3366], z_3163[@i_3366]) && ((@i_1384[@i_3366] = @i_183) && (z_3163[@i_3366] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3010, tt_62: timest, =hostS)) = injbot2(x_3164[@i_3366]) in
                      event fullCT(hostT, hostS, n3_3010, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3011: symseed;
                      new tc'_3012: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3012), SK_63, r2_3011) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3012)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3361 <= N3, @i_3362 <= N suchthat defined(x_3167[@i_3361, @i_3362], r7_3008[@i_3361, @i_3362], z_3166[@i_3361, @i_3362]) && ((@i_183[@i_3362] = @i_183) && (z_3166[@i_3361, @i_3362] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3010, tt_62: timest, =hostS)) = injbot2(x_3167[@i_3361, @i_3362]) in
                      event fullCT(hostT, hostS, n3_3010, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3011: symseed;
                      new tc'_3012: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3012), SK_63, r2_3011) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3012)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3357 <= N3, @i_3358 <= N suchthat defined(x_3171[@i_3357, @i_3358], r7_3018[@i_3357, @i_3358], z_3170[@i_3357, @i_3358]) && ((@i_183[@i_3358] = @i_183) && (z_3170[@i_3357, @i_3358] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3010, tt_62: timest, =hostS)) = injbot2(x_3171[@i_3357, @i_3358]) in
                      event fullCT(hostT, hostS, n3_3010, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3011: symseed;
                      new tc'_3012: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3012), SK_63, r2_3011) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3012)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3353 <= N3, @i_3354 <= N suchthat defined(x_3175[@i_3353, @i_3354], r7_3028[@i_3353, @i_3354], z_3174[@i_3353, @i_3354]) && ((@i_183[@i_3354] = @i_183) && (z_3174[@i_3353, @i_3354] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3010, tt_62: timest, =hostS)) = injbot2(x_3175[@i_3353, @i_3354]) in
                      event fullCT(hostT, hostS, n3_3010, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3011: symseed;
                      new tc'_3012: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3012), SK_63, r2_3011) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3012)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3349 <= N3, @i_3350 <= N suchthat defined(x_3179[@i_3349, @i_3350], r7_3038[@i_3349, @i_3350], z_3178[@i_3349, @i_3350]) && ((@i_183[@i_3350] = @i_183) && (z_3178[@i_3349, @i_3350] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3010, tt_62: timest, =hostS)) = injbot2(x_3179[@i_3349, @i_3350]) in
                      event fullCT(hostT, hostS, n3_3010, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3011: symseed;
                      new tc'_3012: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3012), SK_63, r2_3011) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3012)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3345 <= N3, @i_3346 <= N suchthat defined(x_3183[@i_3345, @i_3346], r7_3048[@i_3345, @i_3346], z_3182[@i_3345, @i_3346]) && ((@i_183[@i_3346] = @i_183) && (z_3182[@i_3345, @i_3346] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3010, tt_62: timest, =hostS)) = injbot2(x_3183[@i_3345, @i_3346]) in
                      event fullCT(hostT, hostS, n3_3010, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3011: symseed;
                      new tc'_3012: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3012), SK_63, r2_3011) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3012)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3341 <= N3, @i_3342 <= N suchthat defined(x_3187[@i_3341, @i_3342], r7_3058[@i_3341, @i_3342], z_3186[@i_3341, @i_3342]) && ((@i_183[@i_3342] = @i_183) && (z_3186[@i_3341, @i_3342] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3010, tt_62: timest, =hostS)) = injbot2(x_3187[@i_3341, @i_3342]) in
                      event fullCT(hostT, hostS, n3_3010, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3011: symseed;
                      new tc'_3012: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3012), SK_63, r2_3011) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3012)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3337 <= N3, @i_3338 <= N suchthat defined(x_3191[@i_3337, @i_3338], r7_3068[@i_3337, @i_3338], z_3190[@i_3337, @i_3338]) && ((@i_183[@i_3338] = @i_183) && (z_3190[@i_3337, @i_3338] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3010, tt_62: timest, =hostS)) = injbot2(x_3191[@i_3337, @i_3338]) in
                      event fullCT(hostT, hostS, n3_3010, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3011: symseed;
                      new tc'_3012: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3012), SK_63, r2_3011) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3012)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3333 <= N3, @i_3334 <= N suchthat defined(x_3195[@i_3333, @i_3334], r7_3078[@i_3333, @i_3334], z_3194[@i_3333, @i_3334]) && ((@i_183[@i_3334] = @i_183) && (z_3194[@i_3333, @i_3334] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3010, tt_62: timest, =hostS)) = injbot2(x_3195[@i_3333, @i_3334]) in
                      event fullCT(hostT, hostS, n3_3010, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3011: symseed;
                      new tc'_3012: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3012), SK_63, r2_3011) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3012)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3329 <= N3, @i_3330 <= N suchthat defined(x_3199[@i_3329, @i_3330], r7_3088[@i_3329, @i_3330], z_3198[@i_3329, @i_3330]) && ((@i_183[@i_3330] = @i_183) && (z_3198[@i_3329, @i_3330] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3010, tt_62: timest, =hostS)) = injbot2(x_3199[@i_3329, @i_3330]) in
                      event fullCT(hostT, hostS, n3_3010, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3011: symseed;
                      new tc'_3012: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3012), SK_63, r2_3011) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3012)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3325 <= N3, @i_3326 <= N suchthat defined(x_3203[@i_3325, @i_3326], r7_3098[@i_3325, @i_3326], z_3202[@i_3325, @i_3326]) && ((@i_183[@i_3326] = @i_183) && (z_3202[@i_3325, @i_3326] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3010, tt_62: timest, =hostS)) = injbot2(x_3203[@i_3325, @i_3326]) in
                      event fullCT(hostT, hostS, n3_3010, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3011: symseed;
                      new tc'_3012: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3012), SK_63, r2_3011) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3012)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3321 <= N3, @i_3322 <= N suchthat defined(x_3207[@i_3321, @i_3322], r7_3108[@i_3321, @i_3322], z_3206[@i_3321, @i_3322]) && ((@i_183[@i_3322] = @i_183) && (z_3206[@i_3321, @i_3322] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3010, tt_62: timest, =hostS)) = injbot2(x_3207[@i_3321, @i_3322]) in
                      event fullCT(hostT, hostS, n3_3010, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3011: symseed;
                      new tc'_3012: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3012), SK_63, r2_3011) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3012)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3317 <= N3, @i_3318 <= N suchthat defined(x_3211[@i_3317, @i_3318], r7_3118[@i_3317, @i_3318], z_3210[@i_3317, @i_3318]) && ((@i_183[@i_3318] = @i_183) && (z_3210[@i_3317, @i_3318] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3010, tt_62: timest, =hostS)) = injbot2(x_3211[@i_3317, @i_3318]) in
                      event fullCT(hostT, hostS, n3_3010, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3011: symseed;
                      new tc'_3012: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3012), SK_63, r2_3011) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3012)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3313 <= N3, @i_3314 <= N suchthat defined(x_3215[@i_3313, @i_3314], r7_3128[@i_3313, @i_3314], z_3214[@i_3313, @i_3314]) && ((@i_183[@i_3314] = @i_183) && (z_3214[@i_3313, @i_3314] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3010, tt_62: timest, =hostS)) = injbot2(x_3215[@i_3313, @i_3314]) in
                      event fullCT(hostT, hostS, n3_3010, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3011: symseed;
                      new tc'_3012: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3012), SK_63, r2_3011) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3012)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3309 <= N3, @i_3310 <= N suchthat defined(x_3219[@i_3309, @i_3310], r7_3138[@i_3309, @i_3310], z_3218[@i_3309, @i_3310]) && ((@i_183[@i_3310] = @i_183) && (z_3218[@i_3309, @i_3310] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3010, tt_62: timest, =hostS)) = injbot2(x_3219[@i_3309, @i_3310]) in
                      event fullCT(hostT, hostS, n3_3010, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3011: symseed;
                      new tc'_3012: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3012), SK_63, r2_3011) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3012)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3305 <= N3, @i_3306 <= N suchthat defined(x_3223[@i_3305, @i_3306], r7_3148[@i_3305, @i_3306], z_3222[@i_3305, @i_3306]) && ((@i_183[@i_3306] = @i_183) && (z_3222[@i_3305, @i_3306] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3010, tt_62: timest, =hostS)) = injbot2(x_3223[@i_3305, @i_3306]) in
                      event fullCT(hostT, hostS, n3_3010, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3011: symseed;
                      new tc'_3012: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3012), SK_63, r2_3011) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3012)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3301 <= N3, @i_3302 <= N suchthat defined(x_3227[@i_3301, @i_3302], r7_3158[@i_3301, @i_3302], z_3226[@i_3301, @i_3302]) && ((@i_183[@i_3302] = @i_183) && (z_3226[@i_3301, @i_3302] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3010, tt_62: timest, =hostS)) = injbot2(x_3227[@i_3301, @i_3302]) in
                      event fullCT(hostT, hostS, n3_3010, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3011: symseed;
                      new tc'_3012: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3012), SK_63, r2_3011) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3012)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3300 <= N suchthat defined(x_3231[@i_3300], r11_1430[@i_3300], z_3230[@i_3300]) && ((@i_1384[@i_3300] = @i_183) && (z_3230[@i_3300] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3010, tt_62: timest, =hostS)) = injbot2(x_3231[@i_3300]) in
                      event fullCT(hostT, hostS, n3_3010, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3011: symseed;
                      new tc'_3012: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3012), SK_63, r2_3011) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3012)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    else
                      let injbot2(concat8(SK_63: key, =n3_3010, tt_62: timest, =hostS)) = bottom in
                      event fullCT(hostT, hostS, n3_3010, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3011: symseed;
                      new tc'_3012: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3012), SK_63, r2_3011) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3012)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3013: symseed;
                    new tc_3014: timest;
                    let e5: maxmac = encsym(pad(C, tc_3014), kgen(s3_1366[@i_183]), r7_3013) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3015: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3015));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3015, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3015, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3016: symseed;
                    new tc'_3017: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3017), SK_63, r2_3016) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3017)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3018: symseed;
                    new tc_3019: timest;
                    let x_3171: maxenc = pad(C, tc_3019) in
                    let z_3170: maxmac = encsym(x_3171, kgen2(s3_1372[@i_183]), r7_3018) in
                    let e5: maxmac = z_3170 in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3020: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3020));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    find @i_3433 <= N suchthat defined(x_3164[@i_3433], r11_1433[@i_3433], z_3163[@i_3433]) && ((@i_1384[@i_3433] = @i_183) && (z_3163[@i_3433] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3020, tt_62: timest, =hostS)) = injbot2(x_3164[@i_3433]) in
                      event fullCT(hostT, hostS, n3_3020, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3021: symseed;
                      new tc'_3022: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3022), SK_63, r2_3021) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3022)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3428 <= N3, @i_3429 <= N suchthat defined(x_3167[@i_3428, @i_3429], r7_3008[@i_3428, @i_3429], z_3166[@i_3428, @i_3429]) && ((@i_183[@i_3429] = @i_183) && (z_3166[@i_3428, @i_3429] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3020, tt_62: timest, =hostS)) = injbot2(x_3167[@i_3428, @i_3429]) in
                      event fullCT(hostT, hostS, n3_3020, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3021: symseed;
                      new tc'_3022: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3022), SK_63, r2_3021) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3022)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3424 <= N3, @i_3425 <= N suchthat defined(x_3171[@i_3424, @i_3425], r7_3018[@i_3424, @i_3425], z_3170[@i_3424, @i_3425]) && ((@i_183[@i_3425] = @i_183) && (z_3170[@i_3424, @i_3425] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3020, tt_62: timest, =hostS)) = injbot2(x_3171[@i_3424, @i_3425]) in
                      event fullCT(hostT, hostS, n3_3020, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3021: symseed;
                      new tc'_3022: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3022), SK_63, r2_3021) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3022)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3420 <= N3, @i_3421 <= N suchthat defined(x_3175[@i_3420, @i_3421], r7_3028[@i_3420, @i_3421], z_3174[@i_3420, @i_3421]) && ((@i_183[@i_3421] = @i_183) && (z_3174[@i_3420, @i_3421] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3020, tt_62: timest, =hostS)) = injbot2(x_3175[@i_3420, @i_3421]) in
                      event fullCT(hostT, hostS, n3_3020, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3021: symseed;
                      new tc'_3022: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3022), SK_63, r2_3021) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3022)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3416 <= N3, @i_3417 <= N suchthat defined(x_3179[@i_3416, @i_3417], r7_3038[@i_3416, @i_3417], z_3178[@i_3416, @i_3417]) && ((@i_183[@i_3417] = @i_183) && (z_3178[@i_3416, @i_3417] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3020, tt_62: timest, =hostS)) = injbot2(x_3179[@i_3416, @i_3417]) in
                      event fullCT(hostT, hostS, n3_3020, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3021: symseed;
                      new tc'_3022: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3022), SK_63, r2_3021) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3022)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3412 <= N3, @i_3413 <= N suchthat defined(x_3183[@i_3412, @i_3413], r7_3048[@i_3412, @i_3413], z_3182[@i_3412, @i_3413]) && ((@i_183[@i_3413] = @i_183) && (z_3182[@i_3412, @i_3413] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3020, tt_62: timest, =hostS)) = injbot2(x_3183[@i_3412, @i_3413]) in
                      event fullCT(hostT, hostS, n3_3020, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3021: symseed;
                      new tc'_3022: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3022), SK_63, r2_3021) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3022)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3408 <= N3, @i_3409 <= N suchthat defined(x_3187[@i_3408, @i_3409], r7_3058[@i_3408, @i_3409], z_3186[@i_3408, @i_3409]) && ((@i_183[@i_3409] = @i_183) && (z_3186[@i_3408, @i_3409] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3020, tt_62: timest, =hostS)) = injbot2(x_3187[@i_3408, @i_3409]) in
                      event fullCT(hostT, hostS, n3_3020, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3021: symseed;
                      new tc'_3022: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3022), SK_63, r2_3021) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3022)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3404 <= N3, @i_3405 <= N suchthat defined(x_3191[@i_3404, @i_3405], r7_3068[@i_3404, @i_3405], z_3190[@i_3404, @i_3405]) && ((@i_183[@i_3405] = @i_183) && (z_3190[@i_3404, @i_3405] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3020, tt_62: timest, =hostS)) = injbot2(x_3191[@i_3404, @i_3405]) in
                      event fullCT(hostT, hostS, n3_3020, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3021: symseed;
                      new tc'_3022: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3022), SK_63, r2_3021) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3022)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3400 <= N3, @i_3401 <= N suchthat defined(x_3195[@i_3400, @i_3401], r7_3078[@i_3400, @i_3401], z_3194[@i_3400, @i_3401]) && ((@i_183[@i_3401] = @i_183) && (z_3194[@i_3400, @i_3401] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3020, tt_62: timest, =hostS)) = injbot2(x_3195[@i_3400, @i_3401]) in
                      event fullCT(hostT, hostS, n3_3020, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3021: symseed;
                      new tc'_3022: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3022), SK_63, r2_3021) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3022)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3396 <= N3, @i_3397 <= N suchthat defined(x_3199[@i_3396, @i_3397], r7_3088[@i_3396, @i_3397], z_3198[@i_3396, @i_3397]) && ((@i_183[@i_3397] = @i_183) && (z_3198[@i_3396, @i_3397] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3020, tt_62: timest, =hostS)) = injbot2(x_3199[@i_3396, @i_3397]) in
                      event fullCT(hostT, hostS, n3_3020, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3021: symseed;
                      new tc'_3022: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3022), SK_63, r2_3021) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3022)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3392 <= N3, @i_3393 <= N suchthat defined(x_3203[@i_3392, @i_3393], r7_3098[@i_3392, @i_3393], z_3202[@i_3392, @i_3393]) && ((@i_183[@i_3393] = @i_183) && (z_3202[@i_3392, @i_3393] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3020, tt_62: timest, =hostS)) = injbot2(x_3203[@i_3392, @i_3393]) in
                      event fullCT(hostT, hostS, n3_3020, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3021: symseed;
                      new tc'_3022: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3022), SK_63, r2_3021) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3022)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3388 <= N3, @i_3389 <= N suchthat defined(x_3207[@i_3388, @i_3389], r7_3108[@i_3388, @i_3389], z_3206[@i_3388, @i_3389]) && ((@i_183[@i_3389] = @i_183) && (z_3206[@i_3388, @i_3389] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3020, tt_62: timest, =hostS)) = injbot2(x_3207[@i_3388, @i_3389]) in
                      event fullCT(hostT, hostS, n3_3020, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3021: symseed;
                      new tc'_3022: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3022), SK_63, r2_3021) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3022)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3384 <= N3, @i_3385 <= N suchthat defined(x_3211[@i_3384, @i_3385], r7_3118[@i_3384, @i_3385], z_3210[@i_3384, @i_3385]) && ((@i_183[@i_3385] = @i_183) && (z_3210[@i_3384, @i_3385] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3020, tt_62: timest, =hostS)) = injbot2(x_3211[@i_3384, @i_3385]) in
                      event fullCT(hostT, hostS, n3_3020, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3021: symseed;
                      new tc'_3022: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3022), SK_63, r2_3021) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3022)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3380 <= N3, @i_3381 <= N suchthat defined(x_3215[@i_3380, @i_3381], r7_3128[@i_3380, @i_3381], z_3214[@i_3380, @i_3381]) && ((@i_183[@i_3381] = @i_183) && (z_3214[@i_3380, @i_3381] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3020, tt_62: timest, =hostS)) = injbot2(x_3215[@i_3380, @i_3381]) in
                      event fullCT(hostT, hostS, n3_3020, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3021: symseed;
                      new tc'_3022: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3022), SK_63, r2_3021) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3022)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3376 <= N3, @i_3377 <= N suchthat defined(x_3219[@i_3376, @i_3377], r7_3138[@i_3376, @i_3377], z_3218[@i_3376, @i_3377]) && ((@i_183[@i_3377] = @i_183) && (z_3218[@i_3376, @i_3377] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3020, tt_62: timest, =hostS)) = injbot2(x_3219[@i_3376, @i_3377]) in
                      event fullCT(hostT, hostS, n3_3020, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3021: symseed;
                      new tc'_3022: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3022), SK_63, r2_3021) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3022)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3372 <= N3, @i_3373 <= N suchthat defined(x_3223[@i_3372, @i_3373], r7_3148[@i_3372, @i_3373], z_3222[@i_3372, @i_3373]) && ((@i_183[@i_3373] = @i_183) && (z_3222[@i_3372, @i_3373] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3020, tt_62: timest, =hostS)) = injbot2(x_3223[@i_3372, @i_3373]) in
                      event fullCT(hostT, hostS, n3_3020, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3021: symseed;
                      new tc'_3022: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3022), SK_63, r2_3021) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3022)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3368 <= N3, @i_3369 <= N suchthat defined(x_3227[@i_3368, @i_3369], r7_3158[@i_3368, @i_3369], z_3226[@i_3368, @i_3369]) && ((@i_183[@i_3369] = @i_183) && (z_3226[@i_3368, @i_3369] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3020, tt_62: timest, =hostS)) = injbot2(x_3227[@i_3368, @i_3369]) in
                      event fullCT(hostT, hostS, n3_3020, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3021: symseed;
                      new tc'_3022: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3022), SK_63, r2_3021) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3022)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3367 <= N suchthat defined(x_3231[@i_3367], r11_1430[@i_3367], z_3230[@i_3367]) && ((@i_1384[@i_3367] = @i_183) && (z_3230[@i_3367] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3020, tt_62: timest, =hostS)) = injbot2(x_3231[@i_3367]) in
                      event fullCT(hostT, hostS, n3_3020, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3021: symseed;
                      new tc'_3022: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3022), SK_63, r2_3021) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3022)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    else
                      let injbot2(concat8(SK_63: key, =n3_3020, tt_62: timest, =hostS)) = bottom in
                      event fullCT(hostT, hostS, n3_3020, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3021: symseed;
                      new tc'_3022: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3022), SK_63, r2_3021) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3022)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3023: symseed;
                    new tc_3024: timest;
                    let e5: maxmac = encsym(pad(C, tc_3024), kgen(s3_1366[@i_183]), r7_3023) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3025: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3025));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3025, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3025, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3026: symseed;
                    new tc'_3027: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3027), SK_63, r2_3026) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3027)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3028: symseed;
                    new tc_3029: timest;
                    let x_3175: maxenc = pad(C, tc_3029) in
                    let z_3174: maxmac = encsym(x_3175, kgen2(s3_1372[@i_183]), r7_3028) in
                    let e5: maxmac = z_3174 in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3030: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3030));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    find @i_3500 <= N suchthat defined(x_3164[@i_3500], r11_1433[@i_3500], z_3163[@i_3500]) && ((@i_1384[@i_3500] = @i_183) && (z_3163[@i_3500] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3030, tt_62: timest, =hostS)) = injbot2(x_3164[@i_3500]) in
                      event fullCT(hostT, hostS, n3_3030, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3031: symseed;
                      new tc'_3032: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3032), SK_63, r2_3031) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3032)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3495 <= N3, @i_3496 <= N suchthat defined(x_3167[@i_3495, @i_3496], r7_3008[@i_3495, @i_3496], z_3166[@i_3495, @i_3496]) && ((@i_183[@i_3496] = @i_183) && (z_3166[@i_3495, @i_3496] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3030, tt_62: timest, =hostS)) = injbot2(x_3167[@i_3495, @i_3496]) in
                      event fullCT(hostT, hostS, n3_3030, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3031: symseed;
                      new tc'_3032: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3032), SK_63, r2_3031) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3032)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3491 <= N3, @i_3492 <= N suchthat defined(x_3171[@i_3491, @i_3492], r7_3018[@i_3491, @i_3492], z_3170[@i_3491, @i_3492]) && ((@i_183[@i_3492] = @i_183) && (z_3170[@i_3491, @i_3492] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3030, tt_62: timest, =hostS)) = injbot2(x_3171[@i_3491, @i_3492]) in
                      event fullCT(hostT, hostS, n3_3030, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3031: symseed;
                      new tc'_3032: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3032), SK_63, r2_3031) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3032)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3487 <= N3, @i_3488 <= N suchthat defined(x_3175[@i_3487, @i_3488], r7_3028[@i_3487, @i_3488], z_3174[@i_3487, @i_3488]) && ((@i_183[@i_3488] = @i_183) && (z_3174[@i_3487, @i_3488] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3030, tt_62: timest, =hostS)) = injbot2(x_3175[@i_3487, @i_3488]) in
                      event fullCT(hostT, hostS, n3_3030, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3031: symseed;
                      new tc'_3032: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3032), SK_63, r2_3031) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3032)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3483 <= N3, @i_3484 <= N suchthat defined(x_3179[@i_3483, @i_3484], r7_3038[@i_3483, @i_3484], z_3178[@i_3483, @i_3484]) && ((@i_183[@i_3484] = @i_183) && (z_3178[@i_3483, @i_3484] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3030, tt_62: timest, =hostS)) = injbot2(x_3179[@i_3483, @i_3484]) in
                      event fullCT(hostT, hostS, n3_3030, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3031: symseed;
                      new tc'_3032: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3032), SK_63, r2_3031) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3032)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3479 <= N3, @i_3480 <= N suchthat defined(x_3183[@i_3479, @i_3480], r7_3048[@i_3479, @i_3480], z_3182[@i_3479, @i_3480]) && ((@i_183[@i_3480] = @i_183) && (z_3182[@i_3479, @i_3480] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3030, tt_62: timest, =hostS)) = injbot2(x_3183[@i_3479, @i_3480]) in
                      event fullCT(hostT, hostS, n3_3030, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3031: symseed;
                      new tc'_3032: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3032), SK_63, r2_3031) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3032)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3475 <= N3, @i_3476 <= N suchthat defined(x_3187[@i_3475, @i_3476], r7_3058[@i_3475, @i_3476], z_3186[@i_3475, @i_3476]) && ((@i_183[@i_3476] = @i_183) && (z_3186[@i_3475, @i_3476] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3030, tt_62: timest, =hostS)) = injbot2(x_3187[@i_3475, @i_3476]) in
                      event fullCT(hostT, hostS, n3_3030, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3031: symseed;
                      new tc'_3032: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3032), SK_63, r2_3031) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3032)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3471 <= N3, @i_3472 <= N suchthat defined(x_3191[@i_3471, @i_3472], r7_3068[@i_3471, @i_3472], z_3190[@i_3471, @i_3472]) && ((@i_183[@i_3472] = @i_183) && (z_3190[@i_3471, @i_3472] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3030, tt_62: timest, =hostS)) = injbot2(x_3191[@i_3471, @i_3472]) in
                      event fullCT(hostT, hostS, n3_3030, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3031: symseed;
                      new tc'_3032: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3032), SK_63, r2_3031) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3032)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3467 <= N3, @i_3468 <= N suchthat defined(x_3195[@i_3467, @i_3468], r7_3078[@i_3467, @i_3468], z_3194[@i_3467, @i_3468]) && ((@i_183[@i_3468] = @i_183) && (z_3194[@i_3467, @i_3468] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3030, tt_62: timest, =hostS)) = injbot2(x_3195[@i_3467, @i_3468]) in
                      event fullCT(hostT, hostS, n3_3030, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3031: symseed;
                      new tc'_3032: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3032), SK_63, r2_3031) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3032)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3463 <= N3, @i_3464 <= N suchthat defined(x_3199[@i_3463, @i_3464], r7_3088[@i_3463, @i_3464], z_3198[@i_3463, @i_3464]) && ((@i_183[@i_3464] = @i_183) && (z_3198[@i_3463, @i_3464] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3030, tt_62: timest, =hostS)) = injbot2(x_3199[@i_3463, @i_3464]) in
                      event fullCT(hostT, hostS, n3_3030, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3031: symseed;
                      new tc'_3032: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3032), SK_63, r2_3031) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3032)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3459 <= N3, @i_3460 <= N suchthat defined(x_3203[@i_3459, @i_3460], r7_3098[@i_3459, @i_3460], z_3202[@i_3459, @i_3460]) && ((@i_183[@i_3460] = @i_183) && (z_3202[@i_3459, @i_3460] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3030, tt_62: timest, =hostS)) = injbot2(x_3203[@i_3459, @i_3460]) in
                      event fullCT(hostT, hostS, n3_3030, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3031: symseed;
                      new tc'_3032: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3032), SK_63, r2_3031) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3032)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3455 <= N3, @i_3456 <= N suchthat defined(x_3207[@i_3455, @i_3456], r7_3108[@i_3455, @i_3456], z_3206[@i_3455, @i_3456]) && ((@i_183[@i_3456] = @i_183) && (z_3206[@i_3455, @i_3456] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3030, tt_62: timest, =hostS)) = injbot2(x_3207[@i_3455, @i_3456]) in
                      event fullCT(hostT, hostS, n3_3030, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3031: symseed;
                      new tc'_3032: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3032), SK_63, r2_3031) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3032)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3451 <= N3, @i_3452 <= N suchthat defined(x_3211[@i_3451, @i_3452], r7_3118[@i_3451, @i_3452], z_3210[@i_3451, @i_3452]) && ((@i_183[@i_3452] = @i_183) && (z_3210[@i_3451, @i_3452] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3030, tt_62: timest, =hostS)) = injbot2(x_3211[@i_3451, @i_3452]) in
                      event fullCT(hostT, hostS, n3_3030, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3031: symseed;
                      new tc'_3032: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3032), SK_63, r2_3031) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3032)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3447 <= N3, @i_3448 <= N suchthat defined(x_3215[@i_3447, @i_3448], r7_3128[@i_3447, @i_3448], z_3214[@i_3447, @i_3448]) && ((@i_183[@i_3448] = @i_183) && (z_3214[@i_3447, @i_3448] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3030, tt_62: timest, =hostS)) = injbot2(x_3215[@i_3447, @i_3448]) in
                      event fullCT(hostT, hostS, n3_3030, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3031: symseed;
                      new tc'_3032: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3032), SK_63, r2_3031) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3032)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3443 <= N3, @i_3444 <= N suchthat defined(x_3219[@i_3443, @i_3444], r7_3138[@i_3443, @i_3444], z_3218[@i_3443, @i_3444]) && ((@i_183[@i_3444] = @i_183) && (z_3218[@i_3443, @i_3444] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3030, tt_62: timest, =hostS)) = injbot2(x_3219[@i_3443, @i_3444]) in
                      event fullCT(hostT, hostS, n3_3030, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3031: symseed;
                      new tc'_3032: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3032), SK_63, r2_3031) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3032)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3439 <= N3, @i_3440 <= N suchthat defined(x_3223[@i_3439, @i_3440], r7_3148[@i_3439, @i_3440], z_3222[@i_3439, @i_3440]) && ((@i_183[@i_3440] = @i_183) && (z_3222[@i_3439, @i_3440] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3030, tt_62: timest, =hostS)) = injbot2(x_3223[@i_3439, @i_3440]) in
                      event fullCT(hostT, hostS, n3_3030, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3031: symseed;
                      new tc'_3032: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3032), SK_63, r2_3031) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3032)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3435 <= N3, @i_3436 <= N suchthat defined(x_3227[@i_3435, @i_3436], r7_3158[@i_3435, @i_3436], z_3226[@i_3435, @i_3436]) && ((@i_183[@i_3436] = @i_183) && (z_3226[@i_3435, @i_3436] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3030, tt_62: timest, =hostS)) = injbot2(x_3227[@i_3435, @i_3436]) in
                      event fullCT(hostT, hostS, n3_3030, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3031: symseed;
                      new tc'_3032: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3032), SK_63, r2_3031) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3032)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3434 <= N suchthat defined(x_3231[@i_3434], r11_1430[@i_3434], z_3230[@i_3434]) && ((@i_1384[@i_3434] = @i_183) && (z_3230[@i_3434] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3030, tt_62: timest, =hostS)) = injbot2(x_3231[@i_3434]) in
                      event fullCT(hostT, hostS, n3_3030, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3031: symseed;
                      new tc'_3032: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3032), SK_63, r2_3031) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3032)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    else
                      let injbot2(concat8(SK_63: key, =n3_3030, tt_62: timest, =hostS)) = bottom in
                      event fullCT(hostT, hostS, n3_3030, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3031: symseed;
                      new tc'_3032: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3032), SK_63, r2_3031) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3032)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3033: symseed;
                    new tc_3034: timest;
                    let e5: maxmac = encsym(pad(C, tc_3034), kgen(s3_1366[@i_183]), r7_3033) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3035: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3035));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3035, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3035, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3036: symseed;
                    new tc'_3037: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3037), SK_63, r2_3036) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3037)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3038: symseed;
                    new tc_3039: timest;
                    let x_3179: maxenc = pad(C, tc_3039) in
                    let z_3178: maxmac = encsym(x_3179, kgen2(s3_1372[@i_183]), r7_3038) in
                    let e5: maxmac = z_3178 in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3040: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3040));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    find @i_3567 <= N suchthat defined(x_3164[@i_3567], r11_1433[@i_3567], z_3163[@i_3567]) && ((@i_1384[@i_3567] = @i_183) && (z_3163[@i_3567] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3040, tt_62: timest, =hostS)) = injbot2(x_3164[@i_3567]) in
                      event fullCT(hostT, hostS, n3_3040, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3041: symseed;
                      new tc'_3042: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3042), SK_63, r2_3041) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3042)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3562 <= N3, @i_3563 <= N suchthat defined(x_3167[@i_3562, @i_3563], r7_3008[@i_3562, @i_3563], z_3166[@i_3562, @i_3563]) && ((@i_183[@i_3563] = @i_183) && (z_3166[@i_3562, @i_3563] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3040, tt_62: timest, =hostS)) = injbot2(x_3167[@i_3562, @i_3563]) in
                      event fullCT(hostT, hostS, n3_3040, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3041: symseed;
                      new tc'_3042: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3042), SK_63, r2_3041) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3042)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3558 <= N3, @i_3559 <= N suchthat defined(x_3171[@i_3558, @i_3559], r7_3018[@i_3558, @i_3559], z_3170[@i_3558, @i_3559]) && ((@i_183[@i_3559] = @i_183) && (z_3170[@i_3558, @i_3559] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3040, tt_62: timest, =hostS)) = injbot2(x_3171[@i_3558, @i_3559]) in
                      event fullCT(hostT, hostS, n3_3040, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3041: symseed;
                      new tc'_3042: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3042), SK_63, r2_3041) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3042)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3554 <= N3, @i_3555 <= N suchthat defined(x_3175[@i_3554, @i_3555], r7_3028[@i_3554, @i_3555], z_3174[@i_3554, @i_3555]) && ((@i_183[@i_3555] = @i_183) && (z_3174[@i_3554, @i_3555] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3040, tt_62: timest, =hostS)) = injbot2(x_3175[@i_3554, @i_3555]) in
                      event fullCT(hostT, hostS, n3_3040, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3041: symseed;
                      new tc'_3042: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3042), SK_63, r2_3041) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3042)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3550 <= N3, @i_3551 <= N suchthat defined(x_3179[@i_3550, @i_3551], r7_3038[@i_3550, @i_3551], z_3178[@i_3550, @i_3551]) && ((@i_183[@i_3551] = @i_183) && (z_3178[@i_3550, @i_3551] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3040, tt_62: timest, =hostS)) = injbot2(x_3179[@i_3550, @i_3551]) in
                      event fullCT(hostT, hostS, n3_3040, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3041: symseed;
                      new tc'_3042: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3042), SK_63, r2_3041) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3042)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3546 <= N3, @i_3547 <= N suchthat defined(x_3183[@i_3546, @i_3547], r7_3048[@i_3546, @i_3547], z_3182[@i_3546, @i_3547]) && ((@i_183[@i_3547] = @i_183) && (z_3182[@i_3546, @i_3547] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3040, tt_62: timest, =hostS)) = injbot2(x_3183[@i_3546, @i_3547]) in
                      event fullCT(hostT, hostS, n3_3040, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3041: symseed;
                      new tc'_3042: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3042), SK_63, r2_3041) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3042)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3542 <= N3, @i_3543 <= N suchthat defined(x_3187[@i_3542, @i_3543], r7_3058[@i_3542, @i_3543], z_3186[@i_3542, @i_3543]) && ((@i_183[@i_3543] = @i_183) && (z_3186[@i_3542, @i_3543] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3040, tt_62: timest, =hostS)) = injbot2(x_3187[@i_3542, @i_3543]) in
                      event fullCT(hostT, hostS, n3_3040, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3041: symseed;
                      new tc'_3042: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3042), SK_63, r2_3041) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3042)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3538 <= N3, @i_3539 <= N suchthat defined(x_3191[@i_3538, @i_3539], r7_3068[@i_3538, @i_3539], z_3190[@i_3538, @i_3539]) && ((@i_183[@i_3539] = @i_183) && (z_3190[@i_3538, @i_3539] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3040, tt_62: timest, =hostS)) = injbot2(x_3191[@i_3538, @i_3539]) in
                      event fullCT(hostT, hostS, n3_3040, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3041: symseed;
                      new tc'_3042: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3042), SK_63, r2_3041) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3042)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3534 <= N3, @i_3535 <= N suchthat defined(x_3195[@i_3534, @i_3535], r7_3078[@i_3534, @i_3535], z_3194[@i_3534, @i_3535]) && ((@i_183[@i_3535] = @i_183) && (z_3194[@i_3534, @i_3535] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3040, tt_62: timest, =hostS)) = injbot2(x_3195[@i_3534, @i_3535]) in
                      event fullCT(hostT, hostS, n3_3040, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3041: symseed;
                      new tc'_3042: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3042), SK_63, r2_3041) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3042)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3530 <= N3, @i_3531 <= N suchthat defined(x_3199[@i_3530, @i_3531], r7_3088[@i_3530, @i_3531], z_3198[@i_3530, @i_3531]) && ((@i_183[@i_3531] = @i_183) && (z_3198[@i_3530, @i_3531] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3040, tt_62: timest, =hostS)) = injbot2(x_3199[@i_3530, @i_3531]) in
                      event fullCT(hostT, hostS, n3_3040, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3041: symseed;
                      new tc'_3042: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3042), SK_63, r2_3041) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3042)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3526 <= N3, @i_3527 <= N suchthat defined(x_3203[@i_3526, @i_3527], r7_3098[@i_3526, @i_3527], z_3202[@i_3526, @i_3527]) && ((@i_183[@i_3527] = @i_183) && (z_3202[@i_3526, @i_3527] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3040, tt_62: timest, =hostS)) = injbot2(x_3203[@i_3526, @i_3527]) in
                      event fullCT(hostT, hostS, n3_3040, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3041: symseed;
                      new tc'_3042: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3042), SK_63, r2_3041) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3042)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3522 <= N3, @i_3523 <= N suchthat defined(x_3207[@i_3522, @i_3523], r7_3108[@i_3522, @i_3523], z_3206[@i_3522, @i_3523]) && ((@i_183[@i_3523] = @i_183) && (z_3206[@i_3522, @i_3523] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3040, tt_62: timest, =hostS)) = injbot2(x_3207[@i_3522, @i_3523]) in
                      event fullCT(hostT, hostS, n3_3040, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3041: symseed;
                      new tc'_3042: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3042), SK_63, r2_3041) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3042)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3518 <= N3, @i_3519 <= N suchthat defined(x_3211[@i_3518, @i_3519], r7_3118[@i_3518, @i_3519], z_3210[@i_3518, @i_3519]) && ((@i_183[@i_3519] = @i_183) && (z_3210[@i_3518, @i_3519] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3040, tt_62: timest, =hostS)) = injbot2(x_3211[@i_3518, @i_3519]) in
                      event fullCT(hostT, hostS, n3_3040, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3041: symseed;
                      new tc'_3042: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3042), SK_63, r2_3041) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3042)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3514 <= N3, @i_3515 <= N suchthat defined(x_3215[@i_3514, @i_3515], r7_3128[@i_3514, @i_3515], z_3214[@i_3514, @i_3515]) && ((@i_183[@i_3515] = @i_183) && (z_3214[@i_3514, @i_3515] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3040, tt_62: timest, =hostS)) = injbot2(x_3215[@i_3514, @i_3515]) in
                      event fullCT(hostT, hostS, n3_3040, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3041: symseed;
                      new tc'_3042: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3042), SK_63, r2_3041) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3042)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3510 <= N3, @i_3511 <= N suchthat defined(x_3219[@i_3510, @i_3511], r7_3138[@i_3510, @i_3511], z_3218[@i_3510, @i_3511]) && ((@i_183[@i_3511] = @i_183) && (z_3218[@i_3510, @i_3511] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3040, tt_62: timest, =hostS)) = injbot2(x_3219[@i_3510, @i_3511]) in
                      event fullCT(hostT, hostS, n3_3040, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3041: symseed;
                      new tc'_3042: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3042), SK_63, r2_3041) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3042)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3506 <= N3, @i_3507 <= N suchthat defined(x_3223[@i_3506, @i_3507], r7_3148[@i_3506, @i_3507], z_3222[@i_3506, @i_3507]) && ((@i_183[@i_3507] = @i_183) && (z_3222[@i_3506, @i_3507] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3040, tt_62: timest, =hostS)) = injbot2(x_3223[@i_3506, @i_3507]) in
                      event fullCT(hostT, hostS, n3_3040, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3041: symseed;
                      new tc'_3042: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3042), SK_63, r2_3041) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3042)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3502 <= N3, @i_3503 <= N suchthat defined(x_3227[@i_3502, @i_3503], r7_3158[@i_3502, @i_3503], z_3226[@i_3502, @i_3503]) && ((@i_183[@i_3503] = @i_183) && (z_3226[@i_3502, @i_3503] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3040, tt_62: timest, =hostS)) = injbot2(x_3227[@i_3502, @i_3503]) in
                      event fullCT(hostT, hostS, n3_3040, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3041: symseed;
                      new tc'_3042: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3042), SK_63, r2_3041) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3042)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3501 <= N suchthat defined(x_3231[@i_3501], r11_1430[@i_3501], z_3230[@i_3501]) && ((@i_1384[@i_3501] = @i_183) && (z_3230[@i_3501] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3040, tt_62: timest, =hostS)) = injbot2(x_3231[@i_3501]) in
                      event fullCT(hostT, hostS, n3_3040, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3041: symseed;
                      new tc'_3042: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3042), SK_63, r2_3041) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3042)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    else
                      let injbot2(concat8(SK_63: key, =n3_3040, tt_62: timest, =hostS)) = bottom in
                      event fullCT(hostT, hostS, n3_3040, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3041: symseed;
                      new tc'_3042: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3042), SK_63, r2_3041) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3042)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
              find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3043: symseed;
                    new tc_3044: timest;
                    let e5: maxmac = encsym(pad(C, tc_3044), kgen(s3_1366[@i_183]), r7_3043) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3045: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3045));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3045, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3045, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3046: symseed;
                    new tc'_3047: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3047), SK_63, r2_3046) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3047)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3048: symseed;
                    new tc_3049: timest;
                    let x_3183: maxenc = pad(C, tc_3049) in
                    let z_3182: maxmac = encsym(x_3183, kgen2(s3_1372[@i_183]), r7_3048) in
                    let e5: maxmac = z_3182 in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3050: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3050));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    find @i_3634 <= N suchthat defined(x_3164[@i_3634], r11_1433[@i_3634], z_3163[@i_3634]) && ((@i_1384[@i_3634] = @i_183) && (z_3163[@i_3634] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3050, tt_62: timest, =hostS)) = injbot2(x_3164[@i_3634]) in
                      event fullCT(hostT, hostS, n3_3050, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3051: symseed;
                      new tc'_3052: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3052), SK_63, r2_3051) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3052)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3629 <= N3, @i_3630 <= N suchthat defined(x_3167[@i_3629, @i_3630], r7_3008[@i_3629, @i_3630], z_3166[@i_3629, @i_3630]) && ((@i_183[@i_3630] = @i_183) && (z_3166[@i_3629, @i_3630] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3050, tt_62: timest, =hostS)) = injbot2(x_3167[@i_3629, @i_3630]) in
                      event fullCT(hostT, hostS, n3_3050, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3051: symseed;
                      new tc'_3052: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3052), SK_63, r2_3051) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3052)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3625 <= N3, @i_3626 <= N suchthat defined(x_3171[@i_3625, @i_3626], r7_3018[@i_3625, @i_3626], z_3170[@i_3625, @i_3626]) && ((@i_183[@i_3626] = @i_183) && (z_3170[@i_3625, @i_3626] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3050, tt_62: timest, =hostS)) = injbot2(x_3171[@i_3625, @i_3626]) in
                      event fullCT(hostT, hostS, n3_3050, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3051: symseed;
                      new tc'_3052: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3052), SK_63, r2_3051) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3052)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3621 <= N3, @i_3622 <= N suchthat defined(x_3175[@i_3621, @i_3622], r7_3028[@i_3621, @i_3622], z_3174[@i_3621, @i_3622]) && ((@i_183[@i_3622] = @i_183) && (z_3174[@i_3621, @i_3622] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3050, tt_62: timest, =hostS)) = injbot2(x_3175[@i_3621, @i_3622]) in
                      event fullCT(hostT, hostS, n3_3050, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3051: symseed;
                      new tc'_3052: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3052), SK_63, r2_3051) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3052)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3617 <= N3, @i_3618 <= N suchthat defined(x_3179[@i_3617, @i_3618], r7_3038[@i_3617, @i_3618], z_3178[@i_3617, @i_3618]) && ((@i_183[@i_3618] = @i_183) && (z_3178[@i_3617, @i_3618] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3050, tt_62: timest, =hostS)) = injbot2(x_3179[@i_3617, @i_3618]) in
                      event fullCT(hostT, hostS, n3_3050, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3051: symseed;
                      new tc'_3052: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3052), SK_63, r2_3051) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3052)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3613 <= N3, @i_3614 <= N suchthat defined(x_3183[@i_3613, @i_3614], r7_3048[@i_3613, @i_3614], z_3182[@i_3613, @i_3614]) && ((@i_183[@i_3614] = @i_183) && (z_3182[@i_3613, @i_3614] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3050, tt_62: timest, =hostS)) = injbot2(x_3183[@i_3613, @i_3614]) in
                      event fullCT(hostT, hostS, n3_3050, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3051: symseed;
                      new tc'_3052: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3052), SK_63, r2_3051) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3052)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3609 <= N3, @i_3610 <= N suchthat defined(x_3187[@i_3609, @i_3610], r7_3058[@i_3609, @i_3610], z_3186[@i_3609, @i_3610]) && ((@i_183[@i_3610] = @i_183) && (z_3186[@i_3609, @i_3610] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3050, tt_62: timest, =hostS)) = injbot2(x_3187[@i_3609, @i_3610]) in
                      event fullCT(hostT, hostS, n3_3050, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3051: symseed;
                      new tc'_3052: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3052), SK_63, r2_3051) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3052)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3605 <= N3, @i_3606 <= N suchthat defined(x_3191[@i_3605, @i_3606], r7_3068[@i_3605, @i_3606], z_3190[@i_3605, @i_3606]) && ((@i_183[@i_3606] = @i_183) && (z_3190[@i_3605, @i_3606] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3050, tt_62: timest, =hostS)) = injbot2(x_3191[@i_3605, @i_3606]) in
                      event fullCT(hostT, hostS, n3_3050, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3051: symseed;
                      new tc'_3052: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3052), SK_63, r2_3051) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3052)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3601 <= N3, @i_3602 <= N suchthat defined(x_3195[@i_3601, @i_3602], r7_3078[@i_3601, @i_3602], z_3194[@i_3601, @i_3602]) && ((@i_183[@i_3602] = @i_183) && (z_3194[@i_3601, @i_3602] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3050, tt_62: timest, =hostS)) = injbot2(x_3195[@i_3601, @i_3602]) in
                      event fullCT(hostT, hostS, n3_3050, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3051: symseed;
                      new tc'_3052: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3052), SK_63, r2_3051) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3052)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3597 <= N3, @i_3598 <= N suchthat defined(x_3199[@i_3597, @i_3598], r7_3088[@i_3597, @i_3598], z_3198[@i_3597, @i_3598]) && ((@i_183[@i_3598] = @i_183) && (z_3198[@i_3597, @i_3598] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3050, tt_62: timest, =hostS)) = injbot2(x_3199[@i_3597, @i_3598]) in
                      event fullCT(hostT, hostS, n3_3050, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3051: symseed;
                      new tc'_3052: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3052), SK_63, r2_3051) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3052)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3593 <= N3, @i_3594 <= N suchthat defined(x_3203[@i_3593, @i_3594], r7_3098[@i_3593, @i_3594], z_3202[@i_3593, @i_3594]) && ((@i_183[@i_3594] = @i_183) && (z_3202[@i_3593, @i_3594] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3050, tt_62: timest, =hostS)) = injbot2(x_3203[@i_3593, @i_3594]) in
                      event fullCT(hostT, hostS, n3_3050, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3051: symseed;
                      new tc'_3052: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3052), SK_63, r2_3051) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3052)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3589 <= N3, @i_3590 <= N suchthat defined(x_3207[@i_3589, @i_3590], r7_3108[@i_3589, @i_3590], z_3206[@i_3589, @i_3590]) && ((@i_183[@i_3590] = @i_183) && (z_3206[@i_3589, @i_3590] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3050, tt_62: timest, =hostS)) = injbot2(x_3207[@i_3589, @i_3590]) in
                      event fullCT(hostT, hostS, n3_3050, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3051: symseed;
                      new tc'_3052: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3052), SK_63, r2_3051) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3052)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3585 <= N3, @i_3586 <= N suchthat defined(x_3211[@i_3585, @i_3586], r7_3118[@i_3585, @i_3586], z_3210[@i_3585, @i_3586]) && ((@i_183[@i_3586] = @i_183) && (z_3210[@i_3585, @i_3586] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3050, tt_62: timest, =hostS)) = injbot2(x_3211[@i_3585, @i_3586]) in
                      event fullCT(hostT, hostS, n3_3050, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3051: symseed;
                      new tc'_3052: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3052), SK_63, r2_3051) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3052)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3581 <= N3, @i_3582 <= N suchthat defined(x_3215[@i_3581, @i_3582], r7_3128[@i_3581, @i_3582], z_3214[@i_3581, @i_3582]) && ((@i_183[@i_3582] = @i_183) && (z_3214[@i_3581, @i_3582] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3050, tt_62: timest, =hostS)) = injbot2(x_3215[@i_3581, @i_3582]) in
                      event fullCT(hostT, hostS, n3_3050, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3051: symseed;
                      new tc'_3052: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3052), SK_63, r2_3051) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3052)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3577 <= N3, @i_3578 <= N suchthat defined(x_3219[@i_3577, @i_3578], r7_3138[@i_3577, @i_3578], z_3218[@i_3577, @i_3578]) && ((@i_183[@i_3578] = @i_183) && (z_3218[@i_3577, @i_3578] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3050, tt_62: timest, =hostS)) = injbot2(x_3219[@i_3577, @i_3578]) in
                      event fullCT(hostT, hostS, n3_3050, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3051: symseed;
                      new tc'_3052: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3052), SK_63, r2_3051) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3052)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3573 <= N3, @i_3574 <= N suchthat defined(x_3223[@i_3573, @i_3574], r7_3148[@i_3573, @i_3574], z_3222[@i_3573, @i_3574]) && ((@i_183[@i_3574] = @i_183) && (z_3222[@i_3573, @i_3574] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3050, tt_62: timest, =hostS)) = injbot2(x_3223[@i_3573, @i_3574]) in
                      event fullCT(hostT, hostS, n3_3050, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3051: symseed;
                      new tc'_3052: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3052), SK_63, r2_3051) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3052)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3569 <= N3, @i_3570 <= N suchthat defined(x_3227[@i_3569, @i_3570], r7_3158[@i_3569, @i_3570], z_3226[@i_3569, @i_3570]) && ((@i_183[@i_3570] = @i_183) && (z_3226[@i_3569, @i_3570] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3050, tt_62: timest, =hostS)) = injbot2(x_3227[@i_3569, @i_3570]) in
                      event fullCT(hostT, hostS, n3_3050, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3051: symseed;
                      new tc'_3052: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3052), SK_63, r2_3051) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3052)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3568 <= N suchthat defined(x_3231[@i_3568], r11_1430[@i_3568], z_3230[@i_3568]) && ((@i_1384[@i_3568] = @i_183) && (z_3230[@i_3568] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3050, tt_62: timest, =hostS)) = injbot2(x_3231[@i_3568]) in
                      event fullCT(hostT, hostS, n3_3050, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3051: symseed;
                      new tc'_3052: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3052), SK_63, r2_3051) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3052)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    else
                      let injbot2(concat8(SK_63: key, =n3_3050, tt_62: timest, =hostS)) = bottom in
                      event fullCT(hostT, hostS, n3_3050, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3051: symseed;
                      new tc'_3052: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3052), SK_63, r2_3051) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3052)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3053: symseed;
                    new tc_3054: timest;
                    let e5: maxmac = encsym(pad(C, tc_3054), kgen(s3_1366[@i_183]), r7_3053) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3055: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3055));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3055, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3055, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3056: symseed;
                    new tc'_3057: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3057), SK_63, r2_3056) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3057)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3058: symseed;
                    new tc_3059: timest;
                    let x_3187: maxenc = pad(C, tc_3059) in
                    let z_3186: maxmac = encsym(x_3187, kgen2(s3_1372[@i_183]), r7_3058) in
                    let e5: maxmac = z_3186 in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3060: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3060));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    find @i_3701 <= N suchthat defined(x_3164[@i_3701], r11_1433[@i_3701], z_3163[@i_3701]) && ((@i_1384[@i_3701] = @i_183) && (z_3163[@i_3701] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3060, tt_62: timest, =hostS)) = injbot2(x_3164[@i_3701]) in
                      event fullCT(hostT, hostS, n3_3060, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3061: symseed;
                      new tc'_3062: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3062), SK_63, r2_3061) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3062)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3696 <= N3, @i_3697 <= N suchthat defined(x_3167[@i_3696, @i_3697], r7_3008[@i_3696, @i_3697], z_3166[@i_3696, @i_3697]) && ((@i_183[@i_3697] = @i_183) && (z_3166[@i_3696, @i_3697] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3060, tt_62: timest, =hostS)) = injbot2(x_3167[@i_3696, @i_3697]) in
                      event fullCT(hostT, hostS, n3_3060, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3061: symseed;
                      new tc'_3062: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3062), SK_63, r2_3061) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3062)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3692 <= N3, @i_3693 <= N suchthat defined(x_3171[@i_3692, @i_3693], r7_3018[@i_3692, @i_3693], z_3170[@i_3692, @i_3693]) && ((@i_183[@i_3693] = @i_183) && (z_3170[@i_3692, @i_3693] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3060, tt_62: timest, =hostS)) = injbot2(x_3171[@i_3692, @i_3693]) in
                      event fullCT(hostT, hostS, n3_3060, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3061: symseed;
                      new tc'_3062: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3062), SK_63, r2_3061) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3062)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3688 <= N3, @i_3689 <= N suchthat defined(x_3175[@i_3688, @i_3689], r7_3028[@i_3688, @i_3689], z_3174[@i_3688, @i_3689]) && ((@i_183[@i_3689] = @i_183) && (z_3174[@i_3688, @i_3689] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3060, tt_62: timest, =hostS)) = injbot2(x_3175[@i_3688, @i_3689]) in
                      event fullCT(hostT, hostS, n3_3060, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3061: symseed;
                      new tc'_3062: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3062), SK_63, r2_3061) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3062)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3684 <= N3, @i_3685 <= N suchthat defined(x_3179[@i_3684, @i_3685], r7_3038[@i_3684, @i_3685], z_3178[@i_3684, @i_3685]) && ((@i_183[@i_3685] = @i_183) && (z_3178[@i_3684, @i_3685] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3060, tt_62: timest, =hostS)) = injbot2(x_3179[@i_3684, @i_3685]) in
                      event fullCT(hostT, hostS, n3_3060, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3061: symseed;
                      new tc'_3062: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3062), SK_63, r2_3061) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3062)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3680 <= N3, @i_3681 <= N suchthat defined(x_3183[@i_3680, @i_3681], r7_3048[@i_3680, @i_3681], z_3182[@i_3680, @i_3681]) && ((@i_183[@i_3681] = @i_183) && (z_3182[@i_3680, @i_3681] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3060, tt_62: timest, =hostS)) = injbot2(x_3183[@i_3680, @i_3681]) in
                      event fullCT(hostT, hostS, n3_3060, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3061: symseed;
                      new tc'_3062: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3062), SK_63, r2_3061) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3062)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3676 <= N3, @i_3677 <= N suchthat defined(x_3187[@i_3676, @i_3677], r7_3058[@i_3676, @i_3677], z_3186[@i_3676, @i_3677]) && ((@i_183[@i_3677] = @i_183) && (z_3186[@i_3676, @i_3677] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3060, tt_62: timest, =hostS)) = injbot2(x_3187[@i_3676, @i_3677]) in
                      event fullCT(hostT, hostS, n3_3060, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3061: symseed;
                      new tc'_3062: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3062), SK_63, r2_3061) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3062)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3672 <= N3, @i_3673 <= N suchthat defined(x_3191[@i_3672, @i_3673], r7_3068[@i_3672, @i_3673], z_3190[@i_3672, @i_3673]) && ((@i_183[@i_3673] = @i_183) && (z_3190[@i_3672, @i_3673] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3060, tt_62: timest, =hostS)) = injbot2(x_3191[@i_3672, @i_3673]) in
                      event fullCT(hostT, hostS, n3_3060, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3061: symseed;
                      new tc'_3062: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3062), SK_63, r2_3061) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3062)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3668 <= N3, @i_3669 <= N suchthat defined(x_3195[@i_3668, @i_3669], r7_3078[@i_3668, @i_3669], z_3194[@i_3668, @i_3669]) && ((@i_183[@i_3669] = @i_183) && (z_3194[@i_3668, @i_3669] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3060, tt_62: timest, =hostS)) = injbot2(x_3195[@i_3668, @i_3669]) in
                      event fullCT(hostT, hostS, n3_3060, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3061: symseed;
                      new tc'_3062: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3062), SK_63, r2_3061) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3062)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3664 <= N3, @i_3665 <= N suchthat defined(x_3199[@i_3664, @i_3665], r7_3088[@i_3664, @i_3665], z_3198[@i_3664, @i_3665]) && ((@i_183[@i_3665] = @i_183) && (z_3198[@i_3664, @i_3665] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3060, tt_62: timest, =hostS)) = injbot2(x_3199[@i_3664, @i_3665]) in
                      event fullCT(hostT, hostS, n3_3060, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3061: symseed;
                      new tc'_3062: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3062), SK_63, r2_3061) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3062)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3660 <= N3, @i_3661 <= N suchthat defined(x_3203[@i_3660, @i_3661], r7_3098[@i_3660, @i_3661], z_3202[@i_3660, @i_3661]) && ((@i_183[@i_3661] = @i_183) && (z_3202[@i_3660, @i_3661] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3060, tt_62: timest, =hostS)) = injbot2(x_3203[@i_3660, @i_3661]) in
                      event fullCT(hostT, hostS, n3_3060, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3061: symseed;
                      new tc'_3062: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3062), SK_63, r2_3061) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3062)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3656 <= N3, @i_3657 <= N suchthat defined(x_3207[@i_3656, @i_3657], r7_3108[@i_3656, @i_3657], z_3206[@i_3656, @i_3657]) && ((@i_183[@i_3657] = @i_183) && (z_3206[@i_3656, @i_3657] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3060, tt_62: timest, =hostS)) = injbot2(x_3207[@i_3656, @i_3657]) in
                      event fullCT(hostT, hostS, n3_3060, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3061: symseed;
                      new tc'_3062: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3062), SK_63, r2_3061) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3062)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3652 <= N3, @i_3653 <= N suchthat defined(x_3211[@i_3652, @i_3653], r7_3118[@i_3652, @i_3653], z_3210[@i_3652, @i_3653]) && ((@i_183[@i_3653] = @i_183) && (z_3210[@i_3652, @i_3653] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3060, tt_62: timest, =hostS)) = injbot2(x_3211[@i_3652, @i_3653]) in
                      event fullCT(hostT, hostS, n3_3060, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3061: symseed;
                      new tc'_3062: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3062), SK_63, r2_3061) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3062)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3648 <= N3, @i_3649 <= N suchthat defined(x_3215[@i_3648, @i_3649], r7_3128[@i_3648, @i_3649], z_3214[@i_3648, @i_3649]) && ((@i_183[@i_3649] = @i_183) && (z_3214[@i_3648, @i_3649] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3060, tt_62: timest, =hostS)) = injbot2(x_3215[@i_3648, @i_3649]) in
                      event fullCT(hostT, hostS, n3_3060, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3061: symseed;
                      new tc'_3062: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3062), SK_63, r2_3061) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3062)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3644 <= N3, @i_3645 <= N suchthat defined(x_3219[@i_3644, @i_3645], r7_3138[@i_3644, @i_3645], z_3218[@i_3644, @i_3645]) && ((@i_183[@i_3645] = @i_183) && (z_3218[@i_3644, @i_3645] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3060, tt_62: timest, =hostS)) = injbot2(x_3219[@i_3644, @i_3645]) in
                      event fullCT(hostT, hostS, n3_3060, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3061: symseed;
                      new tc'_3062: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3062), SK_63, r2_3061) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3062)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3640 <= N3, @i_3641 <= N suchthat defined(x_3223[@i_3640, @i_3641], r7_3148[@i_3640, @i_3641], z_3222[@i_3640, @i_3641]) && ((@i_183[@i_3641] = @i_183) && (z_3222[@i_3640, @i_3641] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3060, tt_62: timest, =hostS)) = injbot2(x_3223[@i_3640, @i_3641]) in
                      event fullCT(hostT, hostS, n3_3060, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3061: symseed;
                      new tc'_3062: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3062), SK_63, r2_3061) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3062)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3636 <= N3, @i_3637 <= N suchthat defined(x_3227[@i_3636, @i_3637], r7_3158[@i_3636, @i_3637], z_3226[@i_3636, @i_3637]) && ((@i_183[@i_3637] = @i_183) && (z_3226[@i_3636, @i_3637] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3060, tt_62: timest, =hostS)) = injbot2(x_3227[@i_3636, @i_3637]) in
                      event fullCT(hostT, hostS, n3_3060, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3061: symseed;
                      new tc'_3062: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3062), SK_63, r2_3061) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3062)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3635 <= N suchthat defined(x_3231[@i_3635], r11_1430[@i_3635], z_3230[@i_3635]) && ((@i_1384[@i_3635] = @i_183) && (z_3230[@i_3635] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3060, tt_62: timest, =hostS)) = injbot2(x_3231[@i_3635]) in
                      event fullCT(hostT, hostS, n3_3060, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3061: symseed;
                      new tc'_3062: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3062), SK_63, r2_3061) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3062)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    else
                      let injbot2(concat8(SK_63: key, =n3_3060, tt_62: timest, =hostS)) = bottom in
                      event fullCT(hostT, hostS, n3_3060, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3061: symseed;
                      new tc'_3062: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3062), SK_63, r2_3061) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3062)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3063: symseed;
                    new tc_3064: timest;
                    let e5: maxmac = encsym(pad(C, tc_3064), kgen(s3_1366[@i_183]), r7_3063) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3065: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3065));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3065, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3065, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3066: symseed;
                    new tc'_3067: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3067), SK_63, r2_3066) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3067)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3068: symseed;
                    new tc_3069: timest;
                    let x_3191: maxenc = pad(C, tc_3069) in
                    let z_3190: maxmac = encsym(x_3191, kgen2(s3_1372[@i_183]), r7_3068) in
                    let e5: maxmac = z_3190 in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3070: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3070));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    find @i_3768 <= N suchthat defined(x_3164[@i_3768], r11_1433[@i_3768], z_3163[@i_3768]) && ((@i_1384[@i_3768] = @i_183) && (z_3163[@i_3768] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3070, tt_62: timest, =hostS)) = injbot2(x_3164[@i_3768]) in
                      event fullCT(hostT, hostS, n3_3070, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3071: symseed;
                      new tc'_3072: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3072), SK_63, r2_3071) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3072)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3763 <= N3, @i_3764 <= N suchthat defined(x_3167[@i_3763, @i_3764], r7_3008[@i_3763, @i_3764], z_3166[@i_3763, @i_3764]) && ((@i_183[@i_3764] = @i_183) && (z_3166[@i_3763, @i_3764] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3070, tt_62: timest, =hostS)) = injbot2(x_3167[@i_3763, @i_3764]) in
                      event fullCT(hostT, hostS, n3_3070, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3071: symseed;
                      new tc'_3072: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3072), SK_63, r2_3071) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3072)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3759 <= N3, @i_3760 <= N suchthat defined(x_3171[@i_3759, @i_3760], r7_3018[@i_3759, @i_3760], z_3170[@i_3759, @i_3760]) && ((@i_183[@i_3760] = @i_183) && (z_3170[@i_3759, @i_3760] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3070, tt_62: timest, =hostS)) = injbot2(x_3171[@i_3759, @i_3760]) in
                      event fullCT(hostT, hostS, n3_3070, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3071: symseed;
                      new tc'_3072: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3072), SK_63, r2_3071) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3072)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3755 <= N3, @i_3756 <= N suchthat defined(x_3175[@i_3755, @i_3756], r7_3028[@i_3755, @i_3756], z_3174[@i_3755, @i_3756]) && ((@i_183[@i_3756] = @i_183) && (z_3174[@i_3755, @i_3756] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3070, tt_62: timest, =hostS)) = injbot2(x_3175[@i_3755, @i_3756]) in
                      event fullCT(hostT, hostS, n3_3070, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3071: symseed;
                      new tc'_3072: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3072), SK_63, r2_3071) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3072)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3751 <= N3, @i_3752 <= N suchthat defined(x_3179[@i_3751, @i_3752], r7_3038[@i_3751, @i_3752], z_3178[@i_3751, @i_3752]) && ((@i_183[@i_3752] = @i_183) && (z_3178[@i_3751, @i_3752] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3070, tt_62: timest, =hostS)) = injbot2(x_3179[@i_3751, @i_3752]) in
                      event fullCT(hostT, hostS, n3_3070, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3071: symseed;
                      new tc'_3072: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3072), SK_63, r2_3071) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3072)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3747 <= N3, @i_3748 <= N suchthat defined(x_3183[@i_3747, @i_3748], r7_3048[@i_3747, @i_3748], z_3182[@i_3747, @i_3748]) && ((@i_183[@i_3748] = @i_183) && (z_3182[@i_3747, @i_3748] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3070, tt_62: timest, =hostS)) = injbot2(x_3183[@i_3747, @i_3748]) in
                      event fullCT(hostT, hostS, n3_3070, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3071: symseed;
                      new tc'_3072: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3072), SK_63, r2_3071) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3072)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3743 <= N3, @i_3744 <= N suchthat defined(x_3187[@i_3743, @i_3744], r7_3058[@i_3743, @i_3744], z_3186[@i_3743, @i_3744]) && ((@i_183[@i_3744] = @i_183) && (z_3186[@i_3743, @i_3744] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3070, tt_62: timest, =hostS)) = injbot2(x_3187[@i_3743, @i_3744]) in
                      event fullCT(hostT, hostS, n3_3070, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3071: symseed;
                      new tc'_3072: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3072), SK_63, r2_3071) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3072)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3739 <= N3, @i_3740 <= N suchthat defined(x_3191[@i_3739, @i_3740], r7_3068[@i_3739, @i_3740], z_3190[@i_3739, @i_3740]) && ((@i_183[@i_3740] = @i_183) && (z_3190[@i_3739, @i_3740] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3070, tt_62: timest, =hostS)) = injbot2(x_3191[@i_3739, @i_3740]) in
                      event fullCT(hostT, hostS, n3_3070, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3071: symseed;
                      new tc'_3072: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3072), SK_63, r2_3071) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3072)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3735 <= N3, @i_3736 <= N suchthat defined(x_3195[@i_3735, @i_3736], r7_3078[@i_3735, @i_3736], z_3194[@i_3735, @i_3736]) && ((@i_183[@i_3736] = @i_183) && (z_3194[@i_3735, @i_3736] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3070, tt_62: timest, =hostS)) = injbot2(x_3195[@i_3735, @i_3736]) in
                      event fullCT(hostT, hostS, n3_3070, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3071: symseed;
                      new tc'_3072: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3072), SK_63, r2_3071) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3072)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3731 <= N3, @i_3732 <= N suchthat defined(x_3199[@i_3731, @i_3732], r7_3088[@i_3731, @i_3732], z_3198[@i_3731, @i_3732]) && ((@i_183[@i_3732] = @i_183) && (z_3198[@i_3731, @i_3732] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3070, tt_62: timest, =hostS)) = injbot2(x_3199[@i_3731, @i_3732]) in
                      event fullCT(hostT, hostS, n3_3070, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3071: symseed;
                      new tc'_3072: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3072), SK_63, r2_3071) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3072)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3727 <= N3, @i_3728 <= N suchthat defined(x_3203[@i_3727, @i_3728], r7_3098[@i_3727, @i_3728], z_3202[@i_3727, @i_3728]) && ((@i_183[@i_3728] = @i_183) && (z_3202[@i_3727, @i_3728] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3070, tt_62: timest, =hostS)) = injbot2(x_3203[@i_3727, @i_3728]) in
                      event fullCT(hostT, hostS, n3_3070, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3071: symseed;
                      new tc'_3072: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3072), SK_63, r2_3071) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3072)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3723 <= N3, @i_3724 <= N suchthat defined(x_3207[@i_3723, @i_3724], r7_3108[@i_3723, @i_3724], z_3206[@i_3723, @i_3724]) && ((@i_183[@i_3724] = @i_183) && (z_3206[@i_3723, @i_3724] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3070, tt_62: timest, =hostS)) = injbot2(x_3207[@i_3723, @i_3724]) in
                      event fullCT(hostT, hostS, n3_3070, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3071: symseed;
                      new tc'_3072: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3072), SK_63, r2_3071) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3072)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3719 <= N3, @i_3720 <= N suchthat defined(x_3211[@i_3719, @i_3720], r7_3118[@i_3719, @i_3720], z_3210[@i_3719, @i_3720]) && ((@i_183[@i_3720] = @i_183) && (z_3210[@i_3719, @i_3720] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3070, tt_62: timest, =hostS)) = injbot2(x_3211[@i_3719, @i_3720]) in
                      event fullCT(hostT, hostS, n3_3070, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3071: symseed;
                      new tc'_3072: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3072), SK_63, r2_3071) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3072)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3715 <= N3, @i_3716 <= N suchthat defined(x_3215[@i_3715, @i_3716], r7_3128[@i_3715, @i_3716], z_3214[@i_3715, @i_3716]) && ((@i_183[@i_3716] = @i_183) && (z_3214[@i_3715, @i_3716] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3070, tt_62: timest, =hostS)) = injbot2(x_3215[@i_3715, @i_3716]) in
                      event fullCT(hostT, hostS, n3_3070, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3071: symseed;
                      new tc'_3072: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3072), SK_63, r2_3071) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3072)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3711 <= N3, @i_3712 <= N suchthat defined(x_3219[@i_3711, @i_3712], r7_3138[@i_3711, @i_3712], z_3218[@i_3711, @i_3712]) && ((@i_183[@i_3712] = @i_183) && (z_3218[@i_3711, @i_3712] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3070, tt_62: timest, =hostS)) = injbot2(x_3219[@i_3711, @i_3712]) in
                      event fullCT(hostT, hostS, n3_3070, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3071: symseed;
                      new tc'_3072: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3072), SK_63, r2_3071) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3072)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3707 <= N3, @i_3708 <= N suchthat defined(x_3223[@i_3707, @i_3708], r7_3148[@i_3707, @i_3708], z_3222[@i_3707, @i_3708]) && ((@i_183[@i_3708] = @i_183) && (z_3222[@i_3707, @i_3708] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3070, tt_62: timest, =hostS)) = injbot2(x_3223[@i_3707, @i_3708]) in
                      event fullCT(hostT, hostS, n3_3070, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3071: symseed;
                      new tc'_3072: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3072), SK_63, r2_3071) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3072)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3703 <= N3, @i_3704 <= N suchthat defined(x_3227[@i_3703, @i_3704], r7_3158[@i_3703, @i_3704], z_3226[@i_3703, @i_3704]) && ((@i_183[@i_3704] = @i_183) && (z_3226[@i_3703, @i_3704] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3070, tt_62: timest, =hostS)) = injbot2(x_3227[@i_3703, @i_3704]) in
                      event fullCT(hostT, hostS, n3_3070, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3071: symseed;
                      new tc'_3072: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3072), SK_63, r2_3071) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3072)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3702 <= N suchthat defined(x_3231[@i_3702], r11_1430[@i_3702], z_3230[@i_3702]) && ((@i_1384[@i_3702] = @i_183) && (z_3230[@i_3702] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3070, tt_62: timest, =hostS)) = injbot2(x_3231[@i_3702]) in
                      event fullCT(hostT, hostS, n3_3070, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3071: symseed;
                      new tc'_3072: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3072), SK_63, r2_3071) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3072)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    else
                      let injbot2(concat8(SK_63: key, =n3_3070, tt_62: timest, =hostS)) = bottom in
                      event fullCT(hostT, hostS, n3_3070, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3071: symseed;
                      new tc'_3072: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3072), SK_63, r2_3071) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3072)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3073: symseed;
                    new tc_3074: timest;
                    let e5: maxmac = encsym(pad(C, tc_3074), kgen(s3_1366[@i_183]), r7_3073) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3075: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3075));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3075, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3075, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3076: symseed;
                    new tc'_3077: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3077), SK_63, r2_3076) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3077)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3078: symseed;
                    new tc_3079: timest;
                    let x_3195: maxenc = pad(C, tc_3079) in
                    let z_3194: maxmac = encsym(x_3195, kgen2(s3_1372[@i_183]), r7_3078) in
                    let e5: maxmac = z_3194 in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3080: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3080));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    find @i_3835 <= N suchthat defined(x_3164[@i_3835], r11_1433[@i_3835], z_3163[@i_3835]) && ((@i_1384[@i_3835] = @i_183) && (z_3163[@i_3835] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3080, tt_62: timest, =hostS)) = injbot2(x_3164[@i_3835]) in
                      event fullCT(hostT, hostS, n3_3080, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3081: symseed;
                      new tc'_3082: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3082), SK_63, r2_3081) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3082)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3830 <= N3, @i_3831 <= N suchthat defined(x_3167[@i_3830, @i_3831], r7_3008[@i_3830, @i_3831], z_3166[@i_3830, @i_3831]) && ((@i_183[@i_3831] = @i_183) && (z_3166[@i_3830, @i_3831] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3080, tt_62: timest, =hostS)) = injbot2(x_3167[@i_3830, @i_3831]) in
                      event fullCT(hostT, hostS, n3_3080, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3081: symseed;
                      new tc'_3082: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3082), SK_63, r2_3081) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3082)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3826 <= N3, @i_3827 <= N suchthat defined(x_3171[@i_3826, @i_3827], r7_3018[@i_3826, @i_3827], z_3170[@i_3826, @i_3827]) && ((@i_183[@i_3827] = @i_183) && (z_3170[@i_3826, @i_3827] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3080, tt_62: timest, =hostS)) = injbot2(x_3171[@i_3826, @i_3827]) in
                      event fullCT(hostT, hostS, n3_3080, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3081: symseed;
                      new tc'_3082: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3082), SK_63, r2_3081) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3082)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3822 <= N3, @i_3823 <= N suchthat defined(x_3175[@i_3822, @i_3823], r7_3028[@i_3822, @i_3823], z_3174[@i_3822, @i_3823]) && ((@i_183[@i_3823] = @i_183) && (z_3174[@i_3822, @i_3823] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3080, tt_62: timest, =hostS)) = injbot2(x_3175[@i_3822, @i_3823]) in
                      event fullCT(hostT, hostS, n3_3080, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3081: symseed;
                      new tc'_3082: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3082), SK_63, r2_3081) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3082)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3818 <= N3, @i_3819 <= N suchthat defined(x_3179[@i_3818, @i_3819], r7_3038[@i_3818, @i_3819], z_3178[@i_3818, @i_3819]) && ((@i_183[@i_3819] = @i_183) && (z_3178[@i_3818, @i_3819] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3080, tt_62: timest, =hostS)) = injbot2(x_3179[@i_3818, @i_3819]) in
                      event fullCT(hostT, hostS, n3_3080, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3081: symseed;
                      new tc'_3082: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3082), SK_63, r2_3081) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3082)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3814 <= N3, @i_3815 <= N suchthat defined(x_3183[@i_3814, @i_3815], r7_3048[@i_3814, @i_3815], z_3182[@i_3814, @i_3815]) && ((@i_183[@i_3815] = @i_183) && (z_3182[@i_3814, @i_3815] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3080, tt_62: timest, =hostS)) = injbot2(x_3183[@i_3814, @i_3815]) in
                      event fullCT(hostT, hostS, n3_3080, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3081: symseed;
                      new tc'_3082: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3082), SK_63, r2_3081) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3082)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3810 <= N3, @i_3811 <= N suchthat defined(x_3187[@i_3810, @i_3811], r7_3058[@i_3810, @i_3811], z_3186[@i_3810, @i_3811]) && ((@i_183[@i_3811] = @i_183) && (z_3186[@i_3810, @i_3811] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3080, tt_62: timest, =hostS)) = injbot2(x_3187[@i_3810, @i_3811]) in
                      event fullCT(hostT, hostS, n3_3080, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3081: symseed;
                      new tc'_3082: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3082), SK_63, r2_3081) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3082)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3806 <= N3, @i_3807 <= N suchthat defined(x_3191[@i_3806, @i_3807], r7_3068[@i_3806, @i_3807], z_3190[@i_3806, @i_3807]) && ((@i_183[@i_3807] = @i_183) && (z_3190[@i_3806, @i_3807] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3080, tt_62: timest, =hostS)) = injbot2(x_3191[@i_3806, @i_3807]) in
                      event fullCT(hostT, hostS, n3_3080, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3081: symseed;
                      new tc'_3082: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3082), SK_63, r2_3081) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3082)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3802 <= N3, @i_3803 <= N suchthat defined(x_3195[@i_3802, @i_3803], r7_3078[@i_3802, @i_3803], z_3194[@i_3802, @i_3803]) && ((@i_183[@i_3803] = @i_183) && (z_3194[@i_3802, @i_3803] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3080, tt_62: timest, =hostS)) = injbot2(x_3195[@i_3802, @i_3803]) in
                      event fullCT(hostT, hostS, n3_3080, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3081: symseed;
                      new tc'_3082: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3082), SK_63, r2_3081) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3082)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3798 <= N3, @i_3799 <= N suchthat defined(x_3199[@i_3798, @i_3799], r7_3088[@i_3798, @i_3799], z_3198[@i_3798, @i_3799]) && ((@i_183[@i_3799] = @i_183) && (z_3198[@i_3798, @i_3799] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3080, tt_62: timest, =hostS)) = injbot2(x_3199[@i_3798, @i_3799]) in
                      event fullCT(hostT, hostS, n3_3080, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3081: symseed;
                      new tc'_3082: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3082), SK_63, r2_3081) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3082)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3794 <= N3, @i_3795 <= N suchthat defined(x_3203[@i_3794, @i_3795], r7_3098[@i_3794, @i_3795], z_3202[@i_3794, @i_3795]) && ((@i_183[@i_3795] = @i_183) && (z_3202[@i_3794, @i_3795] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3080, tt_62: timest, =hostS)) = injbot2(x_3203[@i_3794, @i_3795]) in
                      event fullCT(hostT, hostS, n3_3080, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3081: symseed;
                      new tc'_3082: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3082), SK_63, r2_3081) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3082)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3790 <= N3, @i_3791 <= N suchthat defined(x_3207[@i_3790, @i_3791], r7_3108[@i_3790, @i_3791], z_3206[@i_3790, @i_3791]) && ((@i_183[@i_3791] = @i_183) && (z_3206[@i_3790, @i_3791] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3080, tt_62: timest, =hostS)) = injbot2(x_3207[@i_3790, @i_3791]) in
                      event fullCT(hostT, hostS, n3_3080, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3081: symseed;
                      new tc'_3082: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3082), SK_63, r2_3081) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3082)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3786 <= N3, @i_3787 <= N suchthat defined(x_3211[@i_3786, @i_3787], r7_3118[@i_3786, @i_3787], z_3210[@i_3786, @i_3787]) && ((@i_183[@i_3787] = @i_183) && (z_3210[@i_3786, @i_3787] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3080, tt_62: timest, =hostS)) = injbot2(x_3211[@i_3786, @i_3787]) in
                      event fullCT(hostT, hostS, n3_3080, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3081: symseed;
                      new tc'_3082: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3082), SK_63, r2_3081) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3082)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3782 <= N3, @i_3783 <= N suchthat defined(x_3215[@i_3782, @i_3783], r7_3128[@i_3782, @i_3783], z_3214[@i_3782, @i_3783]) && ((@i_183[@i_3783] = @i_183) && (z_3214[@i_3782, @i_3783] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3080, tt_62: timest, =hostS)) = injbot2(x_3215[@i_3782, @i_3783]) in
                      event fullCT(hostT, hostS, n3_3080, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3081: symseed;
                      new tc'_3082: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3082), SK_63, r2_3081) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3082)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3778 <= N3, @i_3779 <= N suchthat defined(x_3219[@i_3778, @i_3779], r7_3138[@i_3778, @i_3779], z_3218[@i_3778, @i_3779]) && ((@i_183[@i_3779] = @i_183) && (z_3218[@i_3778, @i_3779] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3080, tt_62: timest, =hostS)) = injbot2(x_3219[@i_3778, @i_3779]) in
                      event fullCT(hostT, hostS, n3_3080, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3081: symseed;
                      new tc'_3082: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3082), SK_63, r2_3081) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3082)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3774 <= N3, @i_3775 <= N suchthat defined(x_3223[@i_3774, @i_3775], r7_3148[@i_3774, @i_3775], z_3222[@i_3774, @i_3775]) && ((@i_183[@i_3775] = @i_183) && (z_3222[@i_3774, @i_3775] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3080, tt_62: timest, =hostS)) = injbot2(x_3223[@i_3774, @i_3775]) in
                      event fullCT(hostT, hostS, n3_3080, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3081: symseed;
                      new tc'_3082: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3082), SK_63, r2_3081) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3082)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3770 <= N3, @i_3771 <= N suchthat defined(x_3227[@i_3770, @i_3771], r7_3158[@i_3770, @i_3771], z_3226[@i_3770, @i_3771]) && ((@i_183[@i_3771] = @i_183) && (z_3226[@i_3770, @i_3771] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3080, tt_62: timest, =hostS)) = injbot2(x_3227[@i_3770, @i_3771]) in
                      event fullCT(hostT, hostS, n3_3080, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3081: symseed;
                      new tc'_3082: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3082), SK_63, r2_3081) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3082)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3769 <= N suchthat defined(x_3231[@i_3769], r11_1430[@i_3769], z_3230[@i_3769]) && ((@i_1384[@i_3769] = @i_183) && (z_3230[@i_3769] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3080, tt_62: timest, =hostS)) = injbot2(x_3231[@i_3769]) in
                      event fullCT(hostT, hostS, n3_3080, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3081: symseed;
                      new tc'_3082: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3082), SK_63, r2_3081) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3082)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    else
                      let injbot2(concat8(SK_63: key, =n3_3080, tt_62: timest, =hostS)) = bottom in
                      event fullCT(hostT, hostS, n3_3080, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3081: symseed;
                      new tc'_3082: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3082), SK_63, r2_3081) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3082)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
              find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3083: symseed;
                    new tc_3084: timest;
                    let e5: maxmac = encsym(pad(C, tc_3084), kgen(s3_1366[@i_183]), r7_3083) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3085: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3085));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3085, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3085, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3086: symseed;
                    new tc'_3087: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3087), SK_63, r2_3086) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3087)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3088: symseed;
                    new tc_3089: timest;
                    let x_3199: maxenc = pad(C, tc_3089) in
                    let z_3198: maxmac = encsym(x_3199, kgen2(s3_1372[@i_183]), r7_3088) in
                    let e5: maxmac = z_3198 in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3090: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3090));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    find @i_3902 <= N suchthat defined(x_3164[@i_3902], r11_1433[@i_3902], z_3163[@i_3902]) && ((@i_1384[@i_3902] = @i_183) && (z_3163[@i_3902] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3090, tt_62: timest, =hostS)) = injbot2(x_3164[@i_3902]) in
                      event fullCT(hostT, hostS, n3_3090, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3091: symseed;
                      new tc'_3092: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3092), SK_63, r2_3091) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3092)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3897 <= N3, @i_3898 <= N suchthat defined(x_3167[@i_3897, @i_3898], r7_3008[@i_3897, @i_3898], z_3166[@i_3897, @i_3898]) && ((@i_183[@i_3898] = @i_183) && (z_3166[@i_3897, @i_3898] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3090, tt_62: timest, =hostS)) = injbot2(x_3167[@i_3897, @i_3898]) in
                      event fullCT(hostT, hostS, n3_3090, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3091: symseed;
                      new tc'_3092: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3092), SK_63, r2_3091) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3092)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3893 <= N3, @i_3894 <= N suchthat defined(x_3171[@i_3893, @i_3894], r7_3018[@i_3893, @i_3894], z_3170[@i_3893, @i_3894]) && ((@i_183[@i_3894] = @i_183) && (z_3170[@i_3893, @i_3894] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3090, tt_62: timest, =hostS)) = injbot2(x_3171[@i_3893, @i_3894]) in
                      event fullCT(hostT, hostS, n3_3090, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3091: symseed;
                      new tc'_3092: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3092), SK_63, r2_3091) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3092)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3889 <= N3, @i_3890 <= N suchthat defined(x_3175[@i_3889, @i_3890], r7_3028[@i_3889, @i_3890], z_3174[@i_3889, @i_3890]) && ((@i_183[@i_3890] = @i_183) && (z_3174[@i_3889, @i_3890] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3090, tt_62: timest, =hostS)) = injbot2(x_3175[@i_3889, @i_3890]) in
                      event fullCT(hostT, hostS, n3_3090, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3091: symseed;
                      new tc'_3092: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3092), SK_63, r2_3091) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3092)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3885 <= N3, @i_3886 <= N suchthat defined(x_3179[@i_3885, @i_3886], r7_3038[@i_3885, @i_3886], z_3178[@i_3885, @i_3886]) && ((@i_183[@i_3886] = @i_183) && (z_3178[@i_3885, @i_3886] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3090, tt_62: timest, =hostS)) = injbot2(x_3179[@i_3885, @i_3886]) in
                      event fullCT(hostT, hostS, n3_3090, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3091: symseed;
                      new tc'_3092: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3092), SK_63, r2_3091) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3092)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3881 <= N3, @i_3882 <= N suchthat defined(x_3183[@i_3881, @i_3882], r7_3048[@i_3881, @i_3882], z_3182[@i_3881, @i_3882]) && ((@i_183[@i_3882] = @i_183) && (z_3182[@i_3881, @i_3882] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3090, tt_62: timest, =hostS)) = injbot2(x_3183[@i_3881, @i_3882]) in
                      event fullCT(hostT, hostS, n3_3090, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3091: symseed;
                      new tc'_3092: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3092), SK_63, r2_3091) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3092)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3877 <= N3, @i_3878 <= N suchthat defined(x_3187[@i_3877, @i_3878], r7_3058[@i_3877, @i_3878], z_3186[@i_3877, @i_3878]) && ((@i_183[@i_3878] = @i_183) && (z_3186[@i_3877, @i_3878] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3090, tt_62: timest, =hostS)) = injbot2(x_3187[@i_3877, @i_3878]) in
                      event fullCT(hostT, hostS, n3_3090, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3091: symseed;
                      new tc'_3092: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3092), SK_63, r2_3091) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3092)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3873 <= N3, @i_3874 <= N suchthat defined(x_3191[@i_3873, @i_3874], r7_3068[@i_3873, @i_3874], z_3190[@i_3873, @i_3874]) && ((@i_183[@i_3874] = @i_183) && (z_3190[@i_3873, @i_3874] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3090, tt_62: timest, =hostS)) = injbot2(x_3191[@i_3873, @i_3874]) in
                      event fullCT(hostT, hostS, n3_3090, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3091: symseed;
                      new tc'_3092: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3092), SK_63, r2_3091) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3092)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3869 <= N3, @i_3870 <= N suchthat defined(x_3195[@i_3869, @i_3870], r7_3078[@i_3869, @i_3870], z_3194[@i_3869, @i_3870]) && ((@i_183[@i_3870] = @i_183) && (z_3194[@i_3869, @i_3870] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3090, tt_62: timest, =hostS)) = injbot2(x_3195[@i_3869, @i_3870]) in
                      event fullCT(hostT, hostS, n3_3090, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3091: symseed;
                      new tc'_3092: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3092), SK_63, r2_3091) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3092)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3865 <= N3, @i_3866 <= N suchthat defined(x_3199[@i_3865, @i_3866], r7_3088[@i_3865, @i_3866], z_3198[@i_3865, @i_3866]) && ((@i_183[@i_3866] = @i_183) && (z_3198[@i_3865, @i_3866] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3090, tt_62: timest, =hostS)) = injbot2(x_3199[@i_3865, @i_3866]) in
                      event fullCT(hostT, hostS, n3_3090, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3091: symseed;
                      new tc'_3092: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3092), SK_63, r2_3091) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3092)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3861 <= N3, @i_3862 <= N suchthat defined(x_3203[@i_3861, @i_3862], r7_3098[@i_3861, @i_3862], z_3202[@i_3861, @i_3862]) && ((@i_183[@i_3862] = @i_183) && (z_3202[@i_3861, @i_3862] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3090, tt_62: timest, =hostS)) = injbot2(x_3203[@i_3861, @i_3862]) in
                      event fullCT(hostT, hostS, n3_3090, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3091: symseed;
                      new tc'_3092: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3092), SK_63, r2_3091) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3092)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3857 <= N3, @i_3858 <= N suchthat defined(x_3207[@i_3857, @i_3858], r7_3108[@i_3857, @i_3858], z_3206[@i_3857, @i_3858]) && ((@i_183[@i_3858] = @i_183) && (z_3206[@i_3857, @i_3858] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3090, tt_62: timest, =hostS)) = injbot2(x_3207[@i_3857, @i_3858]) in
                      event fullCT(hostT, hostS, n3_3090, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3091: symseed;
                      new tc'_3092: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3092), SK_63, r2_3091) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3092)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3853 <= N3, @i_3854 <= N suchthat defined(x_3211[@i_3853, @i_3854], r7_3118[@i_3853, @i_3854], z_3210[@i_3853, @i_3854]) && ((@i_183[@i_3854] = @i_183) && (z_3210[@i_3853, @i_3854] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3090, tt_62: timest, =hostS)) = injbot2(x_3211[@i_3853, @i_3854]) in
                      event fullCT(hostT, hostS, n3_3090, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3091: symseed;
                      new tc'_3092: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3092), SK_63, r2_3091) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3092)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3849 <= N3, @i_3850 <= N suchthat defined(x_3215[@i_3849, @i_3850], r7_3128[@i_3849, @i_3850], z_3214[@i_3849, @i_3850]) && ((@i_183[@i_3850] = @i_183) && (z_3214[@i_3849, @i_3850] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3090, tt_62: timest, =hostS)) = injbot2(x_3215[@i_3849, @i_3850]) in
                      event fullCT(hostT, hostS, n3_3090, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3091: symseed;
                      new tc'_3092: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3092), SK_63, r2_3091) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3092)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3845 <= N3, @i_3846 <= N suchthat defined(x_3219[@i_3845, @i_3846], r7_3138[@i_3845, @i_3846], z_3218[@i_3845, @i_3846]) && ((@i_183[@i_3846] = @i_183) && (z_3218[@i_3845, @i_3846] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3090, tt_62: timest, =hostS)) = injbot2(x_3219[@i_3845, @i_3846]) in
                      event fullCT(hostT, hostS, n3_3090, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3091: symseed;
                      new tc'_3092: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3092), SK_63, r2_3091) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3092)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3841 <= N3, @i_3842 <= N suchthat defined(x_3223[@i_3841, @i_3842], r7_3148[@i_3841, @i_3842], z_3222[@i_3841, @i_3842]) && ((@i_183[@i_3842] = @i_183) && (z_3222[@i_3841, @i_3842] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3090, tt_62: timest, =hostS)) = injbot2(x_3223[@i_3841, @i_3842]) in
                      event fullCT(hostT, hostS, n3_3090, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3091: symseed;
                      new tc'_3092: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3092), SK_63, r2_3091) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3092)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3837 <= N3, @i_3838 <= N suchthat defined(x_3227[@i_3837, @i_3838], r7_3158[@i_3837, @i_3838], z_3226[@i_3837, @i_3838]) && ((@i_183[@i_3838] = @i_183) && (z_3226[@i_3837, @i_3838] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3090, tt_62: timest, =hostS)) = injbot2(x_3227[@i_3837, @i_3838]) in
                      event fullCT(hostT, hostS, n3_3090, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3091: symseed;
                      new tc'_3092: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3092), SK_63, r2_3091) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3092)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3836 <= N suchthat defined(x_3231[@i_3836], r11_1430[@i_3836], z_3230[@i_3836]) && ((@i_1384[@i_3836] = @i_183) && (z_3230[@i_3836] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3090, tt_62: timest, =hostS)) = injbot2(x_3231[@i_3836]) in
                      event fullCT(hostT, hostS, n3_3090, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3091: symseed;
                      new tc'_3092: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3092), SK_63, r2_3091) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3092)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    else
                      let injbot2(concat8(SK_63: key, =n3_3090, tt_62: timest, =hostS)) = bottom in
                      event fullCT(hostT, hostS, n3_3090, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3091: symseed;
                      new tc'_3092: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3092), SK_63, r2_3091) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3092)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3093: symseed;
                    new tc_3094: timest;
                    let e5: maxmac = encsym(pad(C, tc_3094), kgen(s3_1366[@i_183]), r7_3093) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3095: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3095));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3095, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3095, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3096: symseed;
                    new tc'_3097: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3097), SK_63, r2_3096) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3097)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3098: symseed;
                    new tc_3099: timest;
                    let x_3203: maxenc = pad(C, tc_3099) in
                    let z_3202: maxmac = encsym(x_3203, kgen2(s3_1372[@i_183]), r7_3098) in
                    let e5: maxmac = z_3202 in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3100: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3100));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    find @i_3969 <= N suchthat defined(x_3164[@i_3969], r11_1433[@i_3969], z_3163[@i_3969]) && ((@i_1384[@i_3969] = @i_183) && (z_3163[@i_3969] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3100, tt_62: timest, =hostS)) = injbot2(x_3164[@i_3969]) in
                      event fullCT(hostT, hostS, n3_3100, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3101: symseed;
                      new tc'_3102: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3102), SK_63, r2_3101) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3102)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3964 <= N3, @i_3965 <= N suchthat defined(x_3167[@i_3964, @i_3965], r7_3008[@i_3964, @i_3965], z_3166[@i_3964, @i_3965]) && ((@i_183[@i_3965] = @i_183) && (z_3166[@i_3964, @i_3965] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3100, tt_62: timest, =hostS)) = injbot2(x_3167[@i_3964, @i_3965]) in
                      event fullCT(hostT, hostS, n3_3100, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3101: symseed;
                      new tc'_3102: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3102), SK_63, r2_3101) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3102)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3960 <= N3, @i_3961 <= N suchthat defined(x_3171[@i_3960, @i_3961], r7_3018[@i_3960, @i_3961], z_3170[@i_3960, @i_3961]) && ((@i_183[@i_3961] = @i_183) && (z_3170[@i_3960, @i_3961] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3100, tt_62: timest, =hostS)) = injbot2(x_3171[@i_3960, @i_3961]) in
                      event fullCT(hostT, hostS, n3_3100, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3101: symseed;
                      new tc'_3102: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3102), SK_63, r2_3101) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3102)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3956 <= N3, @i_3957 <= N suchthat defined(x_3175[@i_3956, @i_3957], r7_3028[@i_3956, @i_3957], z_3174[@i_3956, @i_3957]) && ((@i_183[@i_3957] = @i_183) && (z_3174[@i_3956, @i_3957] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3100, tt_62: timest, =hostS)) = injbot2(x_3175[@i_3956, @i_3957]) in
                      event fullCT(hostT, hostS, n3_3100, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3101: symseed;
                      new tc'_3102: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3102), SK_63, r2_3101) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3102)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3952 <= N3, @i_3953 <= N suchthat defined(x_3179[@i_3952, @i_3953], r7_3038[@i_3952, @i_3953], z_3178[@i_3952, @i_3953]) && ((@i_183[@i_3953] = @i_183) && (z_3178[@i_3952, @i_3953] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3100, tt_62: timest, =hostS)) = injbot2(x_3179[@i_3952, @i_3953]) in
                      event fullCT(hostT, hostS, n3_3100, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3101: symseed;
                      new tc'_3102: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3102), SK_63, r2_3101) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3102)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3948 <= N3, @i_3949 <= N suchthat defined(x_3183[@i_3948, @i_3949], r7_3048[@i_3948, @i_3949], z_3182[@i_3948, @i_3949]) && ((@i_183[@i_3949] = @i_183) && (z_3182[@i_3948, @i_3949] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3100, tt_62: timest, =hostS)) = injbot2(x_3183[@i_3948, @i_3949]) in
                      event fullCT(hostT, hostS, n3_3100, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3101: symseed;
                      new tc'_3102: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3102), SK_63, r2_3101) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3102)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3944 <= N3, @i_3945 <= N suchthat defined(x_3187[@i_3944, @i_3945], r7_3058[@i_3944, @i_3945], z_3186[@i_3944, @i_3945]) && ((@i_183[@i_3945] = @i_183) && (z_3186[@i_3944, @i_3945] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3100, tt_62: timest, =hostS)) = injbot2(x_3187[@i_3944, @i_3945]) in
                      event fullCT(hostT, hostS, n3_3100, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3101: symseed;
                      new tc'_3102: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3102), SK_63, r2_3101) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3102)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3940 <= N3, @i_3941 <= N suchthat defined(x_3191[@i_3940, @i_3941], r7_3068[@i_3940, @i_3941], z_3190[@i_3940, @i_3941]) && ((@i_183[@i_3941] = @i_183) && (z_3190[@i_3940, @i_3941] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3100, tt_62: timest, =hostS)) = injbot2(x_3191[@i_3940, @i_3941]) in
                      event fullCT(hostT, hostS, n3_3100, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3101: symseed;
                      new tc'_3102: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3102), SK_63, r2_3101) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3102)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3936 <= N3, @i_3937 <= N suchthat defined(x_3195[@i_3936, @i_3937], r7_3078[@i_3936, @i_3937], z_3194[@i_3936, @i_3937]) && ((@i_183[@i_3937] = @i_183) && (z_3194[@i_3936, @i_3937] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3100, tt_62: timest, =hostS)) = injbot2(x_3195[@i_3936, @i_3937]) in
                      event fullCT(hostT, hostS, n3_3100, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3101: symseed;
                      new tc'_3102: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3102), SK_63, r2_3101) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3102)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3932 <= N3, @i_3933 <= N suchthat defined(x_3199[@i_3932, @i_3933], r7_3088[@i_3932, @i_3933], z_3198[@i_3932, @i_3933]) && ((@i_183[@i_3933] = @i_183) && (z_3198[@i_3932, @i_3933] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3100, tt_62: timest, =hostS)) = injbot2(x_3199[@i_3932, @i_3933]) in
                      event fullCT(hostT, hostS, n3_3100, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3101: symseed;
                      new tc'_3102: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3102), SK_63, r2_3101) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3102)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3928 <= N3, @i_3929 <= N suchthat defined(x_3203[@i_3928, @i_3929], r7_3098[@i_3928, @i_3929], z_3202[@i_3928, @i_3929]) && ((@i_183[@i_3929] = @i_183) && (z_3202[@i_3928, @i_3929] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3100, tt_62: timest, =hostS)) = injbot2(x_3203[@i_3928, @i_3929]) in
                      event fullCT(hostT, hostS, n3_3100, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3101: symseed;
                      new tc'_3102: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3102), SK_63, r2_3101) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3102)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3924 <= N3, @i_3925 <= N suchthat defined(x_3207[@i_3924, @i_3925], r7_3108[@i_3924, @i_3925], z_3206[@i_3924, @i_3925]) && ((@i_183[@i_3925] = @i_183) && (z_3206[@i_3924, @i_3925] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3100, tt_62: timest, =hostS)) = injbot2(x_3207[@i_3924, @i_3925]) in
                      event fullCT(hostT, hostS, n3_3100, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3101: symseed;
                      new tc'_3102: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3102), SK_63, r2_3101) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3102)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3920 <= N3, @i_3921 <= N suchthat defined(x_3211[@i_3920, @i_3921], r7_3118[@i_3920, @i_3921], z_3210[@i_3920, @i_3921]) && ((@i_183[@i_3921] = @i_183) && (z_3210[@i_3920, @i_3921] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3100, tt_62: timest, =hostS)) = injbot2(x_3211[@i_3920, @i_3921]) in
                      event fullCT(hostT, hostS, n3_3100, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3101: symseed;
                      new tc'_3102: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3102), SK_63, r2_3101) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3102)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3916 <= N3, @i_3917 <= N suchthat defined(x_3215[@i_3916, @i_3917], r7_3128[@i_3916, @i_3917], z_3214[@i_3916, @i_3917]) && ((@i_183[@i_3917] = @i_183) && (z_3214[@i_3916, @i_3917] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3100, tt_62: timest, =hostS)) = injbot2(x_3215[@i_3916, @i_3917]) in
                      event fullCT(hostT, hostS, n3_3100, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3101: symseed;
                      new tc'_3102: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3102), SK_63, r2_3101) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3102)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3912 <= N3, @i_3913 <= N suchthat defined(x_3219[@i_3912, @i_3913], r7_3138[@i_3912, @i_3913], z_3218[@i_3912, @i_3913]) && ((@i_183[@i_3913] = @i_183) && (z_3218[@i_3912, @i_3913] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3100, tt_62: timest, =hostS)) = injbot2(x_3219[@i_3912, @i_3913]) in
                      event fullCT(hostT, hostS, n3_3100, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3101: symseed;
                      new tc'_3102: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3102), SK_63, r2_3101) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3102)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3908 <= N3, @i_3909 <= N suchthat defined(x_3223[@i_3908, @i_3909], r7_3148[@i_3908, @i_3909], z_3222[@i_3908, @i_3909]) && ((@i_183[@i_3909] = @i_183) && (z_3222[@i_3908, @i_3909] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3100, tt_62: timest, =hostS)) = injbot2(x_3223[@i_3908, @i_3909]) in
                      event fullCT(hostT, hostS, n3_3100, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3101: symseed;
                      new tc'_3102: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3102), SK_63, r2_3101) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3102)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3904 <= N3, @i_3905 <= N suchthat defined(x_3227[@i_3904, @i_3905], r7_3158[@i_3904, @i_3905], z_3226[@i_3904, @i_3905]) && ((@i_183[@i_3905] = @i_183) && (z_3226[@i_3904, @i_3905] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3100, tt_62: timest, =hostS)) = injbot2(x_3227[@i_3904, @i_3905]) in
                      event fullCT(hostT, hostS, n3_3100, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3101: symseed;
                      new tc'_3102: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3102), SK_63, r2_3101) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3102)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3903 <= N suchthat defined(x_3231[@i_3903], r11_1430[@i_3903], z_3230[@i_3903]) && ((@i_1384[@i_3903] = @i_183) && (z_3230[@i_3903] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3100, tt_62: timest, =hostS)) = injbot2(x_3231[@i_3903]) in
                      event fullCT(hostT, hostS, n3_3100, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3101: symseed;
                      new tc'_3102: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3102), SK_63, r2_3101) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3102)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    else
                      let injbot2(concat8(SK_63: key, =n3_3100, tt_62: timest, =hostS)) = bottom in
                      event fullCT(hostT, hostS, n3_3100, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3101: symseed;
                      new tc'_3102: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3102), SK_63, r2_3101) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3102)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3103: symseed;
                    new tc_3104: timest;
                    let e5: maxmac = encsym(pad(C, tc_3104), kgen(s3_1366[@i_183]), r7_3103) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3105: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3105));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3105, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3105, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3106: symseed;
                    new tc'_3107: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3107), SK_63, r2_3106) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3107)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3108: symseed;
                    new tc_3109: timest;
                    let x_3207: maxenc = pad(C, tc_3109) in
                    let z_3206: maxmac = encsym(x_3207, kgen2(s3_1372[@i_183]), r7_3108) in
                    let e5: maxmac = z_3206 in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3110: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3110));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    find @i_4036 <= N suchthat defined(x_3164[@i_4036], r11_1433[@i_4036], z_3163[@i_4036]) && ((@i_1384[@i_4036] = @i_183) && (z_3163[@i_4036] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3110, tt_62: timest, =hostS)) = injbot2(x_3164[@i_4036]) in
                      event fullCT(hostT, hostS, n3_3110, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3111: symseed;
                      new tc'_3112: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3112), SK_63, r2_3111) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3112)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4031 <= N3, @i_4032 <= N suchthat defined(x_3167[@i_4031, @i_4032], r7_3008[@i_4031, @i_4032], z_3166[@i_4031, @i_4032]) && ((@i_183[@i_4032] = @i_183) && (z_3166[@i_4031, @i_4032] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3110, tt_62: timest, =hostS)) = injbot2(x_3167[@i_4031, @i_4032]) in
                      event fullCT(hostT, hostS, n3_3110, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3111: symseed;
                      new tc'_3112: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3112), SK_63, r2_3111) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3112)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4027 <= N3, @i_4028 <= N suchthat defined(x_3171[@i_4027, @i_4028], r7_3018[@i_4027, @i_4028], z_3170[@i_4027, @i_4028]) && ((@i_183[@i_4028] = @i_183) && (z_3170[@i_4027, @i_4028] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3110, tt_62: timest, =hostS)) = injbot2(x_3171[@i_4027, @i_4028]) in
                      event fullCT(hostT, hostS, n3_3110, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3111: symseed;
                      new tc'_3112: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3112), SK_63, r2_3111) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3112)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4023 <= N3, @i_4024 <= N suchthat defined(x_3175[@i_4023, @i_4024], r7_3028[@i_4023, @i_4024], z_3174[@i_4023, @i_4024]) && ((@i_183[@i_4024] = @i_183) && (z_3174[@i_4023, @i_4024] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3110, tt_62: timest, =hostS)) = injbot2(x_3175[@i_4023, @i_4024]) in
                      event fullCT(hostT, hostS, n3_3110, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3111: symseed;
                      new tc'_3112: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3112), SK_63, r2_3111) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3112)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4019 <= N3, @i_4020 <= N suchthat defined(x_3179[@i_4019, @i_4020], r7_3038[@i_4019, @i_4020], z_3178[@i_4019, @i_4020]) && ((@i_183[@i_4020] = @i_183) && (z_3178[@i_4019, @i_4020] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3110, tt_62: timest, =hostS)) = injbot2(x_3179[@i_4019, @i_4020]) in
                      event fullCT(hostT, hostS, n3_3110, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3111: symseed;
                      new tc'_3112: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3112), SK_63, r2_3111) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3112)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4015 <= N3, @i_4016 <= N suchthat defined(x_3183[@i_4015, @i_4016], r7_3048[@i_4015, @i_4016], z_3182[@i_4015, @i_4016]) && ((@i_183[@i_4016] = @i_183) && (z_3182[@i_4015, @i_4016] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3110, tt_62: timest, =hostS)) = injbot2(x_3183[@i_4015, @i_4016]) in
                      event fullCT(hostT, hostS, n3_3110, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3111: symseed;
                      new tc'_3112: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3112), SK_63, r2_3111) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3112)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4011 <= N3, @i_4012 <= N suchthat defined(x_3187[@i_4011, @i_4012], r7_3058[@i_4011, @i_4012], z_3186[@i_4011, @i_4012]) && ((@i_183[@i_4012] = @i_183) && (z_3186[@i_4011, @i_4012] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3110, tt_62: timest, =hostS)) = injbot2(x_3187[@i_4011, @i_4012]) in
                      event fullCT(hostT, hostS, n3_3110, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3111: symseed;
                      new tc'_3112: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3112), SK_63, r2_3111) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3112)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4007 <= N3, @i_4008 <= N suchthat defined(x_3191[@i_4007, @i_4008], r7_3068[@i_4007, @i_4008], z_3190[@i_4007, @i_4008]) && ((@i_183[@i_4008] = @i_183) && (z_3190[@i_4007, @i_4008] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3110, tt_62: timest, =hostS)) = injbot2(x_3191[@i_4007, @i_4008]) in
                      event fullCT(hostT, hostS, n3_3110, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3111: symseed;
                      new tc'_3112: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3112), SK_63, r2_3111) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3112)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4003 <= N3, @i_4004 <= N suchthat defined(x_3195[@i_4003, @i_4004], r7_3078[@i_4003, @i_4004], z_3194[@i_4003, @i_4004]) && ((@i_183[@i_4004] = @i_183) && (z_3194[@i_4003, @i_4004] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3110, tt_62: timest, =hostS)) = injbot2(x_3195[@i_4003, @i_4004]) in
                      event fullCT(hostT, hostS, n3_3110, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3111: symseed;
                      new tc'_3112: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3112), SK_63, r2_3111) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3112)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3999 <= N3, @i_4000 <= N suchthat defined(x_3199[@i_3999, @i_4000], r7_3088[@i_3999, @i_4000], z_3198[@i_3999, @i_4000]) && ((@i_183[@i_4000] = @i_183) && (z_3198[@i_3999, @i_4000] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3110, tt_62: timest, =hostS)) = injbot2(x_3199[@i_3999, @i_4000]) in
                      event fullCT(hostT, hostS, n3_3110, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3111: symseed;
                      new tc'_3112: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3112), SK_63, r2_3111) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3112)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3995 <= N3, @i_3996 <= N suchthat defined(x_3203[@i_3995, @i_3996], r7_3098[@i_3995, @i_3996], z_3202[@i_3995, @i_3996]) && ((@i_183[@i_3996] = @i_183) && (z_3202[@i_3995, @i_3996] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3110, tt_62: timest, =hostS)) = injbot2(x_3203[@i_3995, @i_3996]) in
                      event fullCT(hostT, hostS, n3_3110, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3111: symseed;
                      new tc'_3112: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3112), SK_63, r2_3111) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3112)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3991 <= N3, @i_3992 <= N suchthat defined(x_3207[@i_3991, @i_3992], r7_3108[@i_3991, @i_3992], z_3206[@i_3991, @i_3992]) && ((@i_183[@i_3992] = @i_183) && (z_3206[@i_3991, @i_3992] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3110, tt_62: timest, =hostS)) = injbot2(x_3207[@i_3991, @i_3992]) in
                      event fullCT(hostT, hostS, n3_3110, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3111: symseed;
                      new tc'_3112: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3112), SK_63, r2_3111) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3112)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3987 <= N3, @i_3988 <= N suchthat defined(x_3211[@i_3987, @i_3988], r7_3118[@i_3987, @i_3988], z_3210[@i_3987, @i_3988]) && ((@i_183[@i_3988] = @i_183) && (z_3210[@i_3987, @i_3988] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3110, tt_62: timest, =hostS)) = injbot2(x_3211[@i_3987, @i_3988]) in
                      event fullCT(hostT, hostS, n3_3110, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3111: symseed;
                      new tc'_3112: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3112), SK_63, r2_3111) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3112)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3983 <= N3, @i_3984 <= N suchthat defined(x_3215[@i_3983, @i_3984], r7_3128[@i_3983, @i_3984], z_3214[@i_3983, @i_3984]) && ((@i_183[@i_3984] = @i_183) && (z_3214[@i_3983, @i_3984] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3110, tt_62: timest, =hostS)) = injbot2(x_3215[@i_3983, @i_3984]) in
                      event fullCT(hostT, hostS, n3_3110, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3111: symseed;
                      new tc'_3112: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3112), SK_63, r2_3111) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3112)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3979 <= N3, @i_3980 <= N suchthat defined(x_3219[@i_3979, @i_3980], r7_3138[@i_3979, @i_3980], z_3218[@i_3979, @i_3980]) && ((@i_183[@i_3980] = @i_183) && (z_3218[@i_3979, @i_3980] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3110, tt_62: timest, =hostS)) = injbot2(x_3219[@i_3979, @i_3980]) in
                      event fullCT(hostT, hostS, n3_3110, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3111: symseed;
                      new tc'_3112: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3112), SK_63, r2_3111) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3112)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3975 <= N3, @i_3976 <= N suchthat defined(x_3223[@i_3975, @i_3976], r7_3148[@i_3975, @i_3976], z_3222[@i_3975, @i_3976]) && ((@i_183[@i_3976] = @i_183) && (z_3222[@i_3975, @i_3976] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3110, tt_62: timest, =hostS)) = injbot2(x_3223[@i_3975, @i_3976]) in
                      event fullCT(hostT, hostS, n3_3110, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3111: symseed;
                      new tc'_3112: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3112), SK_63, r2_3111) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3112)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3971 <= N3, @i_3972 <= N suchthat defined(x_3227[@i_3971, @i_3972], r7_3158[@i_3971, @i_3972], z_3226[@i_3971, @i_3972]) && ((@i_183[@i_3972] = @i_183) && (z_3226[@i_3971, @i_3972] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3110, tt_62: timest, =hostS)) = injbot2(x_3227[@i_3971, @i_3972]) in
                      event fullCT(hostT, hostS, n3_3110, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3111: symseed;
                      new tc'_3112: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3112), SK_63, r2_3111) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3112)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_3970 <= N suchthat defined(x_3231[@i_3970], r11_1430[@i_3970], z_3230[@i_3970]) && ((@i_1384[@i_3970] = @i_183) && (z_3230[@i_3970] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3110, tt_62: timest, =hostS)) = injbot2(x_3231[@i_3970]) in
                      event fullCT(hostT, hostS, n3_3110, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3111: symseed;
                      new tc'_3112: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3112), SK_63, r2_3111) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3112)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    else
                      let injbot2(concat8(SK_63: key, =n3_3110, tt_62: timest, =hostS)) = bottom in
                      event fullCT(hostT, hostS, n3_3110, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3111: symseed;
                      new tc'_3112: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3112), SK_63, r2_3111) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3112)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3113: symseed;
                    new tc_3114: timest;
                    let e5: maxmac = encsym(pad(C, tc_3114), kgen(s3_1366[@i_183]), r7_3113) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3115: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3115));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3115, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3115, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3116: symseed;
                    new tc'_3117: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3117), SK_63, r2_3116) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3117)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3118: symseed;
                    new tc_3119: timest;
                    let x_3211: maxenc = pad(C, tc_3119) in
                    let z_3210: maxmac = encsym(x_3211, kgen2(s3_1372[@i_183]), r7_3118) in
                    let e5: maxmac = z_3210 in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3120: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3120));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    find @i_4103 <= N suchthat defined(x_3164[@i_4103], r11_1433[@i_4103], z_3163[@i_4103]) && ((@i_1384[@i_4103] = @i_183) && (z_3163[@i_4103] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3120, tt_62: timest, =hostS)) = injbot2(x_3164[@i_4103]) in
                      event fullCT(hostT, hostS, n3_3120, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3121: symseed;
                      new tc'_3122: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3122), SK_63, r2_3121) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3122)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4098 <= N3, @i_4099 <= N suchthat defined(x_3167[@i_4098, @i_4099], r7_3008[@i_4098, @i_4099], z_3166[@i_4098, @i_4099]) && ((@i_183[@i_4099] = @i_183) && (z_3166[@i_4098, @i_4099] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3120, tt_62: timest, =hostS)) = injbot2(x_3167[@i_4098, @i_4099]) in
                      event fullCT(hostT, hostS, n3_3120, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3121: symseed;
                      new tc'_3122: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3122), SK_63, r2_3121) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3122)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4094 <= N3, @i_4095 <= N suchthat defined(x_3171[@i_4094, @i_4095], r7_3018[@i_4094, @i_4095], z_3170[@i_4094, @i_4095]) && ((@i_183[@i_4095] = @i_183) && (z_3170[@i_4094, @i_4095] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3120, tt_62: timest, =hostS)) = injbot2(x_3171[@i_4094, @i_4095]) in
                      event fullCT(hostT, hostS, n3_3120, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3121: symseed;
                      new tc'_3122: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3122), SK_63, r2_3121) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3122)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4090 <= N3, @i_4091 <= N suchthat defined(x_3175[@i_4090, @i_4091], r7_3028[@i_4090, @i_4091], z_3174[@i_4090, @i_4091]) && ((@i_183[@i_4091] = @i_183) && (z_3174[@i_4090, @i_4091] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3120, tt_62: timest, =hostS)) = injbot2(x_3175[@i_4090, @i_4091]) in
                      event fullCT(hostT, hostS, n3_3120, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3121: symseed;
                      new tc'_3122: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3122), SK_63, r2_3121) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3122)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4086 <= N3, @i_4087 <= N suchthat defined(x_3179[@i_4086, @i_4087], r7_3038[@i_4086, @i_4087], z_3178[@i_4086, @i_4087]) && ((@i_183[@i_4087] = @i_183) && (z_3178[@i_4086, @i_4087] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3120, tt_62: timest, =hostS)) = injbot2(x_3179[@i_4086, @i_4087]) in
                      event fullCT(hostT, hostS, n3_3120, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3121: symseed;
                      new tc'_3122: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3122), SK_63, r2_3121) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3122)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4082 <= N3, @i_4083 <= N suchthat defined(x_3183[@i_4082, @i_4083], r7_3048[@i_4082, @i_4083], z_3182[@i_4082, @i_4083]) && ((@i_183[@i_4083] = @i_183) && (z_3182[@i_4082, @i_4083] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3120, tt_62: timest, =hostS)) = injbot2(x_3183[@i_4082, @i_4083]) in
                      event fullCT(hostT, hostS, n3_3120, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3121: symseed;
                      new tc'_3122: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3122), SK_63, r2_3121) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3122)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4078 <= N3, @i_4079 <= N suchthat defined(x_3187[@i_4078, @i_4079], r7_3058[@i_4078, @i_4079], z_3186[@i_4078, @i_4079]) && ((@i_183[@i_4079] = @i_183) && (z_3186[@i_4078, @i_4079] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3120, tt_62: timest, =hostS)) = injbot2(x_3187[@i_4078, @i_4079]) in
                      event fullCT(hostT, hostS, n3_3120, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3121: symseed;
                      new tc'_3122: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3122), SK_63, r2_3121) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3122)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4074 <= N3, @i_4075 <= N suchthat defined(x_3191[@i_4074, @i_4075], r7_3068[@i_4074, @i_4075], z_3190[@i_4074, @i_4075]) && ((@i_183[@i_4075] = @i_183) && (z_3190[@i_4074, @i_4075] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3120, tt_62: timest, =hostS)) = injbot2(x_3191[@i_4074, @i_4075]) in
                      event fullCT(hostT, hostS, n3_3120, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3121: symseed;
                      new tc'_3122: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3122), SK_63, r2_3121) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3122)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4070 <= N3, @i_4071 <= N suchthat defined(x_3195[@i_4070, @i_4071], r7_3078[@i_4070, @i_4071], z_3194[@i_4070, @i_4071]) && ((@i_183[@i_4071] = @i_183) && (z_3194[@i_4070, @i_4071] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3120, tt_62: timest, =hostS)) = injbot2(x_3195[@i_4070, @i_4071]) in
                      event fullCT(hostT, hostS, n3_3120, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3121: symseed;
                      new tc'_3122: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3122), SK_63, r2_3121) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3122)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4066 <= N3, @i_4067 <= N suchthat defined(x_3199[@i_4066, @i_4067], r7_3088[@i_4066, @i_4067], z_3198[@i_4066, @i_4067]) && ((@i_183[@i_4067] = @i_183) && (z_3198[@i_4066, @i_4067] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3120, tt_62: timest, =hostS)) = injbot2(x_3199[@i_4066, @i_4067]) in
                      event fullCT(hostT, hostS, n3_3120, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3121: symseed;
                      new tc'_3122: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3122), SK_63, r2_3121) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3122)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4062 <= N3, @i_4063 <= N suchthat defined(x_3203[@i_4062, @i_4063], r7_3098[@i_4062, @i_4063], z_3202[@i_4062, @i_4063]) && ((@i_183[@i_4063] = @i_183) && (z_3202[@i_4062, @i_4063] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3120, tt_62: timest, =hostS)) = injbot2(x_3203[@i_4062, @i_4063]) in
                      event fullCT(hostT, hostS, n3_3120, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3121: symseed;
                      new tc'_3122: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3122), SK_63, r2_3121) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3122)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4058 <= N3, @i_4059 <= N suchthat defined(x_3207[@i_4058, @i_4059], r7_3108[@i_4058, @i_4059], z_3206[@i_4058, @i_4059]) && ((@i_183[@i_4059] = @i_183) && (z_3206[@i_4058, @i_4059] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3120, tt_62: timest, =hostS)) = injbot2(x_3207[@i_4058, @i_4059]) in
                      event fullCT(hostT, hostS, n3_3120, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3121: symseed;
                      new tc'_3122: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3122), SK_63, r2_3121) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3122)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4054 <= N3, @i_4055 <= N suchthat defined(x_3211[@i_4054, @i_4055], r7_3118[@i_4054, @i_4055], z_3210[@i_4054, @i_4055]) && ((@i_183[@i_4055] = @i_183) && (z_3210[@i_4054, @i_4055] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3120, tt_62: timest, =hostS)) = injbot2(x_3211[@i_4054, @i_4055]) in
                      event fullCT(hostT, hostS, n3_3120, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3121: symseed;
                      new tc'_3122: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3122), SK_63, r2_3121) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3122)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4050 <= N3, @i_4051 <= N suchthat defined(x_3215[@i_4050, @i_4051], r7_3128[@i_4050, @i_4051], z_3214[@i_4050, @i_4051]) && ((@i_183[@i_4051] = @i_183) && (z_3214[@i_4050, @i_4051] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3120, tt_62: timest, =hostS)) = injbot2(x_3215[@i_4050, @i_4051]) in
                      event fullCT(hostT, hostS, n3_3120, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3121: symseed;
                      new tc'_3122: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3122), SK_63, r2_3121) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3122)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4046 <= N3, @i_4047 <= N suchthat defined(x_3219[@i_4046, @i_4047], r7_3138[@i_4046, @i_4047], z_3218[@i_4046, @i_4047]) && ((@i_183[@i_4047] = @i_183) && (z_3218[@i_4046, @i_4047] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3120, tt_62: timest, =hostS)) = injbot2(x_3219[@i_4046, @i_4047]) in
                      event fullCT(hostT, hostS, n3_3120, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3121: symseed;
                      new tc'_3122: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3122), SK_63, r2_3121) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3122)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4042 <= N3, @i_4043 <= N suchthat defined(x_3223[@i_4042, @i_4043], r7_3148[@i_4042, @i_4043], z_3222[@i_4042, @i_4043]) && ((@i_183[@i_4043] = @i_183) && (z_3222[@i_4042, @i_4043] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3120, tt_62: timest, =hostS)) = injbot2(x_3223[@i_4042, @i_4043]) in
                      event fullCT(hostT, hostS, n3_3120, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3121: symseed;
                      new tc'_3122: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3122), SK_63, r2_3121) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3122)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4038 <= N3, @i_4039 <= N suchthat defined(x_3227[@i_4038, @i_4039], r7_3158[@i_4038, @i_4039], z_3226[@i_4038, @i_4039]) && ((@i_183[@i_4039] = @i_183) && (z_3226[@i_4038, @i_4039] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3120, tt_62: timest, =hostS)) = injbot2(x_3227[@i_4038, @i_4039]) in
                      event fullCT(hostT, hostS, n3_3120, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3121: symseed;
                      new tc'_3122: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3122), SK_63, r2_3121) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3122)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4037 <= N suchthat defined(x_3231[@i_4037], r11_1430[@i_4037], z_3230[@i_4037]) && ((@i_1384[@i_4037] = @i_183) && (z_3230[@i_4037] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3120, tt_62: timest, =hostS)) = injbot2(x_3231[@i_4037]) in
                      event fullCT(hostT, hostS, n3_3120, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3121: symseed;
                      new tc'_3122: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3122), SK_63, r2_3121) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3122)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    else
                      let injbot2(concat8(SK_63: key, =n3_3120, tt_62: timest, =hostS)) = bottom in
                      event fullCT(hostT, hostS, n3_3120, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3121: symseed;
                      new tc'_3122: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3122), SK_63, r2_3121) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3122)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
              find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3123: symseed;
                    new tc_3124: timest;
                    let e5: maxmac = encsym(pad(C, tc_3124), kgen(s3_1366[@i_183]), r7_3123) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3125: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3125));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3125, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3125, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3126: symseed;
                    new tc'_3127: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3127), SK_63, r2_3126) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3127)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3128: symseed;
                    new tc_3129: timest;
                    let x_3215: maxenc = pad(C, tc_3129) in
                    let z_3214: maxmac = encsym(x_3215, kgen2(s3_1372[@i_183]), r7_3128) in
                    let e5: maxmac = z_3214 in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3130: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3130));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    find @i_4170 <= N suchthat defined(x_3164[@i_4170], r11_1433[@i_4170], z_3163[@i_4170]) && ((@i_1384[@i_4170] = @i_183) && (z_3163[@i_4170] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3130, tt_62: timest, =hostS)) = injbot2(x_3164[@i_4170]) in
                      event fullCT(hostT, hostS, n3_3130, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3131: symseed;
                      new tc'_3132: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3132), SK_63, r2_3131) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3132)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4165 <= N3, @i_4166 <= N suchthat defined(x_3167[@i_4165, @i_4166], r7_3008[@i_4165, @i_4166], z_3166[@i_4165, @i_4166]) && ((@i_183[@i_4166] = @i_183) && (z_3166[@i_4165, @i_4166] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3130, tt_62: timest, =hostS)) = injbot2(x_3167[@i_4165, @i_4166]) in
                      event fullCT(hostT, hostS, n3_3130, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3131: symseed;
                      new tc'_3132: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3132), SK_63, r2_3131) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3132)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4161 <= N3, @i_4162 <= N suchthat defined(x_3171[@i_4161, @i_4162], r7_3018[@i_4161, @i_4162], z_3170[@i_4161, @i_4162]) && ((@i_183[@i_4162] = @i_183) && (z_3170[@i_4161, @i_4162] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3130, tt_62: timest, =hostS)) = injbot2(x_3171[@i_4161, @i_4162]) in
                      event fullCT(hostT, hostS, n3_3130, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3131: symseed;
                      new tc'_3132: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3132), SK_63, r2_3131) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3132)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4157 <= N3, @i_4158 <= N suchthat defined(x_3175[@i_4157, @i_4158], r7_3028[@i_4157, @i_4158], z_3174[@i_4157, @i_4158]) && ((@i_183[@i_4158] = @i_183) && (z_3174[@i_4157, @i_4158] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3130, tt_62: timest, =hostS)) = injbot2(x_3175[@i_4157, @i_4158]) in
                      event fullCT(hostT, hostS, n3_3130, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3131: symseed;
                      new tc'_3132: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3132), SK_63, r2_3131) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3132)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4153 <= N3, @i_4154 <= N suchthat defined(x_3179[@i_4153, @i_4154], r7_3038[@i_4153, @i_4154], z_3178[@i_4153, @i_4154]) && ((@i_183[@i_4154] = @i_183) && (z_3178[@i_4153, @i_4154] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3130, tt_62: timest, =hostS)) = injbot2(x_3179[@i_4153, @i_4154]) in
                      event fullCT(hostT, hostS, n3_3130, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3131: symseed;
                      new tc'_3132: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3132), SK_63, r2_3131) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3132)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4149 <= N3, @i_4150 <= N suchthat defined(x_3183[@i_4149, @i_4150], r7_3048[@i_4149, @i_4150], z_3182[@i_4149, @i_4150]) && ((@i_183[@i_4150] = @i_183) && (z_3182[@i_4149, @i_4150] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3130, tt_62: timest, =hostS)) = injbot2(x_3183[@i_4149, @i_4150]) in
                      event fullCT(hostT, hostS, n3_3130, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3131: symseed;
                      new tc'_3132: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3132), SK_63, r2_3131) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3132)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4145 <= N3, @i_4146 <= N suchthat defined(x_3187[@i_4145, @i_4146], r7_3058[@i_4145, @i_4146], z_3186[@i_4145, @i_4146]) && ((@i_183[@i_4146] = @i_183) && (z_3186[@i_4145, @i_4146] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3130, tt_62: timest, =hostS)) = injbot2(x_3187[@i_4145, @i_4146]) in
                      event fullCT(hostT, hostS, n3_3130, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3131: symseed;
                      new tc'_3132: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3132), SK_63, r2_3131) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3132)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4141 <= N3, @i_4142 <= N suchthat defined(x_3191[@i_4141, @i_4142], r7_3068[@i_4141, @i_4142], z_3190[@i_4141, @i_4142]) && ((@i_183[@i_4142] = @i_183) && (z_3190[@i_4141, @i_4142] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3130, tt_62: timest, =hostS)) = injbot2(x_3191[@i_4141, @i_4142]) in
                      event fullCT(hostT, hostS, n3_3130, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3131: symseed;
                      new tc'_3132: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3132), SK_63, r2_3131) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3132)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4137 <= N3, @i_4138 <= N suchthat defined(x_3195[@i_4137, @i_4138], r7_3078[@i_4137, @i_4138], z_3194[@i_4137, @i_4138]) && ((@i_183[@i_4138] = @i_183) && (z_3194[@i_4137, @i_4138] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3130, tt_62: timest, =hostS)) = injbot2(x_3195[@i_4137, @i_4138]) in
                      event fullCT(hostT, hostS, n3_3130, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3131: symseed;
                      new tc'_3132: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3132), SK_63, r2_3131) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3132)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4133 <= N3, @i_4134 <= N suchthat defined(x_3199[@i_4133, @i_4134], r7_3088[@i_4133, @i_4134], z_3198[@i_4133, @i_4134]) && ((@i_183[@i_4134] = @i_183) && (z_3198[@i_4133, @i_4134] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3130, tt_62: timest, =hostS)) = injbot2(x_3199[@i_4133, @i_4134]) in
                      event fullCT(hostT, hostS, n3_3130, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3131: symseed;
                      new tc'_3132: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3132), SK_63, r2_3131) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3132)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4129 <= N3, @i_4130 <= N suchthat defined(x_3203[@i_4129, @i_4130], r7_3098[@i_4129, @i_4130], z_3202[@i_4129, @i_4130]) && ((@i_183[@i_4130] = @i_183) && (z_3202[@i_4129, @i_4130] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3130, tt_62: timest, =hostS)) = injbot2(x_3203[@i_4129, @i_4130]) in
                      event fullCT(hostT, hostS, n3_3130, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3131: symseed;
                      new tc'_3132: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3132), SK_63, r2_3131) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3132)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4125 <= N3, @i_4126 <= N suchthat defined(x_3207[@i_4125, @i_4126], r7_3108[@i_4125, @i_4126], z_3206[@i_4125, @i_4126]) && ((@i_183[@i_4126] = @i_183) && (z_3206[@i_4125, @i_4126] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3130, tt_62: timest, =hostS)) = injbot2(x_3207[@i_4125, @i_4126]) in
                      event fullCT(hostT, hostS, n3_3130, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3131: symseed;
                      new tc'_3132: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3132), SK_63, r2_3131) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3132)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4121 <= N3, @i_4122 <= N suchthat defined(x_3211[@i_4121, @i_4122], r7_3118[@i_4121, @i_4122], z_3210[@i_4121, @i_4122]) && ((@i_183[@i_4122] = @i_183) && (z_3210[@i_4121, @i_4122] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3130, tt_62: timest, =hostS)) = injbot2(x_3211[@i_4121, @i_4122]) in
                      event fullCT(hostT, hostS, n3_3130, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3131: symseed;
                      new tc'_3132: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3132), SK_63, r2_3131) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3132)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4117 <= N3, @i_4118 <= N suchthat defined(x_3215[@i_4117, @i_4118], r7_3128[@i_4117, @i_4118], z_3214[@i_4117, @i_4118]) && ((@i_183[@i_4118] = @i_183) && (z_3214[@i_4117, @i_4118] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3130, tt_62: timest, =hostS)) = injbot2(x_3215[@i_4117, @i_4118]) in
                      event fullCT(hostT, hostS, n3_3130, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3131: symseed;
                      new tc'_3132: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3132), SK_63, r2_3131) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3132)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4113 <= N3, @i_4114 <= N suchthat defined(x_3219[@i_4113, @i_4114], r7_3138[@i_4113, @i_4114], z_3218[@i_4113, @i_4114]) && ((@i_183[@i_4114] = @i_183) && (z_3218[@i_4113, @i_4114] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3130, tt_62: timest, =hostS)) = injbot2(x_3219[@i_4113, @i_4114]) in
                      event fullCT(hostT, hostS, n3_3130, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3131: symseed;
                      new tc'_3132: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3132), SK_63, r2_3131) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3132)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4109 <= N3, @i_4110 <= N suchthat defined(x_3223[@i_4109, @i_4110], r7_3148[@i_4109, @i_4110], z_3222[@i_4109, @i_4110]) && ((@i_183[@i_4110] = @i_183) && (z_3222[@i_4109, @i_4110] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3130, tt_62: timest, =hostS)) = injbot2(x_3223[@i_4109, @i_4110]) in
                      event fullCT(hostT, hostS, n3_3130, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3131: symseed;
                      new tc'_3132: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3132), SK_63, r2_3131) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3132)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4105 <= N3, @i_4106 <= N suchthat defined(x_3227[@i_4105, @i_4106], r7_3158[@i_4105, @i_4106], z_3226[@i_4105, @i_4106]) && ((@i_183[@i_4106] = @i_183) && (z_3226[@i_4105, @i_4106] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3130, tt_62: timest, =hostS)) = injbot2(x_3227[@i_4105, @i_4106]) in
                      event fullCT(hostT, hostS, n3_3130, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3131: symseed;
                      new tc'_3132: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3132), SK_63, r2_3131) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3132)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4104 <= N suchthat defined(x_3231[@i_4104], r11_1430[@i_4104], z_3230[@i_4104]) && ((@i_1384[@i_4104] = @i_183) && (z_3230[@i_4104] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3130, tt_62: timest, =hostS)) = injbot2(x_3231[@i_4104]) in
                      event fullCT(hostT, hostS, n3_3130, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3131: symseed;
                      new tc'_3132: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3132), SK_63, r2_3131) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3132)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    else
                      let injbot2(concat8(SK_63: key, =n3_3130, tt_62: timest, =hostS)) = bottom in
                      event fullCT(hostT, hostS, n3_3130, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3131: symseed;
                      new tc'_3132: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3132), SK_63, r2_3131) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3132)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3133: symseed;
                    new tc_3134: timest;
                    let e5: maxmac = encsym(pad(C, tc_3134), kgen(s3_1366[@i_183]), r7_3133) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3135: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3135));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3135, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3135, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3136: symseed;
                    new tc'_3137: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3137), SK_63, r2_3136) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3137)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3138: symseed;
                    new tc_3139: timest;
                    let x_3219: maxenc = pad(C, tc_3139) in
                    let z_3218: maxmac = encsym(x_3219, kgen2(s3_1372[@i_183]), r7_3138) in
                    let e5: maxmac = z_3218 in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3140: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3140));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    find @i_4237 <= N suchthat defined(x_3164[@i_4237], r11_1433[@i_4237], z_3163[@i_4237]) && ((@i_1384[@i_4237] = @i_183) && (z_3163[@i_4237] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3140, tt_62: timest, =hostS)) = injbot2(x_3164[@i_4237]) in
                      event fullCT(hostT, hostS, n3_3140, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3141: symseed;
                      new tc'_3142: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3142), SK_63, r2_3141) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3142)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4232 <= N3, @i_4233 <= N suchthat defined(x_3167[@i_4232, @i_4233], r7_3008[@i_4232, @i_4233], z_3166[@i_4232, @i_4233]) && ((@i_183[@i_4233] = @i_183) && (z_3166[@i_4232, @i_4233] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3140, tt_62: timest, =hostS)) = injbot2(x_3167[@i_4232, @i_4233]) in
                      event fullCT(hostT, hostS, n3_3140, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3141: symseed;
                      new tc'_3142: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3142), SK_63, r2_3141) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3142)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4228 <= N3, @i_4229 <= N suchthat defined(x_3171[@i_4228, @i_4229], r7_3018[@i_4228, @i_4229], z_3170[@i_4228, @i_4229]) && ((@i_183[@i_4229] = @i_183) && (z_3170[@i_4228, @i_4229] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3140, tt_62: timest, =hostS)) = injbot2(x_3171[@i_4228, @i_4229]) in
                      event fullCT(hostT, hostS, n3_3140, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3141: symseed;
                      new tc'_3142: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3142), SK_63, r2_3141) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3142)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4224 <= N3, @i_4225 <= N suchthat defined(x_3175[@i_4224, @i_4225], r7_3028[@i_4224, @i_4225], z_3174[@i_4224, @i_4225]) && ((@i_183[@i_4225] = @i_183) && (z_3174[@i_4224, @i_4225] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3140, tt_62: timest, =hostS)) = injbot2(x_3175[@i_4224, @i_4225]) in
                      event fullCT(hostT, hostS, n3_3140, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3141: symseed;
                      new tc'_3142: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3142), SK_63, r2_3141) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3142)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4220 <= N3, @i_4221 <= N suchthat defined(x_3179[@i_4220, @i_4221], r7_3038[@i_4220, @i_4221], z_3178[@i_4220, @i_4221]) && ((@i_183[@i_4221] = @i_183) && (z_3178[@i_4220, @i_4221] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3140, tt_62: timest, =hostS)) = injbot2(x_3179[@i_4220, @i_4221]) in
                      event fullCT(hostT, hostS, n3_3140, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3141: symseed;
                      new tc'_3142: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3142), SK_63, r2_3141) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3142)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4216 <= N3, @i_4217 <= N suchthat defined(x_3183[@i_4216, @i_4217], r7_3048[@i_4216, @i_4217], z_3182[@i_4216, @i_4217]) && ((@i_183[@i_4217] = @i_183) && (z_3182[@i_4216, @i_4217] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3140, tt_62: timest, =hostS)) = injbot2(x_3183[@i_4216, @i_4217]) in
                      event fullCT(hostT, hostS, n3_3140, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3141: symseed;
                      new tc'_3142: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3142), SK_63, r2_3141) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3142)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4212 <= N3, @i_4213 <= N suchthat defined(x_3187[@i_4212, @i_4213], r7_3058[@i_4212, @i_4213], z_3186[@i_4212, @i_4213]) && ((@i_183[@i_4213] = @i_183) && (z_3186[@i_4212, @i_4213] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3140, tt_62: timest, =hostS)) = injbot2(x_3187[@i_4212, @i_4213]) in
                      event fullCT(hostT, hostS, n3_3140, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3141: symseed;
                      new tc'_3142: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3142), SK_63, r2_3141) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3142)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4208 <= N3, @i_4209 <= N suchthat defined(x_3191[@i_4208, @i_4209], r7_3068[@i_4208, @i_4209], z_3190[@i_4208, @i_4209]) && ((@i_183[@i_4209] = @i_183) && (z_3190[@i_4208, @i_4209] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3140, tt_62: timest, =hostS)) = injbot2(x_3191[@i_4208, @i_4209]) in
                      event fullCT(hostT, hostS, n3_3140, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3141: symseed;
                      new tc'_3142: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3142), SK_63, r2_3141) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3142)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4204 <= N3, @i_4205 <= N suchthat defined(x_3195[@i_4204, @i_4205], r7_3078[@i_4204, @i_4205], z_3194[@i_4204, @i_4205]) && ((@i_183[@i_4205] = @i_183) && (z_3194[@i_4204, @i_4205] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3140, tt_62: timest, =hostS)) = injbot2(x_3195[@i_4204, @i_4205]) in
                      event fullCT(hostT, hostS, n3_3140, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3141: symseed;
                      new tc'_3142: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3142), SK_63, r2_3141) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3142)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4200 <= N3, @i_4201 <= N suchthat defined(x_3199[@i_4200, @i_4201], r7_3088[@i_4200, @i_4201], z_3198[@i_4200, @i_4201]) && ((@i_183[@i_4201] = @i_183) && (z_3198[@i_4200, @i_4201] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3140, tt_62: timest, =hostS)) = injbot2(x_3199[@i_4200, @i_4201]) in
                      event fullCT(hostT, hostS, n3_3140, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3141: symseed;
                      new tc'_3142: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3142), SK_63, r2_3141) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3142)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4196 <= N3, @i_4197 <= N suchthat defined(x_3203[@i_4196, @i_4197], r7_3098[@i_4196, @i_4197], z_3202[@i_4196, @i_4197]) && ((@i_183[@i_4197] = @i_183) && (z_3202[@i_4196, @i_4197] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3140, tt_62: timest, =hostS)) = injbot2(x_3203[@i_4196, @i_4197]) in
                      event fullCT(hostT, hostS, n3_3140, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3141: symseed;
                      new tc'_3142: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3142), SK_63, r2_3141) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3142)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4192 <= N3, @i_4193 <= N suchthat defined(x_3207[@i_4192, @i_4193], r7_3108[@i_4192, @i_4193], z_3206[@i_4192, @i_4193]) && ((@i_183[@i_4193] = @i_183) && (z_3206[@i_4192, @i_4193] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3140, tt_62: timest, =hostS)) = injbot2(x_3207[@i_4192, @i_4193]) in
                      event fullCT(hostT, hostS, n3_3140, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3141: symseed;
                      new tc'_3142: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3142), SK_63, r2_3141) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3142)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4188 <= N3, @i_4189 <= N suchthat defined(x_3211[@i_4188, @i_4189], r7_3118[@i_4188, @i_4189], z_3210[@i_4188, @i_4189]) && ((@i_183[@i_4189] = @i_183) && (z_3210[@i_4188, @i_4189] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3140, tt_62: timest, =hostS)) = injbot2(x_3211[@i_4188, @i_4189]) in
                      event fullCT(hostT, hostS, n3_3140, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3141: symseed;
                      new tc'_3142: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3142), SK_63, r2_3141) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3142)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4184 <= N3, @i_4185 <= N suchthat defined(x_3215[@i_4184, @i_4185], r7_3128[@i_4184, @i_4185], z_3214[@i_4184, @i_4185]) && ((@i_183[@i_4185] = @i_183) && (z_3214[@i_4184, @i_4185] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3140, tt_62: timest, =hostS)) = injbot2(x_3215[@i_4184, @i_4185]) in
                      event fullCT(hostT, hostS, n3_3140, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3141: symseed;
                      new tc'_3142: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3142), SK_63, r2_3141) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3142)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4180 <= N3, @i_4181 <= N suchthat defined(x_3219[@i_4180, @i_4181], r7_3138[@i_4180, @i_4181], z_3218[@i_4180, @i_4181]) && ((@i_183[@i_4181] = @i_183) && (z_3218[@i_4180, @i_4181] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3140, tt_62: timest, =hostS)) = injbot2(x_3219[@i_4180, @i_4181]) in
                      event fullCT(hostT, hostS, n3_3140, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3141: symseed;
                      new tc'_3142: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3142), SK_63, r2_3141) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3142)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4176 <= N3, @i_4177 <= N suchthat defined(x_3223[@i_4176, @i_4177], r7_3148[@i_4176, @i_4177], z_3222[@i_4176, @i_4177]) && ((@i_183[@i_4177] = @i_183) && (z_3222[@i_4176, @i_4177] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3140, tt_62: timest, =hostS)) = injbot2(x_3223[@i_4176, @i_4177]) in
                      event fullCT(hostT, hostS, n3_3140, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3141: symseed;
                      new tc'_3142: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3142), SK_63, r2_3141) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3142)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4172 <= N3, @i_4173 <= N suchthat defined(x_3227[@i_4172, @i_4173], r7_3158[@i_4172, @i_4173], z_3226[@i_4172, @i_4173]) && ((@i_183[@i_4173] = @i_183) && (z_3226[@i_4172, @i_4173] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3140, tt_62: timest, =hostS)) = injbot2(x_3227[@i_4172, @i_4173]) in
                      event fullCT(hostT, hostS, n3_3140, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3141: symseed;
                      new tc'_3142: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3142), SK_63, r2_3141) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3142)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4171 <= N suchthat defined(x_3231[@i_4171], r11_1430[@i_4171], z_3230[@i_4171]) && ((@i_1384[@i_4171] = @i_183) && (z_3230[@i_4171] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3140, tt_62: timest, =hostS)) = injbot2(x_3231[@i_4171]) in
                      event fullCT(hostT, hostS, n3_3140, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3141: symseed;
                      new tc'_3142: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3142), SK_63, r2_3141) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3142)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    else
                      let injbot2(concat8(SK_63: key, =n3_3140, tt_62: timest, =hostS)) = bottom in
                      event fullCT(hostT, hostS, n3_3140, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3141: symseed;
                      new tc'_3142: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3142), SK_63, r2_3141) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3142)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) then
                let x_119: sblocksize = padno(n2) in
                find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3143: symseed;
                    new tc_3144: timest;
                    let e5: maxmac = encsym(pad(C, tc_3144), kgen(s3_1366[@i_183]), r7_3143) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3145: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3145));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3145, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3145, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3146: symseed;
                    new tc'_3147: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3147), SK_63, r2_3146) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3147)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3148: symseed;
                    new tc_3149: timest;
                    let x_3223: maxenc = pad(C, tc_3149) in
                    let z_3222: maxmac = encsym(x_3223, kgen2(s3_1372[@i_183]), r7_3148) in
                    let e5: maxmac = z_3222 in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3150: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3150));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    find @i_4304 <= N suchthat defined(x_3164[@i_4304], r11_1433[@i_4304], z_3163[@i_4304]) && ((@i_1384[@i_4304] = @i_183) && (z_3163[@i_4304] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3150, tt_62: timest, =hostS)) = injbot2(x_3164[@i_4304]) in
                      event fullCT(hostT, hostS, n3_3150, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3151: symseed;
                      new tc'_3152: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3152), SK_63, r2_3151) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3152)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4299 <= N3, @i_4300 <= N suchthat defined(x_3167[@i_4299, @i_4300], r7_3008[@i_4299, @i_4300], z_3166[@i_4299, @i_4300]) && ((@i_183[@i_4300] = @i_183) && (z_3166[@i_4299, @i_4300] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3150, tt_62: timest, =hostS)) = injbot2(x_3167[@i_4299, @i_4300]) in
                      event fullCT(hostT, hostS, n3_3150, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3151: symseed;
                      new tc'_3152: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3152), SK_63, r2_3151) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3152)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4295 <= N3, @i_4296 <= N suchthat defined(x_3171[@i_4295, @i_4296], r7_3018[@i_4295, @i_4296], z_3170[@i_4295, @i_4296]) && ((@i_183[@i_4296] = @i_183) && (z_3170[@i_4295, @i_4296] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3150, tt_62: timest, =hostS)) = injbot2(x_3171[@i_4295, @i_4296]) in
                      event fullCT(hostT, hostS, n3_3150, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3151: symseed;
                      new tc'_3152: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3152), SK_63, r2_3151) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3152)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4291 <= N3, @i_4292 <= N suchthat defined(x_3175[@i_4291, @i_4292], r7_3028[@i_4291, @i_4292], z_3174[@i_4291, @i_4292]) && ((@i_183[@i_4292] = @i_183) && (z_3174[@i_4291, @i_4292] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3150, tt_62: timest, =hostS)) = injbot2(x_3175[@i_4291, @i_4292]) in
                      event fullCT(hostT, hostS, n3_3150, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3151: symseed;
                      new tc'_3152: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3152), SK_63, r2_3151) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3152)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4287 <= N3, @i_4288 <= N suchthat defined(x_3179[@i_4287, @i_4288], r7_3038[@i_4287, @i_4288], z_3178[@i_4287, @i_4288]) && ((@i_183[@i_4288] = @i_183) && (z_3178[@i_4287, @i_4288] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3150, tt_62: timest, =hostS)) = injbot2(x_3179[@i_4287, @i_4288]) in
                      event fullCT(hostT, hostS, n3_3150, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3151: symseed;
                      new tc'_3152: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3152), SK_63, r2_3151) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3152)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4283 <= N3, @i_4284 <= N suchthat defined(x_3183[@i_4283, @i_4284], r7_3048[@i_4283, @i_4284], z_3182[@i_4283, @i_4284]) && ((@i_183[@i_4284] = @i_183) && (z_3182[@i_4283, @i_4284] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3150, tt_62: timest, =hostS)) = injbot2(x_3183[@i_4283, @i_4284]) in
                      event fullCT(hostT, hostS, n3_3150, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3151: symseed;
                      new tc'_3152: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3152), SK_63, r2_3151) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3152)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4279 <= N3, @i_4280 <= N suchthat defined(x_3187[@i_4279, @i_4280], r7_3058[@i_4279, @i_4280], z_3186[@i_4279, @i_4280]) && ((@i_183[@i_4280] = @i_183) && (z_3186[@i_4279, @i_4280] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3150, tt_62: timest, =hostS)) = injbot2(x_3187[@i_4279, @i_4280]) in
                      event fullCT(hostT, hostS, n3_3150, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3151: symseed;
                      new tc'_3152: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3152), SK_63, r2_3151) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3152)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4275 <= N3, @i_4276 <= N suchthat defined(x_3191[@i_4275, @i_4276], r7_3068[@i_4275, @i_4276], z_3190[@i_4275, @i_4276]) && ((@i_183[@i_4276] = @i_183) && (z_3190[@i_4275, @i_4276] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3150, tt_62: timest, =hostS)) = injbot2(x_3191[@i_4275, @i_4276]) in
                      event fullCT(hostT, hostS, n3_3150, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3151: symseed;
                      new tc'_3152: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3152), SK_63, r2_3151) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3152)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4271 <= N3, @i_4272 <= N suchthat defined(x_3195[@i_4271, @i_4272], r7_3078[@i_4271, @i_4272], z_3194[@i_4271, @i_4272]) && ((@i_183[@i_4272] = @i_183) && (z_3194[@i_4271, @i_4272] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3150, tt_62: timest, =hostS)) = injbot2(x_3195[@i_4271, @i_4272]) in
                      event fullCT(hostT, hostS, n3_3150, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3151: symseed;
                      new tc'_3152: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3152), SK_63, r2_3151) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3152)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4267 <= N3, @i_4268 <= N suchthat defined(x_3199[@i_4267, @i_4268], r7_3088[@i_4267, @i_4268], z_3198[@i_4267, @i_4268]) && ((@i_183[@i_4268] = @i_183) && (z_3198[@i_4267, @i_4268] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3150, tt_62: timest, =hostS)) = injbot2(x_3199[@i_4267, @i_4268]) in
                      event fullCT(hostT, hostS, n3_3150, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3151: symseed;
                      new tc'_3152: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3152), SK_63, r2_3151) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3152)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4263 <= N3, @i_4264 <= N suchthat defined(x_3203[@i_4263, @i_4264], r7_3098[@i_4263, @i_4264], z_3202[@i_4263, @i_4264]) && ((@i_183[@i_4264] = @i_183) && (z_3202[@i_4263, @i_4264] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3150, tt_62: timest, =hostS)) = injbot2(x_3203[@i_4263, @i_4264]) in
                      event fullCT(hostT, hostS, n3_3150, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3151: symseed;
                      new tc'_3152: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3152), SK_63, r2_3151) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3152)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4259 <= N3, @i_4260 <= N suchthat defined(x_3207[@i_4259, @i_4260], r7_3108[@i_4259, @i_4260], z_3206[@i_4259, @i_4260]) && ((@i_183[@i_4260] = @i_183) && (z_3206[@i_4259, @i_4260] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3150, tt_62: timest, =hostS)) = injbot2(x_3207[@i_4259, @i_4260]) in
                      event fullCT(hostT, hostS, n3_3150, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3151: symseed;
                      new tc'_3152: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3152), SK_63, r2_3151) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3152)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4255 <= N3, @i_4256 <= N suchthat defined(x_3211[@i_4255, @i_4256], r7_3118[@i_4255, @i_4256], z_3210[@i_4255, @i_4256]) && ((@i_183[@i_4256] = @i_183) && (z_3210[@i_4255, @i_4256] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3150, tt_62: timest, =hostS)) = injbot2(x_3211[@i_4255, @i_4256]) in
                      event fullCT(hostT, hostS, n3_3150, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3151: symseed;
                      new tc'_3152: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3152), SK_63, r2_3151) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3152)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4251 <= N3, @i_4252 <= N suchthat defined(x_3215[@i_4251, @i_4252], r7_3128[@i_4251, @i_4252], z_3214[@i_4251, @i_4252]) && ((@i_183[@i_4252] = @i_183) && (z_3214[@i_4251, @i_4252] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3150, tt_62: timest, =hostS)) = injbot2(x_3215[@i_4251, @i_4252]) in
                      event fullCT(hostT, hostS, n3_3150, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3151: symseed;
                      new tc'_3152: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3152), SK_63, r2_3151) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3152)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4247 <= N3, @i_4248 <= N suchthat defined(x_3219[@i_4247, @i_4248], r7_3138[@i_4247, @i_4248], z_3218[@i_4247, @i_4248]) && ((@i_183[@i_4248] = @i_183) && (z_3218[@i_4247, @i_4248] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3150, tt_62: timest, =hostS)) = injbot2(x_3219[@i_4247, @i_4248]) in
                      event fullCT(hostT, hostS, n3_3150, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3151: symseed;
                      new tc'_3152: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3152), SK_63, r2_3151) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3152)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4243 <= N3, @i_4244 <= N suchthat defined(x_3223[@i_4243, @i_4244], r7_3148[@i_4243, @i_4244], z_3222[@i_4243, @i_4244]) && ((@i_183[@i_4244] = @i_183) && (z_3222[@i_4243, @i_4244] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3150, tt_62: timest, =hostS)) = injbot2(x_3223[@i_4243, @i_4244]) in
                      event fullCT(hostT, hostS, n3_3150, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3151: symseed;
                      new tc'_3152: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3152), SK_63, r2_3151) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3152)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4239 <= N3, @i_4240 <= N suchthat defined(x_3227[@i_4239, @i_4240], r7_3158[@i_4239, @i_4240], z_3226[@i_4239, @i_4240]) && ((@i_183[@i_4240] = @i_183) && (z_3226[@i_4239, @i_4240] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3150, tt_62: timest, =hostS)) = injbot2(x_3227[@i_4239, @i_4240]) in
                      event fullCT(hostT, hostS, n3_3150, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3151: symseed;
                      new tc'_3152: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3152), SK_63, r2_3151) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3152)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4238 <= N suchthat defined(x_3231[@i_4238], r11_1430[@i_4238], z_3230[@i_4238]) && ((@i_1384[@i_4238] = @i_183) && (z_3230[@i_4238] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3150, tt_62: timest, =hostS)) = injbot2(x_3231[@i_4238]) in
                      event fullCT(hostT, hostS, n3_3150, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3151: symseed;
                      new tc'_3152: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3152), SK_63, r2_3151) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3152)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    else
                      let injbot2(concat8(SK_63: key, =n3_3150, tt_62: timest, =hostS)) = bottom in
                      event fullCT(hostT, hostS, n3_3150, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3151: symseed;
                      new tc'_3152: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3152), SK_63, r2_3151) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3152)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
                  find  suchthat defined(s3_1366[@i_183], AK_2841[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3153: symseed;
                    new tc_3154: timest;
                    let e5: maxmac = encsym(pad(C, tc_3154), kgen(s3_1366[@i_183]), r7_3153) in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3155: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3155));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    let injbot2(concat8(SK_63: key, =n3_3155, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
                    event fullCT(hostT, hostS, n3_3155, TGT_58, e5, m7);
                    out(c19[!_36, !_35], acceptC2(hostT, hostS));
                    ! !_37 <= N4
                    in(c20[!_37, !_36, !_35], hostS': server);
                    if (hostS' = hostS) then
                    new r2_3156: symseed;
                    new tc'_3157: timest;
                    let e12: maxmac = encsym(pad(C, tc'_3157), SK_63, r2_3156) in
                    event partCS(hostS, hostT, m7, e12);
                    out(c6[!_37, !_36, !_35], (m6, e12));
                    in(c9[!_37, !_36, !_35], (m13: maxmac));
                    let injbot2(padts(=tc'_3157)) = decsym(m13, SK_63) in
                    event fullCS(hostS, hostT, m7, e12, m13);
                    out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                  orfind  suchthat defined(s3_1372[@i_183], AK_2842[@i_183], z_753[@i_183]) && (z_753[@i_183] = m24) then
                    event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
                    out(c18[!_35], acceptC1(hostZ, hostT));
                    ! !_36 <= N3
                    in(c17[!_36, !_35], (hosT': tgs, hostS: server));
                    if (hosT' = hostT) then
                    new r7_3158: symseed;
                    new tc_3159: timest;
                    let x_3227: maxenc = pad(C, tc_3159) in
                    let z_3226: maxmac = encsym(x_3227, kgen2(s3_1372[@i_183]), r7_3158) in
                    let e5: maxmac = z_3226 in
                    event partCT(hostT, TGT_58, e5);
                    new n3_3160: nonce;
                    out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3160));
                    in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
                    find @i_4371 <= N suchthat defined(x_3164[@i_4371], r11_1433[@i_4371], z_3163[@i_4371]) && ((@i_1384[@i_4371] = @i_183) && (z_3163[@i_4371] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3160, tt_62: timest, =hostS)) = injbot2(x_3164[@i_4371]) in
                      event fullCT(hostT, hostS, n3_3160, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3161: symseed;
                      new tc'_3162: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3162), SK_63, r2_3161) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3162)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4366 <= N3, @i_4367 <= N suchthat defined(x_3167[@i_4366, @i_4367], r7_3008[@i_4366, @i_4367], z_3166[@i_4366, @i_4367]) && ((@i_183[@i_4367] = @i_183) && (z_3166[@i_4366, @i_4367] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3160, tt_62: timest, =hostS)) = injbot2(x_3167[@i_4366, @i_4367]) in
                      event fullCT(hostT, hostS, n3_3160, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3161: symseed;
                      new tc'_3162: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3162), SK_63, r2_3161) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3162)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4362 <= N3, @i_4363 <= N suchthat defined(x_3171[@i_4362, @i_4363], r7_3018[@i_4362, @i_4363], z_3170[@i_4362, @i_4363]) && ((@i_183[@i_4363] = @i_183) && (z_3170[@i_4362, @i_4363] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3160, tt_62: timest, =hostS)) = injbot2(x_3171[@i_4362, @i_4363]) in
                      event fullCT(hostT, hostS, n3_3160, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3161: symseed;
                      new tc'_3162: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3162), SK_63, r2_3161) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3162)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4358 <= N3, @i_4359 <= N suchthat defined(x_3175[@i_4358, @i_4359], r7_3028[@i_4358, @i_4359], z_3174[@i_4358, @i_4359]) && ((@i_183[@i_4359] = @i_183) && (z_3174[@i_4358, @i_4359] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3160, tt_62: timest, =hostS)) = injbot2(x_3175[@i_4358, @i_4359]) in
                      event fullCT(hostT, hostS, n3_3160, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3161: symseed;
                      new tc'_3162: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3162), SK_63, r2_3161) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3162)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4354 <= N3, @i_4355 <= N suchthat defined(x_3179[@i_4354, @i_4355], r7_3038[@i_4354, @i_4355], z_3178[@i_4354, @i_4355]) && ((@i_183[@i_4355] = @i_183) && (z_3178[@i_4354, @i_4355] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3160, tt_62: timest, =hostS)) = injbot2(x_3179[@i_4354, @i_4355]) in
                      event fullCT(hostT, hostS, n3_3160, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3161: symseed;
                      new tc'_3162: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3162), SK_63, r2_3161) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3162)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4350 <= N3, @i_4351 <= N suchthat defined(x_3183[@i_4350, @i_4351], r7_3048[@i_4350, @i_4351], z_3182[@i_4350, @i_4351]) && ((@i_183[@i_4351] = @i_183) && (z_3182[@i_4350, @i_4351] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3160, tt_62: timest, =hostS)) = injbot2(x_3183[@i_4350, @i_4351]) in
                      event fullCT(hostT, hostS, n3_3160, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3161: symseed;
                      new tc'_3162: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3162), SK_63, r2_3161) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3162)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4346 <= N3, @i_4347 <= N suchthat defined(x_3187[@i_4346, @i_4347], r7_3058[@i_4346, @i_4347], z_3186[@i_4346, @i_4347]) && ((@i_183[@i_4347] = @i_183) && (z_3186[@i_4346, @i_4347] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3160, tt_62: timest, =hostS)) = injbot2(x_3187[@i_4346, @i_4347]) in
                      event fullCT(hostT, hostS, n3_3160, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3161: symseed;
                      new tc'_3162: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3162), SK_63, r2_3161) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3162)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4342 <= N3, @i_4343 <= N suchthat defined(x_3191[@i_4342, @i_4343], r7_3068[@i_4342, @i_4343], z_3190[@i_4342, @i_4343]) && ((@i_183[@i_4343] = @i_183) && (z_3190[@i_4342, @i_4343] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3160, tt_62: timest, =hostS)) = injbot2(x_3191[@i_4342, @i_4343]) in
                      event fullCT(hostT, hostS, n3_3160, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3161: symseed;
                      new tc'_3162: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3162), SK_63, r2_3161) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3162)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4338 <= N3, @i_4339 <= N suchthat defined(x_3195[@i_4338, @i_4339], r7_3078[@i_4338, @i_4339], z_3194[@i_4338, @i_4339]) && ((@i_183[@i_4339] = @i_183) && (z_3194[@i_4338, @i_4339] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3160, tt_62: timest, =hostS)) = injbot2(x_3195[@i_4338, @i_4339]) in
                      event fullCT(hostT, hostS, n3_3160, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3161: symseed;
                      new tc'_3162: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3162), SK_63, r2_3161) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3162)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4334 <= N3, @i_4335 <= N suchthat defined(x_3199[@i_4334, @i_4335], r7_3088[@i_4334, @i_4335], z_3198[@i_4334, @i_4335]) && ((@i_183[@i_4335] = @i_183) && (z_3198[@i_4334, @i_4335] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3160, tt_62: timest, =hostS)) = injbot2(x_3199[@i_4334, @i_4335]) in
                      event fullCT(hostT, hostS, n3_3160, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3161: symseed;
                      new tc'_3162: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3162), SK_63, r2_3161) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3162)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4330 <= N3, @i_4331 <= N suchthat defined(x_3203[@i_4330, @i_4331], r7_3098[@i_4330, @i_4331], z_3202[@i_4330, @i_4331]) && ((@i_183[@i_4331] = @i_183) && (z_3202[@i_4330, @i_4331] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3160, tt_62: timest, =hostS)) = injbot2(x_3203[@i_4330, @i_4331]) in
                      event fullCT(hostT, hostS, n3_3160, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3161: symseed;
                      new tc'_3162: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3162), SK_63, r2_3161) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3162)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4326 <= N3, @i_4327 <= N suchthat defined(x_3207[@i_4326, @i_4327], r7_3108[@i_4326, @i_4327], z_3206[@i_4326, @i_4327]) && ((@i_183[@i_4327] = @i_183) && (z_3206[@i_4326, @i_4327] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3160, tt_62: timest, =hostS)) = injbot2(x_3207[@i_4326, @i_4327]) in
                      event fullCT(hostT, hostS, n3_3160, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3161: symseed;
                      new tc'_3162: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3162), SK_63, r2_3161) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3162)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4322 <= N3, @i_4323 <= N suchthat defined(x_3211[@i_4322, @i_4323], r7_3118[@i_4322, @i_4323], z_3210[@i_4322, @i_4323]) && ((@i_183[@i_4323] = @i_183) && (z_3210[@i_4322, @i_4323] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3160, tt_62: timest, =hostS)) = injbot2(x_3211[@i_4322, @i_4323]) in
                      event fullCT(hostT, hostS, n3_3160, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3161: symseed;
                      new tc'_3162: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3162), SK_63, r2_3161) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3162)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4318 <= N3, @i_4319 <= N suchthat defined(x_3215[@i_4318, @i_4319], r7_3128[@i_4318, @i_4319], z_3214[@i_4318, @i_4319]) && ((@i_183[@i_4319] = @i_183) && (z_3214[@i_4318, @i_4319] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3160, tt_62: timest, =hostS)) = injbot2(x_3215[@i_4318, @i_4319]) in
                      event fullCT(hostT, hostS, n3_3160, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3161: symseed;
                      new tc'_3162: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3162), SK_63, r2_3161) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3162)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4314 <= N3, @i_4315 <= N suchthat defined(x_3219[@i_4314, @i_4315], r7_3138[@i_4314, @i_4315], z_3218[@i_4314, @i_4315]) && ((@i_183[@i_4315] = @i_183) && (z_3218[@i_4314, @i_4315] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3160, tt_62: timest, =hostS)) = injbot2(x_3219[@i_4314, @i_4315]) in
                      event fullCT(hostT, hostS, n3_3160, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3161: symseed;
                      new tc'_3162: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3162), SK_63, r2_3161) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3162)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4310 <= N3, @i_4311 <= N suchthat defined(x_3223[@i_4310, @i_4311], r7_3148[@i_4310, @i_4311], z_3222[@i_4310, @i_4311]) && ((@i_183[@i_4311] = @i_183) && (z_3222[@i_4310, @i_4311] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3160, tt_62: timest, =hostS)) = injbot2(x_3223[@i_4310, @i_4311]) in
                      event fullCT(hostT, hostS, n3_3160, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3161: symseed;
                      new tc'_3162: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3162), SK_63, r2_3161) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3162)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4306 <= N3, @i_4307 <= N suchthat defined(x_3227[@i_4306, @i_4307], r7_3158[@i_4306, @i_4307], z_3226[@i_4306, @i_4307]) && ((@i_183[@i_4307] = @i_183) && (z_3226[@i_4306, @i_4307] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3160, tt_62: timest, =hostS)) = injbot2(x_3227[@i_4306, @i_4307]) in
                      event fullCT(hostT, hostS, n3_3160, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3161: symseed;
                      new tc'_3162: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3162), SK_63, r2_3161) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3162)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    orfind @i_4305 <= N suchthat defined(x_3231[@i_4305], r11_1430[@i_4305], z_3230[@i_4305]) && ((@i_1384[@i_4305] = @i_183) && (z_3230[@i_4305] = m7)) then
                      let injbot2(concat8(SK_63: key, =n3_3160, tt_62: timest, =hostS)) = injbot2(x_3231[@i_4305]) in
                      event fullCT(hostT, hostS, n3_3160, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3161: symseed;
                      new tc'_3162: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3162), SK_63, r2_3161) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3162)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
                    else
                      let injbot2(concat8(SK_63: key, =n3_3160, tt_62: timest, =hostS)) = bottom in
                      event fullCT(hostT, hostS, n3_3160, TGT_58, e5, m7);
                      out(c19[!_36, !_35], acceptC2(hostT, hostS));
                      ! !_37 <= N4
                      in(c20[!_37, !_36, !_35], hostS': server);
                      if (hostS' = hostS) then
                      new r2_3161: symseed;
                      new tc'_3162: timest;
                      let e12: maxmac = encsym(pad(C, tc'_3162), SK_63, r2_3161) in
                      event partCS(hostS, hostT, m7, e12);
                      out(c6[!_37, !_36, !_35], (m6, e12));
                      in(c9[!_37, !_36, !_35], (m13: maxmac));
                      let injbot2(padts(=tc'_3162)) = decsym(m13, SK_63) in
                      event fullCS(hostS, hostT, m7, e12, m13);
                      out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = cst_key in
              new r4_1355: symseed;
              new tk_1356: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new s_1357: symkeyseed;
              new r5_1358: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = cst_key in
              new tk_1362: timest;
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new s_1363: symkeyseed;
              new r5_1364: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = cst_key in
              new r4_1367: symseed;
              new tk_1368: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new s_1369: symkeyseed;
              new r5_1370: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new tk_1374: timest;
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new s_1375: symkeyseed;
              new r5_1376: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(s3_1360[@i_1385], AK_2840[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          let injbot2(pad(=hostY_53[@i_1385], ts: timest)) = decsym(m9, kgen(s3_1360[@i_1385])) in
          event partTC(hostY_53[@i_1385], m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
            new rSK_1419: symkeyseed;
            let SK_50: key = kgen(rSK_1419) in
            new r10_1421: symseed;
            new tt_1420: timest;
            let e10: maxmac = encsym(concat5(SK_50, tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
            new r11_1422: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1420, hostW_46), kgen(s3_1360[@i_1385]), r11_1422) in
            event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, e11);
            out(c8[!_39], (hostY_53[@i_1385], e10, e11, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
            new rSK_1423: symkeyseed;
            let SK_50: key = kgen(rSK_1423) in
            new r10_1424: symseed;
            let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
            new tt_1426: timest;
            new r11_1425: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1426, hostW_46), kgen(s3_1360[@i_1385]), r11_1425) in
            event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, e11);
            out(c8[!_39], (hostY_53[@i_1385], z_1150, e11, acceptT(hostY_53[@i_1385], hostW_46)))
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], AK_2842[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          find @i_3299 <= N suchthat defined(x_3164[@i_3299], r11_1433[@i_3299], z_3163[@i_3299]) && ((@i_1384[@i_3299] = @i_1384) && (z_3163[@i_3299] = m9)) then
            let injbot2(pad(=hostY_53[@i_1384], ts: timest)) = injbot2(x_3164[@i_3299]) in
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let x_3231: maxenc = concat8(SK_50, n', tt_1428, hostW_46) in
              let z_3230: maxmac = encsym(x_3231, kgen2(s3_1372[@i_1384]), r11_1430) in
              let e11: maxmac = z_3230 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, e11);
              out(c8[!_39], (hostY_53[@i_1384], e10, e11, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new tt_1434: timest;
              new r11_1433: symseed;
              let x_3164: maxenc = concat8(SK_50, n', tt_1434, hostW_46) in
              let z_3163: maxmac = encsym(x_3164, kgen2(s3_1372[@i_1384]), r11_1433) in
              let e11: maxmac = z_3163 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, e11);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, e11, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3294 <= N3, @i_3295 <= N suchthat defined(x_3167[@i_3294, @i_3295], r7_3008[@i_3294, @i_3295], z_3166[@i_3294, @i_3295]) && ((@i_183[@i_3295] = @i_1384) && (z_3166[@i_3294, @i_3295] = m9)) then
            let injbot2(pad(=hostY_53[@i_1384], ts: timest)) = injbot2(x_3167[@i_3294, @i_3295]) in
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let x_3231: maxenc = concat8(SK_50, n', tt_1428, hostW_46) in
              let z_3230: maxmac = encsym(x_3231, kgen2(s3_1372[@i_1384]), r11_1430) in
              let e11: maxmac = z_3230 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, e11);
              out(c8[!_39], (hostY_53[@i_1384], e10, e11, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new tt_1434: timest;
              new r11_1433: symseed;
              let x_3164: maxenc = concat8(SK_50, n', tt_1434, hostW_46) in
              let z_3163: maxmac = encsym(x_3164, kgen2(s3_1372[@i_1384]), r11_1433) in
              let e11: maxmac = z_3163 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, e11);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, e11, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3290 <= N3, @i_3291 <= N suchthat defined(x_3171[@i_3290, @i_3291], r7_3018[@i_3290, @i_3291], z_3170[@i_3290, @i_3291]) && ((@i_183[@i_3291] = @i_1384) && (z_3170[@i_3290, @i_3291] = m9)) then
            let injbot2(pad(=hostY_53[@i_1384], ts: timest)) = injbot2(x_3171[@i_3290, @i_3291]) in
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let x_3231: maxenc = concat8(SK_50, n', tt_1428, hostW_46) in
              let z_3230: maxmac = encsym(x_3231, kgen2(s3_1372[@i_1384]), r11_1430) in
              let e11: maxmac = z_3230 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, e11);
              out(c8[!_39], (hostY_53[@i_1384], e10, e11, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new tt_1434: timest;
              new r11_1433: symseed;
              let x_3164: maxenc = concat8(SK_50, n', tt_1434, hostW_46) in
              let z_3163: maxmac = encsym(x_3164, kgen2(s3_1372[@i_1384]), r11_1433) in
              let e11: maxmac = z_3163 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, e11);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, e11, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3286 <= N3, @i_3287 <= N suchthat defined(x_3175[@i_3286, @i_3287], r7_3028[@i_3286, @i_3287], z_3174[@i_3286, @i_3287]) && ((@i_183[@i_3287] = @i_1384) && (z_3174[@i_3286, @i_3287] = m9)) then
            let injbot2(pad(=hostY_53[@i_1384], ts: timest)) = injbot2(x_3175[@i_3286, @i_3287]) in
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let x_3231: maxenc = concat8(SK_50, n', tt_1428, hostW_46) in
              let z_3230: maxmac = encsym(x_3231, kgen2(s3_1372[@i_1384]), r11_1430) in
              let e11: maxmac = z_3230 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, e11);
              out(c8[!_39], (hostY_53[@i_1384], e10, e11, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new tt_1434: timest;
              new r11_1433: symseed;
              let x_3164: maxenc = concat8(SK_50, n', tt_1434, hostW_46) in
              let z_3163: maxmac = encsym(x_3164, kgen2(s3_1372[@i_1384]), r11_1433) in
              let e11: maxmac = z_3163 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, e11);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, e11, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3282 <= N3, @i_3283 <= N suchthat defined(x_3179[@i_3282, @i_3283], r7_3038[@i_3282, @i_3283], z_3178[@i_3282, @i_3283]) && ((@i_183[@i_3283] = @i_1384) && (z_3178[@i_3282, @i_3283] = m9)) then
            let injbot2(pad(=hostY_53[@i_1384], ts: timest)) = injbot2(x_3179[@i_3282, @i_3283]) in
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let x_3231: maxenc = concat8(SK_50, n', tt_1428, hostW_46) in
              let z_3230: maxmac = encsym(x_3231, kgen2(s3_1372[@i_1384]), r11_1430) in
              let e11: maxmac = z_3230 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, e11);
              out(c8[!_39], (hostY_53[@i_1384], e10, e11, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new tt_1434: timest;
              new r11_1433: symseed;
              let x_3164: maxenc = concat8(SK_50, n', tt_1434, hostW_46) in
              let z_3163: maxmac = encsym(x_3164, kgen2(s3_1372[@i_1384]), r11_1433) in
              let e11: maxmac = z_3163 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, e11);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, e11, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3278 <= N3, @i_3279 <= N suchthat defined(x_3183[@i_3278, @i_3279], r7_3048[@i_3278, @i_3279], z_3182[@i_3278, @i_3279]) && ((@i_183[@i_3279] = @i_1384) && (z_3182[@i_3278, @i_3279] = m9)) then
            let injbot2(pad(=hostY_53[@i_1384], ts: timest)) = injbot2(x_3183[@i_3278, @i_3279]) in
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let x_3231: maxenc = concat8(SK_50, n', tt_1428, hostW_46) in
              let z_3230: maxmac = encsym(x_3231, kgen2(s3_1372[@i_1384]), r11_1430) in
              let e11: maxmac = z_3230 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, e11);
              out(c8[!_39], (hostY_53[@i_1384], e10, e11, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new tt_1434: timest;
              new r11_1433: symseed;
              let x_3164: maxenc = concat8(SK_50, n', tt_1434, hostW_46) in
              let z_3163: maxmac = encsym(x_3164, kgen2(s3_1372[@i_1384]), r11_1433) in
              let e11: maxmac = z_3163 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, e11);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, e11, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3274 <= N3, @i_3275 <= N suchthat defined(x_3187[@i_3274, @i_3275], r7_3058[@i_3274, @i_3275], z_3186[@i_3274, @i_3275]) && ((@i_183[@i_3275] = @i_1384) && (z_3186[@i_3274, @i_3275] = m9)) then
            let injbot2(pad(=hostY_53[@i_1384], ts: timest)) = injbot2(x_3187[@i_3274, @i_3275]) in
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let x_3231: maxenc = concat8(SK_50, n', tt_1428, hostW_46) in
              let z_3230: maxmac = encsym(x_3231, kgen2(s3_1372[@i_1384]), r11_1430) in
              let e11: maxmac = z_3230 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, e11);
              out(c8[!_39], (hostY_53[@i_1384], e10, e11, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new tt_1434: timest;
              new r11_1433: symseed;
              let x_3164: maxenc = concat8(SK_50, n', tt_1434, hostW_46) in
              let z_3163: maxmac = encsym(x_3164, kgen2(s3_1372[@i_1384]), r11_1433) in
              let e11: maxmac = z_3163 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, e11);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, e11, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3270 <= N3, @i_3271 <= N suchthat defined(x_3191[@i_3270, @i_3271], r7_3068[@i_3270, @i_3271], z_3190[@i_3270, @i_3271]) && ((@i_183[@i_3271] = @i_1384) && (z_3190[@i_3270, @i_3271] = m9)) then
            let injbot2(pad(=hostY_53[@i_1384], ts: timest)) = injbot2(x_3191[@i_3270, @i_3271]) in
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let x_3231: maxenc = concat8(SK_50, n', tt_1428, hostW_46) in
              let z_3230: maxmac = encsym(x_3231, kgen2(s3_1372[@i_1384]), r11_1430) in
              let e11: maxmac = z_3230 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, e11);
              out(c8[!_39], (hostY_53[@i_1384], e10, e11, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new tt_1434: timest;
              new r11_1433: symseed;
              let x_3164: maxenc = concat8(SK_50, n', tt_1434, hostW_46) in
              let z_3163: maxmac = encsym(x_3164, kgen2(s3_1372[@i_1384]), r11_1433) in
              let e11: maxmac = z_3163 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, e11);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, e11, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3266 <= N3, @i_3267 <= N suchthat defined(x_3195[@i_3266, @i_3267], r7_3078[@i_3266, @i_3267], z_3194[@i_3266, @i_3267]) && ((@i_183[@i_3267] = @i_1384) && (z_3194[@i_3266, @i_3267] = m9)) then
            let injbot2(pad(=hostY_53[@i_1384], ts: timest)) = injbot2(x_3195[@i_3266, @i_3267]) in
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let x_3231: maxenc = concat8(SK_50, n', tt_1428, hostW_46) in
              let z_3230: maxmac = encsym(x_3231, kgen2(s3_1372[@i_1384]), r11_1430) in
              let e11: maxmac = z_3230 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, e11);
              out(c8[!_39], (hostY_53[@i_1384], e10, e11, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new tt_1434: timest;
              new r11_1433: symseed;
              let x_3164: maxenc = concat8(SK_50, n', tt_1434, hostW_46) in
              let z_3163: maxmac = encsym(x_3164, kgen2(s3_1372[@i_1384]), r11_1433) in
              let e11: maxmac = z_3163 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, e11);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, e11, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3262 <= N3, @i_3263 <= N suchthat defined(x_3199[@i_3262, @i_3263], r7_3088[@i_3262, @i_3263], z_3198[@i_3262, @i_3263]) && ((@i_183[@i_3263] = @i_1384) && (z_3198[@i_3262, @i_3263] = m9)) then
            let injbot2(pad(=hostY_53[@i_1384], ts: timest)) = injbot2(x_3199[@i_3262, @i_3263]) in
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let x_3231: maxenc = concat8(SK_50, n', tt_1428, hostW_46) in
              let z_3230: maxmac = encsym(x_3231, kgen2(s3_1372[@i_1384]), r11_1430) in
              let e11: maxmac = z_3230 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, e11);
              out(c8[!_39], (hostY_53[@i_1384], e10, e11, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new tt_1434: timest;
              new r11_1433: symseed;
              let x_3164: maxenc = concat8(SK_50, n', tt_1434, hostW_46) in
              let z_3163: maxmac = encsym(x_3164, kgen2(s3_1372[@i_1384]), r11_1433) in
              let e11: maxmac = z_3163 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, e11);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, e11, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3258 <= N3, @i_3259 <= N suchthat defined(x_3203[@i_3258, @i_3259], r7_3098[@i_3258, @i_3259], z_3202[@i_3258, @i_3259]) && ((@i_183[@i_3259] = @i_1384) && (z_3202[@i_3258, @i_3259] = m9)) then
            let injbot2(pad(=hostY_53[@i_1384], ts: timest)) = injbot2(x_3203[@i_3258, @i_3259]) in
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let x_3231: maxenc = concat8(SK_50, n', tt_1428, hostW_46) in
              let z_3230: maxmac = encsym(x_3231, kgen2(s3_1372[@i_1384]), r11_1430) in
              let e11: maxmac = z_3230 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, e11);
              out(c8[!_39], (hostY_53[@i_1384], e10, e11, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new tt_1434: timest;
              new r11_1433: symseed;
              let x_3164: maxenc = concat8(SK_50, n', tt_1434, hostW_46) in
              let z_3163: maxmac = encsym(x_3164, kgen2(s3_1372[@i_1384]), r11_1433) in
              let e11: maxmac = z_3163 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, e11);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, e11, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3254 <= N3, @i_3255 <= N suchthat defined(x_3207[@i_3254, @i_3255], r7_3108[@i_3254, @i_3255], z_3206[@i_3254, @i_3255]) && ((@i_183[@i_3255] = @i_1384) && (z_3206[@i_3254, @i_3255] = m9)) then
            let injbot2(pad(=hostY_53[@i_1384], ts: timest)) = injbot2(x_3207[@i_3254, @i_3255]) in
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let x_3231: maxenc = concat8(SK_50, n', tt_1428, hostW_46) in
              let z_3230: maxmac = encsym(x_3231, kgen2(s3_1372[@i_1384]), r11_1430) in
              let e11: maxmac = z_3230 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, e11);
              out(c8[!_39], (hostY_53[@i_1384], e10, e11, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new tt_1434: timest;
              new r11_1433: symseed;
              let x_3164: maxenc = concat8(SK_50, n', tt_1434, hostW_46) in
              let z_3163: maxmac = encsym(x_3164, kgen2(s3_1372[@i_1384]), r11_1433) in
              let e11: maxmac = z_3163 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, e11);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, e11, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3250 <= N3, @i_3251 <= N suchthat defined(x_3211[@i_3250, @i_3251], r7_3118[@i_3250, @i_3251], z_3210[@i_3250, @i_3251]) && ((@i_183[@i_3251] = @i_1384) && (z_3210[@i_3250, @i_3251] = m9)) then
            let injbot2(pad(=hostY_53[@i_1384], ts: timest)) = injbot2(x_3211[@i_3250, @i_3251]) in
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let x_3231: maxenc = concat8(SK_50, n', tt_1428, hostW_46) in
              let z_3230: maxmac = encsym(x_3231, kgen2(s3_1372[@i_1384]), r11_1430) in
              let e11: maxmac = z_3230 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, e11);
              out(c8[!_39], (hostY_53[@i_1384], e10, e11, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new tt_1434: timest;
              new r11_1433: symseed;
              let x_3164: maxenc = concat8(SK_50, n', tt_1434, hostW_46) in
              let z_3163: maxmac = encsym(x_3164, kgen2(s3_1372[@i_1384]), r11_1433) in
              let e11: maxmac = z_3163 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, e11);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, e11, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3246 <= N3, @i_3247 <= N suchthat defined(x_3215[@i_3246, @i_3247], r7_3128[@i_3246, @i_3247], z_3214[@i_3246, @i_3247]) && ((@i_183[@i_3247] = @i_1384) && (z_3214[@i_3246, @i_3247] = m9)) then
            let injbot2(pad(=hostY_53[@i_1384], ts: timest)) = injbot2(x_3215[@i_3246, @i_3247]) in
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let x_3231: maxenc = concat8(SK_50, n', tt_1428, hostW_46) in
              let z_3230: maxmac = encsym(x_3231, kgen2(s3_1372[@i_1384]), r11_1430) in
              let e11: maxmac = z_3230 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, e11);
              out(c8[!_39], (hostY_53[@i_1384], e10, e11, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new tt_1434: timest;
              new r11_1433: symseed;
              let x_3164: maxenc = concat8(SK_50, n', tt_1434, hostW_46) in
              let z_3163: maxmac = encsym(x_3164, kgen2(s3_1372[@i_1384]), r11_1433) in
              let e11: maxmac = z_3163 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, e11);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, e11, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3242 <= N3, @i_3243 <= N suchthat defined(x_3219[@i_3242, @i_3243], r7_3138[@i_3242, @i_3243], z_3218[@i_3242, @i_3243]) && ((@i_183[@i_3243] = @i_1384) && (z_3218[@i_3242, @i_3243] = m9)) then
            let injbot2(pad(=hostY_53[@i_1384], ts: timest)) = injbot2(x_3219[@i_3242, @i_3243]) in
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let x_3231: maxenc = concat8(SK_50, n', tt_1428, hostW_46) in
              let z_3230: maxmac = encsym(x_3231, kgen2(s3_1372[@i_1384]), r11_1430) in
              let e11: maxmac = z_3230 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, e11);
              out(c8[!_39], (hostY_53[@i_1384], e10, e11, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new tt_1434: timest;
              new r11_1433: symseed;
              let x_3164: maxenc = concat8(SK_50, n', tt_1434, hostW_46) in
              let z_3163: maxmac = encsym(x_3164, kgen2(s3_1372[@i_1384]), r11_1433) in
              let e11: maxmac = z_3163 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, e11);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, e11, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3238 <= N3, @i_3239 <= N suchthat defined(x_3223[@i_3238, @i_3239], r7_3148[@i_3238, @i_3239], z_3222[@i_3238, @i_3239]) && ((@i_183[@i_3239] = @i_1384) && (z_3222[@i_3238, @i_3239] = m9)) then
            let injbot2(pad(=hostY_53[@i_1384], ts: timest)) = injbot2(x_3223[@i_3238, @i_3239]) in
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let x_3231: maxenc = concat8(SK_50, n', tt_1428, hostW_46) in
              let z_3230: maxmac = encsym(x_3231, kgen2(s3_1372[@i_1384]), r11_1430) in
              let e11: maxmac = z_3230 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, e11);
              out(c8[!_39], (hostY_53[@i_1384], e10, e11, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new tt_1434: timest;
              new r11_1433: symseed;
              let x_3164: maxenc = concat8(SK_50, n', tt_1434, hostW_46) in
              let z_3163: maxmac = encsym(x_3164, kgen2(s3_1372[@i_1384]), r11_1433) in
              let e11: maxmac = z_3163 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, e11);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, e11, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3234 <= N3, @i_3235 <= N suchthat defined(x_3227[@i_3234, @i_3235], r7_3158[@i_3234, @i_3235], z_3226[@i_3234, @i_3235]) && ((@i_183[@i_3235] = @i_1384) && (z_3226[@i_3234, @i_3235] = m9)) then
            let injbot2(pad(=hostY_53[@i_1384], ts: timest)) = injbot2(x_3227[@i_3234, @i_3235]) in
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let x_3231: maxenc = concat8(SK_50, n', tt_1428, hostW_46) in
              let z_3230: maxmac = encsym(x_3231, kgen2(s3_1372[@i_1384]), r11_1430) in
              let e11: maxmac = z_3230 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, e11);
              out(c8[!_39], (hostY_53[@i_1384], e10, e11, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new tt_1434: timest;
              new r11_1433: symseed;
              let x_3164: maxenc = concat8(SK_50, n', tt_1434, hostW_46) in
              let z_3163: maxmac = encsym(x_3164, kgen2(s3_1372[@i_1384]), r11_1433) in
              let e11: maxmac = z_3163 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, e11);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, e11, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3233 <= N suchthat defined(x_3231[@i_3233], r11_1430[@i_3233], z_3230[@i_3233]) && ((@i_1384[@i_3233] = @i_1384) && (z_3230[@i_3233] = m9)) then
            let injbot2(pad(=hostY_53[@i_1384], ts: timest)) = injbot2(x_3231[@i_3233]) in
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let x_3231: maxenc = concat8(SK_50, n', tt_1428, hostW_46) in
              let z_3230: maxmac = encsym(x_3231, kgen2(s3_1372[@i_1384]), r11_1430) in
              let e11: maxmac = z_3230 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, e11);
              out(c8[!_39], (hostY_53[@i_1384], e10, e11, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new tt_1434: timest;
              new r11_1433: symseed;
              let x_3164: maxenc = concat8(SK_50, n', tt_1434, hostW_46) in
              let z_3163: maxmac = encsym(x_3164, kgen2(s3_1372[@i_1384]), r11_1433) in
              let e11: maxmac = z_3163 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, e11);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, e11, acceptT(hostY_53[@i_1384], hostW_46)))
          else
            let injbot2(pad(=hostY_53[@i_1384], ts: timest)) = bottom in
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let x_3231: maxenc = concat8(SK_50, n', tt_1428, hostW_46) in
              let z_3230: maxmac = encsym(x_3231, kgen2(s3_1372[@i_1384]), r11_1430) in
              let e11: maxmac = z_3230 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, e11);
              out(c8[!_39], (hostY_53[@i_1384], e10, e11, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new tt_1434: timest;
              new r11_1433: symseed;
              let x_3164: maxenc = concat8(SK_50, n', tt_1434, hostW_46) in
              let z_3163: maxmac = encsym(x_3164, kgen2(s3_1372[@i_1384]), r11_1433) in
              let e11: maxmac = z_3163 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, e11);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, e11, acceptT(hostY_53[@i_1384], hostW_46)))
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying simplify [Difference of probability N * N3 / |nonce|] yields

Game 91 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKt: symkeyseed;
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2839[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1354[@i_184], z_921[@i_184], AK_2839[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_2843: symseed;
            new tc_2844: timest;
            let e5: maxmac = encsym(pad(C, tc_2844), kgen(s3_1354[@i_184]), r7_2843) in
            event partCT(hostT, TGT_58, e5);
            new n3_2845: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
            event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_2846: symseed;
            new tc'_2847: timest;
            let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2840[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1360[@i_184], z_921[@i_184], AK_2840[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_2998: symseed;
            new tc_2999: timest;
            let e5: maxmac = encsym(pad(C, tc_2999), kgen(s3_1360[@i_184]), r7_2998) in
            event partCT(hostT, TGT_58, e5);
            new n3_3000: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3000));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_3000, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
            event fullCT(hostT, hostS, n3_3000, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_3001: symseed;
            new tc'_3002: timest;
            let e12: maxmac = encsym(pad(C, tc'_3002), SK_63, r2_3001) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_3002)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2841[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1366[@i_183], z_753[@i_183], AK_2841[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3003: symseed;
            new tc_3004: timest;
            let e5: maxmac = encsym(pad(C, tc_3004), kgen(s3_1366[@i_183]), r7_3003) in
            event partCT(hostT, TGT_58, e5);
            new n3_3005: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
            event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_3006: symseed;
            new tc'_3007: timest;
            let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2842[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1372[@i_183], z_753[@i_183], AK_2842[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3158: symseed;
            new tc_3159: timest;
            let x_3227: maxenc = pad(C, tc_3159) in
            let z_3226: maxmac = encsym(x_3227, kgen2(s3_1372[@i_183]), r7_3158) in
            let e5: maxmac = z_3226 in
            event partCT(hostT, TGT_58, e5);
            new n3_3160: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3160));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_4371 <= N suchthat defined(hostW_46[@i_4371], tt_1434[@i_4371], n'[@i_4371], SK_50[@i_4371], z_3163[@i_4371], @i_1384[@i_4371]) && ((@i_1384[@i_4371] = @i_183) && (z_3163[@i_4371] = m7)) then
              let SK_63: key = SK_50[@i_4371] in
              if (n3_3160 = n'[@i_4371]) then
              let tt_62: timest = tt_1434[@i_4371] in
              if (hostS = hostW_46[@i_4371]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, e5, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_3161: symseed;
              new tc'_3162: timest;
              let e12: maxmac = encsym(pad(C, tc'_3162), SK_63, r2_3161) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_3162)) = decsym(m13, SK_63) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_4306 <= N3 suchthat defined(z_3226[@i_4306]) && (z_3226[@i_4306] = m7) then
              let @i_4307 <= N = !_35
            orfind @i_4305 <= N suchthat defined(hostW_46[@i_4305], tt_1428[@i_4305], n'[@i_4305], SK_50[@i_4305], z_3230[@i_4305], @i_1384[@i_4305]) && ((@i_1384[@i_4305] = @i_183) && (z_3230[@i_4305] = m7)) then
              let SK_63: key = SK_50[@i_4305] in
              if (n3_3160 = n'[@i_4305]) then
              let tt_62: timest = tt_1428[@i_4305] in
              if (hostS = hostW_46[@i_4305]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, e5, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_3161: symseed;
              new tc'_3162: timest;
              let e12: maxmac = encsym(pad(C, tc'_3162), SK_63, r2_3161) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_3162)) = decsym(m13, SK_63) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = cst_key in
              new r4_1355: symseed;
              new tk_1356: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new s_1357: symkeyseed;
              new r5_1358: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = cst_key in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new s_1363: symkeyseed;
              new r5_1364: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = cst_key in
              new r4_1367: symseed;
              new tk_1368: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new s_1369: symkeyseed;
              new r5_1370: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new s_1375: symkeyseed;
              new r5_1376: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(s3_1360[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          let injbot2(pad(=hostY_53[@i_1385], ts: timest)) = decsym(m9, kgen(s3_1360[@i_1385])) in
          event partTC(hostY_53[@i_1385], m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
            new rSK_1419: symkeyseed;
            let SK_50: key = kgen(rSK_1419) in
            new r10_1421: symseed;
            new tt_1420: timest;
            let e10: maxmac = encsym(concat5(SK_50, tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
            new r11_1422: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1420, hostW_46), kgen(s3_1360[@i_1385]), r11_1422) in
            event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, e11);
            out(c8[!_39], (hostY_53[@i_1385], e10, e11, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
            new rSK_1423: symkeyseed;
            let SK_50: key = kgen(rSK_1423) in
            new r10_1424: symseed;
            let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
            new tt_1426: timest;
            new r11_1425: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1426, hostW_46), kgen(s3_1360[@i_1385]), r11_1425) in
            event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, e11);
            out(c8[!_39], (hostY_53[@i_1385], z_1150, e11, acceptT(hostY_53[@i_1385], hostW_46)))
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          find @i_3299 <= N suchthat defined(z_3163[@i_3299], @i_1384[@i_3299]) && ((@i_1384[@i_3299] = @i_1384) && (z_3163[@i_3299] = m9)) then
            yield
          orfind @i_3234 <= N3, @i_3235 <= N suchthat defined(tc_3159[@i_3234, @i_3235], z_3226[@i_3234, @i_3235], @i_183[@i_3235]) && ((@i_183[@i_3235] = @i_1384) && (z_3226[@i_3234, @i_3235] = m9)) then
            let ts: timest = tc_3159[@i_3234, @i_3235] in
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let x_3231: maxenc = concat8(SK_50, n', tt_1428, hostW_46) in
              let z_3230: maxmac = encsym(x_3231, kgen2(s3_1372[@i_1384]), r11_1430) in
              let e11: maxmac = z_3230 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, e11);
              out(c8[!_39], (hostY_53[@i_1384], e10, e11, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new tt_1434: timest;
              new r11_1433: symseed;
              let x_3164: maxenc = concat8(SK_50, n', tt_1434, hostW_46) in
              let z_3163: maxmac = encsym(x_3164, kgen2(s3_1372[@i_1384]), r11_1433) in
              let e11: maxmac = z_3163 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, e11);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, e11, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3233 <= N suchthat defined(z_3230[@i_3233], @i_1384[@i_3233]) && ((@i_1384[@i_3233] = @i_1384) && (z_3230[@i_3233] = m9)) then
            yield
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying move new all binders yields

Game 92 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKs: symkeyseed;
new rKt: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2839[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1354[@i_184], z_921[@i_184], AK_2839[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_2844: timest;
            new r7_2843: symseed;
            let e5: maxmac = encsym(pad(C, tc_2844), kgen(s3_1354[@i_184]), r7_2843) in
            event partCT(hostT, TGT_58, e5);
            new n3_2845: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
            event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_2847: timest;
            new r2_2846: symseed;
            let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2840[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1360[@i_184], z_921[@i_184], AK_2840[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_2999: timest;
            new r7_2998: symseed;
            let e5: maxmac = encsym(pad(C, tc_2999), kgen(s3_1360[@i_184]), r7_2998) in
            event partCT(hostT, TGT_58, e5);
            new n3_3000: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3000));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_3000, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
            event fullCT(hostT, hostS, n3_3000, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_3002: timest;
            new r2_3001: symseed;
            let e12: maxmac = encsym(pad(C, tc'_3002), SK_63, r2_3001) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_3002)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2841[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1366[@i_183], z_753[@i_183], AK_2841[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_3004: timest;
            new r7_3003: symseed;
            let e5: maxmac = encsym(pad(C, tc_3004), kgen(s3_1366[@i_183]), r7_3003) in
            event partCT(hostT, TGT_58, e5);
            new n3_3005: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
            event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_3007: timest;
            new r2_3006: symseed;
            let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2842[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1372[@i_183], z_753[@i_183], AK_2842[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_3159: timest;
            let x_3227: maxenc = pad(C, tc_3159) in
            new r7_3158: symseed;
            let z_3226: maxmac = encsym(x_3227, kgen2(s3_1372[@i_183]), r7_3158) in
            let e5: maxmac = z_3226 in
            event partCT(hostT, TGT_58, e5);
            new n3_3160: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3160));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_4371 <= N suchthat defined(hostW_46[@i_4371], tt_1434[@i_4371], n'[@i_4371], SK_50[@i_4371], z_3163[@i_4371], @i_1384[@i_4371]) && ((@i_1384[@i_4371] = @i_183) && (z_3163[@i_4371] = m7)) then
              let SK_63: key = SK_50[@i_4371] in
              if (n3_3160 = n'[@i_4371]) then
              let tt_62: timest = tt_1434[@i_4371] in
              if (hostS = hostW_46[@i_4371]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, e5, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_3162: timest;
              new r2_3161: symseed;
              let e12: maxmac = encsym(pad(C, tc'_3162), SK_63, r2_3161) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_3162)) = decsym(m13, SK_63) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_4306 <= N3 suchthat defined(z_3226[@i_4306]) && (z_3226[@i_4306] = m7) then
              let @i_4307 <= N = !_35
            orfind @i_4305 <= N suchthat defined(hostW_46[@i_4305], tt_1428[@i_4305], n'[@i_4305], SK_50[@i_4305], z_3230[@i_4305], @i_1384[@i_4305]) && ((@i_1384[@i_4305] = @i_183) && (z_3230[@i_4305] = m7)) then
              let SK_63: key = SK_50[@i_4305] in
              if (n3_3160 = n'[@i_4305]) then
              let tt_62: timest = tt_1428[@i_4305] in
              if (hostS = hostW_46[@i_4305]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, e5, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_3162: timest;
              new r2_3161: symseed;
              let e12: maxmac = encsym(pad(C, tc'_3162), SK_63, r2_3161) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_3162)) = decsym(m13, SK_63) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = cst_key in
              new tk_1356: timest;
              new r4_1355: symseed;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new r5_1358: symseed;
              new s_1357: symkeyseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = cst_key in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new r5_1364: symseed;
              new s_1363: symkeyseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = cst_key in
              new tk_1368: timest;
              new r4_1367: symseed;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new r5_1370: symseed;
              new s_1369: symkeyseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new r5_1376: symseed;
              new s_1375: symkeyseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(s3_1360[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          let injbot2(pad(=hostY_53[@i_1385], ts: timest)) = decsym(m9, kgen(s3_1360[@i_1385])) in
          event partTC(hostY_53[@i_1385], m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
            new rSK_1419: symkeyseed;
            let SK_50: key = kgen(rSK_1419) in
            new tt_1420: timest;
            new r10_1421: symseed;
            let e10: maxmac = encsym(concat5(SK_50, tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
            new r11_1422: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1420, hostW_46), kgen(s3_1360[@i_1385]), r11_1422) in
            event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, e11);
            out(c8[!_39], (hostY_53[@i_1385], e10, e11, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
            new rSK_1423: symkeyseed;
            let SK_50: key = kgen(rSK_1423) in
            new r10_1424: symseed;
            let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
            new r11_1425: symseed;
            new tt_1426: timest;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1426, hostW_46), kgen(s3_1360[@i_1385]), r11_1425) in
            event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, e11);
            out(c8[!_39], (hostY_53[@i_1385], z_1150, e11, acceptT(hostY_53[@i_1385], hostW_46)))
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          find @i_3299 <= N suchthat defined(z_3163[@i_3299], @i_1384[@i_3299]) && ((@i_1384[@i_3299] = @i_1384) && (z_3163[@i_3299] = m9)) then
            yield
          orfind @i_3234 <= N3, @i_3235 <= N suchthat defined(tc_3159[@i_3234, @i_3235], z_3226[@i_3234, @i_3235], @i_183[@i_3235]) && ((@i_183[@i_3235] = @i_1384) && (z_3226[@i_3234, @i_3235] = m9)) then
            let ts: timest = tc_3159[@i_3234, @i_3235] in
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new tt_1428: timest;
              new r10_1429: symseed;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              let x_3231: maxenc = concat8(SK_50, n', tt_1428, hostW_46) in
              new r11_1430: symseed;
              let z_3230: maxmac = encsym(x_3231, kgen2(s3_1372[@i_1384]), r11_1430) in
              let e11: maxmac = z_3230 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, e11);
              out(c8[!_39], (hostY_53[@i_1384], e10, e11, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new tt_1434: timest;
              let x_3164: maxenc = concat8(SK_50, n', tt_1434, hostW_46) in
              new r11_1433: symseed;
              let z_3163: maxmac = encsym(x_3164, kgen2(s3_1372[@i_1384]), r11_1433) in
              let e11: maxmac = z_3163 in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, e11);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, e11, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3233 <= N suchthat defined(z_3230[@i_3233], @i_1384[@i_3233]) && ((@i_1384[@i_3233] = @i_1384) && (z_3230[@i_3233] = m9)) then
            yield
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying remove assignments of useless yields

Game 93 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKs: symkeyseed;
new rKt: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2839[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1354[@i_184], z_921[@i_184], AK_2839[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_2844: timest;
            new r7_2843: symseed;
            let e5: maxmac = encsym(pad(C, tc_2844), kgen(s3_1354[@i_184]), r7_2843) in
            event partCT(hostT, TGT_58, e5);
            new n3_2845: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
            event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_2847: timest;
            new r2_2846: symseed;
            let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2840[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1360[@i_184], z_921[@i_184], AK_2840[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_2999: timest;
            new r7_2998: symseed;
            let e5: maxmac = encsym(pad(C, tc_2999), kgen(s3_1360[@i_184]), r7_2998) in
            event partCT(hostT, TGT_58, e5);
            new n3_3000: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3000));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_3000, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1360[@i_184])) in
            event fullCT(hostT, hostS, n3_3000, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_3002: timest;
            new r2_3001: symseed;
            let e12: maxmac = encsym(pad(C, tc'_3002), SK_63, r2_3001) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_3002)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2841[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1366[@i_183], z_753[@i_183], AK_2841[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_3004: timest;
            new r7_3003: symseed;
            let e5: maxmac = encsym(pad(C, tc_3004), kgen(s3_1366[@i_183]), r7_3003) in
            event partCT(hostT, TGT_58, e5);
            new n3_3005: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
            event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_3007: timest;
            new r2_3006: symseed;
            let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2842[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1372[@i_183], z_753[@i_183], AK_2842[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_3159: timest;
            let x_3227: maxenc = pad(C, tc_3159) in
            new r7_3158: symseed;
            let z_3226: maxmac = encsym(x_3227, kgen2(s3_1372[@i_183]), r7_3158) in
            event partCT(hostT, TGT_58, z_3226);
            new n3_3160: nonce;
            out(c4[!_36, !_35], (TGT_58, z_3226, hostS, n3_3160));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_4371 <= N suchthat defined(hostW_46[@i_4371], tt_1434[@i_4371], n'[@i_4371], SK_50[@i_4371], z_3163[@i_4371], @i_1384[@i_4371]) && ((@i_1384[@i_4371] = @i_183) && (z_3163[@i_4371] = m7)) then
              if (n3_3160 = n'[@i_4371]) then
              if (hostS = hostW_46[@i_4371]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5480: timest;
              new r2_5481: symseed;
              let e12: maxmac = encsym(pad(C, tc'_5480), SK_50[@i_4371], r2_5481) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5480)) = decsym(m13, SK_50[@i_4371]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_4306 <= N3 suchthat defined(z_3226[@i_4306]) && (z_3226[@i_4306] = m7) then
              yield
            orfind @i_4305 <= N suchthat defined(hostW_46[@i_4305], tt_1428[@i_4305], n'[@i_4305], SK_50[@i_4305], z_3230[@i_4305], @i_1384[@i_4305]) && ((@i_1384[@i_4305] = @i_183) && (z_3230[@i_4305] = m7)) then
              if (n3_3160 = n'[@i_4305]) then
              if (hostS = hostW_46[@i_4305]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5482: timest;
              new r2_5483: symseed;
              let e12: maxmac = encsym(pad(C, tc'_5482), SK_50[@i_4305], r2_5483) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5482)) = decsym(m13, SK_50[@i_4305]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = cst_key in
              new tk_1356: timest;
              new r4_1355: symseed;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new r5_1358: symseed;
              new s_1357: symkeyseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = cst_key in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new r5_1364: symseed;
              new s_1363: symkeyseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = cst_key in
              new tk_1368: timest;
              new r4_1367: symseed;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new r5_1370: symseed;
              new s_1369: symkeyseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new r5_1376: symseed;
              new s_1375: symkeyseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(s3_1360[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          let injbot2(pad(=hostY_53[@i_1385], ts: timest)) = decsym(m9, kgen(s3_1360[@i_1385])) in
          event partTC(hostY_53[@i_1385], m8, m9);
          find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
            new rSK_1419: symkeyseed;
            let SK_50: key = kgen(rSK_1419) in
            new tt_1420: timest;
            new r10_1421: symseed;
            let e10: maxmac = encsym(concat5(SK_50, tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
            new r11_1422: symseed;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1420, hostW_46), kgen(s3_1360[@i_1385]), r11_1422) in
            event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, e11);
            out(c8[!_39], (hostY_53[@i_1385], e10, e11, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
            new rSK_1423: symkeyseed;
            let SK_50: key = kgen(rSK_1423) in
            new r10_1424: symseed;
            let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
            new r11_1425: symseed;
            new tt_1426: timest;
            let e11: maxmac = encsym(concat8(SK_50, n', tt_1426, hostW_46), kgen(s3_1360[@i_1385]), r11_1425) in
            event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, e11);
            out(c8[!_39], (hostY_53[@i_1385], z_1150, e11, acceptT(hostY_53[@i_1385], hostW_46)))
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          find @i_3299 <= N suchthat defined(z_3163[@i_3299], @i_1384[@i_3299]) && ((@i_1384[@i_3299] = @i_1384) && (z_3163[@i_3299] = m9)) then
            yield
          orfind @i_3234 <= N3, @i_3235 <= N suchthat defined(tc_3159[@i_3234, @i_3235], z_3226[@i_3234, @i_3235], @i_183[@i_3235]) && ((@i_183[@i_3235] = @i_1384) && (z_3226[@i_3234, @i_3235] = m9)) then
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new tt_1428: timest;
              new r10_1429: symseed;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              let x_3231: maxenc = concat8(SK_50, n', tt_1428, hostW_46) in
              new r11_1430: symseed;
              let z_3230: maxmac = encsym(x_3231, kgen2(s3_1372[@i_1384]), r11_1430) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, z_3230);
              out(c8[!_39], (hostY_53[@i_1384], e10, z_3230, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new tt_1434: timest;
              let x_3164: maxenc = concat8(SK_50, n', tt_1434, hostW_46) in
              new r11_1433: symseed;
              let z_3163: maxmac = encsym(x_3164, kgen2(s3_1372[@i_1384]), r11_1433) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, z_3163);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, z_3163, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3233 <= N suchthat defined(z_3230[@i_3233], @i_1384[@i_3233]) && ((@i_1384[@i_3233] = @i_1384) && (z_3230[@i_3233] = m9)) then
            yield
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
 [Difference of probability N * Pencctxt(time + time(context for game 93), N + N3 * N, N + N3 * N)] yields

Game 94 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKs: symkeyseed;
new rKt: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2839[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1354[@i_184], z_921[@i_184], AK_2839[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_2844: timest;
            new r7_2843: symseed;
            let e5: maxmac = encsym(pad(C, tc_2844), kgen(s3_1354[@i_184]), r7_2843) in
            event partCT(hostT, TGT_58, e5);
            new n3_2845: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
            event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_2847: timest;
            new r2_2846: symseed;
            let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2840[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1360[@i_184], z_921[@i_184], AK_2840[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_2999: timest;
            new r7_2998: symseed;
            let x_5515: maxenc = pad(C, tc_2999) in
            let z_5514: maxmac = encsym(x_5515, kgen2(s3_1360[@i_184]), r7_2998) in
            let e5: maxmac = z_5514 in
            event partCT(hostT, TGT_58, e5);
            new n3_3000: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3000));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_5534 <= N suchthat defined(x_5512[@i_5534], r11_1425[@i_5534], z_5511[@i_5534]) && ((@i_1385[@i_5534] = @i_184) && (z_5511[@i_5534] = m7)) then
              let injbot2(concat8(SK_63: key, =n3_3000, tt_62: timest, =hostS)) = injbot2(x_5512[@i_5534]) in
              event fullCT(hostT, hostS, n3_3000, TGT_58, e5, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_3002: timest;
              new r2_3001: symseed;
              let e12: maxmac = encsym(pad(C, tc'_3002), SK_63, r2_3001) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_3002)) = decsym(m13, SK_63) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_5529 <= N3, @i_5530 <= N suchthat defined(x_5515[@i_5529, @i_5530], r7_2998[@i_5529, @i_5530], z_5514[@i_5529, @i_5530]) && ((@i_184[@i_5530] = @i_184) && (z_5514[@i_5529, @i_5530] = m7)) then
              let injbot2(concat8(SK_63: key, =n3_3000, tt_62: timest, =hostS)) = injbot2(x_5515[@i_5529, @i_5530]) in
              event fullCT(hostT, hostS, n3_3000, TGT_58, e5, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_3002: timest;
              new r2_3001: symseed;
              let e12: maxmac = encsym(pad(C, tc'_3002), SK_63, r2_3001) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_3002)) = decsym(m13, SK_63) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_5528 <= N suchthat defined(x_5519[@i_5528], r11_1422[@i_5528], z_5518[@i_5528]) && ((@i_1385[@i_5528] = @i_184) && (z_5518[@i_5528] = m7)) then
              let injbot2(concat8(SK_63: key, =n3_3000, tt_62: timest, =hostS)) = injbot2(x_5519[@i_5528]) in
              event fullCT(hostT, hostS, n3_3000, TGT_58, e5, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_3002: timest;
              new r2_3001: symseed;
              let e12: maxmac = encsym(pad(C, tc'_3002), SK_63, r2_3001) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_3002)) = decsym(m13, SK_63) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            else
              let injbot2(concat8(SK_63: key, =n3_3000, tt_62: timest, =hostS)) = bottom in
              event fullCT(hostT, hostS, n3_3000, TGT_58, e5, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_3002: timest;
              new r2_3001: symseed;
              let e12: maxmac = encsym(pad(C, tc'_3002), SK_63, r2_3001) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_3002)) = decsym(m13, SK_63) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2841[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1366[@i_183], z_753[@i_183], AK_2841[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_3004: timest;
            new r7_3003: symseed;
            let e5: maxmac = encsym(pad(C, tc_3004), kgen(s3_1366[@i_183]), r7_3003) in
            event partCT(hostT, TGT_58, e5);
            new n3_3005: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
            event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_3007: timest;
            new r2_3006: symseed;
            let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2842[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1372[@i_183], z_753[@i_183], AK_2842[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_3159: timest;
            let x_3227: maxenc = pad(C, tc_3159) in
            new r7_3158: symseed;
            let z_3226: maxmac = encsym(x_3227, kgen2(s3_1372[@i_183]), r7_3158) in
            event partCT(hostT, TGT_58, z_3226);
            new n3_3160: nonce;
            out(c4[!_36, !_35], (TGT_58, z_3226, hostS, n3_3160));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_4371 <= N suchthat defined(hostW_46[@i_4371], tt_1434[@i_4371], n'[@i_4371], SK_50[@i_4371], z_3163[@i_4371], @i_1384[@i_4371]) && ((@i_1384[@i_4371] = @i_183) && (z_3163[@i_4371] = m7)) then
              if (n3_3160 = n'[@i_4371]) then
              if (hostS = hostW_46[@i_4371]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5480: timest;
              new r2_5481: symseed;
              let e12: maxmac = encsym(pad(C, tc'_5480), SK_50[@i_4371], r2_5481) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5480)) = decsym(m13, SK_50[@i_4371]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_4306 <= N3 suchthat defined(z_3226[@i_4306]) && (z_3226[@i_4306] = m7) then
              yield
            orfind @i_4305 <= N suchthat defined(hostW_46[@i_4305], tt_1428[@i_4305], n'[@i_4305], SK_50[@i_4305], z_3230[@i_4305], @i_1384[@i_4305]) && ((@i_1384[@i_4305] = @i_183) && (z_3230[@i_4305] = m7)) then
              if (n3_3160 = n'[@i_4305]) then
              if (hostS = hostW_46[@i_4305]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5482: timest;
              new r2_5483: symseed;
              let e12: maxmac = encsym(pad(C, tc'_5482), SK_50[@i_4305], r2_5483) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5482)) = decsym(m13, SK_50[@i_4305]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = cst_key in
              new tk_1356: timest;
              new r4_1355: symseed;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new r5_1358: symseed;
              new s_1357: symkeyseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = cst_key in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new r5_1364: symseed;
              new s_1363: symkeyseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = cst_key in
              new tk_1368: timest;
              new r4_1367: symseed;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new r5_1370: symseed;
              new s_1369: symkeyseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new r5_1376: symseed;
              new s_1375: symkeyseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(s3_1360[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          find @i_5527 <= N suchthat defined(x_5512[@i_5527], r11_1425[@i_5527], z_5511[@i_5527]) && ((@i_1385[@i_5527] = @i_1385) && (z_5511[@i_5527] = m9)) then
            let injbot2(pad(=hostY_53[@i_1385], ts: timest)) = injbot2(x_5512[@i_5527]) in
            event partTC(hostY_53[@i_1385], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1419: symkeyseed;
              let SK_50: key = kgen(rSK_1419) in
              new tt_1420: timest;
              new r10_1421: symseed;
              let e10: maxmac = encsym(concat5(SK_50, tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
              new r11_1422: symseed;
              let x_5519: maxenc = concat8(SK_50, n', tt_1420, hostW_46) in
              let z_5518: maxmac = encsym(x_5519, kgen2(s3_1360[@i_1385]), r11_1422) in
              let e11: maxmac = z_5518 in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, e11);
              out(c8[!_39], (hostY_53[@i_1385], e10, e11, acceptT(hostY_53[@i_1385], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1423: symkeyseed;
              let SK_50: key = kgen(rSK_1423) in
              new r10_1424: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
              new r11_1425: symseed;
              new tt_1426: timest;
              let x_5512: maxenc = concat8(SK_50, n', tt_1426, hostW_46) in
              let z_5511: maxmac = encsym(x_5512, kgen2(s3_1360[@i_1385]), r11_1425) in
              let e11: maxmac = z_5511 in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, e11);
              out(c8[!_39], (hostY_53[@i_1385], z_1150, e11, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind @i_5522 <= N3, @i_5523 <= N suchthat defined(x_5515[@i_5522, @i_5523], r7_2998[@i_5522, @i_5523], z_5514[@i_5522, @i_5523]) && ((@i_184[@i_5523] = @i_1385) && (z_5514[@i_5522, @i_5523] = m9)) then
            let injbot2(pad(=hostY_53[@i_1385], ts: timest)) = injbot2(x_5515[@i_5522, @i_5523]) in
            event partTC(hostY_53[@i_1385], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1419: symkeyseed;
              let SK_50: key = kgen(rSK_1419) in
              new tt_1420: timest;
              new r10_1421: symseed;
              let e10: maxmac = encsym(concat5(SK_50, tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
              new r11_1422: symseed;
              let x_5519: maxenc = concat8(SK_50, n', tt_1420, hostW_46) in
              let z_5518: maxmac = encsym(x_5519, kgen2(s3_1360[@i_1385]), r11_1422) in
              let e11: maxmac = z_5518 in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, e11);
              out(c8[!_39], (hostY_53[@i_1385], e10, e11, acceptT(hostY_53[@i_1385], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1423: symkeyseed;
              let SK_50: key = kgen(rSK_1423) in
              new r10_1424: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
              new r11_1425: symseed;
              new tt_1426: timest;
              let x_5512: maxenc = concat8(SK_50, n', tt_1426, hostW_46) in
              let z_5511: maxmac = encsym(x_5512, kgen2(s3_1360[@i_1385]), r11_1425) in
              let e11: maxmac = z_5511 in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, e11);
              out(c8[!_39], (hostY_53[@i_1385], z_1150, e11, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind @i_5521 <= N suchthat defined(x_5519[@i_5521], r11_1422[@i_5521], z_5518[@i_5521]) && ((@i_1385[@i_5521] = @i_1385) && (z_5518[@i_5521] = m9)) then
            let injbot2(pad(=hostY_53[@i_1385], ts: timest)) = injbot2(x_5519[@i_5521]) in
            event partTC(hostY_53[@i_1385], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1419: symkeyseed;
              let SK_50: key = kgen(rSK_1419) in
              new tt_1420: timest;
              new r10_1421: symseed;
              let e10: maxmac = encsym(concat5(SK_50, tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
              new r11_1422: symseed;
              let x_5519: maxenc = concat8(SK_50, n', tt_1420, hostW_46) in
              let z_5518: maxmac = encsym(x_5519, kgen2(s3_1360[@i_1385]), r11_1422) in
              let e11: maxmac = z_5518 in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, e11);
              out(c8[!_39], (hostY_53[@i_1385], e10, e11, acceptT(hostY_53[@i_1385], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1423: symkeyseed;
              let SK_50: key = kgen(rSK_1423) in
              new r10_1424: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
              new r11_1425: symseed;
              new tt_1426: timest;
              let x_5512: maxenc = concat8(SK_50, n', tt_1426, hostW_46) in
              let z_5511: maxmac = encsym(x_5512, kgen2(s3_1360[@i_1385]), r11_1425) in
              let e11: maxmac = z_5511 in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, e11);
              out(c8[!_39], (hostY_53[@i_1385], z_1150, e11, acceptT(hostY_53[@i_1385], hostW_46)))
          else
            let injbot2(pad(=hostY_53[@i_1385], ts: timest)) = bottom in
            event partTC(hostY_53[@i_1385], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1419: symkeyseed;
              let SK_50: key = kgen(rSK_1419) in
              new tt_1420: timest;
              new r10_1421: symseed;
              let e10: maxmac = encsym(concat5(SK_50, tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
              new r11_1422: symseed;
              let x_5519: maxenc = concat8(SK_50, n', tt_1420, hostW_46) in
              let z_5518: maxmac = encsym(x_5519, kgen2(s3_1360[@i_1385]), r11_1422) in
              let e11: maxmac = z_5518 in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, e11);
              out(c8[!_39], (hostY_53[@i_1385], e10, e11, acceptT(hostY_53[@i_1385], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1423: symkeyseed;
              let SK_50: key = kgen(rSK_1423) in
              new r10_1424: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
              new r11_1425: symseed;
              new tt_1426: timest;
              let x_5512: maxenc = concat8(SK_50, n', tt_1426, hostW_46) in
              let z_5511: maxmac = encsym(x_5512, kgen2(s3_1360[@i_1385]), r11_1425) in
              let e11: maxmac = z_5511 in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, e11);
              out(c8[!_39], (hostY_53[@i_1385], z_1150, e11, acceptT(hostY_53[@i_1385], hostW_46)))
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          find @i_3299 <= N suchthat defined(z_3163[@i_3299], @i_1384[@i_3299]) && ((@i_1384[@i_3299] = @i_1384) && (z_3163[@i_3299] = m9)) then
            yield
          orfind @i_3234 <= N3, @i_3235 <= N suchthat defined(tc_3159[@i_3234, @i_3235], z_3226[@i_3234, @i_3235], @i_183[@i_3235]) && ((@i_183[@i_3235] = @i_1384) && (z_3226[@i_3234, @i_3235] = m9)) then
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new tt_1428: timest;
              new r10_1429: symseed;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              let x_3231: maxenc = concat8(SK_50, n', tt_1428, hostW_46) in
              new r11_1430: symseed;
              let z_3230: maxmac = encsym(x_3231, kgen2(s3_1372[@i_1384]), r11_1430) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, z_3230);
              out(c8[!_39], (hostY_53[@i_1384], e10, z_3230, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new tt_1434: timest;
              let x_3164: maxenc = concat8(SK_50, n', tt_1434, hostW_46) in
              new r11_1433: symseed;
              let z_3163: maxmac = encsym(x_3164, kgen2(s3_1372[@i_1384]), r11_1433) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, z_3163);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, z_3163, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3233 <= N suchthat defined(z_3230[@i_3233], @i_1384[@i_3233]) && ((@i_1384[@i_3233] = @i_1384) && (z_3230[@i_3233] = m9)) then
            yield
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying simplify [Difference of probability N * N3 / |nonce| + 0.5 * N * N / |nonce|] yields

Game 95 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKs: symkeyseed;
new rKt: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2839[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1354[@i_184], z_921[@i_184], AK_2839[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_2844: timest;
            new r7_2843: symseed;
            let e5: maxmac = encsym(pad(C, tc_2844), kgen(s3_1354[@i_184]), r7_2843) in
            event partCT(hostT, TGT_58, e5);
            new n3_2845: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
            event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_2847: timest;
            new r2_2846: symseed;
            let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2840[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1360[@i_184], z_921[@i_184], AK_2840[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_2999: timest;
            new r7_2998: symseed;
            let x_5515: maxenc = pad(C, tc_2999) in
            let z_5514: maxmac = encsym(x_5515, kgen2(s3_1360[@i_184]), r7_2998) in
            let e5: maxmac = z_5514 in
            event partCT(hostT, TGT_58, e5);
            new n3_3000: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3000));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_5534 <= N suchthat defined(hostW_46[@i_5534], tt_1426[@i_5534], n'[@i_5534], SK_50[@i_5534], z_5511[@i_5534], @i_1385[@i_5534]) && ((@i_1385[@i_5534] = @i_184) && (z_5511[@i_5534] = m7)) then
              let SK_63: key = SK_50[@i_5534] in
              if (n3_3000 = n'[@i_5534]) then
              let tt_62: timest = tt_1426[@i_5534] in
              if (hostS = hostW_46[@i_5534]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, e5, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_3002: timest;
              new r2_3001: symseed;
              let e12: maxmac = encsym(pad(C, tc'_3002), SK_63, r2_3001) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_3002)) = decsym(m13, SK_63) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_5529 <= N3 suchthat defined(z_5514[@i_5529]) && (z_5514[@i_5529] = m7) then
              let @i_5530 <= N = !_35
            orfind @i_5528 <= N suchthat defined(hostW_46[@i_5528], tt_1420[@i_5528], n'[@i_5528], SK_50[@i_5528], z_5518[@i_5528], @i_1385[@i_5528]) && ((@i_1385[@i_5528] = @i_184) && (z_5518[@i_5528] = m7)) then
              let SK_63: key = SK_50[@i_5528] in
              if (n3_3000 = n'[@i_5528]) then
              let tt_62: timest = tt_1420[@i_5528] in
              if (hostS = hostW_46[@i_5528]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, e5, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_3002: timest;
              new r2_3001: symseed;
              let e12: maxmac = encsym(pad(C, tc'_3002), SK_63, r2_3001) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_3002)) = decsym(m13, SK_63) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2841[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1366[@i_183], z_753[@i_183], AK_2841[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_3004: timest;
            new r7_3003: symseed;
            let e5: maxmac = encsym(pad(C, tc_3004), kgen(s3_1366[@i_183]), r7_3003) in
            event partCT(hostT, TGT_58, e5);
            new n3_3005: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
            event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_3007: timest;
            new r2_3006: symseed;
            let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2842[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1372[@i_183], z_753[@i_183], AK_2842[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_3159: timest;
            let x_3227: maxenc = pad(C, tc_3159) in
            new r7_3158: symseed;
            let z_3226: maxmac = encsym(x_3227, kgen2(s3_1372[@i_183]), r7_3158) in
            event partCT(hostT, TGT_58, z_3226);
            new n3_3160: nonce;
            out(c4[!_36, !_35], (TGT_58, z_3226, hostS, n3_3160));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_4371 <= N suchthat defined(SK_50[@i_4371], hostW_46[@i_4371], n'[@i_4371], z_3163[@i_4371], @i_1384[@i_4371]) && ((@i_1384[@i_4371] = @i_183) && (z_3163[@i_4371] = m7)) then
              if (n3_3160 = n'[@i_4371]) then
              if (hostS = hostW_46[@i_4371]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5480: timest;
              new r2_5481: symseed;
              let e12: maxmac = encsym(pad(C, tc'_5480), SK_50[@i_4371], r2_5481) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5480)) = decsym(m13, SK_50[@i_4371]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_4306 <= N3 suchthat defined(z_3226[@i_4306]) && (z_3226[@i_4306] = m7) then
              yield
            orfind @i_4305 <= N suchthat defined(SK_50[@i_4305], hostW_46[@i_4305], n'[@i_4305], z_3230[@i_4305], @i_1384[@i_4305]) && ((@i_1384[@i_4305] = @i_183) && (z_3230[@i_4305] = m7)) then
              if (n3_3160 = n'[@i_4305]) then
              if (hostS = hostW_46[@i_4305]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5482: timest;
              new r2_5483: symseed;
              let e12: maxmac = encsym(pad(C, tc'_5482), SK_50[@i_4305], r2_5483) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5482)) = decsym(m13, SK_50[@i_4305]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = cst_key in
              new tk_1356: timest;
              new r4_1355: symseed;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new r5_1358: symseed;
              new s_1357: symkeyseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = cst_key in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new r5_1364: symseed;
              new s_1363: symkeyseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = cst_key in
              new tk_1368: timest;
              new r4_1367: symseed;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new r5_1370: symseed;
              new s_1369: symkeyseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new r5_1376: symseed;
              new s_1375: symkeyseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(s3_1360[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          find @i_5527 <= N suchthat defined(z_5511[@i_5527], @i_1385[@i_5527]) && ((@i_1385[@i_5527] = @i_1385) && (z_5511[@i_5527] = m9)) then
            yield
          orfind @i_5522 <= N3, @i_5523 <= N suchthat defined(tc_2999[@i_5522, @i_5523], z_5514[@i_5522, @i_5523], @i_184[@i_5523]) && ((@i_184[@i_5523] = @i_1385) && (z_5514[@i_5522, @i_5523] = m9)) then
            let ts: timest = tc_2999[@i_5522, @i_5523] in
            event partTC(hostY_53[@i_1385], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1419: symkeyseed;
              let SK_50: key = kgen(rSK_1419) in
              new tt_1420: timest;
              new r10_1421: symseed;
              let e10: maxmac = encsym(concat5(SK_50, tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
              new r11_1422: symseed;
              let x_5519: maxenc = concat8(SK_50, n', tt_1420, hostW_46) in
              let z_5518: maxmac = encsym(x_5519, kgen2(s3_1360[@i_1385]), r11_1422) in
              let e11: maxmac = z_5518 in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, e11);
              out(c8[!_39], (hostY_53[@i_1385], e10, e11, acceptT(hostY_53[@i_1385], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1423: symkeyseed;
              let SK_50: key = kgen(rSK_1423) in
              new r10_1424: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
              new r11_1425: symseed;
              new tt_1426: timest;
              let x_5512: maxenc = concat8(SK_50, n', tt_1426, hostW_46) in
              let z_5511: maxmac = encsym(x_5512, kgen2(s3_1360[@i_1385]), r11_1425) in
              let e11: maxmac = z_5511 in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, e11);
              out(c8[!_39], (hostY_53[@i_1385], z_1150, e11, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind @i_5521 <= N suchthat defined(z_5518[@i_5521], @i_1385[@i_5521]) && ((@i_1385[@i_5521] = @i_1385) && (z_5518[@i_5521] = m9)) then
            yield
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          find @i_3299 <= N suchthat defined(z_3163[@i_3299], @i_1384[@i_3299]) && ((@i_1384[@i_3299] = @i_1384) && (z_3163[@i_3299] = m9)) then
            yield
          orfind @i_3234 <= N3, @i_3235 <= N suchthat defined(z_3226[@i_3234, @i_3235], @i_183[@i_3235]) && ((@i_183[@i_3235] = @i_1384) && (z_3226[@i_3234, @i_3235] = m9)) then
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new tt_1428: timest;
              new r10_1429: symseed;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              let x_3231: maxenc = concat8(SK_50, n', tt_1428, hostW_46) in
              new r11_1430: symseed;
              let z_3230: maxmac = encsym(x_3231, kgen2(s3_1372[@i_1384]), r11_1430) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, z_3230);
              out(c8[!_39], (hostY_53[@i_1384], e10, z_3230, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new tt_1434: timest;
              let x_3164: maxenc = concat8(SK_50, n', tt_1434, hostW_46) in
              new r11_1433: symseed;
              let z_3163: maxmac = encsym(x_3164, kgen2(s3_1372[@i_1384]), r11_1433) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, z_3163);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, z_3163, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3233 <= N suchthat defined(z_3230[@i_3233], @i_1384[@i_3233]) && ((@i_1384[@i_3233] = @i_1384) && (z_3230[@i_3233] = m9)) then
            yield
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying move new all binders yields

Game 96 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKt: symkeyseed;
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2839[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1354[@i_184], z_921[@i_184], AK_2839[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_2843: symseed;
            new tc_2844: timest;
            let e5: maxmac = encsym(pad(C, tc_2844), kgen(s3_1354[@i_184]), r7_2843) in
            event partCT(hostT, TGT_58, e5);
            new n3_2845: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
            event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_2846: symseed;
            new tc'_2847: timest;
            let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2840[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1360[@i_184], z_921[@i_184], AK_2840[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_2999: timest;
            let x_5515: maxenc = pad(C, tc_2999) in
            new r7_2998: symseed;
            let z_5514: maxmac = encsym(x_5515, kgen2(s3_1360[@i_184]), r7_2998) in
            let e5: maxmac = z_5514 in
            event partCT(hostT, TGT_58, e5);
            new n3_3000: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3000));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_5534 <= N suchthat defined(hostW_46[@i_5534], tt_1426[@i_5534], n'[@i_5534], SK_50[@i_5534], z_5511[@i_5534], @i_1385[@i_5534]) && ((@i_1385[@i_5534] = @i_184) && (z_5511[@i_5534] = m7)) then
              let SK_63: key = SK_50[@i_5534] in
              if (n3_3000 = n'[@i_5534]) then
              let tt_62: timest = tt_1426[@i_5534] in
              if (hostS = hostW_46[@i_5534]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, e5, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_3001: symseed;
              new tc'_3002: timest;
              let e12: maxmac = encsym(pad(C, tc'_3002), SK_63, r2_3001) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_3002)) = decsym(m13, SK_63) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_5529 <= N3 suchthat defined(z_5514[@i_5529]) && (z_5514[@i_5529] = m7) then
              let @i_5530 <= N = !_35
            orfind @i_5528 <= N suchthat defined(hostW_46[@i_5528], tt_1420[@i_5528], n'[@i_5528], SK_50[@i_5528], z_5518[@i_5528], @i_1385[@i_5528]) && ((@i_1385[@i_5528] = @i_184) && (z_5518[@i_5528] = m7)) then
              let SK_63: key = SK_50[@i_5528] in
              if (n3_3000 = n'[@i_5528]) then
              let tt_62: timest = tt_1420[@i_5528] in
              if (hostS = hostW_46[@i_5528]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, e5, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_3001: symseed;
              new tc'_3002: timest;
              let e12: maxmac = encsym(pad(C, tc'_3002), SK_63, r2_3001) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_3002)) = decsym(m13, SK_63) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2841[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1366[@i_183], z_753[@i_183], AK_2841[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3003: symseed;
            new tc_3004: timest;
            let e5: maxmac = encsym(pad(C, tc_3004), kgen(s3_1366[@i_183]), r7_3003) in
            event partCT(hostT, TGT_58, e5);
            new n3_3005: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
            event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_3006: symseed;
            new tc'_3007: timest;
            let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2842[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1372[@i_183], z_753[@i_183], AK_2842[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_3159: timest;
            let x_3227: maxenc = pad(C, tc_3159) in
            new r7_3158: symseed;
            let z_3226: maxmac = encsym(x_3227, kgen2(s3_1372[@i_183]), r7_3158) in
            event partCT(hostT, TGT_58, z_3226);
            new n3_3160: nonce;
            out(c4[!_36, !_35], (TGT_58, z_3226, hostS, n3_3160));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_4371 <= N suchthat defined(SK_50[@i_4371], hostW_46[@i_4371], n'[@i_4371], z_3163[@i_4371], @i_1384[@i_4371]) && ((@i_1384[@i_4371] = @i_183) && (z_3163[@i_4371] = m7)) then
              if (n3_3160 = n'[@i_4371]) then
              if (hostS = hostW_46[@i_4371]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5481: symseed;
              new tc'_5480: timest;
              let e12: maxmac = encsym(pad(C, tc'_5480), SK_50[@i_4371], r2_5481) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5480)) = decsym(m13, SK_50[@i_4371]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_4306 <= N3 suchthat defined(z_3226[@i_4306]) && (z_3226[@i_4306] = m7) then
              yield
            orfind @i_4305 <= N suchthat defined(SK_50[@i_4305], hostW_46[@i_4305], n'[@i_4305], z_3230[@i_4305], @i_1384[@i_4305]) && ((@i_1384[@i_4305] = @i_183) && (z_3230[@i_4305] = m7)) then
              if (n3_3160 = n'[@i_4305]) then
              if (hostS = hostW_46[@i_4305]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5483: symseed;
              new tc'_5482: timest;
              let e12: maxmac = encsym(pad(C, tc'_5482), SK_50[@i_4305], r2_5483) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5482)) = decsym(m13, SK_50[@i_4305]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = cst_key in
              new r4_1355: symseed;
              new tk_1356: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new s_1357: symkeyseed;
              new r5_1358: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = cst_key in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new s_1363: symkeyseed;
              new r5_1364: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = cst_key in
              new r4_1367: symseed;
              new tk_1368: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new s_1369: symkeyseed;
              new r5_1370: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new s_1375: symkeyseed;
              new r5_1376: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(s3_1360[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          find @i_5527 <= N suchthat defined(z_5511[@i_5527], @i_1385[@i_5527]) && ((@i_1385[@i_5527] = @i_1385) && (z_5511[@i_5527] = m9)) then
            yield
          orfind @i_5522 <= N3, @i_5523 <= N suchthat defined(tc_2999[@i_5522, @i_5523], z_5514[@i_5522, @i_5523], @i_184[@i_5523]) && ((@i_184[@i_5523] = @i_1385) && (z_5514[@i_5522, @i_5523] = m9)) then
            let ts: timest = tc_2999[@i_5522, @i_5523] in
            event partTC(hostY_53[@i_1385], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1419: symkeyseed;
              let SK_50: key = kgen(rSK_1419) in
              new tt_1420: timest;
              new r10_1421: symseed;
              let e10: maxmac = encsym(concat5(SK_50, tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
              let x_5519: maxenc = concat8(SK_50, n', tt_1420, hostW_46) in
              new r11_1422: symseed;
              let z_5518: maxmac = encsym(x_5519, kgen2(s3_1360[@i_1385]), r11_1422) in
              let e11: maxmac = z_5518 in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, e11);
              out(c8[!_39], (hostY_53[@i_1385], e10, e11, acceptT(hostY_53[@i_1385], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1423: symkeyseed;
              let SK_50: key = kgen(rSK_1423) in
              new r10_1424: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
              new tt_1426: timest;
              let x_5512: maxenc = concat8(SK_50, n', tt_1426, hostW_46) in
              new r11_1425: symseed;
              let z_5511: maxmac = encsym(x_5512, kgen2(s3_1360[@i_1385]), r11_1425) in
              let e11: maxmac = z_5511 in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, e11);
              out(c8[!_39], (hostY_53[@i_1385], z_1150, e11, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind @i_5521 <= N suchthat defined(z_5518[@i_5521], @i_1385[@i_5521]) && ((@i_1385[@i_5521] = @i_1385) && (z_5518[@i_5521] = m9)) then
            yield
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          find @i_3299 <= N suchthat defined(z_3163[@i_3299], @i_1384[@i_3299]) && ((@i_1384[@i_3299] = @i_1384) && (z_3163[@i_3299] = m9)) then
            yield
          orfind @i_3234 <= N3, @i_3235 <= N suchthat defined(z_3226[@i_3234, @i_3235], @i_183[@i_3235]) && ((@i_183[@i_3235] = @i_1384) && (z_3226[@i_3234, @i_3235] = m9)) then
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              let x_3231: maxenc = concat8(SK_50, n', tt_1428, hostW_46) in
              new r11_1430: symseed;
              let z_3230: maxmac = encsym(x_3231, kgen2(s3_1372[@i_1384]), r11_1430) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, z_3230);
              out(c8[!_39], (hostY_53[@i_1384], e10, z_3230, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new tt_1434: timest;
              let x_3164: maxenc = concat8(SK_50, n', tt_1434, hostW_46) in
              new r11_1433: symseed;
              let z_3163: maxmac = encsym(x_3164, kgen2(s3_1372[@i_1384]), r11_1433) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, z_3163);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, z_3163, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3233 <= N suchthat defined(z_3230[@i_3233], @i_1384[@i_3233]) && ((@i_1384[@i_3233] = @i_1384) && (z_3230[@i_3233] = m9)) then
            yield
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying remove assignments of useless yields

Game 97 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKt: symkeyseed;
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2839[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1354[@i_184], z_921[@i_184], AK_2839[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_2843: symseed;
            new tc_2844: timest;
            let e5: maxmac = encsym(pad(C, tc_2844), kgen(s3_1354[@i_184]), r7_2843) in
            event partCT(hostT, TGT_58, e5);
            new n3_2845: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
            event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_2846: symseed;
            new tc'_2847: timest;
            let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2840[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1360[@i_184], z_921[@i_184], AK_2840[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_2999: timest;
            let x_5515: maxenc = pad(C, tc_2999) in
            new r7_2998: symseed;
            let z_5514: maxmac = encsym(x_5515, kgen2(s3_1360[@i_184]), r7_2998) in
            event partCT(hostT, TGT_58, z_5514);
            new n3_3000: nonce;
            out(c4[!_36, !_35], (TGT_58, z_5514, hostS, n3_3000));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_5534 <= N suchthat defined(hostW_46[@i_5534], tt_1426[@i_5534], n'[@i_5534], SK_50[@i_5534], z_5511[@i_5534], @i_1385[@i_5534]) && ((@i_1385[@i_5534] = @i_184) && (z_5511[@i_5534] = m7)) then
              if (n3_3000 = n'[@i_5534]) then
              if (hostS = hostW_46[@i_5534]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5639: symseed;
              new tc'_5640: timest;
              let e12: maxmac = encsym(pad(C, tc'_5640), SK_50[@i_5534], r2_5639) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5640)) = decsym(m13, SK_50[@i_5534]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_5529 <= N3 suchthat defined(z_5514[@i_5529]) && (z_5514[@i_5529] = m7) then
              yield
            orfind @i_5528 <= N suchthat defined(hostW_46[@i_5528], tt_1420[@i_5528], n'[@i_5528], SK_50[@i_5528], z_5518[@i_5528], @i_1385[@i_5528]) && ((@i_1385[@i_5528] = @i_184) && (z_5518[@i_5528] = m7)) then
              if (n3_3000 = n'[@i_5528]) then
              if (hostS = hostW_46[@i_5528]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5641: symseed;
              new tc'_5642: timest;
              let e12: maxmac = encsym(pad(C, tc'_5642), SK_50[@i_5528], r2_5641) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5642)) = decsym(m13, SK_50[@i_5528]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2841[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1366[@i_183], z_753[@i_183], AK_2841[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3003: symseed;
            new tc_3004: timest;
            let e5: maxmac = encsym(pad(C, tc_3004), kgen(s3_1366[@i_183]), r7_3003) in
            event partCT(hostT, TGT_58, e5);
            new n3_3005: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
            event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_3006: symseed;
            new tc'_3007: timest;
            let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2842[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1372[@i_183], z_753[@i_183], AK_2842[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_3159: timest;
            let x_3227: maxenc = pad(C, tc_3159) in
            new r7_3158: symseed;
            let z_3226: maxmac = encsym(x_3227, kgen2(s3_1372[@i_183]), r7_3158) in
            event partCT(hostT, TGT_58, z_3226);
            new n3_3160: nonce;
            out(c4[!_36, !_35], (TGT_58, z_3226, hostS, n3_3160));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_4371 <= N suchthat defined(SK_50[@i_4371], hostW_46[@i_4371], n'[@i_4371], z_3163[@i_4371], @i_1384[@i_4371]) && ((@i_1384[@i_4371] = @i_183) && (z_3163[@i_4371] = m7)) then
              if (n3_3160 = n'[@i_4371]) then
              if (hostS = hostW_46[@i_4371]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5481: symseed;
              new tc'_5480: timest;
              let e12: maxmac = encsym(pad(C, tc'_5480), SK_50[@i_4371], r2_5481) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5480)) = decsym(m13, SK_50[@i_4371]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_4306 <= N3 suchthat defined(z_3226[@i_4306]) && (z_3226[@i_4306] = m7) then
              yield
            orfind @i_4305 <= N suchthat defined(SK_50[@i_4305], hostW_46[@i_4305], n'[@i_4305], z_3230[@i_4305], @i_1384[@i_4305]) && ((@i_1384[@i_4305] = @i_183) && (z_3230[@i_4305] = m7)) then
              if (n3_3160 = n'[@i_4305]) then
              if (hostS = hostW_46[@i_4305]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5483: symseed;
              new tc'_5482: timest;
              let e12: maxmac = encsym(pad(C, tc'_5482), SK_50[@i_4305], r2_5483) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5482)) = decsym(m13, SK_50[@i_4305]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = cst_key in
              new r4_1355: symseed;
              new tk_1356: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new s_1357: symkeyseed;
              new r5_1358: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = cst_key in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new s_1363: symkeyseed;
              new r5_1364: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = cst_key in
              new r4_1367: symseed;
              new tk_1368: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new s_1369: symkeyseed;
              new r5_1370: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new s_1375: symkeyseed;
              new r5_1376: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(s3_1360[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          find @i_5527 <= N suchthat defined(z_5511[@i_5527], @i_1385[@i_5527]) && ((@i_1385[@i_5527] = @i_1385) && (z_5511[@i_5527] = m9)) then
            yield
          orfind @i_5522 <= N3, @i_5523 <= N suchthat defined(tc_2999[@i_5522, @i_5523], z_5514[@i_5522, @i_5523], @i_184[@i_5523]) && ((@i_184[@i_5523] = @i_1385) && (z_5514[@i_5522, @i_5523] = m9)) then
            event partTC(hostY_53[@i_1385], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1419: symkeyseed;
              let SK_50: key = kgen(rSK_1419) in
              new tt_1420: timest;
              new r10_1421: symseed;
              let e10: maxmac = encsym(concat5(SK_50, tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
              let x_5519: maxenc = concat8(SK_50, n', tt_1420, hostW_46) in
              new r11_1422: symseed;
              let z_5518: maxmac = encsym(x_5519, kgen2(s3_1360[@i_1385]), r11_1422) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, z_5518);
              out(c8[!_39], (hostY_53[@i_1385], e10, z_5518, acceptT(hostY_53[@i_1385], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1423: symkeyseed;
              let SK_50: key = kgen(rSK_1423) in
              new r10_1424: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
              new tt_1426: timest;
              let x_5512: maxenc = concat8(SK_50, n', tt_1426, hostW_46) in
              new r11_1425: symseed;
              let z_5511: maxmac = encsym(x_5512, kgen2(s3_1360[@i_1385]), r11_1425) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, z_5511);
              out(c8[!_39], (hostY_53[@i_1385], z_1150, z_5511, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind @i_5521 <= N suchthat defined(z_5518[@i_5521], @i_1385[@i_5521]) && ((@i_1385[@i_5521] = @i_1385) && (z_5518[@i_5521] = m9)) then
            yield
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          find @i_3299 <= N suchthat defined(z_3163[@i_3299], @i_1384[@i_3299]) && ((@i_1384[@i_3299] = @i_1384) && (z_3163[@i_3299] = m9)) then
            yield
          orfind @i_3234 <= N3, @i_3235 <= N suchthat defined(z_3226[@i_3234, @i_3235], @i_183[@i_3235]) && ((@i_183[@i_3235] = @i_1384) && (z_3226[@i_3234, @i_3235] = m9)) then
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              let x_3231: maxenc = concat8(SK_50, n', tt_1428, hostW_46) in
              new r11_1430: symseed;
              let z_3230: maxmac = encsym(x_3231, kgen2(s3_1372[@i_1384]), r11_1430) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, z_3230);
              out(c8[!_39], (hostY_53[@i_1384], e10, z_3230, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new tt_1434: timest;
              let x_3164: maxenc = concat8(SK_50, n', tt_1434, hostW_46) in
              new r11_1433: symseed;
              let z_3163: maxmac = encsym(x_3164, kgen2(s3_1372[@i_1384]), r11_1433) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, z_3163);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, z_3163, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3233 <= N suchthat defined(z_3230[@i_3233], @i_1384[@i_3233]) && ((@i_1384[@i_3233] = @i_1384) && (z_3230[@i_3233] = m9)) then
            yield
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


RESULT Proved event inj:fullCT(T, S, N, x, z, y) ==> inj:fullTC(C, S, N, x', z', v, y) with probability 2. * N3 * N * N3 * N / |nonce| + N * N / |nonce| + 2. * N * N3 / |nonce| + N * Pencctxt(time + time(context for game 93), N + N3 * N, N + N3 * N) + N * Pencctxt(time + time(context for game 89), N + N3 * N, N + N3 * N) + Penc(time + time(context for game 79), N) + Pencctxt(time + time(context for game 75), N, N) + Penc(time + time(context for game 68), N) + Pencctxt(time + time(context for game 64), N, N) + N * Penc(time + time(context for game 57), 1.) + 2. * N / |nonce| + N * Pencctxt(time + time(context for game 52), 1., N) + N * Penc(time + time(context for game 47), 1.) + N * Pencctxt(time + time(context for game 43), 1., N) + N * Pmac(time + time(context for game 38), 1., N) + N * Pmac(time + time(context for game 33), 1., N) + N * pPRF(time + time(context for game 27), 2. * 1. + 2. * N) + N * pPRF(time + time(context for game 22), 2. * 1. + 2. * N) + 3. * 1. / |skeyseed| + 3. * Psigncoll + Psign(time + time(context for game 18), 0) + N * Penc(time + time(context for game 14), N) + Psign(time + time(context for game 9), N) + Psign(time + time(context for game 5), 2. * 1.)
RESULT Proved event partTC(C, x, y) ==> (partCT(T, x', y)&&fullKC(C, T, N, w, x, y')) with probability N * N / |nonce| + 2. * N * N3 / |nonce| + N * Pencctxt(time + time(context for game 93), N + N3 * N, N + N3 * N) + N * Pencctxt(time + time(context for game 89), N + N3 * N, N + N3 * N) + Penc(time + time(context for game 79), N) + Pencctxt(time + time(context for game 75), N, N) + Penc(time + time(context for game 68), N) + Pencctxt(time + time(context for game 64), N, N) + N * Penc(time + time(context for game 57), 1.) + 2. * N / |nonce| + N * Pencctxt(time + time(context for game 52), 1., N) + N * Penc(time + time(context for game 47), 1.) + N * Pencctxt(time + time(context for game 43), 1., N) + N * Pmac(time + time(context for game 38), 1., N) + N * Pmac(time + time(context for game 33), 1., N) + N * pPRF(time + time(context for game 27), 2. * 1. + 2. * N) + N * pPRF(time + time(context for game 22), 2. * 1. + 2. * N) + 3. * 1. / |skeyseed| + 3. * Psigncoll + Psign(time + time(context for game 18), 0) + N * Penc(time + time(context for game 14), N) + Psign(time + time(context for game 9), N) + Psign(time + time(context for game 5), 2. * 1.)

Applying equivalence
equiv ! !_15 <= N2 new r: symkeyseed; ! !_16 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen2(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_17 <= N2 new r: symkeyseed; ! !_18 <= N new r2: symseed; (x: maxenc) -> encsym2(Z2(x), kgen2(r), r2)
 [Difference of probability N * Penc(time + time(context for game 98), N + N3 * N)] yields

Game 99 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKt: symkeyseed;
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2839[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1354[@i_184], z_921[@i_184], AK_2839[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_2843: symseed;
            new tc_2844: timest;
            let e5: maxmac = encsym(pad(C, tc_2844), kgen(s3_1354[@i_184]), r7_2843) in
            event partCT(hostT, TGT_58, e5);
            new n3_2845: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
            event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_2846: symseed;
            new tc'_2847: timest;
            let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2840[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1360[@i_184], z_921[@i_184], AK_2840[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_2999: timest;
            let x_5515: maxenc = pad(C, tc_2999) in
            new r7_2998: symseed;
            let z_5514: maxmac = encsym(x_5515, kgen2(s3_1360[@i_184]), r7_2998) in
            event partCT(hostT, TGT_58, z_5514);
            new n3_3000: nonce;
            out(c4[!_36, !_35], (TGT_58, z_5514, hostS, n3_3000));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_5534 <= N suchthat defined(hostW_46[@i_5534], tt_1426[@i_5534], n'[@i_5534], SK_50[@i_5534], z_5511[@i_5534], @i_1385[@i_5534]) && ((@i_1385[@i_5534] = @i_184) && (z_5511[@i_5534] = m7)) then
              if (n3_3000 = n'[@i_5534]) then
              if (hostS = hostW_46[@i_5534]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5639: symseed;
              new tc'_5640: timest;
              let e12: maxmac = encsym(pad(C, tc'_5640), SK_50[@i_5534], r2_5639) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5640)) = decsym(m13, SK_50[@i_5534]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_5529 <= N3 suchthat defined(z_5514[@i_5529]) && (z_5514[@i_5529] = m7) then
              yield
            orfind @i_5528 <= N suchthat defined(hostW_46[@i_5528], tt_1420[@i_5528], n'[@i_5528], SK_50[@i_5528], z_5518[@i_5528], @i_1385[@i_5528]) && ((@i_1385[@i_5528] = @i_184) && (z_5518[@i_5528] = m7)) then
              if (n3_3000 = n'[@i_5528]) then
              if (hostS = hostW_46[@i_5528]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5641: symseed;
              new tc'_5642: timest;
              let e12: maxmac = encsym(pad(C, tc'_5642), SK_50[@i_5528], r2_5641) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5642)) = decsym(m13, SK_50[@i_5528]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2841[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1366[@i_183], z_753[@i_183], AK_2841[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3003: symseed;
            new tc_3004: timest;
            let e5: maxmac = encsym(pad(C, tc_3004), kgen(s3_1366[@i_183]), r7_3003) in
            event partCT(hostT, TGT_58, e5);
            new n3_3005: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
            event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_3006: symseed;
            new tc'_3007: timest;
            let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2842[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1372[@i_183], z_753[@i_183], AK_2842[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_3159: timest;
            let x_3227: maxenc = pad(C, tc_3159) in
            new r7_3158: symseed;
            let z_3226: maxmac = encsym2(Z2(x_3227), kgen2(s3_1372[@i_183]), r7_3158) in
            event partCT(hostT, TGT_58, z_3226);
            new n3_3160: nonce;
            out(c4[!_36, !_35], (TGT_58, z_3226, hostS, n3_3160));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_4371 <= N suchthat defined(SK_50[@i_4371], hostW_46[@i_4371], n'[@i_4371], z_3163[@i_4371], @i_1384[@i_4371]) && ((@i_1384[@i_4371] = @i_183) && (z_3163[@i_4371] = m7)) then
              if (n3_3160 = n'[@i_4371]) then
              if (hostS = hostW_46[@i_4371]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5481: symseed;
              new tc'_5480: timest;
              let e12: maxmac = encsym(pad(C, tc'_5480), SK_50[@i_4371], r2_5481) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5480)) = decsym(m13, SK_50[@i_4371]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_4306 <= N3 suchthat defined(z_3226[@i_4306]) && (z_3226[@i_4306] = m7) then
              yield
            orfind @i_4305 <= N suchthat defined(SK_50[@i_4305], hostW_46[@i_4305], n'[@i_4305], z_3230[@i_4305], @i_1384[@i_4305]) && ((@i_1384[@i_4305] = @i_183) && (z_3230[@i_4305] = m7)) then
              if (n3_3160 = n'[@i_4305]) then
              if (hostS = hostW_46[@i_4305]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5483: symseed;
              new tc'_5482: timest;
              let e12: maxmac = encsym(pad(C, tc'_5482), SK_50[@i_4305], r2_5483) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5482)) = decsym(m13, SK_50[@i_4305]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = cst_key in
              new r4_1355: symseed;
              new tk_1356: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new s_1357: symkeyseed;
              new r5_1358: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = cst_key in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new s_1363: symkeyseed;
              new r5_1364: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = cst_key in
              new r4_1367: symseed;
              new tk_1368: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new s_1369: symkeyseed;
              new r5_1370: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new s_1375: symkeyseed;
              new r5_1376: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(s3_1360[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          find @i_5527 <= N suchthat defined(z_5511[@i_5527], @i_1385[@i_5527]) && ((@i_1385[@i_5527] = @i_1385) && (z_5511[@i_5527] = m9)) then
            yield
          orfind @i_5522 <= N3, @i_5523 <= N suchthat defined(tc_2999[@i_5522, @i_5523], z_5514[@i_5522, @i_5523], @i_184[@i_5523]) && ((@i_184[@i_5523] = @i_1385) && (z_5514[@i_5522, @i_5523] = m9)) then
            event partTC(hostY_53[@i_1385], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1419: symkeyseed;
              let SK_50: key = kgen(rSK_1419) in
              new tt_1420: timest;
              new r10_1421: symseed;
              let e10: maxmac = encsym(concat5(SK_50, tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
              let x_5519: maxenc = concat8(SK_50, n', tt_1420, hostW_46) in
              new r11_1422: symseed;
              let z_5518: maxmac = encsym(x_5519, kgen2(s3_1360[@i_1385]), r11_1422) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, z_5518);
              out(c8[!_39], (hostY_53[@i_1385], e10, z_5518, acceptT(hostY_53[@i_1385], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1423: symkeyseed;
              let SK_50: key = kgen(rSK_1423) in
              new r10_1424: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
              new tt_1426: timest;
              let x_5512: maxenc = concat8(SK_50, n', tt_1426, hostW_46) in
              new r11_1425: symseed;
              let z_5511: maxmac = encsym(x_5512, kgen2(s3_1360[@i_1385]), r11_1425) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, z_5511);
              out(c8[!_39], (hostY_53[@i_1385], z_1150, z_5511, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind @i_5521 <= N suchthat defined(z_5518[@i_5521], @i_1385[@i_5521]) && ((@i_1385[@i_5521] = @i_1385) && (z_5518[@i_5521] = m9)) then
            yield
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          find @i_3299 <= N suchthat defined(z_3163[@i_3299], @i_1384[@i_3299]) && ((@i_1384[@i_3299] = @i_1384) && (z_3163[@i_3299] = m9)) then
            yield
          orfind @i_3234 <= N3, @i_3235 <= N suchthat defined(z_3226[@i_3234, @i_3235], @i_183[@i_3235]) && ((@i_183[@i_3235] = @i_1384) && (z_3226[@i_3234, @i_3235] = m9)) then
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              let x_3231: maxenc = concat8(SK_50, n', tt_1428, hostW_46) in
              new r11_1430: symseed;
              let z_3230: maxmac = encsym2(Z2(x_3231), kgen2(s3_1372[@i_1384]), r11_1430) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, z_3230);
              out(c8[!_39], (hostY_53[@i_1384], e10, z_3230, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new tt_1434: timest;
              let x_3164: maxenc = concat8(SK_50, n', tt_1434, hostW_46) in
              new r11_1433: symseed;
              let z_3163: maxmac = encsym2(Z2(x_3164), kgen2(s3_1372[@i_1384]), r11_1433) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, z_3163);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, z_3163, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3233 <= N suchthat defined(z_3230[@i_3233], @i_1384[@i_3233]) && ((@i_1384[@i_3233] = @i_1384) && (z_3230[@i_3233] = m9)) then
            yield
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying simplify yields

Game 100 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKt: symkeyseed;
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2839[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1354[@i_184], z_921[@i_184], AK_2839[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_2843: symseed;
            new tc_2844: timest;
            let e5: maxmac = encsym(pad(C, tc_2844), kgen(s3_1354[@i_184]), r7_2843) in
            event partCT(hostT, TGT_58, e5);
            new n3_2845: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
            event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_2846: symseed;
            new tc'_2847: timest;
            let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2840[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1360[@i_184], z_921[@i_184], AK_2840[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_2999: timest;
            let x_5515: maxenc = pad(C, tc_2999) in
            new r7_2998: symseed;
            let z_5514: maxmac = encsym(x_5515, kgen2(s3_1360[@i_184]), r7_2998) in
            event partCT(hostT, TGT_58, z_5514);
            new n3_3000: nonce;
            out(c4[!_36, !_35], (TGT_58, z_5514, hostS, n3_3000));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_5534 <= N suchthat defined(SK_50[@i_5534], hostW_46[@i_5534], n'[@i_5534], z_5511[@i_5534], @i_1385[@i_5534]) && ((@i_1385[@i_5534] = @i_184) && (z_5511[@i_5534] = m7)) then
              if (n3_3000 = n'[@i_5534]) then
              if (hostS = hostW_46[@i_5534]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5639: symseed;
              new tc'_5640: timest;
              let e12: maxmac = encsym(pad(C, tc'_5640), SK_50[@i_5534], r2_5639) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5640)) = decsym(m13, SK_50[@i_5534]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_5529 <= N3 suchthat defined(z_5514[@i_5529]) && (z_5514[@i_5529] = m7) then
              yield
            orfind @i_5528 <= N suchthat defined(SK_50[@i_5528], hostW_46[@i_5528], n'[@i_5528], z_5518[@i_5528], @i_1385[@i_5528]) && ((@i_1385[@i_5528] = @i_184) && (z_5518[@i_5528] = m7)) then
              if (n3_3000 = n'[@i_5528]) then
              if (hostS = hostW_46[@i_5528]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5641: symseed;
              new tc'_5642: timest;
              let e12: maxmac = encsym(pad(C, tc'_5642), SK_50[@i_5528], r2_5641) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5642)) = decsym(m13, SK_50[@i_5528]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2841[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1366[@i_183], z_753[@i_183], AK_2841[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3003: symseed;
            new tc_3004: timest;
            let e5: maxmac = encsym(pad(C, tc_3004), kgen(s3_1366[@i_183]), r7_3003) in
            event partCT(hostT, TGT_58, e5);
            new n3_3005: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
            event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_3006: symseed;
            new tc'_3007: timest;
            let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2842[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1372[@i_183], z_753[@i_183], AK_2842[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_3159: timest;
            let x_3227: maxenc = pad(C, tc_3159) in
            new r7_3158: symseed;
            let z_3226: maxmac = encsym2(Zpad, kgen2(s3_1372[@i_183]), r7_3158) in
            event partCT(hostT, TGT_58, z_3226);
            new n3_3160: nonce;
            out(c4[!_36, !_35], (TGT_58, z_3226, hostS, n3_3160));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_4371 <= N suchthat defined(SK_50[@i_4371], hostW_46[@i_4371], n'[@i_4371], z_3163[@i_4371], @i_1384[@i_4371]) && ((@i_1384[@i_4371] = @i_183) && (z_3163[@i_4371] = m7)) then
              if (n3_3160 = n'[@i_4371]) then
              if (hostS = hostW_46[@i_4371]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5481: symseed;
              new tc'_5480: timest;
              let e12: maxmac = encsym(pad(C, tc'_5480), SK_50[@i_4371], r2_5481) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5480)) = decsym(m13, SK_50[@i_4371]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_4306 <= N3 suchthat defined(z_3226[@i_4306]) && (z_3226[@i_4306] = m7) then
              yield
            orfind @i_4305 <= N suchthat defined(SK_50[@i_4305], hostW_46[@i_4305], n'[@i_4305], z_3230[@i_4305], @i_1384[@i_4305]) && ((@i_1384[@i_4305] = @i_183) && (z_3230[@i_4305] = m7)) then
              if (n3_3160 = n'[@i_4305]) then
              if (hostS = hostW_46[@i_4305]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5483: symseed;
              new tc'_5482: timest;
              let e12: maxmac = encsym(pad(C, tc'_5482), SK_50[@i_4305], r2_5483) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5482)) = decsym(m13, SK_50[@i_4305]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = cst_key in
              new r4_1355: symseed;
              new tk_1356: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new s_1357: symkeyseed;
              new r5_1358: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = cst_key in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new s_1363: symkeyseed;
              new r5_1364: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = cst_key in
              new r4_1367: symseed;
              new tk_1368: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new s_1369: symkeyseed;
              new r5_1370: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new s_1375: symkeyseed;
              new r5_1376: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(s3_1360[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          find @i_5527 <= N suchthat defined(z_5511[@i_5527], @i_1385[@i_5527]) && ((@i_1385[@i_5527] = @i_1385) && (z_5511[@i_5527] = m9)) then
            yield
          orfind @i_5522 <= N3, @i_5523 <= N suchthat defined(z_5514[@i_5522, @i_5523], @i_184[@i_5523]) && ((@i_184[@i_5523] = @i_1385) && (z_5514[@i_5522, @i_5523] = m9)) then
            event partTC(hostY_53[@i_1385], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1419: symkeyseed;
              let SK_50: key = kgen(rSK_1419) in
              new tt_1420: timest;
              new r10_1421: symseed;
              let e10: maxmac = encsym(concat5(SK_50, tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
              let x_5519: maxenc = concat8(SK_50, n', tt_1420, hostW_46) in
              new r11_1422: symseed;
              let z_5518: maxmac = encsym(x_5519, kgen2(s3_1360[@i_1385]), r11_1422) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, z_5518);
              out(c8[!_39], (hostY_53[@i_1385], e10, z_5518, acceptT(hostY_53[@i_1385], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1423: symkeyseed;
              let SK_50: key = kgen(rSK_1423) in
              new r10_1424: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
              new tt_1426: timest;
              let x_5512: maxenc = concat8(SK_50, n', tt_1426, hostW_46) in
              new r11_1425: symseed;
              let z_5511: maxmac = encsym(x_5512, kgen2(s3_1360[@i_1385]), r11_1425) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, z_5511);
              out(c8[!_39], (hostY_53[@i_1385], z_1150, z_5511, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind @i_5521 <= N suchthat defined(z_5518[@i_5521], @i_1385[@i_5521]) && ((@i_1385[@i_5521] = @i_1385) && (z_5518[@i_5521] = m9)) then
            yield
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          find @i_3299 <= N suchthat defined(z_3163[@i_3299], @i_1384[@i_3299]) && ((@i_1384[@i_3299] = @i_1384) && (z_3163[@i_3299] = m9)) then
            yield
          orfind @i_3234 <= N3, @i_3235 <= N suchthat defined(z_3226[@i_3234, @i_3235], @i_183[@i_3235]) && ((@i_183[@i_3235] = @i_1384) && (z_3226[@i_3234, @i_3235] = m9)) then
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              let x_3231: maxenc = concat8(SK_50, n', tt_1428, hostW_46) in
              new r11_1430: symseed;
              let z_3230: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1430) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, z_3230);
              out(c8[!_39], (hostY_53[@i_1384], e10, z_3230, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new tt_1434: timest;
              let x_3164: maxenc = concat8(SK_50, n', tt_1434, hostW_46) in
              new r11_1433: symseed;
              let z_3163: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1433) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, z_3163);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, z_3163, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3233 <= N suchthat defined(z_3230[@i_3233], @i_1384[@i_3233]) && ((@i_1384[@i_3233] = @i_1384) && (z_3230[@i_3233] = m9)) then
            yield
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying move new all binders yields

Game 101 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKs: symkeyseed;
new rKt: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2839[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1354[@i_184], z_921[@i_184], AK_2839[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_2844: timest;
            new r7_2843: symseed;
            let e5: maxmac = encsym(pad(C, tc_2844), kgen(s3_1354[@i_184]), r7_2843) in
            event partCT(hostT, TGT_58, e5);
            new n3_2845: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
            event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_2847: timest;
            new r2_2846: symseed;
            let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2840[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1360[@i_184], z_921[@i_184], AK_2840[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_2999: timest;
            let x_5515: maxenc = pad(C, tc_2999) in
            new r7_2998: symseed;
            let z_5514: maxmac = encsym(x_5515, kgen2(s3_1360[@i_184]), r7_2998) in
            event partCT(hostT, TGT_58, z_5514);
            new n3_3000: nonce;
            out(c4[!_36, !_35], (TGT_58, z_5514, hostS, n3_3000));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_5534 <= N suchthat defined(SK_50[@i_5534], hostW_46[@i_5534], n'[@i_5534], z_5511[@i_5534], @i_1385[@i_5534]) && ((@i_1385[@i_5534] = @i_184) && (z_5511[@i_5534] = m7)) then
              if (n3_3000 = n'[@i_5534]) then
              if (hostS = hostW_46[@i_5534]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5640: timest;
              new r2_5639: symseed;
              let e12: maxmac = encsym(pad(C, tc'_5640), SK_50[@i_5534], r2_5639) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5640)) = decsym(m13, SK_50[@i_5534]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_5529 <= N3 suchthat defined(z_5514[@i_5529]) && (z_5514[@i_5529] = m7) then
              yield
            orfind @i_5528 <= N suchthat defined(SK_50[@i_5528], hostW_46[@i_5528], n'[@i_5528], z_5518[@i_5528], @i_1385[@i_5528]) && ((@i_1385[@i_5528] = @i_184) && (z_5518[@i_5528] = m7)) then
              if (n3_3000 = n'[@i_5528]) then
              if (hostS = hostW_46[@i_5528]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5642: timest;
              new r2_5641: symseed;
              let e12: maxmac = encsym(pad(C, tc'_5642), SK_50[@i_5528], r2_5641) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5642)) = decsym(m13, SK_50[@i_5528]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2841[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1366[@i_183], z_753[@i_183], AK_2841[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_3004: timest;
            new r7_3003: symseed;
            let e5: maxmac = encsym(pad(C, tc_3004), kgen(s3_1366[@i_183]), r7_3003) in
            event partCT(hostT, TGT_58, e5);
            new n3_3005: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
            event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_3007: timest;
            new r2_3006: symseed;
            let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2842[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1372[@i_183], z_753[@i_183], AK_2842[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_3159: timest;
            let x_3227: maxenc = pad(C, tc_3159) in
            new r7_3158: symseed;
            let z_3226: maxmac = encsym2(Zpad, kgen2(s3_1372[@i_183]), r7_3158) in
            event partCT(hostT, TGT_58, z_3226);
            new n3_3160: nonce;
            out(c4[!_36, !_35], (TGT_58, z_3226, hostS, n3_3160));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_4371 <= N suchthat defined(SK_50[@i_4371], hostW_46[@i_4371], n'[@i_4371], z_3163[@i_4371], @i_1384[@i_4371]) && ((@i_1384[@i_4371] = @i_183) && (z_3163[@i_4371] = m7)) then
              if (n3_3160 = n'[@i_4371]) then
              if (hostS = hostW_46[@i_4371]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5480: timest;
              new r2_5481: symseed;
              let e12: maxmac = encsym(pad(C, tc'_5480), SK_50[@i_4371], r2_5481) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5480)) = decsym(m13, SK_50[@i_4371]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_4306 <= N3 suchthat defined(z_3226[@i_4306]) && (z_3226[@i_4306] = m7) then
              yield
            orfind @i_4305 <= N suchthat defined(SK_50[@i_4305], hostW_46[@i_4305], n'[@i_4305], z_3230[@i_4305], @i_1384[@i_4305]) && ((@i_1384[@i_4305] = @i_183) && (z_3230[@i_4305] = m7)) then
              if (n3_3160 = n'[@i_4305]) then
              if (hostS = hostW_46[@i_4305]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5482: timest;
              new r2_5483: symseed;
              let e12: maxmac = encsym(pad(C, tc'_5482), SK_50[@i_4305], r2_5483) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5482)) = decsym(m13, SK_50[@i_4305]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = cst_key in
              new tk_1356: timest;
              new r4_1355: symseed;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new r5_1358: symseed;
              new s_1357: symkeyseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = cst_key in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new r5_1364: symseed;
              new s_1363: symkeyseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = cst_key in
              new tk_1368: timest;
              new r4_1367: symseed;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new r5_1370: symseed;
              new s_1369: symkeyseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new r5_1376: symseed;
              new s_1375: symkeyseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(s3_1360[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          find @i_5527 <= N suchthat defined(z_5511[@i_5527], @i_1385[@i_5527]) && ((@i_1385[@i_5527] = @i_1385) && (z_5511[@i_5527] = m9)) then
            yield
          orfind @i_5522 <= N3, @i_5523 <= N suchthat defined(z_5514[@i_5522, @i_5523], @i_184[@i_5523]) && ((@i_184[@i_5523] = @i_1385) && (z_5514[@i_5522, @i_5523] = m9)) then
            event partTC(hostY_53[@i_1385], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1419: symkeyseed;
              let SK_50: key = kgen(rSK_1419) in
              new r10_1421: symseed;
              new tt_1420: timest;
              let e10: maxmac = encsym(concat5(SK_50, tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
              let x_5519: maxenc = concat8(SK_50, n', tt_1420, hostW_46) in
              new r11_1422: symseed;
              let z_5518: maxmac = encsym(x_5519, kgen2(s3_1360[@i_1385]), r11_1422) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, z_5518);
              out(c8[!_39], (hostY_53[@i_1385], e10, z_5518, acceptT(hostY_53[@i_1385], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1423: symkeyseed;
              let SK_50: key = kgen(rSK_1423) in
              new r10_1424: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
              new tt_1426: timest;
              let x_5512: maxenc = concat8(SK_50, n', tt_1426, hostW_46) in
              new r11_1425: symseed;
              let z_5511: maxmac = encsym(x_5512, kgen2(s3_1360[@i_1385]), r11_1425) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, z_5511);
              out(c8[!_39], (hostY_53[@i_1385], z_1150, z_5511, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind @i_5521 <= N suchthat defined(z_5518[@i_5521], @i_1385[@i_5521]) && ((@i_1385[@i_5521] = @i_1385) && (z_5518[@i_5521] = m9)) then
            yield
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          find @i_3299 <= N suchthat defined(z_3163[@i_3299], @i_1384[@i_3299]) && ((@i_1384[@i_3299] = @i_1384) && (z_3163[@i_3299] = m9)) then
            yield
          orfind @i_3234 <= N3, @i_3235 <= N suchthat defined(z_3226[@i_3234, @i_3235], @i_183[@i_3235]) && ((@i_183[@i_3235] = @i_1384) && (z_3226[@i_3234, @i_3235] = m9)) then
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new tt_1428: timest;
              new r10_1429: symseed;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              let x_3231: maxenc = concat8(SK_50, n', tt_1428, hostW_46) in
              new r11_1430: symseed;
              let z_3230: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1430) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, z_3230);
              out(c8[!_39], (hostY_53[@i_1384], e10, z_3230, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new tt_1434: timest;
              let x_3164: maxenc = concat8(SK_50, n', tt_1434, hostW_46) in
              new r11_1433: symseed;
              let z_3163: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1433) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, z_3163);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, z_3163, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3233 <= N suchthat defined(z_3230[@i_3233], @i_1384[@i_3233]) && ((@i_1384[@i_3233] = @i_1384) && (z_3230[@i_3233] = m9)) then
            yield
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying remove assignments of useless yields

Game 102 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKs: symkeyseed;
new rKt: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2839[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1354[@i_184], z_921[@i_184], AK_2839[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_2844: timest;
            new r7_2843: symseed;
            let e5: maxmac = encsym(pad(C, tc_2844), kgen(s3_1354[@i_184]), r7_2843) in
            event partCT(hostT, TGT_58, e5);
            new n3_2845: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
            event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_2847: timest;
            new r2_2846: symseed;
            let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2840[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1360[@i_184], z_921[@i_184], AK_2840[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_2999: timest;
            let x_5515: maxenc = pad(C, tc_2999) in
            new r7_2998: symseed;
            let z_5514: maxmac = encsym(x_5515, kgen2(s3_1360[@i_184]), r7_2998) in
            event partCT(hostT, TGT_58, z_5514);
            new n3_3000: nonce;
            out(c4[!_36, !_35], (TGT_58, z_5514, hostS, n3_3000));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_5534 <= N suchthat defined(SK_50[@i_5534], hostW_46[@i_5534], n'[@i_5534], z_5511[@i_5534], @i_1385[@i_5534]) && ((@i_1385[@i_5534] = @i_184) && (z_5511[@i_5534] = m7)) then
              if (n3_3000 = n'[@i_5534]) then
              if (hostS = hostW_46[@i_5534]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5640: timest;
              new r2_5639: symseed;
              let e12: maxmac = encsym(pad(C, tc'_5640), SK_50[@i_5534], r2_5639) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5640)) = decsym(m13, SK_50[@i_5534]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_5529 <= N3 suchthat defined(z_5514[@i_5529]) && (z_5514[@i_5529] = m7) then
              yield
            orfind @i_5528 <= N suchthat defined(SK_50[@i_5528], hostW_46[@i_5528], n'[@i_5528], z_5518[@i_5528], @i_1385[@i_5528]) && ((@i_1385[@i_5528] = @i_184) && (z_5518[@i_5528] = m7)) then
              if (n3_3000 = n'[@i_5528]) then
              if (hostS = hostW_46[@i_5528]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5642: timest;
              new r2_5641: symseed;
              let e12: maxmac = encsym(pad(C, tc'_5642), SK_50[@i_5528], r2_5641) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5642)) = decsym(m13, SK_50[@i_5528]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2841[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1366[@i_183], z_753[@i_183], AK_2841[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_3004: timest;
            new r7_3003: symseed;
            let e5: maxmac = encsym(pad(C, tc_3004), kgen(s3_1366[@i_183]), r7_3003) in
            event partCT(hostT, TGT_58, e5);
            new n3_3005: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
            event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_3007: timest;
            new r2_3006: symseed;
            let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2842[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1372[@i_183], z_753[@i_183], AK_2842[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_3159: timest;
            new r7_3158: symseed;
            let z_3226: maxmac = encsym2(Zpad, kgen2(s3_1372[@i_183]), r7_3158) in
            event partCT(hostT, TGT_58, z_3226);
            new n3_3160: nonce;
            out(c4[!_36, !_35], (TGT_58, z_3226, hostS, n3_3160));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_4371 <= N suchthat defined(SK_50[@i_4371], hostW_46[@i_4371], n'[@i_4371], z_3163[@i_4371], @i_1384[@i_4371]) && ((@i_1384[@i_4371] = @i_183) && (z_3163[@i_4371] = m7)) then
              if (n3_3160 = n'[@i_4371]) then
              if (hostS = hostW_46[@i_4371]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5480: timest;
              new r2_5481: symseed;
              let e12: maxmac = encsym(pad(C, tc'_5480), SK_50[@i_4371], r2_5481) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5480)) = decsym(m13, SK_50[@i_4371]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_4306 <= N3 suchthat defined(z_3226[@i_4306]) && (z_3226[@i_4306] = m7) then
              yield
            orfind @i_4305 <= N suchthat defined(SK_50[@i_4305], hostW_46[@i_4305], n'[@i_4305], z_3230[@i_4305], @i_1384[@i_4305]) && ((@i_1384[@i_4305] = @i_183) && (z_3230[@i_4305] = m7)) then
              if (n3_3160 = n'[@i_4305]) then
              if (hostS = hostW_46[@i_4305]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5482: timest;
              new r2_5483: symseed;
              let e12: maxmac = encsym(pad(C, tc'_5482), SK_50[@i_4305], r2_5483) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5482)) = decsym(m13, SK_50[@i_4305]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = cst_key in
              new tk_1356: timest;
              new r4_1355: symseed;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new r5_1358: symseed;
              new s_1357: symkeyseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = cst_key in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new r5_1364: symseed;
              new s_1363: symkeyseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = cst_key in
              new tk_1368: timest;
              new r4_1367: symseed;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new r5_1370: symseed;
              new s_1369: symkeyseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new r5_1376: symseed;
              new s_1375: symkeyseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(s3_1360[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          find @i_5527 <= N suchthat defined(z_5511[@i_5527], @i_1385[@i_5527]) && ((@i_1385[@i_5527] = @i_1385) && (z_5511[@i_5527] = m9)) then
            yield
          orfind @i_5522 <= N3, @i_5523 <= N suchthat defined(z_5514[@i_5522, @i_5523], @i_184[@i_5523]) && ((@i_184[@i_5523] = @i_1385) && (z_5514[@i_5522, @i_5523] = m9)) then
            event partTC(hostY_53[@i_1385], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1419: symkeyseed;
              let SK_50: key = kgen(rSK_1419) in
              new r10_1421: symseed;
              new tt_1420: timest;
              let e10: maxmac = encsym(concat5(SK_50, tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
              let x_5519: maxenc = concat8(SK_50, n', tt_1420, hostW_46) in
              new r11_1422: symseed;
              let z_5518: maxmac = encsym(x_5519, kgen2(s3_1360[@i_1385]), r11_1422) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, z_5518);
              out(c8[!_39], (hostY_53[@i_1385], e10, z_5518, acceptT(hostY_53[@i_1385], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1423: symkeyseed;
              let SK_50: key = kgen(rSK_1423) in
              new r10_1424: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
              new tt_1426: timest;
              let x_5512: maxenc = concat8(SK_50, n', tt_1426, hostW_46) in
              new r11_1425: symseed;
              let z_5511: maxmac = encsym(x_5512, kgen2(s3_1360[@i_1385]), r11_1425) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, z_5511);
              out(c8[!_39], (hostY_53[@i_1385], z_1150, z_5511, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind @i_5521 <= N suchthat defined(z_5518[@i_5521], @i_1385[@i_5521]) && ((@i_1385[@i_5521] = @i_1385) && (z_5518[@i_5521] = m9)) then
            yield
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          find @i_3299 <= N suchthat defined(z_3163[@i_3299], @i_1384[@i_3299]) && ((@i_1384[@i_3299] = @i_1384) && (z_3163[@i_3299] = m9)) then
            yield
          orfind @i_3234 <= N3, @i_3235 <= N suchthat defined(z_3226[@i_3234, @i_3235], @i_183[@i_3235]) && ((@i_183[@i_3235] = @i_1384) && (z_3226[@i_3234, @i_3235] = m9)) then
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new tt_1428: timest;
              new r10_1429: symseed;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let z_3230: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1430) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, z_3230);
              out(c8[!_39], (hostY_53[@i_1384], e10, z_3230, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new tt_1434: timest;
              new r11_1433: symseed;
              let z_3163: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1433) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, z_3163);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, z_3163, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3233 <= N suchthat defined(z_3230[@i_3233], @i_1384[@i_3233]) && ((@i_1384[@i_3233] = @i_1384) && (z_3230[@i_3233] = m9)) then
            yield
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying equivalence
equiv ! !_15 <= N2 new r: symkeyseed; ! !_16 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen2(r), r2)
<=(N2 * Penc(time, N))=>
      ! !_17 <= N2 new r: symkeyseed; ! !_18 <= N new r2: symseed; (x: maxenc) -> encsym2(Z2(x), kgen2(r), r2)
 [Difference of probability N * Penc(time + time(context for game 102), N + N3 * N)] yields

Game 103 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKs: symkeyseed;
new rKt: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2839[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1354[@i_184], z_921[@i_184], AK_2839[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_2844: timest;
            new r7_2843: symseed;
            let e5: maxmac = encsym(pad(C, tc_2844), kgen(s3_1354[@i_184]), r7_2843) in
            event partCT(hostT, TGT_58, e5);
            new n3_2845: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
            event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_2847: timest;
            new r2_2846: symseed;
            let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2840[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1360[@i_184], z_921[@i_184], AK_2840[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_2999: timest;
            let x_5515: maxenc = pad(C, tc_2999) in
            new r7_2998: symseed;
            let z_5514: maxmac = encsym2(Z2(x_5515), kgen2(s3_1360[@i_184]), r7_2998) in
            event partCT(hostT, TGT_58, z_5514);
            new n3_3000: nonce;
            out(c4[!_36, !_35], (TGT_58, z_5514, hostS, n3_3000));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_5534 <= N suchthat defined(SK_50[@i_5534], hostW_46[@i_5534], n'[@i_5534], z_5511[@i_5534], @i_1385[@i_5534]) && ((@i_1385[@i_5534] = @i_184) && (z_5511[@i_5534] = m7)) then
              if (n3_3000 = n'[@i_5534]) then
              if (hostS = hostW_46[@i_5534]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5640: timest;
              new r2_5639: symseed;
              let e12: maxmac = encsym(pad(C, tc'_5640), SK_50[@i_5534], r2_5639) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5640)) = decsym(m13, SK_50[@i_5534]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_5529 <= N3 suchthat defined(z_5514[@i_5529]) && (z_5514[@i_5529] = m7) then
              yield
            orfind @i_5528 <= N suchthat defined(SK_50[@i_5528], hostW_46[@i_5528], n'[@i_5528], z_5518[@i_5528], @i_1385[@i_5528]) && ((@i_1385[@i_5528] = @i_184) && (z_5518[@i_5528] = m7)) then
              if (n3_3000 = n'[@i_5528]) then
              if (hostS = hostW_46[@i_5528]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5642: timest;
              new r2_5641: symseed;
              let e12: maxmac = encsym(pad(C, tc'_5642), SK_50[@i_5528], r2_5641) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5642)) = decsym(m13, SK_50[@i_5528]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2841[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1366[@i_183], z_753[@i_183], AK_2841[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_3004: timest;
            new r7_3003: symseed;
            let e5: maxmac = encsym(pad(C, tc_3004), kgen(s3_1366[@i_183]), r7_3003) in
            event partCT(hostT, TGT_58, e5);
            new n3_3005: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
            event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_3007: timest;
            new r2_3006: symseed;
            let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2842[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1372[@i_183], z_753[@i_183], AK_2842[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_3159: timest;
            new r7_3158: symseed;
            let z_3226: maxmac = encsym2(Zpad, kgen2(s3_1372[@i_183]), r7_3158) in
            event partCT(hostT, TGT_58, z_3226);
            new n3_3160: nonce;
            out(c4[!_36, !_35], (TGT_58, z_3226, hostS, n3_3160));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_4371 <= N suchthat defined(SK_50[@i_4371], hostW_46[@i_4371], n'[@i_4371], z_3163[@i_4371], @i_1384[@i_4371]) && ((@i_1384[@i_4371] = @i_183) && (z_3163[@i_4371] = m7)) then
              if (n3_3160 = n'[@i_4371]) then
              if (hostS = hostW_46[@i_4371]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5480: timest;
              new r2_5481: symseed;
              let e12: maxmac = encsym(pad(C, tc'_5480), SK_50[@i_4371], r2_5481) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5480)) = decsym(m13, SK_50[@i_4371]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_4306 <= N3 suchthat defined(z_3226[@i_4306]) && (z_3226[@i_4306] = m7) then
              yield
            orfind @i_4305 <= N suchthat defined(SK_50[@i_4305], hostW_46[@i_4305], n'[@i_4305], z_3230[@i_4305], @i_1384[@i_4305]) && ((@i_1384[@i_4305] = @i_183) && (z_3230[@i_4305] = m7)) then
              if (n3_3160 = n'[@i_4305]) then
              if (hostS = hostW_46[@i_4305]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5482: timest;
              new r2_5483: symseed;
              let e12: maxmac = encsym(pad(C, tc'_5482), SK_50[@i_4305], r2_5483) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5482)) = decsym(m13, SK_50[@i_4305]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = cst_key in
              new tk_1356: timest;
              new r4_1355: symseed;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new r5_1358: symseed;
              new s_1357: symkeyseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = cst_key in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new r5_1364: symseed;
              new s_1363: symkeyseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = cst_key in
              new tk_1368: timest;
              new r4_1367: symseed;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new r5_1370: symseed;
              new s_1369: symkeyseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new r5_1376: symseed;
              new s_1375: symkeyseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(s3_1360[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          find @i_5527 <= N suchthat defined(z_5511[@i_5527], @i_1385[@i_5527]) && ((@i_1385[@i_5527] = @i_1385) && (z_5511[@i_5527] = m9)) then
            yield
          orfind @i_5522 <= N3, @i_5523 <= N suchthat defined(z_5514[@i_5522, @i_5523], @i_184[@i_5523]) && ((@i_184[@i_5523] = @i_1385) && (z_5514[@i_5522, @i_5523] = m9)) then
            event partTC(hostY_53[@i_1385], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1419: symkeyseed;
              let SK_50: key = kgen(rSK_1419) in
              new r10_1421: symseed;
              new tt_1420: timest;
              let e10: maxmac = encsym(concat5(SK_50, tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
              let x_5519: maxenc = concat8(SK_50, n', tt_1420, hostW_46) in
              new r11_1422: symseed;
              let z_5518: maxmac = encsym2(Z2(x_5519), kgen2(s3_1360[@i_1385]), r11_1422) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, z_5518);
              out(c8[!_39], (hostY_53[@i_1385], e10, z_5518, acceptT(hostY_53[@i_1385], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1423: symkeyseed;
              let SK_50: key = kgen(rSK_1423) in
              new r10_1424: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
              new tt_1426: timest;
              let x_5512: maxenc = concat8(SK_50, n', tt_1426, hostW_46) in
              new r11_1425: symseed;
              let z_5511: maxmac = encsym2(Z2(x_5512), kgen2(s3_1360[@i_1385]), r11_1425) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, z_5511);
              out(c8[!_39], (hostY_53[@i_1385], z_1150, z_5511, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind @i_5521 <= N suchthat defined(z_5518[@i_5521], @i_1385[@i_5521]) && ((@i_1385[@i_5521] = @i_1385) && (z_5518[@i_5521] = m9)) then
            yield
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          find @i_3299 <= N suchthat defined(z_3163[@i_3299], @i_1384[@i_3299]) && ((@i_1384[@i_3299] = @i_1384) && (z_3163[@i_3299] = m9)) then
            yield
          orfind @i_3234 <= N3, @i_3235 <= N suchthat defined(z_3226[@i_3234, @i_3235], @i_183[@i_3235]) && ((@i_183[@i_3235] = @i_1384) && (z_3226[@i_3234, @i_3235] = m9)) then
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new tt_1428: timest;
              new r10_1429: symseed;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let z_3230: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1430) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, z_3230);
              out(c8[!_39], (hostY_53[@i_1384], e10, z_3230, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new tt_1434: timest;
              new r11_1433: symseed;
              let z_3163: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1433) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, z_3163);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, z_3163, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3233 <= N suchthat defined(z_3230[@i_3233], @i_1384[@i_3233]) && ((@i_1384[@i_3233] = @i_1384) && (z_3230[@i_3233] = m9)) then
            yield
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying simplify yields

Game 104 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKs: symkeyseed;
new rKt: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2839[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1354[@i_184], z_921[@i_184], AK_2839[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_2844: timest;
            new r7_2843: symseed;
            let e5: maxmac = encsym(pad(C, tc_2844), kgen(s3_1354[@i_184]), r7_2843) in
            event partCT(hostT, TGT_58, e5);
            new n3_2845: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
            event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_2847: timest;
            new r2_2846: symseed;
            let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2840[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1360[@i_184], z_921[@i_184], AK_2840[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_2999: timest;
            let x_5515: maxenc = pad(C, tc_2999) in
            new r7_2998: symseed;
            let z_5514: maxmac = encsym2(Zpad, kgen2(s3_1360[@i_184]), r7_2998) in
            event partCT(hostT, TGT_58, z_5514);
            new n3_3000: nonce;
            out(c4[!_36, !_35], (TGT_58, z_5514, hostS, n3_3000));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_5534 <= N suchthat defined(SK_50[@i_5534], hostW_46[@i_5534], n'[@i_5534], z_5511[@i_5534], @i_1385[@i_5534]) && ((@i_1385[@i_5534] = @i_184) && (z_5511[@i_5534] = m7)) then
              if (n3_3000 = n'[@i_5534]) then
              if (hostS = hostW_46[@i_5534]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5640: timest;
              new r2_5639: symseed;
              let e12: maxmac = encsym(pad(C, tc'_5640), SK_50[@i_5534], r2_5639) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5640)) = decsym(m13, SK_50[@i_5534]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_5529 <= N3 suchthat defined(z_5514[@i_5529]) && (z_5514[@i_5529] = m7) then
              yield
            orfind @i_5528 <= N suchthat defined(SK_50[@i_5528], hostW_46[@i_5528], n'[@i_5528], z_5518[@i_5528], @i_1385[@i_5528]) && ((@i_1385[@i_5528] = @i_184) && (z_5518[@i_5528] = m7)) then
              if (n3_3000 = n'[@i_5528]) then
              if (hostS = hostW_46[@i_5528]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5642: timest;
              new r2_5641: symseed;
              let e12: maxmac = encsym(pad(C, tc'_5642), SK_50[@i_5528], r2_5641) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5642)) = decsym(m13, SK_50[@i_5528]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2841[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1366[@i_183], z_753[@i_183], AK_2841[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_3004: timest;
            new r7_3003: symseed;
            let e5: maxmac = encsym(pad(C, tc_3004), kgen(s3_1366[@i_183]), r7_3003) in
            event partCT(hostT, TGT_58, e5);
            new n3_3005: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
            event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_3007: timest;
            new r2_3006: symseed;
            let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2842[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1372[@i_183], z_753[@i_183], AK_2842[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3158: symseed;
            let z_3226: maxmac = encsym2(Zpad, kgen2(s3_1372[@i_183]), r7_3158) in
            event partCT(hostT, TGT_58, z_3226);
            new n3_3160: nonce;
            out(c4[!_36, !_35], (TGT_58, z_3226, hostS, n3_3160));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_4371 <= N suchthat defined(SK_50[@i_4371], hostW_46[@i_4371], n'[@i_4371], z_3163[@i_4371], @i_1384[@i_4371]) && ((@i_1384[@i_4371] = @i_183) && (z_3163[@i_4371] = m7)) then
              if (n3_3160 = n'[@i_4371]) then
              if (hostS = hostW_46[@i_4371]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5480: timest;
              new r2_5481: symseed;
              let e12: maxmac = encsym(pad(C, tc'_5480), SK_50[@i_4371], r2_5481) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5480)) = decsym(m13, SK_50[@i_4371]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_4306 <= N3 suchthat defined(z_3226[@i_4306]) && (z_3226[@i_4306] = m7) then
              yield
            orfind @i_4305 <= N suchthat defined(SK_50[@i_4305], hostW_46[@i_4305], n'[@i_4305], z_3230[@i_4305], @i_1384[@i_4305]) && ((@i_1384[@i_4305] = @i_183) && (z_3230[@i_4305] = m7)) then
              if (n3_3160 = n'[@i_4305]) then
              if (hostS = hostW_46[@i_4305]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5482: timest;
              new r2_5483: symseed;
              let e12: maxmac = encsym(pad(C, tc'_5482), SK_50[@i_4305], r2_5483) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5482)) = decsym(m13, SK_50[@i_4305]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = cst_key in
              new tk_1356: timest;
              new r4_1355: symseed;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new r5_1358: symseed;
              new s_1357: symkeyseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = cst_key in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new r5_1364: symseed;
              new s_1363: symkeyseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = cst_key in
              new tk_1368: timest;
              new r4_1367: symseed;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new r5_1370: symseed;
              new s_1369: symkeyseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new r5_1376: symseed;
              new s_1375: symkeyseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(s3_1360[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          find @i_5527 <= N suchthat defined(z_5511[@i_5527], @i_1385[@i_5527]) && ((@i_1385[@i_5527] = @i_1385) && (z_5511[@i_5527] = m9)) then
            yield
          orfind @i_5522 <= N3, @i_5523 <= N suchthat defined(z_5514[@i_5522, @i_5523], @i_184[@i_5523]) && ((@i_184[@i_5523] = @i_1385) && (z_5514[@i_5522, @i_5523] = m9)) then
            event partTC(hostY_53[@i_1385], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1419: symkeyseed;
              let SK_50: key = kgen(rSK_1419) in
              new r10_1421: symseed;
              new tt_1420: timest;
              let e10: maxmac = encsym(concat5(SK_50, tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
              let x_5519: maxenc = concat8(SK_50, n', tt_1420, hostW_46) in
              new r11_1422: symseed;
              let z_5518: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1422) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, z_5518);
              out(c8[!_39], (hostY_53[@i_1385], e10, z_5518, acceptT(hostY_53[@i_1385], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1423: symkeyseed;
              let SK_50: key = kgen(rSK_1423) in
              new r10_1424: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
              new tt_1426: timest;
              let x_5512: maxenc = concat8(SK_50, n', tt_1426, hostW_46) in
              new r11_1425: symseed;
              let z_5511: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1425) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, z_5511);
              out(c8[!_39], (hostY_53[@i_1385], z_1150, z_5511, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind @i_5521 <= N suchthat defined(z_5518[@i_5521], @i_1385[@i_5521]) && ((@i_1385[@i_5521] = @i_1385) && (z_5518[@i_5521] = m9)) then
            yield
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          find @i_3299 <= N suchthat defined(z_3163[@i_3299], @i_1384[@i_3299]) && ((@i_1384[@i_3299] = @i_1384) && (z_3163[@i_3299] = m9)) then
            yield
          orfind @i_3234 <= N3, @i_3235 <= N suchthat defined(z_3226[@i_3234, @i_3235], @i_183[@i_3235]) && ((@i_183[@i_3235] = @i_1384) && (z_3226[@i_3234, @i_3235] = m9)) then
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new tt_1428: timest;
              new r10_1429: symseed;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let z_3230: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1430) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, z_3230);
              out(c8[!_39], (hostY_53[@i_1384], e10, z_3230, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new r11_1433: symseed;
              let z_3163: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1433) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, z_3163);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, z_3163, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3233 <= N suchthat defined(z_3230[@i_3233], @i_1384[@i_3233]) && ((@i_1384[@i_3233] = @i_1384) && (z_3230[@i_3233] = m9)) then
            yield
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying move new all binders yields

Game 105 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKt: symkeyseed;
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2839[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1354[@i_184], z_921[@i_184], AK_2839[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_2843: symseed;
            new tc_2844: timest;
            let e5: maxmac = encsym(pad(C, tc_2844), kgen(s3_1354[@i_184]), r7_2843) in
            event partCT(hostT, TGT_58, e5);
            new n3_2845: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
            event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_2846: symseed;
            new tc'_2847: timest;
            let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2840[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1360[@i_184], z_921[@i_184], AK_2840[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_2999: timest;
            let x_5515: maxenc = pad(C, tc_2999) in
            new r7_2998: symseed;
            let z_5514: maxmac = encsym2(Zpad, kgen2(s3_1360[@i_184]), r7_2998) in
            event partCT(hostT, TGT_58, z_5514);
            new n3_3000: nonce;
            out(c4[!_36, !_35], (TGT_58, z_5514, hostS, n3_3000));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_5534 <= N suchthat defined(SK_50[@i_5534], hostW_46[@i_5534], n'[@i_5534], z_5511[@i_5534], @i_1385[@i_5534]) && ((@i_1385[@i_5534] = @i_184) && (z_5511[@i_5534] = m7)) then
              if (n3_3000 = n'[@i_5534]) then
              if (hostS = hostW_46[@i_5534]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5639: symseed;
              new tc'_5640: timest;
              let e12: maxmac = encsym(pad(C, tc'_5640), SK_50[@i_5534], r2_5639) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5640)) = decsym(m13, SK_50[@i_5534]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_5529 <= N3 suchthat defined(z_5514[@i_5529]) && (z_5514[@i_5529] = m7) then
              yield
            orfind @i_5528 <= N suchthat defined(SK_50[@i_5528], hostW_46[@i_5528], n'[@i_5528], z_5518[@i_5528], @i_1385[@i_5528]) && ((@i_1385[@i_5528] = @i_184) && (z_5518[@i_5528] = m7)) then
              if (n3_3000 = n'[@i_5528]) then
              if (hostS = hostW_46[@i_5528]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5641: symseed;
              new tc'_5642: timest;
              let e12: maxmac = encsym(pad(C, tc'_5642), SK_50[@i_5528], r2_5641) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5642)) = decsym(m13, SK_50[@i_5528]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2841[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1366[@i_183], z_753[@i_183], AK_2841[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3003: symseed;
            new tc_3004: timest;
            let e5: maxmac = encsym(pad(C, tc_3004), kgen(s3_1366[@i_183]), r7_3003) in
            event partCT(hostT, TGT_58, e5);
            new n3_3005: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
            event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_3006: symseed;
            new tc'_3007: timest;
            let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2842[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1372[@i_183], z_753[@i_183], AK_2842[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3158: symseed;
            let z_3226: maxmac = encsym2(Zpad, kgen2(s3_1372[@i_183]), r7_3158) in
            event partCT(hostT, TGT_58, z_3226);
            new n3_3160: nonce;
            out(c4[!_36, !_35], (TGT_58, z_3226, hostS, n3_3160));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_4371 <= N suchthat defined(SK_50[@i_4371], hostW_46[@i_4371], n'[@i_4371], z_3163[@i_4371], @i_1384[@i_4371]) && ((@i_1384[@i_4371] = @i_183) && (z_3163[@i_4371] = m7)) then
              if (n3_3160 = n'[@i_4371]) then
              if (hostS = hostW_46[@i_4371]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5481: symseed;
              new tc'_5480: timest;
              let e12: maxmac = encsym(pad(C, tc'_5480), SK_50[@i_4371], r2_5481) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5480)) = decsym(m13, SK_50[@i_4371]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_4306 <= N3 suchthat defined(z_3226[@i_4306]) && (z_3226[@i_4306] = m7) then
              yield
            orfind @i_4305 <= N suchthat defined(SK_50[@i_4305], hostW_46[@i_4305], n'[@i_4305], z_3230[@i_4305], @i_1384[@i_4305]) && ((@i_1384[@i_4305] = @i_183) && (z_3230[@i_4305] = m7)) then
              if (n3_3160 = n'[@i_4305]) then
              if (hostS = hostW_46[@i_4305]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5483: symseed;
              new tc'_5482: timest;
              let e12: maxmac = encsym(pad(C, tc'_5482), SK_50[@i_4305], r2_5483) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5482)) = decsym(m13, SK_50[@i_4305]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = cst_key in
              new r4_1355: symseed;
              new tk_1356: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new s_1357: symkeyseed;
              new r5_1358: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = cst_key in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new s_1363: symkeyseed;
              new r5_1364: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = cst_key in
              new r4_1367: symseed;
              new tk_1368: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new s_1369: symkeyseed;
              new r5_1370: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new s_1375: symkeyseed;
              new r5_1376: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(s3_1360[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          find @i_5527 <= N suchthat defined(z_5511[@i_5527], @i_1385[@i_5527]) && ((@i_1385[@i_5527] = @i_1385) && (z_5511[@i_5527] = m9)) then
            yield
          orfind @i_5522 <= N3, @i_5523 <= N suchthat defined(z_5514[@i_5522, @i_5523], @i_184[@i_5523]) && ((@i_184[@i_5523] = @i_1385) && (z_5514[@i_5522, @i_5523] = m9)) then
            event partTC(hostY_53[@i_1385], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1419: symkeyseed;
              let SK_50: key = kgen(rSK_1419) in
              new tt_1420: timest;
              new r10_1421: symseed;
              let e10: maxmac = encsym(concat5(SK_50, tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
              let x_5519: maxenc = concat8(SK_50, n', tt_1420, hostW_46) in
              new r11_1422: symseed;
              let z_5518: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1422) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, z_5518);
              out(c8[!_39], (hostY_53[@i_1385], e10, z_5518, acceptT(hostY_53[@i_1385], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1423: symkeyseed;
              let SK_50: key = kgen(rSK_1423) in
              new r10_1424: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
              new tt_1426: timest;
              let x_5512: maxenc = concat8(SK_50, n', tt_1426, hostW_46) in
              new r11_1425: symseed;
              let z_5511: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1425) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, z_5511);
              out(c8[!_39], (hostY_53[@i_1385], z_1150, z_5511, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind @i_5521 <= N suchthat defined(z_5518[@i_5521], @i_1385[@i_5521]) && ((@i_1385[@i_5521] = @i_1385) && (z_5518[@i_5521] = m9)) then
            yield
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          find @i_3299 <= N suchthat defined(z_3163[@i_3299], @i_1384[@i_3299]) && ((@i_1384[@i_3299] = @i_1384) && (z_3163[@i_3299] = m9)) then
            yield
          orfind @i_3234 <= N3, @i_3235 <= N suchthat defined(z_3226[@i_3234, @i_3235], @i_183[@i_3235]) && ((@i_183[@i_3235] = @i_1384) && (z_3226[@i_3234, @i_3235] = m9)) then
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let z_3230: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1430) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, z_3230);
              out(c8[!_39], (hostY_53[@i_1384], e10, z_3230, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new r11_1433: symseed;
              let z_3163: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1433) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, z_3163);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, z_3163, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3233 <= N suchthat defined(z_3230[@i_3233], @i_1384[@i_3233]) && ((@i_1384[@i_3233] = @i_1384) && (z_3230[@i_3233] = m9)) then
            yield
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying remove assignments of useless yields

Game 106 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKt: symkeyseed;
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2839[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1354[@i_184], z_921[@i_184], AK_2839[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_2843: symseed;
            new tc_2844: timest;
            let e5: maxmac = encsym(pad(C, tc_2844), kgen(s3_1354[@i_184]), r7_2843) in
            event partCT(hostT, TGT_58, e5);
            new n3_2845: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
            event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_2846: symseed;
            new tc'_2847: timest;
            let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2840[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1360[@i_184], z_921[@i_184], AK_2840[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_2999: timest;
            new r7_2998: symseed;
            let z_5514: maxmac = encsym2(Zpad, kgen2(s3_1360[@i_184]), r7_2998) in
            event partCT(hostT, TGT_58, z_5514);
            new n3_3000: nonce;
            out(c4[!_36, !_35], (TGT_58, z_5514, hostS, n3_3000));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_5534 <= N suchthat defined(SK_50[@i_5534], hostW_46[@i_5534], n'[@i_5534], z_5511[@i_5534], @i_1385[@i_5534]) && ((@i_1385[@i_5534] = @i_184) && (z_5511[@i_5534] = m7)) then
              if (n3_3000 = n'[@i_5534]) then
              if (hostS = hostW_46[@i_5534]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5639: symseed;
              new tc'_5640: timest;
              let e12: maxmac = encsym(pad(C, tc'_5640), SK_50[@i_5534], r2_5639) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5640)) = decsym(m13, SK_50[@i_5534]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_5529 <= N3 suchthat defined(z_5514[@i_5529]) && (z_5514[@i_5529] = m7) then
              yield
            orfind @i_5528 <= N suchthat defined(SK_50[@i_5528], hostW_46[@i_5528], n'[@i_5528], z_5518[@i_5528], @i_1385[@i_5528]) && ((@i_1385[@i_5528] = @i_184) && (z_5518[@i_5528] = m7)) then
              if (n3_3000 = n'[@i_5528]) then
              if (hostS = hostW_46[@i_5528]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5641: symseed;
              new tc'_5642: timest;
              let e12: maxmac = encsym(pad(C, tc'_5642), SK_50[@i_5528], r2_5641) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5642)) = decsym(m13, SK_50[@i_5528]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2841[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1366[@i_183], z_753[@i_183], AK_2841[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3003: symseed;
            new tc_3004: timest;
            let e5: maxmac = encsym(pad(C, tc_3004), kgen(s3_1366[@i_183]), r7_3003) in
            event partCT(hostT, TGT_58, e5);
            new n3_3005: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
            event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_3006: symseed;
            new tc'_3007: timest;
            let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2842[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1372[@i_183], z_753[@i_183], AK_2842[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3158: symseed;
            let z_3226: maxmac = encsym2(Zpad, kgen2(s3_1372[@i_183]), r7_3158) in
            event partCT(hostT, TGT_58, z_3226);
            new n3_3160: nonce;
            out(c4[!_36, !_35], (TGT_58, z_3226, hostS, n3_3160));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_4371 <= N suchthat defined(SK_50[@i_4371], hostW_46[@i_4371], n'[@i_4371], z_3163[@i_4371], @i_1384[@i_4371]) && ((@i_1384[@i_4371] = @i_183) && (z_3163[@i_4371] = m7)) then
              if (n3_3160 = n'[@i_4371]) then
              if (hostS = hostW_46[@i_4371]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5481: symseed;
              new tc'_5480: timest;
              let e12: maxmac = encsym(pad(C, tc'_5480), SK_50[@i_4371], r2_5481) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5480)) = decsym(m13, SK_50[@i_4371]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_4306 <= N3 suchthat defined(z_3226[@i_4306]) && (z_3226[@i_4306] = m7) then
              yield
            orfind @i_4305 <= N suchthat defined(SK_50[@i_4305], hostW_46[@i_4305], n'[@i_4305], z_3230[@i_4305], @i_1384[@i_4305]) && ((@i_1384[@i_4305] = @i_183) && (z_3230[@i_4305] = m7)) then
              if (n3_3160 = n'[@i_4305]) then
              if (hostS = hostW_46[@i_4305]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5483: symseed;
              new tc'_5482: timest;
              let e12: maxmac = encsym(pad(C, tc'_5482), SK_50[@i_4305], r2_5483) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5482)) = decsym(m13, SK_50[@i_4305]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = cst_key in
              new r4_1355: symseed;
              new tk_1356: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new s_1357: symkeyseed;
              new r5_1358: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = cst_key in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new s_1363: symkeyseed;
              new r5_1364: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = cst_key in
              new r4_1367: symseed;
              new tk_1368: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new s_1369: symkeyseed;
              new r5_1370: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new s_1375: symkeyseed;
              new r5_1376: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(s3_1360[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          find @i_5527 <= N suchthat defined(z_5511[@i_5527], @i_1385[@i_5527]) && ((@i_1385[@i_5527] = @i_1385) && (z_5511[@i_5527] = m9)) then
            yield
          orfind @i_5522 <= N3, @i_5523 <= N suchthat defined(z_5514[@i_5522, @i_5523], @i_184[@i_5523]) && ((@i_184[@i_5523] = @i_1385) && (z_5514[@i_5522, @i_5523] = m9)) then
            event partTC(hostY_53[@i_1385], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1419: symkeyseed;
              let SK_50: key = kgen(rSK_1419) in
              new tt_1420: timest;
              new r10_1421: symseed;
              let e10: maxmac = encsym(concat5(SK_50, tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
              new r11_1422: symseed;
              let z_5518: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1422) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, z_5518);
              out(c8[!_39], (hostY_53[@i_1385], e10, z_5518, acceptT(hostY_53[@i_1385], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1423: symkeyseed;
              let SK_50: key = kgen(rSK_1423) in
              new r10_1424: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
              new tt_1426: timest;
              new r11_1425: symseed;
              let z_5511: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1425) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, z_5511);
              out(c8[!_39], (hostY_53[@i_1385], z_1150, z_5511, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind @i_5521 <= N suchthat defined(z_5518[@i_5521], @i_1385[@i_5521]) && ((@i_1385[@i_5521] = @i_1385) && (z_5518[@i_5521] = m9)) then
            yield
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          find @i_3299 <= N suchthat defined(z_3163[@i_3299], @i_1384[@i_3299]) && ((@i_1384[@i_3299] = @i_1384) && (z_3163[@i_3299] = m9)) then
            yield
          orfind @i_3234 <= N3, @i_3235 <= N suchthat defined(z_3226[@i_3234, @i_3235], @i_183[@i_3235]) && ((@i_183[@i_3235] = @i_1384) && (z_3226[@i_3234, @i_3235] = m9)) then
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(SK_50, tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let z_3230: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1430) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, z_3230);
              out(c8[!_39], (hostY_53[@i_1384], e10, z_3230, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new r11_1433: symseed;
              let z_3163: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1433) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, z_3163);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, z_3163, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3233 <= N suchthat defined(z_3230[@i_3233], @i_1384[@i_3233]) && ((@i_1384[@i_3233] = @i_1384) && (z_3230[@i_3233] = m9)) then
            yield
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying remove assignments of binder SK_50 yields

Game 107 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKt: symkeyseed;
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2839[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1354[@i_184], z_921[@i_184], AK_2839[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_2843: symseed;
            new tc_2844: timest;
            let e5: maxmac = encsym(pad(C, tc_2844), kgen(s3_1354[@i_184]), r7_2843) in
            event partCT(hostT, TGT_58, e5);
            new n3_2845: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
            event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_2846: symseed;
            new tc'_2847: timest;
            let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2840[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1360[@i_184], z_921[@i_184], AK_2840[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_2999: timest;
            new r7_2998: symseed;
            let z_5514: maxmac = encsym2(Zpad, kgen2(s3_1360[@i_184]), r7_2998) in
            event partCT(hostT, TGT_58, z_5514);
            new n3_3000: nonce;
            out(c4[!_36, !_35], (TGT_58, z_5514, hostS, n3_3000));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_5534 <= N suchthat defined(SK_50[@i_5534], hostW_46[@i_5534], n'[@i_5534], z_5511[@i_5534], @i_1385[@i_5534]) && ((@i_1385[@i_5534] = @i_184) && (z_5511[@i_5534] = m7)) then
              if (n3_3000 = n'[@i_5534]) then
              if (hostS = hostW_46[@i_5534]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5639: symseed;
              new tc'_5640: timest;
              let e12: maxmac = encsym(pad(C, tc'_5640), SK_50[@i_5534], r2_5639) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5640)) = decsym(m13, SK_50[@i_5534]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_5529 <= N3 suchthat defined(z_5514[@i_5529]) && (z_5514[@i_5529] = m7) then
              yield
            orfind @i_5528 <= N suchthat defined(SK_50[@i_5528], hostW_46[@i_5528], n'[@i_5528], z_5518[@i_5528], @i_1385[@i_5528]) && ((@i_1385[@i_5528] = @i_184) && (z_5518[@i_5528] = m7)) then
              if (n3_3000 = n'[@i_5528]) then
              if (hostS = hostW_46[@i_5528]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5641: symseed;
              new tc'_5642: timest;
              let e12: maxmac = encsym(pad(C, tc'_5642), SK_50[@i_5528], r2_5641) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5642)) = decsym(m13, SK_50[@i_5528]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2841[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1366[@i_183], z_753[@i_183], AK_2841[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3003: symseed;
            new tc_3004: timest;
            let e5: maxmac = encsym(pad(C, tc_3004), kgen(s3_1366[@i_183]), r7_3003) in
            event partCT(hostT, TGT_58, e5);
            new n3_3005: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
            event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_3006: symseed;
            new tc'_3007: timest;
            let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2842[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1372[@i_183], z_753[@i_183], AK_2842[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3158: symseed;
            let z_3226: maxmac = encsym2(Zpad, kgen2(s3_1372[@i_183]), r7_3158) in
            event partCT(hostT, TGT_58, z_3226);
            new n3_3160: nonce;
            out(c4[!_36, !_35], (TGT_58, z_3226, hostS, n3_3160));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_4371 <= N suchthat defined(SK_50[@i_4371], hostW_46[@i_4371], n'[@i_4371], z_3163[@i_4371], @i_1384[@i_4371]) && ((@i_1384[@i_4371] = @i_183) && (z_3163[@i_4371] = m7)) then
              if (n3_3160 = n'[@i_4371]) then
              if (hostS = hostW_46[@i_4371]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5481: symseed;
              new tc'_5480: timest;
              let e12: maxmac = encsym(pad(C, tc'_5480), SK_50[@i_4371], r2_5481) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5480)) = decsym(m13, SK_50[@i_4371]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_4306 <= N3 suchthat defined(z_3226[@i_4306]) && (z_3226[@i_4306] = m7) then
              yield
            orfind @i_4305 <= N suchthat defined(SK_50[@i_4305], hostW_46[@i_4305], n'[@i_4305], z_3230[@i_4305], @i_1384[@i_4305]) && ((@i_1384[@i_4305] = @i_183) && (z_3230[@i_4305] = m7)) then
              if (n3_3160 = n'[@i_4305]) then
              if (hostS = hostW_46[@i_4305]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5483: symseed;
              new tc'_5482: timest;
              let e12: maxmac = encsym(pad(C, tc'_5482), SK_50[@i_4305], r2_5483) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5482)) = decsym(m13, SK_50[@i_4305]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = cst_key in
              new r4_1355: symseed;
              new tk_1356: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new s_1357: symkeyseed;
              new r5_1358: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = cst_key in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new s_1363: symkeyseed;
              new r5_1364: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = cst_key in
              new r4_1367: symseed;
              new tk_1368: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new s_1369: symkeyseed;
              new r5_1370: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new s_1375: symkeyseed;
              new r5_1376: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(s3_1360[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          find @i_5527 <= N suchthat defined(z_5511[@i_5527], @i_1385[@i_5527]) && ((@i_1385[@i_5527] = @i_1385) && (z_5511[@i_5527] = m9)) then
            yield
          orfind @i_5522 <= N3, @i_5523 <= N suchthat defined(z_5514[@i_5522, @i_5523], @i_184[@i_5523]) && ((@i_184[@i_5523] = @i_1385) && (z_5514[@i_5522, @i_5523] = m9)) then
            event partTC(hostY_53[@i_1385], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1419: symkeyseed;
              let SK_50: key = kgen(rSK_1419) in
              new tt_1420: timest;
              new r10_1421: symseed;
              let e10: maxmac = encsym(concat5(kgen(rSK_1419), tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
              new r11_1422: symseed;
              let z_5518: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1422) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, z_5518);
              out(c8[!_39], (hostY_53[@i_1385], e10, z_5518, acceptT(hostY_53[@i_1385], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1423: symkeyseed;
              let SK_50: key = kgen(rSK_1423) in
              new r10_1424: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
              new tt_1426: timest;
              new r11_1425: symseed;
              let z_5511: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1425) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, z_5511);
              out(c8[!_39], (hostY_53[@i_1385], z_1150, z_5511, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind @i_5521 <= N suchthat defined(z_5518[@i_5521], @i_1385[@i_5521]) && ((@i_1385[@i_5521] = @i_1385) && (z_5518[@i_5521] = m9)) then
            yield
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          find @i_3299 <= N suchthat defined(z_3163[@i_3299], @i_1384[@i_3299]) && ((@i_1384[@i_3299] = @i_1384) && (z_3163[@i_3299] = m9)) then
            yield
          orfind @i_3234 <= N3, @i_3235 <= N suchthat defined(z_3226[@i_3234, @i_3235], @i_183[@i_3235]) && ((@i_183[@i_3235] = @i_1384) && (z_3226[@i_3234, @i_3235] = m9)) then
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_50: key = kgen(rSK_1427) in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(kgen(rSK_1427), tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let z_3230: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1430) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, z_3230);
              out(c8[!_39], (hostY_53[@i_1384], e10, z_3230, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_50: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new r11_1433: symseed;
              let z_3163: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1433) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, z_3163);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, z_3163, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3233 <= N suchthat defined(z_3230[@i_3233], @i_1384[@i_3233]) && ((@i_1384[@i_3233] = @i_1384) && (z_3230[@i_3233] = m9)) then
            yield
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_50[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
      let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_50[@i_1153]) in
      new r16: symseed;
      let e16: maxmac = encsym(padts(tc'_45), SK_50[@i_1153], r16) in
      event partSC(hostY_47[@i_1153], m14, m15);
      event fullSC(hostY_47[@i_1153], m14, m15, e16);
      out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying SA rename SK_50 yields

Game 108 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKt: symkeyseed;
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2839[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1354[@i_184], z_921[@i_184], AK_2839[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_2843: symseed;
            new tc_2844: timest;
            let e5: maxmac = encsym(pad(C, tc_2844), kgen(s3_1354[@i_184]), r7_2843) in
            event partCT(hostT, TGT_58, e5);
            new n3_2845: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
            event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_2846: symseed;
            new tc'_2847: timest;
            let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2840[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1360[@i_184], z_921[@i_184], AK_2840[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_2999: timest;
            new r7_2998: symseed;
            let z_5514: maxmac = encsym2(Zpad, kgen2(s3_1360[@i_184]), r7_2998) in
            event partCT(hostT, TGT_58, z_5514);
            new n3_3000: nonce;
            out(c4[!_36, !_35], (TGT_58, z_5514, hostS, n3_3000));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_5534 <= N suchthat defined(SK_5976[@i_5534], hostW_46[@i_5534], n'[@i_5534], z_5511[@i_5534], @i_1385[@i_5534]) && ((@i_1385[@i_5534] = @i_184) && (z_5511[@i_5534] = m7)) then
              if (n3_3000 = n'[@i_5534]) then
              if (hostS = hostW_46[@i_5534]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5639: symseed;
              new tc'_5640: timest;
              let e12: maxmac = encsym(pad(C, tc'_5640), SK_5976[@i_5534], r2_5639) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5640)) = decsym(m13, SK_5976[@i_5534]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_5529 <= N3 suchthat defined(z_5514[@i_5529]) && (z_5514[@i_5529] = m7) then
              yield
            orfind @i_5528 <= N suchthat defined(SK_5975[@i_5528], hostW_46[@i_5528], n'[@i_5528], z_5518[@i_5528], @i_1385[@i_5528]) && ((@i_1385[@i_5528] = @i_184) && (z_5518[@i_5528] = m7)) then
              if (n3_3000 = n'[@i_5528]) then
              if (hostS = hostW_46[@i_5528]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5641: symseed;
              new tc'_5642: timest;
              let e12: maxmac = encsym(pad(C, tc'_5642), SK_5975[@i_5528], r2_5641) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5642)) = decsym(m13, SK_5975[@i_5528]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2841[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1366[@i_183], z_753[@i_183], AK_2841[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3003: symseed;
            new tc_3004: timest;
            let e5: maxmac = encsym(pad(C, tc_3004), kgen(s3_1366[@i_183]), r7_3003) in
            event partCT(hostT, TGT_58, e5);
            new n3_3005: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
            event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_3006: symseed;
            new tc'_3007: timest;
            let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2842[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1372[@i_183], z_753[@i_183], AK_2842[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3158: symseed;
            let z_3226: maxmac = encsym2(Zpad, kgen2(s3_1372[@i_183]), r7_3158) in
            event partCT(hostT, TGT_58, z_3226);
            new n3_3160: nonce;
            out(c4[!_36, !_35], (TGT_58, z_3226, hostS, n3_3160));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_4371 <= N suchthat defined(SK_5978[@i_4371], hostW_46[@i_4371], n'[@i_4371], z_3163[@i_4371], @i_1384[@i_4371]) && ((@i_1384[@i_4371] = @i_183) && (z_3163[@i_4371] = m7)) then
              if (n3_3160 = n'[@i_4371]) then
              if (hostS = hostW_46[@i_4371]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5481: symseed;
              new tc'_5480: timest;
              let e12: maxmac = encsym(pad(C, tc'_5480), SK_5978[@i_4371], r2_5481) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5480)) = decsym(m13, SK_5978[@i_4371]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_4306 <= N3 suchthat defined(z_3226[@i_4306]) && (z_3226[@i_4306] = m7) then
              yield
            orfind @i_4305 <= N suchthat defined(SK_5977[@i_4305], hostW_46[@i_4305], n'[@i_4305], z_3230[@i_4305], @i_1384[@i_4305]) && ((@i_1384[@i_4305] = @i_183) && (z_3230[@i_4305] = m7)) then
              if (n3_3160 = n'[@i_4305]) then
              if (hostS = hostW_46[@i_4305]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5483: symseed;
              new tc'_5482: timest;
              let e12: maxmac = encsym(pad(C, tc'_5482), SK_5977[@i_4305], r2_5483) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5482)) = decsym(m13, SK_5977[@i_4305]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = cst_key in
              new r4_1355: symseed;
              new tk_1356: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new s_1357: symkeyseed;
              new r5_1358: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = cst_key in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new s_1363: symkeyseed;
              new r5_1364: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = cst_key in
              new r4_1367: symseed;
              new tk_1368: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new s_1369: symkeyseed;
              new r5_1370: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new s_1375: symkeyseed;
              new r5_1376: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(s3_1360[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          find @i_5527 <= N suchthat defined(z_5511[@i_5527], @i_1385[@i_5527]) && ((@i_1385[@i_5527] = @i_1385) && (z_5511[@i_5527] = m9)) then
            yield
          orfind @i_5522 <= N3, @i_5523 <= N suchthat defined(z_5514[@i_5522, @i_5523], @i_184[@i_5523]) && ((@i_184[@i_5523] = @i_1385) && (z_5514[@i_5522, @i_5523] = m9)) then
            event partTC(hostY_53[@i_1385], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1419: symkeyseed;
              let SK_5975: key = kgen(rSK_1419) in
              new tt_1420: timest;
              new r10_1421: symseed;
              let e10: maxmac = encsym(concat5(kgen(rSK_1419), tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
              new r11_1422: symseed;
              let z_5518: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1422) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, z_5518);
              out(c8[!_39], (hostY_53[@i_1385], e10, z_5518, acceptT(hostY_53[@i_1385], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1423: symkeyseed;
              let SK_5976: key = kgen(rSK_1423) in
              new r10_1424: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
              new tt_1426: timest;
              new r11_1425: symseed;
              let z_5511: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1425) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, z_5511);
              out(c8[!_39], (hostY_53[@i_1385], z_1150, z_5511, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind @i_5521 <= N suchthat defined(z_5518[@i_5521], @i_1385[@i_5521]) && ((@i_1385[@i_5521] = @i_1385) && (z_5518[@i_5521] = m9)) then
            yield
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          find @i_3299 <= N suchthat defined(z_3163[@i_3299], @i_1384[@i_3299]) && ((@i_1384[@i_3299] = @i_1384) && (z_3163[@i_3299] = m9)) then
            yield
          orfind @i_3234 <= N3, @i_3235 <= N suchthat defined(z_3226[@i_3234, @i_3235], @i_183[@i_3235]) && ((@i_183[@i_3235] = @i_1384) && (z_3226[@i_3234, @i_3235] = m9)) then
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_5977: key = kgen(rSK_1427) in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(kgen(rSK_1427), tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let z_3230: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1430) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, z_3230);
              out(c8[!_39], (hostY_53[@i_1384], e10, z_3230, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_5978: key = kgen(rSK_1431) in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new r11_1433: symseed;
              let z_3163: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1433) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, z_3163);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, z_3163, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3233 <= N suchthat defined(z_3230[@i_3233], @i_1384[@i_3233]) && ((@i_1384[@i_3233] = @i_1384) && (z_3230[@i_3233] = m9)) then
            yield
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_5976[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
        let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_5976[@i_1153]) in
        new r16: symseed;
        let e16: maxmac = encsym(padts(tc'_45), SK_5976[@i_1153], r16) in
        event partSC(hostY_47[@i_1153], m14, m15);
        event fullSC(hostY_47[@i_1153], m14, m15, e16);
        out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
      orfind @i_1153 <= N suchthat defined(SK_5978[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
        let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_5978[@i_1153]) in
        new r16: symseed;
        let e16: maxmac = encsym(padts(tc'_45), SK_5978[@i_1153], r16) in
        event partSC(hostY_47[@i_1153], m14, m15);
        event fullSC(hostY_47[@i_1153], m14, m15, e16);
        out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying remove assignments of binder SK_5978 yields

Game 109 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKt: symkeyseed;
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2839[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1354[@i_184], z_921[@i_184], AK_2839[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_2843: symseed;
            new tc_2844: timest;
            let e5: maxmac = encsym(pad(C, tc_2844), kgen(s3_1354[@i_184]), r7_2843) in
            event partCT(hostT, TGT_58, e5);
            new n3_2845: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
            event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_2846: symseed;
            new tc'_2847: timest;
            let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2840[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1360[@i_184], z_921[@i_184], AK_2840[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_2999: timest;
            new r7_2998: symseed;
            let z_5514: maxmac = encsym2(Zpad, kgen2(s3_1360[@i_184]), r7_2998) in
            event partCT(hostT, TGT_58, z_5514);
            new n3_3000: nonce;
            out(c4[!_36, !_35], (TGT_58, z_5514, hostS, n3_3000));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_5534 <= N suchthat defined(SK_5976[@i_5534], hostW_46[@i_5534], n'[@i_5534], z_5511[@i_5534], @i_1385[@i_5534]) && ((@i_1385[@i_5534] = @i_184) && (z_5511[@i_5534] = m7)) then
              if (n3_3000 = n'[@i_5534]) then
              if (hostS = hostW_46[@i_5534]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5639: symseed;
              new tc'_5640: timest;
              let e12: maxmac = encsym(pad(C, tc'_5640), SK_5976[@i_5534], r2_5639) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5640)) = decsym(m13, SK_5976[@i_5534]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_5529 <= N3 suchthat defined(z_5514[@i_5529]) && (z_5514[@i_5529] = m7) then
              yield
            orfind @i_5528 <= N suchthat defined(SK_5975[@i_5528], hostW_46[@i_5528], n'[@i_5528], z_5518[@i_5528], @i_1385[@i_5528]) && ((@i_1385[@i_5528] = @i_184) && (z_5518[@i_5528] = m7)) then
              if (n3_3000 = n'[@i_5528]) then
              if (hostS = hostW_46[@i_5528]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5641: symseed;
              new tc'_5642: timest;
              let e12: maxmac = encsym(pad(C, tc'_5642), SK_5975[@i_5528], r2_5641) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5642)) = decsym(m13, SK_5975[@i_5528]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2841[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1366[@i_183], z_753[@i_183], AK_2841[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3003: symseed;
            new tc_3004: timest;
            let e5: maxmac = encsym(pad(C, tc_3004), kgen(s3_1366[@i_183]), r7_3003) in
            event partCT(hostT, TGT_58, e5);
            new n3_3005: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
            event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_3006: symseed;
            new tc'_3007: timest;
            let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2842[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1372[@i_183], z_753[@i_183], AK_2842[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3158: symseed;
            let z_3226: maxmac = encsym2(Zpad, kgen2(s3_1372[@i_183]), r7_3158) in
            event partCT(hostT, TGT_58, z_3226);
            new n3_3160: nonce;
            out(c4[!_36, !_35], (TGT_58, z_3226, hostS, n3_3160));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_4371 <= N suchthat defined(rSK_1431[@i_4371], SK_5978[@i_4371], hostW_46[@i_4371], n'[@i_4371], z_3163[@i_4371], @i_1384[@i_4371]) && ((@i_1384[@i_4371] = @i_183) && (z_3163[@i_4371] = m7)) then
              if (n3_3160 = n'[@i_4371]) then
              if (hostS = hostW_46[@i_4371]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5481: symseed;
              new tc'_5480: timest;
              let e12: maxmac = encsym(pad(C, tc'_5480), kgen(rSK_1431[@i_4371]), r2_5481) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5480)) = decsym(m13, kgen(rSK_1431[@i_4371])) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_4306 <= N3 suchthat defined(z_3226[@i_4306]) && (z_3226[@i_4306] = m7) then
              yield
            orfind @i_4305 <= N suchthat defined(SK_5977[@i_4305], hostW_46[@i_4305], n'[@i_4305], z_3230[@i_4305], @i_1384[@i_4305]) && ((@i_1384[@i_4305] = @i_183) && (z_3230[@i_4305] = m7)) then
              if (n3_3160 = n'[@i_4305]) then
              if (hostS = hostW_46[@i_4305]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5483: symseed;
              new tc'_5482: timest;
              let e12: maxmac = encsym(pad(C, tc'_5482), SK_5977[@i_4305], r2_5483) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5482)) = decsym(m13, SK_5977[@i_4305]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = cst_key in
              new r4_1355: symseed;
              new tk_1356: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new s_1357: symkeyseed;
              new r5_1358: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = cst_key in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new s_1363: symkeyseed;
              new r5_1364: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = cst_key in
              new r4_1367: symseed;
              new tk_1368: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new s_1369: symkeyseed;
              new r5_1370: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new s_1375: symkeyseed;
              new r5_1376: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(s3_1360[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          find @i_5527 <= N suchthat defined(z_5511[@i_5527], @i_1385[@i_5527]) && ((@i_1385[@i_5527] = @i_1385) && (z_5511[@i_5527] = m9)) then
            yield
          orfind @i_5522 <= N3, @i_5523 <= N suchthat defined(z_5514[@i_5522, @i_5523], @i_184[@i_5523]) && ((@i_184[@i_5523] = @i_1385) && (z_5514[@i_5522, @i_5523] = m9)) then
            event partTC(hostY_53[@i_1385], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1419: symkeyseed;
              let SK_5975: key = kgen(rSK_1419) in
              new tt_1420: timest;
              new r10_1421: symseed;
              let e10: maxmac = encsym(concat5(kgen(rSK_1419), tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
              new r11_1422: symseed;
              let z_5518: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1422) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, z_5518);
              out(c8[!_39], (hostY_53[@i_1385], e10, z_5518, acceptT(hostY_53[@i_1385], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1423: symkeyseed;
              let SK_5976: key = kgen(rSK_1423) in
              new r10_1424: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
              new tt_1426: timest;
              new r11_1425: symseed;
              let z_5511: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1425) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, z_5511);
              out(c8[!_39], (hostY_53[@i_1385], z_1150, z_5511, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind @i_5521 <= N suchthat defined(z_5518[@i_5521], @i_1385[@i_5521]) && ((@i_1385[@i_5521] = @i_1385) && (z_5518[@i_5521] = m9)) then
            yield
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          find @i_3299 <= N suchthat defined(z_3163[@i_3299], @i_1384[@i_3299]) && ((@i_1384[@i_3299] = @i_1384) && (z_3163[@i_3299] = m9)) then
            yield
          orfind @i_3234 <= N3, @i_3235 <= N suchthat defined(z_3226[@i_3234, @i_3235], @i_183[@i_3235]) && ((@i_183[@i_3235] = @i_1384) && (z_3226[@i_3234, @i_3235] = m9)) then
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_5977: key = kgen(rSK_1427) in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(kgen(rSK_1427), tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let z_3230: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1430) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, z_3230);
              out(c8[!_39], (hostY_53[@i_1384], e10, z_3230, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_5978: key = cst_key in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new r11_1433: symseed;
              let z_3163: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1433) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, z_3163);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, z_3163, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3233 <= N suchthat defined(z_3230[@i_3233], @i_1384[@i_3233]) && ((@i_1384[@i_3233] = @i_1384) && (z_3230[@i_3233] = m9)) then
            yield
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_5976[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
        let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_5976[@i_1153]) in
        new r16_5979: symseed;
        let e16: maxmac = encsym(padts(tc'_45), SK_5976[@i_1153], r16_5979) in
        event partSC(hostY_47[@i_1153], m14, m15);
        event fullSC(hostY_47[@i_1153], m14, m15, e16);
        out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
      orfind @i_1153 <= N suchthat defined(rSK_1431[@i_1153], SK_5978[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
        let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, kgen(rSK_1431[@i_1153])) in
        new r16_5980: symseed;
        let e16: maxmac = encsym(padts(tc'_45), kgen(rSK_1431[@i_1153]), r16_5980) in
        event partSC(hostY_47[@i_1153], m14, m15);
        event fullSC(hostY_47[@i_1153], m14, m15, e16);
        out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying remove assignments of binder SK_5977 yields

Game 110 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKt: symkeyseed;
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2839[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1354[@i_184], z_921[@i_184], AK_2839[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_2843: symseed;
            new tc_2844: timest;
            let e5: maxmac = encsym(pad(C, tc_2844), kgen(s3_1354[@i_184]), r7_2843) in
            event partCT(hostT, TGT_58, e5);
            new n3_2845: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
            event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_2846: symseed;
            new tc'_2847: timest;
            let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2840[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1360[@i_184], z_921[@i_184], AK_2840[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_2999: timest;
            new r7_2998: symseed;
            let z_5514: maxmac = encsym2(Zpad, kgen2(s3_1360[@i_184]), r7_2998) in
            event partCT(hostT, TGT_58, z_5514);
            new n3_3000: nonce;
            out(c4[!_36, !_35], (TGT_58, z_5514, hostS, n3_3000));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_5534 <= N suchthat defined(SK_5976[@i_5534], hostW_46[@i_5534], n'[@i_5534], z_5511[@i_5534], @i_1385[@i_5534]) && ((@i_1385[@i_5534] = @i_184) && (z_5511[@i_5534] = m7)) then
              if (n3_3000 = n'[@i_5534]) then
              if (hostS = hostW_46[@i_5534]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5639: symseed;
              new tc'_5640: timest;
              let e12: maxmac = encsym(pad(C, tc'_5640), SK_5976[@i_5534], r2_5639) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5640)) = decsym(m13, SK_5976[@i_5534]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_5529 <= N3 suchthat defined(z_5514[@i_5529]) && (z_5514[@i_5529] = m7) then
              yield
            orfind @i_5528 <= N suchthat defined(SK_5975[@i_5528], hostW_46[@i_5528], n'[@i_5528], z_5518[@i_5528], @i_1385[@i_5528]) && ((@i_1385[@i_5528] = @i_184) && (z_5518[@i_5528] = m7)) then
              if (n3_3000 = n'[@i_5528]) then
              if (hostS = hostW_46[@i_5528]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5641: symseed;
              new tc'_5642: timest;
              let e12: maxmac = encsym(pad(C, tc'_5642), SK_5975[@i_5528], r2_5641) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5642)) = decsym(m13, SK_5975[@i_5528]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2841[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1366[@i_183], z_753[@i_183], AK_2841[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3003: symseed;
            new tc_3004: timest;
            let e5: maxmac = encsym(pad(C, tc_3004), kgen(s3_1366[@i_183]), r7_3003) in
            event partCT(hostT, TGT_58, e5);
            new n3_3005: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
            event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_3006: symseed;
            new tc'_3007: timest;
            let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2842[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1372[@i_183], z_753[@i_183], AK_2842[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3158: symseed;
            let z_3226: maxmac = encsym2(Zpad, kgen2(s3_1372[@i_183]), r7_3158) in
            event partCT(hostT, TGT_58, z_3226);
            new n3_3160: nonce;
            out(c4[!_36, !_35], (TGT_58, z_3226, hostS, n3_3160));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_4371 <= N suchthat defined(rSK_1431[@i_4371], SK_5978[@i_4371], hostW_46[@i_4371], n'[@i_4371], z_3163[@i_4371], @i_1384[@i_4371]) && ((@i_1384[@i_4371] = @i_183) && (z_3163[@i_4371] = m7)) then
              if (n3_3160 = n'[@i_4371]) then
              if (hostS = hostW_46[@i_4371]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5481: symseed;
              new tc'_5480: timest;
              let e12: maxmac = encsym(pad(C, tc'_5480), kgen(rSK_1431[@i_4371]), r2_5481) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5480)) = decsym(m13, kgen(rSK_1431[@i_4371])) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_4306 <= N3 suchthat defined(z_3226[@i_4306]) && (z_3226[@i_4306] = m7) then
              yield
            orfind @i_4305 <= N suchthat defined(rSK_1427[@i_4305], SK_5977[@i_4305], hostW_46[@i_4305], n'[@i_4305], z_3230[@i_4305], @i_1384[@i_4305]) && ((@i_1384[@i_4305] = @i_183) && (z_3230[@i_4305] = m7)) then
              if (n3_3160 = n'[@i_4305]) then
              if (hostS = hostW_46[@i_4305]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5483: symseed;
              new tc'_5482: timest;
              let e12: maxmac = encsym(pad(C, tc'_5482), kgen(rSK_1427[@i_4305]), r2_5483) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5482)) = decsym(m13, kgen(rSK_1427[@i_4305])) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = cst_key in
              new r4_1355: symseed;
              new tk_1356: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new s_1357: symkeyseed;
              new r5_1358: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = cst_key in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new s_1363: symkeyseed;
              new r5_1364: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = cst_key in
              new r4_1367: symseed;
              new tk_1368: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new s_1369: symkeyseed;
              new r5_1370: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new s_1375: symkeyseed;
              new r5_1376: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(s3_1360[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          find @i_5527 <= N suchthat defined(z_5511[@i_5527], @i_1385[@i_5527]) && ((@i_1385[@i_5527] = @i_1385) && (z_5511[@i_5527] = m9)) then
            yield
          orfind @i_5522 <= N3, @i_5523 <= N suchthat defined(z_5514[@i_5522, @i_5523], @i_184[@i_5523]) && ((@i_184[@i_5523] = @i_1385) && (z_5514[@i_5522, @i_5523] = m9)) then
            event partTC(hostY_53[@i_1385], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1419: symkeyseed;
              let SK_5975: key = kgen(rSK_1419) in
              new tt_1420: timest;
              new r10_1421: symseed;
              let e10: maxmac = encsym(concat5(kgen(rSK_1419), tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
              new r11_1422: symseed;
              let z_5518: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1422) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, z_5518);
              out(c8[!_39], (hostY_53[@i_1385], e10, z_5518, acceptT(hostY_53[@i_1385], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1423: symkeyseed;
              let SK_5976: key = kgen(rSK_1423) in
              new r10_1424: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
              new tt_1426: timest;
              new r11_1425: symseed;
              let z_5511: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1425) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, z_5511);
              out(c8[!_39], (hostY_53[@i_1385], z_1150, z_5511, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind @i_5521 <= N suchthat defined(z_5518[@i_5521], @i_1385[@i_5521]) && ((@i_1385[@i_5521] = @i_1385) && (z_5518[@i_5521] = m9)) then
            yield
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          find @i_3299 <= N suchthat defined(z_3163[@i_3299], @i_1384[@i_3299]) && ((@i_1384[@i_3299] = @i_1384) && (z_3163[@i_3299] = m9)) then
            yield
          orfind @i_3234 <= N3, @i_3235 <= N suchthat defined(z_3226[@i_3234, @i_3235], @i_183[@i_3235]) && ((@i_183[@i_3235] = @i_1384) && (z_3226[@i_3234, @i_3235] = m9)) then
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_5977: key = cst_key in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(kgen(rSK_1427), tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let z_3230: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1430) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, z_3230);
              out(c8[!_39], (hostY_53[@i_1384], e10, z_3230, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_5978: key = cst_key in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new r11_1433: symseed;
              let z_3163: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1433) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, z_3163);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, z_3163, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3233 <= N suchthat defined(z_3230[@i_3233], @i_1384[@i_3233]) && ((@i_1384[@i_3233] = @i_1384) && (z_3230[@i_3233] = m9)) then
            yield
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(SK_5976[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
        let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, SK_5976[@i_1153]) in
        new r16_5979: symseed;
        let e16: maxmac = encsym(padts(tc'_45), SK_5976[@i_1153], r16_5979) in
        event partSC(hostY_47[@i_1153], m14, m15);
        event fullSC(hostY_47[@i_1153], m14, m15, e16);
        out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
      orfind @i_1153 <= N suchthat defined(rSK_1431[@i_1153], SK_5978[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
        let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, kgen(rSK_1431[@i_1153])) in
        new r16_5980: symseed;
        let e16: maxmac = encsym(padts(tc'_45), kgen(rSK_1431[@i_1153]), r16_5980) in
        event partSC(hostY_47[@i_1153], m14, m15);
        event fullSC(hostY_47[@i_1153], m14, m15, e16);
        out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying remove assignments of binder SK_5976 yields

Game 111 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKt: symkeyseed;
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2839[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1354[@i_184], z_921[@i_184], AK_2839[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_2843: symseed;
            new tc_2844: timest;
            let e5: maxmac = encsym(pad(C, tc_2844), kgen(s3_1354[@i_184]), r7_2843) in
            event partCT(hostT, TGT_58, e5);
            new n3_2845: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
            event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_2846: symseed;
            new tc'_2847: timest;
            let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2840[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1360[@i_184], z_921[@i_184], AK_2840[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_2999: timest;
            new r7_2998: symseed;
            let z_5514: maxmac = encsym2(Zpad, kgen2(s3_1360[@i_184]), r7_2998) in
            event partCT(hostT, TGT_58, z_5514);
            new n3_3000: nonce;
            out(c4[!_36, !_35], (TGT_58, z_5514, hostS, n3_3000));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_5534 <= N suchthat defined(rSK_1423[@i_5534], SK_5976[@i_5534], hostW_46[@i_5534], n'[@i_5534], z_5511[@i_5534], @i_1385[@i_5534]) && ((@i_1385[@i_5534] = @i_184) && (z_5511[@i_5534] = m7)) then
              if (n3_3000 = n'[@i_5534]) then
              if (hostS = hostW_46[@i_5534]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5639: symseed;
              new tc'_5640: timest;
              let e12: maxmac = encsym(pad(C, tc'_5640), kgen(rSK_1423[@i_5534]), r2_5639) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5640)) = decsym(m13, kgen(rSK_1423[@i_5534])) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_5529 <= N3 suchthat defined(z_5514[@i_5529]) && (z_5514[@i_5529] = m7) then
              yield
            orfind @i_5528 <= N suchthat defined(SK_5975[@i_5528], hostW_46[@i_5528], n'[@i_5528], z_5518[@i_5528], @i_1385[@i_5528]) && ((@i_1385[@i_5528] = @i_184) && (z_5518[@i_5528] = m7)) then
              if (n3_3000 = n'[@i_5528]) then
              if (hostS = hostW_46[@i_5528]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5641: symseed;
              new tc'_5642: timest;
              let e12: maxmac = encsym(pad(C, tc'_5642), SK_5975[@i_5528], r2_5641) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5642)) = decsym(m13, SK_5975[@i_5528]) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2841[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1366[@i_183], z_753[@i_183], AK_2841[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3003: symseed;
            new tc_3004: timest;
            let e5: maxmac = encsym(pad(C, tc_3004), kgen(s3_1366[@i_183]), r7_3003) in
            event partCT(hostT, TGT_58, e5);
            new n3_3005: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
            event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_3006: symseed;
            new tc'_3007: timest;
            let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2842[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1372[@i_183], z_753[@i_183], AK_2842[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3158: symseed;
            let z_3226: maxmac = encsym2(Zpad, kgen2(s3_1372[@i_183]), r7_3158) in
            event partCT(hostT, TGT_58, z_3226);
            new n3_3160: nonce;
            out(c4[!_36, !_35], (TGT_58, z_3226, hostS, n3_3160));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_4371 <= N suchthat defined(rSK_1431[@i_4371], SK_5978[@i_4371], hostW_46[@i_4371], n'[@i_4371], z_3163[@i_4371], @i_1384[@i_4371]) && ((@i_1384[@i_4371] = @i_183) && (z_3163[@i_4371] = m7)) then
              if (n3_3160 = n'[@i_4371]) then
              if (hostS = hostW_46[@i_4371]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5481: symseed;
              new tc'_5480: timest;
              let e12: maxmac = encsym(pad(C, tc'_5480), kgen(rSK_1431[@i_4371]), r2_5481) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5480)) = decsym(m13, kgen(rSK_1431[@i_4371])) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_4306 <= N3 suchthat defined(z_3226[@i_4306]) && (z_3226[@i_4306] = m7) then
              yield
            orfind @i_4305 <= N suchthat defined(rSK_1427[@i_4305], SK_5977[@i_4305], hostW_46[@i_4305], n'[@i_4305], z_3230[@i_4305], @i_1384[@i_4305]) && ((@i_1384[@i_4305] = @i_183) && (z_3230[@i_4305] = m7)) then
              if (n3_3160 = n'[@i_4305]) then
              if (hostS = hostW_46[@i_4305]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5483: symseed;
              new tc'_5482: timest;
              let e12: maxmac = encsym(pad(C, tc'_5482), kgen(rSK_1427[@i_4305]), r2_5483) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5482)) = decsym(m13, kgen(rSK_1427[@i_4305])) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = cst_key in
              new r4_1355: symseed;
              new tk_1356: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new s_1357: symkeyseed;
              new r5_1358: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = cst_key in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new s_1363: symkeyseed;
              new r5_1364: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = cst_key in
              new r4_1367: symseed;
              new tk_1368: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new s_1369: symkeyseed;
              new r5_1370: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new s_1375: symkeyseed;
              new r5_1376: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(s3_1360[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          find @i_5527 <= N suchthat defined(z_5511[@i_5527], @i_1385[@i_5527]) && ((@i_1385[@i_5527] = @i_1385) && (z_5511[@i_5527] = m9)) then
            yield
          orfind @i_5522 <= N3, @i_5523 <= N suchthat defined(z_5514[@i_5522, @i_5523], @i_184[@i_5523]) && ((@i_184[@i_5523] = @i_1385) && (z_5514[@i_5522, @i_5523] = m9)) then
            event partTC(hostY_53[@i_1385], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1419: symkeyseed;
              let SK_5975: key = kgen(rSK_1419) in
              new tt_1420: timest;
              new r10_1421: symseed;
              let e10: maxmac = encsym(concat5(kgen(rSK_1419), tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
              new r11_1422: symseed;
              let z_5518: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1422) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, z_5518);
              out(c8[!_39], (hostY_53[@i_1385], e10, z_5518, acceptT(hostY_53[@i_1385], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1423: symkeyseed;
              let SK_5976: key = cst_key in
              new r10_1424: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
              new tt_1426: timest;
              new r11_1425: symseed;
              let z_5511: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1425) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, z_5511);
              out(c8[!_39], (hostY_53[@i_1385], z_1150, z_5511, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind @i_5521 <= N suchthat defined(z_5518[@i_5521], @i_1385[@i_5521]) && ((@i_1385[@i_5521] = @i_1385) && (z_5518[@i_5521] = m9)) then
            yield
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          find @i_3299 <= N suchthat defined(z_3163[@i_3299], @i_1384[@i_3299]) && ((@i_1384[@i_3299] = @i_1384) && (z_3163[@i_3299] = m9)) then
            yield
          orfind @i_3234 <= N3, @i_3235 <= N suchthat defined(z_3226[@i_3234, @i_3235], @i_183[@i_3235]) && ((@i_183[@i_3235] = @i_1384) && (z_3226[@i_3234, @i_3235] = m9)) then
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_5977: key = cst_key in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(kgen(rSK_1427), tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let z_3230: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1430) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, z_3230);
              out(c8[!_39], (hostY_53[@i_1384], e10, z_3230, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_5978: key = cst_key in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new r11_1433: symseed;
              let z_3163: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1433) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, z_3163);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, z_3163, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3233 <= N suchthat defined(z_3230[@i_3233], @i_1384[@i_3233]) && ((@i_1384[@i_3233] = @i_1384) && (z_3230[@i_3233] = m9)) then
            yield
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(rSK_1423[@i_1153], SK_5976[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
        let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, kgen(rSK_1423[@i_1153])) in
        new r16_5979: symseed;
        let e16: maxmac = encsym(padts(tc'_45), kgen(rSK_1423[@i_1153]), r16_5979) in
        event partSC(hostY_47[@i_1153], m14, m15);
        event fullSC(hostY_47[@i_1153], m14, m15, e16);
        out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
      orfind @i_1153 <= N suchthat defined(rSK_1431[@i_1153], SK_5978[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
        let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, kgen(rSK_1431[@i_1153])) in
        new r16_5980: symseed;
        let e16: maxmac = encsym(padts(tc'_45), kgen(rSK_1431[@i_1153]), r16_5980) in
        event partSC(hostY_47[@i_1153], m14, m15);
        event fullSC(hostY_47[@i_1153], m14, m15, e16);
        out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying remove assignments of binder SK_5975 yields

Game 112 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKt: symkeyseed;
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2839[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1354[@i_184], z_921[@i_184], AK_2839[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_2843: symseed;
            new tc_2844: timest;
            let e5: maxmac = encsym(pad(C, tc_2844), kgen(s3_1354[@i_184]), r7_2843) in
            event partCT(hostT, TGT_58, e5);
            new n3_2845: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
            event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_2846: symseed;
            new tc'_2847: timest;
            let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2840[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1360[@i_184], z_921[@i_184], AK_2840[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_2999: timest;
            new r7_2998: symseed;
            let z_5514: maxmac = encsym2(Zpad, kgen2(s3_1360[@i_184]), r7_2998) in
            event partCT(hostT, TGT_58, z_5514);
            new n3_3000: nonce;
            out(c4[!_36, !_35], (TGT_58, z_5514, hostS, n3_3000));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_5534 <= N suchthat defined(rSK_1423[@i_5534], SK_5976[@i_5534], hostW_46[@i_5534], n'[@i_5534], z_5511[@i_5534], @i_1385[@i_5534]) && ((@i_1385[@i_5534] = @i_184) && (z_5511[@i_5534] = m7)) then
              if (n3_3000 = n'[@i_5534]) then
              if (hostS = hostW_46[@i_5534]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5639: symseed;
              new tc'_5640: timest;
              let e12: maxmac = encsym(pad(C, tc'_5640), kgen(rSK_1423[@i_5534]), r2_5639) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5640)) = decsym(m13, kgen(rSK_1423[@i_5534])) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_5529 <= N3 suchthat defined(z_5514[@i_5529]) && (z_5514[@i_5529] = m7) then
              yield
            orfind @i_5528 <= N suchthat defined(rSK_1419[@i_5528], SK_5975[@i_5528], hostW_46[@i_5528], n'[@i_5528], z_5518[@i_5528], @i_1385[@i_5528]) && ((@i_1385[@i_5528] = @i_184) && (z_5518[@i_5528] = m7)) then
              if (n3_3000 = n'[@i_5528]) then
              if (hostS = hostW_46[@i_5528]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5641: symseed;
              new tc'_5642: timest;
              let e12: maxmac = encsym(pad(C, tc'_5642), kgen(rSK_1419[@i_5528]), r2_5641) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5642)) = decsym(m13, kgen(rSK_1419[@i_5528])) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2841[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1366[@i_183], z_753[@i_183], AK_2841[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3003: symseed;
            new tc_3004: timest;
            let e5: maxmac = encsym(pad(C, tc_3004), kgen(s3_1366[@i_183]), r7_3003) in
            event partCT(hostT, TGT_58, e5);
            new n3_3005: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
            event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_3006: symseed;
            new tc'_3007: timest;
            let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2842[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1372[@i_183], z_753[@i_183], AK_2842[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3158: symseed;
            let z_3226: maxmac = encsym2(Zpad, kgen2(s3_1372[@i_183]), r7_3158) in
            event partCT(hostT, TGT_58, z_3226);
            new n3_3160: nonce;
            out(c4[!_36, !_35], (TGT_58, z_3226, hostS, n3_3160));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_4371 <= N suchthat defined(rSK_1431[@i_4371], SK_5978[@i_4371], hostW_46[@i_4371], n'[@i_4371], z_3163[@i_4371], @i_1384[@i_4371]) && ((@i_1384[@i_4371] = @i_183) && (z_3163[@i_4371] = m7)) then
              if (n3_3160 = n'[@i_4371]) then
              if (hostS = hostW_46[@i_4371]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5481: symseed;
              new tc'_5480: timest;
              let e12: maxmac = encsym(pad(C, tc'_5480), kgen(rSK_1431[@i_4371]), r2_5481) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5480)) = decsym(m13, kgen(rSK_1431[@i_4371])) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_4306 <= N3 suchthat defined(z_3226[@i_4306]) && (z_3226[@i_4306] = m7) then
              yield
            orfind @i_4305 <= N suchthat defined(rSK_1427[@i_4305], SK_5977[@i_4305], hostW_46[@i_4305], n'[@i_4305], z_3230[@i_4305], @i_1384[@i_4305]) && ((@i_1384[@i_4305] = @i_183) && (z_3230[@i_4305] = m7)) then
              if (n3_3160 = n'[@i_4305]) then
              if (hostS = hostW_46[@i_4305]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5483: symseed;
              new tc'_5482: timest;
              let e12: maxmac = encsym(pad(C, tc'_5482), kgen(rSK_1427[@i_4305]), r2_5483) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5482)) = decsym(m13, kgen(rSK_1427[@i_4305])) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = cst_key in
              new r4_1355: symseed;
              new tk_1356: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new s_1357: symkeyseed;
              new r5_1358: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = cst_key in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new s_1363: symkeyseed;
              new r5_1364: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = cst_key in
              new r4_1367: symseed;
              new tk_1368: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new s_1369: symkeyseed;
              new r5_1370: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new s_1375: symkeyseed;
              new r5_1376: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(s3_1360[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          find @i_5527 <= N suchthat defined(z_5511[@i_5527], @i_1385[@i_5527]) && ((@i_1385[@i_5527] = @i_1385) && (z_5511[@i_5527] = m9)) then
            yield
          orfind @i_5522 <= N3, @i_5523 <= N suchthat defined(z_5514[@i_5522, @i_5523], @i_184[@i_5523]) && ((@i_184[@i_5523] = @i_1385) && (z_5514[@i_5522, @i_5523] = m9)) then
            event partTC(hostY_53[@i_1385], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1419: symkeyseed;
              let SK_5975: key = cst_key in
              new tt_1420: timest;
              new r10_1421: symseed;
              let e10: maxmac = encsym(concat5(kgen(rSK_1419), tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
              new r11_1422: symseed;
              let z_5518: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1422) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, z_5518);
              out(c8[!_39], (hostY_53[@i_1385], e10, z_5518, acceptT(hostY_53[@i_1385], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1423: symkeyseed;
              let SK_5976: key = cst_key in
              new r10_1424: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
              new tt_1426: timest;
              new r11_1425: symseed;
              let z_5511: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1425) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, z_5511);
              out(c8[!_39], (hostY_53[@i_1385], z_1150, z_5511, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind @i_5521 <= N suchthat defined(z_5518[@i_5521], @i_1385[@i_5521]) && ((@i_1385[@i_5521] = @i_1385) && (z_5518[@i_5521] = m9)) then
            yield
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          find @i_3299 <= N suchthat defined(z_3163[@i_3299], @i_1384[@i_3299]) && ((@i_1384[@i_3299] = @i_1384) && (z_3163[@i_3299] = m9)) then
            yield
          orfind @i_3234 <= N3, @i_3235 <= N suchthat defined(z_3226[@i_3234, @i_3235], @i_183[@i_3235]) && ((@i_183[@i_3235] = @i_1384) && (z_3226[@i_3234, @i_3235] = m9)) then
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_5977: key = cst_key in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(kgen(rSK_1427), tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let z_3230: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1430) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, z_3230);
              out(c8[!_39], (hostY_53[@i_1384], e10, z_3230, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_5978: key = cst_key in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new r11_1433: symseed;
              let z_3163: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1433) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, z_3163);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, z_3163, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3233 <= N suchthat defined(z_3230[@i_3233], @i_1384[@i_3233]) && ((@i_1384[@i_3233] = @i_1384) && (z_3230[@i_3233] = m9)) then
            yield
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(rSK_1423[@i_1153], SK_5976[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
        let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, kgen(rSK_1423[@i_1153])) in
        new r16_5979: symseed;
        let e16: maxmac = encsym(padts(tc'_45), kgen(rSK_1423[@i_1153]), r16_5979) in
        event partSC(hostY_47[@i_1153], m14, m15);
        event fullSC(hostY_47[@i_1153], m14, m15, e16);
        out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
      orfind @i_1153 <= N suchthat defined(rSK_1431[@i_1153], SK_5978[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
        let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, kgen(rSK_1431[@i_1153])) in
        new r16_5980: symseed;
        let e16: maxmac = encsym(padts(tc'_45), kgen(rSK_1431[@i_1153]), r16_5980) in
        event partSC(hostY_47[@i_1153], m14, m15);
        event fullSC(hostY_47[@i_1153], m14, m15, e16);
        out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
with rSK_1431 [Difference of probability N * Pencctxt(time + time(context for game 112), N + N4 * N3 * N, N + N4 * N3 * N)] yields

Game 113 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKt: symkeyseed;
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2839[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1354[@i_184], z_921[@i_184], AK_2839[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_2843: symseed;
            new tc_2844: timest;
            let e5: maxmac = encsym(pad(C, tc_2844), kgen(s3_1354[@i_184]), r7_2843) in
            event partCT(hostT, TGT_58, e5);
            new n3_2845: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
            event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_2846: symseed;
            new tc'_2847: timest;
            let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2840[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1360[@i_184], z_921[@i_184], AK_2840[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_2999: timest;
            new r7_2998: symseed;
            let z_5514: maxmac = encsym2(Zpad, kgen2(s3_1360[@i_184]), r7_2998) in
            event partCT(hostT, TGT_58, z_5514);
            new n3_3000: nonce;
            out(c4[!_36, !_35], (TGT_58, z_5514, hostS, n3_3000));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_5534 <= N suchthat defined(rSK_1423[@i_5534], SK_5976[@i_5534], hostW_46[@i_5534], n'[@i_5534], z_5511[@i_5534], @i_1385[@i_5534]) && ((@i_1385[@i_5534] = @i_184) && (z_5511[@i_5534] = m7)) then
              if (n3_3000 = n'[@i_5534]) then
              if (hostS = hostW_46[@i_5534]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5639: symseed;
              new tc'_5640: timest;
              let e12: maxmac = encsym(pad(C, tc'_5640), kgen(rSK_1423[@i_5534]), r2_5639) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5640)) = decsym(m13, kgen(rSK_1423[@i_5534])) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_5529 <= N3 suchthat defined(z_5514[@i_5529]) && (z_5514[@i_5529] = m7) then
              yield
            orfind @i_5528 <= N suchthat defined(rSK_1419[@i_5528], SK_5975[@i_5528], hostW_46[@i_5528], n'[@i_5528], z_5518[@i_5528], @i_1385[@i_5528]) && ((@i_1385[@i_5528] = @i_184) && (z_5518[@i_5528] = m7)) then
              if (n3_3000 = n'[@i_5528]) then
              if (hostS = hostW_46[@i_5528]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5641: symseed;
              new tc'_5642: timest;
              let e12: maxmac = encsym(pad(C, tc'_5642), kgen(rSK_1419[@i_5528]), r2_5641) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5642)) = decsym(m13, kgen(rSK_1419[@i_5528])) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2841[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1366[@i_183], z_753[@i_183], AK_2841[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3003: symseed;
            new tc_3004: timest;
            let e5: maxmac = encsym(pad(C, tc_3004), kgen(s3_1366[@i_183]), r7_3003) in
            event partCT(hostT, TGT_58, e5);
            new n3_3005: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
            event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_3006: symseed;
            new tc'_3007: timest;
            let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2842[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1372[@i_183], z_753[@i_183], AK_2842[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3158: symseed;
            let z_3226: maxmac = encsym2(Zpad, kgen2(s3_1372[@i_183]), r7_3158) in
            event partCT(hostT, TGT_58, z_3226);
            new n3_3160: nonce;
            out(c4[!_36, !_35], (TGT_58, z_3226, hostS, n3_3160));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_4371 <= N suchthat defined(rSK_1431[@i_4371], SK_5978[@i_4371], hostW_46[@i_4371], n'[@i_4371], z_3163[@i_4371], @i_1384[@i_4371]) && ((@i_1384[@i_4371] = @i_183) && (z_3163[@i_4371] = m7)) then
              if (n3_3160 = n'[@i_4371]) then
              if (hostS = hostW_46[@i_4371]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5481: symseed;
              new tc'_5480: timest;
              let x_5985: maxenc = pad(C, tc'_5480) in
              let z_5984: maxmac = encsym(x_5985, kgen2(rSK_1431[@i_4371]), r2_5481) in
              let e12: maxmac = z_5984 in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              find @i_6004 <= N suchthat defined(x_5982[@i_6004], r16_5980[@i_6004], z_5981[@i_6004]) && ((@i_1153[@i_6004] = @i_4371) && (z_5981[@i_6004] = m13)) then
                let injbot2(padts(=tc'_5480)) = injbot2(x_5982[@i_6004]) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_5997 <= N4, @i_5998 <= N3, @i_5999 <= N suchthat defined(x_5985[@i_5997, @i_5998, @i_5999], r2_5481[@i_5997, @i_5998, @i_5999], z_5984[@i_5997, @i_5998, @i_5999]) && ((@i_4371[@i_5998, @i_5999] = @i_4371) && (z_5984[@i_5997, @i_5998, @i_5999] = m13)) then
                let injbot2(padts(=tc'_5480)) = injbot2(x_5985[@i_5997, @i_5998, @i_5999]) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              else
                let injbot2(padts(=tc'_5480)) = bottom in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_4306 <= N3 suchthat defined(z_3226[@i_4306]) && (z_3226[@i_4306] = m7) then
              yield
            orfind @i_4305 <= N suchthat defined(rSK_1427[@i_4305], SK_5977[@i_4305], hostW_46[@i_4305], n'[@i_4305], z_3230[@i_4305], @i_1384[@i_4305]) && ((@i_1384[@i_4305] = @i_183) && (z_3230[@i_4305] = m7)) then
              if (n3_3160 = n'[@i_4305]) then
              if (hostS = hostW_46[@i_4305]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5483: symseed;
              new tc'_5482: timest;
              let e12: maxmac = encsym(pad(C, tc'_5482), kgen(rSK_1427[@i_4305]), r2_5483) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5482)) = decsym(m13, kgen(rSK_1427[@i_4305])) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = cst_key in
              new r4_1355: symseed;
              new tk_1356: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new s_1357: symkeyseed;
              new r5_1358: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = cst_key in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new s_1363: symkeyseed;
              new r5_1364: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = cst_key in
              new r4_1367: symseed;
              new tk_1368: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new s_1369: symkeyseed;
              new r5_1370: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new s_1375: symkeyseed;
              new r5_1376: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(s3_1360[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          find @i_5527 <= N suchthat defined(z_5511[@i_5527], @i_1385[@i_5527]) && ((@i_1385[@i_5527] = @i_1385) && (z_5511[@i_5527] = m9)) then
            yield
          orfind @i_5522 <= N3, @i_5523 <= N suchthat defined(z_5514[@i_5522, @i_5523], @i_184[@i_5523]) && ((@i_184[@i_5523] = @i_1385) && (z_5514[@i_5522, @i_5523] = m9)) then
            event partTC(hostY_53[@i_1385], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1419: symkeyseed;
              let SK_5975: key = cst_key in
              new tt_1420: timest;
              new r10_1421: symseed;
              let e10: maxmac = encsym(concat5(kgen(rSK_1419), tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
              new r11_1422: symseed;
              let z_5518: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1422) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, z_5518);
              out(c8[!_39], (hostY_53[@i_1385], e10, z_5518, acceptT(hostY_53[@i_1385], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1423: symkeyseed;
              let SK_5976: key = cst_key in
              new r10_1424: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
              new tt_1426: timest;
              new r11_1425: symseed;
              let z_5511: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1425) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, z_5511);
              out(c8[!_39], (hostY_53[@i_1385], z_1150, z_5511, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind @i_5521 <= N suchthat defined(z_5518[@i_5521], @i_1385[@i_5521]) && ((@i_1385[@i_5521] = @i_1385) && (z_5518[@i_5521] = m9)) then
            yield
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          find @i_3299 <= N suchthat defined(z_3163[@i_3299], @i_1384[@i_3299]) && ((@i_1384[@i_3299] = @i_1384) && (z_3163[@i_3299] = m9)) then
            yield
          orfind @i_3234 <= N3, @i_3235 <= N suchthat defined(z_3226[@i_3234, @i_3235], @i_183[@i_3235]) && ((@i_183[@i_3235] = @i_1384) && (z_3226[@i_3234, @i_3235] = m9)) then
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_5977: key = cst_key in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(kgen(rSK_1427), tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let z_3230: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1430) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, z_3230);
              out(c8[!_39], (hostY_53[@i_1384], e10, z_3230, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_5978: key = cst_key in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new r11_1433: symseed;
              let z_3163: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1433) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, z_3163);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, z_3163, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3233 <= N suchthat defined(z_3230[@i_3233], @i_1384[@i_3233]) && ((@i_1384[@i_3233] = @i_1384) && (z_3230[@i_3233] = m9)) then
            yield
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(rSK_1423[@i_1153], SK_5976[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
        let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, kgen(rSK_1423[@i_1153])) in
        new r16_5979: symseed;
        let e16: maxmac = encsym(padts(tc'_45), kgen(rSK_1423[@i_1153]), r16_5979) in
        event partSC(hostY_47[@i_1153], m14, m15);
        event fullSC(hostY_47[@i_1153], m14, m15, e16);
        out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
      orfind @i_1153 <= N suchthat defined(rSK_1431[@i_1153], SK_5978[@i_1153], hostY_47[@i_1153], z_1150[@i_1153]) && (z_1150[@i_1153] = m14) then
        find @i_5996 <= N suchthat defined(x_5982[@i_5996], r16_5980[@i_5996], z_5981[@i_5996]) && ((@i_1153[@i_5996] = @i_1153) && (z_5981[@i_5996] = m15)) then
          let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = injbot2(x_5982[@i_5996]) in
          new r16_5980: symseed;
          let x_5982: maxenc = padts(tc'_45) in
          let z_5981: maxmac = encsym(x_5982, kgen2(rSK_1431[@i_1153]), r16_5980) in
          let e16: maxmac = z_5981 in
          event partSC(hostY_47[@i_1153], m14, m15);
          event fullSC(hostY_47[@i_1153], m14, m15, e16);
          out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
        orfind @i_5989 <= N4, @i_5990 <= N3, @i_5991 <= N suchthat defined(x_5985[@i_5989, @i_5990, @i_5991], r2_5481[@i_5989, @i_5990, @i_5991], z_5984[@i_5989, @i_5990, @i_5991]) && ((@i_4371[@i_5990, @i_5991] = @i_1153) && (z_5984[@i_5989, @i_5990, @i_5991] = m15)) then
          let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = injbot2(x_5985[@i_5989, @i_5990, @i_5991]) in
          new r16_5980: symseed;
          let x_5982: maxenc = padts(tc'_45) in
          let z_5981: maxmac = encsym(x_5982, kgen2(rSK_1431[@i_1153]), r16_5980) in
          let e16: maxmac = z_5981 in
          event partSC(hostY_47[@i_1153], m14, m15);
          event fullSC(hostY_47[@i_1153], m14, m15, e16);
          out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
        else
          let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = bottom in
          new r16_5980: symseed;
          let x_5982: maxenc = padts(tc'_45) in
          let z_5981: maxmac = encsym(x_5982, kgen2(rSK_1431[@i_1153]), r16_5980) in
          let e16: maxmac = z_5981 in
          event partSC(hostY_47[@i_1153], m14, m15);
          event fullSC(hostY_47[@i_1153], m14, m15, e16);
          out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying simplify [Difference of probability 0.5 * N3 * N * N3 * N / |nonce|] yields

Game 114 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKt: symkeyseed;
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2839[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1354[@i_184], z_921[@i_184], AK_2839[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_2843: symseed;
            new tc_2844: timest;
            let e5: maxmac = encsym(pad(C, tc_2844), kgen(s3_1354[@i_184]), r7_2843) in
            event partCT(hostT, TGT_58, e5);
            new n3_2845: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
            event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_2846: symseed;
            new tc'_2847: timest;
            let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2840[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1360[@i_184], z_921[@i_184], AK_2840[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_2998: symseed;
            let z_5514: maxmac = encsym2(Zpad, kgen2(s3_1360[@i_184]), r7_2998) in
            event partCT(hostT, TGT_58, z_5514);
            new n3_3000: nonce;
            out(c4[!_36, !_35], (TGT_58, z_5514, hostS, n3_3000));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_5534 <= N suchthat defined(rSK_1423[@i_5534], hostW_46[@i_5534], n'[@i_5534], z_5511[@i_5534], @i_1385[@i_5534]) && ((@i_1385[@i_5534] = @i_184) && (z_5511[@i_5534] = m7)) then
              if (n3_3000 = n'[@i_5534]) then
              if (hostS = hostW_46[@i_5534]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5639: symseed;
              new tc'_5640: timest;
              let e12: maxmac = encsym(pad(C, tc'_5640), kgen(rSK_1423[@i_5534]), r2_5639) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5640)) = decsym(m13, kgen(rSK_1423[@i_5534])) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_5529 <= N3 suchthat defined(z_5514[@i_5529]) && (z_5514[@i_5529] = m7) then
              yield
            orfind @i_5528 <= N suchthat defined(rSK_1419[@i_5528], hostW_46[@i_5528], n'[@i_5528], z_5518[@i_5528], @i_1385[@i_5528]) && ((@i_1385[@i_5528] = @i_184) && (z_5518[@i_5528] = m7)) then
              if (n3_3000 = n'[@i_5528]) then
              if (hostS = hostW_46[@i_5528]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5641: symseed;
              new tc'_5642: timest;
              let e12: maxmac = encsym(pad(C, tc'_5642), kgen(rSK_1419[@i_5528]), r2_5641) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5642)) = decsym(m13, kgen(rSK_1419[@i_5528])) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2841[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1366[@i_183], z_753[@i_183], AK_2841[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3003: symseed;
            new tc_3004: timest;
            let e5: maxmac = encsym(pad(C, tc_3004), kgen(s3_1366[@i_183]), r7_3003) in
            event partCT(hostT, TGT_58, e5);
            new n3_3005: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
            event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_3006: symseed;
            new tc'_3007: timest;
            let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2842[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1372[@i_183], z_753[@i_183], AK_2842[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3158: symseed;
            let z_3226: maxmac = encsym2(Zpad, kgen2(s3_1372[@i_183]), r7_3158) in
            event partCT(hostT, TGT_58, z_3226);
            new n3_3160: nonce;
            out(c4[!_36, !_35], (TGT_58, z_3226, hostS, n3_3160));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_4371 <= N suchthat defined(rSK_1431[@i_4371], hostW_46[@i_4371], n'[@i_4371], z_3163[@i_4371], @i_1384[@i_4371]) && ((@i_1384[@i_4371] = @i_183) && (z_3163[@i_4371] = m7)) then
              if (n3_3160 = n'[@i_4371]) then
              if (hostS = hostW_46[@i_4371]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5481: symseed;
              new tc'_5480: timest;
              let x_5985: maxenc = pad(C, tc'_5480) in
              let z_5984: maxmac = encsym(x_5985, kgen2(rSK_1431[@i_4371]), r2_5481) in
              let e12: maxmac = z_5984 in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              find @i_6004 <= N suchthat defined(tc'_45[@i_6004], z_5981[@i_6004], @i_1153[@i_6004]) && ((@i_1153[@i_6004] = @i_4371) && (z_5981[@i_6004] = m13)) then
                if (tc'_5480 = tc'_45[@i_6004]) then
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_5997 <= N4 suchthat defined(z_5984[@i_5997]) && (z_5984[@i_5997] = m13) then
                let @i_5999 <= N = !_35 in
                let @i_5998 <= N3 = !_36
            orfind @i_4306 <= N3 suchthat defined(z_3226[@i_4306]) && (z_3226[@i_4306] = m7) then
              yield
            orfind @i_4305 <= N suchthat defined(rSK_1427[@i_4305], hostW_46[@i_4305], n'[@i_4305], z_3230[@i_4305], @i_1384[@i_4305]) && ((@i_1384[@i_4305] = @i_183) && (z_3230[@i_4305] = m7)) then
              if (n3_3160 = n'[@i_4305]) then
              if (hostS = hostW_46[@i_4305]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5483: symseed;
              new tc'_5482: timest;
              let e12: maxmac = encsym(pad(C, tc'_5482), kgen(rSK_1427[@i_4305]), r2_5483) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5482)) = decsym(m13, kgen(rSK_1427[@i_4305])) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = cst_key in
              new r4_1355: symseed;
              new tk_1356: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new s_1357: symkeyseed;
              new r5_1358: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = cst_key in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new s_1363: symkeyseed;
              new r5_1364: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = cst_key in
              new r4_1367: symseed;
              new tk_1368: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new s_1369: symkeyseed;
              new r5_1370: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new s_1375: symkeyseed;
              new r5_1376: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(s3_1360[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          find @i_5527 <= N suchthat defined(z_5511[@i_5527], @i_1385[@i_5527]) && ((@i_1385[@i_5527] = @i_1385) && (z_5511[@i_5527] = m9)) then
            yield
          orfind @i_5522 <= N3, @i_5523 <= N suchthat defined(z_5514[@i_5522, @i_5523], @i_184[@i_5523]) && ((@i_184[@i_5523] = @i_1385) && (z_5514[@i_5522, @i_5523] = m9)) then
            event partTC(hostY_53[@i_1385], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1419: symkeyseed;
              let SK_5975: key = cst_key in
              new tt_1420: timest;
              new r10_1421: symseed;
              let e10: maxmac = encsym(concat5(kgen(rSK_1419), tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
              new r11_1422: symseed;
              let z_5518: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1422) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, z_5518);
              out(c8[!_39], (hostY_53[@i_1385], e10, z_5518, acceptT(hostY_53[@i_1385], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1423: symkeyseed;
              let SK_5976: key = cst_key in
              new r10_1424: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
              new r11_1425: symseed;
              let z_5511: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1425) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, z_5511);
              out(c8[!_39], (hostY_53[@i_1385], z_1150, z_5511, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind @i_5521 <= N suchthat defined(z_5518[@i_5521], @i_1385[@i_5521]) && ((@i_1385[@i_5521] = @i_1385) && (z_5518[@i_5521] = m9)) then
            yield
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          find @i_3299 <= N suchthat defined(z_3163[@i_3299], @i_1384[@i_3299]) && ((@i_1384[@i_3299] = @i_1384) && (z_3163[@i_3299] = m9)) then
            yield
          orfind @i_3234 <= N3, @i_3235 <= N suchthat defined(z_3226[@i_3234, @i_3235], @i_183[@i_3235]) && ((@i_183[@i_3235] = @i_1384) && (z_3226[@i_3234, @i_3235] = m9)) then
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_5977: key = cst_key in
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(kgen(rSK_1427), tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let z_3230: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1430) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, z_3230);
              out(c8[!_39], (hostY_53[@i_1384], e10, z_3230, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_5978: key = cst_key in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new r11_1433: symseed;
              let z_3163: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1433) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, z_3163);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, z_3163, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3233 <= N suchthat defined(z_3230[@i_3233], @i_1384[@i_3233]) && ((@i_1384[@i_3233] = @i_1384) && (z_3230[@i_3233] = m9)) then
            yield
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(rSK_1423[@i_1153], hostY_47[@i_1153], z_1150[@i_1153], SK_5976[@i_1153]) && (z_1150[@i_1153] = m14) then
        let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, kgen(rSK_1423[@i_1153])) in
        new r16_5979: symseed;
        let e16: maxmac = encsym(padts(tc'_45), kgen(rSK_1423[@i_1153]), r16_5979) in
        event partSC(hostY_47[@i_1153], m14, m15);
        event fullSC(hostY_47[@i_1153], m14, m15, e16);
        out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
      orfind @i_1153 <= N suchthat defined(hostY_47[@i_1153], rSK_1431[@i_1153], z_1150[@i_1153], SK_5978[@i_1153]) && (z_1150[@i_1153] = m14) then
        find @i_5996 <= N suchthat defined(z_5981[@i_5996], @i_1153[@i_5996]) && ((@i_1153[@i_5996] = @i_1153) && (z_5981[@i_5996] = m15)) then
          yield
        orfind @i_5989 <= N4, @i_5990 <= N3, @i_5991 <= N suchthat defined(tc'_5480[@i_5989, @i_5990, @i_5991], z_5984[@i_5989, @i_5990, @i_5991], @i_4371[@i_5990, @i_5991]) && ((@i_4371[@i_5990, @i_5991] = @i_1153) && (z_5984[@i_5989, @i_5990, @i_5991] = m15)) then
          let tc'_45: timest = tc'_5480[@i_5989, @i_5990, @i_5991] in
          new r16_5980: symseed;
          let x_5982: maxenc = padts(tc'_45) in
          let z_5981: maxmac = encsym(x_5982, kgen2(rSK_1431[@i_1153]), r16_5980) in
          let e16: maxmac = z_5981 in
          event partSC(hostY_47[@i_1153], m14, m15);
          event fullSC(hostY_47[@i_1153], m14, m15, e16);
          out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying move new all binders yields

Game 115 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKs: symkeyseed;
new rKt: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2839[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1354[@i_184], z_921[@i_184], AK_2839[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_2844: timest;
            new r7_2843: symseed;
            let e5: maxmac = encsym(pad(C, tc_2844), kgen(s3_1354[@i_184]), r7_2843) in
            event partCT(hostT, TGT_58, e5);
            new n3_2845: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
            event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_2847: timest;
            new r2_2846: symseed;
            let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2840[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1360[@i_184], z_921[@i_184], AK_2840[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_2998: symseed;
            let z_5514: maxmac = encsym2(Zpad, kgen2(s3_1360[@i_184]), r7_2998) in
            event partCT(hostT, TGT_58, z_5514);
            new n3_3000: nonce;
            out(c4[!_36, !_35], (TGT_58, z_5514, hostS, n3_3000));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_5534 <= N suchthat defined(rSK_1423[@i_5534], hostW_46[@i_5534], n'[@i_5534], z_5511[@i_5534], @i_1385[@i_5534]) && ((@i_1385[@i_5534] = @i_184) && (z_5511[@i_5534] = m7)) then
              if (n3_3000 = n'[@i_5534]) then
              if (hostS = hostW_46[@i_5534]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5640: timest;
              new r2_5639: symseed;
              let e12: maxmac = encsym(pad(C, tc'_5640), kgen(rSK_1423[@i_5534]), r2_5639) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5640)) = decsym(m13, kgen(rSK_1423[@i_5534])) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_5529 <= N3 suchthat defined(z_5514[@i_5529]) && (z_5514[@i_5529] = m7) then
              yield
            orfind @i_5528 <= N suchthat defined(rSK_1419[@i_5528], hostW_46[@i_5528], n'[@i_5528], z_5518[@i_5528], @i_1385[@i_5528]) && ((@i_1385[@i_5528] = @i_184) && (z_5518[@i_5528] = m7)) then
              if (n3_3000 = n'[@i_5528]) then
              if (hostS = hostW_46[@i_5528]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5642: timest;
              new r2_5641: symseed;
              let e12: maxmac = encsym(pad(C, tc'_5642), kgen(rSK_1419[@i_5528]), r2_5641) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5642)) = decsym(m13, kgen(rSK_1419[@i_5528])) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2841[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1366[@i_183], z_753[@i_183], AK_2841[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_3004: timest;
            new r7_3003: symseed;
            let e5: maxmac = encsym(pad(C, tc_3004), kgen(s3_1366[@i_183]), r7_3003) in
            event partCT(hostT, TGT_58, e5);
            new n3_3005: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
            event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_3007: timest;
            new r2_3006: symseed;
            let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2842[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1372[@i_183], z_753[@i_183], AK_2842[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3158: symseed;
            let z_3226: maxmac = encsym2(Zpad, kgen2(s3_1372[@i_183]), r7_3158) in
            event partCT(hostT, TGT_58, z_3226);
            new n3_3160: nonce;
            out(c4[!_36, !_35], (TGT_58, z_3226, hostS, n3_3160));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_4371 <= N suchthat defined(rSK_1431[@i_4371], hostW_46[@i_4371], n'[@i_4371], z_3163[@i_4371], @i_1384[@i_4371]) && ((@i_1384[@i_4371] = @i_183) && (z_3163[@i_4371] = m7)) then
              if (n3_3160 = n'[@i_4371]) then
              if (hostS = hostW_46[@i_4371]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5480: timest;
              let x_5985: maxenc = pad(C, tc'_5480) in
              new r2_5481: symseed;
              let z_5984: maxmac = encsym(x_5985, kgen2(rSK_1431[@i_4371]), r2_5481) in
              let e12: maxmac = z_5984 in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              find @i_6004 <= N suchthat defined(tc'_45[@i_6004], z_5981[@i_6004], @i_1153[@i_6004]) && ((@i_1153[@i_6004] = @i_4371) && (z_5981[@i_6004] = m13)) then
                if (tc'_5480 = tc'_45[@i_6004]) then
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_5997 <= N4 suchthat defined(z_5984[@i_5997]) && (z_5984[@i_5997] = m13) then
                let @i_5999 <= N = !_35 in
                let @i_5998 <= N3 = !_36
            orfind @i_4306 <= N3 suchthat defined(z_3226[@i_4306]) && (z_3226[@i_4306] = m7) then
              yield
            orfind @i_4305 <= N suchthat defined(rSK_1427[@i_4305], hostW_46[@i_4305], n'[@i_4305], z_3230[@i_4305], @i_1384[@i_4305]) && ((@i_1384[@i_4305] = @i_183) && (z_3230[@i_4305] = m7)) then
              if (n3_3160 = n'[@i_4305]) then
              if (hostS = hostW_46[@i_4305]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5482: timest;
              new r2_5483: symseed;
              let e12: maxmac = encsym(pad(C, tc'_5482), kgen(rSK_1427[@i_4305]), r2_5483) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5482)) = decsym(m13, kgen(rSK_1427[@i_4305])) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = cst_key in
              new tk_1356: timest;
              new r4_1355: symseed;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new r5_1358: symseed;
              new s_1357: symkeyseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = cst_key in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new r5_1364: symseed;
              new s_1363: symkeyseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = cst_key in
              new tk_1368: timest;
              new r4_1367: symseed;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new r5_1370: symseed;
              new s_1369: symkeyseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new r5_1376: symseed;
              new s_1375: symkeyseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(s3_1360[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          find @i_5527 <= N suchthat defined(z_5511[@i_5527], @i_1385[@i_5527]) && ((@i_1385[@i_5527] = @i_1385) && (z_5511[@i_5527] = m9)) then
            yield
          orfind @i_5522 <= N3, @i_5523 <= N suchthat defined(z_5514[@i_5522, @i_5523], @i_184[@i_5523]) && ((@i_184[@i_5523] = @i_1385) && (z_5514[@i_5522, @i_5523] = m9)) then
            event partTC(hostY_53[@i_1385], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1419: symkeyseed;
              let SK_5975: key = cst_key in
              new r10_1421: symseed;
              new tt_1420: timest;
              let e10: maxmac = encsym(concat5(kgen(rSK_1419), tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
              new r11_1422: symseed;
              let z_5518: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1422) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, z_5518);
              out(c8[!_39], (hostY_53[@i_1385], e10, z_5518, acceptT(hostY_53[@i_1385], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1423: symkeyseed;
              let SK_5976: key = cst_key in
              new r10_1424: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
              new r11_1425: symseed;
              let z_5511: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1425) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, z_5511);
              out(c8[!_39], (hostY_53[@i_1385], z_1150, z_5511, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind @i_5521 <= N suchthat defined(z_5518[@i_5521], @i_1385[@i_5521]) && ((@i_1385[@i_5521] = @i_1385) && (z_5518[@i_5521] = m9)) then
            yield
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          find @i_3299 <= N suchthat defined(z_3163[@i_3299], @i_1384[@i_3299]) && ((@i_1384[@i_3299] = @i_1384) && (z_3163[@i_3299] = m9)) then
            yield
          orfind @i_3234 <= N3, @i_3235 <= N suchthat defined(z_3226[@i_3234, @i_3235], @i_183[@i_3235]) && ((@i_183[@i_3235] = @i_1384) && (z_3226[@i_3234, @i_3235] = m9)) then
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              let SK_5977: key = cst_key in
              new tt_1428: timest;
              new r10_1429: symseed;
              let e10: maxmac = encsym(concat5(kgen(rSK_1427), tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let z_3230: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1430) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, z_3230);
              out(c8[!_39], (hostY_53[@i_1384], e10, z_3230, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_5978: key = cst_key in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new r11_1433: symseed;
              let z_3163: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1433) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, z_3163);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, z_3163, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3233 <= N suchthat defined(z_3230[@i_3233], @i_1384[@i_3233]) && ((@i_1384[@i_3233] = @i_1384) && (z_3230[@i_3233] = m9)) then
            yield
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(rSK_1423[@i_1153], hostY_47[@i_1153], z_1150[@i_1153], SK_5976[@i_1153]) && (z_1150[@i_1153] = m14) then
        let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, kgen(rSK_1423[@i_1153])) in
        new r16_5979: symseed;
        let e16: maxmac = encsym(padts(tc'_45), kgen(rSK_1423[@i_1153]), r16_5979) in
        event partSC(hostY_47[@i_1153], m14, m15);
        event fullSC(hostY_47[@i_1153], m14, m15, e16);
        out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
      orfind @i_1153 <= N suchthat defined(hostY_47[@i_1153], rSK_1431[@i_1153], z_1150[@i_1153], SK_5978[@i_1153]) && (z_1150[@i_1153] = m14) then
        find @i_5996 <= N suchthat defined(z_5981[@i_5996], @i_1153[@i_5996]) && ((@i_1153[@i_5996] = @i_1153) && (z_5981[@i_5996] = m15)) then
          yield
        orfind @i_5989 <= N4, @i_5990 <= N3, @i_5991 <= N suchthat defined(tc'_5480[@i_5989, @i_5990, @i_5991], z_5984[@i_5989, @i_5990, @i_5991], @i_4371[@i_5990, @i_5991]) && ((@i_4371[@i_5990, @i_5991] = @i_1153) && (z_5984[@i_5989, @i_5990, @i_5991] = m15)) then
          let tc'_45: timest = tc'_5480[@i_5989, @i_5990, @i_5991] in
          let x_5982: maxenc = padts(tc'_45) in
          new r16_5980: symseed;
          let z_5981: maxmac = encsym(x_5982, kgen2(rSK_1431[@i_1153]), r16_5980) in
          let e16: maxmac = z_5981 in
          event partSC(hostY_47[@i_1153], m14, m15);
          event fullSC(hostY_47[@i_1153], m14, m15, e16);
          out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying remove assignments of useless yields

Game 116 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKs: symkeyseed;
new rKt: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2839[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1354[@i_184], z_921[@i_184], AK_2839[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_2844: timest;
            new r7_2843: symseed;
            let e5: maxmac = encsym(pad(C, tc_2844), kgen(s3_1354[@i_184]), r7_2843) in
            event partCT(hostT, TGT_58, e5);
            new n3_2845: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
            event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_2847: timest;
            new r2_2846: symseed;
            let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2840[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1360[@i_184], z_921[@i_184], AK_2840[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_2998: symseed;
            let z_5514: maxmac = encsym2(Zpad, kgen2(s3_1360[@i_184]), r7_2998) in
            event partCT(hostT, TGT_58, z_5514);
            new n3_3000: nonce;
            out(c4[!_36, !_35], (TGT_58, z_5514, hostS, n3_3000));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_5534 <= N suchthat defined(rSK_1423[@i_5534], hostW_46[@i_5534], n'[@i_5534], z_5511[@i_5534], @i_1385[@i_5534]) && ((@i_1385[@i_5534] = @i_184) && (z_5511[@i_5534] = m7)) then
              if (n3_3000 = n'[@i_5534]) then
              if (hostS = hostW_46[@i_5534]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5640: timest;
              new r2_5639: symseed;
              let e12: maxmac = encsym(pad(C, tc'_5640), kgen(rSK_1423[@i_5534]), r2_5639) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5640)) = decsym(m13, kgen(rSK_1423[@i_5534])) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_5529 <= N3 suchthat defined(z_5514[@i_5529]) && (z_5514[@i_5529] = m7) then
              yield
            orfind @i_5528 <= N suchthat defined(rSK_1419[@i_5528], hostW_46[@i_5528], n'[@i_5528], z_5518[@i_5528], @i_1385[@i_5528]) && ((@i_1385[@i_5528] = @i_184) && (z_5518[@i_5528] = m7)) then
              if (n3_3000 = n'[@i_5528]) then
              if (hostS = hostW_46[@i_5528]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5642: timest;
              new r2_5641: symseed;
              let e12: maxmac = encsym(pad(C, tc'_5642), kgen(rSK_1419[@i_5528]), r2_5641) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5642)) = decsym(m13, kgen(rSK_1419[@i_5528])) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2841[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1366[@i_183], z_753[@i_183], AK_2841[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_3004: timest;
            new r7_3003: symseed;
            let e5: maxmac = encsym(pad(C, tc_3004), kgen(s3_1366[@i_183]), r7_3003) in
            event partCT(hostT, TGT_58, e5);
            new n3_3005: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
            event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_3007: timest;
            new r2_3006: symseed;
            let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2842[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1372[@i_183], z_753[@i_183], AK_2842[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3158: symseed;
            let z_3226: maxmac = encsym2(Zpad, kgen2(s3_1372[@i_183]), r7_3158) in
            event partCT(hostT, TGT_58, z_3226);
            new n3_3160: nonce;
            out(c4[!_36, !_35], (TGT_58, z_3226, hostS, n3_3160));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_4371 <= N suchthat defined(rSK_1431[@i_4371], hostW_46[@i_4371], n'[@i_4371], z_3163[@i_4371], @i_1384[@i_4371]) && ((@i_1384[@i_4371] = @i_183) && (z_3163[@i_4371] = m7)) then
              if (n3_3160 = n'[@i_4371]) then
              if (hostS = hostW_46[@i_4371]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5480: timest;
              let x_5985: maxenc = pad(C, tc'_5480) in
              new r2_5481: symseed;
              let z_5984: maxmac = encsym(x_5985, kgen2(rSK_1431[@i_4371]), r2_5481) in
              event partCS(hostS, hostT, m7, z_5984);
              out(c6[!_37, !_36, !_35], (m6, z_5984));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              find @i_6004 <= N suchthat defined(tc'_45[@i_6004], z_5981[@i_6004], @i_1153[@i_6004]) && ((@i_1153[@i_6004] = @i_4371) && (z_5981[@i_6004] = m13)) then
                if (tc'_5480 = tc'_45[@i_6004]) then
                event fullCS(hostS, hostT, m7, z_5984, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_5997 <= N4 suchthat defined(z_5984[@i_5997]) && (z_5984[@i_5997] = m13) then
                yield
            orfind @i_4306 <= N3 suchthat defined(z_3226[@i_4306]) && (z_3226[@i_4306] = m7) then
              yield
            orfind @i_4305 <= N suchthat defined(rSK_1427[@i_4305], hostW_46[@i_4305], n'[@i_4305], z_3230[@i_4305], @i_1384[@i_4305]) && ((@i_1384[@i_4305] = @i_183) && (z_3230[@i_4305] = m7)) then
              if (n3_3160 = n'[@i_4305]) then
              if (hostS = hostW_46[@i_4305]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5482: timest;
              new r2_5483: symseed;
              let e12: maxmac = encsym(pad(C, tc'_5482), kgen(rSK_1427[@i_4305]), r2_5483) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5482)) = decsym(m13, kgen(rSK_1427[@i_4305])) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = cst_key in
              new tk_1356: timest;
              new r4_1355: symseed;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new r5_1358: symseed;
              new s_1357: symkeyseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = cst_key in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new r5_1364: symseed;
              new s_1363: symkeyseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = cst_key in
              new tk_1368: timest;
              new r4_1367: symseed;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new r5_1370: symseed;
              new s_1369: symkeyseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new r5_1376: symseed;
              new s_1375: symkeyseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(s3_1360[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          find @i_5527 <= N suchthat defined(z_5511[@i_5527], @i_1385[@i_5527]) && ((@i_1385[@i_5527] = @i_1385) && (z_5511[@i_5527] = m9)) then
            yield
          orfind @i_5522 <= N3, @i_5523 <= N suchthat defined(z_5514[@i_5522, @i_5523], @i_184[@i_5523]) && ((@i_184[@i_5523] = @i_1385) && (z_5514[@i_5522, @i_5523] = m9)) then
            event partTC(hostY_53[@i_1385], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1419: symkeyseed;
              new r10_1421: symseed;
              new tt_1420: timest;
              let e10: maxmac = encsym(concat5(kgen(rSK_1419), tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
              new r11_1422: symseed;
              let z_5518: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1422) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, z_5518);
              out(c8[!_39], (hostY_53[@i_1385], e10, z_5518, acceptT(hostY_53[@i_1385], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1423: symkeyseed;
              let SK_5976: key = cst_key in
              new r10_1424: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
              new r11_1425: symseed;
              let z_5511: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1425) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, z_5511);
              out(c8[!_39], (hostY_53[@i_1385], z_1150, z_5511, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind @i_5521 <= N suchthat defined(z_5518[@i_5521], @i_1385[@i_5521]) && ((@i_1385[@i_5521] = @i_1385) && (z_5518[@i_5521] = m9)) then
            yield
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          find @i_3299 <= N suchthat defined(z_3163[@i_3299], @i_1384[@i_3299]) && ((@i_1384[@i_3299] = @i_1384) && (z_3163[@i_3299] = m9)) then
            yield
          orfind @i_3234 <= N3, @i_3235 <= N suchthat defined(z_3226[@i_3234, @i_3235], @i_183[@i_3235]) && ((@i_183[@i_3235] = @i_1384) && (z_3226[@i_3234, @i_3235] = m9)) then
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              new tt_1428: timest;
              new r10_1429: symseed;
              let e10: maxmac = encsym(concat5(kgen(rSK_1427), tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let z_3230: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1430) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, z_3230);
              out(c8[!_39], (hostY_53[@i_1384], e10, z_3230, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_5978: key = cst_key in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new r11_1433: symseed;
              let z_3163: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1433) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, z_3163);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, z_3163, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3233 <= N suchthat defined(z_3230[@i_3233], @i_1384[@i_3233]) && ((@i_1384[@i_3233] = @i_1384) && (z_3230[@i_3233] = m9)) then
            yield
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(rSK_1423[@i_1153], hostY_47[@i_1153], z_1150[@i_1153], SK_5976[@i_1153]) && (z_1150[@i_1153] = m14) then
        let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = decsym(m15, kgen(rSK_1423[@i_1153])) in
        new r16_5979: symseed;
        let e16: maxmac = encsym(padts(tc'_45), kgen(rSK_1423[@i_1153]), r16_5979) in
        event partSC(hostY_47[@i_1153], m14, m15);
        event fullSC(hostY_47[@i_1153], m14, m15, e16);
        out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
      orfind @i_1153 <= N suchthat defined(hostY_47[@i_1153], rSK_1431[@i_1153], z_1150[@i_1153], SK_5978[@i_1153]) && (z_1150[@i_1153] = m14) then
        find @i_5996 <= N suchthat defined(z_5981[@i_5996], @i_1153[@i_5996]) && ((@i_1153[@i_5996] = @i_1153) && (z_5981[@i_5996] = m15)) then
          yield
        orfind @i_5989 <= N4, @i_5990 <= N3, @i_5991 <= N suchthat defined(tc'_5480[@i_5989, @i_5990, @i_5991], z_5984[@i_5989, @i_5990, @i_5991], @i_4371[@i_5990, @i_5991]) && ((@i_4371[@i_5990, @i_5991] = @i_1153) && (z_5984[@i_5989, @i_5990, @i_5991] = m15)) then
          let tc'_45: timest = tc'_5480[@i_5989, @i_5990, @i_5991] in
          let x_5982: maxenc = padts(tc'_5480[@i_5989, @i_5990, @i_5991]) in
          new r16_5980: symseed;
          let z_5981: maxmac = encsym(x_5982, kgen2(rSK_1431[@i_1153]), r16_5980) in
          event partSC(hostY_47[@i_1153], m14, m15);
          event fullSC(hostY_47[@i_1153], m14, m15, z_5981);
          out(c12[!_40], (z_5981, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying equivalence
equiv ! !_19 <= N2 new r: symkeyseed; (
  ! !_20 <= N new r2: symseed; (x: maxenc) -> encsym(x, kgen(r), r2),
  ! !_21 <= N3 (y: maxmac) -> decsym(y, kgen(r)))
<=(N2 * Pencctxt(time, N, N3))=>
      ! !_22 <= N2 new r: symkeyseed; (
  ! !_23 <= N new r2: symseed; (x_79: maxenc) -> let x: maxenc = x_79 in let z: maxmac = encsym(x, kgen2(r), r2) in z,
  ! !_24 <= N3 (y: maxmac) -> find j <= N suchthat defined(x[j], r2[j], z[j]) && (z[j] = y) then injbot2(x[j]) else bottom)
 [Difference of probability N * Pencctxt(time + time(context for game 116), N + N4 * N3 * N, N + N4 * N3 * N)] yields

Game 117 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKs: symkeyseed;
new rKt: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2839[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1354[@i_184], z_921[@i_184], AK_2839[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_2844: timest;
            new r7_2843: symseed;
            let e5: maxmac = encsym(pad(C, tc_2844), kgen(s3_1354[@i_184]), r7_2843) in
            event partCT(hostT, TGT_58, e5);
            new n3_2845: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
            event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_2847: timest;
            new r2_2846: symseed;
            let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2840[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1360[@i_184], z_921[@i_184], AK_2840[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_2998: symseed;
            let z_5514: maxmac = encsym2(Zpad, kgen2(s3_1360[@i_184]), r7_2998) in
            event partCT(hostT, TGT_58, z_5514);
            new n3_3000: nonce;
            out(c4[!_36, !_35], (TGT_58, z_5514, hostS, n3_3000));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_5534 <= N suchthat defined(rSK_1423[@i_5534], hostW_46[@i_5534], n'[@i_5534], z_5511[@i_5534], @i_1385[@i_5534]) && ((@i_1385[@i_5534] = @i_184) && (z_5511[@i_5534] = m7)) then
              if (n3_3000 = n'[@i_5534]) then
              if (hostS = hostW_46[@i_5534]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5640: timest;
              new r2_5639: symseed;
              let x_6119: maxenc = pad(C, tc'_5640) in
              let z_6118: maxmac = encsym(x_6119, kgen2(rSK_1423[@i_5534]), r2_5639) in
              let e12: maxmac = z_6118 in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              find @i_6138 <= N suchthat defined(x_6116[@i_6138], r16_5979[@i_6138], z_6115[@i_6138]) && ((@i_1153[@i_6138] = @i_5534) && (z_6115[@i_6138] = m13)) then
                let injbot2(padts(=tc'_5640)) = injbot2(x_6116[@i_6138]) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_6131 <= N4, @i_6132 <= N3, @i_6133 <= N suchthat defined(x_6119[@i_6131, @i_6132, @i_6133], r2_5639[@i_6131, @i_6132, @i_6133], z_6118[@i_6131, @i_6132, @i_6133]) && ((@i_5534[@i_6132, @i_6133] = @i_5534) && (z_6118[@i_6131, @i_6132, @i_6133] = m13)) then
                let injbot2(padts(=tc'_5640)) = injbot2(x_6119[@i_6131, @i_6132, @i_6133]) in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              else
                let injbot2(padts(=tc'_5640)) = bottom in
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
            orfind @i_5529 <= N3 suchthat defined(z_5514[@i_5529]) && (z_5514[@i_5529] = m7) then
              yield
            orfind @i_5528 <= N suchthat defined(rSK_1419[@i_5528], hostW_46[@i_5528], n'[@i_5528], z_5518[@i_5528], @i_1385[@i_5528]) && ((@i_1385[@i_5528] = @i_184) && (z_5518[@i_5528] = m7)) then
              if (n3_3000 = n'[@i_5528]) then
              if (hostS = hostW_46[@i_5528]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5642: timest;
              new r2_5641: symseed;
              let e12: maxmac = encsym(pad(C, tc'_5642), kgen(rSK_1419[@i_5528]), r2_5641) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5642)) = decsym(m13, kgen(rSK_1419[@i_5528])) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2841[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1366[@i_183], z_753[@i_183], AK_2841[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_3004: timest;
            new r7_3003: symseed;
            let e5: maxmac = encsym(pad(C, tc_3004), kgen(s3_1366[@i_183]), r7_3003) in
            event partCT(hostT, TGT_58, e5);
            new n3_3005: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
            event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_3007: timest;
            new r2_3006: symseed;
            let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2842[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1372[@i_183], z_753[@i_183], AK_2842[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3158: symseed;
            let z_3226: maxmac = encsym2(Zpad, kgen2(s3_1372[@i_183]), r7_3158) in
            event partCT(hostT, TGT_58, z_3226);
            new n3_3160: nonce;
            out(c4[!_36, !_35], (TGT_58, z_3226, hostS, n3_3160));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_4371 <= N suchthat defined(rSK_1431[@i_4371], hostW_46[@i_4371], n'[@i_4371], z_3163[@i_4371], @i_1384[@i_4371]) && ((@i_1384[@i_4371] = @i_183) && (z_3163[@i_4371] = m7)) then
              if (n3_3160 = n'[@i_4371]) then
              if (hostS = hostW_46[@i_4371]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5480: timest;
              let x_5985: maxenc = pad(C, tc'_5480) in
              new r2_5481: symseed;
              let z_5984: maxmac = encsym(x_5985, kgen2(rSK_1431[@i_4371]), r2_5481) in
              event partCS(hostS, hostT, m7, z_5984);
              out(c6[!_37, !_36, !_35], (m6, z_5984));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              find @i_6004 <= N suchthat defined(tc'_45[@i_6004], z_5981[@i_6004], @i_1153[@i_6004]) && ((@i_1153[@i_6004] = @i_4371) && (z_5981[@i_6004] = m13)) then
                if (tc'_5480 = tc'_45[@i_6004]) then
                event fullCS(hostS, hostT, m7, z_5984, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_5997 <= N4 suchthat defined(z_5984[@i_5997]) && (z_5984[@i_5997] = m13) then
                yield
            orfind @i_4306 <= N3 suchthat defined(z_3226[@i_4306]) && (z_3226[@i_4306] = m7) then
              yield
            orfind @i_4305 <= N suchthat defined(rSK_1427[@i_4305], hostW_46[@i_4305], n'[@i_4305], z_3230[@i_4305], @i_1384[@i_4305]) && ((@i_1384[@i_4305] = @i_183) && (z_3230[@i_4305] = m7)) then
              if (n3_3160 = n'[@i_4305]) then
              if (hostS = hostW_46[@i_4305]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5482: timest;
              new r2_5483: symseed;
              let e12: maxmac = encsym(pad(C, tc'_5482), kgen(rSK_1427[@i_4305]), r2_5483) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5482)) = decsym(m13, kgen(rSK_1427[@i_4305])) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = cst_key in
              new tk_1356: timest;
              new r4_1355: symseed;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new r5_1358: symseed;
              new s_1357: symkeyseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = cst_key in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new r5_1364: symseed;
              new s_1363: symkeyseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = cst_key in
              new tk_1368: timest;
              new r4_1367: symseed;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new r5_1370: symseed;
              new s_1369: symkeyseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new r5_1376: symseed;
              new s_1375: symkeyseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(s3_1360[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          find @i_5527 <= N suchthat defined(z_5511[@i_5527], @i_1385[@i_5527]) && ((@i_1385[@i_5527] = @i_1385) && (z_5511[@i_5527] = m9)) then
            yield
          orfind @i_5522 <= N3, @i_5523 <= N suchthat defined(z_5514[@i_5522, @i_5523], @i_184[@i_5523]) && ((@i_184[@i_5523] = @i_1385) && (z_5514[@i_5522, @i_5523] = m9)) then
            event partTC(hostY_53[@i_1385], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1419: symkeyseed;
              new r10_1421: symseed;
              new tt_1420: timest;
              let e10: maxmac = encsym(concat5(kgen(rSK_1419), tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
              new r11_1422: symseed;
              let z_5518: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1422) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, z_5518);
              out(c8[!_39], (hostY_53[@i_1385], e10, z_5518, acceptT(hostY_53[@i_1385], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1423: symkeyseed;
              let SK_5976: key = cst_key in
              new r10_1424: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
              new r11_1425: symseed;
              let z_5511: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1425) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, z_5511);
              out(c8[!_39], (hostY_53[@i_1385], z_1150, z_5511, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind @i_5521 <= N suchthat defined(z_5518[@i_5521], @i_1385[@i_5521]) && ((@i_1385[@i_5521] = @i_1385) && (z_5518[@i_5521] = m9)) then
            yield
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          find @i_3299 <= N suchthat defined(z_3163[@i_3299], @i_1384[@i_3299]) && ((@i_1384[@i_3299] = @i_1384) && (z_3163[@i_3299] = m9)) then
            yield
          orfind @i_3234 <= N3, @i_3235 <= N suchthat defined(z_3226[@i_3234, @i_3235], @i_183[@i_3235]) && ((@i_183[@i_3235] = @i_1384) && (z_3226[@i_3234, @i_3235] = m9)) then
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              new tt_1428: timest;
              new r10_1429: symseed;
              let e10: maxmac = encsym(concat5(kgen(rSK_1427), tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let z_3230: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1430) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, z_3230);
              out(c8[!_39], (hostY_53[@i_1384], e10, z_3230, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_5978: key = cst_key in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new r11_1433: symseed;
              let z_3163: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1433) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, z_3163);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, z_3163, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3233 <= N suchthat defined(z_3230[@i_3233], @i_1384[@i_3233]) && ((@i_1384[@i_3233] = @i_1384) && (z_3230[@i_3233] = m9)) then
            yield
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(rSK_1423[@i_1153], hostY_47[@i_1153], z_1150[@i_1153], SK_5976[@i_1153]) && (z_1150[@i_1153] = m14) then
        find @i_6130 <= N suchthat defined(x_6116[@i_6130], r16_5979[@i_6130], z_6115[@i_6130]) && ((@i_1153[@i_6130] = @i_1153) && (z_6115[@i_6130] = m15)) then
          let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = injbot2(x_6116[@i_6130]) in
          new r16_5979: symseed;
          let x_6116: maxenc = padts(tc'_45) in
          let z_6115: maxmac = encsym(x_6116, kgen2(rSK_1423[@i_1153]), r16_5979) in
          let e16: maxmac = z_6115 in
          event partSC(hostY_47[@i_1153], m14, m15);
          event fullSC(hostY_47[@i_1153], m14, m15, e16);
          out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
        orfind @i_6123 <= N4, @i_6124 <= N3, @i_6125 <= N suchthat defined(x_6119[@i_6123, @i_6124, @i_6125], r2_5639[@i_6123, @i_6124, @i_6125], z_6118[@i_6123, @i_6124, @i_6125]) && ((@i_5534[@i_6124, @i_6125] = @i_1153) && (z_6118[@i_6123, @i_6124, @i_6125] = m15)) then
          let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = injbot2(x_6119[@i_6123, @i_6124, @i_6125]) in
          new r16_5979: symseed;
          let x_6116: maxenc = padts(tc'_45) in
          let z_6115: maxmac = encsym(x_6116, kgen2(rSK_1423[@i_1153]), r16_5979) in
          let e16: maxmac = z_6115 in
          event partSC(hostY_47[@i_1153], m14, m15);
          event fullSC(hostY_47[@i_1153], m14, m15, e16);
          out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
        else
          let injbot2(pad(=hostY_47[@i_1153], tc'_45: timest)) = bottom in
          new r16_5979: symseed;
          let x_6116: maxenc = padts(tc'_45) in
          let z_6115: maxmac = encsym(x_6116, kgen2(rSK_1423[@i_1153]), r16_5979) in
          let e16: maxmac = z_6115 in
          event partSC(hostY_47[@i_1153], m14, m15);
          event fullSC(hostY_47[@i_1153], m14, m15, e16);
          out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
      orfind @i_1153 <= N suchthat defined(hostY_47[@i_1153], rSK_1431[@i_1153], z_1150[@i_1153], SK_5978[@i_1153]) && (z_1150[@i_1153] = m14) then
        find @i_5996 <= N suchthat defined(z_5981[@i_5996], @i_1153[@i_5996]) && ((@i_1153[@i_5996] = @i_1153) && (z_5981[@i_5996] = m15)) then
          yield
        orfind @i_5989 <= N4, @i_5990 <= N3, @i_5991 <= N suchthat defined(tc'_5480[@i_5989, @i_5990, @i_5991], z_5984[@i_5989, @i_5990, @i_5991], @i_4371[@i_5990, @i_5991]) && ((@i_4371[@i_5990, @i_5991] = @i_1153) && (z_5984[@i_5989, @i_5990, @i_5991] = m15)) then
          let tc'_45: timest = tc'_5480[@i_5989, @i_5990, @i_5991] in
          let x_5982: maxenc = padts(tc'_5480[@i_5989, @i_5990, @i_5991]) in
          new r16_5980: symseed;
          let z_5981: maxmac = encsym(x_5982, kgen2(rSK_1431[@i_1153]), r16_5980) in
          event partSC(hostY_47[@i_1153], m14, m15);
          event fullSC(hostY_47[@i_1153], m14, m15, z_5981);
          out(c12[!_40], (z_5981, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying simplify [Difference of probability 0.5 * N3 * N * N3 * N / |nonce|] yields

Game 118 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKs: symkeyseed;
new rKt: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new n1: nonce;
          new r1: sseed;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2839[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1354[@i_184], z_921[@i_184], AK_2839[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_2844: timest;
            new r7_2843: symseed;
            let e5: maxmac = encsym(pad(C, tc_2844), kgen(s3_1354[@i_184]), r7_2843) in
            event partCT(hostT, TGT_58, e5);
            new n3_2845: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
            event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_2847: timest;
            new r2_2846: symseed;
            let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2840[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1360[@i_184], z_921[@i_184], AK_2840[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_2998: symseed;
            let z_5514: maxmac = encsym2(Zpad, kgen2(s3_1360[@i_184]), r7_2998) in
            event partCT(hostT, TGT_58, z_5514);
            new n3_3000: nonce;
            out(c4[!_36, !_35], (TGT_58, z_5514, hostS, n3_3000));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_5534 <= N suchthat defined(rSK_1423[@i_5534], hostW_46[@i_5534], n'[@i_5534], z_5511[@i_5534], @i_1385[@i_5534]) && ((@i_1385[@i_5534] = @i_184) && (z_5511[@i_5534] = m7)) then
              if (n3_3000 = n'[@i_5534]) then
              if (hostS = hostW_46[@i_5534]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5640: timest;
              new r2_5639: symseed;
              let x_6119: maxenc = pad(C, tc'_5640) in
              let z_6118: maxmac = encsym(x_6119, kgen2(rSK_1423[@i_5534]), r2_5639) in
              let e12: maxmac = z_6118 in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              find @i_6138 <= N suchthat defined(tc'_45[@i_6138], z_6115[@i_6138], @i_1153[@i_6138]) && ((@i_1153[@i_6138] = @i_5534) && (z_6115[@i_6138] = m13)) then
                if (tc'_5640 = tc'_45[@i_6138]) then
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_6131 <= N4 suchthat defined(z_6118[@i_6131]) && (z_6118[@i_6131] = m13) then
                let @i_6133 <= N = !_35 in
                let @i_6132 <= N3 = !_36
            orfind @i_5529 <= N3 suchthat defined(z_5514[@i_5529]) && (z_5514[@i_5529] = m7) then
              yield
            orfind @i_5528 <= N suchthat defined(rSK_1419[@i_5528], hostW_46[@i_5528], n'[@i_5528], z_5518[@i_5528], @i_1385[@i_5528]) && ((@i_1385[@i_5528] = @i_184) && (z_5518[@i_5528] = m7)) then
              if (n3_3000 = n'[@i_5528]) then
              if (hostS = hostW_46[@i_5528]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5642: timest;
              new r2_5641: symseed;
              let e12: maxmac = encsym(pad(C, tc'_5642), kgen(rSK_1419[@i_5528]), r2_5641) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5642)) = decsym(m13, kgen(rSK_1419[@i_5528])) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2841[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1366[@i_183], z_753[@i_183], AK_2841[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new tc_3004: timest;
            new r7_3003: symseed;
            let e5: maxmac = encsym(pad(C, tc_3004), kgen(s3_1366[@i_183]), r7_3003) in
            event partCT(hostT, TGT_58, e5);
            new n3_3005: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
            event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new tc'_3007: timest;
            new r2_3006: symseed;
            let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2842[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1372[@i_183], z_753[@i_183], AK_2842[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3158: symseed;
            let z_3226: maxmac = encsym2(Zpad, kgen2(s3_1372[@i_183]), r7_3158) in
            event partCT(hostT, TGT_58, z_3226);
            new n3_3160: nonce;
            out(c4[!_36, !_35], (TGT_58, z_3226, hostS, n3_3160));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_4371 <= N suchthat defined(rSK_1431[@i_4371], hostW_46[@i_4371], n'[@i_4371], z_3163[@i_4371], @i_1384[@i_4371]) && ((@i_1384[@i_4371] = @i_183) && (z_3163[@i_4371] = m7)) then
              if (n3_3160 = n'[@i_4371]) then
              if (hostS = hostW_46[@i_4371]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5480: timest;
              let x_5985: maxenc = pad(C, tc'_5480) in
              new r2_5481: symseed;
              let z_5984: maxmac = encsym(x_5985, kgen2(rSK_1431[@i_4371]), r2_5481) in
              event partCS(hostS, hostT, m7, z_5984);
              out(c6[!_37, !_36, !_35], (m6, z_5984));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              find @i_6004 <= N suchthat defined(tc'_45[@i_6004], z_5981[@i_6004], @i_1153[@i_6004]) && ((@i_1153[@i_6004] = @i_4371) && (z_5981[@i_6004] = m13)) then
                if (tc'_5480 = tc'_45[@i_6004]) then
                event fullCS(hostS, hostT, m7, z_5984, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_5997 <= N4 suchthat defined(z_5984[@i_5997]) && (z_5984[@i_5997] = m13) then
                yield
            orfind @i_4306 <= N3 suchthat defined(z_3226[@i_4306]) && (z_3226[@i_4306] = m7) then
              yield
            orfind @i_4305 <= N suchthat defined(rSK_1427[@i_4305], hostW_46[@i_4305], n'[@i_4305], z_3230[@i_4305], @i_1384[@i_4305]) && ((@i_1384[@i_4305] = @i_183) && (z_3230[@i_4305] = m7)) then
              if (n3_3160 = n'[@i_4305]) then
              if (hostS = hostW_46[@i_4305]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5482: timest;
              new r2_5483: symseed;
              let e12: maxmac = encsym(pad(C, tc'_5482), kgen(rSK_1427[@i_4305]), r2_5483) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5482)) = decsym(m13, kgen(rSK_1427[@i_4305])) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = cst_key in
              new tk_1356: timest;
              new r4_1355: symseed;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new r5_1358: symseed;
              new s_1357: symkeyseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = cst_key in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new r5_1364: symseed;
              new s_1363: symkeyseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = cst_key in
              new tk_1368: timest;
              new r4_1367: symseed;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new r5_1370: symseed;
              new s_1369: symkeyseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new r5_1376: symseed;
              new s_1375: symkeyseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(s3_1360[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          find @i_5527 <= N suchthat defined(z_5511[@i_5527], @i_1385[@i_5527]) && ((@i_1385[@i_5527] = @i_1385) && (z_5511[@i_5527] = m9)) then
            yield
          orfind @i_5522 <= N3, @i_5523 <= N suchthat defined(z_5514[@i_5522, @i_5523], @i_184[@i_5523]) && ((@i_184[@i_5523] = @i_1385) && (z_5514[@i_5522, @i_5523] = m9)) then
            event partTC(hostY_53[@i_1385], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1419: symkeyseed;
              new r10_1421: symseed;
              new tt_1420: timest;
              let e10: maxmac = encsym(concat5(kgen(rSK_1419), tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
              new r11_1422: symseed;
              let z_5518: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1422) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, z_5518);
              out(c8[!_39], (hostY_53[@i_1385], e10, z_5518, acceptT(hostY_53[@i_1385], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1423: symkeyseed;
              let SK_5976: key = cst_key in
              new r10_1424: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
              new r11_1425: symseed;
              let z_5511: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1425) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, z_5511);
              out(c8[!_39], (hostY_53[@i_1385], z_1150, z_5511, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind @i_5521 <= N suchthat defined(z_5518[@i_5521], @i_1385[@i_5521]) && ((@i_1385[@i_5521] = @i_1385) && (z_5518[@i_5521] = m9)) then
            yield
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          find @i_3299 <= N suchthat defined(z_3163[@i_3299], @i_1384[@i_3299]) && ((@i_1384[@i_3299] = @i_1384) && (z_3163[@i_3299] = m9)) then
            yield
          orfind @i_3234 <= N3, @i_3235 <= N suchthat defined(z_3226[@i_3234, @i_3235], @i_183[@i_3235]) && ((@i_183[@i_3235] = @i_1384) && (z_3226[@i_3234, @i_3235] = m9)) then
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              new tt_1428: timest;
              new r10_1429: symseed;
              let e10: maxmac = encsym(concat5(kgen(rSK_1427), tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let z_3230: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1430) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, z_3230);
              out(c8[!_39], (hostY_53[@i_1384], e10, z_3230, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_5978: key = cst_key in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new r11_1433: symseed;
              let z_3163: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1433) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, z_3163);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, z_3163, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3233 <= N suchthat defined(z_3230[@i_3233], @i_1384[@i_3233]) && ((@i_1384[@i_3233] = @i_1384) && (z_3230[@i_3233] = m9)) then
            yield
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(hostY_47[@i_1153], rSK_1423[@i_1153], z_1150[@i_1153], SK_5976[@i_1153]) && (z_1150[@i_1153] = m14) then
        find @i_6130 <= N suchthat defined(z_6115[@i_6130], @i_1153[@i_6130]) && ((@i_1153[@i_6130] = @i_1153) && (z_6115[@i_6130] = m15)) then
          yield
        orfind @i_6123 <= N4, @i_6124 <= N3, @i_6125 <= N suchthat defined(tc'_5640[@i_6123, @i_6124, @i_6125], z_6118[@i_6123, @i_6124, @i_6125], @i_5534[@i_6124, @i_6125]) && ((@i_5534[@i_6124, @i_6125] = @i_1153) && (z_6118[@i_6123, @i_6124, @i_6125] = m15)) then
          let tc'_45: timest = tc'_5640[@i_6123, @i_6124, @i_6125] in
          new r16_5979: symseed;
          let x_6116: maxenc = padts(tc'_45) in
          let z_6115: maxmac = encsym(x_6116, kgen2(rSK_1423[@i_1153]), r16_5979) in
          let e16: maxmac = z_6115 in
          event partSC(hostY_47[@i_1153], m14, m15);
          event fullSC(hostY_47[@i_1153], m14, m15, e16);
          out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
      orfind @i_1153 <= N suchthat defined(hostY_47[@i_1153], rSK_1431[@i_1153], z_1150[@i_1153], SK_5978[@i_1153]) && (z_1150[@i_1153] = m14) then
        find @i_5996 <= N suchthat defined(z_5981[@i_5996], @i_1153[@i_5996]) && ((@i_1153[@i_5996] = @i_1153) && (z_5981[@i_5996] = m15)) then
          yield
        orfind @i_5989 <= N4, @i_5990 <= N3, @i_5991 <= N suchthat defined(tc'_5480[@i_5989, @i_5990, @i_5991], z_5984[@i_5989, @i_5990, @i_5991], @i_4371[@i_5990, @i_5991]) && ((@i_4371[@i_5990, @i_5991] = @i_1153) && (z_5984[@i_5989, @i_5990, @i_5991] = m15)) then
          let tc'_45: timest = tc'_5480[@i_5989, @i_5990, @i_5991] in
          let x_5982: maxenc = padts(tc'_5480[@i_5989, @i_5990, @i_5991]) in
          new r16_5980: symseed;
          let z_5981: maxmac = encsym(x_5982, kgen2(rSK_1431[@i_1153]), r16_5980) in
          event partSC(hostY_47[@i_1153], m14, m15);
          event fullSC(hostY_47[@i_1153], m14, m15, z_5981);
          out(c12[!_40], (z_5981, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying move new all binders yields

Game 119 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKt: symkeyseed;
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2839[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1354[@i_184], z_921[@i_184], AK_2839[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_2843: symseed;
            new tc_2844: timest;
            let e5: maxmac = encsym(pad(C, tc_2844), kgen(s3_1354[@i_184]), r7_2843) in
            event partCT(hostT, TGT_58, e5);
            new n3_2845: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
            event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_2846: symseed;
            new tc'_2847: timest;
            let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2840[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1360[@i_184], z_921[@i_184], AK_2840[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_2998: symseed;
            let z_5514: maxmac = encsym2(Zpad, kgen2(s3_1360[@i_184]), r7_2998) in
            event partCT(hostT, TGT_58, z_5514);
            new n3_3000: nonce;
            out(c4[!_36, !_35], (TGT_58, z_5514, hostS, n3_3000));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_5534 <= N suchthat defined(rSK_1423[@i_5534], hostW_46[@i_5534], n'[@i_5534], z_5511[@i_5534], @i_1385[@i_5534]) && ((@i_1385[@i_5534] = @i_184) && (z_5511[@i_5534] = m7)) then
              if (n3_3000 = n'[@i_5534]) then
              if (hostS = hostW_46[@i_5534]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5640: timest;
              let x_6119: maxenc = pad(C, tc'_5640) in
              new r2_5639: symseed;
              let z_6118: maxmac = encsym(x_6119, kgen2(rSK_1423[@i_5534]), r2_5639) in
              let e12: maxmac = z_6118 in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              find @i_6138 <= N suchthat defined(tc'_45[@i_6138], z_6115[@i_6138], @i_1153[@i_6138]) && ((@i_1153[@i_6138] = @i_5534) && (z_6115[@i_6138] = m13)) then
                if (tc'_5640 = tc'_45[@i_6138]) then
                event fullCS(hostS, hostT, m7, e12, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_6131 <= N4 suchthat defined(z_6118[@i_6131]) && (z_6118[@i_6131] = m13) then
                let @i_6133 <= N = !_35 in
                let @i_6132 <= N3 = !_36
            orfind @i_5529 <= N3 suchthat defined(z_5514[@i_5529]) && (z_5514[@i_5529] = m7) then
              yield
            orfind @i_5528 <= N suchthat defined(rSK_1419[@i_5528], hostW_46[@i_5528], n'[@i_5528], z_5518[@i_5528], @i_1385[@i_5528]) && ((@i_1385[@i_5528] = @i_184) && (z_5518[@i_5528] = m7)) then
              if (n3_3000 = n'[@i_5528]) then
              if (hostS = hostW_46[@i_5528]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5641: symseed;
              new tc'_5642: timest;
              let e12: maxmac = encsym(pad(C, tc'_5642), kgen(rSK_1419[@i_5528]), r2_5641) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5642)) = decsym(m13, kgen(rSK_1419[@i_5528])) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2841[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1366[@i_183], z_753[@i_183], AK_2841[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3003: symseed;
            new tc_3004: timest;
            let e5: maxmac = encsym(pad(C, tc_3004), kgen(s3_1366[@i_183]), r7_3003) in
            event partCT(hostT, TGT_58, e5);
            new n3_3005: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
            event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_3006: symseed;
            new tc'_3007: timest;
            let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2842[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1372[@i_183], z_753[@i_183], AK_2842[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3158: symseed;
            let z_3226: maxmac = encsym2(Zpad, kgen2(s3_1372[@i_183]), r7_3158) in
            event partCT(hostT, TGT_58, z_3226);
            new n3_3160: nonce;
            out(c4[!_36, !_35], (TGT_58, z_3226, hostS, n3_3160));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_4371 <= N suchthat defined(rSK_1431[@i_4371], hostW_46[@i_4371], n'[@i_4371], z_3163[@i_4371], @i_1384[@i_4371]) && ((@i_1384[@i_4371] = @i_183) && (z_3163[@i_4371] = m7)) then
              if (n3_3160 = n'[@i_4371]) then
              if (hostS = hostW_46[@i_4371]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5480: timest;
              let x_5985: maxenc = pad(C, tc'_5480) in
              new r2_5481: symseed;
              let z_5984: maxmac = encsym(x_5985, kgen2(rSK_1431[@i_4371]), r2_5481) in
              event partCS(hostS, hostT, m7, z_5984);
              out(c6[!_37, !_36, !_35], (m6, z_5984));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              find @i_6004 <= N suchthat defined(tc'_45[@i_6004], z_5981[@i_6004], @i_1153[@i_6004]) && ((@i_1153[@i_6004] = @i_4371) && (z_5981[@i_6004] = m13)) then
                if (tc'_5480 = tc'_45[@i_6004]) then
                event fullCS(hostS, hostT, m7, z_5984, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_5997 <= N4 suchthat defined(z_5984[@i_5997]) && (z_5984[@i_5997] = m13) then
                yield
            orfind @i_4306 <= N3 suchthat defined(z_3226[@i_4306]) && (z_3226[@i_4306] = m7) then
              yield
            orfind @i_4305 <= N suchthat defined(rSK_1427[@i_4305], hostW_46[@i_4305], n'[@i_4305], z_3230[@i_4305], @i_1384[@i_4305]) && ((@i_1384[@i_4305] = @i_183) && (z_3230[@i_4305] = m7)) then
              if (n3_3160 = n'[@i_4305]) then
              if (hostS = hostW_46[@i_4305]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5483: symseed;
              new tc'_5482: timest;
              let e12: maxmac = encsym(pad(C, tc'_5482), kgen(rSK_1427[@i_4305]), r2_5483) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5482)) = decsym(m13, kgen(rSK_1427[@i_4305])) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = cst_key in
              new r4_1355: symseed;
              new tk_1356: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new s_1357: symkeyseed;
              new r5_1358: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = cst_key in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new s_1363: symkeyseed;
              new r5_1364: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = cst_key in
              new r4_1367: symseed;
              new tk_1368: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new s_1369: symkeyseed;
              new r5_1370: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new s_1375: symkeyseed;
              new r5_1376: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(s3_1360[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          find @i_5527 <= N suchthat defined(z_5511[@i_5527], @i_1385[@i_5527]) && ((@i_1385[@i_5527] = @i_1385) && (z_5511[@i_5527] = m9)) then
            yield
          orfind @i_5522 <= N3, @i_5523 <= N suchthat defined(z_5514[@i_5522, @i_5523], @i_184[@i_5523]) && ((@i_184[@i_5523] = @i_1385) && (z_5514[@i_5522, @i_5523] = m9)) then
            event partTC(hostY_53[@i_1385], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1419: symkeyseed;
              new tt_1420: timest;
              new r10_1421: symseed;
              let e10: maxmac = encsym(concat5(kgen(rSK_1419), tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
              new r11_1422: symseed;
              let z_5518: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1422) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, z_5518);
              out(c8[!_39], (hostY_53[@i_1385], e10, z_5518, acceptT(hostY_53[@i_1385], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1423: symkeyseed;
              let SK_5976: key = cst_key in
              new r10_1424: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
              new r11_1425: symseed;
              let z_5511: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1425) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, z_5511);
              out(c8[!_39], (hostY_53[@i_1385], z_1150, z_5511, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind @i_5521 <= N suchthat defined(z_5518[@i_5521], @i_1385[@i_5521]) && ((@i_1385[@i_5521] = @i_1385) && (z_5518[@i_5521] = m9)) then
            yield
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          find @i_3299 <= N suchthat defined(z_3163[@i_3299], @i_1384[@i_3299]) && ((@i_1384[@i_3299] = @i_1384) && (z_3163[@i_3299] = m9)) then
            yield
          orfind @i_3234 <= N3, @i_3235 <= N suchthat defined(z_3226[@i_3234, @i_3235], @i_183[@i_3235]) && ((@i_183[@i_3235] = @i_1384) && (z_3226[@i_3234, @i_3235] = m9)) then
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(kgen(rSK_1427), tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let z_3230: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1430) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, z_3230);
              out(c8[!_39], (hostY_53[@i_1384], e10, z_3230, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_5978: key = cst_key in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new r11_1433: symseed;
              let z_3163: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1433) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, z_3163);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, z_3163, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3233 <= N suchthat defined(z_3230[@i_3233], @i_1384[@i_3233]) && ((@i_1384[@i_3233] = @i_1384) && (z_3230[@i_3233] = m9)) then
            yield
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(hostY_47[@i_1153], rSK_1423[@i_1153], z_1150[@i_1153], SK_5976[@i_1153]) && (z_1150[@i_1153] = m14) then
        find @i_6130 <= N suchthat defined(z_6115[@i_6130], @i_1153[@i_6130]) && ((@i_1153[@i_6130] = @i_1153) && (z_6115[@i_6130] = m15)) then
          yield
        orfind @i_6123 <= N4, @i_6124 <= N3, @i_6125 <= N suchthat defined(tc'_5640[@i_6123, @i_6124, @i_6125], z_6118[@i_6123, @i_6124, @i_6125], @i_5534[@i_6124, @i_6125]) && ((@i_5534[@i_6124, @i_6125] = @i_1153) && (z_6118[@i_6123, @i_6124, @i_6125] = m15)) then
          let tc'_45: timest = tc'_5640[@i_6123, @i_6124, @i_6125] in
          let x_6116: maxenc = padts(tc'_45) in
          new r16_5979: symseed;
          let z_6115: maxmac = encsym(x_6116, kgen2(rSK_1423[@i_1153]), r16_5979) in
          let e16: maxmac = z_6115 in
          event partSC(hostY_47[@i_1153], m14, m15);
          event fullSC(hostY_47[@i_1153], m14, m15, e16);
          out(c12[!_40], (e16, acceptS(hostY_47[@i_1153])))
      orfind @i_1153 <= N suchthat defined(hostY_47[@i_1153], rSK_1431[@i_1153], z_1150[@i_1153], SK_5978[@i_1153]) && (z_1150[@i_1153] = m14) then
        find @i_5996 <= N suchthat defined(z_5981[@i_5996], @i_1153[@i_5996]) && ((@i_1153[@i_5996] = @i_1153) && (z_5981[@i_5996] = m15)) then
          yield
        orfind @i_5989 <= N4, @i_5990 <= N3, @i_5991 <= N suchthat defined(tc'_5480[@i_5989, @i_5990, @i_5991], z_5984[@i_5989, @i_5990, @i_5991], @i_4371[@i_5990, @i_5991]) && ((@i_4371[@i_5990, @i_5991] = @i_1153) && (z_5984[@i_5989, @i_5990, @i_5991] = m15)) then
          let tc'_45: timest = tc'_5480[@i_5989, @i_5990, @i_5991] in
          let x_5982: maxenc = padts(tc'_5480[@i_5989, @i_5990, @i_5991]) in
          new r16_5980: symseed;
          let z_5981: maxmac = encsym(x_5982, kgen2(rSK_1431[@i_1153]), r16_5980) in
          event partSC(hostY_47[@i_1153], m14, m15);
          event fullSC(hostY_47[@i_1153], m14, m15, z_5981);
          out(c12[!_40], (z_5981, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


Applying remove assignments of useless yields

Game 120 is
in(start, ());
new rkC: keyseed;
let pkC: pkey = pkgen2(rkC) in
new rkCs: skeyseed;
let spkC: spkey = spkgen2(rkCs) in
new rkKs: skeyseed;
let spkK: spkey = spkgen2(rkKs) in
new rkCA: skeyseed;
let pkCA: spkey = spkgen2(rkCA) in
let x_90: sblocksize = concat1(C, pkC, spkC) in
new q1: sseed;
let certC: signature = sign2(x_90, sskgen2(rkCA), q1) in
new rKt: symkeyseed;
new rKs: symkeyseed;
out(c25, (pkC, spkC, spkK, pkCA));
(
  (
    (
      (
        (
          ! !_35 <= N
          in(c1[!_35], hostT: tgs);
          new n2: nonce;
          let x_121: sblocksize = padno(n2) in
          new r1: sseed;
          new n1: nonce;
          out(c2[!_35], (C, pkC, spkC, certC, n2, sign2(x_121, sskgen2(rkCs), r1), C, hostT, n1));
          in(c3[!_35], (m21: bitstring, =C, TGT_58: maxmac, m24: maxmac));
          find @i_184 <= N suchthat defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2839[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1354[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2839[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1354[@i_184], z_921[@i_184], AK_2839[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_2843: symseed;
            new tc_2844: timest;
            let e5: maxmac = encsym(pad(C, tc_2844), kgen(s3_1354[@i_184]), r7_2843) in
            event partCT(hostT, TGT_58, e5);
            new n3_2845: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_2845));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_2845, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1354[@i_184])) in
            event fullCT(hostT, hostS, n3_2845, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_2846: symseed;
            new tc'_2847: timest;
            let e12: maxmac = encsym(pad(C, tc'_2847), SK_63, r2_2846) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_2847)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_184 <= N suchthat defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], m2_169[@i_184], AK_2840[@i_184]) && (m21 = m2_169[@i_184]) then
            let hostZ: kas = K in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1360[@i_184], z_921[@i_184], n5[@i_184], hostW_52[@i_184], ms4[@i_184], ms3[@i_184], AK_2840[@i_184]) && ((certC = ms3[@i_184]) && ((!_35 = @i_123[@i_184]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_184]) && ((hostT = hostW_52[@i_184]) && (n1 = n5[@i_184]))))) then
            if defined(s3_1360[@i_184], z_921[@i_184], AK_2840[@i_184]) && (z_921[@i_184] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_2998: symseed;
            let z_5514: maxmac = encsym2(Zpad, kgen2(s3_1360[@i_184]), r7_2998) in
            event partCT(hostT, TGT_58, z_5514);
            new n3_3000: nonce;
            out(c4[!_36, !_35], (TGT_58, z_5514, hostS, n3_3000));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_5534 <= N suchthat defined(rSK_1423[@i_5534], hostW_46[@i_5534], n'[@i_5534], z_5511[@i_5534], @i_1385[@i_5534]) && ((@i_1385[@i_5534] = @i_184) && (z_5511[@i_5534] = m7)) then
              if (n3_3000 = n'[@i_5534]) then
              if (hostS = hostW_46[@i_5534]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5640: timest;
              let x_6119: maxenc = pad(C, tc'_5640) in
              new r2_5639: symseed;
              let z_6118: maxmac = encsym(x_6119, kgen2(rSK_1423[@i_5534]), r2_5639) in
              event partCS(hostS, hostT, m7, z_6118);
              out(c6[!_37, !_36, !_35], (m6, z_6118));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              find @i_6138 <= N suchthat defined(tc'_45[@i_6138], z_6115[@i_6138], @i_1153[@i_6138]) && ((@i_1153[@i_6138] = @i_5534) && (z_6115[@i_6138] = m13)) then
                if (tc'_5640 = tc'_45[@i_6138]) then
                event fullCS(hostS, hostT, m7, z_6118, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_6131 <= N4 suchthat defined(z_6118[@i_6131]) && (z_6118[@i_6131] = m13) then
                yield
            orfind @i_5529 <= N3 suchthat defined(z_5514[@i_5529]) && (z_5514[@i_5529] = m7) then
              yield
            orfind @i_5528 <= N suchthat defined(rSK_1419[@i_5528], hostW_46[@i_5528], n'[@i_5528], z_5518[@i_5528], @i_1385[@i_5528]) && ((@i_1385[@i_5528] = @i_184) && (z_5518[@i_5528] = m7)) then
              if (n3_3000 = n'[@i_5528]) then
              if (hostS = hostW_46[@i_5528]) then
              event fullCT(hostT, hostS, n3_3000, TGT_58, z_5514, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5641: symseed;
              new tc'_5642: timest;
              let e12: maxmac = encsym(pad(C, tc'_5642), kgen(rSK_1419[@i_5528]), r2_5641) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5642)) = decsym(m13, kgen(rSK_1419[@i_5528])) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2841[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1366[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2841[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1366[@i_183], z_753[@i_183], AK_2841[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3003: symseed;
            new tc_3004: timest;
            let e5: maxmac = encsym(pad(C, tc_3004), kgen(s3_1366[@i_183]), r7_3003) in
            event partCT(hostT, TGT_58, e5);
            new n3_3005: nonce;
            out(c4[!_36, !_35], (TGT_58, e5, hostS, n3_3005));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            let injbot2(concat8(SK_63: key, =n3_3005, tt_62: timest, =hostS)) = decsym(m7, kgen(s3_1366[@i_183])) in
            event fullCT(hostT, hostS, n3_3005, TGT_58, e5, m7);
            out(c19[!_36, !_35], acceptC2(hostT, hostS));
            ! !_37 <= N4
            in(c20[!_37, !_36, !_35], hostS': server);
            if (hostS' = hostS) then
            new r2_3006: symseed;
            new tc'_3007: timest;
            let e12: maxmac = encsym(pad(C, tc'_3007), SK_63, r2_3006) in
            event partCS(hostS, hostT, m7, e12);
            out(c6[!_37, !_36, !_35], (m6, e12));
            in(c9[!_37, !_36, !_35], (m13: maxmac));
            let injbot2(padts(=tc'_3007)) = decsym(m13, SK_63) in
            event fullCS(hostS, hostT, m7, e12, m13);
            out(c10[!_37, !_36, !_35], acceptC3(hostS'))
          orfind @i_183 <= N suchthat defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], m2_174[@i_183], AK_2842[@i_183]) && (m21 = m2_174[@i_183]) then
            let hostZ: kas = K in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) then
            let x_119: sblocksize = padno(n2) in
            if defined(s3_1372[@i_183], z_753[@i_183], n5[@i_183], hostW_52[@i_183], ms4[@i_183], ms3[@i_183], AK_2842[@i_183]) && ((certC = ms3[@i_183]) && ((!_35 = @i_123[@i_183]) && ((sign2(x_119, sskgen2(rkCs), r1) = ms4[@i_183]) && ((hostT = hostW_52[@i_183]) && (n1 = n5[@i_183]))))) then
            if defined(s3_1372[@i_183], z_753[@i_183], AK_2842[@i_183]) && (z_753[@i_183] = m24) then
            event fullCK(hostZ, hostT, n1, m21, TGT_58, m24);
            out(c18[!_35], acceptC1(hostZ, hostT));
            ! !_36 <= N3
            in(c17[!_36, !_35], (hosT': tgs, hostS: server));
            if (hosT' = hostT) then
            new r7_3158: symseed;
            let z_3226: maxmac = encsym2(Zpad, kgen2(s3_1372[@i_183]), r7_3158) in
            event partCT(hostT, TGT_58, z_3226);
            new n3_3160: nonce;
            out(c4[!_36, !_35], (TGT_58, z_3226, hostS, n3_3160));
            in(c5[!_36, !_35], (=C, m6: maxmac, m7: maxmac));
            find @i_4371 <= N suchthat defined(rSK_1431[@i_4371], hostW_46[@i_4371], n'[@i_4371], z_3163[@i_4371], @i_1384[@i_4371]) && ((@i_1384[@i_4371] = @i_183) && (z_3163[@i_4371] = m7)) then
              if (n3_3160 = n'[@i_4371]) then
              if (hostS = hostW_46[@i_4371]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new tc'_5480: timest;
              let x_5985: maxenc = pad(C, tc'_5480) in
              new r2_5481: symseed;
              let z_5984: maxmac = encsym(x_5985, kgen2(rSK_1431[@i_4371]), r2_5481) in
              event partCS(hostS, hostT, m7, z_5984);
              out(c6[!_37, !_36, !_35], (m6, z_5984));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              find @i_6004 <= N suchthat defined(tc'_45[@i_6004], z_5981[@i_6004], @i_1153[@i_6004]) && ((@i_1153[@i_6004] = @i_4371) && (z_5981[@i_6004] = m13)) then
                if (tc'_5480 = tc'_45[@i_6004]) then
                event fullCS(hostS, hostT, m7, z_5984, m13);
                out(c10[!_37, !_36, !_35], acceptC3(hostS'))
              orfind @i_5997 <= N4 suchthat defined(z_5984[@i_5997]) && (z_5984[@i_5997] = m13) then
                yield
            orfind @i_4306 <= N3 suchthat defined(z_3226[@i_4306]) && (z_3226[@i_4306] = m7) then
              yield
            orfind @i_4305 <= N suchthat defined(rSK_1427[@i_4305], hostW_46[@i_4305], n'[@i_4305], z_3230[@i_4305], @i_1384[@i_4305]) && ((@i_1384[@i_4305] = @i_183) && (z_3230[@i_4305] = m7)) then
              if (n3_3160 = n'[@i_4305]) then
              if (hostS = hostW_46[@i_4305]) then
              event fullCT(hostT, hostS, n3_3160, TGT_58, z_3226, m7);
              out(c19[!_36, !_35], acceptC2(hostT, hostS));
              ! !_37 <= N4
              in(c20[!_37, !_36, !_35], hostS': server);
              if (hostS' = hostS) then
              new r2_5483: symseed;
              new tc'_5482: timest;
              let e12: maxmac = encsym(pad(C, tc'_5482), kgen(rSK_1427[@i_4305]), r2_5483) in
              event partCS(hostS, hostT, m7, e12);
              out(c6[!_37, !_36, !_35], (m6, e12));
              in(c9[!_37, !_36, !_35], (m13: maxmac));
              let injbot2(padts(=tc'_5482)) = decsym(m13, kgen(rSK_1427[@i_4305])) in
              event fullCS(hostS, hostT, m7, e12, m13);
              out(c10[!_37, !_36, !_35], acceptC3(hostS'))
        |
          ! !_38 <= N
          in(c22[!_38], (hostY_53: client, pkY: pkey, spkY: spkey, ms3: signature, n4: nonce, ms4: signature, hostV: client, hostW_52: tgs, n5: nonce));
          if (hostV = hostY_53) then
          if (((hostY_53 = C) && ((pkY = pkC) && (spkY = spkC))) && check2(concat1(hostY_53, pkY, spkY), pkCA, ms3)) then
          find @i_123 <= N suchthat defined(n2[@i_123], x_119[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1354: symkeyseed;
              let AK_2839: key = cst_key in
              new r4_1355: symseed;
              new tk_1356: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1354), tk_1356, hostY_53), Lkey[j1], r4_1355) in
              new s_1357: symkeyseed;
              new r5_1358: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1357), r5_1358) in
              new r7_1359: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1359) in
              let m5: bitstring = (m2_169, hostY_53, TGT_56, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, TGT_56, z_921);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1360: symkeyseed;
              let AK_2840: key = cst_key in
              new r4_1361: symseed;
              let z_1378: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1361) in
              new s_1363: symkeyseed;
              new r5_1364: symseed;
              let z_921: maxmac = encsym2(Zconcat4, kgen2(s_1363), r5_1364) in
              new r7_1365: seed;
              let m2_169: bitstring = enc2(Z, pkY, r7_1365) in
              let m5: bitstring = (m2_169, hostY_53, z_1378, z_921) in
              event fullKC(hostY_53, hostW_52, n5, m2_169, z_1378, z_921);
              out(c23[!_38], m5)
          orfind @i_123 <= N suchthat defined(n2[@i_123], x_121[@i_123]) && ((n4 = n2[@i_123]) && check2(padno(n4), spkY, ms4)) then
            find j1 <= N2 suchthat defined(Lkey[j1], Lhost[j1], Qkey_1352[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1366: symkeyseed;
              let AK_2841: key = cst_key in
              new r4_1367: symseed;
              new tk_1368: timest;
              let TGT_56: maxmac = encsym(concat5(kgen(s3_1366), tk_1368, hostY_53), Lkey[j1], r4_1367) in
              new s_1369: symkeyseed;
              new r5_1370: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1369), r5_1370) in
              new r7_1371: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1371) in
              let m5: bitstring = (m2_174, hostY_53, TGT_56, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, TGT_56, z_753);
              out(c23[!_38], m5)
            orfind j1 <= N2 suchthat defined(Lhost[j1], Qkey_1353[j1]) && (Lhost[j1] = hostW_52) then
              new s3_1372: symkeyseed;
              let AK_2842: key = cst_key in
              new r4_1373: symseed;
              let z_1381: maxmac = encsym2(Zconcat5, kgen2(rKt), r4_1373) in
              new s_1375: symkeyseed;
              new r5_1376: symseed;
              let z_753: maxmac = encsym2(Zconcat4, kgen2(s_1375), r5_1376) in
              new r7_1377: seed;
              let m2_174: bitstring = enc2(Z, pkY, r7_1377) in
              let m5: bitstring = (m2_174, hostY_53, z_1381, z_753) in
              event fullKC(hostY_53, hostW_52, n5, m2_174, z_1381, z_753);
              out(c23[!_38], m5)
        )
      |
        ! !_39 <= N
        in(c7[!_39], (m8: maxmac, m9: maxmac, hostW_46: server, n': nonce));
        find @i_1385 <= N suchthat defined(s3_1360[@i_1385], hostY_53[@i_1385], z_1378[@i_1385]) && (z_1378[@i_1385] = m8) then
          let hostY_47: client = hostY_53[@i_1385] in
          find @i_5527 <= N suchthat defined(z_5511[@i_5527], @i_1385[@i_5527]) && ((@i_1385[@i_5527] = @i_1385) && (z_5511[@i_5527] = m9)) then
            yield
          orfind @i_5522 <= N3, @i_5523 <= N suchthat defined(z_5514[@i_5522, @i_5523], @i_184[@i_5523]) && ((@i_184[@i_5523] = @i_1385) && (z_5514[@i_5522, @i_5523] = m9)) then
            event partTC(hostY_53[@i_1385], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1419: symkeyseed;
              new tt_1420: timest;
              new r10_1421: symseed;
              let e10: maxmac = encsym(concat5(kgen(rSK_1419), tt_1420, hostY_53[@i_1385]), Mkey[j3], r10_1421) in
              new r11_1422: symseed;
              let z_5518: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1422) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, e10, z_5518);
              out(c8[!_39], (hostY_53[@i_1385], e10, z_5518, acceptT(hostY_53[@i_1385], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1423: symkeyseed;
              let SK_5976: key = cst_key in
              new r10_1424: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1424) in
              new r11_1425: symseed;
              let z_5511: maxmac = encsym2(Zconcat8, kgen2(s3_1360[@i_1385]), r11_1425) in
              event fullTC(hostY_53[@i_1385], hostW_46, n', m8, m9, z_1150, z_5511);
              out(c8[!_39], (hostY_53[@i_1385], z_1150, z_5511, acceptT(hostY_53[@i_1385], hostW_46)))
          orfind @i_5521 <= N suchthat defined(z_5518[@i_5521], @i_1385[@i_5521]) && ((@i_1385[@i_5521] = @i_1385) && (z_5518[@i_5521] = m9)) then
            yield
        orfind @i_1384 <= N suchthat defined(s3_1372[@i_1384], hostY_53[@i_1384], z_1381[@i_1384]) && (z_1381[@i_1384] = m8) then
          let hostY_47: client = hostY_53[@i_1384] in
          find @i_3299 <= N suchthat defined(z_3163[@i_3299], @i_1384[@i_3299]) && ((@i_1384[@i_3299] = @i_1384) && (z_3163[@i_3299] = m9)) then
            yield
          orfind @i_3234 <= N3, @i_3235 <= N suchthat defined(z_3226[@i_3234, @i_3235], @i_183[@i_3235]) && ((@i_183[@i_3235] = @i_1384) && (z_3226[@i_3234, @i_3235] = m9)) then
            event partTC(hostY_53[@i_1384], m8, m9);
            find j3 <= N2 suchthat defined(Mkey[j3], Mhost2[j3], Mhost1[j3], Pkey_1140[j3]) && ((Mhost1[j3] = T) && (Mhost2[j3] = hostW_46)) then
              new rSK_1427: symkeyseed;
              new r10_1429: symseed;
              new tt_1428: timest;
              let e10: maxmac = encsym(concat5(kgen(rSK_1427), tt_1428, hostY_53[@i_1384]), Mkey[j3], r10_1429) in
              new r11_1430: symseed;
              let z_3230: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1430) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, e10, z_3230);
              out(c8[!_39], (hostY_53[@i_1384], e10, z_3230, acceptT(hostY_53[@i_1384], hostW_46)))
            orfind j3 <= N2 suchthat defined(Mhost2[j3], Pkey_1141[j3]) && (Mhost2[j3] = hostW_46) then
              new rSK_1431: symkeyseed;
              let SK_5978: key = cst_key in
              new r10_1432: symseed;
              let z_1150: maxmac = encsym2(Zconcat5, kgen2(rKs), r10_1432) in
              new r11_1433: symseed;
              let z_3163: maxmac = encsym2(Zconcat8, kgen2(s3_1372[@i_1384]), r11_1433) in
              event fullTC(hostY_53[@i_1384], hostW_46, n', m8, m9, z_1150, z_3163);
              out(c8[!_39], (hostY_53[@i_1384], z_1150, z_3163, acceptT(hostY_53[@i_1384], hostW_46)))
          orfind @i_3233 <= N suchthat defined(z_3230[@i_3233], @i_1384[@i_3233]) && ((@i_1384[@i_3233] = @i_1384) && (z_3230[@i_3233] = m9)) then
            yield
      )
    |
      ! !_40 <= N
      in(c11[!_40], (m14: maxmac, m15: maxmac));
      find @i_1153 <= N suchthat defined(hostY_47[@i_1153], rSK_1423[@i_1153], z_1150[@i_1153], SK_5976[@i_1153]) && (z_1150[@i_1153] = m14) then
        find @i_6130 <= N suchthat defined(z_6115[@i_6130], @i_1153[@i_6130]) && ((@i_1153[@i_6130] = @i_1153) && (z_6115[@i_6130] = m15)) then
          yield
        orfind @i_6123 <= N4, @i_6124 <= N3, @i_6125 <= N suchthat defined(tc'_5640[@i_6123, @i_6124, @i_6125], z_6118[@i_6123, @i_6124, @i_6125], @i_5534[@i_6124, @i_6125]) && ((@i_5534[@i_6124, @i_6125] = @i_1153) && (z_6118[@i_6123, @i_6124, @i_6125] = m15)) then
          let tc'_45: timest = tc'_5640[@i_6123, @i_6124, @i_6125] in
          let x_6116: maxenc = padts(tc'_5640[@i_6123, @i_6124, @i_6125]) in
          new r16_5979: symseed;
          let z_6115: maxmac = encsym(x_6116, kgen2(rSK_1423[@i_1153]), r16_5979) in
          event partSC(hostY_47[@i_1153], m14, m15);
          event fullSC(hostY_47[@i_1153], m14, m15, z_6115);
          out(c12[!_40], (z_6115, acceptS(hostY_47[@i_1153])))
      orfind @i_1153 <= N suchthat defined(hostY_47[@i_1153], rSK_1431[@i_1153], z_1150[@i_1153], SK_5978[@i_1153]) && (z_1150[@i_1153] = m14) then
        find @i_5996 <= N suchthat defined(z_5981[@i_5996], @i_1153[@i_5996]) && ((@i_1153[@i_5996] = @i_1153) && (z_5981[@i_5996] = m15)) then
          yield
        orfind @i_5989 <= N4, @i_5990 <= N3, @i_5991 <= N suchthat defined(tc'_5480[@i_5989, @i_5990, @i_5991], z_5984[@i_5989, @i_5990, @i_5991], @i_4371[@i_5990, @i_5991]) && ((@i_4371[@i_5990, @i_5991] = @i_1153) && (z_5984[@i_5989, @i_5990, @i_5991] = m15)) then
          let tc'_45: timest = tc'_5480[@i_5989, @i_5990, @i_5991] in
          let x_5982: maxenc = padts(tc'_5480[@i_5989, @i_5990, @i_5991]) in
          new r16_5980: symseed;
          let z_5981: maxmac = encsym(x_5982, kgen2(rSK_1431[@i_1153]), r16_5980) in
          event partSC(hostY_47[@i_1153], m14, m15);
          event fullSC(hostY_47[@i_1153], m14, m15, z_5981);
          out(c12[!_40], (z_5981, acceptS(hostY_47[@i_1153])))
    )
  |
    ! !_41 <= N2
    in(c21[!_41], (Lhost: tgs, Lkey: key));
    if (Lhost = T) then
      let Qkey_1353: key = cst_key
    else
      let Qkey_1352: key = cst_key
  )
|
  ! !_42 <= N2
  in(c16[!_42], (Mhost1: tgs, Mhost2: server, Mkey: key));
  if ((Mhost1 = T) && (Mhost2 = S)) then
    let Pkey_1141: key = cst_key
  else
    let Pkey_1140: key = cst_key
)


RESULT Proved event fullCS(S, T, z, y, w) ==> fullSC(C, x, y', w) with probability N3 * N * N3 * N / |nonce| + N * Pencctxt(time + time(context for game 116), N + N4 * N3 * N, N + N4 * N3 * N) + N * Pencctxt(time + time(context for game 112), N + N4 * N3 * N, N + N4 * N3 * N) + N * Penc(time + time(context for game 102), N + N3 * N) + N * Penc(time + time(context for game 98), N + N3 * N) + N * N / |nonce| + 2. * N * N3 / |nonce| + N * Pencctxt(time + time(context for game 93), N + N3 * N, N + N3 * N) + N * Pencctxt(time + time(context for game 89), N + N3 * N, N + N3 * N) + Penc(time + time(context for game 79), N) + Pencctxt(time + time(context for game 75), N, N) + Penc(time + time(context for game 68), N) + Pencctxt(time + time(context for game 64), N, N) + N * Penc(time + time(context for game 57), 1.) + 2. * N / |nonce| + N * Pencctxt(time + time(context for game 52), 1., N) + N * Penc(time + time(context for game 47), 1.) + N * Pencctxt(time + time(context for game 43), 1., N) + N * Pmac(time + time(context for game 38), 1., N) + N * Pmac(time + time(context for game 33), 1., N) + N * pPRF(time + time(context for game 27), 2. * 1. + 2. * N) + N * pPRF(time + time(context for game 22), 2. * 1. + 2. * N) + 3. * 1. / |skeyseed| + 3. * Psigncoll + Psign(time + time(context for game 18), 0) + N * Penc(time + time(context for game 14), N) + Psign(time + time(context for game 9), N) + Psign(time + time(context for game 5), 2. * 1.)
RESULT Proved event partSC(C, z, y) ==> (partCS(S, T, x, y)&&fullTC(C, S, N, v, v', z, w)) with probability N3 * N * N3 * N / |nonce| + N * Pencctxt(time + time(context for game 116), N + N4 * N3 * N, N + N4 * N3 * N) + N * Pencctxt(time + time(context for game 112), N + N4 * N3 * N, N + N4 * N3 * N) + N * Penc(time + time(context for game 102), N + N3 * N) + N * Penc(time + time(context for game 98), N + N3 * N) + N * N / |nonce| + 2. * N * N3 / |nonce| + N * Pencctxt(time + time(context for game 93), N + N3 * N, N + N3 * N) + N * Pencctxt(time + time(context for game 89), N + N3 * N, N + N3 * N) + Penc(time + time(context for game 79), N) + Pencctxt(time + time(context for game 75), N, N) + Penc(time + time(context for game 68), N) + Pencctxt(time + time(context for game 64), N, N) + N * Penc(time + time(context for game 57), 1.) + 2. * N / |nonce| + N * Pencctxt(time + time(context for game 52), 1., N) + N * Penc(time + time(context for game 47), 1.) + N * Pencctxt(time + time(context for game 43), 1., N) + N * Pmac(time + time(context for game 38), 1., N) + N * Pmac(time + time(context for game 33), 1., N) + N * pPRF(time + time(context for game 27), 2. * 1. + 2. * N) + N * pPRF(time + time(context for game 22), 2. * 1. + 2. * N) + 3. * 1. / |skeyseed| + 3. * Psigncoll + Psign(time + time(context for game 18), 0) + N * Penc(time + time(context for game 14), N) + Psign(time + time(context for game 9), N) + Psign(time + time(context for game 5), 2. * 1.)
RESULT time(context for game 5) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + 2. * time(let concat5) * N + 4. * time(= client) * N + 2. * time(let pad) * N + 5. * time(let injbot2) * N + 5. * time(decsym) * N + time(padts) * N + 5. * time(encsym) * N + time(acceptS) * N + 2. * time(kgen) * N + 2. * time(concat5) * N + time(concat8) * N + time(acceptT) * N + N2 * time(= server) * N + 2. * N2 * time(= tgs) * N + N2 * time(T) * N + time(concat1) * N + 3. * time(padno) * N + 2. * time(un1) * N + 2. * time(un2) * N + 4. * time(keyderivation) * N + time(concat4) * N + 2. * time(concat6) * N + time(mac) * N + 2. * time(concat3) * N + 3. * time(sign) * N + time(K) * N + time(concat2) * N + time(enc) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 5: e21[!_38])) * N + time(let concat2) * N + time(let injbot1) * N + time(dec, maxlength(game 5: m21[!_35])) * N + time(concat7) * N + 5. * time(C) * N + time(checkmac) * N + time(= nonce) * N + time(= tgs) * N + time(let concat4) * N + time(acceptC1) * N + time(= server) * N4 * N3 * N + time(C) * N4 * N3 * N + time(pad) * N4 * N3 * N + time(encsym) * N4 * N3 * N + time(= timest) * N4 * N3 * N + time(let padts) * N4 * N3 * N + time(let injbot2) * N4 * N3 * N + time(decsym) * N4 * N3 * N + time(acceptC3) * N4 * N3 * N + time(acceptC2) * N3 * N + time(decsym) * N3 * N + time(let injbot2) * N3 * N + time(let concat8) * N3 * N + time(= server) * N3 * N + time(= nonce) * N3 * N + time(= client) * N3 * N + 2. * time(C) * N3 * N + time(encsym) * N3 * N + time(pad) * N3 * N + time(= tgs) * N3 * N + time(concat7) + time(K) + time(concat1) + time(C) + 2. * time(kgen) + 2. * time(sskgen) + 2. * time(spkgen) + 2. * time(pkgen) + time(skgen)
RESULT time(context for game 9) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + 2. * time(let concat5) * N + 5. * time(= client) * N + 2. * time(let pad) * N + 5. * time(let injbot2) * N + 5. * time(decsym) * N + time(padts) * N + 5. * time(encsym) * N + time(acceptS) * N + 2. * time(kgen) * N + 2. * time(concat5) * N + time(concat8) * N + time(acceptT) * N + N2 * time(= server) * N + 2. * N2 * time(= tgs) * N + N2 * time(T) * N + 6. * time(C) * N + 2. * time(= pkey) * N + time(concat1) * N + 2. * time(check2) * N + 2. * time(spkgen2) * N + 4. * time(= spkey) * N + 3. * time(padno) * N + 2. * time(un1) * N + 2. * time(un2) * N + 4. * time(keyderivation) * N + time(concat4) * N + 2. * time(concat6) * N + time(mac) * N + 2. * time(concat3) * N + time(sign) * N + 2. * time(K) * N + time(concat2) * N + time(enc) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 9: e21[!_38])) * N + time(let concat2) * N + time(let injbot1) * N + time(dec, maxlength(game 9: m21[!_35])) * N + time(= kas) * N + time(concat7) * N + time(checkmac) * N + time(= nonce) * N + time(= tgs) * N + time(let concat4) * N + time(acceptC1) * N + time(= server) * N4 * N3 * N + time(C) * N4 * N3 * N + time(pad) * N4 * N3 * N + time(encsym) * N4 * N3 * N + time(= timest) * N4 * N3 * N + time(let padts) * N4 * N3 * N + time(let injbot2) * N4 * N3 * N + time(decsym) * N4 * N3 * N + time(acceptC3) * N4 * N3 * N + time(acceptC2) * N3 * N + time(decsym) * N3 * N + time(let injbot2) * N3 * N + time(let concat8) * N3 * N + time(= server) * N3 * N + time(= nonce) * N3 * N + time(= client) * N3 * N + 2. * time(C) * N3 * N + time(encsym) * N3 * N + time(pad) * N3 * N + time(= tgs) * N3 * N + 2. * time(sign2) + 2. * time(sskgen2) + time(concat7) + time(K) + time(concat1) + time(C) + 2. * time(kgen) + time(spkgen2) + time(sskgen) + time(spkgen) + 2. * time(pkgen) + time(skgen)
RESULT time(context for game 14) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + 2. * time(let concat5) * N + 5. * time(= client) * N + 2. * time(let pad) * N + 5. * time(let injbot2) * N + 5. * time(decsym) * N + time(padts) * N + 5. * time(encsym) * N + time(acceptS) * N + 2. * time(kgen) * N + 2. * time(concat5) * N + time(concat8) * N + time(acceptT) * N + N2 * time(= server) * N + 2. * N2 * time(= tgs) * N + N2 * time(T) * N + 6. * time(C) * N + 2. * time(= pkey) * N + 4. * time(= spkey) * N + time(concat1) * N + 2. * time(check2) * N + 2. * time(un1) * N + 2. * time(un2) * N + 4. * time(keyderivation) * N + time(concat4) * N + 2. * time(concat6) * N + time(mac) * N + 2. * time(concat3) * N + time(sign) * N + 2. * time(K) * N + time(concat2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 14: e21[!_38])) * N + 2. * N * N * time(check2) + 2. * N * N * time(padno) + 2. * N * N * time(= nonce) + time(let concat2) * N + time(let injbot1) * N + time(= kas) * N + time(concat7) * N + 2. * time(spkgen2) * N + time(check) * N + 2. * time(padno) * N + 2. * time(sskgen2) * N + 2. * time(sign2) * N + time(checkmac) * N + time(= nonce) * N + time(= tgs) * N + time(let concat4) * N + time(acceptC1) * N + time(= server) * N4 * N3 * N + time(C) * N4 * N3 * N + time(pad) * N4 * N3 * N + time(encsym) * N4 * N3 * N + time(= timest) * N4 * N3 * N + time(let padts) * N4 * N3 * N + time(let injbot2) * N4 * N3 * N + time(decsym) * N4 * N3 * N + time(acceptC3) * N4 * N3 * N + time(acceptC2) * N3 * N + time(decsym) * N3 * N + time(let injbot2) * N3 * N + time(let concat8) * N3 * N + time(= server) * N3 * N + time(= nonce) * N3 * N + time(= client) * N3 * N + 2. * time(C) * N3 * N + time(encsym) * N3 * N + time(pad) * N3 * N + time(= tgs) * N3 * N + 2. * time(sign2) + 2. * time(sskgen2) + time(concat7) + time(K) + time(concat1) + time(C) + 2. * time(kgen) + 2. * time(spkgen2) + time(sskgen) + time(spkgen) + time(pkgen)
RESULT time(context for game 18) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + 2. * time(let concat5) * N + 5. * time(= client) * N + 2. * time(let pad) * N + 5. * time(let injbot2) * N + 5. * time(decsym) * N + time(padts) * N + 5. * time(encsym) * N + time(acceptS) * N + 2. * time(kgen) * N + 2. * time(concat5) * N + time(concat8) * N + time(acceptT) * N + N2 * time(= server) * N + 2. * N2 * time(= tgs) * N + N2 * time(T) * N + 6. * time(C) * N + 2. * time(= pkey) * N + 4. * time(= spkey) * N + time(concat1) * N + 2. * time(check2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 18: m2_169[!_38])) * N + 2. * time(un1) * N + 2. * time(un2) * N + 4. * time(keyderivation) * N + time(concat4) * N + 2. * time(concat6) * N + time(mac) * N + time(Z) * N + time(enc2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 18: m2_174[!_38])) * N + 2. * N * N * time(check2) + 2. * N * N * time(padno) + 2. * N * N * time(= nonce) + time(let concat2) * N + time(let injbot1) * N + time(skgen2) * N + time(dec2, maxlength(game 18: m21[!_35])) * N + time(K) * N + time(= kas) * N + time(concat7) * N + 2. * time(spkgen2) * N + time(concat3) * N + 2. * time(padno) * N + 2. * time(sskgen2) * N + 2. * time(sign2) * N + time(checkmac) * N + time(= nonce) * N + time(= tgs) * N + time(let concat4) * N + time(acceptC1) * N + time(= server) * N4 * N3 * N + time(C) * N4 * N3 * N + time(pad) * N4 * N3 * N + time(encsym) * N4 * N3 * N + time(= timest) * N4 * N3 * N + time(let padts) * N4 * N3 * N + time(let injbot2) * N4 * N3 * N + time(decsym) * N4 * N3 * N + time(acceptC3) * N4 * N3 * N + time(acceptC2) * N3 * N + time(decsym) * N3 * N + time(let injbot2) * N3 * N + time(let concat8) * N3 * N + time(= server) * N3 * N + time(= nonce) * N3 * N + time(= client) * N3 * N + 2. * time(C) * N3 * N + time(encsym) * N3 * N + time(pad) * N3 * N + time(= tgs) * N3 * N + N * N * time(= bitstring, maxlength(game 18: m21[!_35]), maxlength(game 18: m2_174[!_38])) + N * N * time(= bitstring, maxlength(game 18: m21[!_35]), maxlength(game 18: m2_169[!_38])) + time(sign2) + time(sskgen2) + time(concat1) + time(C) + 2. * time(kgen) + 2. * time(spkgen2) + time(pkgen) + time(pkgen2)
RESULT time(context for game 22) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + 2. * time(let concat5) * N + 5. * time(= client) * N + 2. * time(let pad) * N + 5. * time(let injbot2) * N + 5. * time(decsym) * N + time(padts) * N + 5. * time(encsym) * N + time(acceptS) * N + 2. * time(kgen) * N + 2. * time(concat5) * N + time(concat8) * N + time(acceptT) * N + N2 * time(= server) * N + 2. * N2 * time(= tgs) * N + N2 * time(T) * N + 6. * time(C) * N + time(= pkey) * N + time(= spkey) * N + time(concat1) * N + time(check2) * N + 4. * time(keyderivation) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 22: m2_169[!_38])) * N + 2. * time(un1) * N + 2. * time(un2) * N + time(concat4) * N + 2. * time(concat6) * N + time(mac) * N + time(Z) * N + time(enc2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 22: m2_174[!_38])) * N + 2. * N * N * time(check2) + 2. * N * N * time(padno) + 2. * N * N * time(= nonce) + time(K) * N + 2. * time(padno) * N + 2. * time(sskgen2) * N + 2. * time(sign2) * N + time(checkmac) * N + time(= nonce) * N + time(= tgs) * N + time(let concat4) * N + time(acceptC1) * N + time(= server) * N4 * N3 * N + time(C) * N4 * N3 * N + time(pad) * N4 * N3 * N + time(encsym) * N4 * N3 * N + time(= timest) * N4 * N3 * N + time(let padts) * N4 * N3 * N + time(let injbot2) * N4 * N3 * N + time(decsym) * N4 * N3 * N + time(acceptC3) * N4 * N3 * N + time(acceptC2) * N3 * N + time(decsym) * N3 * N + time(let injbot2) * N3 * N + time(let concat8) * N3 * N + time(= server) * N3 * N + time(= nonce) * N3 * N + time(= client) * N3 * N + 2. * time(C) * N3 * N + time(encsym) * N3 * N + time(pad) * N3 * N + time(= tgs) * N3 * N + N * N * time(= bitstring, maxlength(game 22: m21[!_35]), maxlength(game 22: m2_174[!_38])) + N * N * time(= bitstring, maxlength(game 22: m21[!_35]), maxlength(game 22: m2_169[!_38])) + time(sign2) + time(sskgen2) + time(concat1) + time(C) + 2. * time(kgen) + 3. * time(spkgen2) + time(pkgen2)
RESULT time(context for game 27) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + 2. * time(let concat5) * N + 5. * time(= client) * N + 2. * time(let pad) * N + 5. * time(let injbot2) * N + 5. * time(decsym) * N + time(padts) * N + 5. * time(encsym) * N + time(acceptS) * N + 4. * time(kgen) * N + 2. * time(concat5) * N + time(concat8) * N + time(acceptT) * N + N2 * time(= server) * N + 2. * N2 * time(= tgs) * N + N2 * time(T) * N + 6. * time(C) * N + time(= pkey) * N + time(= spkey) * N + time(concat1) * N + time(check2) * N + 2. * time(un1) * N + 2. * time(un2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 27: m2_169[!_38])) * N + time(concat4) * N + 2. * time(concat6) * N + time(mac) * N + time(Z) * N + time(enc2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 27: m2_174[!_38])) * N + 2. * N * N * time(check2) + 2. * N * N * time(padno) + 2. * N * N * time(= nonce) + time(K) * N + 2. * time(padno) * N + 2. * time(sskgen2) * N + 2. * time(sign2) * N + time(checkmac) * N + time(= nonce) * N + time(= tgs) * N + time(let concat4) * N + time(acceptC1) * N + time(= server) * N4 * N3 * N + time(C) * N4 * N3 * N + time(pad) * N4 * N3 * N + time(encsym) * N4 * N3 * N + time(= timest) * N4 * N3 * N + time(let padts) * N4 * N3 * N + time(let injbot2) * N4 * N3 * N + time(decsym) * N4 * N3 * N + time(acceptC3) * N4 * N3 * N + time(acceptC2) * N3 * N + time(decsym) * N3 * N + time(let injbot2) * N3 * N + time(let concat8) * N3 * N + time(= server) * N3 * N + time(= nonce) * N3 * N + time(= client) * N3 * N + 2. * time(C) * N3 * N + time(encsym) * N3 * N + time(pad) * N3 * N + time(= tgs) * N3 * N + 2. * time(true) * N + N * N * time(= bitstring, maxlength(game 27: m21[!_35]), maxlength(game 27: m2_174[!_38])) + N * N * time(= bitstring, maxlength(game 27: m21[!_35]), maxlength(game 27: m2_169[!_38])) + time(sign2) + time(sskgen2) + time(concat1) + time(C) + 2. * time(kgen) + 3. * time(spkgen2) + time(pkgen2)
RESULT time(context for game 33) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + 2. * time(let concat5) * N + 5. * time(= client) * N + 2. * time(let pad) * N + 5. * time(let injbot2) * N + 5. * time(decsym) * N + time(padts) * N + 5. * time(encsym) * N + time(acceptS) * N + 4. * time(kgen) * N + 2. * time(concat5) * N + time(concat8) * N + time(acceptT) * N + N2 * time(= server) * N + 2. * N2 * time(= tgs) * N + N2 * time(T) * N + 6. * time(C) * N + time(= pkey) * N + time(= spkey) * N + time(concat1) * N + time(check2) * N + time(mac) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 33: m2_169[!_38])) * N + time(concat4) * N + 2. * time(concat6) * N + time(Z) * N + time(enc2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 33: m2_174[!_38])) * N + 2. * N * N * time(check2) + 2. * N * N * time(padno) + 2. * N * N * time(= nonce) + time(checkmac) * N + time(K) * N + 2. * time(padno) * N + 2. * time(sskgen2) * N + 2. * time(sign2) * N + time(= nonce) * N + time(= tgs) * N + time(let concat4) * N + time(acceptC1) * N + time(= server) * N4 * N3 * N + time(C) * N4 * N3 * N + time(pad) * N4 * N3 * N + time(encsym) * N4 * N3 * N + time(= timest) * N4 * N3 * N + time(let padts) * N4 * N3 * N + time(let injbot2) * N4 * N3 * N + time(decsym) * N4 * N3 * N + time(acceptC3) * N4 * N3 * N + time(acceptC2) * N3 * N + time(decsym) * N3 * N + time(let injbot2) * N3 * N + time(let concat8) * N3 * N + time(= server) * N3 * N + time(= nonce) * N3 * N + time(= client) * N3 * N + 2. * time(C) * N3 * N + time(encsym) * N3 * N + time(pad) * N3 * N + time(= tgs) * N3 * N + 2. * time(true) * N + N * N * time(= bitstring, maxlength(game 33: m21[!_35]), maxlength(game 33: m2_174[!_38])) + N * N * time(= bitstring, maxlength(game 33: m21[!_35]), maxlength(game 33: m2_169[!_38])) + time(sign2) + time(sskgen2) + time(concat1) + time(C) + 2. * time(kgen) + 3. * time(spkgen2) + time(pkgen2)
RESULT time(context for game 38) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + 2. * time(let concat5) * N + 5. * time(= client) * N + 2. * time(let pad) * N + 5. * time(let injbot2) * N + 5. * time(decsym) * N + time(padts) * N + 5. * time(encsym) * N + time(acceptS) * N + 3. * time(kgen) * N + 2. * time(concat5) * N + time(concat8) * N + time(acceptT) * N + N2 * time(= server) * N + 2. * N2 * time(= tgs) * N + N2 * time(T) * N + 6. * time(C) * N + time(= pkey) * N + time(= spkey) * N + time(concat1) * N + time(check2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 38: m2_169[!_38])) * N + time(concat4) * N + 2. * time(concat6) * N + time(kgen2) * N + time(mac2) * N + time(Z) * N + time(enc2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 38: m2_174[!_38])) * N + 2. * N * N * time(check2) + 2. * N * N * time(padno) + 2. * N * N * time(= nonce) + time(K) * N + 2. * time(padno) * N + time(let concat4) * N + time(acceptC1) * N + time(= server) * N4 * N3 * N + time(C) * N4 * N3 * N + time(pad) * N4 * N3 * N + time(encsym) * N4 * N3 * N + time(= timest) * N4 * N3 * N + time(let padts) * N4 * N3 * N + time(let injbot2) * N4 * N3 * N + time(decsym) * N4 * N3 * N + time(acceptC3) * N4 * N3 * N + time(acceptC2) * N3 * N + time(decsym) * N3 * N + time(let injbot2) * N3 * N + time(let concat8) * N3 * N + time(= server) * N3 * N + time(= nonce) * N3 * N + time(= client) * N3 * N + 2. * time(C) * N3 * N + time(encsym) * N3 * N + time(pad) * N3 * N + time(= tgs) * N3 * N + time(= [1,N]) * N + 2. * time(sskgen2) * N + 2. * time(sign2) * N + 2. * time(= signature) * N + 2. * time(= tgs) * N + 2. * time(= nonce) * N + 2. * time(true) * N + N * N * time(= bitstring, maxlength(game 38: m21[!_35]), maxlength(game 38: m2_174[!_38])) + N * N * time(= bitstring, maxlength(game 38: m21[!_35]), maxlength(game 38: m2_169[!_38])) + time(sign2) + time(sskgen2) + time(concat1) + time(C) + 2. * time(kgen) + 3. * time(spkgen2) + time(pkgen2)
RESULT time(context for game 43) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + 2. * time(let concat5) * N + 5. * time(= client) * N + 2. * time(let pad) * N + 5. * time(let injbot2) * N + 5. * time(decsym) * N + time(padts) * N + 5. * time(encsym) * N + time(acceptS) * N + 3. * time(kgen) * N + 2. * time(concat5) * N + time(concat8) * N + time(acceptT) * N + N2 * time(= server) * N + 2. * N2 * time(= tgs) * N + N2 * time(T) * N + 4. * time(C) * N + time(= pkey) * N + time(= spkey) * N + time(concat1) * N + time(check2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 43: m2_169[!_38])) * N + time(concat4) * N + time(Z) * N + time(enc2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 43: m2_174[!_38])) * N + 2. * N * N * time(check2) + 2. * N * N * time(padno) + 2. * N * N * time(= nonce) + time(K) * N + 2. * time(padno) * N + time(let concat4) * N + time(acceptC1) * N + time(= server) * N4 * N3 * N + time(C) * N4 * N3 * N + time(pad) * N4 * N3 * N + time(encsym) * N4 * N3 * N + time(= timest) * N4 * N3 * N + time(let padts) * N4 * N3 * N + time(let injbot2) * N4 * N3 * N + time(decsym) * N4 * N3 * N + time(acceptC3) * N4 * N3 * N + time(acceptC2) * N3 * N + time(decsym) * N3 * N + time(let injbot2) * N3 * N + time(let concat8) * N3 * N + time(= server) * N3 * N + time(= nonce) * N3 * N + time(= client) * N3 * N + 2. * time(C) * N3 * N + time(encsym) * N3 * N + time(pad) * N3 * N + time(= tgs) * N3 * N + time(= [1,N]) * N + 2. * time(sskgen2) * N + 2. * time(sign2) * N + 2. * time(= signature) * N + 2. * time(= tgs) * N + 2. * time(= nonce) * N + 2. * time(true) * N + N * N * time(= bitstring, maxlength(game 43: m21[!_35]), maxlength(game 43: m2_174[!_38])) + N * N * time(= bitstring, maxlength(game 43: m21[!_35]), maxlength(game 43: m2_169[!_38])) + time(sign2) + time(sskgen2) + time(concat1) + time(C) + 2. * time(kgen) + 3. * time(spkgen2) + time(pkgen2)
RESULT time(context for game 47) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + 2. * time(let concat5) * N + 5. * time(= client) * N + 2. * time(let pad) * N + 5. * time(let injbot2) * N + 5. * time(decsym) * N + time(padts) * N + 5. * time(encsym) * N + time(acceptS) * N + 3. * time(kgen) * N + 2. * time(concat5) * N + time(concat8) * N + time(acceptT) * N + N2 * time(= server) * N + 2. * N2 * time(= tgs) * N + N2 * time(T) * N + 4. * time(C) * N + time(= pkey) * N + time(= spkey) * N + time(concat1) * N + time(check2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 47: m2_169[!_38])) * N + time(concat4) * N + time(Z) * N + time(enc2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 47: m2_174[!_38])) * N + 2. * N * N * time(check2) + 2. * N * N * time(padno) + 2. * N * N * time(= nonce) + time(let concat4) * N + time(K) * N + 2. * time(padno) * N + time(acceptC1) * N + time(= server) * N4 * N3 * N + time(C) * N4 * N3 * N + time(pad) * N4 * N3 * N + time(encsym) * N4 * N3 * N + time(= timest) * N4 * N3 * N + time(let padts) * N4 * N3 * N + time(let injbot2) * N4 * N3 * N + time(decsym) * N4 * N3 * N + time(acceptC3) * N4 * N3 * N + time(acceptC2) * N3 * N + time(decsym) * N3 * N + time(let injbot2) * N3 * N + time(let concat8) * N3 * N + time(= server) * N3 * N + time(= nonce) * N3 * N + time(= client) * N3 * N + 2. * time(C) * N3 * N + time(encsym) * N3 * N + time(pad) * N3 * N + time(= tgs) * N3 * N + time(= maxmac) * N + time(= [1,N]) * N + 2. * time(sskgen2) * N + 2. * time(sign2) * N + 2. * time(= signature) * N + 2. * time(= tgs) * N + 2. * time(= nonce) * N + 2. * time(true) * N + N * N * time(= bitstring, maxlength(game 47: m21[!_35]), maxlength(game 47: m2_174[!_38])) + N * N * time(= bitstring, maxlength(game 47: m21[!_35]), maxlength(game 47: m2_169[!_38])) + time(sign2) + time(sskgen2) + time(concat1) + time(C) + 2. * time(kgen) + 3. * time(spkgen2) + time(pkgen2)
RESULT time(context for game 52) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + 2. * time(let concat5) * N + 5. * time(= client) * N + 2. * time(let pad) * N + 5. * time(let injbot2) * N + 4. * time(decsym) * N + time(padts) * N + 4. * time(encsym) * N + time(acceptS) * N + 2. * time(kgen) * N + 2. * time(concat5) * N + time(concat8) * N + time(acceptT) * N + N2 * time(= server) * N + 2. * N2 * time(= tgs) * N + N2 * time(T) * N + 4. * time(C) * N + time(= pkey) * N + time(= spkey) * N + time(concat1) * N + time(check2) * N + time(concat4) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 52: m2_169[!_38])) * N + time(Zconcat4) * N + time(kgen2) * N + time(encsym2) * N + time(Z) * N + time(enc2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 52: m2_174[!_38])) * N + 2. * N * N * time(check2) + 2. * N * N * time(padno) + 2. * N * N * time(= nonce) + time(let concat4) * N + time(K) * N + 2. * time(padno) * N + time(acceptC1) * N + time(= server) * N4 * N3 * N + time(C) * N4 * N3 * N + time(pad) * N4 * N3 * N + time(encsym) * N4 * N3 * N + time(= timest) * N4 * N3 * N + time(let padts) * N4 * N3 * N + time(let injbot2) * N4 * N3 * N + time(decsym) * N4 * N3 * N + time(acceptC3) * N4 * N3 * N + time(acceptC2) * N3 * N + time(decsym) * N3 * N + time(let injbot2) * N3 * N + time(let concat8) * N3 * N + time(= server) * N3 * N + time(= nonce) * N3 * N + time(= client) * N3 * N + 2. * time(C) * N3 * N + time(encsym) * N3 * N + time(pad) * N3 * N + time(= tgs) * N3 * N + time(= maxmac) * N + time(= [1,N]) * N + 2. * time(sskgen2) * N + 2. * time(sign2) * N + 2. * time(= signature) * N + 2. * time(= tgs) * N + 2. * time(= nonce) * N + 2. * time(true) * N + N * N * time(= bitstring, maxlength(game 52: m21[!_35]), maxlength(game 52: m2_174[!_38])) + N * N * time(= bitstring, maxlength(game 52: m21[!_35]), maxlength(game 52: m2_169[!_38])) + time(sign2) + time(sskgen2) + time(concat1) + time(C) + 2. * time(kgen) + 3. * time(spkgen2) + time(pkgen2)
RESULT time(context for game 57) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + 2. * time(let concat5) * N + 5. * time(= client) * N + 2. * time(let pad) * N + 4. * time(let injbot2) * N + 4. * time(decsym) * N + time(padts) * N + 4. * time(encsym) * N + time(acceptS) * N + 2. * time(kgen) * N + 2. * time(concat5) * N + time(concat8) * N + time(acceptT) * N + N2 * time(= server) * N + 2. * N2 * time(= tgs) * N + N2 * time(T) * N + 4. * time(C) * N + time(= pkey) * N + time(= spkey) * N + time(concat1) * N + time(check2) * N + time(concat4) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 57: m2_169[!_38])) * N + time(Zconcat4) * N + time(kgen2) * N + time(encsym2) * N + time(Z) * N + time(enc2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 57: m2_174[!_38])) * N + 2. * N * N * time(check2) + 2. * N * N * time(padno) + 2. * N * N * time(= nonce) + time(K) * N + 2. * time(padno) * N + time(acceptC1) * N + time(= server) * N4 * N3 * N + time(C) * N4 * N3 * N + time(pad) * N4 * N3 * N + time(encsym) * N4 * N3 * N + time(= timest) * N4 * N3 * N + time(let padts) * N4 * N3 * N + time(let injbot2) * N4 * N3 * N + time(decsym) * N4 * N3 * N + time(acceptC3) * N4 * N3 * N + time(acceptC2) * N3 * N + time(decsym) * N3 * N + time(let injbot2) * N3 * N + time(let concat8) * N3 * N + time(= server) * N3 * N + time(= nonce) * N3 * N + time(= client) * N3 * N + 2. * time(C) * N3 * N + time(encsym) * N3 * N + time(pad) * N3 * N + time(= tgs) * N3 * N + time(= maxmac) * N + time(= [1,N]) * N + 2. * time(sskgen2) * N + 2. * time(sign2) * N + 2. * time(= signature) * N + time(= tgs) * N + time(= nonce) * N + 2. * time(true) * N + N * N * time(= bitstring, maxlength(game 57: m21[!_35]), maxlength(game 57: m2_174[!_38])) + N * N * time(= bitstring, maxlength(game 57: m21[!_35]), maxlength(game 57: m2_169[!_38])) + time(sign2) + time(sskgen2) + time(concat1) + time(C) + 2. * time(kgen) + 3. * time(spkgen2) + time(pkgen2)
RESULT time(context for game 64) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + 2. * time(let concat5) * N + 5. * time(= client) * N + 2. * time(let pad) * N + 4. * time(let injbot2) * N + 3. * time(decsym) * N + time(padts) * N + 4. * time(encsym) * N + time(acceptS) * N + 2. * time(kgen) * N + 2. * time(concat5) * N + time(concat8) * N + time(acceptT) * N + 2. * N2 * time(= server) * N + 3. * N2 * time(= tgs) * N + 2. * N2 * time(T) * N + 4. * time(C) * N + time(= pkey) * N + time(= spkey) * N + time(concat1) * N + time(check2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 64: m2_169[!_38])) * N + time(Zconcat4) * N + time(kgen2) * N + time(encsym2) * N + time(Z) * N + time(enc2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 64: m2_174[!_38])) * N + 2. * N * N * time(check2) + 2. * N * N * time(padno) + 2. * N * N * time(= nonce) + time(K) * N + 2. * time(padno) * N + time(acceptC1) * N + time(= server) * N4 * N3 * N + time(C) * N4 * N3 * N + time(pad) * N4 * N3 * N + time(encsym) * N4 * N3 * N + time(= timest) * N4 * N3 * N + time(let padts) * N4 * N3 * N + time(let injbot2) * N4 * N3 * N + time(decsym) * N4 * N3 * N + time(acceptC3) * N4 * N3 * N + time(acceptC2) * N3 * N + time(decsym) * N3 * N + time(let injbot2) * N3 * N + time(let concat8) * N3 * N + time(= server) * N3 * N + time(= nonce) * N3 * N + time(= client) * N3 * N + 2. * time(C) * N3 * N + time(encsym) * N3 * N + time(pad) * N3 * N + time(= tgs) * N3 * N + time(= maxmac) * N + time(= [1,N]) * N + 2. * time(sskgen2) * N + 2. * time(sign2) * N + 2. * time(= signature) * N + time(= tgs) * N + time(= nonce) * N + 2. * time(true) * N + N * N * time(= bitstring, maxlength(game 64: m21[!_35]), maxlength(game 64: m2_174[!_38])) + N * N * time(= bitstring, maxlength(game 64: m21[!_35]), maxlength(game 64: m2_169[!_38])) + time(sign2) + time(sskgen2) + time(concat1) + time(C) + time(kgen) + 3. * time(spkgen2) + time(pkgen2)
RESULT time(context for game 68) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + 5. * time(= client) * N + 2. * time(let pad) * N + 3. * time(let injbot2) * N + 3. * time(decsym) * N + time(padts) * N + 4. * time(encsym) * N + time(acceptS) * N + N * N * time(= maxmac) + time(let concat5) * N + 2. * time(kgen) * N + 2. * time(concat5) * N + time(concat8) * N + time(acceptT) * N + 2. * N2 * time(= server) * N + 2. * N2 * time(= tgs) * N + N2 * time(T) * N + 4. * time(C) * N + time(= pkey) * N + time(= spkey) * N + time(concat1) * N + time(check2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 68: m2_169[!_38])) * N + time(Zconcat4) * N + time(kgen2) * N + time(encsym2) * N + time(Z) * N + time(enc2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 68: m2_174[!_38])) * N + 2. * N * N * time(check2) + 2. * N * N * time(padno) + 2. * N * N * time(= nonce) + time(K) * N + 2. * time(padno) * N + time(acceptC1) * N + time(= server) * N4 * N3 * N + time(C) * N4 * N3 * N + time(pad) * N4 * N3 * N + time(encsym) * N4 * N3 * N + time(= timest) * N4 * N3 * N + time(let padts) * N4 * N3 * N + time(let injbot2) * N4 * N3 * N + time(decsym) * N4 * N3 * N + time(acceptC3) * N4 * N3 * N + time(acceptC2) * N3 * N + time(decsym) * N3 * N + time(let injbot2) * N3 * N + time(let concat8) * N3 * N + time(= server) * N3 * N + time(= nonce) * N3 * N + time(= client) * N3 * N + 2. * time(C) * N3 * N + time(encsym) * N3 * N + time(pad) * N3 * N + time(= tgs) * N3 * N + time(= maxmac) * N + time(= [1,N]) * N + 2. * time(sskgen2) * N + 2. * time(sign2) * N + 2. * time(= signature) * N + time(= tgs) * N + time(= nonce) * N + 2. * time(true) * N + N * N * time(= bitstring, maxlength(game 68: m21[!_35]), maxlength(game 68: m2_174[!_38])) + N * N * time(= bitstring, maxlength(game 68: m21[!_35]), maxlength(game 68: m2_169[!_38])) + time(sign2) + time(sskgen2) + time(concat1) + time(C) + time(kgen) + 3. * time(spkgen2) + time(pkgen2)
RESULT time(context for game 75) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + 5. * time(= client) * N + 2. * time(let pad) * N + 3. * time(let injbot2) * N + 2. * time(decsym) * N + time(padts) * N + 4. * time(encsym) * N + time(acceptS) * N + N * N * time(= maxmac) + time(let concat5) * N + 2. * time(concat5) * N + 2. * time(kgen) * N + time(Zconcat5) * N + 2. * time(kgen2) * N + 2. * time(encsym2) * N + time(concat8) * N + time(acceptT) * N + 2. * N2 * time(= server) * N + 3. * N2 * time(= tgs) * N + N2 * time(T) * N + 4. * time(C) * N + time(= pkey) * N + time(= spkey) * N + time(concat1) * N + time(check2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 75: m2_169[!_38])) * N + time(Zconcat4) * N + time(Z) * N + time(enc2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 75: m2_174[!_38])) * N + 2. * N * N * time(check2) + 2. * N * N * time(padno) + 2. * N * N * time(= nonce) + time(K) * N + 2. * time(padno) * N + time(acceptC1) * N + time(= server) * N4 * N3 * N + time(C) * N4 * N3 * N + time(pad) * N4 * N3 * N + time(encsym) * N4 * N3 * N + time(= timest) * N4 * N3 * N + time(let padts) * N4 * N3 * N + time(let injbot2) * N4 * N3 * N + time(decsym) * N4 * N3 * N + time(acceptC3) * N4 * N3 * N + time(acceptC2) * N3 * N + time(decsym) * N3 * N + time(let injbot2) * N3 * N + time(let concat8) * N3 * N + time(= server) * N3 * N + time(= nonce) * N3 * N + time(= client) * N3 * N + 2. * time(C) * N3 * N + time(encsym) * N3 * N + time(pad) * N3 * N + time(= tgs) * N3 * N + time(= maxmac) * N + time(= [1,N]) * N + 2. * time(sskgen2) * N + 2. * time(sign2) * N + 2. * time(= signature) * N + time(= tgs) * N + time(= nonce) * N + 2. * time(true) * N + N * N * time(= bitstring, maxlength(game 75: m21[!_35]), maxlength(game 75: m2_174[!_38])) + N * N * time(= bitstring, maxlength(game 75: m21[!_35]), maxlength(game 75: m2_169[!_38])) + time(sign2) + time(sskgen2) + time(concat1) + time(C) + 3. * time(spkgen2) + time(pkgen2)
RESULT time(context for game 79) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + 5. * time(= client) * N + 2. * time(let pad) * N + 2. * time(let injbot2) * N + 2. * time(decsym) * N + time(padts) * N + 4. * time(encsym) * N + time(acceptS) * N + 3. * N * N * time(= maxmac) + 2. * time(concat5) * N + 2. * time(kgen) * N + time(Zconcat5) * N + 2. * time(kgen2) * N + 2. * time(encsym2) * N + time(concat8) * N + time(acceptT) * N + 2. * N2 * time(= server) * N + 3. * N2 * time(= tgs) * N + N2 * time(T) * N + 4. * time(C) * N + time(= pkey) * N + time(= spkey) * N + time(concat1) * N + time(check2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 79: m2_169[!_38])) * N + time(Zconcat4) * N + time(Z) * N + time(enc2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 79: m2_174[!_38])) * N + 2. * N * N * time(check2) + 2. * N * N * time(padno) + 2. * N * N * time(= nonce) + time(K) * N + 2. * time(padno) * N + time(acceptC1) * N + time(= server) * N4 * N3 * N + time(C) * N4 * N3 * N + time(pad) * N4 * N3 * N + time(encsym) * N4 * N3 * N + time(= timest) * N4 * N3 * N + time(let padts) * N4 * N3 * N + time(let injbot2) * N4 * N3 * N + time(decsym) * N4 * N3 * N + time(acceptC3) * N4 * N3 * N + time(acceptC2) * N3 * N + time(decsym) * N3 * N + time(let injbot2) * N3 * N + time(let concat8) * N3 * N + time(= server) * N3 * N + time(= nonce) * N3 * N + time(= client) * N3 * N + 2. * time(C) * N3 * N + time(encsym) * N3 * N + time(pad) * N3 * N + time(= tgs) * N3 * N + time(= maxmac) * N + time(= [1,N]) * N + 2. * time(sskgen2) * N + 2. * time(sign2) * N + 2. * time(= signature) * N + time(= tgs) * N + time(= nonce) * N + 2. * time(true) * N + N * N * time(= bitstring, maxlength(game 79: m21[!_35]), maxlength(game 79: m2_174[!_38])) + N * N * time(= bitstring, maxlength(game 79: m21[!_35]), maxlength(game 79: m2_169[!_38])) + time(sign2) + time(sskgen2) + time(concat1) + time(C) + 3. * time(spkgen2) + time(pkgen2)
RESULT time(context for game 89) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + 5. * time(= client) * N + 2. * time(let pad) * N + 2. * time(let injbot2) * N + 2. * time(decsym) * N + time(padts) * N + 4. * time(encsym) * N + time(acceptS) * N + 3. * N * N * time(= maxmac) + 2. * time(concat5) * N + 4. * time(kgen) * N + 2. * time(Zconcat5) * N + 3. * time(kgen2) * N + 3. * time(encsym2) * N + time(concat8) * N + time(acceptT) * N + 2. * N2 * time(= server) * N + 3. * N2 * time(= tgs) * N + N2 * time(T) * N + 4. * time(C) * N + time(= pkey) * N + time(= spkey) * N + time(concat1) * N + time(check2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 89: m2_169[!_38])) * N + time(Zconcat4) * N + time(Z) * N + time(enc2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 89: m2_174[!_38])) * N + 2. * N * N * time(check2) + 2. * N * N * time(padno) + 2. * N * N * time(= nonce) + time(K) * N + 2. * time(padno) * N + time(decsym) * N3 * N + 2. * time(kgen) * N3 * N + time(encsym) * N3 * N + time(acceptC1) * N + time(= server) * N4 * N3 * N + time(C) * N4 * N3 * N + time(pad) * N4 * N3 * N + time(encsym) * N4 * N3 * N + time(= timest) * N4 * N3 * N + time(let padts) * N4 * N3 * N + time(let injbot2) * N4 * N3 * N + time(decsym) * N4 * N3 * N + time(acceptC3) * N4 * N3 * N + time(acceptC2) * N3 * N + time(let injbot2) * N3 * N + time(let concat8) * N3 * N + time(= server) * N3 * N + time(= nonce) * N3 * N + time(= client) * N3 * N + 2. * time(C) * N3 * N + time(pad) * N3 * N + time(= tgs) * N3 * N + 2. * time(= maxmac) * N + 2. * time(= [1,N]) * N + 3. * time(sskgen2) * N + 3. * time(sign2) * N + 4. * time(= signature) * N + 2. * time(= tgs) * N + 2. * time(= nonce) * N + 4. * time(true) * N + 2. * N * N * time(= bitstring, maxlength(game 89: m21[!_35]), maxlength(game 89: m2_174[!_38])) + 2. * N * N * time(= bitstring, maxlength(game 89: m21[!_35]), maxlength(game 89: m2_169[!_38])) + time(sign2) + time(sskgen2) + time(concat1) + time(C) + 3. * time(spkgen2) + time(pkgen2)
RESULT time(context for game 93) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + 5. * time(= client) * N + 2. * time(let pad) * N + 2. * time(let injbot2) * N + time(decsym) * N + time(padts) * N + 4. * time(encsym) * N + time(acceptS) * N + 5. * N * N * time(= maxmac) + 2. * time(concat5) * N + 2. * time(kgen) * N + 2. * time(Zconcat5) * N + 3. * time(encsym2) * N + time(concat8) * N + 4. * time(kgen2) * N + time(acceptT) * N + 2. * N2 * time(= server) * N + 3. * N2 * time(= tgs) * N + N2 * time(T) * N + 3. * N3 * N * N * time(= [1,N]) + 3. * N3 * N * N * time(= maxmac) + 2. * N * N * time(= [1,N]) + 4. * time(C) * N + time(= pkey) * N + time(= spkey) * N + time(concat1) * N + time(check2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 93: m2_169[!_38])) * N + time(Zconcat4) * N + time(Z) * N + time(enc2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 93: m2_174[!_38])) * N + 2. * N * N * time(check2) + 2. * N * N * time(padno) + 2. * N * N * time(= nonce) + time(decsym) * N3 * N + 2. * time(kgen) * N3 * N + time(let injbot2) * N3 * N + time(let concat8) * N3 * N + time(K) * N + 2. * time(padno) * N + time(acceptC1) * N + N3 * N3 * time(= maxmac) * N + time(= server) * N4 * N3 * N + time(C) * N4 * N3 * N + time(pad) * N4 * N3 * N + time(encsym) * N4 * N3 * N + time(= timest) * N4 * N3 * N + time(let padts) * N4 * N3 * N + time(let injbot2) * N4 * N3 * N + time(decsym) * N4 * N3 * N + time(acceptC3) * N4 * N3 * N + time(acceptC2) * N3 * N + time(= server) * N3 * N + time(= nonce) * N3 * N + time(= client) * N3 * N + 2. * time(C) * N3 * N + time(encsym) * N3 * N + time(kgen2) * N3 * N + time(pad) * N3 * N + time(= tgs) * N3 * N + time(= maxmac) * N + time(= [1,N]) * N + 2. * time(sskgen2) * N + 2. * time(sign2) * N + 2. * time(= signature) * N + time(= tgs) * N + time(= nonce) * N + 2. * time(true) * N + 2. * N * N * time(= bitstring, maxlength(game 93: m21[!_35]), maxlength(game 93: m2_174[!_38])) + 2. * N * N * time(= bitstring, maxlength(game 93: m21[!_35]), maxlength(game 93: m2_169[!_38])) + time(sign2) + time(sskgen2) + time(concat1) + time(C) + 3. * time(spkgen2) + time(pkgen2)
RESULT time(context for game 98) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + 4. * time(= client) * N + time(let pad) * N + time(let injbot2) * N + time(decsym) * N + time(padts) * N + 4. * time(encsym) * N + time(acceptS) * N + 5. * N * N * time(= maxmac) + 2. * time(concat5) * N + 2. * time(kgen) * N + 2. * time(Zconcat5) * N + 4. * time(kgen2) * N + 3. * time(encsym2) * N + time(concat8) * N + time(acceptT) * N + 2. * N2 * time(= server) * N + 3. * N2 * time(= tgs) * N + N2 * time(T) * N + 3. * N3 * N * N * time(= [1,N]) + 3. * N3 * N * N * time(= maxmac) + 2. * N * N * time(= [1,N]) + 4. * time(C) * N + time(= pkey) * N + time(= spkey) * N + time(concat1) * N + time(check2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 98: m2_169[!_38])) * N + time(Zconcat4) * N + time(Z) * N + time(enc2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 98: m2_174[!_38])) * N + 2. * N * N * time(check2) + 2. * N * N * time(padno) + 2. * N * N * time(= nonce) + time(kgen2) * N3 * N + time(decsym) * N3 * N + 2. * time(kgen) * N3 * N + time(let injbot2) * N3 * N + time(let concat8) * N3 * N + time(encsym) * N3 * N + time(K) * N + 2. * time(padno) * N + time(acceptC1) * N + N3 * N3 * time(= maxmac) * N + time(= server) * N4 * N3 * N + time(C) * N4 * N3 * N + time(pad) * N4 * N3 * N + time(encsym) * N4 * N3 * N + time(= timest) * N4 * N3 * N + time(let padts) * N4 * N3 * N + time(let injbot2) * N4 * N3 * N + time(decsym) * N4 * N3 * N + time(acceptC3) * N4 * N3 * N + time(acceptC2) * N3 * N + time(= server) * N3 * N + time(= nonce) * N3 * N + time(= client) * N3 * N + 2. * time(C) * N3 * N + time(pad) * N3 * N + time(= tgs) * N3 * N + time(= maxmac) * N + time(= [1,N]) * N + 2. * time(sskgen2) * N + 2. * time(sign2) * N + 2. * time(= signature) * N + time(= tgs) * N + time(= nonce) * N + 2. * time(true) * N + 2. * N * N * time(= bitstring, maxlength(game 98: m21[!_35]), maxlength(game 98: m2_174[!_38])) + 2. * N * N * time(= bitstring, maxlength(game 98: m21[!_35]), maxlength(game 98: m2_169[!_38])) + time(sign2) + time(sskgen2) + time(concat1) + time(C) + 3. * time(spkgen2) + time(pkgen2)
RESULT time(context for game 102) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + 4. * time(= client) * N + time(let pad) * N + time(let injbot2) * N + time(decsym) * N + time(padts) * N + 3. * time(encsym) * N + time(acceptS) * N + 5. * N * N * time(= maxmac) + time(concat8) * N + 2. * time(concat5) * N + 2. * time(kgen) * N + 2. * time(Zconcat5) * N + time(Zconcat8) * N + 4. * time(kgen2) * N + 4. * time(encsym2) * N + time(acceptT) * N + 2. * N2 * time(= server) * N + 3. * N2 * time(= tgs) * N + N2 * time(T) * N + 3. * N3 * N * N * time(= [1,N]) + 3. * N3 * N * N * time(= maxmac) + 2. * N * N * time(= [1,N]) + 4. * time(C) * N + time(= pkey) * N + time(= spkey) * N + time(concat1) * N + time(check2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 102: m2_169[!_38])) * N + time(Zconcat4) * N + time(Z) * N + time(enc2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 102: m2_174[!_38])) * N + 2. * N * N * time(check2) + 2. * N * N * time(padno) + 2. * N * N * time(= nonce) + time(decsym) * N3 * N + 2. * time(kgen) * N3 * N + time(let injbot2) * N3 * N + time(let concat8) * N3 * N + time(encsym) * N3 * N + time(pad) * N3 * N + time(K) * N + 2. * time(padno) * N + time(acceptC1) * N + N3 * N3 * time(= maxmac) * N + time(= server) * N4 * N3 * N + time(C) * N4 * N3 * N + time(pad) * N4 * N3 * N + time(encsym) * N4 * N3 * N + time(= timest) * N4 * N3 * N + time(let padts) * N4 * N3 * N + time(let injbot2) * N4 * N3 * N + time(decsym) * N4 * N3 * N + time(acceptC3) * N4 * N3 * N + time(acceptC2) * N3 * N + time(= server) * N3 * N + time(= nonce) * N3 * N + time(= client) * N3 * N + 2. * time(C) * N3 * N + time(encsym2) * N3 * N + time(kgen2) * N3 * N + time(Zpad) * N3 * N + time(= tgs) * N3 * N + time(= maxmac) * N + time(= [1,N]) * N + 2. * time(sskgen2) * N + 2. * time(sign2) * N + 2. * time(= signature) * N + time(= tgs) * N + time(= nonce) * N + 2. * time(true) * N + 2. * N * N * time(= bitstring, maxlength(game 102: m21[!_35]), maxlength(game 102: m2_174[!_38])) + 2. * N * N * time(= bitstring, maxlength(game 102: m21[!_35]), maxlength(game 102: m2_169[!_38])) + time(sign2) + time(sskgen2) + time(concat1) + time(C) + 3. * time(spkgen2) + time(pkgen2)
RESULT time(context for game 112) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + time(decsym) * N + 4. * time(kgen) * N + 3. * time(encsym) * N + 4. * time(= client) * N + time(let pad) * N + time(let injbot2) * N + time(padts) * N + time(acceptS) * N + 6. * N * N * time(= maxmac) + 2. * time(concat5) * N + 2. * time(Zconcat5) * N + time(Zconcat8) * N + 4. * time(kgen2) * N + 4. * time(encsym2) * N + time(acceptT) * N + 2. * N2 * time(= server) * N + 3. * N2 * time(= tgs) * N + N2 * time(T) * N + 3. * N3 * N * N * time(= [1,N]) + 3. * N3 * N * N * time(= maxmac) + 2. * N * N * time(= [1,N]) + 4. * time(C) * N + time(= pkey) * N + time(= spkey) * N + time(concat1) * N + time(check2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 112: m2_169[!_38])) * N + time(Zconcat4) * N + time(Z) * N + time(enc2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 112: m2_174[!_38])) * N + 2. * N * N * time(check2) + 2. * N * N * time(padno) + 2. * N * N * time(= nonce) + time(decsym) * N3 * N + 2. * time(kgen) * N3 * N + time(let injbot2) * N3 * N + time(let concat8) * N3 * N + time(encsym) * N3 * N + time(pad) * N3 * N + time(K) * N + 2. * time(padno) * N + time(acceptC1) * N + N3 * N3 * time(= maxmac) * N + time(= server) * N4 * N3 * N + time(C) * N4 * N3 * N + time(pad) * N4 * N3 * N + time(encsym) * N4 * N3 * N + time(= timest) * N4 * N3 * N + time(let padts) * N4 * N3 * N + time(let injbot2) * N4 * N3 * N + 2. * time(kgen) * N4 * N3 * N + time(decsym) * N4 * N3 * N + time(acceptC3) * N4 * N3 * N + time(acceptC2) * N3 * N + time(= server) * N3 * N + time(= nonce) * N3 * N + time(= client) * N3 * N + 2. * time(C) * N3 * N + time(encsym2) * N3 * N + time(kgen2) * N3 * N + time(Zpad) * N3 * N + time(= tgs) * N3 * N + time(= maxmac) * N + time(= [1,N]) * N + 2. * time(sskgen2) * N + 2. * time(sign2) * N + 2. * time(= signature) * N + time(= tgs) * N + time(= nonce) * N + 2. * time(true) * N + 2. * N * N * time(= bitstring, maxlength(game 112: m21[!_35]), maxlength(game 112: m2_174[!_38])) + 2. * N * N * time(= bitstring, maxlength(game 112: m21[!_35]), maxlength(game 112: m2_169[!_38])) + time(sign2) + time(sskgen2) + time(concat1) + time(C) + 3. * time(spkgen2) + time(pkgen2)
RESULT time(context for game 116) = 2. * time(T) * N2 + 2. * time(= tgs) * N2 + time(S) * N2 + time(= server) * N2 + 4. * time(= client) * N + time(let pad) * N + time(let injbot2) * N + time(padts) * N + 5. * time(kgen2) * N + 3. * time(encsym) * N + time(acceptS) * N + 2. * N4 * N3 * N * N * time(= maxmac) + 2. * N4 * N3 * N * N * time(= [1,N]) + 3. * N * N * time(= [1,N]) + 7. * N * N * time(= maxmac) + 2. * time(kgen) * N + 2. * time(concat5) * N + 2. * time(Zconcat5) * N + time(Zconcat8) * N + 4. * time(encsym2) * N + time(acceptT) * N + 2. * N2 * time(= server) * N + 3. * N2 * time(= tgs) * N + N2 * time(T) * N + 3. * N3 * N * N * time(= [1,N]) + 3. * N3 * N * N * time(= maxmac) + 4. * time(C) * N + time(= pkey) * N + time(= spkey) * N + time(concat1) * N + time(check2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 116: m2_169[!_38])) * N + time(Zconcat4) * N + time(Z) * N + time(enc2) * N + time((bitstring, client, maxmac, maxmac), maxlength(game 116: m2_174[!_38])) * N + 2. * N * N * time(check2) + 2. * N * N * time(padno) + 2. * N * N * time(= nonce) + time(decsym) * N3 * N + 2. * time(kgen) * N3 * N + time(let injbot2) * N3 * N + time(let concat8) * N3 * N + time(encsym) * N3 * N + time(pad) * N3 * N + time(K) * N + 2. * time(padno) * N + time(acceptC1) * N + N3 * N3 * time(= maxmac) * N + time(= server) * N4 * N3 * N + time(C) * N4 * N3 * N + time(pad) * N4 * N3 * N + time(encsym) * N4 * N3 * N + time(= timest) * N4 * N3 * N + time(let padts) * N4 * N3 * N + time(let injbot2) * N4 * N3 * N + 2. * time(kgen) * N4 * N3 * N + time(decsym) * N4 * N3 * N + time(acceptC3) * N4 * N3 * N + time(acceptC2) * N3 * N + time(= server) * N3 * N + time(= nonce) * N3 * N + time(kgen2) * N4 * N3 * N + N4 * N4 * time(= maxmac) * N3 * N + time(= client) * N3 * N + 2. * time(C) * N3 * N + time(encsym2) * N3 * N + time(kgen2) * N3 * N + time(Zpad) * N3 * N + time(= tgs) * N3 * N + time(= maxmac) * N + time(= [1,N]) * N + 2. * time(sskgen2) * N + 2. * time(sign2) * N + 2. * time(= signature) * N + time(= tgs) * N + time(= nonce) * N + 2. * time(true) * N + 2. * N * N * time(= bitstring, maxlength(game 116: m21[!_35]), maxlength(game 116: m2_174[!_38])) + 2. * N * N * time(= bitstring, maxlength(game 116: m21[!_35]), maxlength(game 116: m2_169[!_38])) + time(sign2) + time(sskgen2) + time(concat1) + time(C) + 3. * time(spkgen2) + time(pkgen2)
All queries proved.
bash-3.1$ 