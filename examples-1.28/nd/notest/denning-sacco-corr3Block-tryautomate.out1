bash-3.2$ cd ..
bash-3.2$ prover examplesnd/denning-sacco-corr3Block-tryautomate
Doing expand if, let, find
Doing simplify
Run simplify 1 time(s). Fixpoint reached.
Doing move new all binders
Doing remove assignments of useless
Please enter a command: crypto enc rkB
Doing equivalence
equiv ! !_1 <= N3 new r: keyseed; (
  () -> pkgen(r) [2],
  ! !_2 <= N2 (m: bitstring) -> dec(m, skgen(r)),
  ! !_3 <= N new r1: seed; (x1: blocksize) -> enc(x1, pkgen(r), r1)), ! !_4 <= N4 new r2: seed; (x: blocksize, y: pkey) -> enc(x, y, r2) [3] [all]
<=(N3 * N4 * Penc(time, N2))=>
      ! !_5 <= N3 new r: keyseed; (
  () -> pkgen2(r) [2],
  ! !_6 <= N2 (m: bitstring) -> find j_10 <= N suchthat defined(m1[j_10], x1[j_10]) && (m = m1[j_10]) then injbot(x1[j_10]) else find j_9 <= N4 suchthat defined(m2[j_9], y[j_9], x[j_9]) && ((y[j_9] = pkgen2(r)) && (m = m2[j_9])) then injbot(x[j_9]) else dec2(m, skgen2(r)),
  ! !_7 <= N new r1: seed; (x1_46: blocksize) -> let x1: blocksize = x1_46 in let m1: bitstring = enc2(Z, pkgen2(r), r1) in m1), ! !_8 <= N4 new r2: seed; new r3: seed; (x_48: blocksize, y_47: pkey) -> let x: blocksize = x_48 in let y: pkey = y_47 in find k <= N3 suchthat defined(r[k]) && (y = pkgen2(r[k])) then let m2: bitstring = enc2(Z, y, r2) in m2 else enc(x, y, r3) [3]
with rkB
Doing remove assignments of binder skB
Doing remove assignments of binder pkB
Doing equivalence
equiv ! !_1 <= N3 new r: keyseed; (
  () -> pkgen(r) [2],
  ! !_2 <= N2 (m: bitstring) -> dec(m, skgen(r)),
  ! !_3 <= N new r1: seed; (x1: blocksize) -> enc(x1, pkgen(r), r1)), ! !_4 <= N4 new r2: seed; (x: blocksize, y: pkey) -> enc(x, y, r2) [3] [all]
<=(N3 * N4 * Penc(time, N2))=>
      ! !_5 <= N3 new r: keyseed; (
  () -> pkgen2(r) [2],
  ! !_6 <= N2 (m: bitstring) -> find j_10 <= N suchthat defined(m1[j_10], x1[j_10]) && (m = m1[j_10]) then injbot(x1[j_10]) else find j_9 <= N4 suchthat defined(m2[j_9], y[j_9], x[j_9]) && ((y[j_9] = pkgen2(r)) && (m = m2[j_9])) then injbot(x[j_9]) else dec2(m, skgen2(r)),
  ! !_7 <= N new r1: seed; (x1_46: blocksize) -> let x1: blocksize = x1_46 in let m1: bitstring = enc2(Z, pkgen2(r), r1) in m1), ! !_8 <= N4 new r2: seed; new r3: seed; (x_48: blocksize, y_47: pkey) -> let x: blocksize = x_48 in let y: pkey = y_47 in find k <= N3 suchthat defined(r[k]) && (y = pkgen2(r[k])) then let m2: bitstring = enc2(Z, y, r2) in m2 else enc(x, y, r3) [3]
with r2, rkB
Doing remove assignments of binder Rkey
Doing SA rename Rkey
Doing remove assignments of binder Rkey_60
Doing remove assignments of binder Rkey_59
Doing equivalence
equiv ! !_1 <= N3 new r: keyseed; (
  () -> pkgen(r) [2],
  ! !_2 <= N2 (m: bitstring) -> dec(m, skgen(r)),
  ! !_3 <= N new r1: seed; (x1: blocksize) -> enc(x1, pkgen(r), r1)), ! !_4 <= N4 new r2: seed; (x: blocksize, y: pkey) -> enc(x, y, r2) [3] [all]
<=(N3 * N4 * Penc(time, N2))=>
      ! !_5 <= N3 new r: keyseed; (
  () -> pkgen2(r) [2],
  ! !_6 <= N2 (m: bitstring) -> find j_10 <= N suchthat defined(m1[j_10], x1[j_10]) && (m = m1[j_10]) then injbot(x1[j_10]) else find j_9 <= N4 suchthat defined(m2[j_9], y[j_9], x[j_9]) && ((y[j_9] = pkgen2(r)) && (m = m2[j_9])) then injbot(x[j_9]) else dec2(m, skgen2(r)),
  ! !_7 <= N new r1: seed; (x1_46: blocksize) -> let x1: blocksize = x1_46 in let m1: bitstring = enc2(Z, pkgen2(r), r1) in m1), ! !_8 <= N4 new r2: seed; new r3: seed; (x_48: blocksize, y_47: pkey) -> let x: blocksize = x_48 in let y: pkey = y_47 in find k <= N3 suchthat defined(r[k]) && (y = pkgen2(r[k])) then let m2: bitstring = enc2(Z, y, r2) in m2 else enc(x, y, r3) [3]
with r2, rkB
Doing simplify
Run simplify 2 time(s). Fixpoint reached.
Doing move new all binders
Doing remove assignments of useless
Please enter a command: crypto sign rkS
Doing equivalence
equiv ! !_11 <= N3 new r: skeyseed; (
  () -> spkgen(r) [2],
  ! !_12 <= N2 new r2: sseed; (x: sblocksize) -> sign(x, sskgen(r), r2),
  ! !_13 <= N (m1: sblocksize, si1: signature) -> check(m1, spkgen(r), si1)), ! !_14 <= N4 (m: sblocksize, y: spkey, si: signature) -> check(m, y, si) [3] [all]
<=(N3 * Psign(time, N2))=>
      ! !_15 <= N3 new r: skeyseed; (
  () -> spkgen2(r) [2],
  ! !_16 <= N2 new r2: sseed; (x_45: sblocksize) -> let x: sblocksize = x_45 in sign2(x, sskgen2(r), r2),
  ! !_17 <= N (m1: sblocksize, si1: signature) -> find j_19 <= N2 suchthat defined(x[j_19]) && ((m1 = x[j_19]) && check2(m1, spkgen(r), si1)) then true else false), ! !_18 <= N4 (m: sblocksize, y: spkey, si: signature) -> find j_21 <= N2, k_22 <= N3 suchthat defined(x[j_21, k_22], r[k_22]) && ((y = spkgen2(r[k_22])) && ((m = x[j_21, k_22]) && check2(m, y, si))) then true else find k_20 <= N3 suchthat defined(r[k_20]) && (y = spkgen2(r[k_20])) then false else check(m, y, si) [3]
with rkS
Doing remove assignments of binder skS
Doing remove assignments of binder pkS
Doing equivalence
equiv ! !_11 <= N3 new r: skeyseed; (
  () -> spkgen(r) [2],
  ! !_12 <= N2 new r2: sseed; (x: sblocksize) -> sign(x, sskgen(r), r2),
  ! !_13 <= N (m1: sblocksize, si1: signature) -> check(m1, spkgen(r), si1)), ! !_14 <= N4 (m: sblocksize, y: spkey, si: signature) -> check(m, y, si) [3] [all]
<=(N3 * Psign(time, N2))=>
      ! !_15 <= N3 new r: skeyseed; (
  () -> spkgen2(r) [2],
  ! !_16 <= N2 new r2: sseed; (x_45: sblocksize) -> let x: sblocksize = x_45 in sign2(x, sskgen2(r), r2),
  ! !_17 <= N (m1: sblocksize, si1: signature) -> find j_19 <= N2 suchthat defined(x[j_19]) && ((m1 = x[j_19]) && check2(m1, spkgen(r), si1)) then true else false), ! !_18 <= N4 (m: sblocksize, y: spkey, si: signature) -> find j_21 <= N2, k_22 <= N3 suchthat defined(x[j_21, k_22], r[k_22]) && ((y = spkgen2(r[k_22])) && ((m = x[j_21, k_22]) && check2(m, y, si))) then true else find k_20 <= N3 suchthat defined(r[k_20]) && (y = spkgen2(r[k_20])) then false else check(m, y, si) [3]
with rkS
Doing simplify
Run simplify 2 time(s). Fixpoint reached.
Doing move new all binders
Doing remove assignments of useless
Please enter a command: crypto sign rkA
Doing equivalence
equiv ! !_11 <= N3 new r: skeyseed; (
  () -> spkgen(r) [2],
  ! !_12 <= N2 new r2: sseed; (x: sblocksize) -> sign(x, sskgen(r), r2),
  ! !_13 <= N (m1: sblocksize, si1: signature) -> check(m1, spkgen(r), si1)), ! !_14 <= N4 (m: sblocksize, y: spkey, si: signature) -> check(m, y, si) [3] [all]
<=(N3 * Psign(time, N2))=>
      ! !_15 <= N3 new r: skeyseed; (
  () -> spkgen2(r) [2],
  ! !_16 <= N2 new r2: sseed; (x_45: sblocksize) -> let x: sblocksize = x_45 in sign2(x, sskgen2(r), r2),
  ! !_17 <= N (m1: sblocksize, si1: signature) -> find j_19 <= N2 suchthat defined(x[j_19]) && ((m1 = x[j_19]) && check2(m1, spkgen(r), si1)) then true else false), ! !_18 <= N4 (m: sblocksize, y: spkey, si: signature) -> find j_21 <= N2, k_22 <= N3 suchthat defined(x[j_21, k_22], r[k_22]) && ((y = spkgen2(r[k_22])) && ((m = x[j_21, k_22]) && check2(m, y, si))) then true else find k_20 <= N3 suchthat defined(r[k_20]) && (y = spkgen2(r[k_20])) then false else check(m, y, si) [3]
with rkA
Doing remove assignments of binder skA
Doing remove assignments of binder pkA
Doing equivalence
equiv ! !_11 <= N3 new r: skeyseed; (
  () -> spkgen(r) [2],
  ! !_12 <= N2 new r2: sseed; (x: sblocksize) -> sign(x, sskgen(r), r2),
  ! !_13 <= N (m1: sblocksize, si1: signature) -> check(m1, spkgen(r), si1)), ! !_14 <= N4 (m: sblocksize, y: spkey, si: signature) -> check(m, y, si) [3] [all]
<=(N3 * Psign(time, N2))=>
      ! !_15 <= N3 new r: skeyseed; (
  () -> spkgen2(r) [2],
  ! !_16 <= N2 new r2: sseed; (x_45: sblocksize) -> let x: sblocksize = x_45 in sign2(x, sskgen2(r), r2),
  ! !_17 <= N (m1: sblocksize, si1: signature) -> find j_19 <= N2 suchthat defined(x[j_19]) && ((m1 = x[j_19]) && check2(m1, spkgen(r), si1)) then true else false), ! !_18 <= N4 (m: sblocksize, y: spkey, si: signature) -> find j_21 <= N2, k_22 <= N3 suchthat defined(x[j_21, k_22], r[k_22]) && ((y = spkgen2(r[k_22])) && ((m = x[j_21, k_22]) && check2(m, y, si))) then true else find k_20 <= N3 suchthat defined(r[k_20]) && (y = spkgen2(r[k_20])) then false else check(m, y, si) [3]
with rkA
Doing remove assignments of binder SRkey
Doing SA rename SRkey
Doing remove assignments of binder SRkey_130
Doing remove assignments of binder SRkey_129
Doing equivalence
equiv ! !_11 <= N3 new r: skeyseed; (
  () -> spkgen(r) [2],
  ! !_12 <= N2 new r2: sseed; (x: sblocksize) -> sign(x, sskgen(r), r2),
  ! !_13 <= N (m1: sblocksize, si1: signature) -> check(m1, spkgen(r), si1)), ! !_14 <= N4 (m: sblocksize, y: spkey, si: signature) -> check(m, y, si) [3] [all]
<=(N3 * Psign(time, N2))=>
      ! !_15 <= N3 new r: skeyseed; (
  () -> spkgen2(r) [2],
  ! !_16 <= N2 new r2: sseed; (x_45: sblocksize) -> let x: sblocksize = x_45 in sign2(x, sskgen2(r), r2),
  ! !_17 <= N (m1: sblocksize, si1: signature) -> find j_19 <= N2 suchthat defined(x[j_19]) && ((m1 = x[j_19]) && check2(m1, spkgen(r), si1)) then true else false), ! !_18 <= N4 (m: sblocksize, y: spkey, si: signature) -> find j_21 <= N2, k_22 <= N3 suchthat defined(x[j_21, k_22], r[k_22]) && ((y = spkgen2(r[k_22])) && ((m = x[j_21, k_22]) && check2(m, y, si))) then true else find k_20 <= N3 suchthat defined(r[k_20]) && (y = spkgen2(r[k_20])) then false else check(m, y, si) [3]
with r1, rkA
Doing simplify
Run simplify 2 time(s). Maximum reached.
Eliminated collisions between rkA and rkS Probability: 1. / |skeyseed|
Reduced (spkgen2(rkA) = spkgen2(rkS)) to (rkA = rkS) Probability: Psigncoll
Doing move new all binders
Doing remove assignments of useless
Please enter a command: show_game
in(start, ());
new rkS: skeyseed;
new rkB: keyseed;
new rkA: skeyseed;
out(c7, (spkgen2(rkA), pkgen2(rkB), spkgen2(rkS)));
(
  (
    (
      (
        (
          ! !_23 <= N
          in(c1[!_23], (=A, =spkgen2(rkA), cert1_41: signature, hostX: host, pkX: pkey, cert2_40: signature));
          find @i_122 <= N suchthat defined(SRkey_130[j2_31[@i_122]], x_71[@i_122]) && check2(concat4(A, spkgen2(rkA)), spkgen(rkS), cert1_41) then
          find @i_114 <= N suchthat defined(Kkey[j2_35[@i_114]], h2_33[@i_114], x_73[@i_114]) && (((hostX = h2_33[@i_114]) && (pkX = Kkey[j2_35[@i_114]])) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
            new k_42: shkey;
            event beginA(A, hostX, k_42);
            new r1: sseed;
            let x_145: sblocksize = concat2(k_42, A, hostX) in
            let x_65: blocksize = concat1(k_42, A, hostX, sign2(x_145, sskgen2(rkA), r1)) in
            if (pkX = pkgen2(rkB)) then
              new r2_137: seed;
              let m2_63: bitstring = enc2(Z, pkX, r2_137) in
              out(c2[!_23], (A, spkgen2(rkA), cert1_41, hostX, pkX, cert2_40, m2_63));
              in(finish[!_23], ());
              out(c8[!_23], k_42)
            else
              new r3_136: seed;
              out(c2[!_23], (A, spkgen2(rkA), cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_136)));
              in(finish[!_23], ());
              out(c8[!_23], k_42)
          orfind @i_113 <= N suchthat defined(h2_33[@i_113], x_75[@i_113]) && (((hostX = h2_33[@i_113]) && (pkX = pkgen2(rkB))) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
            new k_42: shkey;
            event beginA(A, hostX, k_42);
            new r1: sseed;
            new r2_138: seed;
            let m2_63: bitstring = enc2(Z, pkX, r2_138) in
            out(c2[!_23], (A, spkgen2(rkA), cert1_41, hostX, pkX, cert2_40, m2_63));
            in(finish[!_23], ());
            let keyA: shkey = k_42
        |
          ! !_24 <= N
          in(c3[!_24], (hostY: host, pkY: spkey, cert1_38: signature, =B, =pkgen2(rkB), cert2_37: signature, m: bitstring));
          find @i_108 <= N suchthat defined(SKkey[j2_31[@i_108]], h2_29[@i_108], SRkey_129[j2_31[@i_108]], x_71[@i_108]) && (((hostY = h2_29[@i_108]) && (pkY = SKkey[j2_31[@i_108]])) && check2(concat4(hostY, pkY), spkgen(rkS), cert1_38)) then
            find @i_99 <= N suchthat defined(x_75[@i_99]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37) then
            find @i_69 <= N suchthat defined(m2_63[@i_69]) && (m = m2_63[@i_69]) then
              yield
            else
              let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
              if (pkY = spkgen2(rkS)) then
                yield
              else
                if (pkY = spkgen2(rkA)) then
                  yield
                else
                  if check(concat2(k_39, hostY, B), pkY, s) then
                  out(c9[!_24], k_39)
          orfind @i_108 <= N suchthat defined(h2_29[@i_108], SRkey_130[j2_31[@i_108]], x_71[@i_108]) && (((hostY = h2_29[@i_108]) && (pkY = spkgen2(rkA))) && check2(concat4(hostY, pkY), spkgen(rkS), cert1_38)) then
            find @i_99 <= N suchthat defined(x_75[@i_99]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37) then
            find @i_69 <= N suchthat defined(r1[@i_69], k_42[@i_69], hostX[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
              if (B = hostX[@i_69]) then
              let x_141: sblocksize = cst_sblocksize in
              find @i_169 <= N suchthat defined(k_42[@i_69[@i_169]], x_141[@i_169]) && (k_42[@i_69] = k_42[@i_69[@i_169]]) then
              event endB(hostY, B, k_42[@i_69]);
              let keyB: shkey = k_42[@i_69]
            else
              let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
              find @i_162 <= N suchthat defined(k_42[@i_69[@i_162]], x_141[@i_162]) && ((k_39 = k_42[@i_69[@i_162]]) && check2(concat2(k_39, hostY, B), pkY, s)) then
              event endB(hostY, B, k_39);
              let keyB: shkey = k_39
        )
      |
        ! !_25 <= N
        in(c5[!_25], (h1_34: host, h2_33: host));
        find j2_35 <= N2 suchthat defined(Kkey[j2_35], Khost[j2_35], Rkey_59[j2_35]) && (Khost[j2_35] = h2_33) then
          let x_73: sblocksize = concat3(h2_33, Kkey[j2_35]) in
          new r3_61: sseed;
          out(c6[!_25], (h2_33, Kkey[j2_35], sign2(x_73, sskgen2(rkS), r3_61)))
        orfind j2_35 <= N2 suchthat defined(Khost[j2_35], Rkey_60[j2_35]) && (Khost[j2_35] = h2_33) then
          let x_75: sblocksize = concat3(h2_33, pkgen2(rkB)) in
          new r3_62: sseed;
          out(c6[!_25], (h2_33, pkgen2(rkB), sign2(x_75, sskgen2(rkS), r3_62)))
      )
    |
      ! !_26 <= N
      in(c11[!_26], (h1_30: host, h2_29: host));
      find j2_31 <= N2 suchthat defined(SKkey[j2_31], SKhost[j2_31], SRkey_129[j2_31]) && (SKhost[j2_31] = h2_29) then
        let x_71: sblocksize = concat4(h2_29, SKkey[j2_31]) in
        new r3_131: sseed;
        out(c12[!_26], (h2_29, SKkey[j2_31], sign2(x_71, sskgen2(rkS), r3_131)))
      orfind j2_31 <= N2 suchthat defined(SKhost[j2_31], SRkey_130[j2_31]) && (SKhost[j2_31] = h2_29) then
        let x_71: sblocksize = concat4(h2_29, spkgen2(rkA)) in
        new r3_132: sseed;
        out(c12[!_26], (h2_29, spkgen2(rkA), sign2(x_71, sskgen2(rkS), r3_132)))
    )
  |
    ! !_27 <= N2
    in(c4[!_27], (Khost: host, Kkey: pkey));
    if (Khost = B) then
      let Rkey_60: pkey = cst_pkey
    else
      let Rkey_59: pkey = cst_pkey
  )
|
  ! !_28 <= N2
  in(c10[!_28], (SKhost: host, SKkey: spkey));
  if (SKhost = A) then
    let SRkey_130: spkey = cst_spkey
  else
    let SRkey_129: spkey = cst_spkey
)

Please enter a command: SArename k_42
Doing SA rename k_42
Please enter a command: simplify
Doing simplify
Run simplify 2 time(s). Maximum reached.
Please enter a command: simplify
Doing simplify
Run simplify 1 time(s). Fixpoint reached.
Please enter a command: show_game
in(start, ());
new rkS: skeyseed;
new rkB: keyseed;
new rkA: skeyseed;
out(c7, (spkgen2(rkA), pkgen2(rkB), spkgen2(rkS)));
(
  (
    (
      (
        (
          ! !_23 <= N
          in(c1[!_23], (=A, =spkgen2(rkA), cert1_41: signature, hostX: host, pkX: pkey, cert2_40: signature));
          find @i_122 <= N suchthat defined(SRkey_130[j2_31[@i_122]], x_71[@i_122]) && check2(concat4(A, spkgen2(rkA)), spkgen(rkS), cert1_41) then
          find @i_114 <= N suchthat defined(Kkey[j2_35[@i_114]], h2_33[@i_114], x_73[@i_114]) && (((hostX = h2_33[@i_114]) && (pkX = Kkey[j2_35[@i_114]])) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
            new k_175: shkey;
            event beginA(A, hostX, k_175);
            new r1: sseed;
            let x_145: sblocksize = concat2(k_175, A, hostX) in
            let x_65: blocksize = concat1(k_175, A, hostX, sign2(x_145, sskgen2(rkA), r1)) in
            if (pkX = pkgen2(rkB)) then
              new r2_137: seed;
              let m2_63: bitstring = enc2(Z, pkX, r2_137) in
              out(c2[!_23], (A, spkgen2(rkA), cert1_41, hostX, pkX, cert2_40, m2_63));
              in(finish[!_23], ());
              out(c8[!_23], k_175)
            else
              new r3_136: seed;
              out(c2[!_23], (A, spkgen2(rkA), cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_136)));
              in(finish[!_23], ());
              out(c8[!_23], k_175)
          orfind @i_113 <= N suchthat defined(h2_33[@i_113], x_75[@i_113]) && (((hostX = h2_33[@i_113]) && (pkX = pkgen2(rkB))) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
            new k_176: shkey;
            event beginA(A, hostX, k_176);
            new r2_138: seed;
            let m2_63: bitstring = enc2(Z, pkX, r2_138) in
            out(c2[!_23], (A, spkgen2(rkA), cert1_41, hostX, pkX, cert2_40, m2_63));
            in(finish[!_23], ());
            let keyA: shkey = k_176
        |
          ! !_24 <= N
          in(c3[!_24], (hostY: host, pkY: spkey, cert1_38: signature, =B, =pkgen2(rkB), cert2_37: signature, m: bitstring));
          find @i_108 <= N suchthat defined(SKkey[j2_31[@i_108]], h2_29[@i_108], SRkey_129[j2_31[@i_108]], x_71[@i_108]) && (((hostY = h2_29[@i_108]) && (pkY = SKkey[j2_31[@i_108]])) && check2(concat4(hostY, pkY), spkgen(rkS), cert1_38)) then
            find @i_99 <= N suchthat defined(x_75[@i_99]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37) then
            find @i_69 <= N suchthat defined(m2_63[@i_69]) && (m = m2_63[@i_69]) then
              yield
            else
              let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
              if (pkY = spkgen2(rkS)) then
                yield
              else
                if (pkY = spkgen2(rkA)) then
                  yield
                else
                  if check(concat2(k_39, hostY, B), pkY, s) then
                  out(c9[!_24], k_39)
          orfind @i_108 <= N suchthat defined(h2_29[@i_108], SRkey_130[j2_31[@i_108]], x_71[@i_108]) && (((hostY = h2_29[@i_108]) && (pkY = spkgen2(rkA))) && check2(concat4(hostY, pkY), spkgen(rkS), cert1_38)) then
            find @i_99 <= N suchthat defined(x_75[@i_99]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37) then
            find @i_69 <= N suchthat defined(m2_63[@i_69], k_175[@i_69]) && (m = m2_63[@i_69]) then
              yield
            orfind @i_69 <= N suchthat defined(k_176[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
              let x_141: sblocksize = cst_sblocksize in
              find @i_169 <= N suchthat defined(k_176[@i_69[@i_169]], x_141[@i_169]) && (k_176[@i_69] = k_176[@i_69[@i_169]]) then
              event endB(hostY, B, k_176[@i_69]);
              let keyB: shkey = k_176[@i_69]
            else
              let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
              find @i_162 <= N suchthat defined(k_176[@i_69[@i_162]], x_141[@i_162]) && ((k_39 = k_176[@i_69[@i_162]]) && check2(concat2(k_39, hostY, B), pkY, s)) then
              event endB(hostY, B, k_39);
              let keyB: shkey = k_39
        )
      |
        ! !_25 <= N
        in(c5[!_25], (h1_34: host, h2_33: host));
        find j2_35 <= N2 suchthat defined(Kkey[j2_35], Khost[j2_35], Rkey_59[j2_35]) && (Khost[j2_35] = h2_33) then
          let x_73: sblocksize = concat3(h2_33, Kkey[j2_35]) in
          new r3_61: sseed;
          out(c6[!_25], (h2_33, Kkey[j2_35], sign2(x_73, sskgen2(rkS), r3_61)))
        orfind j2_35 <= N2 suchthat defined(Khost[j2_35], Rkey_60[j2_35]) && (Khost[j2_35] = h2_33) then
          let x_75: sblocksize = concat3(h2_33, pkgen2(rkB)) in
          new r3_62: sseed;
          out(c6[!_25], (h2_33, pkgen2(rkB), sign2(x_75, sskgen2(rkS), r3_62)))
      )
    |
      ! !_26 <= N
      in(c11[!_26], (h1_30: host, h2_29: host));
      find j2_31 <= N2 suchthat defined(SKkey[j2_31], SKhost[j2_31], SRkey_129[j2_31]) && (SKhost[j2_31] = h2_29) then
        let x_71: sblocksize = concat4(h2_29, SKkey[j2_31]) in
        new r3_131: sseed;
        out(c12[!_26], (h2_29, SKkey[j2_31], sign2(x_71, sskgen2(rkS), r3_131)))
      orfind j2_31 <= N2 suchthat defined(SKhost[j2_31], SRkey_130[j2_31]) && (SKhost[j2_31] = h2_29) then
        let x_71: sblocksize = concat4(h2_29, spkgen2(rkA)) in
        new r3_132: sseed;
        out(c12[!_26], (h2_29, spkgen2(rkA), sign2(x_71, sskgen2(rkS), r3_132)))
    )
  |
    ! !_27 <= N2
    in(c4[!_27], (Khost: host, Kkey: pkey));
    if (Khost = B) then
      let Rkey_60: pkey = cst_pkey
    else
      let Rkey_59: pkey = cst_pkey
  )
|
  ! !_28 <= N2
  in(c10[!_28], (SKhost: host, SKkey: spkey));
  if (SKhost = A) then
    let SRkey_130: spkey = cst_spkey
  else
    let SRkey_129: spkey = cst_spkey
)

Please enter a command: show_state
Initial state
Game 1 is
in(start, ());
new rkA: skeyseed;
let pkA: spkey = spkgen(rkA) in
let skA: sskey = sskgen(rkA) in
new rkB: keyseed;
let pkB: pkey = pkgen(rkB) in
let skB: skey = skgen(rkB) in
new rkS: skeyseed;
let pkS: spkey = spkgen(rkS) in
let skS: sskey = sskgen(rkS) in
out(c7, (pkA, pkB, pkS));
(
  (
    (
      (
        (
          ! !_23 <= N
          in(c1[!_23], (=A, =pkA, cert1_41: signature, hostX: host, pkX: pkey, cert2_40: signature));
          if check(concat4(A, pkA), pkS, cert1_41) then
          if check(concat3(hostX, pkX), pkS, cert2_40) then
          new k_42: shkey;
          new r1: sseed;
          new r2: seed;
          event beginA(A, hostX, k_42);
          out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, enc(concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)), pkX, r2)));
          in(finish[!_23], ());
          if (hostX = B) then
            let keyA: shkey = k_42
          else
            out(c8[!_23], k_42)
        |
          ! !_24 <= N
          in(c3[!_24], (hostY: host, pkY: spkey, cert1_38: signature, =B, =pkB, cert2_37: signature, m: bitstring));
          if check(concat4(hostY, pkY), pkS, cert1_38) then
          if check(concat3(B, pkB), pkS, cert2_37) then
          let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec(m, skB) in
          if check(concat2(k_39, hostY, B), pkY, s) then
          if (hostY = A) then
            event endB(hostY, B, k_39);
            let keyB: shkey = k_39
          else
            out(c9[!_24], k_39)
        )
      |
        ! !_25 <= N
        in(c5[!_25], (h1_34: host, h2_33: host));
        find j2_35 <= N2 suchthat defined(Khost[j2_35], Rkey[j2_35]) && (Khost[j2_35] = h2_33) then
        new r3_36: sseed;
        out(c6[!_25], (h2_33, Rkey[j2_35], sign(concat3(h2_33, Rkey[j2_35]), skS, r3_36)))
      )
    |
      ! !_26 <= N
      in(c11[!_26], (h1_30: host, h2_29: host));
      find j2_31 <= N2 suchthat defined(SKhost[j2_31], SRkey[j2_31]) && (SKhost[j2_31] = h2_29) then
      new r3_32: sseed;
      out(c12[!_26], (h2_29, SRkey[j2_31], sign(concat4(h2_29, SRkey[j2_31]), skS, r3_32)))
    )
  |
    ! !_27 <= N2
    in(c4[!_27], (Khost: host, Kkey: pkey));
    let Rkey: pkey = if (Khost = B) then pkB else Kkey
  )
|
  ! !_28 <= N2
  in(c10[!_28], (SKhost: host, SKkey: spkey));
  let SRkey: spkey = if (SKhost = A) then pkA else SKkey
)


Applying expand if, let, find yields

Game 2 is
in(start, ());
new rkA: skeyseed;
let pkA: spkey = spkgen(rkA) in
let skA: sskey = sskgen(rkA) in
new rkB: keyseed;
let pkB: pkey = pkgen(rkB) in
let skB: skey = skgen(rkB) in
new rkS: skeyseed;
let pkS: spkey = spkgen(rkS) in
let skS: sskey = sskgen(rkS) in
out(c7, (pkA, pkB, pkS));
(
  (
    (
      (
        (
          ! !_23 <= N
          in(c1[!_23], (=A, =pkA, cert1_41: signature, hostX: host, pkX: pkey, cert2_40: signature));
          if check(concat4(A, pkA), pkS, cert1_41) then
          if check(concat3(hostX, pkX), pkS, cert2_40) then
          new k_42: shkey;
          new r1: sseed;
          new r2: seed;
          event beginA(A, hostX, k_42);
          out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, enc(concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)), pkX, r2)));
          in(finish[!_23], ());
          if (hostX = B) then
            let keyA: shkey = k_42
          else
            out(c8[!_23], k_42)
        |
          ! !_24 <= N
          in(c3[!_24], (hostY: host, pkY: spkey, cert1_38: signature, =B, =pkB, cert2_37: signature, m: bitstring));
          if check(concat4(hostY, pkY), pkS, cert1_38) then
          if check(concat3(B, pkB), pkS, cert2_37) then
          let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec(m, skB) in
          if check(concat2(k_39, hostY, B), pkY, s) then
          if (hostY = A) then
            event endB(hostY, B, k_39);
            let keyB: shkey = k_39
          else
            out(c9[!_24], k_39)
        )
      |
        ! !_25 <= N
        in(c5[!_25], (h1_34: host, h2_33: host));
        find j2_35 <= N2 suchthat defined(Khost[j2_35], Rkey[j2_35]) && (Khost[j2_35] = h2_33) then
        new r3_36: sseed;
        out(c6[!_25], (h2_33, Rkey[j2_35], sign(concat3(h2_33, Rkey[j2_35]), skS, r3_36)))
      )
    |
      ! !_26 <= N
      in(c11[!_26], (h1_30: host, h2_29: host));
      find j2_31 <= N2 suchthat defined(SKhost[j2_31], SRkey[j2_31]) && (SKhost[j2_31] = h2_29) then
      new r3_32: sseed;
      out(c12[!_26], (h2_29, SRkey[j2_31], sign(concat4(h2_29, SRkey[j2_31]), skS, r3_32)))
    )
  |
    ! !_27 <= N2
    in(c4[!_27], (Khost: host, Kkey: pkey));
    if (Khost = B) then
      let Rkey: pkey = pkB
    else
      let Rkey: pkey = Kkey
  )
|
  ! !_28 <= N2
  in(c10[!_28], (SKhost: host, SKkey: spkey));
  if (SKhost = A) then
    let SRkey: spkey = pkA
  else
    let SRkey: spkey = SKkey
)


Applying move new all binders yields

Game 3 is
in(start, ());
new rkA: skeyseed;
let pkA: spkey = spkgen(rkA) in
let skA: sskey = sskgen(rkA) in
new rkB: keyseed;
let pkB: pkey = pkgen(rkB) in
let skB: skey = skgen(rkB) in
new rkS: skeyseed;
let pkS: spkey = spkgen(rkS) in
let skS: sskey = sskgen(rkS) in
out(c7, (pkA, pkB, pkS));
(
  (
    (
      (
        (
          ! !_23 <= N
          in(c1[!_23], (=A, =pkA, cert1_41: signature, hostX: host, pkX: pkey, cert2_40: signature));
          if check(concat4(A, pkA), pkS, cert1_41) then
          if check(concat3(hostX, pkX), pkS, cert2_40) then
          new k_42: shkey;
          event beginA(A, hostX, k_42);
          new r2: seed;
          new r1: sseed;
          out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, enc(concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)), pkX, r2)));
          in(finish[!_23], ());
          if (hostX = B) then
            let keyA: shkey = k_42
          else
            out(c8[!_23], k_42)
        |
          ! !_24 <= N
          in(c3[!_24], (hostY: host, pkY: spkey, cert1_38: signature, =B, =pkB, cert2_37: signature, m: bitstring));
          if check(concat4(hostY, pkY), pkS, cert1_38) then
          if check(concat3(B, pkB), pkS, cert2_37) then
          let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec(m, skB) in
          if check(concat2(k_39, hostY, B), pkY, s) then
          if (hostY = A) then
            event endB(hostY, B, k_39);
            let keyB: shkey = k_39
          else
            out(c9[!_24], k_39)
        )
      |
        ! !_25 <= N
        in(c5[!_25], (h1_34: host, h2_33: host));
        find j2_35 <= N2 suchthat defined(Khost[j2_35], Rkey[j2_35]) && (Khost[j2_35] = h2_33) then
        new r3_36: sseed;
        out(c6[!_25], (h2_33, Rkey[j2_35], sign(concat3(h2_33, Rkey[j2_35]), skS, r3_36)))
      )
    |
      ! !_26 <= N
      in(c11[!_26], (h1_30: host, h2_29: host));
      find j2_31 <= N2 suchthat defined(SKhost[j2_31], SRkey[j2_31]) && (SKhost[j2_31] = h2_29) then
      new r3_32: sseed;
      out(c12[!_26], (h2_29, SRkey[j2_31], sign(concat4(h2_29, SRkey[j2_31]), skS, r3_32)))
    )
  |
    ! !_27 <= N2
    in(c4[!_27], (Khost: host, Kkey: pkey));
    if (Khost = B) then
      let Rkey: pkey = pkB
    else
      let Rkey: pkey = Kkey
  )
|
  ! !_28 <= N2
  in(c10[!_28], (SKhost: host, SKkey: spkey));
  if (SKhost = A) then
    let SRkey: spkey = pkA
  else
    let SRkey: spkey = SKkey
)


Applying remove assignments of binder skB yields

Game 4 is
in(start, ());
new rkA: skeyseed;
let pkA: spkey = spkgen(rkA) in
let skA: sskey = sskgen(rkA) in
new rkB: keyseed;
let pkB: pkey = pkgen(rkB) in
new rkS: skeyseed;
let pkS: spkey = spkgen(rkS) in
let skS: sskey = sskgen(rkS) in
out(c7, (pkA, pkB, pkS));
(
  (
    (
      (
        (
          ! !_23 <= N
          in(c1[!_23], (=A, =pkA, cert1_41: signature, hostX: host, pkX: pkey, cert2_40: signature));
          if check(concat4(A, pkA), pkS, cert1_41) then
          if check(concat3(hostX, pkX), pkS, cert2_40) then
          new k_42: shkey;
          event beginA(A, hostX, k_42);
          new r2: seed;
          new r1: sseed;
          out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, enc(concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)), pkX, r2)));
          in(finish[!_23], ());
          if (hostX = B) then
            let keyA: shkey = k_42
          else
            out(c8[!_23], k_42)
        |
          ! !_24 <= N
          in(c3[!_24], (hostY: host, pkY: spkey, cert1_38: signature, =B, =pkB, cert2_37: signature, m: bitstring));
          if check(concat4(hostY, pkY), pkS, cert1_38) then
          if check(concat3(B, pkB), pkS, cert2_37) then
          let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec(m, skgen(rkB)) in
          if check(concat2(k_39, hostY, B), pkY, s) then
          if (hostY = A) then
            event endB(hostY, B, k_39);
            let keyB: shkey = k_39
          else
            out(c9[!_24], k_39)
        )
      |
        ! !_25 <= N
        in(c5[!_25], (h1_34: host, h2_33: host));
        find j2_35 <= N2 suchthat defined(Khost[j2_35], Rkey[j2_35]) && (Khost[j2_35] = h2_33) then
        new r3_36: sseed;
        out(c6[!_25], (h2_33, Rkey[j2_35], sign(concat3(h2_33, Rkey[j2_35]), skS, r3_36)))
      )
    |
      ! !_26 <= N
      in(c11[!_26], (h1_30: host, h2_29: host));
      find j2_31 <= N2 suchthat defined(SKhost[j2_31], SRkey[j2_31]) && (SKhost[j2_31] = h2_29) then
      new r3_32: sseed;
      out(c12[!_26], (h2_29, SRkey[j2_31], sign(concat4(h2_29, SRkey[j2_31]), skS, r3_32)))
    )
  |
    ! !_27 <= N2
    in(c4[!_27], (Khost: host, Kkey: pkey));
    if (Khost = B) then
      let Rkey: pkey = pkB
    else
      let Rkey: pkey = Kkey
  )
|
  ! !_28 <= N2
  in(c10[!_28], (SKhost: host, SKkey: spkey));
  if (SKhost = A) then
    let SRkey: spkey = pkA
  else
    let SRkey: spkey = SKkey
)


Applying remove assignments of binder pkB yields

Game 5 is
in(start, ());
new rkA: skeyseed;
let pkA: spkey = spkgen(rkA) in
let skA: sskey = sskgen(rkA) in
new rkB: keyseed;
new rkS: skeyseed;
let pkS: spkey = spkgen(rkS) in
let skS: sskey = sskgen(rkS) in
out(c7, (pkA, pkgen(rkB), pkS));
(
  (
    (
      (
        (
          ! !_23 <= N
          in(c1[!_23], (=A, =pkA, cert1_41: signature, hostX: host, pkX: pkey, cert2_40: signature));
          if check(concat4(A, pkA), pkS, cert1_41) then
          if check(concat3(hostX, pkX), pkS, cert2_40) then
          new k_42: shkey;
          event beginA(A, hostX, k_42);
          new r2: seed;
          new r1: sseed;
          out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, enc(concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)), pkX, r2)));
          in(finish[!_23], ());
          if (hostX = B) then
            let keyA: shkey = k_42
          else
            out(c8[!_23], k_42)
        |
          ! !_24 <= N
          in(c3[!_24], (hostY: host, pkY: spkey, cert1_38: signature, =B, =pkgen(rkB), cert2_37: signature, m: bitstring));
          if check(concat4(hostY, pkY), pkS, cert1_38) then
          if check(concat3(B, pkgen(rkB)), pkS, cert2_37) then
          let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec(m, skgen(rkB)) in
          if check(concat2(k_39, hostY, B), pkY, s) then
          if (hostY = A) then
            event endB(hostY, B, k_39);
            let keyB: shkey = k_39
          else
            out(c9[!_24], k_39)
        )
      |
        ! !_25 <= N
        in(c5[!_25], (h1_34: host, h2_33: host));
        find j2_35 <= N2 suchthat defined(Khost[j2_35], Rkey[j2_35]) && (Khost[j2_35] = h2_33) then
        new r3_36: sseed;
        out(c6[!_25], (h2_33, Rkey[j2_35], sign(concat3(h2_33, Rkey[j2_35]), skS, r3_36)))
      )
    |
      ! !_26 <= N
      in(c11[!_26], (h1_30: host, h2_29: host));
      find j2_31 <= N2 suchthat defined(SKhost[j2_31], SRkey[j2_31]) && (SKhost[j2_31] = h2_29) then
      new r3_32: sseed;
      out(c12[!_26], (h2_29, SRkey[j2_31], sign(concat4(h2_29, SRkey[j2_31]), skS, r3_32)))
    )
  |
    ! !_27 <= N2
    in(c4[!_27], (Khost: host, Kkey: pkey));
    if (Khost = B) then
      let Rkey: pkey = pkgen(rkB)
    else
      let Rkey: pkey = Kkey
  )
|
  ! !_28 <= N2
  in(c10[!_28], (SKhost: host, SKkey: spkey));
  if (SKhost = A) then
    let SRkey: spkey = pkA
  else
    let SRkey: spkey = SKkey
)


Applying SA rename Rkey yields

Game 6 is
in(start, ());
new rkA: skeyseed;
let pkA: spkey = spkgen(rkA) in
let skA: sskey = sskgen(rkA) in
new rkB: keyseed;
new rkS: skeyseed;
let pkS: spkey = spkgen(rkS) in
let skS: sskey = sskgen(rkS) in
out(c7, (pkA, pkgen(rkB), pkS));
(
  (
    (
      (
        (
          ! !_23 <= N
          in(c1[!_23], (=A, =pkA, cert1_41: signature, hostX: host, pkX: pkey, cert2_40: signature));
          if check(concat4(A, pkA), pkS, cert1_41) then
          if check(concat3(hostX, pkX), pkS, cert2_40) then
          new k_42: shkey;
          event beginA(A, hostX, k_42);
          new r2: seed;
          new r1: sseed;
          out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, enc(concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)), pkX, r2)));
          in(finish[!_23], ());
          if (hostX = B) then
            let keyA: shkey = k_42
          else
            out(c8[!_23], k_42)
        |
          ! !_24 <= N
          in(c3[!_24], (hostY: host, pkY: spkey, cert1_38: signature, =B, =pkgen(rkB), cert2_37: signature, m: bitstring));
          if check(concat4(hostY, pkY), pkS, cert1_38) then
          if check(concat3(B, pkgen(rkB)), pkS, cert2_37) then
          let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec(m, skgen(rkB)) in
          if check(concat2(k_39, hostY, B), pkY, s) then
          if (hostY = A) then
            event endB(hostY, B, k_39);
            let keyB: shkey = k_39
          else
            out(c9[!_24], k_39)
        )
      |
        ! !_25 <= N
        in(c5[!_25], (h1_34: host, h2_33: host));
        find j2_35 <= N2 suchthat defined(Khost[j2_35], Rkey_59[j2_35]) && (Khost[j2_35] = h2_33) then
          new r3_36: sseed;
          out(c6[!_25], (h2_33, Rkey_59[j2_35], sign(concat3(h2_33, Rkey_59[j2_35]), skS, r3_36)))
        orfind j2_35 <= N2 suchthat defined(Khost[j2_35], Rkey_60[j2_35]) && (Khost[j2_35] = h2_33) then
          new r3_36: sseed;
          out(c6[!_25], (h2_33, Rkey_60[j2_35], sign(concat3(h2_33, Rkey_60[j2_35]), skS, r3_36)))
      )
    |
      ! !_26 <= N
      in(c11[!_26], (h1_30: host, h2_29: host));
      find j2_31 <= N2 suchthat defined(SKhost[j2_31], SRkey[j2_31]) && (SKhost[j2_31] = h2_29) then
      new r3_32: sseed;
      out(c12[!_26], (h2_29, SRkey[j2_31], sign(concat4(h2_29, SRkey[j2_31]), skS, r3_32)))
    )
  |
    ! !_27 <= N2
    in(c4[!_27], (Khost: host, Kkey: pkey));
    if (Khost = B) then
      let Rkey_60: pkey = pkgen(rkB)
    else
      let Rkey_59: pkey = Kkey
  )
|
  ! !_28 <= N2
  in(c10[!_28], (SKhost: host, SKkey: spkey));
  if (SKhost = A) then
    let SRkey: spkey = pkA
  else
    let SRkey: spkey = SKkey
)


Applying remove assignments of binder Rkey_60 yields

Game 7 is
in(start, ());
new rkA: skeyseed;
let pkA: spkey = spkgen(rkA) in
let skA: sskey = sskgen(rkA) in
new rkB: keyseed;
new rkS: skeyseed;
let pkS: spkey = spkgen(rkS) in
let skS: sskey = sskgen(rkS) in
out(c7, (pkA, pkgen(rkB), pkS));
(
  (
    (
      (
        (
          ! !_23 <= N
          in(c1[!_23], (=A, =pkA, cert1_41: signature, hostX: host, pkX: pkey, cert2_40: signature));
          if check(concat4(A, pkA), pkS, cert1_41) then
          if check(concat3(hostX, pkX), pkS, cert2_40) then
          new k_42: shkey;
          event beginA(A, hostX, k_42);
          new r2: seed;
          new r1: sseed;
          out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, enc(concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)), pkX, r2)));
          in(finish[!_23], ());
          if (hostX = B) then
            let keyA: shkey = k_42
          else
            out(c8[!_23], k_42)
        |
          ! !_24 <= N
          in(c3[!_24], (hostY: host, pkY: spkey, cert1_38: signature, =B, =pkgen(rkB), cert2_37: signature, m: bitstring));
          if check(concat4(hostY, pkY), pkS, cert1_38) then
          if check(concat3(B, pkgen(rkB)), pkS, cert2_37) then
          let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec(m, skgen(rkB)) in
          if check(concat2(k_39, hostY, B), pkY, s) then
          if (hostY = A) then
            event endB(hostY, B, k_39);
            let keyB: shkey = k_39
          else
            out(c9[!_24], k_39)
        )
      |
        ! !_25 <= N
        in(c5[!_25], (h1_34: host, h2_33: host));
        find j2_35 <= N2 suchthat defined(Kkey[j2_35], Rkey_59[j2_35], Khost[j2_35]) && (Khost[j2_35] = h2_33) then
          new r3_61: sseed;
          out(c6[!_25], (h2_33, Kkey[j2_35], sign(concat3(h2_33, Kkey[j2_35]), skS, r3_61)))
        orfind j2_35 <= N2 suchthat defined(rkB, Rkey_60[j2_35], Khost[j2_35]) && (Khost[j2_35] = h2_33) then
          new r3_62: sseed;
          out(c6[!_25], (h2_33, pkgen(rkB), sign(concat3(h2_33, pkgen(rkB)), skS, r3_62)))
      )
    |
      ! !_26 <= N
      in(c11[!_26], (h1_30: host, h2_29: host));
      find j2_31 <= N2 suchthat defined(SKhost[j2_31], SRkey[j2_31]) && (SKhost[j2_31] = h2_29) then
      new r3_32: sseed;
      out(c12[!_26], (h2_29, SRkey[j2_31], sign(concat4(h2_29, SRkey[j2_31]), skS, r3_32)))
    )
  |
    ! !_27 <= N2
    in(c4[!_27], (Khost: host, Kkey: pkey));
    if (Khost = B) then
      let Rkey_60: pkey = cst_pkey
    else
      let Rkey_59: pkey = cst_pkey
  )
|
  ! !_28 <= N2
  in(c10[!_28], (SKhost: host, SKkey: spkey));
  if (SKhost = A) then
    let SRkey: spkey = pkA
  else
    let SRkey: spkey = SKkey
)


Applying equivalence
equiv ! !_1 <= N3 new r: keyseed; (
  () -> pkgen(r) [2],
  ! !_2 <= N2 (m: bitstring) -> dec(m, skgen(r)),
  ! !_3 <= N new r1: seed; (x1: blocksize) -> enc(x1, pkgen(r), r1)), ! !_4 <= N4 new r2: seed; (x: blocksize, y: pkey) -> enc(x, y, r2) [3] [all]
<=(N3 * N4 * Penc(time, N2))=>
      ! !_5 <= N3 new r: keyseed; (
  () -> pkgen2(r) [2],
  ! !_6 <= N2 (m: bitstring) -> find j_10 <= N suchthat defined(m1[j_10], x1[j_10]) && (m = m1[j_10]) then injbot(x1[j_10]) else find j_9 <= N4 suchthat defined(m2[j_9], y[j_9], x[j_9]) && ((y[j_9] = pkgen2(r)) && (m = m2[j_9])) then injbot(x[j_9]) else dec2(m, skgen2(r)),
  ! !_7 <= N new r1: seed; (x1_46: blocksize) -> let x1: blocksize = x1_46 in let m1: bitstring = enc2(Z, pkgen2(r), r1) in m1), ! !_8 <= N4 new r2: seed; new r3: seed; (x_48: blocksize, y_47: pkey) -> let x: blocksize = x_48 in let y: pkey = y_47 in find k <= N3 suchthat defined(r[k]) && (y = pkgen2(r[k])) then let m2: bitstring = enc2(Z, y, r2) in m2 else enc(x, y, r3) [3]
with r2, rkB [Difference of probability N * Penc(time + time(context for game 7), N)] yields

Game 8 is
in(start, ());
new rkA: skeyseed;
let pkA: spkey = spkgen(rkA) in
let skA: sskey = sskgen(rkA) in
new rkB: keyseed;
new rkS: skeyseed;
let pkS: spkey = spkgen(rkS) in
let skS: sskey = sskgen(rkS) in
out(c7, (pkA, pkgen2(rkB), pkS));
(
  (
    (
      (
        (
          ! !_23 <= N
          in(c1[!_23], (=A, =pkA, cert1_41: signature, hostX: host, pkX: pkey, cert2_40: signature));
          if check(concat4(A, pkA), pkS, cert1_41) then
          if check(concat3(hostX, pkX), pkS, cert2_40) then
          new k_42: shkey;
          event beginA(A, hostX, k_42);
          new r2: seed;
          new r3_66: seed;
          new r1: sseed;
          let x_65: blocksize = concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)) in
          let y_64: pkey = pkX in
          if defined(rkB) && (y_64 = pkgen2(rkB)) then
            let m2_63: bitstring = enc2(Z, y_64, r2) in
            out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, m2_63));
            in(finish[!_23], ());
            if (hostX = B) then
              let keyA: shkey = k_42
            else
              out(c8[!_23], k_42)
          else
            out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, enc(x_65, y_64, r3_66)));
            in(finish[!_23], ());
            if (hostX = B) then
              let keyA: shkey = k_42
            else
              out(c8[!_23], k_42)
        |
          ! !_24 <= N
          in(c3[!_24], (hostY: host, pkY: spkey, cert1_38: signature, =B, =pkgen2(rkB), cert2_37: signature, m: bitstring));
          if check(concat4(hostY, pkY), pkS, cert1_38) then
          if check(concat3(B, pkgen2(rkB)), pkS, cert2_37) then
          find           else
            find @i_69 <= N suchthat defined(m2_63[@i_69], y_64[@i_69], x_65[@i_69]) && ((y_64[@i_69] = pkgen2(rkB)) && (m = m2_63[@i_69])) then
              let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = injbot(x_65[@i_69]) in
              if check(concat2(k_39, hostY, B), pkY, s) then
              if (hostY = A) then
                event endB(hostY, B, k_39);
                let keyB: shkey = k_39
              else
                out(c9[!_24], k_39)
            else
              let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
              if check(concat2(k_39, hostY, B), pkY, s) then
              if (hostY = A) then
                event endB(hostY, B, k_39);
                let keyB: shkey = k_39
              else
                out(c9[!_24], k_39)
        )
      |
        ! !_25 <= N
        in(c5[!_25], (h1_34: host, h2_33: host));
        find j2_35 <= N2 suchthat defined(Kkey[j2_35], Rkey_59[j2_35], Khost[j2_35]) && (Khost[j2_35] = h2_33) then
          new r3_61: sseed;
          out(c6[!_25], (h2_33, Kkey[j2_35], sign(concat3(h2_33, Kkey[j2_35]), skS, r3_61)))
        orfind j2_35 <= N2 suchthat defined(rkB, Rkey_60[j2_35], Khost[j2_35]) && (Khost[j2_35] = h2_33) then
          new r3_62: sseed;
          out(c6[!_25], (h2_33, pkgen2(rkB), sign(concat3(h2_33, pkgen2(rkB)), skS, r3_62)))
      )
    |
      ! !_26 <= N
      in(c11[!_26], (h1_30: host, h2_29: host));
      find j2_31 <= N2 suchthat defined(SKhost[j2_31], SRkey[j2_31]) && (SKhost[j2_31] = h2_29) then
      new r3_32: sseed;
      out(c12[!_26], (h2_29, SRkey[j2_31], sign(concat4(h2_29, SRkey[j2_31]), skS, r3_32)))
    )
  |
    ! !_27 <= N2
    in(c4[!_27], (Khost: host, Kkey: pkey));
    if (Khost = B) then
      let Rkey_60: pkey = cst_pkey
    else
      let Rkey_59: pkey = cst_pkey
  )
|
  ! !_28 <= N2
  in(c10[!_28], (SKhost: host, SKkey: spkey));
  if (SKhost = A) then
    let SRkey: spkey = pkA
  else
    let SRkey: spkey = SKkey
)


Applying simplify yields

Game 9 is
in(start, ());
new rkA: skeyseed;
let pkA: spkey = spkgen(rkA) in
let skA: sskey = sskgen(rkA) in
new rkB: keyseed;
new rkS: skeyseed;
let pkS: spkey = spkgen(rkS) in
let skS: sskey = sskgen(rkS) in
out(c7, (pkA, pkgen2(rkB), pkS));
(
  (
    (
      (
        (
          ! !_23 <= N
          in(c1[!_23], (=A, =pkA, cert1_41: signature, hostX: host, pkX: pkey, cert2_40: signature));
          if check(concat4(A, pkA), pkS, cert1_41) then
          if check(concat3(hostX, pkX), pkS, cert2_40) then
          new k_42: shkey;
          event beginA(A, hostX, k_42);
          new r2: seed;
          new r3_66: seed;
          new r1: sseed;
          let x_65: blocksize = concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)) in
          let y_64: pkey = pkX in
          if (y_64 = pkgen2(rkB)) then
            let m2_63: bitstring = enc2(Z, y_64, r2) in
            out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, m2_63));
            in(finish[!_23], ());
            if (hostX = B) then
              let keyA: shkey = k_42
            else
              out(c8[!_23], k_42)
          else
            out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, enc(x_65, y_64, r3_66)));
            in(finish[!_23], ());
            if (hostX = B) then
              let keyA: shkey = k_42
            else
              out(c8[!_23], k_42)
        |
          ! !_24 <= N
          in(c3[!_24], (hostY: host, pkY: spkey, cert1_38: signature, =B, =pkgen2(rkB), cert2_37: signature, m: bitstring));
          if check(concat4(hostY, pkY), pkS, cert1_38) then
          if check(concat3(B, pkgen2(rkB)), pkS, cert2_37) then
          find @i_69 <= N suchthat defined(r1[@i_69], hostX[@i_69], k_42[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
            let k_39: shkey = k_42[@i_69] in
            if (hostY = A) then
            if (B = hostX[@i_69]) then
            let s: signature = sign(concat2(k_42[@i_69], A, hostX[@i_69]), skA, r1[@i_69]) in
            if check(concat2(k_39, hostY, B), pkY, s) then
            event endB(hostY, B, k_39);
            let keyB: shkey = k_39
          else
            let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
            if check(concat2(k_39, hostY, B), pkY, s) then
            if (hostY = A) then
              event endB(hostY, B, k_39);
              let keyB: shkey = k_39
            else
              out(c9[!_24], k_39)
        )
      |
        ! !_25 <= N
        in(c5[!_25], (h1_34: host, h2_33: host));
        find j2_35 <= N2 suchthat defined(Kkey[j2_35], Khost[j2_35], Rkey_59[j2_35]) && (Khost[j2_35] = h2_33) then
          new r3_61: sseed;
          out(c6[!_25], (h2_33, Kkey[j2_35], sign(concat3(h2_33, Kkey[j2_35]), skS, r3_61)))
        orfind j2_35 <= N2 suchthat defined(Khost[j2_35], Rkey_60[j2_35]) && (Khost[j2_35] = h2_33) then
          new r3_62: sseed;
          out(c6[!_25], (h2_33, pkgen2(rkB), sign(concat3(h2_33, pkgen2(rkB)), skS, r3_62)))
      )
    |
      ! !_26 <= N
      in(c11[!_26], (h1_30: host, h2_29: host));
      find j2_31 <= N2 suchthat defined(SRkey[j2_31], SKhost[j2_31]) && (SKhost[j2_31] = h2_29) then
      new r3_32: sseed;
      out(c12[!_26], (h2_29, SRkey[j2_31], sign(concat4(h2_29, SRkey[j2_31]), skS, r3_32)))
    )
  |
    ! !_27 <= N2
    in(c4[!_27], (Khost: host, Kkey: pkey));
    if (Khost = B) then
      let Rkey_60: pkey = cst_pkey
    else
      let Rkey_59: pkey = cst_pkey
  )
|
  ! !_28 <= N2
  in(c10[!_28], (SKhost: host, SKkey: spkey));
  if (SKhost = A) then
    let SRkey: spkey = pkA
  else
    let SRkey: spkey = SKkey
)


Applying move new all binders yields

Game 10 is
in(start, ());
new rkA: skeyseed;
let pkA: spkey = spkgen(rkA) in
let skA: sskey = sskgen(rkA) in
new rkS: skeyseed;
let pkS: spkey = spkgen(rkS) in
let skS: sskey = sskgen(rkS) in
new rkB: keyseed;
out(c7, (pkA, pkgen2(rkB), pkS));
(
  (
    (
      (
        (
          ! !_23 <= N
          in(c1[!_23], (=A, =pkA, cert1_41: signature, hostX: host, pkX: pkey, cert2_40: signature));
          if check(concat4(A, pkA), pkS, cert1_41) then
          if check(concat3(hostX, pkX), pkS, cert2_40) then
          new k_42: shkey;
          event beginA(A, hostX, k_42);
          new r1: sseed;
          let x_65: blocksize = concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)) in
          let y_64: pkey = pkX in
          if (y_64 = pkgen2(rkB)) then
            new r2: seed;
            let m2_63: bitstring = enc2(Z, y_64, r2) in
            out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, m2_63));
            in(finish[!_23], ());
            if (hostX = B) then
              let keyA: shkey = k_42
            else
              out(c8[!_23], k_42)
          else
            new r3_66: seed;
            out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, enc(x_65, y_64, r3_66)));
            in(finish[!_23], ());
            if (hostX = B) then
              let keyA: shkey = k_42
            else
              out(c8[!_23], k_42)
        |
          ! !_24 <= N
          in(c3[!_24], (hostY: host, pkY: spkey, cert1_38: signature, =B, =pkgen2(rkB), cert2_37: signature, m: bitstring));
          if check(concat4(hostY, pkY), pkS, cert1_38) then
          if check(concat3(B, pkgen2(rkB)), pkS, cert2_37) then
          find @i_69 <= N suchthat defined(r1[@i_69], hostX[@i_69], k_42[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
            let k_39: shkey = k_42[@i_69] in
            if (hostY = A) then
            if (B = hostX[@i_69]) then
            let s: signature = sign(concat2(k_42[@i_69], A, hostX[@i_69]), skA, r1[@i_69]) in
            if check(concat2(k_39, hostY, B), pkY, s) then
            event endB(hostY, B, k_39);
            let keyB: shkey = k_39
          else
            let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
            if check(concat2(k_39, hostY, B), pkY, s) then
            if (hostY = A) then
              event endB(hostY, B, k_39);
              let keyB: shkey = k_39
            else
              out(c9[!_24], k_39)
        )
      |
        ! !_25 <= N
        in(c5[!_25], (h1_34: host, h2_33: host));
        find j2_35 <= N2 suchthat defined(Kkey[j2_35], Khost[j2_35], Rkey_59[j2_35]) && (Khost[j2_35] = h2_33) then
          new r3_61: sseed;
          out(c6[!_25], (h2_33, Kkey[j2_35], sign(concat3(h2_33, Kkey[j2_35]), skS, r3_61)))
        orfind j2_35 <= N2 suchthat defined(Khost[j2_35], Rkey_60[j2_35]) && (Khost[j2_35] = h2_33) then
          new r3_62: sseed;
          out(c6[!_25], (h2_33, pkgen2(rkB), sign(concat3(h2_33, pkgen2(rkB)), skS, r3_62)))
      )
    |
      ! !_26 <= N
      in(c11[!_26], (h1_30: host, h2_29: host));
      find j2_31 <= N2 suchthat defined(SRkey[j2_31], SKhost[j2_31]) && (SKhost[j2_31] = h2_29) then
      new r3_32: sseed;
      out(c12[!_26], (h2_29, SRkey[j2_31], sign(concat4(h2_29, SRkey[j2_31]), skS, r3_32)))
    )
  |
    ! !_27 <= N2
    in(c4[!_27], (Khost: host, Kkey: pkey));
    if (Khost = B) then
      let Rkey_60: pkey = cst_pkey
    else
      let Rkey_59: pkey = cst_pkey
  )
|
  ! !_28 <= N2
  in(c10[!_28], (SKhost: host, SKkey: spkey));
  if (SKhost = A) then
    let SRkey: spkey = pkA
  else
    let SRkey: spkey = SKkey
)


Applying remove assignments of useless yields

Game 11 is
in(start, ());
new rkA: skeyseed;
let pkA: spkey = spkgen(rkA) in
let skA: sskey = sskgen(rkA) in
new rkS: skeyseed;
let pkS: spkey = spkgen(rkS) in
let skS: sskey = sskgen(rkS) in
new rkB: keyseed;
out(c7, (pkA, pkgen2(rkB), pkS));
(
  (
    (
      (
        (
          ! !_23 <= N
          in(c1[!_23], (=A, =pkA, cert1_41: signature, hostX: host, pkX: pkey, cert2_40: signature));
          if check(concat4(A, pkA), pkS, cert1_41) then
          if check(concat3(hostX, pkX), pkS, cert2_40) then
          new k_42: shkey;
          event beginA(A, hostX, k_42);
          new r1: sseed;
          let x_65: blocksize = concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)) in
          if (pkX = pkgen2(rkB)) then
            new r2: seed;
            let m2_63: bitstring = enc2(Z, pkX, r2) in
            out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, m2_63));
            in(finish[!_23], ());
            if (hostX = B) then
              let keyA: shkey = k_42
            else
              out(c8[!_23], k_42)
          else
            new r3_66: seed;
            out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_66)));
            in(finish[!_23], ());
            if (hostX = B) then
              let keyA: shkey = k_42
            else
              out(c8[!_23], k_42)
        |
          ! !_24 <= N
          in(c3[!_24], (hostY: host, pkY: spkey, cert1_38: signature, =B, =pkgen2(rkB), cert2_37: signature, m: bitstring));
          if check(concat4(hostY, pkY), pkS, cert1_38) then
          if check(concat3(B, pkgen2(rkB)), pkS, cert2_37) then
          find @i_69 <= N suchthat defined(r1[@i_69], hostX[@i_69], k_42[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
            if (hostY = A) then
            if (B = hostX[@i_69]) then
            let s: signature = sign(concat2(k_42[@i_69], A, hostX[@i_69]), skA, r1[@i_69]) in
            if check(concat2(k_42[@i_69], hostY, B), pkY, s) then
            event endB(hostY, B, k_42[@i_69]);
            let keyB: shkey = k_42[@i_69]
          else
            let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
            if check(concat2(k_39, hostY, B), pkY, s) then
            if (hostY = A) then
              event endB(hostY, B, k_39);
              let keyB: shkey = k_39
            else
              out(c9[!_24], k_39)
        )
      |
        ! !_25 <= N
        in(c5[!_25], (h1_34: host, h2_33: host));
        find j2_35 <= N2 suchthat defined(Kkey[j2_35], Khost[j2_35], Rkey_59[j2_35]) && (Khost[j2_35] = h2_33) then
          new r3_61: sseed;
          out(c6[!_25], (h2_33, Kkey[j2_35], sign(concat3(h2_33, Kkey[j2_35]), skS, r3_61)))
        orfind j2_35 <= N2 suchthat defined(Khost[j2_35], Rkey_60[j2_35]) && (Khost[j2_35] = h2_33) then
          new r3_62: sseed;
          out(c6[!_25], (h2_33, pkgen2(rkB), sign(concat3(h2_33, pkgen2(rkB)), skS, r3_62)))
      )
    |
      ! !_26 <= N
      in(c11[!_26], (h1_30: host, h2_29: host));
      find j2_31 <= N2 suchthat defined(SRkey[j2_31], SKhost[j2_31]) && (SKhost[j2_31] = h2_29) then
      new r3_32: sseed;
      out(c12[!_26], (h2_29, SRkey[j2_31], sign(concat4(h2_29, SRkey[j2_31]), skS, r3_32)))
    )
  |
    ! !_27 <= N2
    in(c4[!_27], (Khost: host, Kkey: pkey));
    if (Khost = B) then
      let Rkey_60: pkey = cst_pkey
    else
      let Rkey_59: pkey = cst_pkey
  )
|
  ! !_28 <= N2
  in(c10[!_28], (SKhost: host, SKkey: spkey));
  if (SKhost = A) then
    let SRkey: spkey = pkA
  else
    let SRkey: spkey = SKkey
)


Applying remove assignments of binder skS yields

Game 12 is
in(start, ());
new rkA: skeyseed;
let pkA: spkey = spkgen(rkA) in
let skA: sskey = sskgen(rkA) in
new rkS: skeyseed;
let pkS: spkey = spkgen(rkS) in
new rkB: keyseed;
out(c7, (pkA, pkgen2(rkB), pkS));
(
  (
    (
      (
        (
          ! !_23 <= N
          in(c1[!_23], (=A, =pkA, cert1_41: signature, hostX: host, pkX: pkey, cert2_40: signature));
          if check(concat4(A, pkA), pkS, cert1_41) then
          if check(concat3(hostX, pkX), pkS, cert2_40) then
          new k_42: shkey;
          event beginA(A, hostX, k_42);
          new r1: sseed;
          let x_65: blocksize = concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)) in
          if (pkX = pkgen2(rkB)) then
            new r2: seed;
            let m2_63: bitstring = enc2(Z, pkX, r2) in
            out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, m2_63));
            in(finish[!_23], ());
            if (hostX = B) then
              let keyA: shkey = k_42
            else
              out(c8[!_23], k_42)
          else
            new r3_66: seed;
            out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_66)));
            in(finish[!_23], ());
            if (hostX = B) then
              let keyA: shkey = k_42
            else
              out(c8[!_23], k_42)
        |
          ! !_24 <= N
          in(c3[!_24], (hostY: host, pkY: spkey, cert1_38: signature, =B, =pkgen2(rkB), cert2_37: signature, m: bitstring));
          if check(concat4(hostY, pkY), pkS, cert1_38) then
          if check(concat3(B, pkgen2(rkB)), pkS, cert2_37) then
          find @i_69 <= N suchthat defined(r1[@i_69], hostX[@i_69], k_42[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
            if (hostY = A) then
            if (B = hostX[@i_69]) then
            let s: signature = sign(concat2(k_42[@i_69], A, hostX[@i_69]), skA, r1[@i_69]) in
            if check(concat2(k_42[@i_69], hostY, B), pkY, s) then
            event endB(hostY, B, k_42[@i_69]);
            let keyB: shkey = k_42[@i_69]
          else
            let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
            if check(concat2(k_39, hostY, B), pkY, s) then
            if (hostY = A) then
              event endB(hostY, B, k_39);
              let keyB: shkey = k_39
            else
              out(c9[!_24], k_39)
        )
      |
        ! !_25 <= N
        in(c5[!_25], (h1_34: host, h2_33: host));
        find j2_35 <= N2 suchthat defined(Kkey[j2_35], Khost[j2_35], Rkey_59[j2_35]) && (Khost[j2_35] = h2_33) then
          new r3_61: sseed;
          out(c6[!_25], (h2_33, Kkey[j2_35], sign(concat3(h2_33, Kkey[j2_35]), sskgen(rkS), r3_61)))
        orfind j2_35 <= N2 suchthat defined(Khost[j2_35], Rkey_60[j2_35]) && (Khost[j2_35] = h2_33) then
          new r3_62: sseed;
          out(c6[!_25], (h2_33, pkgen2(rkB), sign(concat3(h2_33, pkgen2(rkB)), sskgen(rkS), r3_62)))
      )
    |
      ! !_26 <= N
      in(c11[!_26], (h1_30: host, h2_29: host));
      find j2_31 <= N2 suchthat defined(SRkey[j2_31], SKhost[j2_31]) && (SKhost[j2_31] = h2_29) then
      new r3_32: sseed;
      out(c12[!_26], (h2_29, SRkey[j2_31], sign(concat4(h2_29, SRkey[j2_31]), sskgen(rkS), r3_32)))
    )
  |
    ! !_27 <= N2
    in(c4[!_27], (Khost: host, Kkey: pkey));
    if (Khost = B) then
      let Rkey_60: pkey = cst_pkey
    else
      let Rkey_59: pkey = cst_pkey
  )
|
  ! !_28 <= N2
  in(c10[!_28], (SKhost: host, SKkey: spkey));
  if (SKhost = A) then
    let SRkey: spkey = pkA
  else
    let SRkey: spkey = SKkey
)


Applying remove assignments of binder pkS yields

Game 13 is
in(start, ());
new rkA: skeyseed;
let pkA: spkey = spkgen(rkA) in
let skA: sskey = sskgen(rkA) in
new rkS: skeyseed;
new rkB: keyseed;
out(c7, (pkA, pkgen2(rkB), spkgen(rkS)));
(
  (
    (
      (
        (
          ! !_23 <= N
          in(c1[!_23], (=A, =pkA, cert1_41: signature, hostX: host, pkX: pkey, cert2_40: signature));
          if check(concat4(A, pkA), spkgen(rkS), cert1_41) then
          if check(concat3(hostX, pkX), spkgen(rkS), cert2_40) then
          new k_42: shkey;
          event beginA(A, hostX, k_42);
          new r1: sseed;
          let x_65: blocksize = concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)) in
          if (pkX = pkgen2(rkB)) then
            new r2: seed;
            let m2_63: bitstring = enc2(Z, pkX, r2) in
            out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, m2_63));
            in(finish[!_23], ());
            if (hostX = B) then
              let keyA: shkey = k_42
            else
              out(c8[!_23], k_42)
          else
            new r3_66: seed;
            out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_66)));
            in(finish[!_23], ());
            if (hostX = B) then
              let keyA: shkey = k_42
            else
              out(c8[!_23], k_42)
        |
          ! !_24 <= N
          in(c3[!_24], (hostY: host, pkY: spkey, cert1_38: signature, =B, =pkgen2(rkB), cert2_37: signature, m: bitstring));
          if check(concat4(hostY, pkY), spkgen(rkS), cert1_38) then
          if check(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37) then
          find @i_69 <= N suchthat defined(r1[@i_69], hostX[@i_69], k_42[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
            if (hostY = A) then
            if (B = hostX[@i_69]) then
            let s: signature = sign(concat2(k_42[@i_69], A, hostX[@i_69]), skA, r1[@i_69]) in
            if check(concat2(k_42[@i_69], hostY, B), pkY, s) then
            event endB(hostY, B, k_42[@i_69]);
            let keyB: shkey = k_42[@i_69]
          else
            let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
            if check(concat2(k_39, hostY, B), pkY, s) then
            if (hostY = A) then
              event endB(hostY, B, k_39);
              let keyB: shkey = k_39
            else
              out(c9[!_24], k_39)
        )
      |
        ! !_25 <= N
        in(c5[!_25], (h1_34: host, h2_33: host));
        find j2_35 <= N2 suchthat defined(Kkey[j2_35], Khost[j2_35], Rkey_59[j2_35]) && (Khost[j2_35] = h2_33) then
          new r3_61: sseed;
          out(c6[!_25], (h2_33, Kkey[j2_35], sign(concat3(h2_33, Kkey[j2_35]), sskgen(rkS), r3_61)))
        orfind j2_35 <= N2 suchthat defined(Khost[j2_35], Rkey_60[j2_35]) && (Khost[j2_35] = h2_33) then
          new r3_62: sseed;
          out(c6[!_25], (h2_33, pkgen2(rkB), sign(concat3(h2_33, pkgen2(rkB)), sskgen(rkS), r3_62)))
      )
    |
      ! !_26 <= N
      in(c11[!_26], (h1_30: host, h2_29: host));
      find j2_31 <= N2 suchthat defined(SRkey[j2_31], SKhost[j2_31]) && (SKhost[j2_31] = h2_29) then
      new r3_32: sseed;
      out(c12[!_26], (h2_29, SRkey[j2_31], sign(concat4(h2_29, SRkey[j2_31]), sskgen(rkS), r3_32)))
    )
  |
    ! !_27 <= N2
    in(c4[!_27], (Khost: host, Kkey: pkey));
    if (Khost = B) then
      let Rkey_60: pkey = cst_pkey
    else
      let Rkey_59: pkey = cst_pkey
  )
|
  ! !_28 <= N2
  in(c10[!_28], (SKhost: host, SKkey: spkey));
  if (SKhost = A) then
    let SRkey: spkey = pkA
  else
    let SRkey: spkey = SKkey
)


Applying equivalence
equiv ! !_11 <= N3 new r: skeyseed; (
  () -> spkgen(r) [2],
  ! !_12 <= N2 new r2: sseed; (x: sblocksize) -> sign(x, sskgen(r), r2),
  ! !_13 <= N (m1: sblocksize, si1: signature) -> check(m1, spkgen(r), si1)), ! !_14 <= N4 (m: sblocksize, y: spkey, si: signature) -> check(m, y, si) [3] [all]
<=(N3 * Psign(time, N2))=>
      ! !_15 <= N3 new r: skeyseed; (
  () -> spkgen2(r) [2],
  ! !_16 <= N2 new r2: sseed; (x_45: sblocksize) -> let x: sblocksize = x_45 in sign2(x, sskgen2(r), r2),
  ! !_17 <= N (m1: sblocksize, si1: signature) -> find j_19 <= N2 suchthat defined(x[j_19]) && ((m1 = x[j_19]) && check2(m1, spkgen(r), si1)) then true else false), ! !_18 <= N4 (m: sblocksize, y: spkey, si: signature) -> find j_21 <= N2, k_22 <= N3 suchthat defined(x[j_21, k_22], r[k_22]) && ((y = spkgen2(r[k_22])) && ((m = x[j_21, k_22]) && check2(m, y, si))) then true else find k_20 <= N3 suchthat defined(r[k_20]) && (y = spkgen2(r[k_20])) then false else check(m, y, si) [3]
with rkS [Difference of probability Psign(time + time(context for game 13), 2. * N)] yields

Game 14 is
in(start, ());
new rkA: skeyseed;
let pkA: spkey = spkgen(rkA) in
let skA: sskey = sskgen(rkA) in
new rkS: skeyseed;
new rkB: keyseed;
out(c7, (pkA, pkgen2(rkB), spkgen2(rkS)));
(
  (
    (
      (
        (
          ! !_23 <= N
          in(c1[!_23], (=A, =pkA, cert1_41: signature, hostX: host, pkX: pkey, cert2_40: signature));
          find @i_122 <= N suchthat defined(x_71[@i_122]) && ((concat4(A, pkA) = x_71[@i_122]) && check2(concat4(A, pkA), spkgen(rkS), cert1_41)) then
            if true then
            find @i_115 <= N suchthat defined(x_71[@i_115]) && ((concat3(hostX, pkX) = x_71[@i_115]) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
              if true then
              new k_42: shkey;
              event beginA(A, hostX, k_42);
              new r1: sseed;
              let x_65: blocksize = concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)) in
              if (pkX = pkgen2(rkB)) then
                new r2: seed;
                let m2_63: bitstring = enc2(Z, pkX, r2) in
                out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, m2_63));
                in(finish[!_23], ());
                if (hostX = B) then
                  let keyA: shkey = k_42
                else
                  out(c8[!_23], k_42)
              else
                new r3_66: seed;
                out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_66)));
                in(finish[!_23], ());
                if (hostX = B) then
                  let keyA: shkey = k_42
                else
                  out(c8[!_23], k_42)
            orfind @i_114 <= N suchthat defined(x_73[@i_114]) && ((concat3(hostX, pkX) = x_73[@i_114]) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
              if true then
              new k_42: shkey;
              event beginA(A, hostX, k_42);
              new r1: sseed;
              let x_65: blocksize = concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)) in
              if (pkX = pkgen2(rkB)) then
                new r2: seed;
                let m2_63: bitstring = enc2(Z, pkX, r2) in
                out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, m2_63));
                in(finish[!_23], ());
                if (hostX = B) then
                  let keyA: shkey = k_42
                else
                  out(c8[!_23], k_42)
              else
                new r3_66: seed;
                out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_66)));
                in(finish[!_23], ());
                if (hostX = B) then
                  let keyA: shkey = k_42
                else
                  out(c8[!_23], k_42)
            orfind @i_113 <= N suchthat defined(x_75[@i_113]) && ((concat3(hostX, pkX) = x_75[@i_113]) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
              if true then
              new k_42: shkey;
              event beginA(A, hostX, k_42);
              new r1: sseed;
              let x_65: blocksize = concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)) in
              if (pkX = pkgen2(rkB)) then
                new r2: seed;
                let m2_63: bitstring = enc2(Z, pkX, r2) in
                out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, m2_63));
                in(finish[!_23], ());
                if (hostX = B) then
                  let keyA: shkey = k_42
                else
                  out(c8[!_23], k_42)
              else
                new r3_66: seed;
                out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_66)));
                in(finish[!_23], ());
                if (hostX = B) then
                  let keyA: shkey = k_42
                else
                  out(c8[!_23], k_42)
            else
              if false then
              new k_42: shkey;
              event beginA(A, hostX, k_42);
              new r1: sseed;
              let x_65: blocksize = concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)) in
              if (pkX = pkgen2(rkB)) then
                new r2: seed;
                let m2_63: bitstring = enc2(Z, pkX, r2) in
                out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, m2_63));
                in(finish[!_23], ());
                if (hostX = B) then
                  let keyA: shkey = k_42
                else
                  out(c8[!_23], k_42)
              else
                new r3_66: seed;
                out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_66)));
                in(finish[!_23], ());
                if (hostX = B) then
                  let keyA: shkey = k_42
                else
                  out(c8[!_23], k_42)
          orfind @i_121 <= N suchthat defined(x_73[@i_121]) && ((concat4(A, pkA) = x_73[@i_121]) && check2(concat4(A, pkA), spkgen(rkS), cert1_41)) then
            if true then
            find @i_115 <= N suchthat defined(x_71[@i_115]) && ((concat3(hostX, pkX) = x_71[@i_115]) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
              if true then
              new k_42: shkey;
              event beginA(A, hostX, k_42);
              new r1: sseed;
              let x_65: blocksize = concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)) in
              if (pkX = pkgen2(rkB)) then
                new r2: seed;
                let m2_63: bitstring = enc2(Z, pkX, r2) in
                out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, m2_63));
                in(finish[!_23], ());
                if (hostX = B) then
                  let keyA: shkey = k_42
                else
                  out(c8[!_23], k_42)
              else
                new r3_66: seed;
                out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_66)));
                in(finish[!_23], ());
                if (hostX = B) then
                  let keyA: shkey = k_42
                else
                  out(c8[!_23], k_42)
            orfind @i_114 <= N suchthat defined(x_73[@i_114]) && ((concat3(hostX, pkX) = x_73[@i_114]) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
              if true then
              new k_42: shkey;
              event beginA(A, hostX, k_42);
              new r1: sseed;
              let x_65: blocksize = concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)) in
              if (pkX = pkgen2(rkB)) then
                new r2: seed;
                let m2_63: bitstring = enc2(Z, pkX, r2) in
                out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, m2_63));
                in(finish[!_23], ());
                if (hostX = B) then
                  let keyA: shkey = k_42
                else
                  out(c8[!_23], k_42)
              else
                new r3_66: seed;
                out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_66)));
                in(finish[!_23], ());
                if (hostX = B) then
                  let keyA: shkey = k_42
                else
                  out(c8[!_23], k_42)
            orfind @i_113 <= N suchthat defined(x_75[@i_113]) && ((concat3(hostX, pkX) = x_75[@i_113]) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
              if true then
              new k_42: shkey;
              event beginA(A, hostX, k_42);
              new r1: sseed;
              let x_65: blocksize = concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)) in
              if (pkX = pkgen2(rkB)) then
                new r2: seed;
                let m2_63: bitstring = enc2(Z, pkX, r2) in
                out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, m2_63));
                in(finish[!_23], ());
                if (hostX = B) then
                  let keyA: shkey = k_42
                else
                  out(c8[!_23], k_42)
              else
                new r3_66: seed;
                out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_66)));
                in(finish[!_23], ());
                if (hostX = B) then
                  let keyA: shkey = k_42
                else
                  out(c8[!_23], k_42)
            else
              if false then
              new k_42: shkey;
              event beginA(A, hostX, k_42);
              new r1: sseed;
              let x_65: blocksize = concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)) in
              if (pkX = pkgen2(rkB)) then
                new r2: seed;
                let m2_63: bitstring = enc2(Z, pkX, r2) in
                out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, m2_63));
                in(finish[!_23], ());
                if (hostX = B) then
                  let keyA: shkey = k_42
                else
                  out(c8[!_23], k_42)
              else
                new r3_66: seed;
                out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_66)));
                in(finish[!_23], ());
                if (hostX = B) then
                  let keyA: shkey = k_42
                else
                  out(c8[!_23], k_42)
          orfind @i_120 <= N suchthat defined(x_75[@i_120]) && ((concat4(A, pkA) = x_75[@i_120]) && check2(concat4(A, pkA), spkgen(rkS), cert1_41)) then
            if true then
            find @i_115 <= N suchthat defined(x_71[@i_115]) && ((concat3(hostX, pkX) = x_71[@i_115]) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
              if true then
              new k_42: shkey;
              event beginA(A, hostX, k_42);
              new r1: sseed;
              let x_65: blocksize = concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)) in
              if (pkX = pkgen2(rkB)) then
                new r2: seed;
                let m2_63: bitstring = enc2(Z, pkX, r2) in
                out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, m2_63));
                in(finish[!_23], ());
                if (hostX = B) then
                  let keyA: shkey = k_42
                else
                  out(c8[!_23], k_42)
              else
                new r3_66: seed;
                out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_66)));
                in(finish[!_23], ());
                if (hostX = B) then
                  let keyA: shkey = k_42
                else
                  out(c8[!_23], k_42)
            orfind @i_114 <= N suchthat defined(x_73[@i_114]) && ((concat3(hostX, pkX) = x_73[@i_114]) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
              if true then
              new k_42: shkey;
              event beginA(A, hostX, k_42);
              new r1: sseed;
              let x_65: blocksize = concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)) in
              if (pkX = pkgen2(rkB)) then
                new r2: seed;
                let m2_63: bitstring = enc2(Z, pkX, r2) in
                out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, m2_63));
                in(finish[!_23], ());
                if (hostX = B) then
                  let keyA: shkey = k_42
                else
                  out(c8[!_23], k_42)
              else
                new r3_66: seed;
                out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_66)));
                in(finish[!_23], ());
                if (hostX = B) then
                  let keyA: shkey = k_42
                else
                  out(c8[!_23], k_42)
            orfind @i_113 <= N suchthat defined(x_75[@i_113]) && ((concat3(hostX, pkX) = x_75[@i_113]) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
              if true then
              new k_42: shkey;
              event beginA(A, hostX, k_42);
              new r1: sseed;
              let x_65: blocksize = concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)) in
              if (pkX = pkgen2(rkB)) then
                new r2: seed;
                let m2_63: bitstring = enc2(Z, pkX, r2) in
                out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, m2_63));
                in(finish[!_23], ());
                if (hostX = B) then
                  let keyA: shkey = k_42
                else
                  out(c8[!_23], k_42)
              else
                new r3_66: seed;
                out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_66)));
                in(finish[!_23], ());
                if (hostX = B) then
                  let keyA: shkey = k_42
                else
                  out(c8[!_23], k_42)
            else
              if false then
              new k_42: shkey;
              event beginA(A, hostX, k_42);
              new r1: sseed;
              let x_65: blocksize = concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)) in
              if (pkX = pkgen2(rkB)) then
                new r2: seed;
                let m2_63: bitstring = enc2(Z, pkX, r2) in
                out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, m2_63));
                in(finish[!_23], ());
                if (hostX = B) then
                  let keyA: shkey = k_42
                else
                  out(c8[!_23], k_42)
              else
                new r3_66: seed;
                out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_66)));
                in(finish[!_23], ());
                if (hostX = B) then
                  let keyA: shkey = k_42
                else
                  out(c8[!_23], k_42)
          else
            if false then
            find @i_115 <= N suchthat defined(x_71[@i_115]) && ((concat3(hostX, pkX) = x_71[@i_115]) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
              if true then
              new k_42: shkey;
              event beginA(A, hostX, k_42);
              new r1: sseed;
              let x_65: blocksize = concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)) in
              if (pkX = pkgen2(rkB)) then
                new r2: seed;
                let m2_63: bitstring = enc2(Z, pkX, r2) in
                out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, m2_63));
                in(finish[!_23], ());
                if (hostX = B) then
                  let keyA: shkey = k_42
                else
                  out(c8[!_23], k_42)
              else
                new r3_66: seed;
                out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_66)));
                in(finish[!_23], ());
                if (hostX = B) then
                  let keyA: shkey = k_42
                else
                  out(c8[!_23], k_42)
            orfind @i_114 <= N suchthat defined(x_73[@i_114]) && ((concat3(hostX, pkX) = x_73[@i_114]) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
              if true then
              new k_42: shkey;
              event beginA(A, hostX, k_42);
              new r1: sseed;
              let x_65: blocksize = concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)) in
              if (pkX = pkgen2(rkB)) then
                new r2: seed;
                let m2_63: bitstring = enc2(Z, pkX, r2) in
                out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, m2_63));
                in(finish[!_23], ());
                if (hostX = B) then
                  let keyA: shkey = k_42
                else
                  out(c8[!_23], k_42)
              else
                new r3_66: seed;
                out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_66)));
                in(finish[!_23], ());
                if (hostX = B) then
                  let keyA: shkey = k_42
                else
                  out(c8[!_23], k_42)
            orfind @i_113 <= N suchthat defined(x_75[@i_113]) && ((concat3(hostX, pkX) = x_75[@i_113]) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
              if true then
              new k_42: shkey;
              event beginA(A, hostX, k_42);
              new r1: sseed;
              let x_65: blocksize = concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)) in
              if (pkX = pkgen2(rkB)) then
                new r2: seed;
                let m2_63: bitstring = enc2(Z, pkX, r2) in
                out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, m2_63));
                in(finish[!_23], ());
                if (hostX = B) then
                  let keyA: shkey = k_42
                else
                  out(c8[!_23], k_42)
              else
                new r3_66: seed;
                out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_66)));
                in(finish[!_23], ());
                if (hostX = B) then
                  let keyA: shkey = k_42
                else
                  out(c8[!_23], k_42)
            else
              if false then
              new k_42: shkey;
              event beginA(A, hostX, k_42);
              new r1: sseed;
              let x_65: blocksize = concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)) in
              if (pkX = pkgen2(rkB)) then
                new r2: seed;
                let m2_63: bitstring = enc2(Z, pkX, r2) in
                out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, m2_63));
                in(finish[!_23], ());
                if (hostX = B) then
                  let keyA: shkey = k_42
                else
                  out(c8[!_23], k_42)
              else
                new r3_66: seed;
                out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_66)));
                in(finish[!_23], ());
                if (hostX = B) then
                  let keyA: shkey = k_42
                else
                  out(c8[!_23], k_42)
        |
          ! !_24 <= N
          in(c3[!_24], (hostY: host, pkY: spkey, cert1_38: signature, =B, =pkgen2(rkB), cert2_37: signature, m: bitstring));
          find @i_108 <= N suchthat defined(x_71[@i_108]) && ((concat4(hostY, pkY) = x_71[@i_108]) && check2(concat4(hostY, pkY), spkgen(rkS), cert1_38)) then
            if true then
            find @i_101 <= N suchthat defined(x_71[@i_101]) && ((concat3(B, pkgen2(rkB)) = x_71[@i_101]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37)) then
              if true then
              find @i_69 <= N suchthat defined(r1[@i_69], hostX[@i_69], k_42[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
                if (hostY = A) then
                if (B = hostX[@i_69]) then
                let s: signature = sign(concat2(k_42[@i_69], A, hostX[@i_69]), skA, r1[@i_69]) in
                find @i_92 <= N suchthat defined(x_71[@i_92], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_71[@i_92]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_91 <= N suchthat defined(x_73[@i_91], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_73[@i_91]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_90 <= N suchthat defined(x_75[@i_90], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_75[@i_90]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                else
                  if defined(rkS) && (pkY = spkgen2(rkS)) then
                    if false then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
                  else
                    if check(concat2(k_42[@i_69], hostY, B), pkY, s) then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
              else
                let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
                find @i_83 <= N suchthat defined(x_71[@i_83], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_71[@i_83]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_82 <= N suchthat defined(x_73[@i_82], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_73[@i_82]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_81 <= N suchthat defined(x_75[@i_81], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_75[@i_81]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                else
                  if defined(rkS) && (pkY = spkgen2(rkS)) then
                    if false then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
                  else
                    if check(concat2(k_39, hostY, B), pkY, s) then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
            orfind @i_100 <= N suchthat defined(x_73[@i_100]) && ((concat3(B, pkgen2(rkB)) = x_73[@i_100]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37)) then
              if true then
              find @i_69 <= N suchthat defined(r1[@i_69], hostX[@i_69], k_42[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
                if (hostY = A) then
                if (B = hostX[@i_69]) then
                let s: signature = sign(concat2(k_42[@i_69], A, hostX[@i_69]), skA, r1[@i_69]) in
                find @i_92 <= N suchthat defined(x_71[@i_92], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_71[@i_92]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_91 <= N suchthat defined(x_73[@i_91], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_73[@i_91]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_90 <= N suchthat defined(x_75[@i_90], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_75[@i_90]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                else
                  if defined(rkS) && (pkY = spkgen2(rkS)) then
                    if false then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
                  else
                    if check(concat2(k_42[@i_69], hostY, B), pkY, s) then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
              else
                let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
                find @i_83 <= N suchthat defined(x_71[@i_83], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_71[@i_83]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_82 <= N suchthat defined(x_73[@i_82], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_73[@i_82]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_81 <= N suchthat defined(x_75[@i_81], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_75[@i_81]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                else
                  if defined(rkS) && (pkY = spkgen2(rkS)) then
                    if false then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
                  else
                    if check(concat2(k_39, hostY, B), pkY, s) then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
            orfind @i_99 <= N suchthat defined(x_75[@i_99]) && ((concat3(B, pkgen2(rkB)) = x_75[@i_99]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37)) then
              if true then
              find @i_69 <= N suchthat defined(r1[@i_69], hostX[@i_69], k_42[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
                if (hostY = A) then
                if (B = hostX[@i_69]) then
                let s: signature = sign(concat2(k_42[@i_69], A, hostX[@i_69]), skA, r1[@i_69]) in
                find @i_92 <= N suchthat defined(x_71[@i_92], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_71[@i_92]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_91 <= N suchthat defined(x_73[@i_91], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_73[@i_91]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_90 <= N suchthat defined(x_75[@i_90], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_75[@i_90]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                else
                  if defined(rkS) && (pkY = spkgen2(rkS)) then
                    if false then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
                  else
                    if check(concat2(k_42[@i_69], hostY, B), pkY, s) then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
              else
                let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
                find @i_83 <= N suchthat defined(x_71[@i_83], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_71[@i_83]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_82 <= N suchthat defined(x_73[@i_82], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_73[@i_82]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_81 <= N suchthat defined(x_75[@i_81], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_75[@i_81]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                else
                  if defined(rkS) && (pkY = spkgen2(rkS)) then
                    if false then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
                  else
                    if check(concat2(k_39, hostY, B), pkY, s) then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
            else
              if false then
              find @i_69 <= N suchthat defined(r1[@i_69], hostX[@i_69], k_42[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
                if (hostY = A) then
                if (B = hostX[@i_69]) then
                let s: signature = sign(concat2(k_42[@i_69], A, hostX[@i_69]), skA, r1[@i_69]) in
                find @i_92 <= N suchthat defined(x_71[@i_92], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_71[@i_92]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_91 <= N suchthat defined(x_73[@i_91], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_73[@i_91]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_90 <= N suchthat defined(x_75[@i_90], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_75[@i_90]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                else
                  if defined(rkS) && (pkY = spkgen2(rkS)) then
                    if false then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
                  else
                    if check(concat2(k_42[@i_69], hostY, B), pkY, s) then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
              else
                let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
                find @i_83 <= N suchthat defined(x_71[@i_83], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_71[@i_83]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_82 <= N suchthat defined(x_73[@i_82], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_73[@i_82]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_81 <= N suchthat defined(x_75[@i_81], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_75[@i_81]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                else
                  if defined(rkS) && (pkY = spkgen2(rkS)) then
                    if false then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
                  else
                    if check(concat2(k_39, hostY, B), pkY, s) then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
          orfind @i_107 <= N suchthat defined(x_73[@i_107]) && ((concat4(hostY, pkY) = x_73[@i_107]) && check2(concat4(hostY, pkY), spkgen(rkS), cert1_38)) then
            if true then
            find @i_101 <= N suchthat defined(x_71[@i_101]) && ((concat3(B, pkgen2(rkB)) = x_71[@i_101]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37)) then
              if true then
              find @i_69 <= N suchthat defined(r1[@i_69], hostX[@i_69], k_42[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
                if (hostY = A) then
                if (B = hostX[@i_69]) then
                let s: signature = sign(concat2(k_42[@i_69], A, hostX[@i_69]), skA, r1[@i_69]) in
                find @i_92 <= N suchthat defined(x_71[@i_92], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_71[@i_92]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_91 <= N suchthat defined(x_73[@i_91], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_73[@i_91]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_90 <= N suchthat defined(x_75[@i_90], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_75[@i_90]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                else
                  if defined(rkS) && (pkY = spkgen2(rkS)) then
                    if false then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
                  else
                    if check(concat2(k_42[@i_69], hostY, B), pkY, s) then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
              else
                let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
                find @i_83 <= N suchthat defined(x_71[@i_83], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_71[@i_83]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_82 <= N suchthat defined(x_73[@i_82], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_73[@i_82]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_81 <= N suchthat defined(x_75[@i_81], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_75[@i_81]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                else
                  if defined(rkS) && (pkY = spkgen2(rkS)) then
                    if false then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
                  else
                    if check(concat2(k_39, hostY, B), pkY, s) then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
            orfind @i_100 <= N suchthat defined(x_73[@i_100]) && ((concat3(B, pkgen2(rkB)) = x_73[@i_100]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37)) then
              if true then
              find @i_69 <= N suchthat defined(r1[@i_69], hostX[@i_69], k_42[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
                if (hostY = A) then
                if (B = hostX[@i_69]) then
                let s: signature = sign(concat2(k_42[@i_69], A, hostX[@i_69]), skA, r1[@i_69]) in
                find @i_92 <= N suchthat defined(x_71[@i_92], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_71[@i_92]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_91 <= N suchthat defined(x_73[@i_91], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_73[@i_91]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_90 <= N suchthat defined(x_75[@i_90], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_75[@i_90]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                else
                  if defined(rkS) && (pkY = spkgen2(rkS)) then
                    if false then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
                  else
                    if check(concat2(k_42[@i_69], hostY, B), pkY, s) then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
              else
                let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
                find @i_83 <= N suchthat defined(x_71[@i_83], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_71[@i_83]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_82 <= N suchthat defined(x_73[@i_82], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_73[@i_82]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_81 <= N suchthat defined(x_75[@i_81], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_75[@i_81]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                else
                  if defined(rkS) && (pkY = spkgen2(rkS)) then
                    if false then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
                  else
                    if check(concat2(k_39, hostY, B), pkY, s) then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
            orfind @i_99 <= N suchthat defined(x_75[@i_99]) && ((concat3(B, pkgen2(rkB)) = x_75[@i_99]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37)) then
              if true then
              find @i_69 <= N suchthat defined(r1[@i_69], hostX[@i_69], k_42[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
                if (hostY = A) then
                if (B = hostX[@i_69]) then
                let s: signature = sign(concat2(k_42[@i_69], A, hostX[@i_69]), skA, r1[@i_69]) in
                find @i_92 <= N suchthat defined(x_71[@i_92], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_71[@i_92]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_91 <= N suchthat defined(x_73[@i_91], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_73[@i_91]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_90 <= N suchthat defined(x_75[@i_90], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_75[@i_90]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                else
                  if defined(rkS) && (pkY = spkgen2(rkS)) then
                    if false then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
                  else
                    if check(concat2(k_42[@i_69], hostY, B), pkY, s) then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
              else
                let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
                find @i_83 <= N suchthat defined(x_71[@i_83], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_71[@i_83]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_82 <= N suchthat defined(x_73[@i_82], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_73[@i_82]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_81 <= N suchthat defined(x_75[@i_81], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_75[@i_81]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                else
                  if defined(rkS) && (pkY = spkgen2(rkS)) then
                    if false then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
                  else
                    if check(concat2(k_39, hostY, B), pkY, s) then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
            else
              if false then
              find @i_69 <= N suchthat defined(r1[@i_69], hostX[@i_69], k_42[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
                if (hostY = A) then
                if (B = hostX[@i_69]) then
                let s: signature = sign(concat2(k_42[@i_69], A, hostX[@i_69]), skA, r1[@i_69]) in
                find @i_92 <= N suchthat defined(x_71[@i_92], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_71[@i_92]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_91 <= N suchthat defined(x_73[@i_91], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_73[@i_91]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_90 <= N suchthat defined(x_75[@i_90], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_75[@i_90]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                else
                  if defined(rkS) && (pkY = spkgen2(rkS)) then
                    if false then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
                  else
                    if check(concat2(k_42[@i_69], hostY, B), pkY, s) then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
              else
                let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
                find @i_83 <= N suchthat defined(x_71[@i_83], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_71[@i_83]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_82 <= N suchthat defined(x_73[@i_82], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_73[@i_82]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_81 <= N suchthat defined(x_75[@i_81], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_75[@i_81]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                else
                  if defined(rkS) && (pkY = spkgen2(rkS)) then
                    if false then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
                  else
                    if check(concat2(k_39, hostY, B), pkY, s) then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
          orfind @i_106 <= N suchthat defined(x_75[@i_106]) && ((concat4(hostY, pkY) = x_75[@i_106]) && check2(concat4(hostY, pkY), spkgen(rkS), cert1_38)) then
            if true then
            find @i_101 <= N suchthat defined(x_71[@i_101]) && ((concat3(B, pkgen2(rkB)) = x_71[@i_101]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37)) then
              if true then
              find @i_69 <= N suchthat defined(r1[@i_69], hostX[@i_69], k_42[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
                if (hostY = A) then
                if (B = hostX[@i_69]) then
                let s: signature = sign(concat2(k_42[@i_69], A, hostX[@i_69]), skA, r1[@i_69]) in
                find @i_92 <= N suchthat defined(x_71[@i_92], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_71[@i_92]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_91 <= N suchthat defined(x_73[@i_91], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_73[@i_91]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_90 <= N suchthat defined(x_75[@i_90], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_75[@i_90]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                else
                  if defined(rkS) && (pkY = spkgen2(rkS)) then
                    if false then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
                  else
                    if check(concat2(k_42[@i_69], hostY, B), pkY, s) then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
              else
                let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
                find @i_83 <= N suchthat defined(x_71[@i_83], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_71[@i_83]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_82 <= N suchthat defined(x_73[@i_82], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_73[@i_82]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_81 <= N suchthat defined(x_75[@i_81], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_75[@i_81]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                else
                  if defined(rkS) && (pkY = spkgen2(rkS)) then
                    if false then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
                  else
                    if check(concat2(k_39, hostY, B), pkY, s) then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
            orfind @i_100 <= N suchthat defined(x_73[@i_100]) && ((concat3(B, pkgen2(rkB)) = x_73[@i_100]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37)) then
              if true then
              find @i_69 <= N suchthat defined(r1[@i_69], hostX[@i_69], k_42[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
                if (hostY = A) then
                if (B = hostX[@i_69]) then
                let s: signature = sign(concat2(k_42[@i_69], A, hostX[@i_69]), skA, r1[@i_69]) in
                find @i_92 <= N suchthat defined(x_71[@i_92], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_71[@i_92]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_91 <= N suchthat defined(x_73[@i_91], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_73[@i_91]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_90 <= N suchthat defined(x_75[@i_90], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_75[@i_90]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                else
                  if defined(rkS) && (pkY = spkgen2(rkS)) then
                    if false then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
                  else
                    if check(concat2(k_42[@i_69], hostY, B), pkY, s) then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
              else
                let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
                find @i_83 <= N suchthat defined(x_71[@i_83], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_71[@i_83]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_82 <= N suchthat defined(x_73[@i_82], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_73[@i_82]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_81 <= N suchthat defined(x_75[@i_81], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_75[@i_81]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                else
                  if defined(rkS) && (pkY = spkgen2(rkS)) then
                    if false then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
                  else
                    if check(concat2(k_39, hostY, B), pkY, s) then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
            orfind @i_99 <= N suchthat defined(x_75[@i_99]) && ((concat3(B, pkgen2(rkB)) = x_75[@i_99]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37)) then
              if true then
              find @i_69 <= N suchthat defined(r1[@i_69], hostX[@i_69], k_42[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
                if (hostY = A) then
                if (B = hostX[@i_69]) then
                let s: signature = sign(concat2(k_42[@i_69], A, hostX[@i_69]), skA, r1[@i_69]) in
                find @i_92 <= N suchthat defined(x_71[@i_92], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_71[@i_92]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_91 <= N suchthat defined(x_73[@i_91], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_73[@i_91]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_90 <= N suchthat defined(x_75[@i_90], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_75[@i_90]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                else
                  if defined(rkS) && (pkY = spkgen2(rkS)) then
                    if false then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
                  else
                    if check(concat2(k_42[@i_69], hostY, B), pkY, s) then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
              else
                let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
                find @i_83 <= N suchthat defined(x_71[@i_83], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_71[@i_83]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_82 <= N suchthat defined(x_73[@i_82], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_73[@i_82]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_81 <= N suchthat defined(x_75[@i_81], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_75[@i_81]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                else
                  if defined(rkS) && (pkY = spkgen2(rkS)) then
                    if false then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
                  else
                    if check(concat2(k_39, hostY, B), pkY, s) then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
            else
              if false then
              find @i_69 <= N suchthat defined(r1[@i_69], hostX[@i_69], k_42[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
                if (hostY = A) then
                if (B = hostX[@i_69]) then
                let s: signature = sign(concat2(k_42[@i_69], A, hostX[@i_69]), skA, r1[@i_69]) in
                find @i_92 <= N suchthat defined(x_71[@i_92], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_71[@i_92]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_91 <= N suchthat defined(x_73[@i_91], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_73[@i_91]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_90 <= N suchthat defined(x_75[@i_90], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_75[@i_90]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                else
                  if defined(rkS) && (pkY = spkgen2(rkS)) then
                    if false then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
                  else
                    if check(concat2(k_42[@i_69], hostY, B), pkY, s) then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
              else
                let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
                find @i_83 <= N suchthat defined(x_71[@i_83], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_71[@i_83]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_82 <= N suchthat defined(x_73[@i_82], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_73[@i_82]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_81 <= N suchthat defined(x_75[@i_81], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_75[@i_81]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                else
                  if defined(rkS) && (pkY = spkgen2(rkS)) then
                    if false then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
                  else
                    if check(concat2(k_39, hostY, B), pkY, s) then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
          else
            if false then
            find @i_101 <= N suchthat defined(x_71[@i_101]) && ((concat3(B, pkgen2(rkB)) = x_71[@i_101]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37)) then
              if true then
              find @i_69 <= N suchthat defined(r1[@i_69], hostX[@i_69], k_42[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
                if (hostY = A) then
                if (B = hostX[@i_69]) then
                let s: signature = sign(concat2(k_42[@i_69], A, hostX[@i_69]), skA, r1[@i_69]) in
                find @i_92 <= N suchthat defined(x_71[@i_92], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_71[@i_92]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_91 <= N suchthat defined(x_73[@i_91], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_73[@i_91]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_90 <= N suchthat defined(x_75[@i_90], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_75[@i_90]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                else
                  if defined(rkS) && (pkY = spkgen2(rkS)) then
                    if false then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
                  else
                    if check(concat2(k_42[@i_69], hostY, B), pkY, s) then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
              else
                let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
                find @i_83 <= N suchthat defined(x_71[@i_83], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_71[@i_83]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_82 <= N suchthat defined(x_73[@i_82], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_73[@i_82]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_81 <= N suchthat defined(x_75[@i_81], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_75[@i_81]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                else
                  if defined(rkS) && (pkY = spkgen2(rkS)) then
                    if false then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
                  else
                    if check(concat2(k_39, hostY, B), pkY, s) then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
            orfind @i_100 <= N suchthat defined(x_73[@i_100]) && ((concat3(B, pkgen2(rkB)) = x_73[@i_100]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37)) then
              if true then
              find @i_69 <= N suchthat defined(r1[@i_69], hostX[@i_69], k_42[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
                if (hostY = A) then
                if (B = hostX[@i_69]) then
                let s: signature = sign(concat2(k_42[@i_69], A, hostX[@i_69]), skA, r1[@i_69]) in
                find @i_92 <= N suchthat defined(x_71[@i_92], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_71[@i_92]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_91 <= N suchthat defined(x_73[@i_91], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_73[@i_91]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_90 <= N suchthat defined(x_75[@i_90], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_75[@i_90]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                else
                  if defined(rkS) && (pkY = spkgen2(rkS)) then
                    if false then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
                  else
                    if check(concat2(k_42[@i_69], hostY, B), pkY, s) then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
              else
                let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
                find @i_83 <= N suchthat defined(x_71[@i_83], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_71[@i_83]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_82 <= N suchthat defined(x_73[@i_82], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_73[@i_82]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_81 <= N suchthat defined(x_75[@i_81], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_75[@i_81]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                else
                  if defined(rkS) && (pkY = spkgen2(rkS)) then
                    if false then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
                  else
                    if check(concat2(k_39, hostY, B), pkY, s) then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
            orfind @i_99 <= N suchthat defined(x_75[@i_99]) && ((concat3(B, pkgen2(rkB)) = x_75[@i_99]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37)) then
              if true then
              find @i_69 <= N suchthat defined(r1[@i_69], hostX[@i_69], k_42[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
                if (hostY = A) then
                if (B = hostX[@i_69]) then
                let s: signature = sign(concat2(k_42[@i_69], A, hostX[@i_69]), skA, r1[@i_69]) in
                find @i_92 <= N suchthat defined(x_71[@i_92], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_71[@i_92]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_91 <= N suchthat defined(x_73[@i_91], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_73[@i_91]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_90 <= N suchthat defined(x_75[@i_90], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_75[@i_90]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                else
                  if defined(rkS) && (pkY = spkgen2(rkS)) then
                    if false then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
                  else
                    if check(concat2(k_42[@i_69], hostY, B), pkY, s) then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
              else
                let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
                find @i_83 <= N suchthat defined(x_71[@i_83], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_71[@i_83]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_82 <= N suchthat defined(x_73[@i_82], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_73[@i_82]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_81 <= N suchthat defined(x_75[@i_81], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_75[@i_81]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                else
                  if defined(rkS) && (pkY = spkgen2(rkS)) then
                    if false then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
                  else
                    if check(concat2(k_39, hostY, B), pkY, s) then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
            else
              if false then
              find @i_69 <= N suchthat defined(r1[@i_69], hostX[@i_69], k_42[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
                if (hostY = A) then
                if (B = hostX[@i_69]) then
                let s: signature = sign(concat2(k_42[@i_69], A, hostX[@i_69]), skA, r1[@i_69]) in
                find @i_92 <= N suchthat defined(x_71[@i_92], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_71[@i_92]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_91 <= N suchthat defined(x_73[@i_91], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_73[@i_91]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_90 <= N suchthat defined(x_75[@i_90], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_42[@i_69], hostY, B) = x_75[@i_90]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                else
                  if defined(rkS) && (pkY = spkgen2(rkS)) then
                    if false then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
                  else
                    if check(concat2(k_42[@i_69], hostY, B), pkY, s) then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
              else
                let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
                find @i_83 <= N suchthat defined(x_71[@i_83], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_71[@i_83]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_82 <= N suchthat defined(x_73[@i_82], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_73[@i_82]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_81 <= N suchthat defined(x_75[@i_81], rkS) && ((pkY = spkgen2(rkS)) && ((concat2(k_39, hostY, B) = x_75[@i_81]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                else
                  if defined(rkS) && (pkY = spkgen2(rkS)) then
                    if false then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
                  else
                    if check(concat2(k_39, hostY, B), pkY, s) then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
        )
      |
        ! !_25 <= N
        in(c5[!_25], (h1_34: host, h2_33: host));
        find j2_35 <= N2 suchthat defined(Kkey[j2_35], Khost[j2_35], Rkey_59[j2_35]) && (Khost[j2_35] = h2_33) then
          new r3_61: sseed;
          let x_73: sblocksize = concat3(h2_33, Kkey[j2_35]) in
          out(c6[!_25], (h2_33, Kkey[j2_35], sign2(x_73, sskgen2(rkS), r3_61)))
        orfind j2_35 <= N2 suchthat defined(Khost[j2_35], Rkey_60[j2_35]) && (Khost[j2_35] = h2_33) then
          new r3_62: sseed;
          let x_75: sblocksize = concat3(h2_33, pkgen2(rkB)) in
          out(c6[!_25], (h2_33, pkgen2(rkB), sign2(x_75, sskgen2(rkS), r3_62)))
      )
    |
      ! !_26 <= N
      in(c11[!_26], (h1_30: host, h2_29: host));
      find j2_31 <= N2 suchthat defined(SRkey[j2_31], SKhost[j2_31]) && (SKhost[j2_31] = h2_29) then
      new r3_32: sseed;
      let x_71: sblocksize = concat4(h2_29, SRkey[j2_31]) in
      out(c12[!_26], (h2_29, SRkey[j2_31], sign2(x_71, sskgen2(rkS), r3_32)))
    )
  |
    ! !_27 <= N2
    in(c4[!_27], (Khost: host, Kkey: pkey));
    if (Khost = B) then
      let Rkey_60: pkey = cst_pkey
    else
      let Rkey_59: pkey = cst_pkey
  )
|
  ! !_28 <= N2
  in(c10[!_28], (SKhost: host, SKkey: spkey));
  if (SKhost = A) then
    let SRkey: spkey = pkA
  else
    let SRkey: spkey = SKkey
)


Applying simplify yields

Game 15 is
in(start, ());
new rkA: skeyseed;
let pkA: spkey = spkgen(rkA) in
let skA: sskey = sskgen(rkA) in
new rkS: skeyseed;
new rkB: keyseed;
out(c7, (pkA, pkgen2(rkB), spkgen2(rkS)));
(
  (
    (
      (
        (
          ! !_23 <= N
          in(c1[!_23], (=A, =pkA, cert1_41: signature, hostX: host, pkX: pkey, cert2_40: signature));
          find @i_122 <= N suchthat defined(SRkey[j2_31[@i_122]], h2_29[@i_122], x_71[@i_122]) && (((A = h2_29[@i_122]) && (pkA = SRkey[j2_31[@i_122]])) && check2(concat4(A, pkA), spkgen(rkS), cert1_41)) then
          find @i_114 <= N suchthat defined(Kkey[j2_35[@i_114]], h2_33[@i_114], x_73[@i_114]) && (((hostX = h2_33[@i_114]) && (pkX = Kkey[j2_35[@i_114]])) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
            new k_42: shkey;
            event beginA(A, hostX, k_42);
            new r1: sseed;
            let x_65: blocksize = concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)) in
            if (pkX = pkgen2(rkB)) then
              new r2: seed;
              let m2_63: bitstring = enc2(Z, pkX, r2) in
              out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, m2_63));
              in(finish[!_23], ());
              out(c8[!_23], k_42)
            else
              new r3_66: seed;
              out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_66)));
              in(finish[!_23], ());
              out(c8[!_23], k_42)
          orfind @i_113 <= N suchthat defined(h2_33[@i_113], x_75[@i_113]) && (((hostX = h2_33[@i_113]) && (pkX = pkgen2(rkB))) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
            new k_42: shkey;
            event beginA(A, hostX, k_42);
            new r1: sseed;
            let x_65: blocksize = concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)) in
            new r2: seed;
            let m2_63: bitstring = enc2(Z, pkX, r2) in
            out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, m2_63));
            in(finish[!_23], ());
            let keyA: shkey = k_42
        |
          ! !_24 <= N
          in(c3[!_24], (hostY: host, pkY: spkey, cert1_38: signature, =B, =pkgen2(rkB), cert2_37: signature, m: bitstring));
          find @i_108 <= N suchthat defined(SRkey[j2_31[@i_108]], h2_29[@i_108], x_71[@i_108]) && (((hostY = h2_29[@i_108]) && (pkY = SRkey[j2_31[@i_108]])) && check2(concat4(hostY, pkY), spkgen(rkS), cert1_38)) then
          find @i_99 <= N suchthat defined(x_75[@i_99]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37) then
          find @i_69 <= N suchthat defined(r1[@i_69], k_42[@i_69], hostX[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then

	    (* Some reasoning should show that hostY = A is impossible here
	    x_71[@i_108] is defined, so SRkey_129[j2_31[@i_108]] is defined, so 
	    SKhost[j2_31[@i_108]] <> A
	    Furthermore SKhost[j2_31[@i_108]] = h2_29[@i_108] = hostY
	    so hostY <> A
	    This is a limitation in simplification.
	     *)



            if (hostY = A) then
            if (B = hostX[@i_69]) then
            let s: signature = sign(concat2(k_42[@i_69], A, hostX[@i_69]), skA, r1[@i_69]) in
            if (pkY = spkgen2(rkS)) then
              yield
            else
              if check(concat2(k_42[@i_69], hostY, B), pkY, s) then
              event endB(hostY, B, k_42[@i_69]);
              let keyB: shkey = k_42[@i_69]
          else
            let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
            if (pkY = spkgen2(rkS)) then
              yield
            else
              if check(concat2(k_39, hostY, B), pkY, s) then
              if (hostY = A) then
                event endB(hostY, B, k_39);
                let keyB: shkey = k_39
              else
                out(c9[!_24], k_39)
        )
      |
        ! !_25 <= N
        in(c5[!_25], (h1_34: host, h2_33: host));
        find j2_35 <= N2 suchthat defined(Kkey[j2_35], Khost[j2_35], Rkey_59[j2_35]) && (Khost[j2_35] = h2_33) then
          new r3_61: sseed;
          let x_73: sblocksize = concat3(h2_33, Kkey[j2_35]) in
          out(c6[!_25], (h2_33, Kkey[j2_35], sign2(x_73, sskgen2(rkS), r3_61)))
        orfind j2_35 <= N2 suchthat defined(Khost[j2_35], Rkey_60[j2_35]) && (Khost[j2_35] = h2_33) then
          new r3_62: sseed;
          let x_75: sblocksize = concat3(h2_33, pkgen2(rkB)) in
          out(c6[!_25], (h2_33, pkgen2(rkB), sign2(x_75, sskgen2(rkS), r3_62)))
      )
    |
      ! !_26 <= N
      in(c11[!_26], (h1_30: host, h2_29: host));
      find j2_31 <= N2 suchthat defined(SRkey[j2_31], SKhost[j2_31]) && (SKhost[j2_31] = h2_29) then
      new r3_32: sseed;
      let x_71: sblocksize = concat4(h2_29, SRkey[j2_31]) in
      out(c12[!_26], (h2_29, SRkey[j2_31], sign2(x_71, sskgen2(rkS), r3_32)))
    )
  |
    ! !_27 <= N2
    in(c4[!_27], (Khost: host, Kkey: pkey));
    if (Khost = B) then
      let Rkey_60: pkey = cst_pkey
    else
      let Rkey_59: pkey = cst_pkey
  )
|
  ! !_28 <= N2
  in(c10[!_28], (SKhost: host, SKkey: spkey));
  if (SKhost = A) then
    let SRkey: spkey = pkA
  else
    let SRkey: spkey = SKkey
)


Applying move new all binders yields

Game 16 is
in(start, ());
new rkA: skeyseed;
let pkA: spkey = spkgen(rkA) in
let skA: sskey = sskgen(rkA) in
new rkB: keyseed;
new rkS: skeyseed;
out(c7, (pkA, pkgen2(rkB), spkgen2(rkS)));
(
  (
    (
      (
        (
          ! !_23 <= N
          in(c1[!_23], (=A, =pkA, cert1_41: signature, hostX: host, pkX: pkey, cert2_40: signature));
          find @i_122 <= N suchthat defined(SRkey[j2_31[@i_122]], h2_29[@i_122], x_71[@i_122]) && (((A = h2_29[@i_122]) && (pkA = SRkey[j2_31[@i_122]])) && check2(concat4(A, pkA), spkgen(rkS), cert1_41)) then
          find @i_114 <= N suchthat defined(Kkey[j2_35[@i_114]], h2_33[@i_114], x_73[@i_114]) && (((hostX = h2_33[@i_114]) && (pkX = Kkey[j2_35[@i_114]])) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
            new k_42: shkey;
            event beginA(A, hostX, k_42);
            new r1: sseed;
            let x_65: blocksize = concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)) in
            if (pkX = pkgen2(rkB)) then
              new r2: seed;
              let m2_63: bitstring = enc2(Z, pkX, r2) in
              out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, m2_63));
              in(finish[!_23], ());
              out(c8[!_23], k_42)
            else
              new r3_66: seed;
              out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_66)));
              in(finish[!_23], ());
              out(c8[!_23], k_42)
          orfind @i_113 <= N suchthat defined(h2_33[@i_113], x_75[@i_113]) && (((hostX = h2_33[@i_113]) && (pkX = pkgen2(rkB))) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
            new k_42: shkey;
            event beginA(A, hostX, k_42);
            new r1: sseed;
            let x_65: blocksize = concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)) in
            new r2: seed;
            let m2_63: bitstring = enc2(Z, pkX, r2) in
            out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, m2_63));
            in(finish[!_23], ());
            let keyA: shkey = k_42
        |
          ! !_24 <= N
          in(c3[!_24], (hostY: host, pkY: spkey, cert1_38: signature, =B, =pkgen2(rkB), cert2_37: signature, m: bitstring));
          find @i_108 <= N suchthat defined(SRkey[j2_31[@i_108]], h2_29[@i_108], x_71[@i_108]) && (((hostY = h2_29[@i_108]) && (pkY = SRkey[j2_31[@i_108]])) && check2(concat4(hostY, pkY), spkgen(rkS), cert1_38)) then
          find @i_99 <= N suchthat defined(x_75[@i_99]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37) then
          find @i_69 <= N suchthat defined(r1[@i_69], k_42[@i_69], hostX[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
            if (hostY = A) then
            if (B = hostX[@i_69]) then
            let s: signature = sign(concat2(k_42[@i_69], A, hostX[@i_69]), skA, r1[@i_69]) in
            if (pkY = spkgen2(rkS)) then
              yield
            else
              if check(concat2(k_42[@i_69], hostY, B), pkY, s) then
              event endB(hostY, B, k_42[@i_69]);
              let keyB: shkey = k_42[@i_69]
          else
            let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
            if (pkY = spkgen2(rkS)) then
              yield
            else
              if check(concat2(k_39, hostY, B), pkY, s) then
              if (hostY = A) then
                event endB(hostY, B, k_39);
                let keyB: shkey = k_39
              else
                out(c9[!_24], k_39)
        )
      |
        ! !_25 <= N
        in(c5[!_25], (h1_34: host, h2_33: host));
        find j2_35 <= N2 suchthat defined(Kkey[j2_35], Khost[j2_35], Rkey_59[j2_35]) && (Khost[j2_35] = h2_33) then
          let x_73: sblocksize = concat3(h2_33, Kkey[j2_35]) in
          new r3_61: sseed;
          out(c6[!_25], (h2_33, Kkey[j2_35], sign2(x_73, sskgen2(rkS), r3_61)))
        orfind j2_35 <= N2 suchthat defined(Khost[j2_35], Rkey_60[j2_35]) && (Khost[j2_35] = h2_33) then
          let x_75: sblocksize = concat3(h2_33, pkgen2(rkB)) in
          new r3_62: sseed;
          out(c6[!_25], (h2_33, pkgen2(rkB), sign2(x_75, sskgen2(rkS), r3_62)))
      )
    |
      ! !_26 <= N
      in(c11[!_26], (h1_30: host, h2_29: host));
      find j2_31 <= N2 suchthat defined(SRkey[j2_31], SKhost[j2_31]) && (SKhost[j2_31] = h2_29) then
      let x_71: sblocksize = concat4(h2_29, SRkey[j2_31]) in
      new r3_32: sseed;
      out(c12[!_26], (h2_29, SRkey[j2_31], sign2(x_71, sskgen2(rkS), r3_32)))
    )
  |
    ! !_27 <= N2
    in(c4[!_27], (Khost: host, Kkey: pkey));
    if (Khost = B) then
      let Rkey_60: pkey = cst_pkey
    else
      let Rkey_59: pkey = cst_pkey
  )
|
  ! !_28 <= N2
  in(c10[!_28], (SKhost: host, SKkey: spkey));
  if (SKhost = A) then
    let SRkey: spkey = pkA
  else
    let SRkey: spkey = SKkey
)


Applying remove assignments of useless yields

Game 17 is
in(start, ());
new rkA: skeyseed;
let pkA: spkey = spkgen(rkA) in
let skA: sskey = sskgen(rkA) in
new rkB: keyseed;
new rkS: skeyseed;
out(c7, (pkA, pkgen2(rkB), spkgen2(rkS)));
(
  (
    (
      (
        (
          ! !_23 <= N
          in(c1[!_23], (=A, =pkA, cert1_41: signature, hostX: host, pkX: pkey, cert2_40: signature));
          find @i_122 <= N suchthat defined(SRkey[j2_31[@i_122]], h2_29[@i_122], x_71[@i_122]) && (((A = h2_29[@i_122]) && (pkA = SRkey[j2_31[@i_122]])) && check2(concat4(A, pkA), spkgen(rkS), cert1_41)) then
          find @i_114 <= N suchthat defined(Kkey[j2_35[@i_114]], h2_33[@i_114], x_73[@i_114]) && (((hostX = h2_33[@i_114]) && (pkX = Kkey[j2_35[@i_114]])) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
            new k_42: shkey;
            event beginA(A, hostX, k_42);
            new r1: sseed;
            let x_65: blocksize = concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), skA, r1)) in
            if (pkX = pkgen2(rkB)) then
              new r2_123: seed;
              let m2_63: bitstring = enc2(Z, pkX, r2_123) in
              out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, m2_63));
              in(finish[!_23], ());
              out(c8[!_23], k_42)
            else
              new r3_66: seed;
              out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_66)));
              in(finish[!_23], ());
              out(c8[!_23], k_42)
          orfind @i_113 <= N suchthat defined(h2_33[@i_113], x_75[@i_113]) && (((hostX = h2_33[@i_113]) && (pkX = pkgen2(rkB))) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
            new k_42: shkey;
            event beginA(A, hostX, k_42);
            new r1: sseed;
            new r2_124: seed;
            let m2_63: bitstring = enc2(Z, pkX, r2_124) in
            out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, m2_63));
            in(finish[!_23], ());
            let keyA: shkey = k_42
        |
          ! !_24 <= N
          in(c3[!_24], (hostY: host, pkY: spkey, cert1_38: signature, =B, =pkgen2(rkB), cert2_37: signature, m: bitstring));
          find @i_108 <= N suchthat defined(SRkey[j2_31[@i_108]], h2_29[@i_108], x_71[@i_108]) && (((hostY = h2_29[@i_108]) && (pkY = SRkey[j2_31[@i_108]])) && check2(concat4(hostY, pkY), spkgen(rkS), cert1_38)) then
          find @i_99 <= N suchthat defined(x_75[@i_99]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37) then
          find @i_69 <= N suchthat defined(r1[@i_69], k_42[@i_69], hostX[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
            if (hostY = A) then
            if (B = hostX[@i_69]) then
            let s: signature = sign(concat2(k_42[@i_69], A, hostX[@i_69]), skA, r1[@i_69]) in
            if (pkY = spkgen2(rkS)) then
              yield
            else
              if check(concat2(k_42[@i_69], hostY, B), pkY, s) then
              event endB(hostY, B, k_42[@i_69]);
              let keyB: shkey = k_42[@i_69]
          else
            let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
            if (pkY = spkgen2(rkS)) then
              yield
            else
              if check(concat2(k_39, hostY, B), pkY, s) then
              if (hostY = A) then
                event endB(hostY, B, k_39);
                let keyB: shkey = k_39
              else
                out(c9[!_24], k_39)
        )
      |
        ! !_25 <= N
        in(c5[!_25], (h1_34: host, h2_33: host));
        find j2_35 <= N2 suchthat defined(Kkey[j2_35], Khost[j2_35], Rkey_59[j2_35]) && (Khost[j2_35] = h2_33) then
          let x_73: sblocksize = concat3(h2_33, Kkey[j2_35]) in
          new r3_61: sseed;
          out(c6[!_25], (h2_33, Kkey[j2_35], sign2(x_73, sskgen2(rkS), r3_61)))
        orfind j2_35 <= N2 suchthat defined(Khost[j2_35], Rkey_60[j2_35]) && (Khost[j2_35] = h2_33) then
          let x_75: sblocksize = concat3(h2_33, pkgen2(rkB)) in
          new r3_62: sseed;
          out(c6[!_25], (h2_33, pkgen2(rkB), sign2(x_75, sskgen2(rkS), r3_62)))
      )
    |
      ! !_26 <= N
      in(c11[!_26], (h1_30: host, h2_29: host));
      find j2_31 <= N2 suchthat defined(SRkey[j2_31], SKhost[j2_31]) && (SKhost[j2_31] = h2_29) then
      let x_71: sblocksize = concat4(h2_29, SRkey[j2_31]) in
      new r3_32: sseed;
      out(c12[!_26], (h2_29, SRkey[j2_31], sign2(x_71, sskgen2(rkS), r3_32)))
    )
  |
    ! !_27 <= N2
    in(c4[!_27], (Khost: host, Kkey: pkey));
    if (Khost = B) then
      let Rkey_60: pkey = cst_pkey
    else
      let Rkey_59: pkey = cst_pkey
  )
|
  ! !_28 <= N2
  in(c10[!_28], (SKhost: host, SKkey: spkey));
  if (SKhost = A) then
    let SRkey: spkey = pkA
  else
    let SRkey: spkey = SKkey
)


Applying remove assignments of binder skA yields

Game 18 is
in(start, ());
new rkA: skeyseed;
let pkA: spkey = spkgen(rkA) in
new rkB: keyseed;
new rkS: skeyseed;
out(c7, (pkA, pkgen2(rkB), spkgen2(rkS)));
(
  (
    (
      (
        (
          ! !_23 <= N
          in(c1[!_23], (=A, =pkA, cert1_41: signature, hostX: host, pkX: pkey, cert2_40: signature));
          find @i_122 <= N suchthat defined(SRkey[j2_31[@i_122]], h2_29[@i_122], x_71[@i_122]) && (((A = h2_29[@i_122]) && (pkA = SRkey[j2_31[@i_122]])) && check2(concat4(A, pkA), spkgen(rkS), cert1_41)) then
          find @i_114 <= N suchthat defined(Kkey[j2_35[@i_114]], h2_33[@i_114], x_73[@i_114]) && (((hostX = h2_33[@i_114]) && (pkX = Kkey[j2_35[@i_114]])) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
            new k_42: shkey;
            event beginA(A, hostX, k_42);
            new r1: sseed;
            let x_65: blocksize = concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), sskgen(rkA), r1)) in
            if (pkX = pkgen2(rkB)) then
              new r2_123: seed;
              let m2_63: bitstring = enc2(Z, pkX, r2_123) in
              out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, m2_63));
              in(finish[!_23], ());
              out(c8[!_23], k_42)
            else
              new r3_66: seed;
              out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_66)));
              in(finish[!_23], ());
              out(c8[!_23], k_42)
          orfind @i_113 <= N suchthat defined(h2_33[@i_113], x_75[@i_113]) && (((hostX = h2_33[@i_113]) && (pkX = pkgen2(rkB))) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
            new k_42: shkey;
            event beginA(A, hostX, k_42);
            new r1: sseed;
            new r2_124: seed;
            let m2_63: bitstring = enc2(Z, pkX, r2_124) in
            out(c2[!_23], (A, pkA, cert1_41, hostX, pkX, cert2_40, m2_63));
            in(finish[!_23], ());
            let keyA: shkey = k_42
        |
          ! !_24 <= N
          in(c3[!_24], (hostY: host, pkY: spkey, cert1_38: signature, =B, =pkgen2(rkB), cert2_37: signature, m: bitstring));
          find @i_108 <= N suchthat defined(SRkey[j2_31[@i_108]], h2_29[@i_108], x_71[@i_108]) && (((hostY = h2_29[@i_108]) && (pkY = SRkey[j2_31[@i_108]])) && check2(concat4(hostY, pkY), spkgen(rkS), cert1_38)) then
          find @i_99 <= N suchthat defined(x_75[@i_99]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37) then
          find @i_69 <= N suchthat defined(r1[@i_69], k_42[@i_69], hostX[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
            if (hostY = A) then
            if (B = hostX[@i_69]) then
            let s: signature = sign(concat2(k_42[@i_69], A, hostX[@i_69]), sskgen(rkA), r1[@i_69]) in
            if (pkY = spkgen2(rkS)) then
              yield
            else
              if check(concat2(k_42[@i_69], hostY, B), pkY, s) then
              event endB(hostY, B, k_42[@i_69]);
              let keyB: shkey = k_42[@i_69]
          else
            let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
            if (pkY = spkgen2(rkS)) then
              yield
            else
              if check(concat2(k_39, hostY, B), pkY, s) then
              if (hostY = A) then
                event endB(hostY, B, k_39);
                let keyB: shkey = k_39
              else
                out(c9[!_24], k_39)
        )
      |
        ! !_25 <= N
        in(c5[!_25], (h1_34: host, h2_33: host));
        find j2_35 <= N2 suchthat defined(Kkey[j2_35], Khost[j2_35], Rkey_59[j2_35]) && (Khost[j2_35] = h2_33) then
          let x_73: sblocksize = concat3(h2_33, Kkey[j2_35]) in
          new r3_61: sseed;
          out(c6[!_25], (h2_33, Kkey[j2_35], sign2(x_73, sskgen2(rkS), r3_61)))
        orfind j2_35 <= N2 suchthat defined(Khost[j2_35], Rkey_60[j2_35]) && (Khost[j2_35] = h2_33) then
          let x_75: sblocksize = concat3(h2_33, pkgen2(rkB)) in
          new r3_62: sseed;
          out(c6[!_25], (h2_33, pkgen2(rkB), sign2(x_75, sskgen2(rkS), r3_62)))
      )
    |
      ! !_26 <= N
      in(c11[!_26], (h1_30: host, h2_29: host));
      find j2_31 <= N2 suchthat defined(SRkey[j2_31], SKhost[j2_31]) && (SKhost[j2_31] = h2_29) then
      let x_71: sblocksize = concat4(h2_29, SRkey[j2_31]) in
      new r3_32: sseed;
      out(c12[!_26], (h2_29, SRkey[j2_31], sign2(x_71, sskgen2(rkS), r3_32)))
    )
  |
    ! !_27 <= N2
    in(c4[!_27], (Khost: host, Kkey: pkey));
    if (Khost = B) then
      let Rkey_60: pkey = cst_pkey
    else
      let Rkey_59: pkey = cst_pkey
  )
|
  ! !_28 <= N2
  in(c10[!_28], (SKhost: host, SKkey: spkey));
  if (SKhost = A) then
    let SRkey: spkey = pkA
  else
    let SRkey: spkey = SKkey
)


Applying remove assignments of binder pkA yields

Game 19 is
in(start, ());
new rkA: skeyseed;
new rkB: keyseed;
new rkS: skeyseed;
out(c7, (spkgen(rkA), pkgen2(rkB), spkgen2(rkS)));
(
  (
    (
      (
        (
          ! !_23 <= N
          in(c1[!_23], (=A, =spkgen(rkA), cert1_41: signature, hostX: host, pkX: pkey, cert2_40: signature));
          find @i_122 <= N suchthat defined(SRkey[j2_31[@i_122]], h2_29[@i_122], x_71[@i_122]) && (((A = h2_29[@i_122]) && (spkgen(rkA) = SRkey[j2_31[@i_122]])) && check2(concat4(A, spkgen(rkA)), spkgen(rkS), cert1_41)) then
          find @i_114 <= N suchthat defined(Kkey[j2_35[@i_114]], h2_33[@i_114], x_73[@i_114]) && (((hostX = h2_33[@i_114]) && (pkX = Kkey[j2_35[@i_114]])) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
            new k_42: shkey;
            event beginA(A, hostX, k_42);
            new r1: sseed;
            let x_65: blocksize = concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), sskgen(rkA), r1)) in
            if (pkX = pkgen2(rkB)) then
              new r2_123: seed;
              let m2_63: bitstring = enc2(Z, pkX, r2_123) in
              out(c2[!_23], (A, spkgen(rkA), cert1_41, hostX, pkX, cert2_40, m2_63));
              in(finish[!_23], ());
              out(c8[!_23], k_42)
            else
              new r3_66: seed;
              out(c2[!_23], (A, spkgen(rkA), cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_66)));
              in(finish[!_23], ());
              out(c8[!_23], k_42)
          orfind @i_113 <= N suchthat defined(h2_33[@i_113], x_75[@i_113]) && (((hostX = h2_33[@i_113]) && (pkX = pkgen2(rkB))) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
            new k_42: shkey;
            event beginA(A, hostX, k_42);
            new r1: sseed;
            new r2_124: seed;
            let m2_63: bitstring = enc2(Z, pkX, r2_124) in
            out(c2[!_23], (A, spkgen(rkA), cert1_41, hostX, pkX, cert2_40, m2_63));
            in(finish[!_23], ());
            let keyA: shkey = k_42
        |
          ! !_24 <= N
          in(c3[!_24], (hostY: host, pkY: spkey, cert1_38: signature, =B, =pkgen2(rkB), cert2_37: signature, m: bitstring));
          find @i_108 <= N suchthat defined(SRkey[j2_31[@i_108]], h2_29[@i_108], x_71[@i_108]) && (((hostY = h2_29[@i_108]) && (pkY = SRkey[j2_31[@i_108]])) && check2(concat4(hostY, pkY), spkgen(rkS), cert1_38)) then
          find @i_99 <= N suchthat defined(x_75[@i_99]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37) then
          find @i_69 <= N suchthat defined(r1[@i_69], k_42[@i_69], hostX[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
            if (hostY = A) then
            if (B = hostX[@i_69]) then
            let s: signature = sign(concat2(k_42[@i_69], A, hostX[@i_69]), sskgen(rkA), r1[@i_69]) in
            if (pkY = spkgen2(rkS)) then
              yield
            else
              if check(concat2(k_42[@i_69], hostY, B), pkY, s) then
              event endB(hostY, B, k_42[@i_69]);
              let keyB: shkey = k_42[@i_69]
          else
            let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
            if (pkY = spkgen2(rkS)) then
              yield
            else
              if check(concat2(k_39, hostY, B), pkY, s) then
              if (hostY = A) then
                event endB(hostY, B, k_39);
                let keyB: shkey = k_39
              else
                out(c9[!_24], k_39)
        )
      |
        ! !_25 <= N
        in(c5[!_25], (h1_34: host, h2_33: host));
        find j2_35 <= N2 suchthat defined(Kkey[j2_35], Khost[j2_35], Rkey_59[j2_35]) && (Khost[j2_35] = h2_33) then
          let x_73: sblocksize = concat3(h2_33, Kkey[j2_35]) in
          new r3_61: sseed;
          out(c6[!_25], (h2_33, Kkey[j2_35], sign2(x_73, sskgen2(rkS), r3_61)))
        orfind j2_35 <= N2 suchthat defined(Khost[j2_35], Rkey_60[j2_35]) && (Khost[j2_35] = h2_33) then
          let x_75: sblocksize = concat3(h2_33, pkgen2(rkB)) in
          new r3_62: sseed;
          out(c6[!_25], (h2_33, pkgen2(rkB), sign2(x_75, sskgen2(rkS), r3_62)))
      )
    |
      ! !_26 <= N
      in(c11[!_26], (h1_30: host, h2_29: host));
      find j2_31 <= N2 suchthat defined(SRkey[j2_31], SKhost[j2_31]) && (SKhost[j2_31] = h2_29) then
      let x_71: sblocksize = concat4(h2_29, SRkey[j2_31]) in
      new r3_32: sseed;
      out(c12[!_26], (h2_29, SRkey[j2_31], sign2(x_71, sskgen2(rkS), r3_32)))
    )
  |
    ! !_27 <= N2
    in(c4[!_27], (Khost: host, Kkey: pkey));
    if (Khost = B) then
      let Rkey_60: pkey = cst_pkey
    else
      let Rkey_59: pkey = cst_pkey
  )
|
  ! !_28 <= N2
  in(c10[!_28], (SKhost: host, SKkey: spkey));
  if (SKhost = A) then
    let SRkey: spkey = spkgen(rkA)
  else
    let SRkey: spkey = SKkey
)


Applying SA rename SRkey yields

Game 20 is
in(start, ());
new rkA: skeyseed;
new rkB: keyseed;
new rkS: skeyseed;
out(c7, (spkgen(rkA), pkgen2(rkB), spkgen2(rkS)));
(
  (
    (
      (
        (
          ! !_23 <= N
          in(c1[!_23], (=A, =spkgen(rkA), cert1_41: signature, hostX: host, pkX: pkey, cert2_40: signature));
          find @i_122 <= N suchthat defined(SRkey_129[j2_31[@i_122]], h2_29[@i_122], x_71[@i_122]) && (((A = h2_29[@i_122]) && (spkgen(rkA) = SRkey_129[j2_31[@i_122]])) && check2(concat4(A, spkgen(rkA)), spkgen(rkS), cert1_41)) then
            find @i_114 <= N suchthat defined(Kkey[j2_35[@i_114]], h2_33[@i_114], x_73[@i_114]) && (((hostX = h2_33[@i_114]) && (pkX = Kkey[j2_35[@i_114]])) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
              new k_42: shkey;
              event beginA(A, hostX, k_42);
              new r1: sseed;
              let x_65: blocksize = concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), sskgen(rkA), r1)) in
              if (pkX = pkgen2(rkB)) then
                new r2_123: seed;
                let m2_63: bitstring = enc2(Z, pkX, r2_123) in
                out(c2[!_23], (A, spkgen(rkA), cert1_41, hostX, pkX, cert2_40, m2_63));
                in(finish[!_23], ());
                out(c8[!_23], k_42)
              else
                new r3_66: seed;
                out(c2[!_23], (A, spkgen(rkA), cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_66)));
                in(finish[!_23], ());
                out(c8[!_23], k_42)
            orfind @i_113 <= N suchthat defined(h2_33[@i_113], x_75[@i_113]) && (((hostX = h2_33[@i_113]) && (pkX = pkgen2(rkB))) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
              new k_42: shkey;
              event beginA(A, hostX, k_42);
              new r1: sseed;
              new r2_124: seed;
              let m2_63: bitstring = enc2(Z, pkX, r2_124) in
              out(c2[!_23], (A, spkgen(rkA), cert1_41, hostX, pkX, cert2_40, m2_63));
              in(finish[!_23], ());
              let keyA: shkey = k_42
          orfind @i_122 <= N suchthat defined(SRkey_130[j2_31[@i_122]], h2_29[@i_122], x_71[@i_122]) && (((A = h2_29[@i_122]) && (spkgen(rkA) = SRkey_130[j2_31[@i_122]])) && check2(concat4(A, spkgen(rkA)), spkgen(rkS), cert1_41)) then
            find @i_114 <= N suchthat defined(Kkey[j2_35[@i_114]], h2_33[@i_114], x_73[@i_114]) && (((hostX = h2_33[@i_114]) && (pkX = Kkey[j2_35[@i_114]])) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
              new k_42: shkey;
              event beginA(A, hostX, k_42);
              new r1: sseed;
              let x_65: blocksize = concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), sskgen(rkA), r1)) in
              if (pkX = pkgen2(rkB)) then
                new r2_123: seed;
                let m2_63: bitstring = enc2(Z, pkX, r2_123) in
                out(c2[!_23], (A, spkgen(rkA), cert1_41, hostX, pkX, cert2_40, m2_63));
                in(finish[!_23], ());
                out(c8[!_23], k_42)
              else
                new r3_66: seed;
                out(c2[!_23], (A, spkgen(rkA), cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_66)));
                in(finish[!_23], ());
                out(c8[!_23], k_42)
            orfind @i_113 <= N suchthat defined(h2_33[@i_113], x_75[@i_113]) && (((hostX = h2_33[@i_113]) && (pkX = pkgen2(rkB))) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
              new k_42: shkey;
              event beginA(A, hostX, k_42);
              new r1: sseed;
              new r2_124: seed;
              let m2_63: bitstring = enc2(Z, pkX, r2_124) in
              out(c2[!_23], (A, spkgen(rkA), cert1_41, hostX, pkX, cert2_40, m2_63));
              in(finish[!_23], ());
              let keyA: shkey = k_42
        |
          ! !_24 <= N
          in(c3[!_24], (hostY: host, pkY: spkey, cert1_38: signature, =B, =pkgen2(rkB), cert2_37: signature, m: bitstring));
          find @i_108 <= N suchthat defined(SRkey_129[j2_31[@i_108]], h2_29[@i_108], x_71[@i_108]) && (((hostY = h2_29[@i_108]) && (pkY = SRkey_129[j2_31[@i_108]])) && check2(concat4(hostY, pkY), spkgen(rkS), cert1_38)) then
            find @i_99 <= N suchthat defined(x_75[@i_99]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37) then
            find @i_69 <= N suchthat defined(r1[@i_69], k_42[@i_69], hostX[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then


	    (* Some reasoning should show that hostY = A is impossible here
	    x_71[@i_108] is defined, so SRkey_129[j2_31[@i_108]] is defined, so 
	    SKhost[j2_31[@i_108]] <> A
	    Furthermore SKhost[j2_31[@i_108]] = h2_29[@i_108] = hostY
	    so hostY <> A
	    This is a limitation in simplification.
	     *)


              if (hostY = A) then
              if (B = hostX[@i_69]) then
              let s: signature = sign(concat2(k_42[@i_69], A, hostX[@i_69]), sskgen(rkA), r1[@i_69]) in
              if (pkY = spkgen2(rkS)) then
                yield
              else
                if check(concat2(k_42[@i_69], hostY, B), pkY, s) then
                event endB(hostY, B, k_42[@i_69]);
                let keyB: shkey = k_42[@i_69]
            else
              let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
              if (pkY = spkgen2(rkS)) then
                yield
              else
                if check(concat2(k_39, hostY, B), pkY, s) then
                if (hostY = A) then
                  event endB(hostY, B, k_39);
                  let keyB: shkey = k_39
                else
                  out(c9[!_24], k_39)
          orfind @i_108 <= N suchthat defined(SRkey_130[j2_31[@i_108]], h2_29[@i_108], x_71[@i_108]) && (((hostY = h2_29[@i_108]) && (pkY = SRkey_130[j2_31[@i_108]])) && check2(concat4(hostY, pkY), spkgen(rkS), cert1_38)) then
            find @i_99 <= N suchthat defined(x_75[@i_99]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37) then
            find @i_69 <= N suchthat defined(r1[@i_69], k_42[@i_69], hostX[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
              if (hostY = A) then
              if (B = hostX[@i_69]) then
              let s: signature = sign(concat2(k_42[@i_69], A, hostX[@i_69]), sskgen(rkA), r1[@i_69]) in
              if (pkY = spkgen2(rkS)) then
                yield
              else
                if check(concat2(k_42[@i_69], hostY, B), pkY, s) then
                event endB(hostY, B, k_42[@i_69]);
                let keyB: shkey = k_42[@i_69]
            else
              let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
              if (pkY = spkgen2(rkS)) then
                yield
              else
                if check(concat2(k_39, hostY, B), pkY, s) then
                if (hostY = A) then
                  event endB(hostY, B, k_39);
                  let keyB: shkey = k_39
                else
                  out(c9[!_24], k_39)
        )
      |
        ! !_25 <= N
        in(c5[!_25], (h1_34: host, h2_33: host));
        find j2_35 <= N2 suchthat defined(Kkey[j2_35], Khost[j2_35], Rkey_59[j2_35]) && (Khost[j2_35] = h2_33) then
          let x_73: sblocksize = concat3(h2_33, Kkey[j2_35]) in
          new r3_61: sseed;
          out(c6[!_25], (h2_33, Kkey[j2_35], sign2(x_73, sskgen2(rkS), r3_61)))
        orfind j2_35 <= N2 suchthat defined(Khost[j2_35], Rkey_60[j2_35]) && (Khost[j2_35] = h2_33) then
          let x_75: sblocksize = concat3(h2_33, pkgen2(rkB)) in
          new r3_62: sseed;
          out(c6[!_25], (h2_33, pkgen2(rkB), sign2(x_75, sskgen2(rkS), r3_62)))
      )
    |
      ! !_26 <= N
      in(c11[!_26], (h1_30: host, h2_29: host));
      find j2_31 <= N2 suchthat defined(SRkey_129[j2_31], SKhost[j2_31]) && (SKhost[j2_31] = h2_29) then
        let x_71: sblocksize = concat4(h2_29, SRkey_129[j2_31]) in
        new r3_32: sseed;
        out(c12[!_26], (h2_29, SRkey_129[j2_31], sign2(x_71, sskgen2(rkS), r3_32)))
      orfind j2_31 <= N2 suchthat defined(SRkey_130[j2_31], SKhost[j2_31]) && (SKhost[j2_31] = h2_29) then
        let x_71: sblocksize = concat4(h2_29, SRkey_130[j2_31]) in
        new r3_32: sseed;
        out(c12[!_26], (h2_29, SRkey_130[j2_31], sign2(x_71, sskgen2(rkS), r3_32)))
    )
  |
    ! !_27 <= N2
    in(c4[!_27], (Khost: host, Kkey: pkey));
    if (Khost = B) then
      let Rkey_60: pkey = cst_pkey
    else
      let Rkey_59: pkey = cst_pkey
  )
|
  ! !_28 <= N2
  in(c10[!_28], (SKhost: host, SKkey: spkey));
  if (SKhost = A) then
    let SRkey_130: spkey = spkgen(rkA)
  else
    let SRkey_129: spkey = SKkey
)


Applying remove assignments of binder SRkey_130 yields

Game 21 is
in(start, ());
new rkA: skeyseed;
new rkB: keyseed;
new rkS: skeyseed;
out(c7, (spkgen(rkA), pkgen2(rkB), spkgen2(rkS)));
(
  (
    (
      (
        (
          ! !_23 <= N
          in(c1[!_23], (=A, =spkgen(rkA), cert1_41: signature, hostX: host, pkX: pkey, cert2_40: signature));
          find @i_122 <= N suchthat defined(SKkey[j2_31[@i_122]], SRkey_129[j2_31[@i_122]], h2_29[@i_122], x_71[@i_122]) && (((A = h2_29[@i_122]) && (spkgen(rkA) = SKkey[j2_31[@i_122]])) && check2(concat4(A, spkgen(rkA)), spkgen(rkS), cert1_41)) then
            find @i_114 <= N suchthat defined(Kkey[j2_35[@i_114]], h2_33[@i_114], x_73[@i_114]) && (((hostX = h2_33[@i_114]) && (pkX = Kkey[j2_35[@i_114]])) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
              new k_42: shkey;
              event beginA(A, hostX, k_42);
              new r1: sseed;
              let x_65: blocksize = concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), sskgen(rkA), r1)) in
              if (pkX = pkgen2(rkB)) then
                new r2_134: seed;
                let m2_63: bitstring = enc2(Z, pkX, r2_134) in
                out(c2[!_23], (A, spkgen(rkA), cert1_41, hostX, pkX, cert2_40, m2_63));
                in(finish[!_23], ());
                out(c8[!_23], k_42)
              else
                new r3_133: seed;
                out(c2[!_23], (A, spkgen(rkA), cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_133)));
                in(finish[!_23], ());
                out(c8[!_23], k_42)
            orfind @i_113 <= N suchthat defined(h2_33[@i_113], x_75[@i_113]) && (((hostX = h2_33[@i_113]) && (pkX = pkgen2(rkB))) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
              new k_42: shkey;
              event beginA(A, hostX, k_42);
              new r1: sseed;
              new r2_135: seed;
              let m2_63: bitstring = enc2(Z, pkX, r2_135) in
              out(c2[!_23], (A, spkgen(rkA), cert1_41, hostX, pkX, cert2_40, m2_63));
              in(finish[!_23], ());
              let keyA: shkey = k_42
          orfind @i_122 <= N suchthat defined(rkA, SRkey_130[j2_31[@i_122]], h2_29[@i_122], x_71[@i_122]) && (((A = h2_29[@i_122]) && (spkgen(rkA) = spkgen(rkA))) && check2(concat4(A, spkgen(rkA)), spkgen(rkS), cert1_41)) then
            find @i_114 <= N suchthat defined(Kkey[j2_35[@i_114]], h2_33[@i_114], x_73[@i_114]) && (((hostX = h2_33[@i_114]) && (pkX = Kkey[j2_35[@i_114]])) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
              new k_42: shkey;
              event beginA(A, hostX, k_42);
              new r1: sseed;
              let x_65: blocksize = concat1(k_42, A, hostX, sign(concat2(k_42, A, hostX), sskgen(rkA), r1)) in
              if (pkX = pkgen2(rkB)) then
                new r2_137: seed;
                let m2_63: bitstring = enc2(Z, pkX, r2_137) in
                out(c2[!_23], (A, spkgen(rkA), cert1_41, hostX, pkX, cert2_40, m2_63));
                in(finish[!_23], ());
                out(c8[!_23], k_42)
              else
                new r3_136: seed;
                out(c2[!_23], (A, spkgen(rkA), cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_136)));
                in(finish[!_23], ());
                out(c8[!_23], k_42)
            orfind @i_113 <= N suchthat defined(h2_33[@i_113], x_75[@i_113]) && (((hostX = h2_33[@i_113]) && (pkX = pkgen2(rkB))) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
              new k_42: shkey;
              event beginA(A, hostX, k_42);
              new r1: sseed;
              new r2_138: seed;
              let m2_63: bitstring = enc2(Z, pkX, r2_138) in
              out(c2[!_23], (A, spkgen(rkA), cert1_41, hostX, pkX, cert2_40, m2_63));
              in(finish[!_23], ());
              let keyA: shkey = k_42
        |
          ! !_24 <= N
          in(c3[!_24], (hostY: host, pkY: spkey, cert1_38: signature, =B, =pkgen2(rkB), cert2_37: signature, m: bitstring));
          find @i_108 <= N suchthat defined(SKkey[j2_31[@i_108]], SRkey_129[j2_31[@i_108]], h2_29[@i_108], x_71[@i_108]) && (((hostY = h2_29[@i_108]) && (pkY = SKkey[j2_31[@i_108]])) && check2(concat4(hostY, pkY), spkgen(rkS), cert1_38)) then
            find @i_99 <= N suchthat defined(x_75[@i_99]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37) then
            find @i_69 <= N suchthat defined(r1[@i_69], k_42[@i_69], hostX[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
              if (hostY = A) then
              if (B = hostX[@i_69]) then
              let s: signature = sign(concat2(k_42[@i_69], A, hostX[@i_69]), sskgen(rkA), r1[@i_69]) in
              if (pkY = spkgen2(rkS)) then
                yield
              else
                if check(concat2(k_42[@i_69], hostY, B), pkY, s) then
                event endB(hostY, B, k_42[@i_69]);
                let keyB: shkey = k_42[@i_69]
            else
              let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
              if (pkY = spkgen2(rkS)) then
                yield
              else
                if check(concat2(k_39, hostY, B), pkY, s) then
                if (hostY = A) then
                  event endB(hostY, B, k_39);
                  let keyB: shkey = k_39
                else
                  out(c9[!_24], k_39)
          orfind @i_108 <= N suchthat defined(rkA, SRkey_130[j2_31[@i_108]], h2_29[@i_108], x_71[@i_108]) && (((hostY = h2_29[@i_108]) && (pkY = spkgen(rkA))) && check2(concat4(hostY, pkY), spkgen(rkS), cert1_38)) then
            find @i_99 <= N suchthat defined(x_75[@i_99]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37) then
            find @i_69 <= N suchthat defined(r1[@i_69], k_42[@i_69], hostX[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
              if (hostY = A) then
              if (B = hostX[@i_69]) then
              let s: signature = sign(concat2(k_42[@i_69], A, hostX[@i_69]), sskgen(rkA), r1[@i_69]) in
              if (pkY = spkgen2(rkS)) then
                yield
              else
                if check(concat2(k_42[@i_69], hostY, B), pkY, s) then
                event endB(hostY, B, k_42[@i_69]);
                let keyB: shkey = k_42[@i_69]
            else
              let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
              if (pkY = spkgen2(rkS)) then
                yield
              else
                if check(concat2(k_39, hostY, B), pkY, s) then
                if (hostY = A) then
                  event endB(hostY, B, k_39);
                  let keyB: shkey = k_39
                else
                  out(c9[!_24], k_39)
        )
      |
        ! !_25 <= N
        in(c5[!_25], (h1_34: host, h2_33: host));
        find j2_35 <= N2 suchthat defined(Kkey[j2_35], Khost[j2_35], Rkey_59[j2_35]) && (Khost[j2_35] = h2_33) then
          let x_73: sblocksize = concat3(h2_33, Kkey[j2_35]) in
          new r3_61: sseed;
          out(c6[!_25], (h2_33, Kkey[j2_35], sign2(x_73, sskgen2(rkS), r3_61)))
        orfind j2_35 <= N2 suchthat defined(Khost[j2_35], Rkey_60[j2_35]) && (Khost[j2_35] = h2_33) then
          let x_75: sblocksize = concat3(h2_33, pkgen2(rkB)) in
          new r3_62: sseed;
          out(c6[!_25], (h2_33, pkgen2(rkB), sign2(x_75, sskgen2(rkS), r3_62)))
      )
    |
      ! !_26 <= N
      in(c11[!_26], (h1_30: host, h2_29: host));
      find j2_31 <= N2 suchthat defined(SKkey[j2_31], SRkey_129[j2_31], SKhost[j2_31]) && (SKhost[j2_31] = h2_29) then
        let x_71: sblocksize = concat4(h2_29, SKkey[j2_31]) in
        new r3_131: sseed;
        out(c12[!_26], (h2_29, SKkey[j2_31], sign2(x_71, sskgen2(rkS), r3_131)))
      orfind j2_31 <= N2 suchthat defined(rkA, SRkey_130[j2_31], SKhost[j2_31]) && (SKhost[j2_31] = h2_29) then
        let x_71: sblocksize = concat4(h2_29, spkgen(rkA)) in
        new r3_132: sseed;
        out(c12[!_26], (h2_29, spkgen(rkA), sign2(x_71, sskgen2(rkS), r3_132)))
    )
  |
    ! !_27 <= N2
    in(c4[!_27], (Khost: host, Kkey: pkey));
    if (Khost = B) then
      let Rkey_60: pkey = cst_pkey
    else
      let Rkey_59: pkey = cst_pkey
  )
|
  ! !_28 <= N2
  in(c10[!_28], (SKhost: host, SKkey: spkey));
  if (SKhost = A) then
    let SRkey_130: spkey = cst_spkey
  else
    let SRkey_129: spkey = cst_spkey
)


Applying equivalence
equiv ! !_11 <= N3 new r: skeyseed; (
  () -> spkgen(r) [2],
  ! !_12 <= N2 new r2: sseed; (x: sblocksize) -> sign(x, sskgen(r), r2),
  ! !_13 <= N (m1: sblocksize, si1: signature) -> check(m1, spkgen(r), si1)), ! !_14 <= N4 (m: sblocksize, y: spkey, si: signature) -> check(m, y, si) [3] [all]
<=(N3 * Psign(time, N2))=>
      ! !_15 <= N3 new r: skeyseed; (
  () -> spkgen2(r) [2],
  ! !_16 <= N2 new r2: sseed; (x_45: sblocksize) -> let x: sblocksize = x_45 in sign2(x, sskgen2(r), r2),
  ! !_17 <= N (m1: sblocksize, si1: signature) -> find j_19 <= N2 suchthat defined(x[j_19]) && ((m1 = x[j_19]) && check2(m1, spkgen(r), si1)) then true else false), ! !_18 <= N4 (m: sblocksize, y: spkey, si: signature) -> find j_21 <= N2, k_22 <= N3 suchthat defined(x[j_21, k_22], r[k_22]) && ((y = spkgen2(r[k_22])) && ((m = x[j_21, k_22]) && check2(m, y, si))) then true else find k_20 <= N3 suchthat defined(r[k_20]) && (y = spkgen2(r[k_20])) then false else check(m, y, si) [3]
with r1, rkA [Difference of probability Psign(time + time(context for game 21), N)] yields

Game 22 is
in(start, ());
new rkA: skeyseed;
new rkB: keyseed;
new rkS: skeyseed;
out(c7, (spkgen2(rkA), pkgen2(rkB), spkgen2(rkS)));
(
  (
    (
      (
        (
          ! !_23 <= N
          in(c1[!_23], (=A, =spkgen2(rkA), cert1_41: signature, hostX: host, pkX: pkey, cert2_40: signature));
          find @i_122 <= N suchthat defined(SKkey[j2_31[@i_122]], SRkey_129[j2_31[@i_122]], h2_29[@i_122], x_71[@i_122]) && (((A = h2_29[@i_122]) && (spkgen2(rkA) = SKkey[j2_31[@i_122]])) && check2(concat4(A, spkgen2(rkA)), spkgen(rkS), cert1_41)) then
            find @i_114 <= N suchthat defined(Kkey[j2_35[@i_114]], h2_33[@i_114], x_73[@i_114]) && (((hostX = h2_33[@i_114]) && (pkX = Kkey[j2_35[@i_114]])) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
              new k_42: shkey;
              event beginA(A, hostX, k_42);
              new r1: sseed;
              let x_143: sblocksize = concat2(k_42, A, hostX) in
              let x_65: blocksize = concat1(k_42, A, hostX, sign2(x_143, sskgen2(rkA), r1)) in
              if (pkX = pkgen2(rkB)) then
                new r2_134: seed;
                let m2_63: bitstring = enc2(Z, pkX, r2_134) in
                out(c2[!_23], (A, spkgen2(rkA), cert1_41, hostX, pkX, cert2_40, m2_63));
                in(finish[!_23], ());
                out(c8[!_23], k_42)
              else
                new r3_133: seed;
                out(c2[!_23], (A, spkgen2(rkA), cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_133)));
                in(finish[!_23], ());
                out(c8[!_23], k_42)
            orfind @i_113 <= N suchthat defined(h2_33[@i_113], x_75[@i_113]) && (((hostX = h2_33[@i_113]) && (pkX = pkgen2(rkB))) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
              new k_42: shkey;
              event beginA(A, hostX, k_42);
              new r1: sseed;
              new r2_135: seed;
              let m2_63: bitstring = enc2(Z, pkX, r2_135) in
              out(c2[!_23], (A, spkgen2(rkA), cert1_41, hostX, pkX, cert2_40, m2_63));
              in(finish[!_23], ());
              let keyA: shkey = k_42
          orfind @i_122 <= N suchthat defined(rkA, SRkey_130[j2_31[@i_122]], h2_29[@i_122], x_71[@i_122]) && (((A = h2_29[@i_122]) && (spkgen2(rkA) = spkgen2(rkA))) && check2(concat4(A, spkgen2(rkA)), spkgen(rkS), cert1_41)) then
            find @i_114 <= N suchthat defined(Kkey[j2_35[@i_114]], h2_33[@i_114], x_73[@i_114]) && (((hostX = h2_33[@i_114]) && (pkX = Kkey[j2_35[@i_114]])) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
              new k_42: shkey;
              event beginA(A, hostX, k_42);
              new r1: sseed;
              let x_145: sblocksize = concat2(k_42, A, hostX) in
              let x_65: blocksize = concat1(k_42, A, hostX, sign2(x_145, sskgen2(rkA), r1)) in
              if (pkX = pkgen2(rkB)) then
                new r2_137: seed;
                let m2_63: bitstring = enc2(Z, pkX, r2_137) in
                out(c2[!_23], (A, spkgen2(rkA), cert1_41, hostX, pkX, cert2_40, m2_63));
                in(finish[!_23], ());
                out(c8[!_23], k_42)
              else
                new r3_136: seed;
                out(c2[!_23], (A, spkgen2(rkA), cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_136)));
                in(finish[!_23], ());
                out(c8[!_23], k_42)
            orfind @i_113 <= N suchthat defined(h2_33[@i_113], x_75[@i_113]) && (((hostX = h2_33[@i_113]) && (pkX = pkgen2(rkB))) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
              new k_42: shkey;
              event beginA(A, hostX, k_42);
              new r1: sseed;
              new r2_138: seed;
              let m2_63: bitstring = enc2(Z, pkX, r2_138) in
              out(c2[!_23], (A, spkgen2(rkA), cert1_41, hostX, pkX, cert2_40, m2_63));
              in(finish[!_23], ());
              let keyA: shkey = k_42
        |
          ! !_24 <= N
          in(c3[!_24], (hostY: host, pkY: spkey, cert1_38: signature, =B, =pkgen2(rkB), cert2_37: signature, m: bitstring));
          find @i_108 <= N suchthat defined(SKkey[j2_31[@i_108]], SRkey_129[j2_31[@i_108]], h2_29[@i_108], x_71[@i_108]) && (((hostY = h2_29[@i_108]) && (pkY = SKkey[j2_31[@i_108]])) && check2(concat4(hostY, pkY), spkgen(rkS), cert1_38)) then
            find @i_99 <= N suchthat defined(x_75[@i_99]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37) then
            find @i_69 <= N suchthat defined(r1[@i_69], k_42[@i_69], hostX[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
              if (hostY = A) then
              if (B = hostX[@i_69]) then
              let x_139: sblocksize = concat2(k_42[@i_69], A, hostX[@i_69]) in
              let s: signature = sign2(x_139, sskgen2(rkA), r1[@i_69]) in
              if (pkY = spkgen2(rkS)) then
                yield
              else
                find @i_154 <= N, @i_156 <= N suchthat defined(x_139[@i_156], rkA) && ((@i_154 = @i_69[@i_156]) && ((pkY = spkgen2(rkA)) && ((concat2(k_42[@i_69], hostY, B) = x_139[@i_156]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s)))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_154 <= N, @i_155 <= N suchthat defined(x_141[@i_155], rkA) && ((@i_154 = @i_69[@i_155]) && ((pkY = spkgen2(rkA)) && ((concat2(k_42[@i_69], hostY, B) = x_141[@i_155]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s)))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_154 <= N suchthat defined(x_143[@i_154], rkA) && ((pkY = spkgen2(rkA)) && ((concat2(k_42[@i_69], hostY, B) = x_143[@i_154]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_154 <= N suchthat defined(x_145[@i_154], rkA) && ((pkY = spkgen2(rkA)) && ((concat2(k_42[@i_69], hostY, B) = x_145[@i_154]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                else
                  if defined(rkA) && (pkY = spkgen2(rkA)) then
                    if false then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
                  else
                    if check(concat2(k_42[@i_69], hostY, B), pkY, s) then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
            else
              let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
              if (pkY = spkgen2(rkS)) then
                yield
              else
                find @i_147 <= N, @i_149 <= N suchthat defined(x_139[@i_149], rkA) && ((@i_147 = @i_69[@i_149]) && ((pkY = spkgen2(rkA)) && ((concat2(k_39, hostY, B) = x_139[@i_149]) && check2(concat2(k_39, hostY, B), pkY, s)))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_147 <= N, @i_148 <= N suchthat defined(x_141[@i_148], rkA) && ((@i_147 = @i_69[@i_148]) && ((pkY = spkgen2(rkA)) && ((concat2(k_39, hostY, B) = x_141[@i_148]) && check2(concat2(k_39, hostY, B), pkY, s)))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_147 <= N suchthat defined(x_143[@i_147], rkA) && ((pkY = spkgen2(rkA)) && ((concat2(k_39, hostY, B) = x_143[@i_147]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_147 <= N suchthat defined(x_145[@i_147], rkA) && ((pkY = spkgen2(rkA)) && ((concat2(k_39, hostY, B) = x_145[@i_147]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                else
                  if defined(rkA) && (pkY = spkgen2(rkA)) then
                    if false then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
                  else
                    if check(concat2(k_39, hostY, B), pkY, s) then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
          orfind @i_108 <= N suchthat defined(rkA, SRkey_130[j2_31[@i_108]], h2_29[@i_108], x_71[@i_108]) && (((hostY = h2_29[@i_108]) && (pkY = spkgen2(rkA))) && check2(concat4(hostY, pkY), spkgen(rkS), cert1_38)) then
            find @i_99 <= N suchthat defined(x_75[@i_99]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37) then
            find @i_69 <= N suchthat defined(r1[@i_69], k_42[@i_69], hostX[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
              if (hostY = A) then
              if (B = hostX[@i_69]) then
              let x_141: sblocksize = concat2(k_42[@i_69], A, hostX[@i_69]) in
              let s: signature = sign2(x_141, sskgen2(rkA), r1[@i_69]) in
              if (pkY = spkgen2(rkS)) then
                yield
              else
                find @i_168 <= N, @i_170 <= N suchthat defined(x_139[@i_170], rkA) && ((@i_168 = @i_69[@i_170]) && ((pkY = spkgen2(rkA)) && ((concat2(k_42[@i_69], hostY, B) = x_139[@i_170]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s)))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_168 <= N, @i_169 <= N suchthat defined(x_141[@i_169], rkA) && ((@i_168 = @i_69[@i_169]) && ((pkY = spkgen2(rkA)) && ((concat2(k_42[@i_69], hostY, B) = x_141[@i_169]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s)))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_168 <= N suchthat defined(x_143[@i_168], rkA) && ((pkY = spkgen2(rkA)) && ((concat2(k_42[@i_69], hostY, B) = x_143[@i_168]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                orfind @i_168 <= N suchthat defined(x_145[@i_168], rkA) && ((pkY = spkgen2(rkA)) && ((concat2(k_42[@i_69], hostY, B) = x_145[@i_168]) && check2(concat2(k_42[@i_69], hostY, B), pkY, s))) then
                  if true then
                  event endB(hostY, B, k_42[@i_69]);
                  let keyB: shkey = k_42[@i_69]
                else
                  if defined(rkA) && (pkY = spkgen2(rkA)) then
                    if false then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
                  else
                    if check(concat2(k_42[@i_69], hostY, B), pkY, s) then
                    event endB(hostY, B, k_42[@i_69]);
                    let keyB: shkey = k_42[@i_69]
            else
              let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
              if (pkY = spkgen2(rkS)) then
                yield
              else
                find @i_161 <= N, @i_163 <= N suchthat defined(x_139[@i_163], rkA) && ((@i_161 = @i_69[@i_163]) && ((pkY = spkgen2(rkA)) && ((concat2(k_39, hostY, B) = x_139[@i_163]) && check2(concat2(k_39, hostY, B), pkY, s)))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_161 <= N, @i_162 <= N suchthat defined(x_141[@i_162], rkA) && ((@i_161 = @i_69[@i_162]) && ((pkY = spkgen2(rkA)) && ((concat2(k_39, hostY, B) = x_141[@i_162]) && check2(concat2(k_39, hostY, B), pkY, s)))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_161 <= N suchthat defined(x_143[@i_161], rkA) && ((pkY = spkgen2(rkA)) && ((concat2(k_39, hostY, B) = x_143[@i_161]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                orfind @i_161 <= N suchthat defined(x_145[@i_161], rkA) && ((pkY = spkgen2(rkA)) && ((concat2(k_39, hostY, B) = x_145[@i_161]) && check2(concat2(k_39, hostY, B), pkY, s))) then
                  if true then
                  if (hostY = A) then
                    event endB(hostY, B, k_39);
                    let keyB: shkey = k_39
                  else
                    out(c9[!_24], k_39)
                else
                  if defined(rkA) && (pkY = spkgen2(rkA)) then
                    if false then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
                  else
                    if check(concat2(k_39, hostY, B), pkY, s) then
                    if (hostY = A) then
                      event endB(hostY, B, k_39);
                      let keyB: shkey = k_39
                    else
                      out(c9[!_24], k_39)
        )
      |
        ! !_25 <= N
        in(c5[!_25], (h1_34: host, h2_33: host));
        find j2_35 <= N2 suchthat defined(Kkey[j2_35], Khost[j2_35], Rkey_59[j2_35]) && (Khost[j2_35] = h2_33) then
          let x_73: sblocksize = concat3(h2_33, Kkey[j2_35]) in
          new r3_61: sseed;
          out(c6[!_25], (h2_33, Kkey[j2_35], sign2(x_73, sskgen2(rkS), r3_61)))
        orfind j2_35 <= N2 suchthat defined(Khost[j2_35], Rkey_60[j2_35]) && (Khost[j2_35] = h2_33) then
          let x_75: sblocksize = concat3(h2_33, pkgen2(rkB)) in
          new r3_62: sseed;
          out(c6[!_25], (h2_33, pkgen2(rkB), sign2(x_75, sskgen2(rkS), r3_62)))
      )
    |
      ! !_26 <= N
      in(c11[!_26], (h1_30: host, h2_29: host));
      find j2_31 <= N2 suchthat defined(SKkey[j2_31], SRkey_129[j2_31], SKhost[j2_31]) && (SKhost[j2_31] = h2_29) then
        let x_71: sblocksize = concat4(h2_29, SKkey[j2_31]) in
        new r3_131: sseed;
        out(c12[!_26], (h2_29, SKkey[j2_31], sign2(x_71, sskgen2(rkS), r3_131)))
      orfind j2_31 <= N2 suchthat defined(rkA, SRkey_130[j2_31], SKhost[j2_31]) && (SKhost[j2_31] = h2_29) then
        let x_71: sblocksize = concat4(h2_29, spkgen2(rkA)) in
        new r3_132: sseed;
        out(c12[!_26], (h2_29, spkgen2(rkA), sign2(x_71, sskgen2(rkS), r3_132)))
    )
  |
    ! !_27 <= N2
    in(c4[!_27], (Khost: host, Kkey: pkey));
    if (Khost = B) then
      let Rkey_60: pkey = cst_pkey
    else
      let Rkey_59: pkey = cst_pkey
  )
|
  ! !_28 <= N2
  in(c10[!_28], (SKhost: host, SKkey: spkey));
  if (SKhost = A) then
    let SRkey_130: spkey = cst_spkey
  else
    let SRkey_129: spkey = cst_spkey
)


Applying simplify [Difference of probability Psigncoll + 1. / |skeyseed|] yields

Game 23 is
in(start, ());
new rkA: skeyseed;
new rkB: keyseed;
new rkS: skeyseed;
out(c7, (spkgen2(rkA), pkgen2(rkB), spkgen2(rkS)));
(
  (
    (
      (
        (
          ! !_23 <= N
          in(c1[!_23], (=A, =spkgen2(rkA), cert1_41: signature, hostX: host, pkX: pkey, cert2_40: signature));
          find @i_122 <= N suchthat defined(SRkey_130[j2_31[@i_122]], x_71[@i_122]) && check2(concat4(A, spkgen2(rkA)), spkgen(rkS), cert1_41) then
          find @i_114 <= N suchthat defined(Kkey[j2_35[@i_114]], h2_33[@i_114], x_73[@i_114]) && (((hostX = h2_33[@i_114]) && (pkX = Kkey[j2_35[@i_114]])) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
            new k_42: shkey;
            event beginA(A, hostX, k_42);
            new r1: sseed;
            let x_145: sblocksize = concat2(k_42, A, hostX) in
            let x_65: blocksize = concat1(k_42, A, hostX, sign2(x_145, sskgen2(rkA), r1)) in
            if (pkX = pkgen2(rkB)) then
              new r2_137: seed;
              let m2_63: bitstring = enc2(Z, pkX, r2_137) in
              out(c2[!_23], (A, spkgen2(rkA), cert1_41, hostX, pkX, cert2_40, m2_63));
              in(finish[!_23], ());
              out(c8[!_23], k_42)
            else
              new r3_136: seed;
              out(c2[!_23], (A, spkgen2(rkA), cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_136)));
              in(finish[!_23], ());
              out(c8[!_23], k_42)
          orfind @i_113 <= N suchthat defined(h2_33[@i_113], x_75[@i_113]) && (((hostX = h2_33[@i_113]) && (pkX = pkgen2(rkB))) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
            new k_42: shkey;
            event beginA(A, hostX, k_42);
            new r1: sseed;
            new r2_138: seed;
            let m2_63: bitstring = enc2(Z, pkX, r2_138) in
            out(c2[!_23], (A, spkgen2(rkA), cert1_41, hostX, pkX, cert2_40, m2_63));
            in(finish[!_23], ());
            let keyA: shkey = k_42
        |
          ! !_24 <= N
          in(c3[!_24], (hostY: host, pkY: spkey, cert1_38: signature, =B, =pkgen2(rkB), cert2_37: signature, m: bitstring));
          find @i_108 <= N suchthat defined(SKkey[j2_31[@i_108]], h2_29[@i_108], SRkey_129[j2_31[@i_108]], x_71[@i_108]) && (((hostY = h2_29[@i_108]) && (pkY = SKkey[j2_31[@i_108]])) && check2(concat4(hostY, pkY), spkgen(rkS), cert1_38)) then
            find @i_99 <= N suchthat defined(x_75[@i_99]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37) then
            find @i_69 <= N suchthat defined(m2_63[@i_69]) && (m = m2_63[@i_69]) then
              yield
            else
              let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
              if (pkY = spkgen2(rkS)) then
                yield
              else
                if (pkY = spkgen2(rkA)) then
                  yield
                else
                  if check(concat2(k_39, hostY, B), pkY, s) then
                  out(c9[!_24], k_39)
          orfind @i_108 <= N suchthat defined(h2_29[@i_108], SRkey_130[j2_31[@i_108]], x_71[@i_108]) && (((hostY = h2_29[@i_108]) && (pkY = spkgen2(rkA))) && check2(concat4(hostY, pkY), spkgen(rkS), cert1_38)) then
            find @i_99 <= N suchthat defined(x_75[@i_99]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37) then
            find @i_69 <= N suchthat defined(r1[@i_69], k_42[@i_69], hostX[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
              if (B = hostX[@i_69]) then
              let x_141: sblocksize = concat2(k_42[@i_69], A, hostX[@i_69]) in
              let s: signature = sign2(x_141, sskgen2(rkA), r1[@i_69]) in
              find @i_169 <= N suchthat defined(k_42[@i_69[@i_169]], x_141[@i_169]) && (k_42[@i_69] = k_42[@i_69[@i_169]]) then
              let @i_168 <= N = @i_69[@i_169] in
              event endB(hostY, B, k_42[@i_69]);
              let keyB: shkey = k_42[@i_69]
            else
              let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
              find @i_162 <= N suchthat defined(k_42[@i_69[@i_162]], x_141[@i_162]) && ((k_39 = k_42[@i_69[@i_162]]) && check2(concat2(k_39, hostY, B), pkY, s)) then
              let @i_161 <= N = @i_69[@i_162] in
              event endB(hostY, B, k_39);
              let keyB: shkey = k_39
        )
      |
        ! !_25 <= N
        in(c5[!_25], (h1_34: host, h2_33: host));
        find j2_35 <= N2 suchthat defined(Kkey[j2_35], Khost[j2_35], Rkey_59[j2_35]) && (Khost[j2_35] = h2_33) then
          let x_73: sblocksize = concat3(h2_33, Kkey[j2_35]) in
          new r3_61: sseed;
          out(c6[!_25], (h2_33, Kkey[j2_35], sign2(x_73, sskgen2(rkS), r3_61)))
        orfind j2_35 <= N2 suchthat defined(Khost[j2_35], Rkey_60[j2_35]) && (Khost[j2_35] = h2_33) then
          let x_75: sblocksize = concat3(h2_33, pkgen2(rkB)) in
          new r3_62: sseed;
          out(c6[!_25], (h2_33, pkgen2(rkB), sign2(x_75, sskgen2(rkS), r3_62)))
      )
    |
      ! !_26 <= N
      in(c11[!_26], (h1_30: host, h2_29: host));
      find j2_31 <= N2 suchthat defined(SKkey[j2_31], SKhost[j2_31], SRkey_129[j2_31]) && (SKhost[j2_31] = h2_29) then
        let x_71: sblocksize = concat4(h2_29, SKkey[j2_31]) in
        new r3_131: sseed;
        out(c12[!_26], (h2_29, SKkey[j2_31], sign2(x_71, sskgen2(rkS), r3_131)))
      orfind j2_31 <= N2 suchthat defined(SKhost[j2_31], SRkey_130[j2_31]) && (SKhost[j2_31] = h2_29) then
        let x_71: sblocksize = concat4(h2_29, spkgen2(rkA)) in
        new r3_132: sseed;
        out(c12[!_26], (h2_29, spkgen2(rkA), sign2(x_71, sskgen2(rkS), r3_132)))
    )
  |
    ! !_27 <= N2
    in(c4[!_27], (Khost: host, Kkey: pkey));
    if (Khost = B) then
      let Rkey_60: pkey = cst_pkey
    else
      let Rkey_59: pkey = cst_pkey
  )
|
  ! !_28 <= N2
  in(c10[!_28], (SKhost: host, SKkey: spkey));
  if (SKhost = A) then
    let SRkey_130: spkey = cst_spkey
  else
    let SRkey_129: spkey = cst_spkey
)


Applying move new all binders yields

Game 24 is
in(start, ());
new rkS: skeyseed;
new rkB: keyseed;
new rkA: skeyseed;
out(c7, (spkgen2(rkA), pkgen2(rkB), spkgen2(rkS)));
(
  (
    (
      (
        (
          ! !_23 <= N
          in(c1[!_23], (=A, =spkgen2(rkA), cert1_41: signature, hostX: host, pkX: pkey, cert2_40: signature));
          find @i_122 <= N suchthat defined(SRkey_130[j2_31[@i_122]], x_71[@i_122]) && check2(concat4(A, spkgen2(rkA)), spkgen(rkS), cert1_41) then
          find @i_114 <= N suchthat defined(Kkey[j2_35[@i_114]], h2_33[@i_114], x_73[@i_114]) && (((hostX = h2_33[@i_114]) && (pkX = Kkey[j2_35[@i_114]])) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
            new k_42: shkey;
            event beginA(A, hostX, k_42);
            new r1: sseed;
            let x_145: sblocksize = concat2(k_42, A, hostX) in
            let x_65: blocksize = concat1(k_42, A, hostX, sign2(x_145, sskgen2(rkA), r1)) in
            if (pkX = pkgen2(rkB)) then
              new r2_137: seed;
              let m2_63: bitstring = enc2(Z, pkX, r2_137) in
              out(c2[!_23], (A, spkgen2(rkA), cert1_41, hostX, pkX, cert2_40, m2_63));
              in(finish[!_23], ());
              out(c8[!_23], k_42)
            else
              new r3_136: seed;
              out(c2[!_23], (A, spkgen2(rkA), cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_136)));
              in(finish[!_23], ());
              out(c8[!_23], k_42)
          orfind @i_113 <= N suchthat defined(h2_33[@i_113], x_75[@i_113]) && (((hostX = h2_33[@i_113]) && (pkX = pkgen2(rkB))) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
            new k_42: shkey;
            event beginA(A, hostX, k_42);
            new r1: sseed;
            new r2_138: seed;
            let m2_63: bitstring = enc2(Z, pkX, r2_138) in
            out(c2[!_23], (A, spkgen2(rkA), cert1_41, hostX, pkX, cert2_40, m2_63));
            in(finish[!_23], ());
            let keyA: shkey = k_42
        |
          ! !_24 <= N
          in(c3[!_24], (hostY: host, pkY: spkey, cert1_38: signature, =B, =pkgen2(rkB), cert2_37: signature, m: bitstring));
          find @i_108 <= N suchthat defined(SKkey[j2_31[@i_108]], h2_29[@i_108], SRkey_129[j2_31[@i_108]], x_71[@i_108]) && (((hostY = h2_29[@i_108]) && (pkY = SKkey[j2_31[@i_108]])) && check2(concat4(hostY, pkY), spkgen(rkS), cert1_38)) then
            find @i_99 <= N suchthat defined(x_75[@i_99]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37) then
            find @i_69 <= N suchthat defined(m2_63[@i_69]) && (m = m2_63[@i_69]) then
              yield
            else
              let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
              if (pkY = spkgen2(rkS)) then
                yield
              else
                if (pkY = spkgen2(rkA)) then
                  yield
                else
                  if check(concat2(k_39, hostY, B), pkY, s) then
                  out(c9[!_24], k_39)
          orfind @i_108 <= N suchthat defined(h2_29[@i_108], SRkey_130[j2_31[@i_108]], x_71[@i_108]) && (((hostY = h2_29[@i_108]) && (pkY = spkgen2(rkA))) && check2(concat4(hostY, pkY), spkgen(rkS), cert1_38)) then
            find @i_99 <= N suchthat defined(x_75[@i_99]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37) then
            find @i_69 <= N suchthat defined(r1[@i_69], k_42[@i_69], hostX[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
              if (B = hostX[@i_69]) then
              let x_141: sblocksize = concat2(k_42[@i_69], A, hostX[@i_69]) in
              let s: signature = sign2(x_141, sskgen2(rkA), r1[@i_69]) in
              find @i_169 <= N suchthat defined(k_42[@i_69[@i_169]], x_141[@i_169]) && (k_42[@i_69] = k_42[@i_69[@i_169]]) then
              let @i_168 <= N = @i_69[@i_169] in
              event endB(hostY, B, k_42[@i_69]);
              let keyB: shkey = k_42[@i_69]
            else
              let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
              find @i_162 <= N suchthat defined(k_42[@i_69[@i_162]], x_141[@i_162]) && ((k_39 = k_42[@i_69[@i_162]]) && check2(concat2(k_39, hostY, B), pkY, s)) then
              let @i_161 <= N = @i_69[@i_162] in
              event endB(hostY, B, k_39);
              let keyB: shkey = k_39
        )
      |
        ! !_25 <= N
        in(c5[!_25], (h1_34: host, h2_33: host));
        find j2_35 <= N2 suchthat defined(Kkey[j2_35], Khost[j2_35], Rkey_59[j2_35]) && (Khost[j2_35] = h2_33) then
          let x_73: sblocksize = concat3(h2_33, Kkey[j2_35]) in
          new r3_61: sseed;
          out(c6[!_25], (h2_33, Kkey[j2_35], sign2(x_73, sskgen2(rkS), r3_61)))
        orfind j2_35 <= N2 suchthat defined(Khost[j2_35], Rkey_60[j2_35]) && (Khost[j2_35] = h2_33) then
          let x_75: sblocksize = concat3(h2_33, pkgen2(rkB)) in
          new r3_62: sseed;
          out(c6[!_25], (h2_33, pkgen2(rkB), sign2(x_75, sskgen2(rkS), r3_62)))
      )
    |
      ! !_26 <= N
      in(c11[!_26], (h1_30: host, h2_29: host));
      find j2_31 <= N2 suchthat defined(SKkey[j2_31], SKhost[j2_31], SRkey_129[j2_31]) && (SKhost[j2_31] = h2_29) then
        let x_71: sblocksize = concat4(h2_29, SKkey[j2_31]) in
        new r3_131: sseed;
        out(c12[!_26], (h2_29, SKkey[j2_31], sign2(x_71, sskgen2(rkS), r3_131)))
      orfind j2_31 <= N2 suchthat defined(SKhost[j2_31], SRkey_130[j2_31]) && (SKhost[j2_31] = h2_29) then
        let x_71: sblocksize = concat4(h2_29, spkgen2(rkA)) in
        new r3_132: sseed;
        out(c12[!_26], (h2_29, spkgen2(rkA), sign2(x_71, sskgen2(rkS), r3_132)))
    )
  |
    ! !_27 <= N2
    in(c4[!_27], (Khost: host, Kkey: pkey));
    if (Khost = B) then
      let Rkey_60: pkey = cst_pkey
    else
      let Rkey_59: pkey = cst_pkey
  )
|
  ! !_28 <= N2
  in(c10[!_28], (SKhost: host, SKkey: spkey));
  if (SKhost = A) then
    let SRkey_130: spkey = cst_spkey
  else
    let SRkey_129: spkey = cst_spkey
)


Applying remove assignments of useless yields

Game 25 is
in(start, ());
new rkS: skeyseed;
new rkB: keyseed;
new rkA: skeyseed;
out(c7, (spkgen2(rkA), pkgen2(rkB), spkgen2(rkS)));
(
  (
    (
      (
        (
          ! !_23 <= N
          in(c1[!_23], (=A, =spkgen2(rkA), cert1_41: signature, hostX: host, pkX: pkey, cert2_40: signature));
          find @i_122 <= N suchthat defined(SRkey_130[j2_31[@i_122]], x_71[@i_122]) && check2(concat4(A, spkgen2(rkA)), spkgen(rkS), cert1_41) then
          find @i_114 <= N suchthat defined(Kkey[j2_35[@i_114]], h2_33[@i_114], x_73[@i_114]) && (((hostX = h2_33[@i_114]) && (pkX = Kkey[j2_35[@i_114]])) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
            new k_42: shkey;
            event beginA(A, hostX, k_42);
            new r1: sseed;
            let x_145: sblocksize = concat2(k_42, A, hostX) in
            let x_65: blocksize = concat1(k_42, A, hostX, sign2(x_145, sskgen2(rkA), r1)) in
            if (pkX = pkgen2(rkB)) then
              new r2_137: seed;
              let m2_63: bitstring = enc2(Z, pkX, r2_137) in
              out(c2[!_23], (A, spkgen2(rkA), cert1_41, hostX, pkX, cert2_40, m2_63));
              in(finish[!_23], ());
              out(c8[!_23], k_42)
            else
              new r3_136: seed;
              out(c2[!_23], (A, spkgen2(rkA), cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_136)));
              in(finish[!_23], ());
              out(c8[!_23], k_42)
          orfind @i_113 <= N suchthat defined(h2_33[@i_113], x_75[@i_113]) && (((hostX = h2_33[@i_113]) && (pkX = pkgen2(rkB))) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
            new k_42: shkey;
            event beginA(A, hostX, k_42);
            new r1: sseed;
            new r2_138: seed;
            let m2_63: bitstring = enc2(Z, pkX, r2_138) in
            out(c2[!_23], (A, spkgen2(rkA), cert1_41, hostX, pkX, cert2_40, m2_63));
            in(finish[!_23], ());
            let keyA: shkey = k_42
        |
          ! !_24 <= N
          in(c3[!_24], (hostY: host, pkY: spkey, cert1_38: signature, =B, =pkgen2(rkB), cert2_37: signature, m: bitstring));
          find @i_108 <= N suchthat defined(SKkey[j2_31[@i_108]], h2_29[@i_108], SRkey_129[j2_31[@i_108]], x_71[@i_108]) && (((hostY = h2_29[@i_108]) && (pkY = SKkey[j2_31[@i_108]])) && check2(concat4(hostY, pkY), spkgen(rkS), cert1_38)) then
            find @i_99 <= N suchthat defined(x_75[@i_99]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37) then
            find @i_69 <= N suchthat defined(m2_63[@i_69]) && (m = m2_63[@i_69]) then
              yield
            else
              let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
              if (pkY = spkgen2(rkS)) then
                yield
              else
                if (pkY = spkgen2(rkA)) then
                  yield
                else
                  if check(concat2(k_39, hostY, B), pkY, s) then
                  out(c9[!_24], k_39)
          orfind @i_108 <= N suchthat defined(h2_29[@i_108], SRkey_130[j2_31[@i_108]], x_71[@i_108]) && (((hostY = h2_29[@i_108]) && (pkY = spkgen2(rkA))) && check2(concat4(hostY, pkY), spkgen(rkS), cert1_38)) then
            find @i_99 <= N suchthat defined(x_75[@i_99]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37) then
            find @i_69 <= N suchthat defined(r1[@i_69], k_42[@i_69], hostX[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
              if (B = hostX[@i_69]) then
              let x_141: sblocksize = cst_sblocksize in
              find @i_169 <= N suchthat defined(k_42[@i_69[@i_169]], x_141[@i_169]) && (k_42[@i_69] = k_42[@i_69[@i_169]]) then
              event endB(hostY, B, k_42[@i_69]);
              let keyB: shkey = k_42[@i_69]
            else
              let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
              find @i_162 <= N suchthat defined(k_42[@i_69[@i_162]], x_141[@i_162]) && ((k_39 = k_42[@i_69[@i_162]]) && check2(concat2(k_39, hostY, B), pkY, s)) then
              event endB(hostY, B, k_39);
              let keyB: shkey = k_39
        )
      |
        ! !_25 <= N
        in(c5[!_25], (h1_34: host, h2_33: host));
        find j2_35 <= N2 suchthat defined(Kkey[j2_35], Khost[j2_35], Rkey_59[j2_35]) && (Khost[j2_35] = h2_33) then
          let x_73: sblocksize = concat3(h2_33, Kkey[j2_35]) in
          new r3_61: sseed;
          out(c6[!_25], (h2_33, Kkey[j2_35], sign2(x_73, sskgen2(rkS), r3_61)))
        orfind j2_35 <= N2 suchthat defined(Khost[j2_35], Rkey_60[j2_35]) && (Khost[j2_35] = h2_33) then
          let x_75: sblocksize = concat3(h2_33, pkgen2(rkB)) in
          new r3_62: sseed;
          out(c6[!_25], (h2_33, pkgen2(rkB), sign2(x_75, sskgen2(rkS), r3_62)))
      )
    |
      ! !_26 <= N
      in(c11[!_26], (h1_30: host, h2_29: host));
      find j2_31 <= N2 suchthat defined(SKkey[j2_31], SKhost[j2_31], SRkey_129[j2_31]) && (SKhost[j2_31] = h2_29) then
        let x_71: sblocksize = concat4(h2_29, SKkey[j2_31]) in
        new r3_131: sseed;
        out(c12[!_26], (h2_29, SKkey[j2_31], sign2(x_71, sskgen2(rkS), r3_131)))
      orfind j2_31 <= N2 suchthat defined(SKhost[j2_31], SRkey_130[j2_31]) && (SKhost[j2_31] = h2_29) then
        let x_71: sblocksize = concat4(h2_29, spkgen2(rkA)) in
        new r3_132: sseed;
        out(c12[!_26], (h2_29, spkgen2(rkA), sign2(x_71, sskgen2(rkS), r3_132)))
    )
  |
    ! !_27 <= N2
    in(c4[!_27], (Khost: host, Kkey: pkey));
    if (Khost = B) then
      let Rkey_60: pkey = cst_pkey
    else
      let Rkey_59: pkey = cst_pkey
  )
|
  ! !_28 <= N2
  in(c10[!_28], (SKhost: host, SKkey: spkey));
  if (SKhost = A) then
    let SRkey_130: spkey = cst_spkey
  else
    let SRkey_129: spkey = cst_spkey
)


Applying SA rename k_42 yields

Game 26 is
in(start, ());
new rkS: skeyseed;
new rkB: keyseed;
new rkA: skeyseed;
out(c7, (spkgen2(rkA), pkgen2(rkB), spkgen2(rkS)));
(
  (
    (
      (
        (
          ! !_23 <= N
          in(c1[!_23], (=A, =spkgen2(rkA), cert1_41: signature, hostX: host, pkX: pkey, cert2_40: signature));
          find @i_122 <= N suchthat defined(SRkey_130[j2_31[@i_122]], x_71[@i_122]) && check2(concat4(A, spkgen2(rkA)), spkgen(rkS), cert1_41) then
          find @i_114 <= N suchthat defined(Kkey[j2_35[@i_114]], h2_33[@i_114], x_73[@i_114]) && (((hostX = h2_33[@i_114]) && (pkX = Kkey[j2_35[@i_114]])) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
            new k_175: shkey;
            event beginA(A, hostX, k_175);
            new r1: sseed;
            let x_145: sblocksize = concat2(k_175, A, hostX) in
            let x_65: blocksize = concat1(k_175, A, hostX, sign2(x_145, sskgen2(rkA), r1)) in
            if (pkX = pkgen2(rkB)) then
              new r2_137: seed;
              let m2_63: bitstring = enc2(Z, pkX, r2_137) in
              out(c2[!_23], (A, spkgen2(rkA), cert1_41, hostX, pkX, cert2_40, m2_63));
              in(finish[!_23], ());
              out(c8[!_23], k_175)
            else
              new r3_136: seed;
              out(c2[!_23], (A, spkgen2(rkA), cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_136)));
              in(finish[!_23], ());
              out(c8[!_23], k_175)
          orfind @i_113 <= N suchthat defined(h2_33[@i_113], x_75[@i_113]) && (((hostX = h2_33[@i_113]) && (pkX = pkgen2(rkB))) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
            new k_176: shkey;
            event beginA(A, hostX, k_176);
            new r1: sseed;
            new r2_138: seed;
            let m2_63: bitstring = enc2(Z, pkX, r2_138) in
            out(c2[!_23], (A, spkgen2(rkA), cert1_41, hostX, pkX, cert2_40, m2_63));
            in(finish[!_23], ());
            let keyA: shkey = k_176
        |
          ! !_24 <= N
          in(c3[!_24], (hostY: host, pkY: spkey, cert1_38: signature, =B, =pkgen2(rkB), cert2_37: signature, m: bitstring));
          find @i_108 <= N suchthat defined(SKkey[j2_31[@i_108]], h2_29[@i_108], SRkey_129[j2_31[@i_108]], x_71[@i_108]) && (((hostY = h2_29[@i_108]) && (pkY = SKkey[j2_31[@i_108]])) && check2(concat4(hostY, pkY), spkgen(rkS), cert1_38)) then
            find @i_99 <= N suchthat defined(x_75[@i_99]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37) then
            find @i_69 <= N suchthat defined(m2_63[@i_69]) && (m = m2_63[@i_69]) then
              yield
            else
              let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
              if (pkY = spkgen2(rkS)) then
                yield
              else
                if (pkY = spkgen2(rkA)) then
                  yield
                else
                  if check(concat2(k_39, hostY, B), pkY, s) then
                  out(c9[!_24], k_39)
          orfind @i_108 <= N suchthat defined(h2_29[@i_108], SRkey_130[j2_31[@i_108]], x_71[@i_108]) && (((hostY = h2_29[@i_108]) && (pkY = spkgen2(rkA))) && check2(concat4(hostY, pkY), spkgen(rkS), cert1_38)) then
            find @i_99 <= N suchthat defined(x_75[@i_99]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37) then
            find @i_69 <= N suchthat defined(r1[@i_69], k_175[@i_69], hostX[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
              if (B = hostX[@i_69]) then
              let x_141: sblocksize = cst_sblocksize in
              find @i_169 <= N suchthat defined(k_175[@i_69[@i_169]], x_141[@i_169]) && (k_175[@i_69] = k_175[@i_69[@i_169]]) then
                event endB(hostY, B, k_175[@i_69]);
                let keyB: shkey = k_175[@i_69]
              orfind @i_169 <= N suchthat defined(k_176[@i_69[@i_169]], x_141[@i_169]) && (k_175[@i_69] = k_176[@i_69[@i_169]]) then
                event endB(hostY, B, k_175[@i_69]);
                let keyB: shkey = k_175[@i_69]
            orfind @i_69 <= N suchthat defined(r1[@i_69], k_176[@i_69], hostX[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
              if (B = hostX[@i_69]) then
              let x_141: sblocksize = cst_sblocksize in
              find @i_169 <= N suchthat defined(k_175[@i_69[@i_169]], x_141[@i_169]) && (k_176[@i_69] = k_175[@i_69[@i_169]]) then
                event endB(hostY, B, k_176[@i_69]);
                let keyB: shkey = k_176[@i_69]
              orfind @i_169 <= N suchthat defined(k_176[@i_69[@i_169]], x_141[@i_169]) && (k_176[@i_69] = k_176[@i_69[@i_169]]) then
                event endB(hostY, B, k_176[@i_69]);
                let keyB: shkey = k_176[@i_69]
            else
              let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
              find @i_162 <= N suchthat defined(k_175[@i_69[@i_162]], x_141[@i_162]) && ((k_39 = k_175[@i_69[@i_162]]) && check2(concat2(k_39, hostY, B), pkY, s)) then
                event endB(hostY, B, k_39);
                let keyB: shkey = k_39
              orfind @i_162 <= N suchthat defined(k_176[@i_69[@i_162]], x_141[@i_162]) && ((k_39 = k_176[@i_69[@i_162]]) && check2(concat2(k_39, hostY, B), pkY, s)) then
                event endB(hostY, B, k_39);
                let keyB: shkey = k_39
        )
      |
        ! !_25 <= N
        in(c5[!_25], (h1_34: host, h2_33: host));
        find j2_35 <= N2 suchthat defined(Kkey[j2_35], Khost[j2_35], Rkey_59[j2_35]) && (Khost[j2_35] = h2_33) then
          let x_73: sblocksize = concat3(h2_33, Kkey[j2_35]) in
          new r3_61: sseed;
          out(c6[!_25], (h2_33, Kkey[j2_35], sign2(x_73, sskgen2(rkS), r3_61)))
        orfind j2_35 <= N2 suchthat defined(Khost[j2_35], Rkey_60[j2_35]) && (Khost[j2_35] = h2_33) then
          let x_75: sblocksize = concat3(h2_33, pkgen2(rkB)) in
          new r3_62: sseed;
          out(c6[!_25], (h2_33, pkgen2(rkB), sign2(x_75, sskgen2(rkS), r3_62)))
      )
    |
      ! !_26 <= N
      in(c11[!_26], (h1_30: host, h2_29: host));
      find j2_31 <= N2 suchthat defined(SKkey[j2_31], SKhost[j2_31], SRkey_129[j2_31]) && (SKhost[j2_31] = h2_29) then
        let x_71: sblocksize = concat4(h2_29, SKkey[j2_31]) in
        new r3_131: sseed;
        out(c12[!_26], (h2_29, SKkey[j2_31], sign2(x_71, sskgen2(rkS), r3_131)))
      orfind j2_31 <= N2 suchthat defined(SKhost[j2_31], SRkey_130[j2_31]) && (SKhost[j2_31] = h2_29) then
        let x_71: sblocksize = concat4(h2_29, spkgen2(rkA)) in
        new r3_132: sseed;
        out(c12[!_26], (h2_29, spkgen2(rkA), sign2(x_71, sskgen2(rkS), r3_132)))
    )
  |
    ! !_27 <= N2
    in(c4[!_27], (Khost: host, Kkey: pkey));
    if (Khost = B) then
      let Rkey_60: pkey = cst_pkey
    else
      let Rkey_59: pkey = cst_pkey
  )
|
  ! !_28 <= N2
  in(c10[!_28], (SKhost: host, SKkey: spkey));
  if (SKhost = A) then
    let SRkey_130: spkey = cst_spkey
  else
    let SRkey_129: spkey = cst_spkey
)


Applying simplify yields

Game 27 is
in(start, ());
new rkS: skeyseed;
new rkB: keyseed;
new rkA: skeyseed;
out(c7, (spkgen2(rkA), pkgen2(rkB), spkgen2(rkS)));
(
  (
    (
      (
        (
          ! !_23 <= N
          in(c1[!_23], (=A, =spkgen2(rkA), cert1_41: signature, hostX: host, pkX: pkey, cert2_40: signature));
          find @i_122 <= N suchthat defined(SRkey_130[j2_31[@i_122]], x_71[@i_122]) && check2(concat4(A, spkgen2(rkA)), spkgen(rkS), cert1_41) then
          find @i_114 <= N suchthat defined(Kkey[j2_35[@i_114]], h2_33[@i_114], x_73[@i_114]) && (((hostX = h2_33[@i_114]) && (pkX = Kkey[j2_35[@i_114]])) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
            new k_175: shkey;
            event beginA(A, hostX, k_175);
            new r1: sseed;
            let x_145: sblocksize = concat2(k_175, A, hostX) in
            let x_65: blocksize = concat1(k_175, A, hostX, sign2(x_145, sskgen2(rkA), r1)) in
            if (pkX = pkgen2(rkB)) then
              new r2_137: seed;
              let m2_63: bitstring = enc2(Z, pkX, r2_137) in
              out(c2[!_23], (A, spkgen2(rkA), cert1_41, hostX, pkX, cert2_40, m2_63));
              in(finish[!_23], ());
              out(c8[!_23], k_175)
            else
              new r3_136: seed;
              out(c2[!_23], (A, spkgen2(rkA), cert1_41, hostX, pkX, cert2_40, enc(x_65, pkX, r3_136)));
              in(finish[!_23], ());
              out(c8[!_23], k_175)
          orfind @i_113 <= N suchthat defined(h2_33[@i_113], x_75[@i_113]) && (((hostX = h2_33[@i_113]) && (pkX = pkgen2(rkB))) && check2(concat3(hostX, pkX), spkgen(rkS), cert2_40)) then
            new k_176: shkey;
            event beginA(A, hostX, k_176);
            new r2_138: seed;
            let m2_63: bitstring = enc2(Z, pkX, r2_138) in
            out(c2[!_23], (A, spkgen2(rkA), cert1_41, hostX, pkX, cert2_40, m2_63));
            in(finish[!_23], ());
            let keyA: shkey = k_176
        |
          ! !_24 <= N
          in(c3[!_24], (hostY: host, pkY: spkey, cert1_38: signature, =B, =pkgen2(rkB), cert2_37: signature, m: bitstring));
          find @i_108 <= N suchthat defined(SKkey[j2_31[@i_108]], h2_29[@i_108], SRkey_129[j2_31[@i_108]], x_71[@i_108]) && (((hostY = h2_29[@i_108]) && (pkY = SKkey[j2_31[@i_108]])) && check2(concat4(hostY, pkY), spkgen(rkS), cert1_38)) then
            find @i_99 <= N suchthat defined(x_75[@i_99]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37) then
            find @i_69 <= N suchthat defined(m2_63[@i_69]) && (m = m2_63[@i_69]) then
              yield
            else
              let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
              if (pkY = spkgen2(rkS)) then
                yield
              else
                if (pkY = spkgen2(rkA)) then
                  yield
                else
                  if check(concat2(k_39, hostY, B), pkY, s) then
                  out(c9[!_24], k_39)
          orfind @i_108 <= N suchthat defined(h2_29[@i_108], SRkey_130[j2_31[@i_108]], x_71[@i_108]) && (((hostY = h2_29[@i_108]) && (pkY = spkgen2(rkA))) && check2(concat4(hostY, pkY), spkgen(rkS), cert1_38)) then
            find @i_99 <= N suchthat defined(x_75[@i_99]) && check2(concat3(B, pkgen2(rkB)), spkgen(rkS), cert2_37) then
            find @i_69 <= N suchthat defined(m2_63[@i_69], k_175[@i_69]) && (m = m2_63[@i_69]) then
              yield
            orfind @i_69 <= N suchthat defined(k_176[@i_69], m2_63[@i_69]) && (m = m2_63[@i_69]) then
              let x_141: sblocksize = cst_sblocksize in
              find @i_169 <= N suchthat defined(k_176[@i_69[@i_169]], x_141[@i_169]) && (k_176[@i_69] = k_176[@i_69[@i_169]]) then
              event endB(hostY, B, k_176[@i_69]);
              let keyB: shkey = k_176[@i_69]
            else
              let injbot(concat1(k_39: shkey, =hostY, =B, s: signature)) = dec2(m, skgen2(rkB)) in
              find @i_162 <= N suchthat defined(k_176[@i_69[@i_162]], x_141[@i_162]) && ((k_39 = k_176[@i_69[@i_162]]) && check2(concat2(k_39, hostY, B), pkY, s)) then
              event endB(hostY, B, k_39);
              let keyB: shkey = k_39
        )
      |
        ! !_25 <= N
        in(c5[!_25], (h1_34: host, h2_33: host));
        find j2_35 <= N2 suchthat defined(Kkey[j2_35], Khost[j2_35], Rkey_59[j2_35]) && (Khost[j2_35] = h2_33) then
          let x_73: sblocksize = concat3(h2_33, Kkey[j2_35]) in
          new r3_61: sseed;
          out(c6[!_25], (h2_33, Kkey[j2_35], sign2(x_73, sskgen2(rkS), r3_61)))
        orfind j2_35 <= N2 suchthat defined(Khost[j2_35], Rkey_60[j2_35]) && (Khost[j2_35] = h2_33) then
          let x_75: sblocksize = concat3(h2_33, pkgen2(rkB)) in
          new r3_62: sseed;
          out(c6[!_25], (h2_33, pkgen2(rkB), sign2(x_75, sskgen2(rkS), r3_62)))
      )
    |
      ! !_26 <= N
      in(c11[!_26], (h1_30: host, h2_29: host));
      find j2_31 <= N2 suchthat defined(SKkey[j2_31], SKhost[j2_31], SRkey_129[j2_31]) && (SKhost[j2_31] = h2_29) then
        let x_71: sblocksize = concat4(h2_29, SKkey[j2_31]) in
        new r3_131: sseed;
        out(c12[!_26], (h2_29, SKkey[j2_31], sign2(x_71, sskgen2(rkS), r3_131)))
      orfind j2_31 <= N2 suchthat defined(SKhost[j2_31], SRkey_130[j2_31]) && (SKhost[j2_31] = h2_29) then
        let x_71: sblocksize = concat4(h2_29, spkgen2(rkA)) in
        new r3_132: sseed;
        out(c12[!_26], (h2_29, spkgen2(rkA), sign2(x_71, sskgen2(rkS), r3_132)))
    )
  |
    ! !_27 <= N2
    in(c4[!_27], (Khost: host, Kkey: pkey));
    if (Khost = B) then
      let Rkey_60: pkey = cst_pkey
    else
      let Rkey_59: pkey = cst_pkey
  )
|
  ! !_28 <= N2
  in(c10[!_28], (SKhost: host, SKkey: spkey));
  if (SKhost = A) then
    let SRkey_130: spkey = cst_spkey
  else
    let SRkey_129: spkey = cst_spkey
)

RESULT time(context for game 7) = time(A) * N2 + 2. * time(= host) * N2 + time(B) * N2 + 3. * time(concat4) * N + 3. * time(sign) * N + 3. * N2 * time(= host) * N + 3. * time(concat3) * N + time(= pkey) * N + time(let concat1) * N + time(let injbot) * N + 5. * time(B) * N + 2. * time(concat2) * N + 5. * time(check) * N + 6. * time(A) * N + 6. * time(= host) * N + time(= spkey) * N + time(concat1) * N + 2. * time(sskgen) + 2. * time(spkgen)
RESULT time(context for game 13) = time(A) * N2 + 2. * time(= host) * N2 + time(B) * N2 + 3. * time(concat4) * N + 3. * N2 * time(= host) * N + 5. * time(pkgen2) * N + 3. * time(concat3) * N + 2. * time(= pkey) * N + 2. * time(sign) * N + time(let concat1) * N + time(let injbot) * N + time(skgen2) * N + time(dec2, maxlength(game 13: m[!_24])) * N + 5. * time(B) * N + 3. * time(concat2) * N + 7. * time(A) * N + 6. * time(= host) * N + N * N * time(= bitstring, maxlength(game 13: m[!_24]), maxlength(game 13: m2_63[!_23])) + time(= spkey) * N + time(concat1) * N + time(Z) * N + time(enc2) * N + time(enc) * N + time(pkgen2) + time(sskgen) + time(spkgen)
RESULT time(context for game 21) = time(A) * N2 + 2. * time(= host) * N2 + time(B) * N2 + time(concat4) * N + 2. * time(sskgen2) * N + 2. * time(sign2) * N + 4. * N2 * time(= host) * N + time(concat3) * N + 4. * time(pkgen2) * N + 2. * time(= pkey) * N + time(let concat1) * N + time(let injbot) * N + time(skgen2) * N + time(dec2, maxlength(game 21: m[!_24])) * N + time(spkgen2) * N + 2. * time(= spkey) * N + 3. * time(B) * N + 3. * time(concat2) * N + 6. * time(A) * N + 5. * time(= host) * N + N * N * time(= bitstring, maxlength(game 21: m[!_24]), maxlength(game 21: m2_63[!_23])) + 3. * N * N * time(concat3) + 2. * N * N * time(pkgen2) + N * N * time(B) + 7. * N * N * time(check2) + 7. * N * N * time(spkgen) + 4. * N * N * time(concat4) + 4. * N * N * time(= spkey) + 6. * N * N * time(= host) + time(concat1) * N + time(enc) * N + time(Z) * N + time(enc2) * N + 2. * N * N * time(= pkey) + 4. * N * N * time(A) + time(spkgen2) + time(pkgen2)
Please enter a command: quit
You have mail in /var/spool/mail/blanchet
bash-3.2$ exit

Process shell finished
