blanchet@laurier:/import/absint3/blanchet/dev/cryptoverif/src$ cd ..
blanchet@laurier:/import/absint3/blanchet/dev/cryptoverif$ cryptoverif eke/EKEtryfinalstep
Doing expand if, let, find... No change.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
No change.
Doing move all binders... No change.
Doing remove assignments of useless... No change.
Please enter a command: set maxIterSimplif = 3
Please enter a command: crypto h1
Trying equivalence
equiv ! !_43 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all], ! !_44 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash1) -> (r' = h1(x1', x2', x3', x4', x5')) [all]
<=(set(proba <= Neq / |hash1|))=>
      ! !_45 <= N (x1_72: host, x2_71: host, x3_70: G, x4_69: G, x5_68: G) -> let x1: host = x1_72 in let x2: host = x2_71 in let x3: G = x3_70 in let x4: G = x4_69 in let x5: G = x5_68 in find [unique] j_47 <= N suchthat defined(x1[j_47], x2[j_47], x3[j_47], x4[j_47], x5[j_47], r1[j_47]) && ((x1 = x1[j_47]) && ((x2 = x2[j_47]) && ((x3 = x3[j_47]) && ((x4 = x4[j_47]) && (x5 = x5[j_47]))))) then r1[j_47] else new r1: hash1; r1, ! !_46 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash1) -> find [unique] j_48 <= N suchthat defined(x1[j_48], x2[j_48], x3[j_48], x4[j_48], x5[j_48], r1[j_48]) && ((x1' = x1[j_48]) && ((x2' = x2[j_48]) && ((x3' = x3[j_48]) && ((x4' = x4[j_48]) && (x5' = x5[j_48]))))) then (r' = r1[j_48]) else false
... Succeeded.
Doing simplify... Run simplify 2 time(s). Fixpoint reached.
Eliminated collisions between exp(g, yp[!_59]) and x4_84[!2_81] Probability: qH1 * NP / |exponent|
(exp(g, yp[!_59]) characterizes a part of yp[!_59] of type(s) exponent;
 x4_84[!2_81] does not depend on yp[!_59])
Eliminated collisions between exp(g, yp[!_59]) and x4_96[!2_79] Probability: NU * NP / |exponent|
(exp(g, yp[!_59]) characterizes a part of yp[!_59] of type(s) exponent;
 x4_96[!2_79] does not depend on yp[!_59])
Eliminated collisions between x and xp Probability: NU * NP / |exponent|
Eliminated collisions between x and x Probability: 0.5 * NU * NU / |exponent|
Eliminated collisions between y and yp Probability: NS * NP / |exponent|
Eliminated collisions between yp and yp Probability: 0.5 * NP * NP / |exponent|
Eliminated collisions between xp and xp Probability: 0.5 * NP * NP / |exponent|
Reduced (mult(xp[!_59], yp[!_59]) = mult(xp[@i_106[!_59]], yp[@i_106[!_59]])) to (((xp[!_59] = xp[@i_106[!_59]]) && (yp[!_59] = yp[@i_106[!_59]])) || (((xp[!_59] = yp[@i_106[!_59]]) && (yp[!_59] = xp[@i_106[!_59]])) || (((xp[!_59] = yp[!_59]) || (xp[@i_106[!_59]] = yp[@i_106[!_59]])) && (@1_mult'(xp[!_59], yp[!_59]) = @1_mult'(xp[@i_106[!_59]], yp[@i_106[!_59]]))))) Probability: 1. / |exponent| * NP
Done.
Doing move all binders... No change.
Doing remove assignments of useless... Done.
Please enter a command: show_game occ
{662}in(start, ());
{661}new pw: passwd;
{660}out(c8, {659}());
{658}(
{653}  ! !_57 <= NU
{652}  in(c1[{651}!_57], ());
{650}  new x: exponent;
{649}  let X: G = {648}exp({645}g, {647}x) in
{644}  out(c2[{643}!_57], {642}({639}U, {641}X));
{638}  in(c5[{637}!_57], (={636}S, Ystar_u: G));
{635}  let Y_u: G = {634}dec({632}Ystar_u, {633}pw) in
{630}  let K_u: G = {629}exp({626}Y_u, {628}x) in
{624}  let x1_99: host = {623}U in
{622}  let x2_98: host = {621}S in
{620}  find [unique] @i_115 <= qH1 suchthat defined(x11[{599}@i_115], x12[{601}@i_115], x13[{603}@i_115], x14[{605}@i_115], x15[{607}@i_115], x5_83[{609}@i_115], x4_84[{611}@i_115], x3_85[{613}@i_115], x2_86[{615}@i_115], x1_87[{617}@i_115], r1_82[{619}@i_115]) && {597}({569}({565}x1_99 = {568}x11[{567}@i_115]) && {596}({575}({571}x2_98 = {574}x12[{573}@i_115]) && {595}({581}({577}X = {580}x13[{579}@i_115]) && {594}({587}({583}Y_u = {586}x14[{585}@i_115]) && {593}({589}K_u = {592}x15[{591}@i_115]))))) then
  (
{563}    let sk_u: hash0 = {562}h0({554}U, {555}S, {557}X, {559}Y_u, {561}K_u) in
{553}    event {552}termU({541}U, {543}X, {544}S, {546}Ystar_u, {549}r1_82[{548}@i_115], {551}sk_u);
{538}    out(c6[{537}!_57], {536}r1_82[{535}@i_115])
  )
  else
{531}    new r1_94: hash1;
{530}    let sk_u: hash0 = {529}h0({521}U, {522}S, {524}X, {526}Y_u, {528}K_u) in
{520}    event {519}termU({509}U, {511}X, {512}S, {514}Ystar_u, {516}r1_94, {518}sk_u);
{506}    out(c6[{505}!_57], {504}r1_94)
) | (
{495}  ! !_58 <= NS
{494}  in(c3[{493}!_58], (={492}U, X_s: G));
{491}  new y: exponent;
{490}  let Y: G = {489}exp({486}g, {488}y) in
{485}  let Ystar: G = {484}enc({482}Y, {483}pw) in
{480}  out(c4[{479}!_58], {478}({475}S, {477}Ystar));
{474}  in(c7[{473}!_58], auth_s: hash1);
{472}  let K_s: G = {471}exp({468}X_s, {470}y) in
{466}  find [unique] @i_111 <= qH1 suchthat defined(x11[{377}@i_111], x12[{379}@i_111], x13[{381}@i_111], x14[{383}@i_111], x15[{385}@i_111], x5_83[{387}@i_111], x4_84[{389}@i_111], x3_85[{391}@i_111], x2_86[{393}@i_111], x1_87[{395}@i_111], r1_82[{397}@i_111]) && {375}({348}({344}U = {347}x11[{346}@i_111]) && {374}({353}({349}S = {352}x12[{351}@i_111]) && {373}({359}({355}X_s = {358}x13[{357}@i_111]) && {372}({365}({361}Y = {364}x14[{363}@i_111]) && {371}({367}K_s = {370}x15[{369}@i_111]))))) then
  (
{343}    if {342}({338}auth_s = {341}r1_82[{340}@i_111]) then
{336}    let sk_s: hash0 = {335}h0({327}U, {328}S, {330}X_s, {332}Y, {334}K_s) in
{326}    event {325}termS({315}U, {317}X_s, {318}S, {320}Ystar, {322}auth_s, {324}sk_s)
  )
  orfind @i_108 <= NU suchthat defined(X[{453}@i_108], Y_u[{455}@i_108], K_u[{457}@i_108], Y_u[{459}@i_108], Y_u[{461}@i_108], Y_u[{463}@i_108], r1_94[{465}@i_108]) && {451}({437}({433}X_s = {436}X[{435}@i_108]) && {450}({443}({439}Y = {442}Y_u[{441}@i_108]) && {449}({445}K_s = {448}K_u[{447}@i_108]))) then
  (
{431}    if {430}({426}auth_s = {429}r1_94[{428}@i_108]) then
{424}    let sk_s: hash0 = {423}h0({415}U, {416}S, {418}X_s, {420}Y, {422}K_s) in
{414}    event {413}termS({403}U, {405}X_s, {406}S, {408}Ystar, {410}auth_s, {412}sk_s)
  )
) | (
{305}  ! !_59 <= NP
{304}  in(cp[{303}!_59], ());
{302}  new xp: exponent;
{301}  let Xp: G = {300}exp({297}g, {299}xp) in
{296}  new yp: exponent;
{295}  let Yp: G = {294}exp({291}g, {293}yp) in
{290}  let Kp: G = {289}exp({283}g, {288}mult({285}xp, {287}yp)) in
{282}  let Ystarp: G = {281}enc({279}Yp, {280}pw) in
{277}  let x1_93: host = {276}U in
{275}  let x2_92: host = {274}S in
{273}  new r1_88: hash1;
{272}  let sk_p: hash0 = {271}h0({263}U, {264}S, {266}Xp, {268}Yp, {270}Kp) in
{262}  out(cp[{261}!_59], {260}({252}U, {254}Xp, {255}S, {257}Ystarp, {259}r1_88))
) | (
{242}  ! !_60 <= qE
{241}  in(@2_c1[{240}!_60], (@2_x: G, @2_ke: passwd));
{239}  out(@2_c2[{238}!_60], {237}enc({234}@2_x, {236}@2_ke))
) | (
{231}  ! !_61 <= qD
{230}  in(@2_c3[{229}!_61], (@2_m: G, @2_kd: passwd));
{228}  out(@2_c4[{227}!_61], {226}dec({223}@2_m, {225}@2_kd))
) | (
{220}  ! !_62 <= qH0
{219}  in(c10[{218}!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
{217}  out(c20[{216}!_62], {215}h0({206}x1, {208}x2, {210}x3, {212}x4, {214}x5))
) | (
{203}  ! !_63 <= qH1
{202}  in(c11[{201}!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
{200}  let x1_87: host = {199}cst_host in
{198}  let x2_86: host = {197}cst_host in
{196}  let x3_85: G = {195}cst_G in
{194}  let x4_84: G = {193}cst_G in
{192}  let x5_83: G = {191}cst_G in
{190}  find [unique] @i_103 <= qH1 suchthat defined(x11[{53}@i_103], x12[{55}@i_103], x13[{57}@i_103], x14[{59}@i_103], x15[{61}@i_103], x5_83[{63}@i_103], x4_84[{65}@i_103], x3_85[{67}@i_103], x2_86[{69}@i_103], x1_87[{71}@i_103], r1_82[{73}@i_103]) && {51}({23}({19}x11 = {22}x11[{21}@i_103]) && {50}({29}({25}x12 = {28}x12[{27}@i_103]) && {49}({35}({31}x13 = {34}x13[{33}@i_103]) && {48}({41}({37}x14 = {40}x14[{39}@i_103]) && {47}({43}x15 = {46}x15[{45}@i_103]))))) then
{17}    out(c21[{16}!_63], {15}r1_82[{14}@i_103])
  orfind @i_102 <= NP suchthat defined(Xp[{115}@i_102], Yp[{117}@i_102], Kp[{119}@i_102], xp[{121}@i_102], xp[{123}@i_102], xp[{125}@i_102], x1_93[{127}@i_102], x2_92[{129}@i_102], r1_88[{131}@i_102]) && {113}({85}({81}x11 = {84}x1_93[{83}@i_102]) && {112}({91}({87}x12 = {90}x2_92[{89}@i_102]) && {111}({97}({93}x13 = {96}Xp[{95}@i_102]) && {110}({103}({99}x14 = {102}Yp[{101}@i_102]) && {109}({105}x15 = {108}Kp[{107}@i_102]))))) then
{79}    out(c21[{78}!_63], {77}r1_88[{76}@i_102])
  orfind @i_100 <= NU suchthat defined(X[{173}@i_100], Y_u[{175}@i_100], K_u[{177}@i_100], Y_u[{179}@i_100], Y_u[{181}@i_100], Y_u[{183}@i_100], x1_99[{185}@i_100], x2_98[{187}@i_100], r1_94[{189}@i_100]) && {171}({143}({139}x11 = {142}x1_99[{141}@i_100]) && {170}({149}({145}x12 = {148}x2_98[{147}@i_100]) && {169}({155}({151}x13 = {154}X[{153}@i_100]) && {168}({161}({157}x14 = {160}Y_u[{159}@i_100]) && {167}({163}x15 = {166}K_u[{165}@i_100]))))) then
{137}    out(c21[{136}!_63], {135}r1_94[{134}@i_100])
  else
{11}    new r1_82: hash1;
{10}    out(c21[{9}!_63], {8}r1_82)
)

Please enter a command: insert 472 find j <= NU suchthat defined(X[j]) && X[j] = X_s then
Doing insert instruction find j <= NU suchthat defined(X[j]) && X[j] = X_s then at occurrence 472... Done.
Please enter a command: show_game occ
{836}in(start, ());
{835}new pw: passwd;
{834}out(c8, {833}());
{832}(
{827}  ! !_57 <= NU
{826}  in(c1[{825}!_57], ());
{824}  new x: exponent;
{823}  let X: G = {822}exp({819}g, {821}x) in
{818}  out(c2[{817}!_57], {816}({813}U, {815}X));
{812}  in(c5[{811}!_57], (={810}S, Ystar_u: G));
{809}  let Y_u: G = {808}dec({806}Ystar_u, {807}pw) in
{804}  let K_u: G = {803}exp({800}Y_u, {802}x) in
{798}  let x1_99: host = {797}U in
{796}  let x2_98: host = {795}S in
{794}  find [unique] @i_115 <= qH1 suchthat defined(x11[{773}@i_115], x12[{775}@i_115], x13[{777}@i_115], x14[{779}@i_115], x15[{781}@i_115], x5_83[{783}@i_115], x4_84[{785}@i_115], x3_85[{787}@i_115], x2_86[{789}@i_115], x1_87[{791}@i_115], r1_82[{793}@i_115]) && {771}({743}({739}x1_99 = {742}x11[{741}@i_115]) && {770}({749}({745}x2_98 = {748}x12[{747}@i_115]) && {769}({755}({751}X = {754}x13[{753}@i_115]) && {768}({761}({757}Y_u = {760}x14[{759}@i_115]) && {767}({763}K_u = {766}x15[{765}@i_115]))))) then
  (
{737}    let sk_u: hash0 = {736}h0({728}U, {729}S, {731}X, {733}Y_u, {735}K_u) in
{727}    event {726}termU({715}U, {717}X, {718}S, {720}Ystar_u, {723}r1_82[{722}@i_115], {725}sk_u);
{712}    out(c6[{711}!_57], {710}r1_82[{709}@i_115])
  )
  else
{705}    new r1_94: hash1;
{704}    let sk_u: hash0 = {703}h0({695}U, {696}S, {698}X, {700}Y_u, {702}K_u) in
{694}    event {693}termU({683}U, {685}X, {686}S, {688}Ystar_u, {690}r1_94, {692}sk_u);
{680}    out(c6[{679}!_57], {678}r1_94)
) | (
{669}  ! !_58 <= NS
{668}  in(c3[{667}!_58], (={666}U, X_s: G));
{665}  new y: exponent;
{664}  let Y: G = {663}exp({660}g, {662}y) in
{659}  let Ystar: G = {658}enc({656}Y, {657}pw) in
{654}  out(c4[{653}!_58], {652}({649}S, {651}Ystar));
{648}  in(c7[{647}!_58], auth_s: hash1);
{646}  find j <= NU suchthat defined(X[{645}j]) && {643}({640}X[{639}j] = {642}X_s) then
  (
{637}    let K_s: G = {636}exp({633}X_s, {635}y) in
{631}    find [unique] @i_111 <= qH1 suchthat defined(x11[{542}@i_111], x12[{544}@i_111], x13[{546}@i_111], x14[{548}@i_111], x15[{550}@i_111], x5_83[{552}@i_111], x4_84[{554}@i_111], x3_85[{556}@i_111], x2_86[{558}@i_111], x1_87[{560}@i_111], r1_82[{562}@i_111]) && {540}({513}({509}U = {512}x11[{511}@i_111]) && {539}({518}({514}S = {517}x12[{516}@i_111]) && {538}({524}({520}X_s = {523}x13[{522}@i_111]) && {537}({530}({526}Y = {529}x14[{528}@i_111]) && {536}({532}K_s = {535}x15[{534}@i_111]))))) then
    (
{508}      if {507}({503}auth_s = {506}r1_82[{505}@i_111]) then
{501}      let sk_s: hash0 = {500}h0({492}U, {493}S, {495}X_s, {497}Y, {499}K_s) in
{491}      event {490}termS({480}U, {482}X_s, {483}S, {485}Ystar, {487}auth_s, {489}sk_s)
    )
    orfind @i_108 <= NU suchthat defined(X[{618}@i_108], Y_u[{620}@i_108], K_u[{622}@i_108], Y_u[{624}@i_108], Y_u[{626}@i_108], Y_u[{628}@i_108], r1_94[{630}@i_108]) && {616}({602}({598}X_s = {601}X[{600}@i_108]) && {615}({608}({604}Y = {607}Y_u[{606}@i_108]) && {614}({610}K_s = {613}K_u[{612}@i_108]))) then
    (
{596}      if {595}({591}auth_s = {594}r1_94[{593}@i_108]) then
{589}      let sk_s: hash0 = {588}h0({580}U, {581}S, {583}X_s, {585}Y, {587}K_s) in
{579}      event {578}termS({568}U, {570}X_s, {571}S, {573}Ystar, {575}auth_s, {577}sk_s)
    )
  )
  else
{472}    let K_s: G = {471}exp({468}X_s, {470}y) in
{466}    find [unique] @i_111 <= qH1 suchthat defined(x11[{377}@i_111], x12[{379}@i_111], x13[{381}@i_111], x14[{383}@i_111], x15[{385}@i_111], x5_83[{387}@i_111], x4_84[{389}@i_111], x3_85[{391}@i_111], x2_86[{393}@i_111], x1_87[{395}@i_111], r1_82[{397}@i_111]) && {375}({348}({344}U = {347}x11[{346}@i_111]) && {374}({353}({349}S = {352}x12[{351}@i_111]) && {373}({359}({355}X_s = {358}x13[{357}@i_111]) && {372}({365}({361}Y = {364}x14[{363}@i_111]) && {371}({367}K_s = {370}x15[{369}@i_111]))))) then
    (
{343}      if {342}({338}auth_s = {341}r1_82[{340}@i_111]) then
{336}      let sk_s: hash0 = {335}h0({327}U, {328}S, {330}X_s, {332}Y, {334}K_s) in
{326}      event {325}termS({315}U, {317}X_s, {318}S, {320}Ystar, {322}auth_s, {324}sk_s)
    )
    orfind @i_108 <= NU suchthat defined(X[{453}@i_108], Y_u[{455}@i_108], K_u[{457}@i_108], Y_u[{459}@i_108], Y_u[{461}@i_108], Y_u[{463}@i_108], r1_94[{465}@i_108]) && {451}({437}({433}X_s = {436}X[{435}@i_108]) && {450}({443}({439}Y = {442}Y_u[{441}@i_108]) && {449}({445}K_s = {448}K_u[{447}@i_108]))) then
    (
{431}      if {430}({426}auth_s = {429}r1_94[{428}@i_108]) then
{424}      let sk_s: hash0 = {423}h0({415}U, {416}S, {418}X_s, {420}Y, {422}K_s) in
{414}      event {413}termS({403}U, {405}X_s, {406}S, {408}Ystar, {410}auth_s, {412}sk_s)
    )
) | (
{305}  ! !_59 <= NP
{304}  in(cp[{303}!_59], ());
{302}  new xp: exponent;
{301}  let Xp: G = {300}exp({297}g, {299}xp) in
{296}  new yp: exponent;
{295}  let Yp: G = {294}exp({291}g, {293}yp) in
{290}  let Kp: G = {289}exp({283}g, {288}mult({285}xp, {287}yp)) in
{282}  let Ystarp: G = {281}enc({279}Yp, {280}pw) in
{277}  let x1_93: host = {276}U in
{275}  let x2_92: host = {274}S in
{273}  new r1_88: hash1;
{272}  let sk_p: hash0 = {271}h0({263}U, {264}S, {266}Xp, {268}Yp, {270}Kp) in
{262}  out(cp[{261}!_59], {260}({252}U, {254}Xp, {255}S, {257}Ystarp, {259}r1_88))
) | (
{242}  ! !_60 <= qE
{241}  in(@2_c1[{240}!_60], (@2_x: G, @2_ke: passwd));
{239}  out(@2_c2[{238}!_60], {237}enc({234}@2_x, {236}@2_ke))
) | (
{231}  ! !_61 <= qD
{230}  in(@2_c3[{229}!_61], (@2_m: G, @2_kd: passwd));
{228}  out(@2_c4[{227}!_61], {226}dec({223}@2_m, {225}@2_kd))
) | (
{220}  ! !_62 <= qH0
{219}  in(c10[{218}!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
{217}  out(c20[{216}!_62], {215}h0({206}x1, {208}x2, {210}x3, {212}x4, {214}x5))
) | (
{203}  ! !_63 <= qH1
{202}  in(c11[{201}!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
{200}  let x1_87: host = {199}cst_host in
{198}  let x2_86: host = {197}cst_host in
{196}  let x3_85: G = {195}cst_G in
{194}  let x4_84: G = {193}cst_G in
{192}  let x5_83: G = {191}cst_G in
{190}  find [unique] @i_103 <= qH1 suchthat defined(x11[{53}@i_103], x12[{55}@i_103], x13[{57}@i_103], x14[{59}@i_103], x15[{61}@i_103], x5_83[{63}@i_103], x4_84[{65}@i_103], x3_85[{67}@i_103], x2_86[{69}@i_103], x1_87[{71}@i_103], r1_82[{73}@i_103]) && {51}({23}({19}x11 = {22}x11[{21}@i_103]) && {50}({29}({25}x12 = {28}x12[{27}@i_103]) && {49}({35}({31}x13 = {34}x13[{33}@i_103]) && {48}({41}({37}x14 = {40}x14[{39}@i_103]) && {47}({43}x15 = {46}x15[{45}@i_103]))))) then
{17}    out(c21[{16}!_63], {15}r1_82[{14}@i_103])
  orfind @i_102 <= NP suchthat defined(Xp[{115}@i_102], Yp[{117}@i_102], Kp[{119}@i_102], xp[{121}@i_102], xp[{123}@i_102], xp[{125}@i_102], x1_93[{127}@i_102], x2_92[{129}@i_102], r1_88[{131}@i_102]) && {113}({85}({81}x11 = {84}x1_93[{83}@i_102]) && {112}({91}({87}x12 = {90}x2_92[{89}@i_102]) && {111}({97}({93}x13 = {96}Xp[{95}@i_102]) && {110}({103}({99}x14 = {102}Yp[{101}@i_102]) && {109}({105}x15 = {108}Kp[{107}@i_102]))))) then
{79}    out(c21[{78}!_63], {77}r1_88[{76}@i_102])
  orfind @i_100 <= NU suchthat defined(X[{173}@i_100], Y_u[{175}@i_100], K_u[{177}@i_100], Y_u[{179}@i_100], Y_u[{181}@i_100], Y_u[{183}@i_100], x1_99[{185}@i_100], x2_98[{187}@i_100], r1_94[{189}@i_100]) && {171}({143}({139}x11 = {142}x1_99[{141}@i_100]) && {170}({149}({145}x12 = {148}x2_98[{147}@i_100]) && {169}({155}({151}x13 = {154}X[{153}@i_100]) && {168}({161}({157}x14 = {160}Y_u[{159}@i_100]) && {167}({163}x15 = {166}K_u[{165}@i_100]))))) then
{137}    out(c21[{136}!_63], {135}r1_94[{134}@i_100])
  else
{11}    new r1_82: hash1;
{10}    out(c21[{9}!_63], {8}r1_82)
)

Please enter a command: insert 472 find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && (U = x11[nj]) && (S = x12[nj]) && (X_s = x13[nj]) && (Y = x14[nj]) && (auth_s = r1_82[nj]) then
Doing insert instruction find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && (U = x11[nj]) && (S = x12[nj]) && (X_s = x13[nj]) && (Y = x14[nj]) && (auth_s = r1_82[nj]) then at occurrence 472... Done.
Please enter a command: show_game occ
{1044}in(start, ());
{1043}new pw: passwd;
{1042}out(c8, {1041}());
{1040}(
{1035}  ! !_57 <= NU
{1034}  in(c1[{1033}!_57], ());
{1032}  new x: exponent;
{1031}  let X: G = {1030}exp({1027}g, {1029}x) in
{1026}  out(c2[{1025}!_57], {1024}({1021}U, {1023}X));
{1020}  in(c5[{1019}!_57], (={1018}S, Ystar_u: G));
{1017}  let Y_u: G = {1016}dec({1014}Ystar_u, {1015}pw) in
{1012}  let K_u: G = {1011}exp({1008}Y_u, {1010}x) in
{1006}  let x1_99: host = {1005}U in
{1004}  let x2_98: host = {1003}S in
{1002}  find [unique] @i_115 <= qH1 suchthat defined(x11[{981}@i_115], x12[{983}@i_115], x13[{985}@i_115], x14[{987}@i_115], x15[{989}@i_115], x5_83[{991}@i_115], x4_84[{993}@i_115], x3_85[{995}@i_115], x2_86[{997}@i_115], x1_87[{999}@i_115], r1_82[{1001}@i_115]) && {979}({951}({947}x1_99 = {950}x11[{949}@i_115]) && {978}({957}({953}x2_98 = {956}x12[{955}@i_115]) && {977}({963}({959}X = {962}x13[{961}@i_115]) && {976}({969}({965}Y_u = {968}x14[{967}@i_115]) && {975}({971}K_u = {974}x15[{973}@i_115]))))) then
  (
{945}    let sk_u: hash0 = {944}h0({936}U, {937}S, {939}X, {941}Y_u, {943}K_u) in
{935}    event {934}termU({923}U, {925}X, {926}S, {928}Ystar_u, {931}r1_82[{930}@i_115], {933}sk_u);
{920}    out(c6[{919}!_57], {918}r1_82[{917}@i_115])
  )
  else
{913}    new r1_94: hash1;
{912}    let sk_u: hash0 = {911}h0({903}U, {904}S, {906}X, {908}Y_u, {910}K_u) in
{902}    event {901}termU({891}U, {893}X, {894}S, {896}Ystar_u, {898}r1_94, {900}sk_u);
{888}    out(c6[{887}!_57], {886}r1_94)
) | (
{877}  ! !_58 <= NS
{876}  in(c3[{875}!_58], (={874}U, X_s: G));
{873}  new y: exponent;
{872}  let Y: G = {871}exp({868}g, {870}y) in
{867}  let Ystar: G = {866}enc({864}Y, {865}pw) in
{862}  out(c4[{861}!_58], {860}({857}S, {859}Ystar));
{856}  in(c7[{855}!_58], auth_s: hash1);
{854}  find j <= NU suchthat defined(X[{853}j]) && {851}({848}X[{847}j] = {850}X_s) then
  (
{845}    let K_s: G = {844}exp({841}X_s, {843}y) in
{839}    find [unique] @i_111 <= qH1 suchthat defined(x11[{750}@i_111], x12[{752}@i_111], x13[{754}@i_111], x14[{756}@i_111], x15[{758}@i_111], x5_83[{760}@i_111], x4_84[{762}@i_111], x3_85[{764}@i_111], x2_86[{766}@i_111], x1_87[{768}@i_111], r1_82[{770}@i_111]) && {748}({721}({717}U = {720}x11[{719}@i_111]) && {747}({726}({722}S = {725}x12[{724}@i_111]) && {746}({732}({728}X_s = {731}x13[{730}@i_111]) && {745}({738}({734}Y = {737}x14[{736}@i_111]) && {744}({740}K_s = {743}x15[{742}@i_111]))))) then
    (
{716}      if {715}({711}auth_s = {714}r1_82[{713}@i_111]) then
{709}      let sk_s: hash0 = {708}h0({700}U, {701}S, {703}X_s, {705}Y, {707}K_s) in
{699}      event {698}termS({688}U, {690}X_s, {691}S, {693}Ystar, {695}auth_s, {697}sk_s)
    )
    orfind @i_108 <= NU suchthat defined(X[{826}@i_108], Y_u[{828}@i_108], K_u[{830}@i_108], Y_u[{832}@i_108], Y_u[{834}@i_108], Y_u[{836}@i_108], r1_94[{838}@i_108]) && {824}({810}({806}X_s = {809}X[{808}@i_108]) && {823}({816}({812}Y = {815}Y_u[{814}@i_108]) && {822}({818}K_s = {821}K_u[{820}@i_108]))) then
    (
{804}      if {803}({799}auth_s = {802}r1_94[{801}@i_108]) then
{797}      let sk_s: hash0 = {796}h0({788}U, {789}S, {791}X_s, {793}Y, {795}K_s) in
{787}      event {786}termS({776}U, {778}X_s, {779}S, {781}Ystar, {783}auth_s, {785}sk_s)
    )
  )
  else
{680}    find nj <= qH1 suchthat defined(x11[{671}nj], x12[{673}nj], x13[{675}nj], x14[{677}nj], r1_82[{679}nj]) && {669}({642}({638}U = {641}x11[{640}nj]) && {668}({647}({643}S = {646}x12[{645}nj]) && {667}({653}({649}X_s = {652}x13[{651}nj]) && {666}({659}({655}Y = {658}x14[{657}nj]) && {665}({661}auth_s = {664}r1_82[{663}nj]))))) then
    (
{637}      let K_s: G = {636}exp({633}X_s, {635}y) in
{631}      find [unique] @i_111 <= qH1 suchthat defined(x11[{542}@i_111], x12[{544}@i_111], x13[{546}@i_111], x14[{548}@i_111], x15[{550}@i_111], x5_83[{552}@i_111], x4_84[{554}@i_111], x3_85[{556}@i_111], x2_86[{558}@i_111], x1_87[{560}@i_111], r1_82[{562}@i_111]) && {540}({513}({509}U = {512}x11[{511}@i_111]) && {539}({518}({514}S = {517}x12[{516}@i_111]) && {538}({524}({520}X_s = {523}x13[{522}@i_111]) && {537}({530}({526}Y = {529}x14[{528}@i_111]) && {536}({532}K_s = {535}x15[{534}@i_111]))))) then
      (
{508}        if {507}({503}auth_s = {506}r1_82[{505}@i_111]) then
{501}        let sk_s: hash0 = {500}h0({492}U, {493}S, {495}X_s, {497}Y, {499}K_s) in
{491}        event {490}termS({480}U, {482}X_s, {483}S, {485}Ystar, {487}auth_s, {489}sk_s)
      )
      orfind @i_108 <= NU suchthat defined(X[{618}@i_108], Y_u[{620}@i_108], K_u[{622}@i_108], Y_u[{624}@i_108], Y_u[{626}@i_108], Y_u[{628}@i_108], r1_94[{630}@i_108]) && {616}({602}({598}X_s = {601}X[{600}@i_108]) && {615}({608}({604}Y = {607}Y_u[{606}@i_108]) && {614}({610}K_s = {613}K_u[{612}@i_108]))) then
      (
{596}        if {595}({591}auth_s = {594}r1_94[{593}@i_108]) then
{589}        let sk_s: hash0 = {588}h0({580}U, {581}S, {583}X_s, {585}Y, {587}K_s) in
{579}        event {578}termS({568}U, {570}X_s, {571}S, {573}Ystar, {575}auth_s, {577}sk_s)
      )
    )
    else
{472}      let K_s: G = {471}exp({468}X_s, {470}y) in
{466}      find [unique] @i_111 <= qH1 suchthat defined(x11[{377}@i_111], x12[{379}@i_111], x13[{381}@i_111], x14[{383}@i_111], x15[{385}@i_111], x5_83[{387}@i_111], x4_84[{389}@i_111], x3_85[{391}@i_111], x2_86[{393}@i_111], x1_87[{395}@i_111], r1_82[{397}@i_111]) && {375}({348}({344}U = {347}x11[{346}@i_111]) && {374}({353}({349}S = {352}x12[{351}@i_111]) && {373}({359}({355}X_s = {358}x13[{357}@i_111]) && {372}({365}({361}Y = {364}x14[{363}@i_111]) && {371}({367}K_s = {370}x15[{369}@i_111]))))) then
      (
{343}        if {342}({338}auth_s = {341}r1_82[{340}@i_111]) then
{336}        let sk_s: hash0 = {335}h0({327}U, {328}S, {330}X_s, {332}Y, {334}K_s) in
{326}        event {325}termS({315}U, {317}X_s, {318}S, {320}Ystar, {322}auth_s, {324}sk_s)
      )
      orfind @i_108 <= NU suchthat defined(X[{453}@i_108], Y_u[{455}@i_108], K_u[{457}@i_108], Y_u[{459}@i_108], Y_u[{461}@i_108], Y_u[{463}@i_108], r1_94[{465}@i_108]) && {451}({437}({433}X_s = {436}X[{435}@i_108]) && {450}({443}({439}Y = {442}Y_u[{441}@i_108]) && {449}({445}K_s = {448}K_u[{447}@i_108]))) then
      (
{431}        if {430}({426}auth_s = {429}r1_94[{428}@i_108]) then
{424}        let sk_s: hash0 = {423}h0({415}U, {416}S, {418}X_s, {420}Y, {422}K_s) in
{414}        event {413}termS({403}U, {405}X_s, {406}S, {408}Ystar, {410}auth_s, {412}sk_s)
      )
) | (
{305}  ! !_59 <= NP
{304}  in(cp[{303}!_59], ());
{302}  new xp: exponent;
{301}  let Xp: G = {300}exp({297}g, {299}xp) in
{296}  new yp: exponent;
{295}  let Yp: G = {294}exp({291}g, {293}yp) in
{290}  let Kp: G = {289}exp({283}g, {288}mult({285}xp, {287}yp)) in
{282}  let Ystarp: G = {281}enc({279}Yp, {280}pw) in
{277}  let x1_93: host = {276}U in
{275}  let x2_92: host = {274}S in
{273}  new r1_88: hash1;
{272}  let sk_p: hash0 = {271}h0({263}U, {264}S, {266}Xp, {268}Yp, {270}Kp) in
{262}  out(cp[{261}!_59], {260}({252}U, {254}Xp, {255}S, {257}Ystarp, {259}r1_88))
) | (
{242}  ! !_60 <= qE
{241}  in(@2_c1[{240}!_60], (@2_x: G, @2_ke: passwd));
{239}  out(@2_c2[{238}!_60], {237}enc({234}@2_x, {236}@2_ke))
) | (
{231}  ! !_61 <= qD
{230}  in(@2_c3[{229}!_61], (@2_m: G, @2_kd: passwd));
{228}  out(@2_c4[{227}!_61], {226}dec({223}@2_m, {225}@2_kd))
) | (
{220}  ! !_62 <= qH0
{219}  in(c10[{218}!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
{217}  out(c20[{216}!_62], {215}h0({206}x1, {208}x2, {210}x3, {212}x4, {214}x5))
) | (
{203}  ! !_63 <= qH1
{202}  in(c11[{201}!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
{200}  let x1_87: host = {199}cst_host in
{198}  let x2_86: host = {197}cst_host in
{196}  let x3_85: G = {195}cst_G in
{194}  let x4_84: G = {193}cst_G in
{192}  let x5_83: G = {191}cst_G in
{190}  find [unique] @i_103 <= qH1 suchthat defined(x11[{53}@i_103], x12[{55}@i_103], x13[{57}@i_103], x14[{59}@i_103], x15[{61}@i_103], x5_83[{63}@i_103], x4_84[{65}@i_103], x3_85[{67}@i_103], x2_86[{69}@i_103], x1_87[{71}@i_103], r1_82[{73}@i_103]) && {51}({23}({19}x11 = {22}x11[{21}@i_103]) && {50}({29}({25}x12 = {28}x12[{27}@i_103]) && {49}({35}({31}x13 = {34}x13[{33}@i_103]) && {48}({41}({37}x14 = {40}x14[{39}@i_103]) && {47}({43}x15 = {46}x15[{45}@i_103]))))) then
{17}    out(c21[{16}!_63], {15}r1_82[{14}@i_103])
  orfind @i_102 <= NP suchthat defined(Xp[{115}@i_102], Yp[{117}@i_102], Kp[{119}@i_102], xp[{121}@i_102], xp[{123}@i_102], xp[{125}@i_102], x1_93[{127}@i_102], x2_92[{129}@i_102], r1_88[{131}@i_102]) && {113}({85}({81}x11 = {84}x1_93[{83}@i_102]) && {112}({91}({87}x12 = {90}x2_92[{89}@i_102]) && {111}({97}({93}x13 = {96}Xp[{95}@i_102]) && {110}({103}({99}x14 = {102}Yp[{101}@i_102]) && {109}({105}x15 = {108}Kp[{107}@i_102]))))) then
{79}    out(c21[{78}!_63], {77}r1_88[{76}@i_102])
  orfind @i_100 <= NU suchthat defined(X[{173}@i_100], Y_u[{175}@i_100], K_u[{177}@i_100], Y_u[{179}@i_100], Y_u[{181}@i_100], Y_u[{183}@i_100], x1_99[{185}@i_100], x2_98[{187}@i_100], r1_94[{189}@i_100]) && {171}({143}({139}x11 = {142}x1_99[{141}@i_100]) && {170}({149}({145}x12 = {148}x2_98[{147}@i_100]) && {169}({155}({151}x13 = {154}X[{153}@i_100]) && {168}({161}({157}x14 = {160}Y_u[{159}@i_100]) && {167}({163}x15 = {166}K_u[{165}@i_100]))))) then
{137}    out(c21[{136}!_63], {135}r1_94[{134}@i_100])
  else
{11}    new r1_82: hash1;
{10}    out(c21[{9}!_63], {8}r1_82)
)

Please enter a command: insert_event Auth 637
Doing insert event Auth at occurrence 637... Done.
Please enter a command: simplify
Doing simplify... Run simplify 3 time(s). Fixpoint reached.
Done.
Please enter a command: crypto enc
Trying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_79: G, @2_ke_78: passwd) := let @2_x: G = @2_x_79 in let @2_ke: passwd = @2_ke_78 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_81: G, @2_kd_80: passwd) := let @2_m: G = @2_m_81 in let @2_kd: passwd = @2_kd_80 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
... Succeeded.
Doing simplify... Run simplify 2 time(s). Fixpoint reached.
Eliminated collisions between @2_r4_188[!_57] and x14[!2_1273] Probability: qH1 * NU / |G|
(@2_r4_188[!_57] characterizes a part of @2_r4_188[!_57] of type(s) G;
 x14[!2_1273] does not depend on @2_r4_188[!_57])
Eliminated collisions between exp(g, y[!_58]) and @2_r4_176[!2_1170] Probability: qD * NS / |exponent|
(exp(g, y[!_58]) characterizes a part of y[!_58] of type(s) exponent;
 @2_r4_176[!2_1170] does not depend on y[!_58])
Eliminated collisions between exp(g, y[!_58]) and @2_r4_188[!2_1169] Probability: NU * NS / |exponent|
(exp(g, y[!_58]) characterizes a part of y[!_58] of type(s) exponent;
 @2_r4_188[!2_1169] does not depend on y[!_58])
Eliminated collisions between exp(g, y[!_58]) and @2_x_181[!2_1168] Probability: qE * NS / |exponent|
(exp(g, y[!_58]) characterizes a part of y[!_58] of type(s) exponent;
 @2_x_181[!2_1168] does not depend on y[!_58])
Eliminated collisions between exp(g, y[!_58]) and @2_x_184[!2_1167] Probability: NP * NS / |exponent|
(exp(g, y[!_58]) characterizes a part of y[!_58] of type(s) exponent;
 @2_x_184[!2_1167] does not depend on y[!_58])
Eliminated collisions between exp(g, yp[!_59]) and @2_r4_176[!2_1164] Probability: qD * NP / |exponent|
(exp(g, yp[!_59]) characterizes a part of yp[!_59] of type(s) exponent;
 @2_r4_176[!2_1164] does not depend on yp[!_59])
Eliminated collisions between exp(g, yp[!_59]) and @2_r4_188[!2_1163] Probability: NU * NP / |exponent|
(exp(g, yp[!_59]) characterizes a part of yp[!_59] of type(s) exponent;
 @2_r4_188[!2_1163] does not depend on yp[!_59])
Eliminated collisions between exp(g, yp[!_59]) and @2_x_181[!2_1162] Probability: qE * NP / |exponent|
(exp(g, yp[!_59]) characterizes a part of yp[!_59] of type(s) exponent;
 @2_x_181[!2_1162] does not depend on yp[!_59])
Eliminated collisions between exp(g, yp[!_59]) and @2_x_187[!2_1160] Probability: NS * NP / |exponent|
(exp(g, yp[!_59]) characterizes a part of yp[!_59] of type(s) exponent;
 @2_x_187[!2_1160] does not depend on yp[!_59])
Eliminated collisions between y and y Probability: 0.5 * NS * NS / |exponent|
Done.
Doing move all binders... Done.
Doing remove assignments of useless... Done.
Please enter a command: show_game occ
{1593}in(start, ());
{1592}new pw: passwd;
{1591}out(c8, {1590}());
{1589}(
{1584}  ! !_57 <= NU
{1583}  in(c1[{1582}!_57], ());
{1581}  new x: exponent;
{1580}  let X: G = {1579}exp({1576}g, {1578}x) in
{1575}  out(c2[{1574}!_57], {1573}({1570}U, {1572}X));
{1569}  in(c5[{1568}!_57], (={1567}S, Ystar_u: G));
{1566}  let @2_m_190: G = {1565}cst_G in
{1564}  let @2_kd_189: passwd = {1563}cst_passwd in
{1562}  find [unique] @i_240 <= qD suchthat defined(@2_m[{959}@i_240], @2_kd[{961}@i_240], @2_kd_177[{963}@i_240], @2_m_178[{965}@i_240], @2_r4_176[{967}@i_240]) && {957}({951}({947}Ystar_u = {950}@2_m[{949}@i_240]) && {956}({952}pw = {955}@2_kd[{954}@i_240])) then
  (
{945}    let Y_u: G = {944}@2_r4_176[{943}@i_240] in
{941}    let K_u: G = {940}exp({937}@2_r4_176[{936}@i_240], {939}x) in
{934}    let x1_99: host = {933}U in
{932}    let x2_98: host = {931}S in
{930}    find [unique] @i_115 <= qH1 suchthat defined(x11[{919}@i_115], x12[{921}@i_115], x13[{923}@i_115], x14[{925}@i_115], x15[{927}@i_115], r1_82[{929}@i_115]) && {917}({888}({884}x1_99 = {887}x11[{886}@i_115]) && {916}({894}({890}x2_98 = {893}x12[{892}@i_115]) && {915}({900}({896}X = {899}x13[{898}@i_115]) && {914}({907}({903}@2_r4_176[{902}@i_240] = {906}x14[{905}@i_115]) && {913}({909}K_u = {912}x15[{911}@i_115]))))) then
    (
{882}      let sk_u: hash0 = {881}h0({872}U, {873}S, {875}X, {878}@2_r4_176[{877}@i_240], {880}K_u) in
{871}      event {870}termU({859}U, {861}X, {862}S, {864}Ystar_u, {867}r1_82[{866}@i_115], {869}sk_u);
{856}      out(c6[{855}!_57], {854}r1_82[{853}@i_115])
    )
    else
{849}      new r1_94: hash1;
{848}      let sk_u: hash0 = {847}h0({838}U, {839}S, {841}X, {844}@2_r4_176[{843}@i_240], {846}K_u) in
{837}      event {836}termU({826}U, {828}X, {829}S, {831}Ystar_u, {833}r1_94, {835}sk_u);
{823}      out(c6[{822}!_57], {821}r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[{1107}@i_236], @2_m_190[{1109}@i_236], @2_r4_188[{1111}@i_236]) && {1105}({1101}Ystar_u = {1104}Ystar_u[{1103}@i_236]) then
  (
{1099}    let Y_u: G = {1098}@2_r4_188[{1097}@i_236] in
{1095}    let K_u: G = {1094}exp({1091}@2_r4_188[{1090}@i_236], {1093}x) in
{1088}    let x1_99: host = {1087}U in
{1086}    let x2_98: host = {1085}S in
{1084}    find [unique] @i_115 <= qH1 suchthat defined(x11[{1073}@i_115], x12[{1075}@i_115], x13[{1077}@i_115], x14[{1079}@i_115], x15[{1081}@i_115], r1_82[{1083}@i_115]) && {1071}({1042}({1038}x1_99 = {1041}x11[{1040}@i_115]) && {1070}({1048}({1044}x2_98 = {1047}x12[{1046}@i_115]) && {1069}({1054}({1050}X = {1053}x13[{1052}@i_115]) && {1068}({1061}({1057}@2_r4_188[{1056}@i_236] = {1060}x14[{1059}@i_115]) && {1067}({1063}K_u = {1066}x15[{1065}@i_115]))))) then
    (
{1036}      let sk_u: hash0 = {1035}h0({1026}U, {1027}S, {1029}X, {1032}@2_r4_188[{1031}@i_236], {1034}K_u) in
{1025}      event {1024}termU({1013}U, {1015}X, {1016}S, {1018}Ystar_u, {1021}r1_82[{1020}@i_115], {1023}sk_u);
{1010}      out(c6[{1009}!_57], {1008}r1_82[{1007}@i_115])
    )
    else
{1003}      new r1_94: hash1;
{1002}      let sk_u: hash0 = {1001}h0({992}U, {993}S, {995}X, {998}@2_r4_188[{997}@i_236], {1000}K_u) in
{991}      event {990}termU({980}U, {982}X, {983}S, {985}Ystar_u, {987}r1_94, {989}sk_u);
{977}      out(c6[{976}!_57], {975}r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_ke[{1257}@i_234], @2_x[{1259}@i_234], @2_x_181[{1261}@i_234], @2_ke_180[{1263}@i_234], @2_r2_179[{1265}@i_234]) && {1255}({1249}({1245}Ystar_u = {1248}@2_r2_179[{1247}@i_234]) && {1254}({1250}pw = {1253}@2_ke[{1252}@i_234])) then
  (
{1243}    let Y_u: G = {1242}@2_x[{1241}@i_234] in
{1239}    let K_u: G = {1238}exp({1235}@2_x[{1234}@i_234], {1237}x) in
{1232}    let x1_99: host = {1231}U in
{1230}    let x2_98: host = {1229}S in
{1228}    find [unique] @i_115 <= qH1 suchthat defined(x11[{1217}@i_115], x12[{1219}@i_115], x13[{1221}@i_115], x14[{1223}@i_115], x15[{1225}@i_115], r1_82[{1227}@i_115]) && {1215}({1186}({1182}x1_99 = {1185}x11[{1184}@i_115]) && {1214}({1192}({1188}x2_98 = {1191}x12[{1190}@i_115]) && {1213}({1198}({1194}X = {1197}x13[{1196}@i_115]) && {1212}({1205}({1201}@2_x[{1200}@i_234] = {1204}x14[{1203}@i_115]) && {1211}({1207}K_u = {1210}x15[{1209}@i_115]))))) then
    (
{1180}      let sk_u: hash0 = {1179}h0({1170}U, {1171}S, {1173}X, {1176}@2_x[{1175}@i_234], {1178}K_u) in
{1169}      event {1168}termU({1157}U, {1159}X, {1160}S, {1162}Ystar_u, {1165}r1_82[{1164}@i_115], {1167}sk_u);
{1154}      out(c6[{1153}!_57], {1152}r1_82[{1151}@i_115])
    )
    else
{1147}      new r1_94: hash1;
{1146}      let sk_u: hash0 = {1145}h0({1136}U, {1137}S, {1139}X, {1142}@2_x[{1141}@i_234], {1144}K_u) in
{1135}      event {1134}termU({1124}U, {1126}X, {1127}S, {1129}Ystar_u, {1131}r1_94, {1133}sk_u);
{1121}      out(c6[{1120}!_57], {1119}r1_94)
  )
  orfind @i_233 <= NP suchthat defined(Yp[{1407}@i_233], xp[{1409}@i_233], @2_r2_182[{1411}@i_233], yp[{1413}@i_233]) && {1405}({1401}Ystar_u = {1404}@2_r2_182[{1403}@i_233]) then
  (
{1399}    let Y_u: G = {1398}Yp[{1397}@i_233] in
{1395}    let K_u: G = {1394}exp({1387}g, {1393}mult({1390}yp[{1389}@i_233], {1392}x)) in
{1386}    let x1_99: host = {1385}U in
{1384}    let x2_98: host = {1383}S in
{1382}    find [unique] @i_115 <= qH1 suchthat defined(x11[{1371}@i_115], x12[{1373}@i_115], x13[{1375}@i_115], x14[{1377}@i_115], x15[{1379}@i_115], r1_82[{1381}@i_115]) && {1369}({1340}({1336}x1_99 = {1339}x11[{1338}@i_115]) && {1368}({1346}({1342}x2_98 = {1345}x12[{1344}@i_115]) && {1367}({1352}({1348}X = {1351}x13[{1350}@i_115]) && {1366}({1359}({1355}Yp[{1354}@i_233] = {1358}x14[{1357}@i_115]) && {1365}({1361}K_u = {1364}x15[{1363}@i_115]))))) then
    (
{1334}      let sk_u: hash0 = {1333}h0({1324}U, {1325}S, {1327}X, {1330}Yp[{1329}@i_233], {1332}K_u) in
{1323}      event {1322}termU({1311}U, {1313}X, {1314}S, {1316}Ystar_u, {1319}r1_82[{1318}@i_115], {1321}sk_u);
{1308}      out(c6[{1307}!_57], {1306}r1_82[{1305}@i_115])
    )
    else
{1301}      new r1_94: hash1;
{1300}      let sk_u: hash0 = {1299}h0({1290}U, {1291}S, {1293}X, {1296}Yp[{1295}@i_233], {1298}K_u) in
{1289}      event {1288}termU({1278}U, {1280}X, {1281}S, {1283}Ystar_u, {1285}r1_94, {1287}sk_u);
{1275}      out(c6[{1274}!_57], {1273}r1_94)
  )
  orfind @i_232 <= NS suchthat defined(Y[{1555}@i_232], y[{1557}@i_232], @2_r2_185[{1559}@i_232], y[{1561}@i_232]) && {1553}({1549}Ystar_u = {1552}@2_r2_185[{1551}@i_232]) then
  (
{1547}    let Y_u: G = {1546}Y[{1545}@i_232] in
{1543}    let K_u: G = {1542}exp({1535}g, {1541}mult({1538}y[{1537}@i_232], {1540}x)) in
{1534}    let x1_99: host = {1533}U in
{1532}    let x2_98: host = {1531}S in
{1530}    find [unique] @i_115 <= qH1 suchthat defined(x11[{1519}@i_115], x12[{1521}@i_115], x13[{1523}@i_115], x14[{1525}@i_115], x15[{1527}@i_115], r1_82[{1529}@i_115]) && {1517}({1488}({1484}x1_99 = {1487}x11[{1486}@i_115]) && {1516}({1494}({1490}x2_98 = {1493}x12[{1492}@i_115]) && {1515}({1500}({1496}X = {1499}x13[{1498}@i_115]) && {1514}({1507}({1503}Y[{1502}@i_232] = {1506}x14[{1505}@i_115]) && {1513}({1509}K_u = {1512}x15[{1511}@i_115]))))) then
    (
{1482}      let sk_u: hash0 = {1481}h0({1472}U, {1473}S, {1475}X, {1478}Y[{1477}@i_232], {1480}K_u) in
{1471}      event {1470}termU({1459}U, {1461}X, {1462}S, {1464}Ystar_u, {1467}r1_82[{1466}@i_115], {1469}sk_u);
{1456}      out(c6[{1455}!_57], {1454}r1_82[{1453}@i_115])
    )
    else
{1449}      new r1_94: hash1;
{1448}      let sk_u: hash0 = {1447}h0({1438}U, {1439}S, {1441}X, {1444}Y[{1443}@i_232], {1446}K_u) in
{1437}      event {1436}termU({1426}U, {1428}X, {1429}S, {1431}Ystar_u, {1433}r1_94, {1435}sk_u);
{1423}      out(c6[{1422}!_57], {1421}r1_94)
  )
  else
{813}    new @2_r4_188: G;
{812}    let Y_u: G = {811}@2_r4_188 in
{809}    let K_u: G = {808}exp({805}@2_r4_188, {807}x) in
{803}    let x1_99: host = {802}U in
{801}    let x2_98: host = {800}S in
{799}    new r1_94: hash1;
{798}    let sk_u: hash0 = {797}h0({789}U, {790}S, {792}X, {794}@2_r4_188, {796}K_u) in
{788}    event {787}termU({777}U, {779}X, {780}S, {782}Ystar_u, {784}r1_94, {786}sk_u);
{774}    out(c6[{773}!_57], {772}r1_94)
) | (
{761}  ! !_58 <= NS
{760}  in(c3[{759}!_58], (={758}U, X_s: G));
{757}  new y: exponent;
{756}  let Y: G = {755}exp({752}g, {754}y) in
{751}  new @2_r2_185: G;
{750}  out(c4[{749}!_58], {748}({745}S, {747}@2_r2_185));
{744}  in(c7[{743}!_58], auth_s: hash1);
{742}  find j <= NU suchthat defined(X[{739}j], x[{741}j]) && {737}({734}X[{733}j] = {736}X_s) then
  (
{731}    let K_s: G = {730}exp({723}g, {729}mult({726}x[{725}j], {728}y)) in
{722}    find [unique] @i_111 <= qH1 suchthat defined(x11[{658}@i_111], x12[{660}@i_111], x13[{662}@i_111], x14[{664}@i_111], x15[{666}@i_111], r1_82[{668}@i_111]) && {656}({629}({625}U = {628}x11[{627}@i_111]) && {655}({634}({630}S = {633}x12[{632}@i_111]) && {654}({640}({636}X_s = {639}x13[{638}@i_111]) && {653}({646}({642}Y = {645}x14[{644}@i_111]) && {652}({648}K_s = {651}x15[{650}@i_111]))))) then
    (
{624}      if {623}({619}auth_s = {622}r1_82[{621}@i_111]) then
{617}      let sk_s: hash0 = {616}h0({608}U, {609}S, {611}X_s, {613}Y, {615}K_s) in
{607}      event {606}termS({596}U, {598}X_s, {599}S, {601}@2_r2_185, {603}auth_s, {605}sk_s)
    )
    orfind  suchthat defined(Y_u[{717}j], K_u[{719}j], r1_94[{721}j]) && {715}({708}({704}Y = {707}Y_u[{706}j]) && {714}({710}K_s = {713}K_u[{712}j])) then
    (
{702}      if {701}({697}auth_s = {700}r1_94[{699}j]) then
{695}      let sk_s: hash0 = {694}h0({686}U, {687}S, {689}X_s, {691}Y, {693}K_s) in
{685}      event {684}termS({674}U, {676}X_s, {677}S, {679}@2_r2_185, {681}auth_s, {683}sk_s)
    )
  )
  else
{588}    find nj <= qH1 suchthat defined(x11[{579}nj], x12[{581}nj], x13[{583}nj], x14[{585}nj], r1_82[{587}nj]) && {577}({550}({546}U = {549}x11[{548}nj]) && {576}({555}({551}S = {554}x12[{553}nj]) && {575}({561}({557}X_s = {560}x13[{559}nj]) && {574}({567}({563}Y = {566}x14[{565}nj]) && {573}({569}auth_s = {572}r1_82[{571}nj]))))) then
{545}    event {544}Auth
) | (
{539}  ! !_59 <= NP
{538}  in(cp[{537}!_59], ());
{536}  new xp: exponent;
{535}  let Xp: G = {534}exp({531}g, {533}xp) in
{530}  new yp: exponent;
{529}  let Yp: G = {528}exp({525}g, {527}yp) in
{524}  let Kp: G = {523}exp({517}g, {522}mult({519}xp, {521}yp)) in
{516}  new @2_r2_182: G;
{515}  let x1_93: host = {514}U in
{513}  let x2_92: host = {512}S in
{511}  new r1_88: hash1;
{510}  let sk_p: hash0 = {509}h0({501}U, {502}S, {504}Xp, {506}Yp, {508}Kp) in
{500}  out(cp[{499}!_59], {498}({490}U, {492}Xp, {493}S, {495}@2_r2_182, {497}r1_88))
) | (
{481}  ! !_60 <= qE
{480}  in(@2_c1[{479}!_60], (@2_x: G, @2_ke: passwd));
{478}  let @2_x_181: G = {477}cst_G in
{476}  let @2_ke_180: passwd = {475}cst_passwd in
{474}  find [unique] @i_210 <= qD suchthat defined(@2_kd[{361}@i_210], @2_m[{363}@i_210], @2_m_178[{365}@i_210], @2_kd_177[{367}@i_210], @2_r4_176[{369}@i_210]) && {359}({352}({348}@2_x = {351}@2_r4_176[{350}@i_210]) && {358}({354}@2_ke = {357}@2_kd[{356}@i_210])) then
{346}    out(@2_c2[{345}!_60], {344}@2_m[{343}@i_210])
  orfind @i_206 <= NU suchthat defined(pw, Ystar_u[{388}@i_206], @2_m_190[{390}@i_206], @2_kd_189[{392}@i_206], @2_r4_188[{394}@i_206]) && {386}({381}({377}@2_x = {380}@2_r4_188[{379}@i_206]) && {385}({383}@2_ke = {384}pw)) then
{375}    out(@2_c2[{374}!_60], {373}Ystar_u[{372}@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[{415}@i_204], @2_ke[{417}@i_204], @2_ke_180[{419}@i_204], @2_x_181[{421}@i_204], @2_r2_179[{423}@i_204]) && {413}({406}({402}@2_x = {405}@2_x[{404}@i_204]) && {412}({408}@2_ke = {411}@2_ke[{410}@i_204])) then
{400}    out(@2_c2[{399}!_60], {398}@2_r2_179[{397}@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[{442}@i_203], pw, xp[{444}@i_203], xp[{446}@i_203], @2_r2_182[{448}@i_203]) && {440}({435}({431}@2_x = {434}Yp[{433}@i_203]) && {439}({437}@2_ke = {438}pw)) then
{429}    out(@2_c2[{428}!_60], {427}@2_r2_182[{426}@i_203])
  orfind @i_202 <= NS suchthat defined(Y[{467}@i_202], pw, y[{469}@i_202], y[{471}@i_202], @2_r2_185[{473}@i_202]) && {465}({460}({456}@2_x = {459}Y[{458}@i_202]) && {464}({462}@2_ke = {463}pw)) then
{454}    out(@2_c2[{453}!_60], {452}@2_r2_185[{451}@i_202])
  else
{340}    new @2_r2_179: G;
{339}    out(@2_c2[{338}!_60], {337}@2_r2_179)
) | (
{332}  ! !_61 <= qD
{331}  in(@2_c3[{330}!_61], (@2_m: G, @2_kd: passwd));
{329}  let @2_m_178: G = {328}cst_G in
{327}  let @2_kd_177: passwd = {326}cst_passwd in
{325}  find [unique] @i_200 <= qD suchthat defined(@2_m[{212}@i_200], @2_kd[{214}@i_200], @2_kd_177[{216}@i_200], @2_m_178[{218}@i_200], @2_r4_176[{220}@i_200]) && {210}({203}({199}@2_m = {202}@2_m[{201}@i_200]) && {209}({205}@2_kd = {208}@2_kd[{207}@i_200])) then
{197}    out(@2_c4[{196}!_61], {195}@2_r4_176[{194}@i_200])
  orfind @i_196 <= NU suchthat defined(Ystar_u[{239}@i_196], pw, @2_kd_189[{241}@i_196], @2_m_190[{243}@i_196], @2_r4_188[{245}@i_196]) && {237}({232}({228}@2_m = {231}Ystar_u[{230}@i_196]) && {236}({234}@2_kd = {235}pw)) then
{226}    out(@2_c4[{225}!_61], {224}@2_r4_188[{223}@i_196])
  orfind @i_194 <= qE suchthat defined(@2_ke[{266}@i_194], @2_x[{268}@i_194], @2_x_181[{270}@i_194], @2_ke_180[{272}@i_194], @2_r2_179[{274}@i_194]) && {264}({257}({253}@2_m = {256}@2_r2_179[{255}@i_194]) && {263}({259}@2_kd = {262}@2_ke[{261}@i_194])) then
{251}    out(@2_c4[{250}!_61], {249}@2_x[{248}@i_194])
  orfind @i_193 <= NP suchthat defined(pw, Yp[{293}@i_193], xp[{295}@i_193], xp[{297}@i_193], @2_r2_182[{299}@i_193]) && {291}({286}({282}@2_m = {285}@2_r2_182[{284}@i_193]) && {290}({288}@2_kd = {289}pw)) then
{280}    out(@2_c4[{279}!_61], {278}Yp[{277}@i_193])
  orfind @i_192 <= NS suchthat defined(pw, Y[{318}@i_192], y[{320}@i_192], y[{322}@i_192], @2_r2_185[{324}@i_192]) && {316}({311}({307}@2_m = {310}@2_r2_185[{309}@i_192]) && {315}({313}@2_kd = {314}pw)) then
{305}    out(@2_c4[{304}!_61], {303}Y[{302}@i_192])
  else
{191}    new @2_r4_176: G;
{190}    out(@2_c4[{189}!_61], {188}@2_r4_176)
) | (
{183}  ! !_62 <= qH0
{182}  in(c10[{181}!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
{180}  out(c20[{179}!_62], {178}h0({169}x1, {171}x2, {173}x3, {175}x4, {177}x5))
) | (
{166}  ! !_63 <= qH1
{165}  in(c11[{164}!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
{163}  find [unique] @i_103 <= qH1 suchthat defined(x11[{48}@i_103], x12[{50}@i_103], x13[{52}@i_103], x14[{54}@i_103], x15[{56}@i_103], r1_82[{58}@i_103]) && {46}({18}({14}x11 = {17}x11[{16}@i_103]) && {45}({24}({20}x12 = {23}x12[{22}@i_103]) && {44}({30}({26}x13 = {29}x13[{28}@i_103]) && {43}({36}({32}x14 = {35}x14[{34}@i_103]) && {42}({38}x15 = {41}x15[{40}@i_103]))))) then
{12}    out(c21[{11}!_63], {10}r1_82[{9}@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[{100}@i_102], x2_92[{102}@i_102], Xp[{104}@i_102], Yp[{106}@i_102], Kp[{108}@i_102], r1_88[{110}@i_102]) && {98}({70}({66}x11 = {69}x1_93[{68}@i_102]) && {97}({76}({72}x12 = {75}x2_92[{74}@i_102]) && {96}({82}({78}x13 = {81}Xp[{80}@i_102]) && {95}({88}({84}x14 = {87}Yp[{86}@i_102]) && {94}({90}x15 = {93}Kp[{92}@i_102]))))) then
{64}    out(c21[{63}!_63], {62}r1_88[{61}@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[{152}@i_100], x2_98[{154}@i_100], X[{156}@i_100], Y_u[{158}@i_100], K_u[{160}@i_100], r1_94[{162}@i_100]) && {150}({122}({118}x11 = {121}x1_99[{120}@i_100]) && {149}({128}({124}x12 = {127}x2_98[{126}@i_100]) && {148}({134}({130}x13 = {133}X[{132}@i_100]) && {147}({140}({136}x14 = {139}Y_u[{138}@i_100]) && {146}({142}x15 = {145}K_u[{144}@i_100]))))) then
{116}    out(c21[{115}!_63], {114}r1_94[{113}@i_100])
  else
{6}    new r1_82: hash1;
{5}    out(c21[{4}!_63], {3}r1_82)
)

Please enter a command: insert_event Encryptt 1243
Doing insert event Encryptt at occurrence 1243... Done.
Please enter a command: auto
Trying equivalence
equiv ! !_43 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all], ! !_44 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash1) -> (r' = h1(x1', x2', x3', x4', x5')) [all]
<=(set(proba <= Neq / |hash1|))=>
      ! !_45 <= N (x1_72: host, x2_71: host, x3_70: G, x4_69: G, x5_68: G) -> let x1: host = x1_72 in let x2: host = x2_71 in let x3: G = x3_70 in let x4: G = x4_69 in let x5: G = x5_68 in find [unique] j_47 <= N suchthat defined(x1[j_47], x2[j_47], x3[j_47], x4[j_47], x5[j_47], r1[j_47]) && ((x1 = x1[j_47]) && ((x2 = x2[j_47]) && ((x3 = x3[j_47]) && ((x4 = x4[j_47]) && (x5 = x5[j_47]))))) then r1[j_47] else new r1: hash1; r1, ! !_46 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash1) -> find [unique] j_48 <= N suchthat defined(x1[j_48], x2[j_48], x3[j_48], x4[j_48], x5[j_48], r1[j_48]) && ((x1' = x1[j_48]) && ((x2' = x2[j_48]) && ((x3' = x3[j_48]) && ((x4' = x4[j_48]) && (x5' = x5[j_48]))))) then (r' = r1[j_48]) else false
... Failed.
Trying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all], ! !_38 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash0) -> (r' = h0(x1', x2', x3', x4', x5')) [all]
<=(set(proba <= Neq / |hash0|))=>
      ! !_39 <= N (x1_77: host, x2_76: host, x3_75: G, x4_74: G, x5_73: G) -> let x1: host = x1_77 in let x2: host = x2_76 in let x3: G = x3_75 in let x4: G = x4_74 in let x5: G = x5_73 in find [unique] j_41 <= N suchthat defined(x1[j_41], x2[j_41], x3[j_41], x4[j_41], x5[j_41], r[j_41]) && ((x1 = x1[j_41]) && ((x2 = x2[j_41]) && ((x3 = x3[j_41]) && ((x4 = x4[j_41]) && (x5 = x5[j_41]))))) then r[j_41] else new r: hash0; r, ! !_40 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash0) -> find [unique] j_42 <= N suchthat defined(x1[j_42], x2[j_42], x3[j_42], x4[j_42], x5[j_42], r[j_42]) && ((x1' = x1[j_42]) && ((x2' = x2[j_42]) && ((x3' = x3[j_42]) && ((x4' = x4[j_42]) && (x5' = x5[j_42]))))) then (r' = r[j_42]) else false
... Succeeded.
Doing simplify... Run simplify 3 time(s). Fixpoint reached.
Eliminated collisions between exp(g, yp[!2_4954]) and @2_r4_188[!2_4955] Probability: NU * NP / |exponent|
(exp(g, yp[!2_4954]) characterizes a part of yp[!2_4954] of type(s) exponent;
 @2_r4_188[!2_4955] does not depend on yp[!2_4954])
Eliminated collisions between exp(g, yp[!2_4795]) and @2_r4_176[!2_4796] Probability: qD * NP / |exponent|
(exp(g, yp[!2_4795]) characterizes a part of yp[!2_4795] of type(s) exponent;
 @2_r4_176[!2_4796] does not depend on yp[!2_4795])
Eliminated collisions between @2_r4_176[!2_4583] and exp(g, yp[!2_4584]) Probability: NP * qD / |G|
(@2_r4_176[!2_4583] characterizes a part of @2_r4_176[!2_4583] of type(s) G;
 exp(g, yp[!2_4584]) does not depend on @2_r4_176[!2_4583])
Eliminated collisions between @2_r4_188[!2_4535] and exp(g, yp[!2_4536]) Probability: NP * NU / |G|
(@2_r4_188[!2_4535] characterizes a part of @2_r4_188[!2_4535] of type(s) G;
 exp(g, yp[!2_4536]) does not depend on @2_r4_188[!2_4535])
Eliminated collisions between r1_94[!_57] and auth_s[!2_4012] Probability: NS * NU / |hash1|
(r1_94[!_57] characterizes a part of r1_94[!_57] of type(s) hash1;
 auth_s[!2_4012] does not depend on r1_94[!_57])
Eliminated collisions between @2_r4_176[!2_3990] and exp(g, y[!2_3991]) Probability: NS * qD / |G|
(@2_r4_176[!2_3990] characterizes a part of @2_r4_176[!2_3990] of type(s) G;
 exp(g, y[!2_3991]) does not depend on @2_r4_176[!2_3990])
Eliminated collisions between @2_r4_188[!2_3942] and exp(g, y[!2_3943]) Probability: NS * NU / |G|
(@2_r4_188[!2_3942] characterizes a part of @2_r4_188[!2_3942] of type(s) G;
 exp(g, y[!2_3943]) does not depend on @2_r4_188[!2_3942])
Eliminated collisions between @2_r4_188[!_57] and x4_340[!2_3835] Probability: qH0 * NU / |G|
(@2_r4_188[!_57] characterizes a part of @2_r4_188[!_57] of type(s) G;
 x4_340[!2_3835] does not depend on @2_r4_188[!_57])
Eliminated collisions between @2_r4_188[!_57] and x4_346[!2_3834] Probability: NP * NU / |G|
(@2_r4_188[!_57] characterizes a part of @2_r4_188[!_57] of type(s) G;
 x4_346[!2_3834] does not depend on @2_r4_188[!_57])
Eliminated collisions between @2_r4_188[!_57] and x4_352[!2_3833] Probability: NS * NU / |G|
(@2_r4_188[!_57] characterizes a part of @2_r4_188[!_57] of type(s) G;
 x4_352[!2_3833] does not depend on @2_r4_188[!_57])
Eliminated collisions between @2_r4_188[!_57] and x4_358[!2_3832] Probability: NS * NU / |G|
(@2_r4_188[!_57] characterizes a part of @2_r4_188[!_57] of type(s) G;
 x4_358[!2_3832] does not depend on @2_r4_188[!_57])
Eliminated collisions between @2_r4_188[!_57] and x4_370[!2_3830] Probability: NU * NU / |G|
(@2_r4_188[!_57] characterizes a part of @2_r4_188[!_57] of type(s) G;
 x4_370[!2_3830] does not depend on @2_r4_188[!_57])
Eliminated collisions between @2_r4_188[!_57] and x4_376[!2_3829] Probability: NU * NU / |G|
(@2_r4_188[!_57] characterizes a part of @2_r4_188[!_57] of type(s) G;
 x4_376[!2_3829] does not depend on @2_r4_188[!_57])
Eliminated collisions between @2_r4_188[!_57] and x4_382[!2_3828] Probability: NU * NU / |G|
(@2_r4_188[!_57] characterizes a part of @2_r4_188[!_57] of type(s) G;
 x4_382[!2_3828] does not depend on @2_r4_188[!_57])
Eliminated collisions between @2_r4_188[!_57] and x4_388[!2_3827] Probability: NU * NU / |G|
(@2_r4_188[!_57] characterizes a part of @2_r4_188[!_57] of type(s) G;
 x4_388[!2_3827] does not depend on @2_r4_188[!_57])
Eliminated collisions between @2_r4_188[!_57] and x4_394[!2_3826] Probability: NU * NU / |G|
(@2_r4_188[!_57] characterizes a part of @2_r4_188[!_57] of type(s) G;
 x4_394[!2_3826] does not depend on @2_r4_188[!_57])
Eliminated collisions between @2_r4_188[!_57] and x4_400[!2_3825] Probability: NU * NU / |G|
(@2_r4_188[!_57] characterizes a part of @2_r4_188[!_57] of type(s) G;
 x4_400[!2_3825] does not depend on @2_r4_188[!_57])
Eliminated collisions between @2_r4_188[!_57] and x4_406[!2_3824] Probability: NU * NU / |G|
(@2_r4_188[!_57] characterizes a part of @2_r4_188[!_57] of type(s) G;
 x4_406[!2_3824] does not depend on @2_r4_188[!_57])
Eliminated collisions between @2_r4_188[!_57] and x4_412[!2_3823] Probability: NU * NU / |G|
(@2_r4_188[!_57] characterizes a part of @2_r4_188[!_57] of type(s) G;
 x4_412[!2_3823] does not depend on @2_r4_188[!_57])
Eliminated collisions between exp(g, y[!_58]) and @2_r4_176[!2_3388] Probability: qD * NS / |exponent|
(exp(g, y[!_58]) characterizes a part of y[!_58] of type(s) exponent;
 @2_r4_176[!2_3388] does not depend on y[!_58])
Eliminated collisions between exp(g, y[!_58]) and @2_r4_188[!2_3343] Probability: NU * NS / |exponent|
(exp(g, y[!_58]) characterizes a part of y[!_58] of type(s) exponent;
 @2_r4_188[!2_3343] does not depend on y[!_58])
Eliminated collisions between exp(g, yp[!_59]) and x4_340[!2_3094] Probability: qH0 * NP / |exponent|
(exp(g, yp[!_59]) characterizes a part of yp[!_59] of type(s) exponent;
 x4_340[!2_3094] does not depend on yp[!_59])
Eliminated collisions between exp(g, yp[!_59]) and x4_352[!2_3092] Probability: NS * NP / |exponent|
(exp(g, yp[!_59]) characterizes a part of yp[!_59] of type(s) exponent;
 x4_352[!2_3092] does not depend on yp[!_59])
Eliminated collisions between exp(g, yp[!_59]) and x4_358[!2_3091] Probability: NS * NP / |exponent|
(exp(g, yp[!_59]) characterizes a part of yp[!_59] of type(s) exponent;
 x4_358[!2_3091] does not depend on yp[!_59])
Eliminated collisions between exp(g, yp[!_59]) and x4_364[!2_3090] Probability: NU * NP / |exponent|
(exp(g, yp[!_59]) characterizes a part of yp[!_59] of type(s) exponent;
 x4_364[!2_3090] does not depend on yp[!_59])
Eliminated collisions between exp(g, yp[!_59]) and x4_370[!2_3089] Probability: NU * NP / |exponent|
(exp(g, yp[!_59]) characterizes a part of yp[!_59] of type(s) exponent;
 x4_370[!2_3089] does not depend on yp[!_59])
Eliminated collisions between exp(g, yp[!_59]) and x4_376[!2_3088] Probability: NU * NP / |exponent|
(exp(g, yp[!_59]) characterizes a part of yp[!_59] of type(s) exponent;
 x4_376[!2_3088] does not depend on yp[!_59])
Eliminated collisions between exp(g, yp[!_59]) and x4_382[!2_3087] Probability: NU * NP / |exponent|
(exp(g, yp[!_59]) characterizes a part of yp[!_59] of type(s) exponent;
 x4_382[!2_3087] does not depend on yp[!_59])
Eliminated collisions between exp(g, yp[!_59]) and x4_388[!2_3086] Probability: NU * NP / |exponent|
(exp(g, yp[!_59]) characterizes a part of yp[!_59] of type(s) exponent;
 x4_388[!2_3086] does not depend on yp[!_59])
Eliminated collisions between exp(g, yp[!_59]) and x4_394[!2_3085] Probability: NU * NP / |exponent|
(exp(g, yp[!_59]) characterizes a part of yp[!_59] of type(s) exponent;
 x4_394[!2_3085] does not depend on yp[!_59])
Eliminated collisions between exp(g, yp[!_59]) and x4_400[!2_3084] Probability: NU * NP / |exponent|
(exp(g, yp[!_59]) characterizes a part of yp[!_59] of type(s) exponent;
 x4_400[!2_3084] does not depend on yp[!_59])
Eliminated collisions between exp(g, yp[!_59]) and x4_406[!2_3083] Probability: NU * NP / |exponent|
(exp(g, yp[!_59]) characterizes a part of yp[!_59] of type(s) exponent;
 x4_406[!2_3083] does not depend on yp[!_59])
Eliminated collisions between exp(g, yp[!_59]) and x4_412[!2_3082] Probability: NU * NP / |exponent|
(exp(g, yp[!_59]) characterizes a part of yp[!_59] of type(s) exponent;
 x4_412[!2_3082] does not depend on yp[!_59])
Eliminated collisions between @2_r4_176 and @2_r4_176 Probability: 0.5 * qD * qD / |G|
Eliminated collisions between @2_r4_176 and @2_r4_188 Probability: qD * NU / |G|
Eliminated collisions between @2_r2_185 and @2_r2_182 Probability: NS * NP / |G|
Eliminated collisions between @2_r4_188 and @2_r4_188 Probability: 0.5 * NU * NU / |G|
Eliminated collisions between r1_94 and r1_82 Probability: NU * qH1 / |hash1|
Reduced (mult(y[@i_232[j[!_58]]], x[j[!_58]]) = mult(x[j[!_58]], y[!_58])) to (((y[@i_232[j[!_58]]] = x[j[!_58]]) && (x[j[!_58]] = y[!_58])) || (((y[@i_232[j[!_58]]] = y[!_58]) && (x[j[!_58]] = x[j[!_58]])) || (((y[@i_232[j[!_58]]] = x[j[!_58]]) || (x[j[!_58]] = y[!_58])) && (@1_mult'(y[@i_232[j[!_58]]], x[j[!_58]]) = @1_mult'(x[j[!_58]], y[!_58]))))) Probability: 1. / |exponent| * NS
Reduced (mult(yp[@i_233[!_57]], x[!_57]) = mult(xp[@i_557[!_57]], yp[@i_557[!_57]])) to (((yp[@i_233[!_57]] = xp[@i_557[!_57]]) && (x[!_57] = yp[@i_557[!_57]])) || (((yp[@i_233[!_57]] = yp[@i_557[!_57]]) && (x[!_57] = xp[@i_557[!_57]])) || (((yp[@i_233[!_57]] = x[!_57]) || (xp[@i_557[!_57]] = yp[@i_557[!_57]])) && (@1_mult'(yp[@i_233[!_57]], x[!_57]) = @1_mult'(xp[@i_557[!_57]], yp[@i_557[!_57]]))))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_233[!_57]], x[!_57]) = mult(x[j[@i_556[!_57]]], y[@i_556[!_57]])) to (((yp[@i_233[!_57]] = x[j[@i_556[!_57]]]) && (x[!_57] = y[@i_556[!_57]])) || (((yp[@i_233[!_57]] = y[@i_556[!_57]]) && (x[!_57] = x[j[@i_556[!_57]]])) || (((yp[@i_233[!_57]] = x[!_57]) || (x[j[@i_556[!_57]]] = y[@i_556[!_57]])) && (@1_mult'(yp[@i_233[!_57]], x[!_57]) = @1_mult'(x[j[@i_556[!_57]]], y[@i_556[!_57]]))))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_233[!_57]], x[!_57]) = mult(x[j[@i_555[!_57]]], y[@i_555[!_57]])) to (((yp[@i_233[!_57]] = x[j[@i_555[!_57]]]) && (x[!_57] = y[@i_555[!_57]])) || (((yp[@i_233[!_57]] = y[@i_555[!_57]]) && (x[!_57] = x[j[@i_555[!_57]]])) || (((yp[@i_233[!_57]] = x[!_57]) || (x[j[@i_555[!_57]]] = y[@i_555[!_57]])) && (@1_mult'(yp[@i_233[!_57]], x[!_57]) = @1_mult'(x[j[@i_555[!_57]]], y[@i_555[!_57]]))))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_233[!_57]], x[!_57]) = mult(yp[@i_233[@i_549[!_57]]], x[@i_549[!_57]])) to (((yp[@i_233[!_57]] = yp[@i_233[@i_549[!_57]]]) && (x[!_57] = x[@i_549[!_57]])) || (((yp[@i_233[!_57]] = x[@i_549[!_57]]) && (x[!_57] = yp[@i_233[@i_549[!_57]]])) || (((yp[@i_233[!_57]] = x[!_57]) || (yp[@i_233[@i_549[!_57]]] = x[@i_549[!_57]])) && (@1_mult'(yp[@i_233[!_57]], x[!_57]) = @1_mult'(yp[@i_233[@i_549[!_57]]], x[@i_549[!_57]]))))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_233[!_57]], x[!_57]) = mult(yp[@i_233[@i_548[!_57]]], x[@i_548[!_57]])) to (((yp[@i_233[!_57]] = yp[@i_233[@i_548[!_57]]]) && (x[!_57] = x[@i_548[!_57]])) || (((yp[@i_233[!_57]] = x[@i_548[!_57]]) && (x[!_57] = yp[@i_233[@i_548[!_57]]])) || (((yp[@i_233[!_57]] = x[!_57]) || (yp[@i_233[@i_548[!_57]]] = x[@i_548[!_57]])) && (@1_mult'(yp[@i_233[!_57]], x[!_57]) = @1_mult'(yp[@i_233[@i_548[!_57]]], x[@i_548[!_57]]))))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_233[!_57]], x[!_57]) = mult(y[@i_232[@i_547[!_57]]], x[@i_547[!_57]])) to (((yp[@i_233[!_57]] = y[@i_232[@i_547[!_57]]]) && (x[!_57] = x[@i_547[!_57]])) || (((yp[@i_233[!_57]] = x[@i_547[!_57]]) && (x[!_57] = y[@i_232[@i_547[!_57]]])) || (((yp[@i_233[!_57]] = x[!_57]) || (y[@i_232[@i_547[!_57]]] = x[@i_547[!_57]])) && (@1_mult'(yp[@i_233[!_57]], x[!_57]) = @1_mult'(y[@i_232[@i_547[!_57]]], x[@i_547[!_57]]))))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_233[!_57]], x[!_57]) = mult(y[@i_232[@i_546[!_57]]], x[@i_546[!_57]])) to (((yp[@i_233[!_57]] = y[@i_232[@i_546[!_57]]]) && (x[!_57] = x[@i_546[!_57]])) || (((yp[@i_233[!_57]] = x[@i_546[!_57]]) && (x[!_57] = y[@i_232[@i_546[!_57]]])) || (((yp[@i_233[!_57]] = x[!_57]) || (y[@i_232[@i_546[!_57]]] = x[@i_546[!_57]])) && (@1_mult'(yp[@i_233[!_57]], x[!_57]) = @1_mult'(y[@i_232[@i_546[!_57]]], x[@i_546[!_57]]))))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_233[!_57]], x[!_57]) = mult(xp[@i_544[!_57]], yp[@i_544[!_57]])) to (((yp[@i_233[!_57]] = xp[@i_544[!_57]]) && (x[!_57] = yp[@i_544[!_57]])) || (((yp[@i_233[!_57]] = yp[@i_544[!_57]]) && (x[!_57] = xp[@i_544[!_57]])) || (((yp[@i_233[!_57]] = x[!_57]) || (xp[@i_544[!_57]] = yp[@i_544[!_57]])) && (@1_mult'(yp[@i_233[!_57]], x[!_57]) = @1_mult'(xp[@i_544[!_57]], yp[@i_544[!_57]]))))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_233[!_57]], x[!_57]) = mult(x[j[@i_543[!_57]]], y[@i_543[!_57]])) to (((yp[@i_233[!_57]] = x[j[@i_543[!_57]]]) && (x[!_57] = y[@i_543[!_57]])) || (((yp[@i_233[!_57]] = y[@i_543[!_57]]) && (x[!_57] = x[j[@i_543[!_57]]])) || (((yp[@i_233[!_57]] = x[!_57]) || (x[j[@i_543[!_57]]] = y[@i_543[!_57]])) && (@1_mult'(yp[@i_233[!_57]], x[!_57]) = @1_mult'(x[j[@i_543[!_57]]], y[@i_543[!_57]]))))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_233[!_57]], x[!_57]) = mult(x[j[@i_542[!_57]]], y[@i_542[!_57]])) to (((yp[@i_233[!_57]] = x[j[@i_542[!_57]]]) && (x[!_57] = y[@i_542[!_57]])) || (((yp[@i_233[!_57]] = y[@i_542[!_57]]) && (x[!_57] = x[j[@i_542[!_57]]])) || (((yp[@i_233[!_57]] = x[!_57]) || (x[j[@i_542[!_57]]] = y[@i_542[!_57]])) && (@1_mult'(yp[@i_233[!_57]], x[!_57]) = @1_mult'(x[j[@i_542[!_57]]], y[@i_542[!_57]]))))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_233[!_57]], x[!_57]) = mult(yp[@i_233[@i_536[!_57]]], x[@i_536[!_57]])) to (((yp[@i_233[!_57]] = yp[@i_233[@i_536[!_57]]]) && (x[!_57] = x[@i_536[!_57]])) || (((yp[@i_233[!_57]] = x[@i_536[!_57]]) && (x[!_57] = yp[@i_233[@i_536[!_57]]])) || (((yp[@i_233[!_57]] = x[!_57]) || (yp[@i_233[@i_536[!_57]]] = x[@i_536[!_57]])) && (@1_mult'(yp[@i_233[!_57]], x[!_57]) = @1_mult'(yp[@i_233[@i_536[!_57]]], x[@i_536[!_57]]))))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_233[!_57]], x[!_57]) = mult(yp[@i_233[@i_535[!_57]]], x[@i_535[!_57]])) to (((yp[@i_233[!_57]] = yp[@i_233[@i_535[!_57]]]) && (x[!_57] = x[@i_535[!_57]])) || (((yp[@i_233[!_57]] = x[@i_535[!_57]]) && (x[!_57] = yp[@i_233[@i_535[!_57]]])) || (((yp[@i_233[!_57]] = x[!_57]) || (yp[@i_233[@i_535[!_57]]] = x[@i_535[!_57]])) && (@1_mult'(yp[@i_233[!_57]], x[!_57]) = @1_mult'(yp[@i_233[@i_535[!_57]]], x[@i_535[!_57]]))))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_233[!_57]], x[!_57]) = mult(y[@i_232[@i_534[!_57]]], x[@i_534[!_57]])) to (((yp[@i_233[!_57]] = y[@i_232[@i_534[!_57]]]) && (x[!_57] = x[@i_534[!_57]])) || (((yp[@i_233[!_57]] = x[@i_534[!_57]]) && (x[!_57] = y[@i_232[@i_534[!_57]]])) || (((yp[@i_233[!_57]] = x[!_57]) || (y[@i_232[@i_534[!_57]]] = x[@i_534[!_57]])) && (@1_mult'(yp[@i_233[!_57]], x[!_57]) = @1_mult'(y[@i_232[@i_534[!_57]]], x[@i_534[!_57]]))))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_233[!_57]], x[!_57]) = mult(y[@i_232[@i_533[!_57]]], x[@i_533[!_57]])) to (((yp[@i_233[!_57]] = y[@i_232[@i_533[!_57]]]) && (x[!_57] = x[@i_533[!_57]])) || (((yp[@i_233[!_57]] = x[@i_533[!_57]]) && (x[!_57] = y[@i_232[@i_533[!_57]]])) || (((yp[@i_233[!_57]] = x[!_57]) || (y[@i_232[@i_533[!_57]]] = x[@i_533[!_57]])) && (@1_mult'(yp[@i_233[!_57]], x[!_57]) = @1_mult'(y[@i_232[@i_533[!_57]]], x[@i_533[!_57]]))))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_232[!_57]], x[!_57]) = mult(xp[@i_583[!_57]], yp[@i_583[!_57]])) to (((y[@i_232[!_57]] = xp[@i_583[!_57]]) && (x[!_57] = yp[@i_583[!_57]])) || (((y[@i_232[!_57]] = yp[@i_583[!_57]]) && (x[!_57] = xp[@i_583[!_57]])) || (((y[@i_232[!_57]] = x[!_57]) || (xp[@i_583[!_57]] = yp[@i_583[!_57]])) && (@1_mult'(y[@i_232[!_57]], x[!_57]) = @1_mult'(xp[@i_583[!_57]], yp[@i_583[!_57]]))))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_232[!_57]], x[!_57]) = mult(x[j[@i_582[!_57]]], y[@i_582[!_57]])) to (((y[@i_232[!_57]] = x[j[@i_582[!_57]]]) && (x[!_57] = y[@i_582[!_57]])) || (((y[@i_232[!_57]] = y[@i_582[!_57]]) && (x[!_57] = x[j[@i_582[!_57]]])) || (((y[@i_232[!_57]] = x[!_57]) || (x[j[@i_582[!_57]]] = y[@i_582[!_57]])) && (@1_mult'(y[@i_232[!_57]], x[!_57]) = @1_mult'(x[j[@i_582[!_57]]], y[@i_582[!_57]]))))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_232[!_57]], x[!_57]) = mult(x[j[@i_581[!_57]]], y[@i_581[!_57]])) to (((y[@i_232[!_57]] = x[j[@i_581[!_57]]]) && (x[!_57] = y[@i_581[!_57]])) || (((y[@i_232[!_57]] = y[@i_581[!_57]]) && (x[!_57] = x[j[@i_581[!_57]]])) || (((y[@i_232[!_57]] = x[!_57]) || (x[j[@i_581[!_57]]] = y[@i_581[!_57]])) && (@1_mult'(y[@i_232[!_57]], x[!_57]) = @1_mult'(x[j[@i_581[!_57]]], y[@i_581[!_57]]))))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_232[!_57]], x[!_57]) = mult(yp[@i_233[@i_575[!_57]]], x[@i_575[!_57]])) to (((y[@i_232[!_57]] = yp[@i_233[@i_575[!_57]]]) && (x[!_57] = x[@i_575[!_57]])) || (((y[@i_232[!_57]] = x[@i_575[!_57]]) && (x[!_57] = yp[@i_233[@i_575[!_57]]])) || (((y[@i_232[!_57]] = x[!_57]) || (yp[@i_233[@i_575[!_57]]] = x[@i_575[!_57]])) && (@1_mult'(y[@i_232[!_57]], x[!_57]) = @1_mult'(yp[@i_233[@i_575[!_57]]], x[@i_575[!_57]]))))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_232[!_57]], x[!_57]) = mult(yp[@i_233[@i_574[!_57]]], x[@i_574[!_57]])) to (((y[@i_232[!_57]] = yp[@i_233[@i_574[!_57]]]) && (x[!_57] = x[@i_574[!_57]])) || (((y[@i_232[!_57]] = x[@i_574[!_57]]) && (x[!_57] = yp[@i_233[@i_574[!_57]]])) || (((y[@i_232[!_57]] = x[!_57]) || (yp[@i_233[@i_574[!_57]]] = x[@i_574[!_57]])) && (@1_mult'(y[@i_232[!_57]], x[!_57]) = @1_mult'(yp[@i_233[@i_574[!_57]]], x[@i_574[!_57]]))))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_232[!_57]], x[!_57]) = mult(y[@i_232[@i_573[!_57]]], x[@i_573[!_57]])) to (((y[@i_232[!_57]] = y[@i_232[@i_573[!_57]]]) && (x[!_57] = x[@i_573[!_57]])) || (((y[@i_232[!_57]] = x[@i_573[!_57]]) && (x[!_57] = y[@i_232[@i_573[!_57]]])) || (((y[@i_232[!_57]] = x[!_57]) || (y[@i_232[@i_573[!_57]]] = x[@i_573[!_57]])) && (@1_mult'(y[@i_232[!_57]], x[!_57]) = @1_mult'(y[@i_232[@i_573[!_57]]], x[@i_573[!_57]]))))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_232[!_57]], x[!_57]) = mult(y[@i_232[@i_572[!_57]]], x[@i_572[!_57]])) to (((y[@i_232[!_57]] = y[@i_232[@i_572[!_57]]]) && (x[!_57] = x[@i_572[!_57]])) || (((y[@i_232[!_57]] = x[@i_572[!_57]]) && (x[!_57] = y[@i_232[@i_572[!_57]]])) || (((y[@i_232[!_57]] = x[!_57]) || (y[@i_232[@i_572[!_57]]] = x[@i_572[!_57]])) && (@1_mult'(y[@i_232[!_57]], x[!_57]) = @1_mult'(y[@i_232[@i_572[!_57]]], x[@i_572[!_57]]))))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_232[!_57]], x[!_57]) = mult(xp[@i_570[!_57]], yp[@i_570[!_57]])) to (((y[@i_232[!_57]] = xp[@i_570[!_57]]) && (x[!_57] = yp[@i_570[!_57]])) || (((y[@i_232[!_57]] = yp[@i_570[!_57]]) && (x[!_57] = xp[@i_570[!_57]])) || (((y[@i_232[!_57]] = x[!_57]) || (xp[@i_570[!_57]] = yp[@i_570[!_57]])) && (@1_mult'(y[@i_232[!_57]], x[!_57]) = @1_mult'(xp[@i_570[!_57]], yp[@i_570[!_57]]))))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_232[!_57]], x[!_57]) = mult(x[j[@i_569[!_57]]], y[@i_569[!_57]])) to (((y[@i_232[!_57]] = x[j[@i_569[!_57]]]) && (x[!_57] = y[@i_569[!_57]])) || (((y[@i_232[!_57]] = y[@i_569[!_57]]) && (x[!_57] = x[j[@i_569[!_57]]])) || (((y[@i_232[!_57]] = x[!_57]) || (x[j[@i_569[!_57]]] = y[@i_569[!_57]])) && (@1_mult'(y[@i_232[!_57]], x[!_57]) = @1_mult'(x[j[@i_569[!_57]]], y[@i_569[!_57]]))))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_232[!_57]], x[!_57]) = mult(x[j[@i_568[!_57]]], y[@i_568[!_57]])) to (((y[@i_232[!_57]] = x[j[@i_568[!_57]]]) && (x[!_57] = y[@i_568[!_57]])) || (((y[@i_232[!_57]] = y[@i_568[!_57]]) && (x[!_57] = x[j[@i_568[!_57]]])) || (((y[@i_232[!_57]] = x[!_57]) || (x[j[@i_568[!_57]]] = y[@i_568[!_57]])) && (@1_mult'(y[@i_232[!_57]], x[!_57]) = @1_mult'(x[j[@i_568[!_57]]], y[@i_568[!_57]]))))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_232[!_57]], x[!_57]) = mult(yp[@i_233[@i_562[!_57]]], x[@i_562[!_57]])) to (((y[@i_232[!_57]] = yp[@i_233[@i_562[!_57]]]) && (x[!_57] = x[@i_562[!_57]])) || (((y[@i_232[!_57]] = x[@i_562[!_57]]) && (x[!_57] = yp[@i_233[@i_562[!_57]]])) || (((y[@i_232[!_57]] = x[!_57]) || (yp[@i_233[@i_562[!_57]]] = x[@i_562[!_57]])) && (@1_mult'(y[@i_232[!_57]], x[!_57]) = @1_mult'(yp[@i_233[@i_562[!_57]]], x[@i_562[!_57]]))))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_232[!_57]], x[!_57]) = mult(yp[@i_233[@i_561[!_57]]], x[@i_561[!_57]])) to (((y[@i_232[!_57]] = yp[@i_233[@i_561[!_57]]]) && (x[!_57] = x[@i_561[!_57]])) || (((y[@i_232[!_57]] = x[@i_561[!_57]]) && (x[!_57] = yp[@i_233[@i_561[!_57]]])) || (((y[@i_232[!_57]] = x[!_57]) || (yp[@i_233[@i_561[!_57]]] = x[@i_561[!_57]])) && (@1_mult'(y[@i_232[!_57]], x[!_57]) = @1_mult'(yp[@i_233[@i_561[!_57]]], x[@i_561[!_57]]))))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_232[!_57]], x[!_57]) = mult(y[@i_232[@i_560[!_57]]], x[@i_560[!_57]])) to (((y[@i_232[!_57]] = y[@i_232[@i_560[!_57]]]) && (x[!_57] = x[@i_560[!_57]])) || (((y[@i_232[!_57]] = x[@i_560[!_57]]) && (x[!_57] = y[@i_232[@i_560[!_57]]])) || (((y[@i_232[!_57]] = x[!_57]) || (y[@i_232[@i_560[!_57]]] = x[@i_560[!_57]])) && (@1_mult'(y[@i_232[!_57]], x[!_57]) = @1_mult'(y[@i_232[@i_560[!_57]]], x[@i_560[!_57]]))))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_232[!_57]], x[!_57]) = mult(y[@i_232[@i_559[!_57]]], x[@i_559[!_57]])) to (((y[@i_232[!_57]] = y[@i_232[@i_559[!_57]]]) && (x[!_57] = x[@i_559[!_57]])) || (((y[@i_232[!_57]] = x[@i_559[!_57]]) && (x[!_57] = y[@i_232[@i_559[!_57]]])) || (((y[@i_232[!_57]] = x[!_57]) || (y[@i_232[@i_559[!_57]]] = x[@i_559[!_57]])) && (@1_mult'(y[@i_232[!_57]], x[!_57]) = @1_mult'(y[@i_232[@i_559[!_57]]], x[@i_559[!_57]]))))) Probability: 1. / |exponent| * NU
Reduced (mult(x[j[!_58]], y[!_58]) = mult(xp[@i_453[!_58]], yp[@i_453[!_58]])) to (((x[j[!_58]] = xp[@i_453[!_58]]) && (y[!_58] = yp[@i_453[!_58]])) || (((x[j[!_58]] = yp[@i_453[!_58]]) && (y[!_58] = xp[@i_453[!_58]])) || (((x[j[!_58]] = y[!_58]) || (xp[@i_453[!_58]] = yp[@i_453[!_58]])) && (@1_mult'(x[j[!_58]], y[!_58]) = @1_mult'(xp[@i_453[!_58]], yp[@i_453[!_58]]))))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_58]], y[!_58]) = mult(x[j[@i_452[!_58]]], y[@i_452[!_58]])) to (((x[j[!_58]] = x[j[@i_452[!_58]]]) && (y[!_58] = y[@i_452[!_58]])) || (((x[j[!_58]] = y[@i_452[!_58]]) && (y[!_58] = x[j[@i_452[!_58]]])) || (((x[j[!_58]] = y[!_58]) || (x[j[@i_452[!_58]]] = y[@i_452[!_58]])) && (@1_mult'(x[j[!_58]], y[!_58]) = @1_mult'(x[j[@i_452[!_58]]], y[@i_452[!_58]]))))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_58]], y[!_58]) = mult(x[j[@i_451[!_58]]], y[@i_451[!_58]])) to (((x[j[!_58]] = x[j[@i_451[!_58]]]) && (y[!_58] = y[@i_451[!_58]])) || (((x[j[!_58]] = y[@i_451[!_58]]) && (y[!_58] = x[j[@i_451[!_58]]])) || (((x[j[!_58]] = y[!_58]) || (x[j[@i_451[!_58]]] = y[@i_451[!_58]])) && (@1_mult'(x[j[!_58]], y[!_58]) = @1_mult'(x[j[@i_451[!_58]]], y[@i_451[!_58]]))))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_58]], y[!_58]) = mult(yp[@i_233[@i_445[!_58]]], x[@i_445[!_58]])) to (((x[j[!_58]] = yp[@i_233[@i_445[!_58]]]) && (y[!_58] = x[@i_445[!_58]])) || (((x[j[!_58]] = x[@i_445[!_58]]) && (y[!_58] = yp[@i_233[@i_445[!_58]]])) || (((x[j[!_58]] = y[!_58]) || (yp[@i_233[@i_445[!_58]]] = x[@i_445[!_58]])) && (@1_mult'(x[j[!_58]], y[!_58]) = @1_mult'(yp[@i_233[@i_445[!_58]]], x[@i_445[!_58]]))))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_58]], y[!_58]) = mult(yp[@i_233[@i_444[!_58]]], x[@i_444[!_58]])) to (((x[j[!_58]] = yp[@i_233[@i_444[!_58]]]) && (y[!_58] = x[@i_444[!_58]])) || (((x[j[!_58]] = x[@i_444[!_58]]) && (y[!_58] = yp[@i_233[@i_444[!_58]]])) || (((x[j[!_58]] = y[!_58]) || (yp[@i_233[@i_444[!_58]]] = x[@i_444[!_58]])) && (@1_mult'(x[j[!_58]], y[!_58]) = @1_mult'(yp[@i_233[@i_444[!_58]]], x[@i_444[!_58]]))))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_58]], y[!_58]) = mult(y[@i_232[@i_443[!_58]]], x[@i_443[!_58]])) to (((x[j[!_58]] = y[@i_232[@i_443[!_58]]]) && (y[!_58] = x[@i_443[!_58]])) || (((x[j[!_58]] = x[@i_443[!_58]]) && (y[!_58] = y[@i_232[@i_443[!_58]]])) || (((x[j[!_58]] = y[!_58]) || (y[@i_232[@i_443[!_58]]] = x[@i_443[!_58]])) && (@1_mult'(x[j[!_58]], y[!_58]) = @1_mult'(y[@i_232[@i_443[!_58]]], x[@i_443[!_58]]))))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_58]], y[!_58]) = mult(y[@i_232[@i_442[!_58]]], x[@i_442[!_58]])) to (((x[j[!_58]] = y[@i_232[@i_442[!_58]]]) && (y[!_58] = x[@i_442[!_58]])) || (((x[j[!_58]] = x[@i_442[!_58]]) && (y[!_58] = y[@i_232[@i_442[!_58]]])) || (((x[j[!_58]] = y[!_58]) || (y[@i_232[@i_442[!_58]]] = x[@i_442[!_58]])) && (@1_mult'(x[j[!_58]], y[!_58]) = @1_mult'(y[@i_232[@i_442[!_58]]], x[@i_442[!_58]]))))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_58]], y[!_58]) = mult(xp[@i_466[!_58]], yp[@i_466[!_58]])) to (((x[j[!_58]] = xp[@i_466[!_58]]) && (y[!_58] = yp[@i_466[!_58]])) || (((x[j[!_58]] = yp[@i_466[!_58]]) && (y[!_58] = xp[@i_466[!_58]])) || (((x[j[!_58]] = y[!_58]) || (xp[@i_466[!_58]] = yp[@i_466[!_58]])) && (@1_mult'(x[j[!_58]], y[!_58]) = @1_mult'(xp[@i_466[!_58]], yp[@i_466[!_58]]))))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_58]], y[!_58]) = mult(x[j[@i_465[!_58]]], y[@i_465[!_58]])) to (((x[j[!_58]] = x[j[@i_465[!_58]]]) && (y[!_58] = y[@i_465[!_58]])) || (((x[j[!_58]] = y[@i_465[!_58]]) && (y[!_58] = x[j[@i_465[!_58]]])) || (((x[j[!_58]] = y[!_58]) || (x[j[@i_465[!_58]]] = y[@i_465[!_58]])) && (@1_mult'(x[j[!_58]], y[!_58]) = @1_mult'(x[j[@i_465[!_58]]], y[@i_465[!_58]]))))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_58]], y[!_58]) = mult(x[j[@i_464[!_58]]], y[@i_464[!_58]])) to (((x[j[!_58]] = x[j[@i_464[!_58]]]) && (y[!_58] = y[@i_464[!_58]])) || (((x[j[!_58]] = y[@i_464[!_58]]) && (y[!_58] = x[j[@i_464[!_58]]])) || (((x[j[!_58]] = y[!_58]) || (x[j[@i_464[!_58]]] = y[@i_464[!_58]])) && (@1_mult'(x[j[!_58]], y[!_58]) = @1_mult'(x[j[@i_464[!_58]]], y[@i_464[!_58]]))))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_58]], y[!_58]) = mult(yp[@i_233[@i_458[!_58]]], x[@i_458[!_58]])) to (((x[j[!_58]] = yp[@i_233[@i_458[!_58]]]) && (y[!_58] = x[@i_458[!_58]])) || (((x[j[!_58]] = x[@i_458[!_58]]) && (y[!_58] = yp[@i_233[@i_458[!_58]]])) || (((x[j[!_58]] = y[!_58]) || (yp[@i_233[@i_458[!_58]]] = x[@i_458[!_58]])) && (@1_mult'(x[j[!_58]], y[!_58]) = @1_mult'(yp[@i_233[@i_458[!_58]]], x[@i_458[!_58]]))))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_58]], y[!_58]) = mult(yp[@i_233[@i_457[!_58]]], x[@i_457[!_58]])) to (((x[j[!_58]] = yp[@i_233[@i_457[!_58]]]) && (y[!_58] = x[@i_457[!_58]])) || (((x[j[!_58]] = x[@i_457[!_58]]) && (y[!_58] = yp[@i_233[@i_457[!_58]]])) || (((x[j[!_58]] = y[!_58]) || (yp[@i_233[@i_457[!_58]]] = x[@i_457[!_58]])) && (@1_mult'(x[j[!_58]], y[!_58]) = @1_mult'(yp[@i_233[@i_457[!_58]]], x[@i_457[!_58]]))))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_58]], y[!_58]) = mult(y[@i_232[@i_456[!_58]]], x[@i_456[!_58]])) to (((x[j[!_58]] = y[@i_232[@i_456[!_58]]]) && (y[!_58] = x[@i_456[!_58]])) || (((x[j[!_58]] = x[@i_456[!_58]]) && (y[!_58] = y[@i_232[@i_456[!_58]]])) || (((x[j[!_58]] = y[!_58]) || (y[@i_232[@i_456[!_58]]] = x[@i_456[!_58]])) && (@1_mult'(x[j[!_58]], y[!_58]) = @1_mult'(y[@i_232[@i_456[!_58]]], x[@i_456[!_58]]))))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_58]], y[!_58]) = mult(y[@i_232[@i_455[!_58]]], x[@i_455[!_58]])) to (((x[j[!_58]] = y[@i_232[@i_455[!_58]]]) && (y[!_58] = x[@i_455[!_58]])) || (((x[j[!_58]] = x[@i_455[!_58]]) && (y[!_58] = y[@i_232[@i_455[!_58]]])) || (((x[j[!_58]] = y[!_58]) || (y[@i_232[@i_455[!_58]]] = x[@i_455[!_58]])) && (@1_mult'(x[j[!_58]], y[!_58]) = @1_mult'(y[@i_232[@i_455[!_58]]], x[@i_455[!_58]]))))) Probability: 1. / |exponent| * NS
Reduced (mult(xp[!_59], yp[!_59]) = mult(xp[@i_440[!_59]], yp[@i_440[!_59]])) to (((xp[!_59] = xp[@i_440[!_59]]) && (yp[!_59] = yp[@i_440[!_59]])) || (((xp[!_59] = yp[@i_440[!_59]]) && (yp[!_59] = xp[@i_440[!_59]])) || (((xp[!_59] = yp[!_59]) || (xp[@i_440[!_59]] = yp[@i_440[!_59]])) && (@1_mult'(xp[!_59], yp[!_59]) = @1_mult'(xp[@i_440[!_59]], yp[@i_440[!_59]]))))) Probability: 1. / |exponent| * NP
Done.
Doing move all binders... Done.
Doing remove assignments of useless... Done.
Trying equivalence
equiv ! !_43 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all], ! !_44 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash1) -> (r' = h1(x1', x2', x3', x4', x5')) [all]
<=(set(proba <= Neq / |hash1|))=>
      ! !_45 <= N (x1_72: host, x2_71: host, x3_70: G, x4_69: G, x5_68: G) -> let x1: host = x1_72 in let x2: host = x2_71 in let x3: G = x3_70 in let x4: G = x4_69 in let x5: G = x5_68 in find [unique] j_47 <= N suchthat defined(x1[j_47], x2[j_47], x3[j_47], x4[j_47], x5[j_47], r1[j_47]) && ((x1 = x1[j_47]) && ((x2 = x2[j_47]) && ((x3 = x3[j_47]) && ((x4 = x4[j_47]) && (x5 = x5[j_47]))))) then r1[j_47] else new r1: hash1; r1, ! !_46 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash1) -> find [unique] j_48 <= N suchthat defined(x1[j_48], x2[j_48], x3[j_48], x4[j_48], x5[j_48], r1[j_48]) && ((x1' = x1[j_48]) && ((x2' = x2[j_48]) && ((x3' = x3[j_48]) && ((x4' = x4[j_48]) && (x5' = x5[j_48]))))) then (r' = r1[j_48]) else false
... Failed.
Trying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all], ! !_38 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash0) -> (r' = h0(x1', x2', x3', x4', x5')) [all]
<=(set(proba <= Neq / |hash0|))=>
      ! !_39 <= N (x1_77: host, x2_76: host, x3_75: G, x4_74: G, x5_73: G) -> let x1: host = x1_77 in let x2: host = x2_76 in let x3: G = x3_75 in let x4: G = x4_74 in let x5: G = x5_73 in find [unique] j_41 <= N suchthat defined(x1[j_41], x2[j_41], x3[j_41], x4[j_41], x5[j_41], r[j_41]) && ((x1 = x1[j_41]) && ((x2 = x2[j_41]) && ((x3 = x3[j_41]) && ((x4 = x4[j_41]) && (x5 = x5[j_41]))))) then r[j_41] else new r: hash0; r, ! !_40 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash0) -> find [unique] j_42 <= N suchthat defined(x1[j_42], x2[j_42], x3[j_42], x4[j_42], x5[j_42], r[j_42]) && ((x1' = x1[j_42]) && ((x2' = x2[j_42]) && ((x3' = x3[j_42]) && ((x4' = x4[j_42]) && (x5' = x5[j_42]))))) then (r' = r[j_42]) else false
... Failed.
Trying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_79: G, @2_ke_78: passwd) := let @2_x: G = @2_x_79 in let @2_ke: passwd = @2_ke_78 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_81: G, @2_kd_80: passwd) := let @2_m: G = @2_m_81 in let @2_kd: passwd = @2_kd_80 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 7.4 * #@1_Oa) * max(1., 7.4 * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
... Failed.
Trying equivalence
equiv ! !_7 <= @1_N new @1_x: exponent; @1_OX() := exp(g, @1_x)
<=(0)=>
      ! !_8 <= @1_N new @1_X: G; @1_OX() := @1_X
... Failed.
Trying equivalence
equiv ! !_1 <= @1_N new @1_X: G; (
  @1_OX() := @1_X,
  ! !_2 <= @1_N' @1_OXm(@1_m: exponent) := exp(@1_X, @1_m))
<=(0)=>
      ! !_3 <= @1_N new @1_x: exponent; (
  @1_OX() := exp(g, @1_x),
  ! !_4 <= @1_N' @1_OXm(@1_m: exponent) := exp(g, mult(@1_x, @1_m)))
... Succeeded.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
No change.
Doing move all binders... No change.
Doing remove assignments of useless... Done.
Trying equivalence
equiv ! !_43 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all], ! !_44 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash1) -> (r' = h1(x1', x2', x3', x4', x5')) [all]
<=(set(proba <= Neq / |hash1|))=>
      ! !_45 <= N (x1_72: host, x2_71: host, x3_70: G, x4_69: G, x5_68: G) -> let x1: host = x1_72 in let x2: host = x2_71 in let x3: G = x3_70 in let x4: G = x4_69 in let x5: G = x5_68 in find [unique] j_47 <= N suchthat defined(x1[j_47], x2[j_47], x3[j_47], x4[j_47], x5[j_47], r1[j_47]) && ((x1 = x1[j_47]) && ((x2 = x2[j_47]) && ((x3 = x3[j_47]) && ((x4 = x4[j_47]) && (x5 = x5[j_47]))))) then r1[j_47] else new r1: hash1; r1, ! !_46 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash1) -> find [unique] j_48 <= N suchthat defined(x1[j_48], x2[j_48], x3[j_48], x4[j_48], x5[j_48], r1[j_48]) && ((x1' = x1[j_48]) && ((x2' = x2[j_48]) && ((x3' = x3[j_48]) && ((x4' = x4[j_48]) && (x5' = x5[j_48]))))) then (r' = r1[j_48]) else false
... Failed.
Trying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all], ! !_38 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash0) -> (r' = h0(x1', x2', x3', x4', x5')) [all]
<=(set(proba <= Neq / |hash0|))=>
      ! !_39 <= N (x1_77: host, x2_76: host, x3_75: G, x4_74: G, x5_73: G) -> let x1: host = x1_77 in let x2: host = x2_76 in let x3: G = x3_75 in let x4: G = x4_74 in let x5: G = x5_73 in find [unique] j_41 <= N suchthat defined(x1[j_41], x2[j_41], x3[j_41], x4[j_41], x5[j_41], r[j_41]) && ((x1 = x1[j_41]) && ((x2 = x2[j_41]) && ((x3 = x3[j_41]) && ((x4 = x4[j_41]) && (x5 = x5[j_41]))))) then r[j_41] else new r: hash0; r, ! !_40 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash0) -> find [unique] j_42 <= N suchthat defined(x1[j_42], x2[j_42], x3[j_42], x4[j_42], x5[j_42], r[j_42]) && ((x1' = x1[j_42]) && ((x2' = x2[j_42]) && ((x3' = x3[j_42]) && ((x4' = x4[j_42]) && (x5' = x5[j_42]))))) then (r' = r[j_42]) else false
... Failed.
Trying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_79: G, @2_ke_78: passwd) := let @2_x: G = @2_x_79 in let @2_ke: passwd = @2_ke_78 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_81: G, @2_kd_80: passwd) := let @2_m: G = @2_m_81 in let @2_kd: passwd = @2_kd_80 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 7.4 * #@1_Oa) * max(1., 7.4 * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
... Failed.
Trying equivalence
equiv ! !_7 <= @1_N new @1_x: exponent; @1_OX() := exp(g, @1_x)
<=(0)=>
      ! !_8 <= @1_N new @1_X: G; @1_OX() := @1_X
... Failed.
Trying equivalence
equiv ! !_1 <= @1_N new @1_X: G; (
  @1_OX() := @1_X,
  ! !_2 <= @1_N' @1_OXm(@1_m: exponent) := exp(@1_X, @1_m))
<=(0)=>
      ! !_3 <= @1_N new @1_x: exponent; (
  @1_OX() := exp(g, @1_x),
  ! !_4 <= @1_N' @1_OXm(@1_m: exponent) := exp(g, mult(@1_x, @1_m)))
... Succeeded.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
No change.
Doing move all binders... No change.
Doing remove assignments of useless... Done.
Trying equivalence
equiv ! !_43 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all], ! !_44 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash1) -> (r' = h1(x1', x2', x3', x4', x5')) [all]
<=(set(proba <= Neq / |hash1|))=>
      ! !_45 <= N (x1_72: host, x2_71: host, x3_70: G, x4_69: G, x5_68: G) -> let x1: host = x1_72 in let x2: host = x2_71 in let x3: G = x3_70 in let x4: G = x4_69 in let x5: G = x5_68 in find [unique] j_47 <= N suchthat defined(x1[j_47], x2[j_47], x3[j_47], x4[j_47], x5[j_47], r1[j_47]) && ((x1 = x1[j_47]) && ((x2 = x2[j_47]) && ((x3 = x3[j_47]) && ((x4 = x4[j_47]) && (x5 = x5[j_47]))))) then r1[j_47] else new r1: hash1; r1, ! !_46 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash1) -> find [unique] j_48 <= N suchthat defined(x1[j_48], x2[j_48], x3[j_48], x4[j_48], x5[j_48], r1[j_48]) && ((x1' = x1[j_48]) && ((x2' = x2[j_48]) && ((x3' = x3[j_48]) && ((x4' = x4[j_48]) && (x5' = x5[j_48]))))) then (r' = r1[j_48]) else false
... Failed.
Trying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all], ! !_38 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash0) -> (r' = h0(x1', x2', x3', x4', x5')) [all]
<=(set(proba <= Neq / |hash0|))=>
      ! !_39 <= N (x1_77: host, x2_76: host, x3_75: G, x4_74: G, x5_73: G) -> let x1: host = x1_77 in let x2: host = x2_76 in let x3: G = x3_75 in let x4: G = x4_74 in let x5: G = x5_73 in find [unique] j_41 <= N suchthat defined(x1[j_41], x2[j_41], x3[j_41], x4[j_41], x5[j_41], r[j_41]) && ((x1 = x1[j_41]) && ((x2 = x2[j_41]) && ((x3 = x3[j_41]) && ((x4 = x4[j_41]) && (x5 = x5[j_41]))))) then r[j_41] else new r: hash0; r, ! !_40 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash0) -> find [unique] j_42 <= N suchthat defined(x1[j_42], x2[j_42], x3[j_42], x4[j_42], x5[j_42], r[j_42]) && ((x1' = x1[j_42]) && ((x2' = x2[j_42]) && ((x3' = x3[j_42]) && ((x4' = x4[j_42]) && (x5' = x5[j_42]))))) then (r' = r[j_42]) else false
... Failed.
Trying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_79: G, @2_ke_78: passwd) := let @2_x: G = @2_x_79 in let @2_ke: passwd = @2_ke_78 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_81: G, @2_kd_80: passwd) := let @2_m: G = @2_m_81 in let @2_kd: passwd = @2_kd_80 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 7.4 * #@1_Oa) * max(1., 7.4 * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
... Failed.
Trying equivalence
equiv ! !_7 <= @1_N new @1_x: exponent; @1_OX() := exp(g, @1_x)
<=(0)=>
      ! !_8 <= @1_N new @1_X: G; @1_OX() := @1_X
... Failed.
Trying equivalence
equiv ! !_1 <= @1_N new @1_X: G; (
  @1_OX() := @1_X,
  ! !_2 <= @1_N' @1_OXm(@1_m: exponent) := exp(@1_X, @1_m))
<=(0)=>
      ! !_3 <= @1_N new @1_x: exponent; (
  @1_OX() := exp(g, @1_x),
  ! !_4 <= @1_N' @1_OXm(@1_m: exponent) := exp(g, mult(@1_x, @1_m)))
... Failed.
Doing SA rename K_u... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 2 time(s). Fixpoint reached.
Eliminated collisions between y and @1_x_737 Probability: NS * qD / |exponent|
Eliminated collisions between y and @1_x_874 Probability: NS * NU / |exponent|
Reduced (mult(x[j[!_58]], y[!_58]) = mult(@1_x_737[@i_240[j[!_58]]], x[j[!_58]])) to (((x[j[!_58]] = @1_x_737[@i_240[j[!_58]]]) && (y[!_58] = x[j[!_58]])) || (((x[j[!_58]] = x[j[!_58]]) && (y[!_58] = @1_x_737[@i_240[j[!_58]]])) || (((x[j[!_58]] = y[!_58]) || (@1_x_737[@i_240[j[!_58]]] = x[j[!_58]])) && (@1_mult'(x[j[!_58]], y[!_58]) = @1_mult'(@1_x_737[@i_240[j[!_58]]], x[j[!_58]]))))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_58]], y[!_58]) = mult(@1_x_874[@i_236[j[!_58]]], x[j[!_58]])) to (((x[j[!_58]] = @1_x_874[@i_236[j[!_58]]]) && (y[!_58] = x[j[!_58]])) || (((x[j[!_58]] = x[j[!_58]]) && (y[!_58] = @1_x_874[@i_236[j[!_58]]])) || (((x[j[!_58]] = y[!_58]) || (@1_x_874[@i_236[j[!_58]]] = x[j[!_58]])) && (@1_mult'(x[j[!_58]], y[!_58]) = @1_mult'(@1_x_874[@i_236[j[!_58]]], x[j[!_58]]))))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_58]], y[!_58]) = mult(yp[@i_233[j[!_58]]], x[j[!_58]])) to (((x[j[!_58]] = yp[@i_233[j[!_58]]]) && (y[!_58] = x[j[!_58]])) || (((x[j[!_58]] = x[j[!_58]]) && (y[!_58] = yp[@i_233[j[!_58]]])) || (((x[j[!_58]] = y[!_58]) || (yp[@i_233[j[!_58]]] = x[j[!_58]])) && (@1_mult'(x[j[!_58]], y[!_58]) = @1_mult'(yp[@i_233[j[!_58]]], x[j[!_58]]))))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_58]], y[!_58]) = mult(@1_x_874[j[!_58]], x[j[!_58]])) to (((x[j[!_58]] = @1_x_874[j[!_58]]) && (y[!_58] = x[j[!_58]])) || (((x[j[!_58]] = x[j[!_58]]) && (y[!_58] = @1_x_874[j[!_58]])) || (((x[j[!_58]] = y[!_58]) || (@1_x_874[j[!_58]] = x[j[!_58]])) && (@1_mult'(x[j[!_58]], y[!_58]) = @1_mult'(@1_x_874[j[!_58]], x[j[!_58]]))))) Probability: 1. / |exponent| * NS
Done.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 7.4 * #@1_Oa) * max(1., 7.4 * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
with x, @1_x_737... Failed.
Doing remove assignments of binder K_s... Done.
Doing remove assignments of binder K_u_1041... Done.
Doing remove assignments of binder K_u_1037... Done.
Doing remove assignments of binder K_u_1038... Done.
Doing remove assignments of binder K_u_1039... Done.
Doing remove assignments of binder K_u_1040... Done.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 7.4 * #@1_Oa) * max(1., 7.4 * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
with @1_x_874, yp, y, x, @1_x_737... Failed.
Doing remove assignments of binder Kp... Done.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 7.4 * #@1_Oa) * max(1., 7.4 * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
with x, @1_x_874, yp, y, xp, @1_x_737... Eliminated collisions between @1_x_874 and @1_x_874 Probability: 0.5 * NU * NU / |exponent|
Eliminated collisions between @1_x_737 and @1_x_737 Probability: 0.5 * qD * qD / |exponent|
Eliminated collisions between @1_x_874 and yp Probability: NU * NP / |exponent|
Eliminated collisions between @1_x_874 and @1_x_737 Probability: NU * qD / |exponent|
Eliminated collisions between yp and @1_x_737 Probability: NP * qD / |exponent|
Succeeded.
Doing simplify... Run simplify 3 time(s). Maximum reached.
Done.
Doing move all binders... Done.
Doing remove assignments of useless... Done.
Proved one-session secrecy of sk_u
Proved secrecy of sk_u
Proved one-session secrecy of sk_s
Proved secrecy of sk_s
Proved one-session secrecy of sk_p
Proved secrecy of sk_p
Proved query event inj:termS(x, X, y, Y, a, k) ==> inj:termU(x, X, y, Y, a, k)
Proved query event termS(x, X, y, Y, a, k) && termU(x, X, y, Y, a, k') ==> (k = k')
Trying equivalence
equiv ! !_43 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all], ! !_44 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash1) -> (r' = h1(x1', x2', x3', x4', x5')) [all]
<=(set(proba <= Neq / |hash1|))=>
      ! !_45 <= N (x1_72: host, x2_71: host, x3_70: G, x4_69: G, x5_68: G) -> let x1: host = x1_72 in let x2: host = x2_71 in let x3: G = x3_70 in let x4: G = x4_69 in let x5: G = x5_68 in find [unique] j_47 <= N suchthat defined(x1[j_47], x2[j_47], x3[j_47], x4[j_47], x5[j_47], r1[j_47]) && ((x1 = x1[j_47]) && ((x2 = x2[j_47]) && ((x3 = x3[j_47]) && ((x4 = x4[j_47]) && (x5 = x5[j_47]))))) then r1[j_47] else new r1: hash1; r1, ! !_46 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash1) -> find [unique] j_48 <= N suchthat defined(x1[j_48], x2[j_48], x3[j_48], x4[j_48], x5[j_48], r1[j_48]) && ((x1' = x1[j_48]) && ((x2' = x2[j_48]) && ((x3' = x3[j_48]) && ((x4' = x4[j_48]) && (x5' = x5[j_48]))))) then (r' = r1[j_48]) else false
... Failed.
Trying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all], ! !_38 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash0) -> (r' = h0(x1', x2', x3', x4', x5')) [all]
<=(set(proba <= Neq / |hash0|))=>
      ! !_39 <= N (x1_77: host, x2_76: host, x3_75: G, x4_74: G, x5_73: G) -> let x1: host = x1_77 in let x2: host = x2_76 in let x3: G = x3_75 in let x4: G = x4_74 in let x5: G = x5_73 in find [unique] j_41 <= N suchthat defined(x1[j_41], x2[j_41], x3[j_41], x4[j_41], x5[j_41], r[j_41]) && ((x1 = x1[j_41]) && ((x2 = x2[j_41]) && ((x3 = x3[j_41]) && ((x4 = x4[j_41]) && (x5 = x5[j_41]))))) then r[j_41] else new r: hash0; r, ! !_40 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash0) -> find [unique] j_42 <= N suchthat defined(x1[j_42], x2[j_42], x3[j_42], x4[j_42], x5[j_42], r[j_42]) && ((x1' = x1[j_42]) && ((x2' = x2[j_42]) && ((x3' = x3[j_42]) && ((x4' = x4[j_42]) && (x5' = x5[j_42]))))) then (r' = r[j_42]) else false
... Failed.
Trying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_79: G, @2_ke_78: passwd) := let @2_x: G = @2_x_79 in let @2_ke: passwd = @2_ke_78 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_81: G, @2_kd_80: passwd) := let @2_m: G = @2_m_81 in let @2_kd: passwd = @2_kd_80 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 7.4 * #@1_Oa) * max(1., 7.4 * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
... Succeeded.
Doing simplify... Run simplify 2 time(s). Fixpoint reached.
Done.
Doing move all binders... No change.
Doing remove assignments of useless... Done.
Trying equivalence
equiv ! !_43 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all], ! !_44 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash1) -> (r' = h1(x1', x2', x3', x4', x5')) [all]
<=(set(proba <= Neq / |hash1|))=>
      ! !_45 <= N (x1_72: host, x2_71: host, x3_70: G, x4_69: G, x5_68: G) -> let x1: host = x1_72 in let x2: host = x2_71 in let x3: G = x3_70 in let x4: G = x4_69 in let x5: G = x5_68 in find [unique] j_47 <= N suchthat defined(x1[j_47], x2[j_47], x3[j_47], x4[j_47], x5[j_47], r1[j_47]) && ((x1 = x1[j_47]) && ((x2 = x2[j_47]) && ((x3 = x3[j_47]) && ((x4 = x4[j_47]) && (x5 = x5[j_47]))))) then r1[j_47] else new r1: hash1; r1, ! !_46 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash1) -> find [unique] j_48 <= N suchthat defined(x1[j_48], x2[j_48], x3[j_48], x4[j_48], x5[j_48], r1[j_48]) && ((x1' = x1[j_48]) && ((x2' = x2[j_48]) && ((x3' = x3[j_48]) && ((x4' = x4[j_48]) && (x5' = x5[j_48]))))) then (r' = r1[j_48]) else false
... Failed.
Trying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all], ! !_38 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash0) -> (r' = h0(x1', x2', x3', x4', x5')) [all]
<=(set(proba <= Neq / |hash0|))=>
      ! !_39 <= N (x1_77: host, x2_76: host, x3_75: G, x4_74: G, x5_73: G) -> let x1: host = x1_77 in let x2: host = x2_76 in let x3: G = x3_75 in let x4: G = x4_74 in let x5: G = x5_73 in find [unique] j_41 <= N suchthat defined(x1[j_41], x2[j_41], x3[j_41], x4[j_41], x5[j_41], r[j_41]) && ((x1 = x1[j_41]) && ((x2 = x2[j_41]) && ((x3 = x3[j_41]) && ((x4 = x4[j_41]) && (x5 = x5[j_41]))))) then r[j_41] else new r: hash0; r, ! !_40 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash0) -> find [unique] j_42 <= N suchthat defined(x1[j_42], x2[j_42], x3[j_42], x4[j_42], x5[j_42], r[j_42]) && ((x1' = x1[j_42]) && ((x2' = x2[j_42]) && ((x3' = x3[j_42]) && ((x4' = x4[j_42]) && (x5' = x5[j_42]))))) then (r' = r[j_42]) else false
... Failed.
Trying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_79: G, @2_ke_78: passwd) := let @2_x: G = @2_x_79 in let @2_ke: passwd = @2_ke_78 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_81: G, @2_kd_80: passwd) := let @2_m: G = @2_m_81 in let @2_kd: passwd = @2_kd_80 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 7.4 * #@1_Oa) * max(1., 7.4 * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
... Succeeded.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
No change.
Doing move all binders... No change.
Doing remove assignments of useless... Done.
Trying equivalence
equiv ! !_43 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all], ! !_44 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash1) -> (r' = h1(x1', x2', x3', x4', x5')) [all]
<=(set(proba <= Neq / |hash1|))=>
      ! !_45 <= N (x1_72: host, x2_71: host, x3_70: G, x4_69: G, x5_68: G) -> let x1: host = x1_72 in let x2: host = x2_71 in let x3: G = x3_70 in let x4: G = x4_69 in let x5: G = x5_68 in find [unique] j_47 <= N suchthat defined(x1[j_47], x2[j_47], x3[j_47], x4[j_47], x5[j_47], r1[j_47]) && ((x1 = x1[j_47]) && ((x2 = x2[j_47]) && ((x3 = x3[j_47]) && ((x4 = x4[j_47]) && (x5 = x5[j_47]))))) then r1[j_47] else new r1: hash1; r1, ! !_46 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash1) -> find [unique] j_48 <= N suchthat defined(x1[j_48], x2[j_48], x3[j_48], x4[j_48], x5[j_48], r1[j_48]) && ((x1' = x1[j_48]) && ((x2' = x2[j_48]) && ((x3' = x3[j_48]) && ((x4' = x4[j_48]) && (x5' = x5[j_48]))))) then (r' = r1[j_48]) else false
... Failed.
Trying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all], ! !_38 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash0) -> (r' = h0(x1', x2', x3', x4', x5')) [all]
<=(set(proba <= Neq / |hash0|))=>
      ! !_39 <= N (x1_77: host, x2_76: host, x3_75: G, x4_74: G, x5_73: G) -> let x1: host = x1_77 in let x2: host = x2_76 in let x3: G = x3_75 in let x4: G = x4_74 in let x5: G = x5_73 in find [unique] j_41 <= N suchthat defined(x1[j_41], x2[j_41], x3[j_41], x4[j_41], x5[j_41], r[j_41]) && ((x1 = x1[j_41]) && ((x2 = x2[j_41]) && ((x3 = x3[j_41]) && ((x4 = x4[j_41]) && (x5 = x5[j_41]))))) then r[j_41] else new r: hash0; r, ! !_40 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash0) -> find [unique] j_42 <= N suchthat defined(x1[j_42], x2[j_42], x3[j_42], x4[j_42], x5[j_42], r[j_42]) && ((x1' = x1[j_42]) && ((x2' = x2[j_42]) && ((x3' = x3[j_42]) && ((x4' = x4[j_42]) && (x5' = x5[j_42]))))) then (r' = r[j_42]) else false
... Failed.
Trying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_79: G, @2_ke_78: passwd) := let @2_x: G = @2_x_79 in let @2_ke: passwd = @2_ke_78 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_81: G, @2_kd_80: passwd) := let @2_m: G = @2_m_81 in let @2_kd: passwd = @2_kd_80 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 7.4 * #@1_Oa) * max(1., 7.4 * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
... Succeeded.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
No change.
Doing move all binders... No change.
Doing remove assignments of useless... Done.
Trying equivalence
equiv ! !_43 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all], ! !_44 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash1) -> (r' = h1(x1', x2', x3', x4', x5')) [all]
<=(set(proba <= Neq / |hash1|))=>
      ! !_45 <= N (x1_72: host, x2_71: host, x3_70: G, x4_69: G, x5_68: G) -> let x1: host = x1_72 in let x2: host = x2_71 in let x3: G = x3_70 in let x4: G = x4_69 in let x5: G = x5_68 in find [unique] j_47 <= N suchthat defined(x1[j_47], x2[j_47], x3[j_47], x4[j_47], x5[j_47], r1[j_47]) && ((x1 = x1[j_47]) && ((x2 = x2[j_47]) && ((x3 = x3[j_47]) && ((x4 = x4[j_47]) && (x5 = x5[j_47]))))) then r1[j_47] else new r1: hash1; r1, ! !_46 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash1) -> find [unique] j_48 <= N suchthat defined(x1[j_48], x2[j_48], x3[j_48], x4[j_48], x5[j_48], r1[j_48]) && ((x1' = x1[j_48]) && ((x2' = x2[j_48]) && ((x3' = x3[j_48]) && ((x4' = x4[j_48]) && (x5' = x5[j_48]))))) then (r' = r1[j_48]) else false
... Failed.
Trying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all], ! !_38 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash0) -> (r' = h0(x1', x2', x3', x4', x5')) [all]
<=(set(proba <= Neq / |hash0|))=>
      ! !_39 <= N (x1_77: host, x2_76: host, x3_75: G, x4_74: G, x5_73: G) -> let x1: host = x1_77 in let x2: host = x2_76 in let x3: G = x3_75 in let x4: G = x4_74 in let x5: G = x5_73 in find [unique] j_41 <= N suchthat defined(x1[j_41], x2[j_41], x3[j_41], x4[j_41], x5[j_41], r[j_41]) && ((x1 = x1[j_41]) && ((x2 = x2[j_41]) && ((x3 = x3[j_41]) && ((x4 = x4[j_41]) && (x5 = x5[j_41]))))) then r[j_41] else new r: hash0; r, ! !_40 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash0) -> find [unique] j_42 <= N suchthat defined(x1[j_42], x2[j_42], x3[j_42], x4[j_42], x5[j_42], r[j_42]) && ((x1' = x1[j_42]) && ((x2' = x2[j_42]) && ((x3' = x3[j_42]) && ((x4' = x4[j_42]) && (x5' = x5[j_42]))))) then (r' = r[j_42]) else false
... Failed.
Trying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_79: G, @2_ke_78: passwd) := let @2_x: G = @2_x_79 in let @2_ke: passwd = @2_ke_78 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_81: G, @2_kd_80: passwd) := let @2_m: G = @2_m_81 in let @2_kd: passwd = @2_kd_80 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 7.4 * #@1_Oa) * max(1., 7.4 * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
... Succeeded.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
No change.
Doing move all binders... No change.
Doing remove assignments of useless... Done.
Trying equivalence
equiv ! !_43 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all], ! !_44 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash1) -> (r' = h1(x1', x2', x3', x4', x5')) [all]
<=(set(proba <= Neq / |hash1|))=>
      ! !_45 <= N (x1_72: host, x2_71: host, x3_70: G, x4_69: G, x5_68: G) -> let x1: host = x1_72 in let x2: host = x2_71 in let x3: G = x3_70 in let x4: G = x4_69 in let x5: G = x5_68 in find [unique] j_47 <= N suchthat defined(x1[j_47], x2[j_47], x3[j_47], x4[j_47], x5[j_47], r1[j_47]) && ((x1 = x1[j_47]) && ((x2 = x2[j_47]) && ((x3 = x3[j_47]) && ((x4 = x4[j_47]) && (x5 = x5[j_47]))))) then r1[j_47] else new r1: hash1; r1, ! !_46 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash1) -> find [unique] j_48 <= N suchthat defined(x1[j_48], x2[j_48], x3[j_48], x4[j_48], x5[j_48], r1[j_48]) && ((x1' = x1[j_48]) && ((x2' = x2[j_48]) && ((x3' = x3[j_48]) && ((x4' = x4[j_48]) && (x5' = x5[j_48]))))) then (r' = r1[j_48]) else false
... Failed.
Trying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all], ! !_38 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash0) -> (r' = h0(x1', x2', x3', x4', x5')) [all]
<=(set(proba <= Neq / |hash0|))=>
      ! !_39 <= N (x1_77: host, x2_76: host, x3_75: G, x4_74: G, x5_73: G) -> let x1: host = x1_77 in let x2: host = x2_76 in let x3: G = x3_75 in let x4: G = x4_74 in let x5: G = x5_73 in find [unique] j_41 <= N suchthat defined(x1[j_41], x2[j_41], x3[j_41], x4[j_41], x5[j_41], r[j_41]) && ((x1 = x1[j_41]) && ((x2 = x2[j_41]) && ((x3 = x3[j_41]) && ((x4 = x4[j_41]) && (x5 = x5[j_41]))))) then r[j_41] else new r: hash0; r, ! !_40 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash0) -> find [unique] j_42 <= N suchthat defined(x1[j_42], x2[j_42], x3[j_42], x4[j_42], x5[j_42], r[j_42]) && ((x1' = x1[j_42]) && ((x2' = x2[j_42]) && ((x3' = x3[j_42]) && ((x4' = x4[j_42]) && (x5' = x5[j_42]))))) then (r' = r[j_42]) else false
... Failed.
Trying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_79: G, @2_ke_78: passwd) := let @2_x: G = @2_x_79 in let @2_ke: passwd = @2_ke_78 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_81: G, @2_kd_80: passwd) := let @2_m: G = @2_m_81 in let @2_kd: passwd = @2_kd_80 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 7.4 * #@1_Oa) * max(1., 7.4 * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
... Succeeded.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
No change.
Doing move all binders... No change.
Doing remove assignments of useless... Done.
Trying equivalence
equiv ! !_43 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all], ! !_44 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash1) -> (r' = h1(x1', x2', x3', x4', x5')) [all]
<=(set(proba <= Neq / |hash1|))=>
      ! !_45 <= N (x1_72: host, x2_71: host, x3_70: G, x4_69: G, x5_68: G) -> let x1: host = x1_72 in let x2: host = x2_71 in let x3: G = x3_70 in let x4: G = x4_69 in let x5: G = x5_68 in find [unique] j_47 <= N suchthat defined(x1[j_47], x2[j_47], x3[j_47], x4[j_47], x5[j_47], r1[j_47]) && ((x1 = x1[j_47]) && ((x2 = x2[j_47]) && ((x3 = x3[j_47]) && ((x4 = x4[j_47]) && (x5 = x5[j_47]))))) then r1[j_47] else new r1: hash1; r1, ! !_46 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash1) -> find [unique] j_48 <= N suchthat defined(x1[j_48], x2[j_48], x3[j_48], x4[j_48], x5[j_48], r1[j_48]) && ((x1' = x1[j_48]) && ((x2' = x2[j_48]) && ((x3' = x3[j_48]) && ((x4' = x4[j_48]) && (x5' = x5[j_48]))))) then (r' = r1[j_48]) else false
... Failed.
Trying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all], ! !_38 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash0) -> (r' = h0(x1', x2', x3', x4', x5')) [all]
<=(set(proba <= Neq / |hash0|))=>
      ! !_39 <= N (x1_77: host, x2_76: host, x3_75: G, x4_74: G, x5_73: G) -> let x1: host = x1_77 in let x2: host = x2_76 in let x3: G = x3_75 in let x4: G = x4_74 in let x5: G = x5_73 in find [unique] j_41 <= N suchthat defined(x1[j_41], x2[j_41], x3[j_41], x4[j_41], x5[j_41], r[j_41]) && ((x1 = x1[j_41]) && ((x2 = x2[j_41]) && ((x3 = x3[j_41]) && ((x4 = x4[j_41]) && (x5 = x5[j_41]))))) then r[j_41] else new r: hash0; r, ! !_40 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash0) -> find [unique] j_42 <= N suchthat defined(x1[j_42], x2[j_42], x3[j_42], x4[j_42], x5[j_42], r[j_42]) && ((x1' = x1[j_42]) && ((x2' = x2[j_42]) && ((x3' = x3[j_42]) && ((x4' = x4[j_42]) && (x5' = x5[j_42]))))) then (r' = r[j_42]) else false
... Failed.
Trying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_79: G, @2_ke_78: passwd) := let @2_x: G = @2_x_79 in let @2_ke: passwd = @2_ke_78 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_81: G, @2_kd_80: passwd) := let @2_m: G = @2_m_81 in let @2_kd: passwd = @2_kd_80 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 7.4 * #@1_Oa) * max(1., 7.4 * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
... Succeeded.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
No change.
Doing move all binders... No change.
Doing remove assignments of useless... Done.
Trying equivalence
equiv ! !_43 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all], ! !_44 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash1) -> (r' = h1(x1', x2', x3', x4', x5')) [all]
<=(set(proba <= Neq / |hash1|))=>
      ! !_45 <= N (x1_72: host, x2_71: host, x3_70: G, x4_69: G, x5_68: G) -> let x1: host = x1_72 in let x2: host = x2_71 in let x3: G = x3_70 in let x4: G = x4_69 in let x5: G = x5_68 in find [unique] j_47 <= N suchthat defined(x1[j_47], x2[j_47], x3[j_47], x4[j_47], x5[j_47], r1[j_47]) && ((x1 = x1[j_47]) && ((x2 = x2[j_47]) && ((x3 = x3[j_47]) && ((x4 = x4[j_47]) && (x5 = x5[j_47]))))) then r1[j_47] else new r1: hash1; r1, ! !_46 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash1) -> find [unique] j_48 <= N suchthat defined(x1[j_48], x2[j_48], x3[j_48], x4[j_48], x5[j_48], r1[j_48]) && ((x1' = x1[j_48]) && ((x2' = x2[j_48]) && ((x3' = x3[j_48]) && ((x4' = x4[j_48]) && (x5' = x5[j_48]))))) then (r' = r1[j_48]) else false
... Failed.
Trying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all], ! !_38 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash0) -> (r' = h0(x1', x2', x3', x4', x5')) [all]
<=(set(proba <= Neq / |hash0|))=>
      ! !_39 <= N (x1_77: host, x2_76: host, x3_75: G, x4_74: G, x5_73: G) -> let x1: host = x1_77 in let x2: host = x2_76 in let x3: G = x3_75 in let x4: G = x4_74 in let x5: G = x5_73 in find [unique] j_41 <= N suchthat defined(x1[j_41], x2[j_41], x3[j_41], x4[j_41], x5[j_41], r[j_41]) && ((x1 = x1[j_41]) && ((x2 = x2[j_41]) && ((x3 = x3[j_41]) && ((x4 = x4[j_41]) && (x5 = x5[j_41]))))) then r[j_41] else new r: hash0; r, ! !_40 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash0) -> find [unique] j_42 <= N suchthat defined(x1[j_42], x2[j_42], x3[j_42], x4[j_42], x5[j_42], r[j_42]) && ((x1' = x1[j_42]) && ((x2' = x2[j_42]) && ((x3' = x3[j_42]) && ((x4' = x4[j_42]) && (x5' = x5[j_42]))))) then (r' = r[j_42]) else false
... Failed.
Trying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_79: G, @2_ke_78: passwd) := let @2_x: G = @2_x_79 in let @2_ke: passwd = @2_ke_78 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_81: G, @2_kd_80: passwd) := let @2_m: G = @2_m_81 in let @2_kd: passwd = @2_kd_80 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 7.4 * #@1_Oa) * max(1., 7.4 * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
... Failed.
Trying equivalence
equiv ! !_7 <= @1_N new @1_x: exponent; @1_OX() := exp(g, @1_x)
<=(0)=>
      ! !_8 <= @1_N new @1_X: G; @1_OX() := @1_X
... Failed.
Trying equivalence
equiv ! !_1 <= @1_N new @1_X: G; (
  @1_OX() := @1_X,
  ! !_2 <= @1_N' @1_OXm(@1_m: exponent) := exp(@1_X, @1_m))
<=(0)=>
      ! !_3 <= @1_N new @1_x: exponent; (
  @1_OX() := exp(g, @1_x),
  ! !_4 <= @1_N' @1_OXm(@1_m: exponent) := exp(g, mult(@1_x, @1_m)))
... Failed.
===================== Proof starts =======================
Initial state
Game 1 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let auth_u: hash1 = h1(U, S, X, Y_u, K_u) in
  let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
  event termU(U, X, S, Ystar_u, auth_u, sk_u);
  out(c6[!_57], auth_u)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_58], (S, Ystar));
  in(c7[!_58], auth_s: hash1);
  let K_s: G = exp(X_s, y) in
  if (auth_s = h1(U, S, X_s, Y, K_s)) then
  let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
  event termS(U, X_s, S, Ystar, auth_s, sk_s)
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let authp: hash1 = h1(U, S, Xp, Yp, Kp) in
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_59], (U, Xp, S, Ystarp, authp))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_60], enc(@2_x, @2_ke))
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_61], dec(@2_m, @2_kd))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_62], h0(x1, x2, x3, x4, x5))
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  out(c21[!_63], h1(x11, x12, x13, x14, x15))
)


Applying equivalence
equiv ! !_43 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all], ! !_44 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash1) -> (r' = h1(x1', x2', x3', x4', x5')) [all]
<=(set(proba <= Neq / |hash1|))=>
      ! !_45 <= N (x1_72: host, x2_71: host, x3_70: G, x4_69: G, x5_68: G) -> let x1: host = x1_72 in let x2: host = x2_71 in let x3: G = x3_70 in let x4: G = x4_69 in let x5: G = x5_68 in find [unique] j_47 <= N suchthat defined(x1[j_47], x2[j_47], x3[j_47], x4[j_47], x5[j_47], r1[j_47]) && ((x1 = x1[j_47]) && ((x2 = x2[j_47]) && ((x3 = x3[j_47]) && ((x4 = x4[j_47]) && (x5 = x5[j_47]))))) then r1[j_47] else new r1: hash1; r1, ! !_46 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash1) -> find [unique] j_48 <= N suchthat defined(x1[j_48], x2[j_48], x3[j_48], x4[j_48], x5[j_48], r1[j_48]) && ((x1' = x1[j_48]) && ((x2' = x2[j_48]) && ((x3' = x3[j_48]) && ((x4' = x4[j_48]) && (x5' = x5[j_48]))))) then (r' = r1[j_48]) else false
 [Excluding set(dist 1->2, proba <= NS / |hash1|)] yields

Game 2 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_99: host = U in
  let x2_98: host = S in
  let x3_97: G = X in
  let x4_96: G = Y_u in
  let x5_95: G = K_u in
  find [unique] @i_115 <= qH1 suchthat defined(x1_87[@i_115], x2_86[@i_115], x3_85[@i_115], x4_84[@i_115], x5_83[@i_115], r1_82[@i_115]) && ((x1_99 = x1_87[@i_115]) && ((x2_98 = x2_86[@i_115]) && ((x3_97 = x3_85[@i_115]) && ((x4_96 = x4_84[@i_115]) && (x5_95 = x5_83[@i_115]))))) then
  (
    let auth_u: hash1 = r1_82[@i_115] in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_57], auth_u)
  )
  orfind @i_114 <= NP suchthat defined(x1_93[@i_114], x2_92[@i_114], x3_91[@i_114], x4_90[@i_114], x5_89[@i_114], r1_88[@i_114]) && ((x1_99 = x1_93[@i_114]) && ((x2_98 = x2_92[@i_114]) && ((x3_97 = x3_91[@i_114]) && ((x4_96 = x4_90[@i_114]) && (x5_95 = x5_89[@i_114]))))) then
  (
    let auth_u: hash1 = r1_88[@i_114] in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_57], auth_u)
  )
  orfind @i_112 <= NU suchthat defined(x1_99[@i_112], x2_98[@i_112], x3_97[@i_112], x4_96[@i_112], x5_95[@i_112], r1_94[@i_112]) && ((x1_99 = x1_99[@i_112]) && ((x2_98 = x2_98[@i_112]) && ((x3_97 = x3_97[@i_112]) && ((x4_96 = x4_96[@i_112]) && (x5_95 = x5_95[@i_112]))))) then
  (
    let auth_u: hash1 = r1_94[@i_112] in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_57], auth_u)
  )
  else
    new r1_94: hash1;
    let auth_u: hash1 = r1_94 in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_57], auth_u)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_58], (S, Ystar));
  in(c7[!_58], auth_s: hash1);
  let K_s: G = exp(X_s, y) in
  find [unique] @i_111 <= qH1 suchthat defined(x1_87[@i_111], x2_86[@i_111], x3_85[@i_111], x4_84[@i_111], x5_83[@i_111], r1_82[@i_111]) && ((U = x1_87[@i_111]) && ((S = x2_86[@i_111]) && ((X_s = x3_85[@i_111]) && ((Y = x4_84[@i_111]) && (K_s = x5_83[@i_111]))))) then
  (
    if (auth_s = r1_82[@i_111]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  orfind @i_110 <= NP suchthat defined(x1_93[@i_110], x2_92[@i_110], x3_91[@i_110], x4_90[@i_110], x5_89[@i_110], r1_88[@i_110]) && ((U = x1_93[@i_110]) && ((S = x2_92[@i_110]) && ((X_s = x3_91[@i_110]) && ((Y = x4_90[@i_110]) && (K_s = x5_89[@i_110]))))) then
  (
    if (auth_s = r1_88[@i_110]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  orfind @i_108 <= NU suchthat defined(x1_99[@i_108], x2_98[@i_108], x3_97[@i_108], x4_96[@i_108], x5_95[@i_108], r1_94[@i_108]) && ((U = x1_99[@i_108]) && ((S = x2_98[@i_108]) && ((X_s = x3_97[@i_108]) && ((Y = x4_96[@i_108]) && (K_s = x5_95[@i_108]))))) then
  (
    if (auth_s = r1_94[@i_108]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  else
    if false then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let x1_93: host = U in
  let x2_92: host = S in
  let x3_91: G = Xp in
  let x4_90: G = Yp in
  let x5_89: G = Kp in
  find [unique] @i_107 <= qH1 suchthat defined(x1_87[@i_107], x2_86[@i_107], x3_85[@i_107], x4_84[@i_107], x5_83[@i_107], r1_82[@i_107]) && ((x1_93 = x1_87[@i_107]) && ((x2_92 = x2_86[@i_107]) && ((x3_91 = x3_85[@i_107]) && ((x4_90 = x4_84[@i_107]) && (x5_89 = x5_83[@i_107]))))) then
  (
    let authp: hash1 = r1_82[@i_107] in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_59], (U, Xp, S, Ystarp, authp))
  )
  orfind @i_106 <= NP suchthat defined(x1_93[@i_106], x2_92[@i_106], x3_91[@i_106], x4_90[@i_106], x5_89[@i_106], r1_88[@i_106]) && ((x1_93 = x1_93[@i_106]) && ((x2_92 = x2_92[@i_106]) && ((x3_91 = x3_91[@i_106]) && ((x4_90 = x4_90[@i_106]) && (x5_89 = x5_89[@i_106]))))) then
  (
    let authp: hash1 = r1_88[@i_106] in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_59], (U, Xp, S, Ystarp, authp))
  )
  orfind @i_104 <= NU suchthat defined(x1_99[@i_104], x2_98[@i_104], x3_97[@i_104], x4_96[@i_104], x5_95[@i_104], r1_94[@i_104]) && ((x1_93 = x1_99[@i_104]) && ((x2_92 = x2_98[@i_104]) && ((x3_91 = x3_97[@i_104]) && ((x4_90 = x4_96[@i_104]) && (x5_89 = x5_95[@i_104]))))) then
  (
    let authp: hash1 = r1_94[@i_104] in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_59], (U, Xp, S, Ystarp, authp))
  )
  else
    new r1_88: hash1;
    let authp: hash1 = r1_88 in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_59], (U, Xp, S, Ystarp, authp))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_60], enc(@2_x, @2_ke))
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_61], dec(@2_m, @2_kd))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_62], h0(x1, x2, x3, x4, x5))
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_87: host = x11 in
  let x2_86: host = x12 in
  let x3_85: G = x13 in
  let x4_84: G = x14 in
  let x5_83: G = x15 in
  find [unique] @i_103 <= qH1 suchthat defined(x1_87[@i_103], x2_86[@i_103], x3_85[@i_103], x4_84[@i_103], x5_83[@i_103], r1_82[@i_103]) && ((x1_87 = x1_87[@i_103]) && ((x2_86 = x2_86[@i_103]) && ((x3_85 = x3_85[@i_103]) && ((x4_84 = x4_84[@i_103]) && (x5_83 = x5_83[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], x3_91[@i_102], x4_90[@i_102], x5_89[@i_102], r1_88[@i_102]) && ((x1_87 = x1_93[@i_102]) && ((x2_86 = x2_92[@i_102]) && ((x3_85 = x3_91[@i_102]) && ((x4_84 = x4_90[@i_102]) && (x5_83 = x5_89[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], x3_97[@i_100], x4_96[@i_100], x5_95[@i_100], r1_94[@i_100]) && ((x1_87 = x1_99[@i_100]) && ((x2_86 = x2_98[@i_100]) && ((x3_85 = x3_97[@i_100]) && ((x4_84 = x4_96[@i_100]) && (x5_83 = x5_95[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying simplify [Excluding set(dist 2->3, proba <= 2. * NU * NP / |exponent| + qH1 * NP / |exponent| + 1. / |exponent| * NP + NP * NP / |exponent| + NS * NP / |exponent| + 0.5 * NU * NU / |exponent|)] yields

Game 3 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_99: host = U in
  let x2_98: host = S in
  let x3_97: G = X in
  let x4_96: G = Y_u in
  let x5_95: G = K_u in
  find [unique] @i_115 <= qH1 suchthat defined(x1_87[@i_115], x2_86[@i_115], x3_85[@i_115], x4_84[@i_115], x5_83[@i_115], r1_82[@i_115]) && ((x1_99 = x1_87[@i_115]) && ((x2_98 = x2_86[@i_115]) && ((x3_97 = x3_85[@i_115]) && ((x4_96 = x4_84[@i_115]) && (x5_95 = x5_83[@i_115]))))) then
  (
    let auth_u: hash1 = r1_82[@i_115] in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_57], auth_u)
  )
  else
    new r1_94: hash1;
    let auth_u: hash1 = r1_94 in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_57], auth_u)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_58], (S, Ystar));
  in(c7[!_58], auth_s: hash1);
  let K_s: G = exp(X_s, y) in
  find [unique] @i_111 <= qH1 suchthat defined(x1_87[@i_111], x2_86[@i_111], x3_85[@i_111], x4_84[@i_111], x5_83[@i_111], r1_82[@i_111]) && ((U = x1_87[@i_111]) && ((S = x2_86[@i_111]) && ((X_s = x3_85[@i_111]) && ((Y = x4_84[@i_111]) && (K_s = x5_83[@i_111]))))) then
  (
    if (auth_s = r1_82[@i_111]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  orfind @i_108 <= NU suchthat defined(x3_97[@i_108], x4_96[@i_108], x5_95[@i_108], r1_94[@i_108]) && ((X_s = x3_97[@i_108]) && ((Y = x4_96[@i_108]) && (K_s = x5_95[@i_108]))) then
  (
    if (auth_s = r1_94[@i_108]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let x1_93: host = U in
  let x2_92: host = S in
  let x3_91: G = Xp in
  let x4_90: G = Yp in
  let x5_89: G = Kp in
  new r1_88: hash1;
  let authp: hash1 = r1_88 in
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_59], (U, Xp, S, Ystarp, authp))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_60], enc(@2_x, @2_ke))
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_61], dec(@2_m, @2_kd))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_62], h0(x1, x2, x3, x4, x5))
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_87: host = x11 in
  let x2_86: host = x12 in
  let x3_85: G = x13 in
  let x4_84: G = x14 in
  let x5_83: G = x15 in
  find [unique] @i_103 <= qH1 suchthat defined(x1_87[@i_103], x2_86[@i_103], x3_85[@i_103], x4_84[@i_103], x5_83[@i_103], r1_82[@i_103]) && ((x1_87 = x1_87[@i_103]) && ((x2_86 = x2_86[@i_103]) && ((x3_85 = x3_85[@i_103]) && ((x4_84 = x4_84[@i_103]) && (x5_83 = x5_83[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], x3_91[@i_102], x4_90[@i_102], x5_89[@i_102], r1_88[@i_102]) && ((x1_87 = x1_93[@i_102]) && ((x2_86 = x2_92[@i_102]) && ((x3_85 = x3_91[@i_102]) && ((x4_84 = x4_90[@i_102]) && (x5_83 = x5_89[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], x3_97[@i_100], x4_96[@i_100], x5_95[@i_100], r1_94[@i_100]) && ((x1_87 = x1_99[@i_100]) && ((x2_86 = x2_98[@i_100]) && ((x3_85 = x3_97[@i_100]) && ((x4_84 = x4_96[@i_100]) && (x5_83 = x5_95[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of useless yields

Game 4 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_99: host = U in
  let x2_98: host = S in
  find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], x5_83[@i_115], x4_84[@i_115], x3_85[@i_115], x2_86[@i_115], x1_87[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
  (
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
    out(c6[!_57], r1_82[@i_115])
  )
  else
    new r1_94: hash1;
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_94, sk_u);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_58], (S, Ystar));
  in(c7[!_58], auth_s: hash1);
  let K_s: G = exp(X_s, y) in
  find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], x5_83[@i_111], x4_84[@i_111], x3_85[@i_111], x2_86[@i_111], x1_87[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
  (
    if (auth_s = r1_82[@i_111]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  orfind @i_108 <= NU suchthat defined(X[@i_108], Y_u[@i_108], K_u[@i_108], Y_u[@i_108], Y_u[@i_108], Y_u[@i_108], r1_94[@i_108]) && ((X_s = X[@i_108]) && ((Y = Y_u[@i_108]) && (K_s = K_u[@i_108]))) then
  (
    if (auth_s = r1_94[@i_108]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_59], (U, Xp, S, Ystarp, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_60], enc(@2_x, @2_ke))
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_61], dec(@2_m, @2_kd))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_62], h0(x1, x2, x3, x4, x5))
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_87: host = cst_host in
  let x2_86: host = cst_host in
  let x3_85: G = cst_G in
  let x4_84: G = cst_G in
  let x5_83: G = cst_G in
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], x5_83[@i_103], x4_84[@i_103], x3_85[@i_103], x2_86[@i_103], x1_87[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(Xp[@i_102], Yp[@i_102], Kp[@i_102], xp[@i_102], xp[@i_102], xp[@i_102], x1_93[@i_102], x2_92[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(X[@i_100], Y_u[@i_100], K_u[@i_100], Y_u[@i_100], Y_u[@i_100], Y_u[@i_100], x1_99[@i_100], x2_98[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying insert instruction find j <= NU suchthat defined(X[j]) && X[j] = X_s then at occurrence 472 yields

Game 5 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_99: host = U in
  let x2_98: host = S in
  find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], x5_83[@i_115], x4_84[@i_115], x3_85[@i_115], x2_86[@i_115], x1_87[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
  (
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
    out(c6[!_57], r1_82[@i_115])
  )
  else
    new r1_94: hash1;
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_94, sk_u);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_58], (S, Ystar));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(X_s, y) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], x5_83[@i_111], x4_84[@i_111], x3_85[@i_111], x2_86[@i_111], x1_87[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind @i_108 <= NU suchthat defined(X[@i_108], Y_u[@i_108], K_u[@i_108], Y_u[@i_108], Y_u[@i_108], Y_u[@i_108], r1_94[@i_108]) && ((X_s = X[@i_108]) && ((Y = Y_u[@i_108]) && (K_s = K_u[@i_108]))) then
    (
      if (auth_s = r1_94[@i_108]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  else
    let K_s: G = exp(X_s, y) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], x5_83[@i_111], x4_84[@i_111], x3_85[@i_111], x2_86[@i_111], x1_87[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind @i_108 <= NU suchthat defined(X[@i_108], Y_u[@i_108], K_u[@i_108], Y_u[@i_108], Y_u[@i_108], Y_u[@i_108], r1_94[@i_108]) && ((X_s = X[@i_108]) && ((Y = Y_u[@i_108]) && (K_s = K_u[@i_108]))) then
    (
      if (auth_s = r1_94[@i_108]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_59], (U, Xp, S, Ystarp, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_60], enc(@2_x, @2_ke))
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_61], dec(@2_m, @2_kd))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_62], h0(x1, x2, x3, x4, x5))
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_87: host = cst_host in
  let x2_86: host = cst_host in
  let x3_85: G = cst_G in
  let x4_84: G = cst_G in
  let x5_83: G = cst_G in
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], x5_83[@i_103], x4_84[@i_103], x3_85[@i_103], x2_86[@i_103], x1_87[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(Xp[@i_102], Yp[@i_102], Kp[@i_102], xp[@i_102], xp[@i_102], xp[@i_102], x1_93[@i_102], x2_92[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(X[@i_100], Y_u[@i_100], K_u[@i_100], Y_u[@i_100], Y_u[@i_100], Y_u[@i_100], x1_99[@i_100], x2_98[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying insert instruction find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && (U = x11[nj]) && (S = x12[nj]) && (X_s = x13[nj]) && (Y = x14[nj]) && (auth_s = r1_82[nj]) then at occurrence 472 yields

Game 6 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_99: host = U in
  let x2_98: host = S in
  find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], x5_83[@i_115], x4_84[@i_115], x3_85[@i_115], x2_86[@i_115], x1_87[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
  (
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
    out(c6[!_57], r1_82[@i_115])
  )
  else
    new r1_94: hash1;
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_94, sk_u);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_58], (S, Ystar));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(X_s, y) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], x5_83[@i_111], x4_84[@i_111], x3_85[@i_111], x2_86[@i_111], x1_87[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind @i_108 <= NU suchthat defined(X[@i_108], Y_u[@i_108], K_u[@i_108], Y_u[@i_108], Y_u[@i_108], Y_u[@i_108], r1_94[@i_108]) && ((X_s = X[@i_108]) && ((Y = Y_u[@i_108]) && (K_s = K_u[@i_108]))) then
    (
      if (auth_s = r1_94[@i_108]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    (
      let K_s: G = exp(X_s, y) in
      find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], x5_83[@i_111], x4_84[@i_111], x3_85[@i_111], x2_86[@i_111], x1_87[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
      (
        if (auth_s = r1_82[@i_111]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_108 <= NU suchthat defined(X[@i_108], Y_u[@i_108], K_u[@i_108], Y_u[@i_108], Y_u[@i_108], Y_u[@i_108], r1_94[@i_108]) && ((X_s = X[@i_108]) && ((Y = Y_u[@i_108]) && (K_s = K_u[@i_108]))) then
      (
        if (auth_s = r1_94[@i_108]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
    )
    else
      let K_s: G = exp(X_s, y) in
      find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], x5_83[@i_111], x4_84[@i_111], x3_85[@i_111], x2_86[@i_111], x1_87[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
      (
        if (auth_s = r1_82[@i_111]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_108 <= NU suchthat defined(X[@i_108], Y_u[@i_108], K_u[@i_108], Y_u[@i_108], Y_u[@i_108], Y_u[@i_108], r1_94[@i_108]) && ((X_s = X[@i_108]) && ((Y = Y_u[@i_108]) && (K_s = K_u[@i_108]))) then
      (
        if (auth_s = r1_94[@i_108]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_59], (U, Xp, S, Ystarp, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_60], enc(@2_x, @2_ke))
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_61], dec(@2_m, @2_kd))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_62], h0(x1, x2, x3, x4, x5))
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_87: host = cst_host in
  let x2_86: host = cst_host in
  let x3_85: G = cst_G in
  let x4_84: G = cst_G in
  let x5_83: G = cst_G in
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], x5_83[@i_103], x4_84[@i_103], x3_85[@i_103], x2_86[@i_103], x1_87[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(Xp[@i_102], Yp[@i_102], Kp[@i_102], xp[@i_102], xp[@i_102], xp[@i_102], x1_93[@i_102], x2_92[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(X[@i_100], Y_u[@i_100], K_u[@i_100], Y_u[@i_100], Y_u[@i_100], Y_u[@i_100], x1_99[@i_100], x2_98[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying insert event Auth at occurrence 637 [Excluding set(event Auth in game 7)] yields

Game 7 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_99: host = U in
  let x2_98: host = S in
  find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], x5_83[@i_115], x4_84[@i_115], x3_85[@i_115], x2_86[@i_115], x1_87[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
  (
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
    out(c6[!_57], r1_82[@i_115])
  )
  else
    new r1_94: hash1;
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_94, sk_u);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_58], (S, Ystar));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(X_s, y) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], x5_83[@i_111], x4_84[@i_111], x3_85[@i_111], x2_86[@i_111], x1_87[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind @i_108 <= NU suchthat defined(X[@i_108], Y_u[@i_108], K_u[@i_108], Y_u[@i_108], Y_u[@i_108], Y_u[@i_108], r1_94[@i_108]) && ((X_s = X[@i_108]) && ((Y = Y_u[@i_108]) && (K_s = K_u[@i_108]))) then
    (
      if (auth_s = r1_94[@i_108]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
      event Auth
    else
      let K_s: G = exp(X_s, y) in
      find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], x5_83[@i_111], x4_84[@i_111], x3_85[@i_111], x2_86[@i_111], x1_87[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
      (
        if (auth_s = r1_82[@i_111]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_108 <= NU suchthat defined(X[@i_108], Y_u[@i_108], K_u[@i_108], Y_u[@i_108], Y_u[@i_108], Y_u[@i_108], r1_94[@i_108]) && ((X_s = X[@i_108]) && ((Y = Y_u[@i_108]) && (K_s = K_u[@i_108]))) then
      (
        if (auth_s = r1_94[@i_108]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_59], (U, Xp, S, Ystarp, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_60], enc(@2_x, @2_ke))
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_61], dec(@2_m, @2_kd))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_62], h0(x1, x2, x3, x4, x5))
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_87: host = cst_host in
  let x2_86: host = cst_host in
  let x3_85: G = cst_G in
  let x4_84: G = cst_G in
  let x5_83: G = cst_G in
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], x5_83[@i_103], x4_84[@i_103], x3_85[@i_103], x2_86[@i_103], x1_87[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(Xp[@i_102], Yp[@i_102], Kp[@i_102], xp[@i_102], xp[@i_102], xp[@i_102], x1_93[@i_102], x2_92[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(X[@i_100], Y_u[@i_100], K_u[@i_100], Y_u[@i_100], Y_u[@i_100], Y_u[@i_100], x1_99[@i_100], x2_98[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying simplify yields

Game 8 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_99: host = U in
  let x2_98: host = S in
  find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
  (
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
    out(c6[!_57], r1_82[@i_115])
  )
  else
    new r1_94: hash1;
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_94, sk_u);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_58], (S, Ystar));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      let @i_108 <= NU = j in
      if (auth_s = r1_94[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_59], (U, Xp, S, Ystarp, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_60], enc(@2_x, @2_ke))
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_61], dec(@2_m, @2_kd))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_62], h0(x1, x2, x3, x4, x5))
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_87: host = cst_host in
  let x2_86: host = cst_host in
  let x3_85: G = cst_G in
  let x4_84: G = cst_G in
  let x5_83: G = cst_G in
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_79: G, @2_ke_78: passwd) := let @2_x: G = @2_x_79 in let @2_ke: passwd = @2_ke_78 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_81: G, @2_kd_80: passwd) := let @2_m: G = @2_m_81 in let @2_kd: passwd = @2_kd_80 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
 [Excluding set(dist 8->9, proba <= (NS * NS + 2. * NP * NS + 2. * qE * NS + 2. * NU * NS + 2. * qD * NS + NP * NP + 2. * qE * NP + 2. * NU * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 2. * qD * qE + NU * NU + 2. * qD * NU + qD * qD + -1. * NS + -1. * NP + -1. * qE + -1. * NU + -1. * qD) / |G|)] yields

Game 9 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  let @2_m_190: G = Ystar_u in
  let @2_kd_189: passwd = pw in
  find [unique] @i_240 <= qD suchthat defined(@2_r4_176[@i_240], @2_m_178[@i_240], @2_kd_177[@i_240]) && ((@2_m_190 = @2_m_178[@i_240]) && (@2_kd_189 = @2_kd_177[@i_240])) then
  (
    let Y_u: G = @2_r4_176[@i_240] in
    let K_u: G = exp(Y_u, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(@2_r4_188[@i_236], @2_m_190[@i_236], @2_kd_189[@i_236]) && ((@2_m_190 = @2_m_190[@i_236]) && (@2_kd_189 = @2_kd_189[@i_236])) then
  (
    let Y_u: G = @2_r4_188[@i_236] in
    let K_u: G = exp(Y_u, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_x_181[@i_234], @2_ke_180[@i_234], @2_r2_179[@i_234]) && ((@2_m_190 = @2_r2_179[@i_234]) && (@2_kd_189 = @2_ke_180[@i_234])) then
  (
    let Y_u: G = @2_x_181[@i_234] in
    let K_u: G = exp(Y_u, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_233 <= NP suchthat defined(@2_x_184[@i_233], @2_ke_183[@i_233], @2_r2_182[@i_233]) && ((@2_m_190 = @2_r2_182[@i_233]) && (@2_kd_189 = @2_ke_183[@i_233])) then
  (
    let Y_u: G = @2_x_184[@i_233] in
    let K_u: G = exp(Y_u, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_x_187[@i_232], @2_ke_186[@i_232], @2_r2_185[@i_232]) && ((@2_m_190 = @2_r2_185[@i_232]) && (@2_kd_189 = @2_ke_186[@i_232])) then
  (
    let Y_u: G = @2_x_187[@i_232] in
    let K_u: G = exp(Y_u, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  else
    new @2_r4_188: G;
    let Y_u: G = @2_r4_188 in
    let K_u: G = exp(Y_u, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let @2_x_187: G = Y in
  let @2_ke_186: passwd = pw in
  find [unique] @i_230 <= qD suchthat defined(@2_r4_176[@i_230], @2_m_178[@i_230], @2_kd_177[@i_230]) && ((@2_x_187 = @2_r4_176[@i_230]) && (@2_ke_186 = @2_kd_177[@i_230])) then
  (
    let Ystar: G = @2_m_178[@i_230] in
    out(c4[!_58], (S, Ystar));
    in(c7[!_58], auth_s: hash1);
    find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
    (
      let K_s: G = exp(g, mult(x[j], y)) in
      find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
      (
        if (auth_s = r1_82[@i_111]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
      (
        let @i_108 <= NU = j in
        if (auth_s = r1_94[j]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
    )
    else
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
      event Auth
  )
  orfind @i_226 <= NU suchthat defined(@2_r4_188[@i_226], @2_m_190[@i_226], @2_kd_189[@i_226]) && ((@2_x_187 = @2_r4_188[@i_226]) && (@2_ke_186 = @2_kd_189[@i_226])) then
  (
    let Ystar: G = @2_m_190[@i_226] in
    out(c4[!_58], (S, Ystar));
    in(c7[!_58], auth_s: hash1);
    find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
    (
      let K_s: G = exp(g, mult(x[j], y)) in
      find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
      (
        if (auth_s = r1_82[@i_111]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
      (
        let @i_108 <= NU = j in
        if (auth_s = r1_94[j]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
    )
    else
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
      event Auth
  )
  orfind @i_224 <= qE suchthat defined(@2_x_181[@i_224], @2_ke_180[@i_224], @2_r2_179[@i_224]) && ((@2_x_187 = @2_x_181[@i_224]) && (@2_ke_186 = @2_ke_180[@i_224])) then
  (
    let Ystar: G = @2_r2_179[@i_224] in
    out(c4[!_58], (S, Ystar));
    in(c7[!_58], auth_s: hash1);
    find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
    (
      let K_s: G = exp(g, mult(x[j], y)) in
      find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
      (
        if (auth_s = r1_82[@i_111]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
      (
        let @i_108 <= NU = j in
        if (auth_s = r1_94[j]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
    )
    else
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
      event Auth
  )
  orfind @i_223 <= NP suchthat defined(@2_x_184[@i_223], @2_ke_183[@i_223], @2_r2_182[@i_223]) && ((@2_x_187 = @2_x_184[@i_223]) && (@2_ke_186 = @2_ke_183[@i_223])) then
  (
    let Ystar: G = @2_r2_182[@i_223] in
    out(c4[!_58], (S, Ystar));
    in(c7[!_58], auth_s: hash1);
    find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
    (
      let K_s: G = exp(g, mult(x[j], y)) in
      find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
      (
        if (auth_s = r1_82[@i_111]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
      (
        let @i_108 <= NU = j in
        if (auth_s = r1_94[j]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
    )
    else
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
      event Auth
  )
  orfind @i_222 <= NS suchthat defined(@2_x_187[@i_222], @2_ke_186[@i_222], @2_r2_185[@i_222]) && ((@2_x_187 = @2_x_187[@i_222]) && (@2_ke_186 = @2_ke_186[@i_222])) then
  (
    let Ystar: G = @2_r2_185[@i_222] in
    out(c4[!_58], (S, Ystar));
    in(c7[!_58], auth_s: hash1);
    find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
    (
      let K_s: G = exp(g, mult(x[j], y)) in
      find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
      (
        if (auth_s = r1_82[@i_111]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
      (
        let @i_108 <= NU = j in
        if (auth_s = r1_94[j]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
    )
    else
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
      event Auth
  )
  else
    new @2_r2_185: G;
    let Ystar: G = @2_r2_185 in
    out(c4[!_58], (S, Ystar));
    in(c7[!_58], auth_s: hash1);
    find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
    (
      let K_s: G = exp(g, mult(x[j], y)) in
      find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
      (
        if (auth_s = r1_82[@i_111]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
      (
        let @i_108 <= NU = j in
        if (auth_s = r1_94[j]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
    )
    else
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
      event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let @2_x_184: G = Yp in
  let @2_ke_183: passwd = pw in
  find [unique] @i_220 <= qD suchthat defined(@2_r4_176[@i_220], @2_m_178[@i_220], @2_kd_177[@i_220]) && ((@2_x_184 = @2_r4_176[@i_220]) && (@2_ke_183 = @2_kd_177[@i_220])) then
  (
    let Ystarp: G = @2_m_178[@i_220] in
    let x1_93: host = U in
    let x2_92: host = S in
    new r1_88: hash1;
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_59], (U, Xp, S, Ystarp, r1_88))
  )
  orfind @i_216 <= NU suchthat defined(@2_r4_188[@i_216], @2_m_190[@i_216], @2_kd_189[@i_216]) && ((@2_x_184 = @2_r4_188[@i_216]) && (@2_ke_183 = @2_kd_189[@i_216])) then
  (
    let Ystarp: G = @2_m_190[@i_216] in
    let x1_93: host = U in
    let x2_92: host = S in
    new r1_88: hash1;
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_59], (U, Xp, S, Ystarp, r1_88))
  )
  orfind @i_214 <= qE suchthat defined(@2_x_181[@i_214], @2_ke_180[@i_214], @2_r2_179[@i_214]) && ((@2_x_184 = @2_x_181[@i_214]) && (@2_ke_183 = @2_ke_180[@i_214])) then
  (
    let Ystarp: G = @2_r2_179[@i_214] in
    let x1_93: host = U in
    let x2_92: host = S in
    new r1_88: hash1;
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_59], (U, Xp, S, Ystarp, r1_88))
  )
  orfind @i_213 <= NP suchthat defined(@2_x_184[@i_213], @2_ke_183[@i_213], @2_r2_182[@i_213]) && ((@2_x_184 = @2_x_184[@i_213]) && (@2_ke_183 = @2_ke_183[@i_213])) then
  (
    let Ystarp: G = @2_r2_182[@i_213] in
    let x1_93: host = U in
    let x2_92: host = S in
    new r1_88: hash1;
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_59], (U, Xp, S, Ystarp, r1_88))
  )
  orfind @i_212 <= NS suchthat defined(@2_x_187[@i_212], @2_ke_186[@i_212], @2_r2_185[@i_212]) && ((@2_x_184 = @2_x_187[@i_212]) && (@2_ke_183 = @2_ke_186[@i_212])) then
  (
    let Ystarp: G = @2_r2_185[@i_212] in
    let x1_93: host = U in
    let x2_92: host = S in
    new r1_88: hash1;
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_59], (U, Xp, S, Ystarp, r1_88))
  )
  else
    new @2_r2_182: G;
    let Ystarp: G = @2_r2_182 in
    let x1_93: host = U in
    let x2_92: host = S in
    new r1_88: hash1;
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_59], (U, Xp, S, Ystarp, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  let @2_x_181: G = @2_x in
  let @2_ke_180: passwd = @2_ke in
  find [unique] @i_210 <= qD suchthat defined(@2_r4_176[@i_210], @2_m_178[@i_210], @2_kd_177[@i_210]) && ((@2_x_181 = @2_r4_176[@i_210]) && (@2_ke_180 = @2_kd_177[@i_210])) then
    out(@2_c2[!_60], @2_m_178[@i_210])
  orfind @i_206 <= NU suchthat defined(@2_r4_188[@i_206], @2_m_190[@i_206], @2_kd_189[@i_206]) && ((@2_x_181 = @2_r4_188[@i_206]) && (@2_ke_180 = @2_kd_189[@i_206])) then
    out(@2_c2[!_60], @2_m_190[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x_181[@i_204], @2_ke_180[@i_204], @2_r2_179[@i_204]) && ((@2_x_181 = @2_x_181[@i_204]) && (@2_ke_180 = @2_ke_180[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(@2_x_184[@i_203], @2_ke_183[@i_203], @2_r2_182[@i_203]) && ((@2_x_181 = @2_x_184[@i_203]) && (@2_ke_180 = @2_ke_183[@i_203])) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(@2_x_187[@i_202], @2_ke_186[@i_202], @2_r2_185[@i_202]) && ((@2_x_181 = @2_x_187[@i_202]) && (@2_ke_180 = @2_ke_186[@i_202])) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  let @2_m_178: G = @2_m in
  let @2_kd_177: passwd = @2_kd in
  find [unique] @i_200 <= qD suchthat defined(@2_r4_176[@i_200], @2_m_178[@i_200], @2_kd_177[@i_200]) && ((@2_m_178 = @2_m_178[@i_200]) && (@2_kd_177 = @2_kd_177[@i_200])) then
    out(@2_c4[!_61], @2_r4_176[@i_200])
  orfind @i_196 <= NU suchthat defined(@2_r4_188[@i_196], @2_m_190[@i_196], @2_kd_189[@i_196]) && ((@2_m_178 = @2_m_190[@i_196]) && (@2_kd_177 = @2_kd_189[@i_196])) then
    out(@2_c4[!_61], @2_r4_188[@i_196])
  orfind @i_194 <= qE suchthat defined(@2_x_181[@i_194], @2_ke_180[@i_194], @2_r2_179[@i_194]) && ((@2_m_178 = @2_r2_179[@i_194]) && (@2_kd_177 = @2_ke_180[@i_194])) then
    out(@2_c4[!_61], @2_x_181[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_x_184[@i_193], @2_ke_183[@i_193], @2_r2_182[@i_193]) && ((@2_m_178 = @2_r2_182[@i_193]) && (@2_kd_177 = @2_ke_183[@i_193])) then
    out(@2_c4[!_61], @2_x_184[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_x_187[@i_192], @2_ke_186[@i_192], @2_r2_185[@i_192]) && ((@2_m_178 = @2_r2_185[@i_192]) && (@2_kd_177 = @2_ke_186[@i_192])) then
    out(@2_c4[!_61], @2_x_187[@i_192])
  else
    new @2_r4_176: G;
    out(@2_c4[!_61], @2_r4_176)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_62], h0(x1, x2, x3, x4, x5))
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_87: host = cst_host in
  let x2_86: host = cst_host in
  let x3_85: G = cst_G in
  let x4_84: G = cst_G in
  let x5_83: G = cst_G in
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying simplify [Excluding set(dist 9->10, proba <= NS * NP / |exponent| + qE * NP / |exponent| + NU * NP / |exponent| + qD * NP / |exponent| + NP * NS / |exponent| + qE * NS / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G| + 0.5 * NS * NS / |exponent|)] yields

Game 10 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  let @2_m_190: G = Ystar_u in
  let @2_kd_189: passwd = pw in
  find [unique] @i_240 <= qD suchthat defined(@2_m_178[@i_240], @2_kd_177[@i_240], @2_r4_176[@i_240]) && ((@2_m_190 = @2_m_178[@i_240]) && (@2_kd_189 = @2_kd_177[@i_240])) then
  (
    let Y_u: G = @2_r4_176[@i_240] in
    let K_u: G = exp(Y_u, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(@2_m_190[@i_236], @2_r4_188[@i_236]) && (@2_m_190 = @2_m_190[@i_236]) then
  (
    let Y_u: G = @2_r4_188[@i_236] in
    let K_u: G = exp(Y_u, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke_180[@i_234], @2_x_181[@i_234]) && ((@2_m_190 = @2_r2_179[@i_234]) && (@2_kd_189 = @2_ke_180[@i_234])) then
  (
    let Y_u: G = @2_x_181[@i_234] in
    let K_u: G = exp(Y_u, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], @2_x_184[@i_233], yp[@i_233]) && (@2_m_190 = @2_r2_182[@i_233]) then
  (
    let Y_u: G = @2_x_184[@i_233] in
    let K_u: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], @2_x_187[@i_232], y[@i_232]) && (@2_m_190 = @2_r2_185[@i_232]) then
  (
    let Y_u: G = @2_x_187[@i_232] in
    let K_u: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  else
    new @2_r4_188: G;
    let Y_u: G = @2_r4_188 in
    let K_u: G = exp(Y_u, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_94, sk_u);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let @2_x_187: G = Y in
  let @2_ke_186: passwd = pw in
  new @2_r2_185: G;
  let Ystar: G = @2_r2_185 in
  out(c4[!_58], (S, Ystar));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      let @i_108 <= NU = j in
      if (auth_s = r1_94[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let @2_x_184: G = Yp in
  let @2_ke_183: passwd = pw in
  new @2_r2_182: G;
  let Ystarp: G = @2_r2_182 in
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_59], (U, Xp, S, Ystarp, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  let @2_x_181: G = @2_x in
  let @2_ke_180: passwd = @2_ke in
  find [unique] @i_210 <= qD suchthat defined(@2_r4_176[@i_210], @2_kd_177[@i_210], @2_m_178[@i_210]) && ((@2_x_181 = @2_r4_176[@i_210]) && (@2_ke_180 = @2_kd_177[@i_210])) then
    out(@2_c2[!_60], @2_m_178[@i_210])
  orfind @i_206 <= NU suchthat defined(@2_r4_188[@i_206], @2_kd_189[@i_206], @2_m_190[@i_206]) && ((@2_x_181 = @2_r4_188[@i_206]) && (@2_ke_180 = @2_kd_189[@i_206])) then
    out(@2_c2[!_60], @2_m_190[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x_181[@i_204], @2_ke_180[@i_204], @2_r2_179[@i_204]) && ((@2_x_181 = @2_x_181[@i_204]) && (@2_ke_180 = @2_ke_180[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(@2_x_184[@i_203], @2_ke_183[@i_203], @2_r2_182[@i_203]) && ((@2_x_181 = @2_x_184[@i_203]) && (@2_ke_180 = @2_ke_183[@i_203])) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(@2_x_187[@i_202], @2_ke_186[@i_202], @2_r2_185[@i_202]) && ((@2_x_181 = @2_x_187[@i_202]) && (@2_ke_180 = @2_ke_186[@i_202])) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  let @2_m_178: G = @2_m in
  let @2_kd_177: passwd = @2_kd in
  find [unique] @i_200 <= qD suchthat defined(@2_m_178[@i_200], @2_kd_177[@i_200], @2_r4_176[@i_200]) && ((@2_m_178 = @2_m_178[@i_200]) && (@2_kd_177 = @2_kd_177[@i_200])) then
    out(@2_c4[!_61], @2_r4_176[@i_200])
  orfind @i_196 <= NU suchthat defined(@2_m_190[@i_196], @2_kd_189[@i_196], @2_r4_188[@i_196]) && ((@2_m_178 = @2_m_190[@i_196]) && (@2_kd_177 = @2_kd_189[@i_196])) then
    out(@2_c4[!_61], @2_r4_188[@i_196])
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke_180[@i_194], @2_x_181[@i_194]) && ((@2_m_178 = @2_r2_179[@i_194]) && (@2_kd_177 = @2_ke_180[@i_194])) then
    out(@2_c4[!_61], @2_x_181[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], @2_ke_183[@i_193], @2_x_184[@i_193]) && ((@2_m_178 = @2_r2_182[@i_193]) && (@2_kd_177 = @2_ke_183[@i_193])) then
    out(@2_c4[!_61], @2_x_184[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], @2_ke_186[@i_192], @2_x_187[@i_192]) && ((@2_m_178 = @2_r2_185[@i_192]) && (@2_kd_177 = @2_ke_186[@i_192])) then
    out(@2_c4[!_61], @2_x_187[@i_192])
  else
    new @2_r4_176: G;
    out(@2_c4[!_61], @2_r4_176)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_62], h0(x1, x2, x3, x4, x5))
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_87: host = cst_host in
  let x2_86: host = cst_host in
  let x3_85: G = cst_G in
  let x4_84: G = cst_G in
  let x5_83: G = cst_G in
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying move all binders yields

Game 11 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  let @2_m_190: G = Ystar_u in
  let @2_kd_189: passwd = pw in
  find [unique] @i_240 <= qD suchthat defined(@2_m_178[@i_240], @2_kd_177[@i_240], @2_r4_176[@i_240]) && ((@2_m_190 = @2_m_178[@i_240]) && (@2_kd_189 = @2_kd_177[@i_240])) then
  (
    let Y_u: G = @2_r4_176[@i_240] in
    let K_u: G = exp(Y_u, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(@2_m_190[@i_236], @2_r4_188[@i_236]) && (@2_m_190 = @2_m_190[@i_236]) then
  (
    let Y_u: G = @2_r4_188[@i_236] in
    let K_u: G = exp(Y_u, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke_180[@i_234], @2_x_181[@i_234]) && ((@2_m_190 = @2_r2_179[@i_234]) && (@2_kd_189 = @2_ke_180[@i_234])) then
  (
    let Y_u: G = @2_x_181[@i_234] in
    let K_u: G = exp(Y_u, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], @2_x_184[@i_233], yp[@i_233]) && (@2_m_190 = @2_r2_182[@i_233]) then
  (
    let Y_u: G = @2_x_184[@i_233] in
    let K_u: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], @2_x_187[@i_232], y[@i_232]) && (@2_m_190 = @2_r2_185[@i_232]) then
  (
    let Y_u: G = @2_x_187[@i_232] in
    let K_u: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  else
    new @2_r4_188: G;
    let Y_u: G = @2_r4_188 in
    let K_u: G = exp(Y_u, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_94, sk_u);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let @2_x_187: G = Y in
  let @2_ke_186: passwd = pw in
  new @2_r2_185: G;
  let Ystar: G = @2_r2_185 in
  out(c4[!_58], (S, Ystar));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_94[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let @2_x_184: G = Yp in
  let @2_ke_183: passwd = pw in
  new @2_r2_182: G;
  let Ystarp: G = @2_r2_182 in
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_59], (U, Xp, S, Ystarp, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  let @2_x_181: G = @2_x in
  let @2_ke_180: passwd = @2_ke in
  find [unique] @i_210 <= qD suchthat defined(@2_r4_176[@i_210], @2_kd_177[@i_210], @2_m_178[@i_210]) && ((@2_x_181 = @2_r4_176[@i_210]) && (@2_ke_180 = @2_kd_177[@i_210])) then
    out(@2_c2[!_60], @2_m_178[@i_210])
  orfind @i_206 <= NU suchthat defined(@2_r4_188[@i_206], @2_kd_189[@i_206], @2_m_190[@i_206]) && ((@2_x_181 = @2_r4_188[@i_206]) && (@2_ke_180 = @2_kd_189[@i_206])) then
    out(@2_c2[!_60], @2_m_190[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x_181[@i_204], @2_ke_180[@i_204], @2_r2_179[@i_204]) && ((@2_x_181 = @2_x_181[@i_204]) && (@2_ke_180 = @2_ke_180[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(@2_x_184[@i_203], @2_ke_183[@i_203], @2_r2_182[@i_203]) && ((@2_x_181 = @2_x_184[@i_203]) && (@2_ke_180 = @2_ke_183[@i_203])) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(@2_x_187[@i_202], @2_ke_186[@i_202], @2_r2_185[@i_202]) && ((@2_x_181 = @2_x_187[@i_202]) && (@2_ke_180 = @2_ke_186[@i_202])) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  let @2_m_178: G = @2_m in
  let @2_kd_177: passwd = @2_kd in
  find [unique] @i_200 <= qD suchthat defined(@2_m_178[@i_200], @2_kd_177[@i_200], @2_r4_176[@i_200]) && ((@2_m_178 = @2_m_178[@i_200]) && (@2_kd_177 = @2_kd_177[@i_200])) then
    out(@2_c4[!_61], @2_r4_176[@i_200])
  orfind @i_196 <= NU suchthat defined(@2_m_190[@i_196], @2_kd_189[@i_196], @2_r4_188[@i_196]) && ((@2_m_178 = @2_m_190[@i_196]) && (@2_kd_177 = @2_kd_189[@i_196])) then
    out(@2_c4[!_61], @2_r4_188[@i_196])
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke_180[@i_194], @2_x_181[@i_194]) && ((@2_m_178 = @2_r2_179[@i_194]) && (@2_kd_177 = @2_ke_180[@i_194])) then
    out(@2_c4[!_61], @2_x_181[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], @2_ke_183[@i_193], @2_x_184[@i_193]) && ((@2_m_178 = @2_r2_182[@i_193]) && (@2_kd_177 = @2_ke_183[@i_193])) then
    out(@2_c4[!_61], @2_x_184[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], @2_ke_186[@i_192], @2_x_187[@i_192]) && ((@2_m_178 = @2_r2_185[@i_192]) && (@2_kd_177 = @2_ke_186[@i_192])) then
    out(@2_c4[!_61], @2_x_187[@i_192])
  else
    new @2_r4_176: G;
    out(@2_c4[!_61], @2_r4_176)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_62], h0(x1, x2, x3, x4, x5))
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of useless yields

Game 12 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  let @2_m_190: G = cst_G in
  let @2_kd_189: passwd = cst_passwd in
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @2_kd_177[@i_240], @2_m_178[@i_240], @2_r4_176[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = @2_r4_176[@i_240] in
    let K_u: G = exp(@2_r4_176[@i_240], x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@2_r4_176[@i_240] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, @2_r4_176[@i_240], K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, @2_r4_176[@i_240], K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @2_m_190[@i_236], @2_r4_188[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = @2_r4_188[@i_236] in
    let K_u: G = exp(@2_r4_188[@i_236], x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@2_r4_188[@i_236] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, @2_r4_188[@i_236], K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, @2_r4_188[@i_236], K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_ke[@i_234], @2_x[@i_234], @2_x_181[@i_234], @2_ke_180[@i_234], @2_r2_179[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
  (
    let Y_u: G = @2_x[@i_234] in
    let K_u: G = exp(@2_x[@i_234], x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@2_x[@i_234] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, @2_x[@i_234], K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, @2_x[@i_234], K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_233 <= NP suchthat defined(Yp[@i_233], xp[@i_233], @2_r2_182[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Yp[@i_233], K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Yp[@i_233], K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(Y[@i_232], y[@i_232], @2_r2_185[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y[@i_232], K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y[@i_232], K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  else
    new @2_r4_188: G;
    let Y_u: G = @2_r4_188 in
    let K_u: G = exp(@2_r4_188, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let sk_u: hash0 = h0(U, S, X, @2_r4_188, K_u) in
    event termU(U, X, S, Ystar_u, r1_94, sk_u);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_94[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  let @2_x_181: G = cst_G in
  let @2_ke_180: passwd = cst_passwd in
  find [unique] @i_210 <= qD suchthat defined(@2_kd[@i_210], @2_m[@i_210], @2_m_178[@i_210], @2_kd_177[@i_210], @2_r4_176[@i_210]) && ((@2_x = @2_r4_176[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(pw, Ystar_u[@i_206], @2_m_190[@i_206], @2_kd_189[@i_206], @2_r4_188[@i_206]) && ((@2_x = @2_r4_188[@i_206]) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_ke_180[@i_204], @2_x_181[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], pw, xp[@i_203], xp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], pw, y[@i_202], y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  let @2_m_178: G = cst_G in
  let @2_kd_177: passwd = cst_passwd in
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @2_kd_177[@i_200], @2_m_178[@i_200], @2_r4_176[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @2_r4_176[@i_200])
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], pw, @2_kd_189[@i_196], @2_m_190[@i_196], @2_r4_188[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @2_r4_188[@i_196])
  orfind @i_194 <= qE suchthat defined(@2_ke[@i_194], @2_x[@i_194], @2_x_181[@i_194], @2_ke_180[@i_194], @2_r2_179[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(pw, Yp[@i_193], xp[@i_193], xp[@i_193], @2_r2_182[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(pw, Y[@i_192], y[@i_192], y[@i_192], @2_r2_185[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @2_r4_176: G;
    out(@2_c4[!_61], @2_r4_176)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_62], h0(x1, x2, x3, x4, x5))
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying insert event Encryptt at occurrence 1243 [Excluding set(event Encryptt in game 13)] yields

Game 13 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  let @2_m_190: G = cst_G in
  let @2_kd_189: passwd = cst_passwd in
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @2_kd_177[@i_240], @2_m_178[@i_240], @2_r4_176[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = @2_r4_176[@i_240] in
    let K_u: G = exp(@2_r4_176[@i_240], x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@2_r4_176[@i_240] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, @2_r4_176[@i_240], K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, @2_r4_176[@i_240], K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @2_m_190[@i_236], @2_r4_188[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = @2_r4_188[@i_236] in
    let K_u: G = exp(@2_r4_188[@i_236], x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@2_r4_188[@i_236] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, @2_r4_188[@i_236], K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, @2_r4_188[@i_236], K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_ke[@i_234], @2_x[@i_234], @2_x_181[@i_234], @2_ke_180[@i_234], @2_r2_179[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(Yp[@i_233], xp[@i_233], @2_r2_182[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Yp[@i_233], K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Yp[@i_233], K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(Y[@i_232], y[@i_232], @2_r2_185[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y[@i_232], K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y[@i_232], K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  else
    new @2_r4_188: G;
    let Y_u: G = @2_r4_188 in
    let K_u: G = exp(@2_r4_188, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let sk_u: hash0 = h0(U, S, X, @2_r4_188, K_u) in
    event termU(U, X, S, Ystar_u, r1_94, sk_u);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_94[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  let @2_x_181: G = cst_G in
  let @2_ke_180: passwd = cst_passwd in
  find [unique] @i_210 <= qD suchthat defined(@2_kd[@i_210], @2_m[@i_210], @2_m_178[@i_210], @2_kd_177[@i_210], @2_r4_176[@i_210]) && ((@2_x = @2_r4_176[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(pw, Ystar_u[@i_206], @2_m_190[@i_206], @2_kd_189[@i_206], @2_r4_188[@i_206]) && ((@2_x = @2_r4_188[@i_206]) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_ke_180[@i_204], @2_x_181[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], pw, xp[@i_203], xp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], pw, y[@i_202], y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  let @2_m_178: G = cst_G in
  let @2_kd_177: passwd = cst_passwd in
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @2_kd_177[@i_200], @2_m_178[@i_200], @2_r4_176[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @2_r4_176[@i_200])
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], pw, @2_kd_189[@i_196], @2_m_190[@i_196], @2_r4_188[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @2_r4_188[@i_196])
  orfind @i_194 <= qE suchthat defined(@2_ke[@i_194], @2_x[@i_194], @2_x_181[@i_194], @2_ke_180[@i_194], @2_r2_179[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(pw, Yp[@i_193], xp[@i_193], xp[@i_193], @2_r2_182[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(pw, Y[@i_192], y[@i_192], y[@i_192], @2_r2_185[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @2_r4_176: G;
    out(@2_c4[!_61], @2_r4_176)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_62], h0(x1, x2, x3, x4, x5))
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all], ! !_38 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash0) -> (r' = h0(x1', x2', x3', x4', x5')) [all]
<=(set(proba <= Neq / |hash0|))=>
      ! !_39 <= N (x1_77: host, x2_76: host, x3_75: G, x4_74: G, x5_73: G) -> let x1: host = x1_77 in let x2: host = x2_76 in let x3: G = x3_75 in let x4: G = x4_74 in let x5: G = x5_73 in find [unique] j_41 <= N suchthat defined(x1[j_41], x2[j_41], x3[j_41], x4[j_41], x5[j_41], r[j_41]) && ((x1 = x1[j_41]) && ((x2 = x2[j_41]) && ((x3 = x3[j_41]) && ((x4 = x4[j_41]) && (x5 = x5[j_41]))))) then r[j_41] else new r: hash0; r, ! !_40 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash0) -> find [unique] j_42 <= N suchthat defined(x1[j_42], x2[j_42], x3[j_42], x4[j_42], x5[j_42], r[j_42]) && ((x1' = x1[j_42]) && ((x2' = x2[j_42]) && ((x3' = x3[j_42]) && ((x4' = x4[j_42]) && (x5' = x5[j_42]))))) then (r' = r[j_42]) else false
 yields

Game 14 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  let @2_m_190: G = cst_G in
  let @2_kd_189: passwd = cst_passwd in
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @2_kd_177[@i_240], @2_m_178[@i_240], @2_r4_176[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = @2_r4_176[@i_240] in
    let K_u: G = exp(@2_r4_176[@i_240], x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@2_r4_176[@i_240] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      let x3_377: G = X in
      let x4_376: G = @2_r4_176[@i_240] in
      let x5_375: G = K_u in
      find [unique] @i_506 <= qH0 suchthat defined(x1_343[@i_506], x2_342[@i_506], x3_341[@i_506], x4_340[@i_506], x5_339[@i_506], r_338[@i_506]) && ((x1_379 = x1_343[@i_506]) && ((x2_378 = x2_342[@i_506]) && ((x3_377 = x3_341[@i_506]) && ((x4_376 = x4_340[@i_506]) && (x5_375 = x5_339[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_505 <= NP suchthat defined(x1_349[@i_505], x2_348[@i_505], x3_347[@i_505], x4_346[@i_505], x5_345[@i_505], r_344[@i_505]) && ((x1_379 = x1_349[@i_505]) && ((x2_378 = x2_348[@i_505]) && ((x3_377 = x3_347[@i_505]) && ((x4_376 = x4_346[@i_505]) && (x5_375 = x5_345[@i_505]))))) then
      (
        let sk_u: hash0 = r_344[@i_505] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_504 <= NS suchthat defined(x1_355[@i_504], x2_354[@i_504], x3_353[@i_504], x4_352[@i_504], x5_351[@i_504], r_350[@i_504]) && ((x1_379 = x1_355[@i_504]) && ((x2_378 = x2_354[@i_504]) && ((x3_377 = x3_353[@i_504]) && ((x4_376 = x4_352[@i_504]) && (x5_375 = x5_351[@i_504]))))) then
      (
        let sk_u: hash0 = r_350[@i_504] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_503 <= NS suchthat defined(x1_361[@i_503], x2_360[@i_503], x3_359[@i_503], x4_358[@i_503], x5_357[@i_503], r_356[@i_503]) && ((x1_379 = x1_361[@i_503]) && ((x2_378 = x2_360[@i_503]) && ((x3_377 = x3_359[@i_503]) && ((x4_376 = x4_358[@i_503]) && (x5_375 = x5_357[@i_503]))))) then
      (
        let sk_u: hash0 = r_356[@i_503] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_502 <= NU suchthat defined(x1_367[@i_502], x2_366[@i_502], x3_365[@i_502], x4_364[@i_502], x5_363[@i_502], r_362[@i_502]) && ((x1_379 = x1_367[@i_502]) && ((x2_378 = x2_366[@i_502]) && ((x3_377 = x3_365[@i_502]) && ((x4_376 = x4_364[@i_502]) && (x5_375 = x5_363[@i_502]))))) then
      (
        let sk_u: hash0 = r_362[@i_502] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_501 <= NU suchthat defined(x1_373[@i_501], x2_372[@i_501], x3_371[@i_501], x4_370[@i_501], x5_369[@i_501], r_368[@i_501]) && ((x1_379 = x1_373[@i_501]) && ((x2_378 = x2_372[@i_501]) && ((x3_377 = x3_371[@i_501]) && ((x4_376 = x4_370[@i_501]) && (x5_375 = x5_369[@i_501]))))) then
      (
        let sk_u: hash0 = r_368[@i_501] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_500 <= NU suchthat defined(x1_379[@i_500], x2_378[@i_500], x3_377[@i_500], x4_376[@i_500], x5_375[@i_500], r_374[@i_500]) && ((x1_379 = x1_379[@i_500]) && ((x2_378 = x2_378[@i_500]) && ((x3_377 = x3_377[@i_500]) && ((x4_376 = x4_376[@i_500]) && (x5_375 = x5_375[@i_500]))))) then
      (
        let sk_u: hash0 = r_374[@i_500] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_499 <= NU suchthat defined(x1_385[@i_499], x2_384[@i_499], x3_383[@i_499], x4_382[@i_499], x5_381[@i_499], r_380[@i_499]) && ((x1_379 = x1_385[@i_499]) && ((x2_378 = x2_384[@i_499]) && ((x3_377 = x3_383[@i_499]) && ((x4_376 = x4_382[@i_499]) && (x5_375 = x5_381[@i_499]))))) then
      (
        let sk_u: hash0 = r_380[@i_499] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_498 <= NU suchthat defined(x1_391[@i_498], x2_390[@i_498], x3_389[@i_498], x4_388[@i_498], x5_387[@i_498], r_386[@i_498]) && ((x1_379 = x1_391[@i_498]) && ((x2_378 = x2_390[@i_498]) && ((x3_377 = x3_389[@i_498]) && ((x4_376 = x4_388[@i_498]) && (x5_375 = x5_387[@i_498]))))) then
      (
        let sk_u: hash0 = r_386[@i_498] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_497 <= NU suchthat defined(x1_397[@i_497], x2_396[@i_497], x3_395[@i_497], x4_394[@i_497], x5_393[@i_497], r_392[@i_497]) && ((x1_379 = x1_397[@i_497]) && ((x2_378 = x2_396[@i_497]) && ((x3_377 = x3_395[@i_497]) && ((x4_376 = x4_394[@i_497]) && (x5_375 = x5_393[@i_497]))))) then
      (
        let sk_u: hash0 = r_392[@i_497] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_496 <= NU suchthat defined(x1_403[@i_496], x2_402[@i_496], x3_401[@i_496], x4_400[@i_496], x5_399[@i_496], r_398[@i_496]) && ((x1_379 = x1_403[@i_496]) && ((x2_378 = x2_402[@i_496]) && ((x3_377 = x3_401[@i_496]) && ((x4_376 = x4_400[@i_496]) && (x5_375 = x5_399[@i_496]))))) then
      (
        let sk_u: hash0 = r_398[@i_496] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_495 <= NU suchthat defined(x1_409[@i_495], x2_408[@i_495], x3_407[@i_495], x4_406[@i_495], x5_405[@i_495], r_404[@i_495]) && ((x1_379 = x1_409[@i_495]) && ((x2_378 = x2_408[@i_495]) && ((x3_377 = x3_407[@i_495]) && ((x4_376 = x4_406[@i_495]) && (x5_375 = x5_405[@i_495]))))) then
      (
        let sk_u: hash0 = r_404[@i_495] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_494 <= NU suchthat defined(x1_415[@i_494], x2_414[@i_494], x3_413[@i_494], x4_412[@i_494], x5_411[@i_494], r_410[@i_494]) && ((x1_379 = x1_415[@i_494]) && ((x2_378 = x2_414[@i_494]) && ((x3_377 = x3_413[@i_494]) && ((x4_376 = x4_412[@i_494]) && (x5_375 = x5_411[@i_494]))))) then
      (
        let sk_u: hash0 = r_410[@i_494] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let x1_373: host = U in
      let x2_372: host = S in
      let x3_371: G = X in
      let x4_370: G = @2_r4_176[@i_240] in
      let x5_369: G = K_u in
      find [unique] @i_493 <= qH0 suchthat defined(x1_343[@i_493], x2_342[@i_493], x3_341[@i_493], x4_340[@i_493], x5_339[@i_493], r_338[@i_493]) && ((x1_373 = x1_343[@i_493]) && ((x2_372 = x2_342[@i_493]) && ((x3_371 = x3_341[@i_493]) && ((x4_370 = x4_340[@i_493]) && (x5_369 = x5_339[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_492 <= NP suchthat defined(x1_349[@i_492], x2_348[@i_492], x3_347[@i_492], x4_346[@i_492], x5_345[@i_492], r_344[@i_492]) && ((x1_373 = x1_349[@i_492]) && ((x2_372 = x2_348[@i_492]) && ((x3_371 = x3_347[@i_492]) && ((x4_370 = x4_346[@i_492]) && (x5_369 = x5_345[@i_492]))))) then
      (
        let sk_u: hash0 = r_344[@i_492] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_491 <= NS suchthat defined(x1_355[@i_491], x2_354[@i_491], x3_353[@i_491], x4_352[@i_491], x5_351[@i_491], r_350[@i_491]) && ((x1_373 = x1_355[@i_491]) && ((x2_372 = x2_354[@i_491]) && ((x3_371 = x3_353[@i_491]) && ((x4_370 = x4_352[@i_491]) && (x5_369 = x5_351[@i_491]))))) then
      (
        let sk_u: hash0 = r_350[@i_491] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_490 <= NS suchthat defined(x1_361[@i_490], x2_360[@i_490], x3_359[@i_490], x4_358[@i_490], x5_357[@i_490], r_356[@i_490]) && ((x1_373 = x1_361[@i_490]) && ((x2_372 = x2_360[@i_490]) && ((x3_371 = x3_359[@i_490]) && ((x4_370 = x4_358[@i_490]) && (x5_369 = x5_357[@i_490]))))) then
      (
        let sk_u: hash0 = r_356[@i_490] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_489 <= NU suchthat defined(x1_367[@i_489], x2_366[@i_489], x3_365[@i_489], x4_364[@i_489], x5_363[@i_489], r_362[@i_489]) && ((x1_373 = x1_367[@i_489]) && ((x2_372 = x2_366[@i_489]) && ((x3_371 = x3_365[@i_489]) && ((x4_370 = x4_364[@i_489]) && (x5_369 = x5_363[@i_489]))))) then
      (
        let sk_u: hash0 = r_362[@i_489] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_488 <= NU suchthat defined(x1_373[@i_488], x2_372[@i_488], x3_371[@i_488], x4_370[@i_488], x5_369[@i_488], r_368[@i_488]) && ((x1_373 = x1_373[@i_488]) && ((x2_372 = x2_372[@i_488]) && ((x3_371 = x3_371[@i_488]) && ((x4_370 = x4_370[@i_488]) && (x5_369 = x5_369[@i_488]))))) then
      (
        let sk_u: hash0 = r_368[@i_488] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_487 <= NU suchthat defined(x1_379[@i_487], x2_378[@i_487], x3_377[@i_487], x4_376[@i_487], x5_375[@i_487], r_374[@i_487]) && ((x1_373 = x1_379[@i_487]) && ((x2_372 = x2_378[@i_487]) && ((x3_371 = x3_377[@i_487]) && ((x4_370 = x4_376[@i_487]) && (x5_369 = x5_375[@i_487]))))) then
      (
        let sk_u: hash0 = r_374[@i_487] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_486 <= NU suchthat defined(x1_385[@i_486], x2_384[@i_486], x3_383[@i_486], x4_382[@i_486], x5_381[@i_486], r_380[@i_486]) && ((x1_373 = x1_385[@i_486]) && ((x2_372 = x2_384[@i_486]) && ((x3_371 = x3_383[@i_486]) && ((x4_370 = x4_382[@i_486]) && (x5_369 = x5_381[@i_486]))))) then
      (
        let sk_u: hash0 = r_380[@i_486] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_485 <= NU suchthat defined(x1_391[@i_485], x2_390[@i_485], x3_389[@i_485], x4_388[@i_485], x5_387[@i_485], r_386[@i_485]) && ((x1_373 = x1_391[@i_485]) && ((x2_372 = x2_390[@i_485]) && ((x3_371 = x3_389[@i_485]) && ((x4_370 = x4_388[@i_485]) && (x5_369 = x5_387[@i_485]))))) then
      (
        let sk_u: hash0 = r_386[@i_485] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_484 <= NU suchthat defined(x1_397[@i_484], x2_396[@i_484], x3_395[@i_484], x4_394[@i_484], x5_393[@i_484], r_392[@i_484]) && ((x1_373 = x1_397[@i_484]) && ((x2_372 = x2_396[@i_484]) && ((x3_371 = x3_395[@i_484]) && ((x4_370 = x4_394[@i_484]) && (x5_369 = x5_393[@i_484]))))) then
      (
        let sk_u: hash0 = r_392[@i_484] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_483 <= NU suchthat defined(x1_403[@i_483], x2_402[@i_483], x3_401[@i_483], x4_400[@i_483], x5_399[@i_483], r_398[@i_483]) && ((x1_373 = x1_403[@i_483]) && ((x2_372 = x2_402[@i_483]) && ((x3_371 = x3_401[@i_483]) && ((x4_370 = x4_400[@i_483]) && (x5_369 = x5_399[@i_483]))))) then
      (
        let sk_u: hash0 = r_398[@i_483] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_482 <= NU suchthat defined(x1_409[@i_482], x2_408[@i_482], x3_407[@i_482], x4_406[@i_482], x5_405[@i_482], r_404[@i_482]) && ((x1_373 = x1_409[@i_482]) && ((x2_372 = x2_408[@i_482]) && ((x3_371 = x3_407[@i_482]) && ((x4_370 = x4_406[@i_482]) && (x5_369 = x5_405[@i_482]))))) then
      (
        let sk_u: hash0 = r_404[@i_482] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_481 <= NU suchthat defined(x1_415[@i_481], x2_414[@i_481], x3_413[@i_481], x4_412[@i_481], x5_411[@i_481], r_410[@i_481]) && ((x1_373 = x1_415[@i_481]) && ((x2_372 = x2_414[@i_481]) && ((x3_371 = x3_413[@i_481]) && ((x4_370 = x4_412[@i_481]) && (x5_369 = x5_411[@i_481]))))) then
      (
        let sk_u: hash0 = r_410[@i_481] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @2_m_190[@i_236], @2_r4_188[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = @2_r4_188[@i_236] in
    let K_u: G = exp(@2_r4_188[@i_236], x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@2_r4_188[@i_236] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      let x3_389: G = X in
      let x4_388: G = @2_r4_188[@i_236] in
      let x5_387: G = K_u in
      find [unique] @i_532 <= qH0 suchthat defined(x1_343[@i_532], x2_342[@i_532], x3_341[@i_532], x4_340[@i_532], x5_339[@i_532], r_338[@i_532]) && ((x1_391 = x1_343[@i_532]) && ((x2_390 = x2_342[@i_532]) && ((x3_389 = x3_341[@i_532]) && ((x4_388 = x4_340[@i_532]) && (x5_387 = x5_339[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_531 <= NP suchthat defined(x1_349[@i_531], x2_348[@i_531], x3_347[@i_531], x4_346[@i_531], x5_345[@i_531], r_344[@i_531]) && ((x1_391 = x1_349[@i_531]) && ((x2_390 = x2_348[@i_531]) && ((x3_389 = x3_347[@i_531]) && ((x4_388 = x4_346[@i_531]) && (x5_387 = x5_345[@i_531]))))) then
      (
        let sk_u: hash0 = r_344[@i_531] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_530 <= NS suchthat defined(x1_355[@i_530], x2_354[@i_530], x3_353[@i_530], x4_352[@i_530], x5_351[@i_530], r_350[@i_530]) && ((x1_391 = x1_355[@i_530]) && ((x2_390 = x2_354[@i_530]) && ((x3_389 = x3_353[@i_530]) && ((x4_388 = x4_352[@i_530]) && (x5_387 = x5_351[@i_530]))))) then
      (
        let sk_u: hash0 = r_350[@i_530] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_529 <= NS suchthat defined(x1_361[@i_529], x2_360[@i_529], x3_359[@i_529], x4_358[@i_529], x5_357[@i_529], r_356[@i_529]) && ((x1_391 = x1_361[@i_529]) && ((x2_390 = x2_360[@i_529]) && ((x3_389 = x3_359[@i_529]) && ((x4_388 = x4_358[@i_529]) && (x5_387 = x5_357[@i_529]))))) then
      (
        let sk_u: hash0 = r_356[@i_529] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_528 <= NU suchthat defined(x1_367[@i_528], x2_366[@i_528], x3_365[@i_528], x4_364[@i_528], x5_363[@i_528], r_362[@i_528]) && ((x1_391 = x1_367[@i_528]) && ((x2_390 = x2_366[@i_528]) && ((x3_389 = x3_365[@i_528]) && ((x4_388 = x4_364[@i_528]) && (x5_387 = x5_363[@i_528]))))) then
      (
        let sk_u: hash0 = r_362[@i_528] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_527 <= NU suchthat defined(x1_373[@i_527], x2_372[@i_527], x3_371[@i_527], x4_370[@i_527], x5_369[@i_527], r_368[@i_527]) && ((x1_391 = x1_373[@i_527]) && ((x2_390 = x2_372[@i_527]) && ((x3_389 = x3_371[@i_527]) && ((x4_388 = x4_370[@i_527]) && (x5_387 = x5_369[@i_527]))))) then
      (
        let sk_u: hash0 = r_368[@i_527] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_526 <= NU suchthat defined(x1_379[@i_526], x2_378[@i_526], x3_377[@i_526], x4_376[@i_526], x5_375[@i_526], r_374[@i_526]) && ((x1_391 = x1_379[@i_526]) && ((x2_390 = x2_378[@i_526]) && ((x3_389 = x3_377[@i_526]) && ((x4_388 = x4_376[@i_526]) && (x5_387 = x5_375[@i_526]))))) then
      (
        let sk_u: hash0 = r_374[@i_526] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_525 <= NU suchthat defined(x1_385[@i_525], x2_384[@i_525], x3_383[@i_525], x4_382[@i_525], x5_381[@i_525], r_380[@i_525]) && ((x1_391 = x1_385[@i_525]) && ((x2_390 = x2_384[@i_525]) && ((x3_389 = x3_383[@i_525]) && ((x4_388 = x4_382[@i_525]) && (x5_387 = x5_381[@i_525]))))) then
      (
        let sk_u: hash0 = r_380[@i_525] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_524 <= NU suchthat defined(x1_391[@i_524], x2_390[@i_524], x3_389[@i_524], x4_388[@i_524], x5_387[@i_524], r_386[@i_524]) && ((x1_391 = x1_391[@i_524]) && ((x2_390 = x2_390[@i_524]) && ((x3_389 = x3_389[@i_524]) && ((x4_388 = x4_388[@i_524]) && (x5_387 = x5_387[@i_524]))))) then
      (
        let sk_u: hash0 = r_386[@i_524] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_523 <= NU suchthat defined(x1_397[@i_523], x2_396[@i_523], x3_395[@i_523], x4_394[@i_523], x5_393[@i_523], r_392[@i_523]) && ((x1_391 = x1_397[@i_523]) && ((x2_390 = x2_396[@i_523]) && ((x3_389 = x3_395[@i_523]) && ((x4_388 = x4_394[@i_523]) && (x5_387 = x5_393[@i_523]))))) then
      (
        let sk_u: hash0 = r_392[@i_523] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_522 <= NU suchthat defined(x1_403[@i_522], x2_402[@i_522], x3_401[@i_522], x4_400[@i_522], x5_399[@i_522], r_398[@i_522]) && ((x1_391 = x1_403[@i_522]) && ((x2_390 = x2_402[@i_522]) && ((x3_389 = x3_401[@i_522]) && ((x4_388 = x4_400[@i_522]) && (x5_387 = x5_399[@i_522]))))) then
      (
        let sk_u: hash0 = r_398[@i_522] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_521 <= NU suchthat defined(x1_409[@i_521], x2_408[@i_521], x3_407[@i_521], x4_406[@i_521], x5_405[@i_521], r_404[@i_521]) && ((x1_391 = x1_409[@i_521]) && ((x2_390 = x2_408[@i_521]) && ((x3_389 = x3_407[@i_521]) && ((x4_388 = x4_406[@i_521]) && (x5_387 = x5_405[@i_521]))))) then
      (
        let sk_u: hash0 = r_404[@i_521] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_520 <= NU suchthat defined(x1_415[@i_520], x2_414[@i_520], x3_413[@i_520], x4_412[@i_520], x5_411[@i_520], r_410[@i_520]) && ((x1_391 = x1_415[@i_520]) && ((x2_390 = x2_414[@i_520]) && ((x3_389 = x3_413[@i_520]) && ((x4_388 = x4_412[@i_520]) && (x5_387 = x5_411[@i_520]))))) then
      (
        let sk_u: hash0 = r_410[@i_520] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let x1_385: host = U in
      let x2_384: host = S in
      let x3_383: G = X in
      let x4_382: G = @2_r4_188[@i_236] in
      let x5_381: G = K_u in
      find [unique] @i_519 <= qH0 suchthat defined(x1_343[@i_519], x2_342[@i_519], x3_341[@i_519], x4_340[@i_519], x5_339[@i_519], r_338[@i_519]) && ((x1_385 = x1_343[@i_519]) && ((x2_384 = x2_342[@i_519]) && ((x3_383 = x3_341[@i_519]) && ((x4_382 = x4_340[@i_519]) && (x5_381 = x5_339[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_518 <= NP suchthat defined(x1_349[@i_518], x2_348[@i_518], x3_347[@i_518], x4_346[@i_518], x5_345[@i_518], r_344[@i_518]) && ((x1_385 = x1_349[@i_518]) && ((x2_384 = x2_348[@i_518]) && ((x3_383 = x3_347[@i_518]) && ((x4_382 = x4_346[@i_518]) && (x5_381 = x5_345[@i_518]))))) then
      (
        let sk_u: hash0 = r_344[@i_518] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_517 <= NS suchthat defined(x1_355[@i_517], x2_354[@i_517], x3_353[@i_517], x4_352[@i_517], x5_351[@i_517], r_350[@i_517]) && ((x1_385 = x1_355[@i_517]) && ((x2_384 = x2_354[@i_517]) && ((x3_383 = x3_353[@i_517]) && ((x4_382 = x4_352[@i_517]) && (x5_381 = x5_351[@i_517]))))) then
      (
        let sk_u: hash0 = r_350[@i_517] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_516 <= NS suchthat defined(x1_361[@i_516], x2_360[@i_516], x3_359[@i_516], x4_358[@i_516], x5_357[@i_516], r_356[@i_516]) && ((x1_385 = x1_361[@i_516]) && ((x2_384 = x2_360[@i_516]) && ((x3_383 = x3_359[@i_516]) && ((x4_382 = x4_358[@i_516]) && (x5_381 = x5_357[@i_516]))))) then
      (
        let sk_u: hash0 = r_356[@i_516] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_515 <= NU suchthat defined(x1_367[@i_515], x2_366[@i_515], x3_365[@i_515], x4_364[@i_515], x5_363[@i_515], r_362[@i_515]) && ((x1_385 = x1_367[@i_515]) && ((x2_384 = x2_366[@i_515]) && ((x3_383 = x3_365[@i_515]) && ((x4_382 = x4_364[@i_515]) && (x5_381 = x5_363[@i_515]))))) then
      (
        let sk_u: hash0 = r_362[@i_515] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_514 <= NU suchthat defined(x1_373[@i_514], x2_372[@i_514], x3_371[@i_514], x4_370[@i_514], x5_369[@i_514], r_368[@i_514]) && ((x1_385 = x1_373[@i_514]) && ((x2_384 = x2_372[@i_514]) && ((x3_383 = x3_371[@i_514]) && ((x4_382 = x4_370[@i_514]) && (x5_381 = x5_369[@i_514]))))) then
      (
        let sk_u: hash0 = r_368[@i_514] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_513 <= NU suchthat defined(x1_379[@i_513], x2_378[@i_513], x3_377[@i_513], x4_376[@i_513], x5_375[@i_513], r_374[@i_513]) && ((x1_385 = x1_379[@i_513]) && ((x2_384 = x2_378[@i_513]) && ((x3_383 = x3_377[@i_513]) && ((x4_382 = x4_376[@i_513]) && (x5_381 = x5_375[@i_513]))))) then
      (
        let sk_u: hash0 = r_374[@i_513] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_512 <= NU suchthat defined(x1_385[@i_512], x2_384[@i_512], x3_383[@i_512], x4_382[@i_512], x5_381[@i_512], r_380[@i_512]) && ((x1_385 = x1_385[@i_512]) && ((x2_384 = x2_384[@i_512]) && ((x3_383 = x3_383[@i_512]) && ((x4_382 = x4_382[@i_512]) && (x5_381 = x5_381[@i_512]))))) then
      (
        let sk_u: hash0 = r_380[@i_512] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_511 <= NU suchthat defined(x1_391[@i_511], x2_390[@i_511], x3_389[@i_511], x4_388[@i_511], x5_387[@i_511], r_386[@i_511]) && ((x1_385 = x1_391[@i_511]) && ((x2_384 = x2_390[@i_511]) && ((x3_383 = x3_389[@i_511]) && ((x4_382 = x4_388[@i_511]) && (x5_381 = x5_387[@i_511]))))) then
      (
        let sk_u: hash0 = r_386[@i_511] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_510 <= NU suchthat defined(x1_397[@i_510], x2_396[@i_510], x3_395[@i_510], x4_394[@i_510], x5_393[@i_510], r_392[@i_510]) && ((x1_385 = x1_397[@i_510]) && ((x2_384 = x2_396[@i_510]) && ((x3_383 = x3_395[@i_510]) && ((x4_382 = x4_394[@i_510]) && (x5_381 = x5_393[@i_510]))))) then
      (
        let sk_u: hash0 = r_392[@i_510] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_509 <= NU suchthat defined(x1_403[@i_509], x2_402[@i_509], x3_401[@i_509], x4_400[@i_509], x5_399[@i_509], r_398[@i_509]) && ((x1_385 = x1_403[@i_509]) && ((x2_384 = x2_402[@i_509]) && ((x3_383 = x3_401[@i_509]) && ((x4_382 = x4_400[@i_509]) && (x5_381 = x5_399[@i_509]))))) then
      (
        let sk_u: hash0 = r_398[@i_509] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_508 <= NU suchthat defined(x1_409[@i_508], x2_408[@i_508], x3_407[@i_508], x4_406[@i_508], x5_405[@i_508], r_404[@i_508]) && ((x1_385 = x1_409[@i_508]) && ((x2_384 = x2_408[@i_508]) && ((x3_383 = x3_407[@i_508]) && ((x4_382 = x4_406[@i_508]) && (x5_381 = x5_405[@i_508]))))) then
      (
        let sk_u: hash0 = r_404[@i_508] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_507 <= NU suchthat defined(x1_415[@i_507], x2_414[@i_507], x3_413[@i_507], x4_412[@i_507], x5_411[@i_507], r_410[@i_507]) && ((x1_385 = x1_415[@i_507]) && ((x2_384 = x2_414[@i_507]) && ((x3_383 = x3_413[@i_507]) && ((x4_382 = x4_412[@i_507]) && (x5_381 = x5_411[@i_507]))))) then
      (
        let sk_u: hash0 = r_410[@i_507] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_ke[@i_234], @2_x[@i_234], @2_x_181[@i_234], @2_ke_180[@i_234], @2_r2_179[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(Yp[@i_233], xp[@i_233], @2_r2_182[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      let x3_401: G = X in
      let x4_400: G = Yp[@i_233] in
      let x5_399: G = K_u in
      find [unique] @i_558 <= qH0 suchthat defined(x1_343[@i_558], x2_342[@i_558], x3_341[@i_558], x4_340[@i_558], x5_339[@i_558], r_338[@i_558]) && ((x1_403 = x1_343[@i_558]) && ((x2_402 = x2_342[@i_558]) && ((x3_401 = x3_341[@i_558]) && ((x4_400 = x4_340[@i_558]) && (x5_399 = x5_339[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_557 <= NP suchthat defined(x1_349[@i_557], x2_348[@i_557], x3_347[@i_557], x4_346[@i_557], x5_345[@i_557], r_344[@i_557]) && ((x1_403 = x1_349[@i_557]) && ((x2_402 = x2_348[@i_557]) && ((x3_401 = x3_347[@i_557]) && ((x4_400 = x4_346[@i_557]) && (x5_399 = x5_345[@i_557]))))) then
      (
        let sk_u: hash0 = r_344[@i_557] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_556 <= NS suchthat defined(x1_355[@i_556], x2_354[@i_556], x3_353[@i_556], x4_352[@i_556], x5_351[@i_556], r_350[@i_556]) && ((x1_403 = x1_355[@i_556]) && ((x2_402 = x2_354[@i_556]) && ((x3_401 = x3_353[@i_556]) && ((x4_400 = x4_352[@i_556]) && (x5_399 = x5_351[@i_556]))))) then
      (
        let sk_u: hash0 = r_350[@i_556] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_555 <= NS suchthat defined(x1_361[@i_555], x2_360[@i_555], x3_359[@i_555], x4_358[@i_555], x5_357[@i_555], r_356[@i_555]) && ((x1_403 = x1_361[@i_555]) && ((x2_402 = x2_360[@i_555]) && ((x3_401 = x3_359[@i_555]) && ((x4_400 = x4_358[@i_555]) && (x5_399 = x5_357[@i_555]))))) then
      (
        let sk_u: hash0 = r_356[@i_555] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_554 <= NU suchthat defined(x1_367[@i_554], x2_366[@i_554], x3_365[@i_554], x4_364[@i_554], x5_363[@i_554], r_362[@i_554]) && ((x1_403 = x1_367[@i_554]) && ((x2_402 = x2_366[@i_554]) && ((x3_401 = x3_365[@i_554]) && ((x4_400 = x4_364[@i_554]) && (x5_399 = x5_363[@i_554]))))) then
      (
        let sk_u: hash0 = r_362[@i_554] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_553 <= NU suchthat defined(x1_373[@i_553], x2_372[@i_553], x3_371[@i_553], x4_370[@i_553], x5_369[@i_553], r_368[@i_553]) && ((x1_403 = x1_373[@i_553]) && ((x2_402 = x2_372[@i_553]) && ((x3_401 = x3_371[@i_553]) && ((x4_400 = x4_370[@i_553]) && (x5_399 = x5_369[@i_553]))))) then
      (
        let sk_u: hash0 = r_368[@i_553] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_552 <= NU suchthat defined(x1_379[@i_552], x2_378[@i_552], x3_377[@i_552], x4_376[@i_552], x5_375[@i_552], r_374[@i_552]) && ((x1_403 = x1_379[@i_552]) && ((x2_402 = x2_378[@i_552]) && ((x3_401 = x3_377[@i_552]) && ((x4_400 = x4_376[@i_552]) && (x5_399 = x5_375[@i_552]))))) then
      (
        let sk_u: hash0 = r_374[@i_552] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_551 <= NU suchthat defined(x1_385[@i_551], x2_384[@i_551], x3_383[@i_551], x4_382[@i_551], x5_381[@i_551], r_380[@i_551]) && ((x1_403 = x1_385[@i_551]) && ((x2_402 = x2_384[@i_551]) && ((x3_401 = x3_383[@i_551]) && ((x4_400 = x4_382[@i_551]) && (x5_399 = x5_381[@i_551]))))) then
      (
        let sk_u: hash0 = r_380[@i_551] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_550 <= NU suchthat defined(x1_391[@i_550], x2_390[@i_550], x3_389[@i_550], x4_388[@i_550], x5_387[@i_550], r_386[@i_550]) && ((x1_403 = x1_391[@i_550]) && ((x2_402 = x2_390[@i_550]) && ((x3_401 = x3_389[@i_550]) && ((x4_400 = x4_388[@i_550]) && (x5_399 = x5_387[@i_550]))))) then
      (
        let sk_u: hash0 = r_386[@i_550] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_549 <= NU suchthat defined(x1_397[@i_549], x2_396[@i_549], x3_395[@i_549], x4_394[@i_549], x5_393[@i_549], r_392[@i_549]) && ((x1_403 = x1_397[@i_549]) && ((x2_402 = x2_396[@i_549]) && ((x3_401 = x3_395[@i_549]) && ((x4_400 = x4_394[@i_549]) && (x5_399 = x5_393[@i_549]))))) then
      (
        let sk_u: hash0 = r_392[@i_549] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_548 <= NU suchthat defined(x1_403[@i_548], x2_402[@i_548], x3_401[@i_548], x4_400[@i_548], x5_399[@i_548], r_398[@i_548]) && ((x1_403 = x1_403[@i_548]) && ((x2_402 = x2_402[@i_548]) && ((x3_401 = x3_401[@i_548]) && ((x4_400 = x4_400[@i_548]) && (x5_399 = x5_399[@i_548]))))) then
      (
        let sk_u: hash0 = r_398[@i_548] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_547 <= NU suchthat defined(x1_409[@i_547], x2_408[@i_547], x3_407[@i_547], x4_406[@i_547], x5_405[@i_547], r_404[@i_547]) && ((x1_403 = x1_409[@i_547]) && ((x2_402 = x2_408[@i_547]) && ((x3_401 = x3_407[@i_547]) && ((x4_400 = x4_406[@i_547]) && (x5_399 = x5_405[@i_547]))))) then
      (
        let sk_u: hash0 = r_404[@i_547] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_546 <= NU suchthat defined(x1_415[@i_546], x2_414[@i_546], x3_413[@i_546], x4_412[@i_546], x5_411[@i_546], r_410[@i_546]) && ((x1_403 = x1_415[@i_546]) && ((x2_402 = x2_414[@i_546]) && ((x3_401 = x3_413[@i_546]) && ((x4_400 = x4_412[@i_546]) && (x5_399 = x5_411[@i_546]))))) then
      (
        let sk_u: hash0 = r_410[@i_546] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let x1_397: host = U in
      let x2_396: host = S in
      let x3_395: G = X in
      let x4_394: G = Yp[@i_233] in
      let x5_393: G = K_u in
      find [unique] @i_545 <= qH0 suchthat defined(x1_343[@i_545], x2_342[@i_545], x3_341[@i_545], x4_340[@i_545], x5_339[@i_545], r_338[@i_545]) && ((x1_397 = x1_343[@i_545]) && ((x2_396 = x2_342[@i_545]) && ((x3_395 = x3_341[@i_545]) && ((x4_394 = x4_340[@i_545]) && (x5_393 = x5_339[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_544 <= NP suchthat defined(x1_349[@i_544], x2_348[@i_544], x3_347[@i_544], x4_346[@i_544], x5_345[@i_544], r_344[@i_544]) && ((x1_397 = x1_349[@i_544]) && ((x2_396 = x2_348[@i_544]) && ((x3_395 = x3_347[@i_544]) && ((x4_394 = x4_346[@i_544]) && (x5_393 = x5_345[@i_544]))))) then
      (
        let sk_u: hash0 = r_344[@i_544] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_543 <= NS suchthat defined(x1_355[@i_543], x2_354[@i_543], x3_353[@i_543], x4_352[@i_543], x5_351[@i_543], r_350[@i_543]) && ((x1_397 = x1_355[@i_543]) && ((x2_396 = x2_354[@i_543]) && ((x3_395 = x3_353[@i_543]) && ((x4_394 = x4_352[@i_543]) && (x5_393 = x5_351[@i_543]))))) then
      (
        let sk_u: hash0 = r_350[@i_543] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_542 <= NS suchthat defined(x1_361[@i_542], x2_360[@i_542], x3_359[@i_542], x4_358[@i_542], x5_357[@i_542], r_356[@i_542]) && ((x1_397 = x1_361[@i_542]) && ((x2_396 = x2_360[@i_542]) && ((x3_395 = x3_359[@i_542]) && ((x4_394 = x4_358[@i_542]) && (x5_393 = x5_357[@i_542]))))) then
      (
        let sk_u: hash0 = r_356[@i_542] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_541 <= NU suchthat defined(x1_367[@i_541], x2_366[@i_541], x3_365[@i_541], x4_364[@i_541], x5_363[@i_541], r_362[@i_541]) && ((x1_397 = x1_367[@i_541]) && ((x2_396 = x2_366[@i_541]) && ((x3_395 = x3_365[@i_541]) && ((x4_394 = x4_364[@i_541]) && (x5_393 = x5_363[@i_541]))))) then
      (
        let sk_u: hash0 = r_362[@i_541] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_540 <= NU suchthat defined(x1_373[@i_540], x2_372[@i_540], x3_371[@i_540], x4_370[@i_540], x5_369[@i_540], r_368[@i_540]) && ((x1_397 = x1_373[@i_540]) && ((x2_396 = x2_372[@i_540]) && ((x3_395 = x3_371[@i_540]) && ((x4_394 = x4_370[@i_540]) && (x5_393 = x5_369[@i_540]))))) then
      (
        let sk_u: hash0 = r_368[@i_540] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_539 <= NU suchthat defined(x1_379[@i_539], x2_378[@i_539], x3_377[@i_539], x4_376[@i_539], x5_375[@i_539], r_374[@i_539]) && ((x1_397 = x1_379[@i_539]) && ((x2_396 = x2_378[@i_539]) && ((x3_395 = x3_377[@i_539]) && ((x4_394 = x4_376[@i_539]) && (x5_393 = x5_375[@i_539]))))) then
      (
        let sk_u: hash0 = r_374[@i_539] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_538 <= NU suchthat defined(x1_385[@i_538], x2_384[@i_538], x3_383[@i_538], x4_382[@i_538], x5_381[@i_538], r_380[@i_538]) && ((x1_397 = x1_385[@i_538]) && ((x2_396 = x2_384[@i_538]) && ((x3_395 = x3_383[@i_538]) && ((x4_394 = x4_382[@i_538]) && (x5_393 = x5_381[@i_538]))))) then
      (
        let sk_u: hash0 = r_380[@i_538] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_537 <= NU suchthat defined(x1_391[@i_537], x2_390[@i_537], x3_389[@i_537], x4_388[@i_537], x5_387[@i_537], r_386[@i_537]) && ((x1_397 = x1_391[@i_537]) && ((x2_396 = x2_390[@i_537]) && ((x3_395 = x3_389[@i_537]) && ((x4_394 = x4_388[@i_537]) && (x5_393 = x5_387[@i_537]))))) then
      (
        let sk_u: hash0 = r_386[@i_537] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_536 <= NU suchthat defined(x1_397[@i_536], x2_396[@i_536], x3_395[@i_536], x4_394[@i_536], x5_393[@i_536], r_392[@i_536]) && ((x1_397 = x1_397[@i_536]) && ((x2_396 = x2_396[@i_536]) && ((x3_395 = x3_395[@i_536]) && ((x4_394 = x4_394[@i_536]) && (x5_393 = x5_393[@i_536]))))) then
      (
        let sk_u: hash0 = r_392[@i_536] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_535 <= NU suchthat defined(x1_403[@i_535], x2_402[@i_535], x3_401[@i_535], x4_400[@i_535], x5_399[@i_535], r_398[@i_535]) && ((x1_397 = x1_403[@i_535]) && ((x2_396 = x2_402[@i_535]) && ((x3_395 = x3_401[@i_535]) && ((x4_394 = x4_400[@i_535]) && (x5_393 = x5_399[@i_535]))))) then
      (
        let sk_u: hash0 = r_398[@i_535] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_534 <= NU suchthat defined(x1_409[@i_534], x2_408[@i_534], x3_407[@i_534], x4_406[@i_534], x5_405[@i_534], r_404[@i_534]) && ((x1_397 = x1_409[@i_534]) && ((x2_396 = x2_408[@i_534]) && ((x3_395 = x3_407[@i_534]) && ((x4_394 = x4_406[@i_534]) && (x5_393 = x5_405[@i_534]))))) then
      (
        let sk_u: hash0 = r_404[@i_534] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_533 <= NU suchthat defined(x1_415[@i_533], x2_414[@i_533], x3_413[@i_533], x4_412[@i_533], x5_411[@i_533], r_410[@i_533]) && ((x1_397 = x1_415[@i_533]) && ((x2_396 = x2_414[@i_533]) && ((x3_395 = x3_413[@i_533]) && ((x4_394 = x4_412[@i_533]) && (x5_393 = x5_411[@i_533]))))) then
      (
        let sk_u: hash0 = r_410[@i_533] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(Y[@i_232], y[@i_232], @2_r2_185[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      let x3_413: G = X in
      let x4_412: G = Y[@i_232] in
      let x5_411: G = K_u in
      find [unique] @i_584 <= qH0 suchthat defined(x1_343[@i_584], x2_342[@i_584], x3_341[@i_584], x4_340[@i_584], x5_339[@i_584], r_338[@i_584]) && ((x1_415 = x1_343[@i_584]) && ((x2_414 = x2_342[@i_584]) && ((x3_413 = x3_341[@i_584]) && ((x4_412 = x4_340[@i_584]) && (x5_411 = x5_339[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_583 <= NP suchthat defined(x1_349[@i_583], x2_348[@i_583], x3_347[@i_583], x4_346[@i_583], x5_345[@i_583], r_344[@i_583]) && ((x1_415 = x1_349[@i_583]) && ((x2_414 = x2_348[@i_583]) && ((x3_413 = x3_347[@i_583]) && ((x4_412 = x4_346[@i_583]) && (x5_411 = x5_345[@i_583]))))) then
      (
        let sk_u: hash0 = r_344[@i_583] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_582 <= NS suchthat defined(x1_355[@i_582], x2_354[@i_582], x3_353[@i_582], x4_352[@i_582], x5_351[@i_582], r_350[@i_582]) && ((x1_415 = x1_355[@i_582]) && ((x2_414 = x2_354[@i_582]) && ((x3_413 = x3_353[@i_582]) && ((x4_412 = x4_352[@i_582]) && (x5_411 = x5_351[@i_582]))))) then
      (
        let sk_u: hash0 = r_350[@i_582] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_581 <= NS suchthat defined(x1_361[@i_581], x2_360[@i_581], x3_359[@i_581], x4_358[@i_581], x5_357[@i_581], r_356[@i_581]) && ((x1_415 = x1_361[@i_581]) && ((x2_414 = x2_360[@i_581]) && ((x3_413 = x3_359[@i_581]) && ((x4_412 = x4_358[@i_581]) && (x5_411 = x5_357[@i_581]))))) then
      (
        let sk_u: hash0 = r_356[@i_581] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_580 <= NU suchthat defined(x1_367[@i_580], x2_366[@i_580], x3_365[@i_580], x4_364[@i_580], x5_363[@i_580], r_362[@i_580]) && ((x1_415 = x1_367[@i_580]) && ((x2_414 = x2_366[@i_580]) && ((x3_413 = x3_365[@i_580]) && ((x4_412 = x4_364[@i_580]) && (x5_411 = x5_363[@i_580]))))) then
      (
        let sk_u: hash0 = r_362[@i_580] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_579 <= NU suchthat defined(x1_373[@i_579], x2_372[@i_579], x3_371[@i_579], x4_370[@i_579], x5_369[@i_579], r_368[@i_579]) && ((x1_415 = x1_373[@i_579]) && ((x2_414 = x2_372[@i_579]) && ((x3_413 = x3_371[@i_579]) && ((x4_412 = x4_370[@i_579]) && (x5_411 = x5_369[@i_579]))))) then
      (
        let sk_u: hash0 = r_368[@i_579] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_578 <= NU suchthat defined(x1_379[@i_578], x2_378[@i_578], x3_377[@i_578], x4_376[@i_578], x5_375[@i_578], r_374[@i_578]) && ((x1_415 = x1_379[@i_578]) && ((x2_414 = x2_378[@i_578]) && ((x3_413 = x3_377[@i_578]) && ((x4_412 = x4_376[@i_578]) && (x5_411 = x5_375[@i_578]))))) then
      (
        let sk_u: hash0 = r_374[@i_578] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_577 <= NU suchthat defined(x1_385[@i_577], x2_384[@i_577], x3_383[@i_577], x4_382[@i_577], x5_381[@i_577], r_380[@i_577]) && ((x1_415 = x1_385[@i_577]) && ((x2_414 = x2_384[@i_577]) && ((x3_413 = x3_383[@i_577]) && ((x4_412 = x4_382[@i_577]) && (x5_411 = x5_381[@i_577]))))) then
      (
        let sk_u: hash0 = r_380[@i_577] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_576 <= NU suchthat defined(x1_391[@i_576], x2_390[@i_576], x3_389[@i_576], x4_388[@i_576], x5_387[@i_576], r_386[@i_576]) && ((x1_415 = x1_391[@i_576]) && ((x2_414 = x2_390[@i_576]) && ((x3_413 = x3_389[@i_576]) && ((x4_412 = x4_388[@i_576]) && (x5_411 = x5_387[@i_576]))))) then
      (
        let sk_u: hash0 = r_386[@i_576] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_575 <= NU suchthat defined(x1_397[@i_575], x2_396[@i_575], x3_395[@i_575], x4_394[@i_575], x5_393[@i_575], r_392[@i_575]) && ((x1_415 = x1_397[@i_575]) && ((x2_414 = x2_396[@i_575]) && ((x3_413 = x3_395[@i_575]) && ((x4_412 = x4_394[@i_575]) && (x5_411 = x5_393[@i_575]))))) then
      (
        let sk_u: hash0 = r_392[@i_575] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_574 <= NU suchthat defined(x1_403[@i_574], x2_402[@i_574], x3_401[@i_574], x4_400[@i_574], x5_399[@i_574], r_398[@i_574]) && ((x1_415 = x1_403[@i_574]) && ((x2_414 = x2_402[@i_574]) && ((x3_413 = x3_401[@i_574]) && ((x4_412 = x4_400[@i_574]) && (x5_411 = x5_399[@i_574]))))) then
      (
        let sk_u: hash0 = r_398[@i_574] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_573 <= NU suchthat defined(x1_409[@i_573], x2_408[@i_573], x3_407[@i_573], x4_406[@i_573], x5_405[@i_573], r_404[@i_573]) && ((x1_415 = x1_409[@i_573]) && ((x2_414 = x2_408[@i_573]) && ((x3_413 = x3_407[@i_573]) && ((x4_412 = x4_406[@i_573]) && (x5_411 = x5_405[@i_573]))))) then
      (
        let sk_u: hash0 = r_404[@i_573] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_572 <= NU suchthat defined(x1_415[@i_572], x2_414[@i_572], x3_413[@i_572], x4_412[@i_572], x5_411[@i_572], r_410[@i_572]) && ((x1_415 = x1_415[@i_572]) && ((x2_414 = x2_414[@i_572]) && ((x3_413 = x3_413[@i_572]) && ((x4_412 = x4_412[@i_572]) && (x5_411 = x5_411[@i_572]))))) then
      (
        let sk_u: hash0 = r_410[@i_572] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let x1_409: host = U in
      let x2_408: host = S in
      let x3_407: G = X in
      let x4_406: G = Y[@i_232] in
      let x5_405: G = K_u in
      find [unique] @i_571 <= qH0 suchthat defined(x1_343[@i_571], x2_342[@i_571], x3_341[@i_571], x4_340[@i_571], x5_339[@i_571], r_338[@i_571]) && ((x1_409 = x1_343[@i_571]) && ((x2_408 = x2_342[@i_571]) && ((x3_407 = x3_341[@i_571]) && ((x4_406 = x4_340[@i_571]) && (x5_405 = x5_339[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_570 <= NP suchthat defined(x1_349[@i_570], x2_348[@i_570], x3_347[@i_570], x4_346[@i_570], x5_345[@i_570], r_344[@i_570]) && ((x1_409 = x1_349[@i_570]) && ((x2_408 = x2_348[@i_570]) && ((x3_407 = x3_347[@i_570]) && ((x4_406 = x4_346[@i_570]) && (x5_405 = x5_345[@i_570]))))) then
      (
        let sk_u: hash0 = r_344[@i_570] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_569 <= NS suchthat defined(x1_355[@i_569], x2_354[@i_569], x3_353[@i_569], x4_352[@i_569], x5_351[@i_569], r_350[@i_569]) && ((x1_409 = x1_355[@i_569]) && ((x2_408 = x2_354[@i_569]) && ((x3_407 = x3_353[@i_569]) && ((x4_406 = x4_352[@i_569]) && (x5_405 = x5_351[@i_569]))))) then
      (
        let sk_u: hash0 = r_350[@i_569] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_568 <= NS suchthat defined(x1_361[@i_568], x2_360[@i_568], x3_359[@i_568], x4_358[@i_568], x5_357[@i_568], r_356[@i_568]) && ((x1_409 = x1_361[@i_568]) && ((x2_408 = x2_360[@i_568]) && ((x3_407 = x3_359[@i_568]) && ((x4_406 = x4_358[@i_568]) && (x5_405 = x5_357[@i_568]))))) then
      (
        let sk_u: hash0 = r_356[@i_568] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_567 <= NU suchthat defined(x1_367[@i_567], x2_366[@i_567], x3_365[@i_567], x4_364[@i_567], x5_363[@i_567], r_362[@i_567]) && ((x1_409 = x1_367[@i_567]) && ((x2_408 = x2_366[@i_567]) && ((x3_407 = x3_365[@i_567]) && ((x4_406 = x4_364[@i_567]) && (x5_405 = x5_363[@i_567]))))) then
      (
        let sk_u: hash0 = r_362[@i_567] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_566 <= NU suchthat defined(x1_373[@i_566], x2_372[@i_566], x3_371[@i_566], x4_370[@i_566], x5_369[@i_566], r_368[@i_566]) && ((x1_409 = x1_373[@i_566]) && ((x2_408 = x2_372[@i_566]) && ((x3_407 = x3_371[@i_566]) && ((x4_406 = x4_370[@i_566]) && (x5_405 = x5_369[@i_566]))))) then
      (
        let sk_u: hash0 = r_368[@i_566] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_565 <= NU suchthat defined(x1_379[@i_565], x2_378[@i_565], x3_377[@i_565], x4_376[@i_565], x5_375[@i_565], r_374[@i_565]) && ((x1_409 = x1_379[@i_565]) && ((x2_408 = x2_378[@i_565]) && ((x3_407 = x3_377[@i_565]) && ((x4_406 = x4_376[@i_565]) && (x5_405 = x5_375[@i_565]))))) then
      (
        let sk_u: hash0 = r_374[@i_565] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_564 <= NU suchthat defined(x1_385[@i_564], x2_384[@i_564], x3_383[@i_564], x4_382[@i_564], x5_381[@i_564], r_380[@i_564]) && ((x1_409 = x1_385[@i_564]) && ((x2_408 = x2_384[@i_564]) && ((x3_407 = x3_383[@i_564]) && ((x4_406 = x4_382[@i_564]) && (x5_405 = x5_381[@i_564]))))) then
      (
        let sk_u: hash0 = r_380[@i_564] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_563 <= NU suchthat defined(x1_391[@i_563], x2_390[@i_563], x3_389[@i_563], x4_388[@i_563], x5_387[@i_563], r_386[@i_563]) && ((x1_409 = x1_391[@i_563]) && ((x2_408 = x2_390[@i_563]) && ((x3_407 = x3_389[@i_563]) && ((x4_406 = x4_388[@i_563]) && (x5_405 = x5_387[@i_563]))))) then
      (
        let sk_u: hash0 = r_386[@i_563] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_562 <= NU suchthat defined(x1_397[@i_562], x2_396[@i_562], x3_395[@i_562], x4_394[@i_562], x5_393[@i_562], r_392[@i_562]) && ((x1_409 = x1_397[@i_562]) && ((x2_408 = x2_396[@i_562]) && ((x3_407 = x3_395[@i_562]) && ((x4_406 = x4_394[@i_562]) && (x5_405 = x5_393[@i_562]))))) then
      (
        let sk_u: hash0 = r_392[@i_562] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_561 <= NU suchthat defined(x1_403[@i_561], x2_402[@i_561], x3_401[@i_561], x4_400[@i_561], x5_399[@i_561], r_398[@i_561]) && ((x1_409 = x1_403[@i_561]) && ((x2_408 = x2_402[@i_561]) && ((x3_407 = x3_401[@i_561]) && ((x4_406 = x4_400[@i_561]) && (x5_405 = x5_399[@i_561]))))) then
      (
        let sk_u: hash0 = r_398[@i_561] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_560 <= NU suchthat defined(x1_409[@i_560], x2_408[@i_560], x3_407[@i_560], x4_406[@i_560], x5_405[@i_560], r_404[@i_560]) && ((x1_409 = x1_409[@i_560]) && ((x2_408 = x2_408[@i_560]) && ((x3_407 = x3_407[@i_560]) && ((x4_406 = x4_406[@i_560]) && (x5_405 = x5_405[@i_560]))))) then
      (
        let sk_u: hash0 = r_404[@i_560] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_559 <= NU suchthat defined(x1_415[@i_559], x2_414[@i_559], x3_413[@i_559], x4_412[@i_559], x5_411[@i_559], r_410[@i_559]) && ((x1_409 = x1_415[@i_559]) && ((x2_408 = x2_414[@i_559]) && ((x3_407 = x3_413[@i_559]) && ((x4_406 = x4_412[@i_559]) && (x5_405 = x5_411[@i_559]))))) then
      (
        let sk_u: hash0 = r_410[@i_559] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
  )
  else
    new @2_r4_188: G;
    let Y_u: G = @2_r4_188 in
    let K_u: G = exp(@2_r4_188, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    let x3_365: G = X in
    let x4_364: G = @2_r4_188 in
    let x5_363: G = K_u in
    find [unique] @i_480 <= qH0 suchthat defined(x1_343[@i_480], x2_342[@i_480], x3_341[@i_480], x4_340[@i_480], x5_339[@i_480], r_338[@i_480]) && ((x1_367 = x1_343[@i_480]) && ((x2_366 = x2_342[@i_480]) && ((x3_365 = x3_341[@i_480]) && ((x4_364 = x4_340[@i_480]) && (x5_363 = x5_339[@i_480]))))) then
    (
      let sk_u: hash0 = r_338[@i_480] in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
    )
    orfind @i_479 <= NP suchthat defined(x1_349[@i_479], x2_348[@i_479], x3_347[@i_479], x4_346[@i_479], x5_345[@i_479], r_344[@i_479]) && ((x1_367 = x1_349[@i_479]) && ((x2_366 = x2_348[@i_479]) && ((x3_365 = x3_347[@i_479]) && ((x4_364 = x4_346[@i_479]) && (x5_363 = x5_345[@i_479]))))) then
    (
      let sk_u: hash0 = r_344[@i_479] in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
    )
    orfind @i_478 <= NS suchthat defined(x1_355[@i_478], x2_354[@i_478], x3_353[@i_478], x4_352[@i_478], x5_351[@i_478], r_350[@i_478]) && ((x1_367 = x1_355[@i_478]) && ((x2_366 = x2_354[@i_478]) && ((x3_365 = x3_353[@i_478]) && ((x4_364 = x4_352[@i_478]) && (x5_363 = x5_351[@i_478]))))) then
    (
      let sk_u: hash0 = r_350[@i_478] in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
    )
    orfind @i_477 <= NS suchthat defined(x1_361[@i_477], x2_360[@i_477], x3_359[@i_477], x4_358[@i_477], x5_357[@i_477], r_356[@i_477]) && ((x1_367 = x1_361[@i_477]) && ((x2_366 = x2_360[@i_477]) && ((x3_365 = x3_359[@i_477]) && ((x4_364 = x4_358[@i_477]) && (x5_363 = x5_357[@i_477]))))) then
    (
      let sk_u: hash0 = r_356[@i_477] in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
    )
    orfind @i_476 <= NU suchthat defined(x1_367[@i_476], x2_366[@i_476], x3_365[@i_476], x4_364[@i_476], x5_363[@i_476], r_362[@i_476]) && ((x1_367 = x1_367[@i_476]) && ((x2_366 = x2_366[@i_476]) && ((x3_365 = x3_365[@i_476]) && ((x4_364 = x4_364[@i_476]) && (x5_363 = x5_363[@i_476]))))) then
    (
      let sk_u: hash0 = r_362[@i_476] in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
    )
    orfind @i_475 <= NU suchthat defined(x1_373[@i_475], x2_372[@i_475], x3_371[@i_475], x4_370[@i_475], x5_369[@i_475], r_368[@i_475]) && ((x1_367 = x1_373[@i_475]) && ((x2_366 = x2_372[@i_475]) && ((x3_365 = x3_371[@i_475]) && ((x4_364 = x4_370[@i_475]) && (x5_363 = x5_369[@i_475]))))) then
    (
      let sk_u: hash0 = r_368[@i_475] in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
    )
    orfind @i_474 <= NU suchthat defined(x1_379[@i_474], x2_378[@i_474], x3_377[@i_474], x4_376[@i_474], x5_375[@i_474], r_374[@i_474]) && ((x1_367 = x1_379[@i_474]) && ((x2_366 = x2_378[@i_474]) && ((x3_365 = x3_377[@i_474]) && ((x4_364 = x4_376[@i_474]) && (x5_363 = x5_375[@i_474]))))) then
    (
      let sk_u: hash0 = r_374[@i_474] in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
    )
    orfind @i_473 <= NU suchthat defined(x1_385[@i_473], x2_384[@i_473], x3_383[@i_473], x4_382[@i_473], x5_381[@i_473], r_380[@i_473]) && ((x1_367 = x1_385[@i_473]) && ((x2_366 = x2_384[@i_473]) && ((x3_365 = x3_383[@i_473]) && ((x4_364 = x4_382[@i_473]) && (x5_363 = x5_381[@i_473]))))) then
    (
      let sk_u: hash0 = r_380[@i_473] in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
    )
    orfind @i_472 <= NU suchthat defined(x1_391[@i_472], x2_390[@i_472], x3_389[@i_472], x4_388[@i_472], x5_387[@i_472], r_386[@i_472]) && ((x1_367 = x1_391[@i_472]) && ((x2_366 = x2_390[@i_472]) && ((x3_365 = x3_389[@i_472]) && ((x4_364 = x4_388[@i_472]) && (x5_363 = x5_387[@i_472]))))) then
    (
      let sk_u: hash0 = r_386[@i_472] in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
    )
    orfind @i_471 <= NU suchthat defined(x1_397[@i_471], x2_396[@i_471], x3_395[@i_471], x4_394[@i_471], x5_393[@i_471], r_392[@i_471]) && ((x1_367 = x1_397[@i_471]) && ((x2_366 = x2_396[@i_471]) && ((x3_365 = x3_395[@i_471]) && ((x4_364 = x4_394[@i_471]) && (x5_363 = x5_393[@i_471]))))) then
    (
      let sk_u: hash0 = r_392[@i_471] in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
    )
    orfind @i_470 <= NU suchthat defined(x1_403[@i_470], x2_402[@i_470], x3_401[@i_470], x4_400[@i_470], x5_399[@i_470], r_398[@i_470]) && ((x1_367 = x1_403[@i_470]) && ((x2_366 = x2_402[@i_470]) && ((x3_365 = x3_401[@i_470]) && ((x4_364 = x4_400[@i_470]) && (x5_363 = x5_399[@i_470]))))) then
    (
      let sk_u: hash0 = r_398[@i_470] in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
    )
    orfind @i_469 <= NU suchthat defined(x1_409[@i_469], x2_408[@i_469], x3_407[@i_469], x4_406[@i_469], x5_405[@i_469], r_404[@i_469]) && ((x1_367 = x1_409[@i_469]) && ((x2_366 = x2_408[@i_469]) && ((x3_365 = x3_407[@i_469]) && ((x4_364 = x4_406[@i_469]) && (x5_363 = x5_405[@i_469]))))) then
    (
      let sk_u: hash0 = r_404[@i_469] in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
    )
    orfind @i_468 <= NU suchthat defined(x1_415[@i_468], x2_414[@i_468], x3_413[@i_468], x4_412[@i_468], x5_411[@i_468], r_410[@i_468]) && ((x1_367 = x1_415[@i_468]) && ((x2_366 = x2_414[@i_468]) && ((x3_365 = x3_413[@i_468]) && ((x4_364 = x4_412[@i_468]) && (x5_363 = x5_411[@i_468]))))) then
    (
      let sk_u: hash0 = r_410[@i_468] in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
    )
    else
      new r_362: hash0;
      let sk_u: hash0 = r_362 in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      let x3_353: G = X_s in
      let x4_352: G = Y in
      let x5_351: G = K_s in
      find [unique] @i_454 <= qH0 suchthat defined(x1_343[@i_454], x2_342[@i_454], x3_341[@i_454], x4_340[@i_454], x5_339[@i_454], r_338[@i_454]) && ((x1_355 = x1_343[@i_454]) && ((x2_354 = x2_342[@i_454]) && ((x3_353 = x3_341[@i_454]) && ((x4_352 = x4_340[@i_454]) && (x5_351 = x5_339[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_453 <= NP suchthat defined(x1_349[@i_453], x2_348[@i_453], x3_347[@i_453], x4_346[@i_453], x5_345[@i_453], r_344[@i_453]) && ((x1_355 = x1_349[@i_453]) && ((x2_354 = x2_348[@i_453]) && ((x3_353 = x3_347[@i_453]) && ((x4_352 = x4_346[@i_453]) && (x5_351 = x5_345[@i_453]))))) then
      (
        let sk_s: hash0 = r_344[@i_453] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_452 <= NS suchthat defined(x1_355[@i_452], x2_354[@i_452], x3_353[@i_452], x4_352[@i_452], x5_351[@i_452], r_350[@i_452]) && ((x1_355 = x1_355[@i_452]) && ((x2_354 = x2_354[@i_452]) && ((x3_353 = x3_353[@i_452]) && ((x4_352 = x4_352[@i_452]) && (x5_351 = x5_351[@i_452]))))) then
      (
        let sk_s: hash0 = r_350[@i_452] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_451 <= NS suchthat defined(x1_361[@i_451], x2_360[@i_451], x3_359[@i_451], x4_358[@i_451], x5_357[@i_451], r_356[@i_451]) && ((x1_355 = x1_361[@i_451]) && ((x2_354 = x2_360[@i_451]) && ((x3_353 = x3_359[@i_451]) && ((x4_352 = x4_358[@i_451]) && (x5_351 = x5_357[@i_451]))))) then
      (
        let sk_s: hash0 = r_356[@i_451] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_450 <= NU suchthat defined(x1_367[@i_450], x2_366[@i_450], x3_365[@i_450], x4_364[@i_450], x5_363[@i_450], r_362[@i_450]) && ((x1_355 = x1_367[@i_450]) && ((x2_354 = x2_366[@i_450]) && ((x3_353 = x3_365[@i_450]) && ((x4_352 = x4_364[@i_450]) && (x5_351 = x5_363[@i_450]))))) then
      (
        let sk_s: hash0 = r_362[@i_450] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_449 <= NU suchthat defined(x1_373[@i_449], x2_372[@i_449], x3_371[@i_449], x4_370[@i_449], x5_369[@i_449], r_368[@i_449]) && ((x1_355 = x1_373[@i_449]) && ((x2_354 = x2_372[@i_449]) && ((x3_353 = x3_371[@i_449]) && ((x4_352 = x4_370[@i_449]) && (x5_351 = x5_369[@i_449]))))) then
      (
        let sk_s: hash0 = r_368[@i_449] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_448 <= NU suchthat defined(x1_379[@i_448], x2_378[@i_448], x3_377[@i_448], x4_376[@i_448], x5_375[@i_448], r_374[@i_448]) && ((x1_355 = x1_379[@i_448]) && ((x2_354 = x2_378[@i_448]) && ((x3_353 = x3_377[@i_448]) && ((x4_352 = x4_376[@i_448]) && (x5_351 = x5_375[@i_448]))))) then
      (
        let sk_s: hash0 = r_374[@i_448] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_447 <= NU suchthat defined(x1_385[@i_447], x2_384[@i_447], x3_383[@i_447], x4_382[@i_447], x5_381[@i_447], r_380[@i_447]) && ((x1_355 = x1_385[@i_447]) && ((x2_354 = x2_384[@i_447]) && ((x3_353 = x3_383[@i_447]) && ((x4_352 = x4_382[@i_447]) && (x5_351 = x5_381[@i_447]))))) then
      (
        let sk_s: hash0 = r_380[@i_447] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_446 <= NU suchthat defined(x1_391[@i_446], x2_390[@i_446], x3_389[@i_446], x4_388[@i_446], x5_387[@i_446], r_386[@i_446]) && ((x1_355 = x1_391[@i_446]) && ((x2_354 = x2_390[@i_446]) && ((x3_353 = x3_389[@i_446]) && ((x4_352 = x4_388[@i_446]) && (x5_351 = x5_387[@i_446]))))) then
      (
        let sk_s: hash0 = r_386[@i_446] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_445 <= NU suchthat defined(x1_397[@i_445], x2_396[@i_445], x3_395[@i_445], x4_394[@i_445], x5_393[@i_445], r_392[@i_445]) && ((x1_355 = x1_397[@i_445]) && ((x2_354 = x2_396[@i_445]) && ((x3_353 = x3_395[@i_445]) && ((x4_352 = x4_394[@i_445]) && (x5_351 = x5_393[@i_445]))))) then
      (
        let sk_s: hash0 = r_392[@i_445] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_444 <= NU suchthat defined(x1_403[@i_444], x2_402[@i_444], x3_401[@i_444], x4_400[@i_444], x5_399[@i_444], r_398[@i_444]) && ((x1_355 = x1_403[@i_444]) && ((x2_354 = x2_402[@i_444]) && ((x3_353 = x3_401[@i_444]) && ((x4_352 = x4_400[@i_444]) && (x5_351 = x5_399[@i_444]))))) then
      (
        let sk_s: hash0 = r_398[@i_444] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_443 <= NU suchthat defined(x1_409[@i_443], x2_408[@i_443], x3_407[@i_443], x4_406[@i_443], x5_405[@i_443], r_404[@i_443]) && ((x1_355 = x1_409[@i_443]) && ((x2_354 = x2_408[@i_443]) && ((x3_353 = x3_407[@i_443]) && ((x4_352 = x4_406[@i_443]) && (x5_351 = x5_405[@i_443]))))) then
      (
        let sk_s: hash0 = r_404[@i_443] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_442 <= NU suchthat defined(x1_415[@i_442], x2_414[@i_442], x3_413[@i_442], x4_412[@i_442], x5_411[@i_442], r_410[@i_442]) && ((x1_355 = x1_415[@i_442]) && ((x2_354 = x2_414[@i_442]) && ((x3_353 = x3_413[@i_442]) && ((x4_352 = x4_412[@i_442]) && (x5_351 = x5_411[@i_442]))))) then
      (
        let sk_s: hash0 = r_410[@i_442] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      let x3_359: G = X_s in
      let x4_358: G = Y in
      let x5_357: G = K_s in
      find [unique] @i_467 <= qH0 suchthat defined(x1_343[@i_467], x2_342[@i_467], x3_341[@i_467], x4_340[@i_467], x5_339[@i_467], r_338[@i_467]) && ((x1_361 = x1_343[@i_467]) && ((x2_360 = x2_342[@i_467]) && ((x3_359 = x3_341[@i_467]) && ((x4_358 = x4_340[@i_467]) && (x5_357 = x5_339[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_466 <= NP suchthat defined(x1_349[@i_466], x2_348[@i_466], x3_347[@i_466], x4_346[@i_466], x5_345[@i_466], r_344[@i_466]) && ((x1_361 = x1_349[@i_466]) && ((x2_360 = x2_348[@i_466]) && ((x3_359 = x3_347[@i_466]) && ((x4_358 = x4_346[@i_466]) && (x5_357 = x5_345[@i_466]))))) then
      (
        let sk_s: hash0 = r_344[@i_466] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_465 <= NS suchthat defined(x1_355[@i_465], x2_354[@i_465], x3_353[@i_465], x4_352[@i_465], x5_351[@i_465], r_350[@i_465]) && ((x1_361 = x1_355[@i_465]) && ((x2_360 = x2_354[@i_465]) && ((x3_359 = x3_353[@i_465]) && ((x4_358 = x4_352[@i_465]) && (x5_357 = x5_351[@i_465]))))) then
      (
        let sk_s: hash0 = r_350[@i_465] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_464 <= NS suchthat defined(x1_361[@i_464], x2_360[@i_464], x3_359[@i_464], x4_358[@i_464], x5_357[@i_464], r_356[@i_464]) && ((x1_361 = x1_361[@i_464]) && ((x2_360 = x2_360[@i_464]) && ((x3_359 = x3_359[@i_464]) && ((x4_358 = x4_358[@i_464]) && (x5_357 = x5_357[@i_464]))))) then
      (
        let sk_s: hash0 = r_356[@i_464] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_463 <= NU suchthat defined(x1_367[@i_463], x2_366[@i_463], x3_365[@i_463], x4_364[@i_463], x5_363[@i_463], r_362[@i_463]) && ((x1_361 = x1_367[@i_463]) && ((x2_360 = x2_366[@i_463]) && ((x3_359 = x3_365[@i_463]) && ((x4_358 = x4_364[@i_463]) && (x5_357 = x5_363[@i_463]))))) then
      (
        let sk_s: hash0 = r_362[@i_463] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_462 <= NU suchthat defined(x1_373[@i_462], x2_372[@i_462], x3_371[@i_462], x4_370[@i_462], x5_369[@i_462], r_368[@i_462]) && ((x1_361 = x1_373[@i_462]) && ((x2_360 = x2_372[@i_462]) && ((x3_359 = x3_371[@i_462]) && ((x4_358 = x4_370[@i_462]) && (x5_357 = x5_369[@i_462]))))) then
      (
        let sk_s: hash0 = r_368[@i_462] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_461 <= NU suchthat defined(x1_379[@i_461], x2_378[@i_461], x3_377[@i_461], x4_376[@i_461], x5_375[@i_461], r_374[@i_461]) && ((x1_361 = x1_379[@i_461]) && ((x2_360 = x2_378[@i_461]) && ((x3_359 = x3_377[@i_461]) && ((x4_358 = x4_376[@i_461]) && (x5_357 = x5_375[@i_461]))))) then
      (
        let sk_s: hash0 = r_374[@i_461] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_460 <= NU suchthat defined(x1_385[@i_460], x2_384[@i_460], x3_383[@i_460], x4_382[@i_460], x5_381[@i_460], r_380[@i_460]) && ((x1_361 = x1_385[@i_460]) && ((x2_360 = x2_384[@i_460]) && ((x3_359 = x3_383[@i_460]) && ((x4_358 = x4_382[@i_460]) && (x5_357 = x5_381[@i_460]))))) then
      (
        let sk_s: hash0 = r_380[@i_460] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_459 <= NU suchthat defined(x1_391[@i_459], x2_390[@i_459], x3_389[@i_459], x4_388[@i_459], x5_387[@i_459], r_386[@i_459]) && ((x1_361 = x1_391[@i_459]) && ((x2_360 = x2_390[@i_459]) && ((x3_359 = x3_389[@i_459]) && ((x4_358 = x4_388[@i_459]) && (x5_357 = x5_387[@i_459]))))) then
      (
        let sk_s: hash0 = r_386[@i_459] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_458 <= NU suchthat defined(x1_397[@i_458], x2_396[@i_458], x3_395[@i_458], x4_394[@i_458], x5_393[@i_458], r_392[@i_458]) && ((x1_361 = x1_397[@i_458]) && ((x2_360 = x2_396[@i_458]) && ((x3_359 = x3_395[@i_458]) && ((x4_358 = x4_394[@i_458]) && (x5_357 = x5_393[@i_458]))))) then
      (
        let sk_s: hash0 = r_392[@i_458] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_457 <= NU suchthat defined(x1_403[@i_457], x2_402[@i_457], x3_401[@i_457], x4_400[@i_457], x5_399[@i_457], r_398[@i_457]) && ((x1_361 = x1_403[@i_457]) && ((x2_360 = x2_402[@i_457]) && ((x3_359 = x3_401[@i_457]) && ((x4_358 = x4_400[@i_457]) && (x5_357 = x5_399[@i_457]))))) then
      (
        let sk_s: hash0 = r_398[@i_457] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_456 <= NU suchthat defined(x1_409[@i_456], x2_408[@i_456], x3_407[@i_456], x4_406[@i_456], x5_405[@i_456], r_404[@i_456]) && ((x1_361 = x1_409[@i_456]) && ((x2_360 = x2_408[@i_456]) && ((x3_359 = x3_407[@i_456]) && ((x4_358 = x4_406[@i_456]) && (x5_357 = x5_405[@i_456]))))) then
      (
        let sk_s: hash0 = r_404[@i_456] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_455 <= NU suchthat defined(x1_415[@i_455], x2_414[@i_455], x3_413[@i_455], x4_412[@i_455], x5_411[@i_455], r_410[@i_455]) && ((x1_361 = x1_415[@i_455]) && ((x2_360 = x2_414[@i_455]) && ((x3_359 = x3_413[@i_455]) && ((x4_358 = x4_412[@i_455]) && (x5_357 = x5_411[@i_455]))))) then
      (
        let sk_s: hash0 = r_410[@i_455] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  let x3_347: G = Xp in
  let x4_346: G = Yp in
  let x5_345: G = Kp in
  find [unique] @i_441 <= qH0 suchthat defined(x1_343[@i_441], x2_342[@i_441], x3_341[@i_441], x4_340[@i_441], x5_339[@i_441], r_338[@i_441]) && ((x1_349 = x1_343[@i_441]) && ((x2_348 = x2_342[@i_441]) && ((x3_347 = x3_341[@i_441]) && ((x4_346 = x4_340[@i_441]) && (x5_345 = x5_339[@i_441]))))) then
  (
    let sk_p: hash0 = r_338[@i_441] in
    out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
  )
  orfind @i_440 <= NP suchthat defined(x1_349[@i_440], x2_348[@i_440], x3_347[@i_440], x4_346[@i_440], x5_345[@i_440], r_344[@i_440]) && ((x1_349 = x1_349[@i_440]) && ((x2_348 = x2_348[@i_440]) && ((x3_347 = x3_347[@i_440]) && ((x4_346 = x4_346[@i_440]) && (x5_345 = x5_345[@i_440]))))) then
  (
    let sk_p: hash0 = r_344[@i_440] in
    out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
  )
  orfind @i_439 <= NS suchthat defined(x1_355[@i_439], x2_354[@i_439], x3_353[@i_439], x4_352[@i_439], x5_351[@i_439], r_350[@i_439]) && ((x1_349 = x1_355[@i_439]) && ((x2_348 = x2_354[@i_439]) && ((x3_347 = x3_353[@i_439]) && ((x4_346 = x4_352[@i_439]) && (x5_345 = x5_351[@i_439]))))) then
  (
    let sk_p: hash0 = r_350[@i_439] in
    out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
  )
  orfind @i_438 <= NS suchthat defined(x1_361[@i_438], x2_360[@i_438], x3_359[@i_438], x4_358[@i_438], x5_357[@i_438], r_356[@i_438]) && ((x1_349 = x1_361[@i_438]) && ((x2_348 = x2_360[@i_438]) && ((x3_347 = x3_359[@i_438]) && ((x4_346 = x4_358[@i_438]) && (x5_345 = x5_357[@i_438]))))) then
  (
    let sk_p: hash0 = r_356[@i_438] in
    out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
  )
  orfind @i_437 <= NU suchthat defined(x1_367[@i_437], x2_366[@i_437], x3_365[@i_437], x4_364[@i_437], x5_363[@i_437], r_362[@i_437]) && ((x1_349 = x1_367[@i_437]) && ((x2_348 = x2_366[@i_437]) && ((x3_347 = x3_365[@i_437]) && ((x4_346 = x4_364[@i_437]) && (x5_345 = x5_363[@i_437]))))) then
  (
    let sk_p: hash0 = r_362[@i_437] in
    out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
  )
  orfind @i_436 <= NU suchthat defined(x1_373[@i_436], x2_372[@i_436], x3_371[@i_436], x4_370[@i_436], x5_369[@i_436], r_368[@i_436]) && ((x1_349 = x1_373[@i_436]) && ((x2_348 = x2_372[@i_436]) && ((x3_347 = x3_371[@i_436]) && ((x4_346 = x4_370[@i_436]) && (x5_345 = x5_369[@i_436]))))) then
  (
    let sk_p: hash0 = r_368[@i_436] in
    out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
  )
  orfind @i_435 <= NU suchthat defined(x1_379[@i_435], x2_378[@i_435], x3_377[@i_435], x4_376[@i_435], x5_375[@i_435], r_374[@i_435]) && ((x1_349 = x1_379[@i_435]) && ((x2_348 = x2_378[@i_435]) && ((x3_347 = x3_377[@i_435]) && ((x4_346 = x4_376[@i_435]) && (x5_345 = x5_375[@i_435]))))) then
  (
    let sk_p: hash0 = r_374[@i_435] in
    out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
  )
  orfind @i_434 <= NU suchthat defined(x1_385[@i_434], x2_384[@i_434], x3_383[@i_434], x4_382[@i_434], x5_381[@i_434], r_380[@i_434]) && ((x1_349 = x1_385[@i_434]) && ((x2_348 = x2_384[@i_434]) && ((x3_347 = x3_383[@i_434]) && ((x4_346 = x4_382[@i_434]) && (x5_345 = x5_381[@i_434]))))) then
  (
    let sk_p: hash0 = r_380[@i_434] in
    out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
  )
  orfind @i_433 <= NU suchthat defined(x1_391[@i_433], x2_390[@i_433], x3_389[@i_433], x4_388[@i_433], x5_387[@i_433], r_386[@i_433]) && ((x1_349 = x1_391[@i_433]) && ((x2_348 = x2_390[@i_433]) && ((x3_347 = x3_389[@i_433]) && ((x4_346 = x4_388[@i_433]) && (x5_345 = x5_387[@i_433]))))) then
  (
    let sk_p: hash0 = r_386[@i_433] in
    out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
  )
  orfind @i_432 <= NU suchthat defined(x1_397[@i_432], x2_396[@i_432], x3_395[@i_432], x4_394[@i_432], x5_393[@i_432], r_392[@i_432]) && ((x1_349 = x1_397[@i_432]) && ((x2_348 = x2_396[@i_432]) && ((x3_347 = x3_395[@i_432]) && ((x4_346 = x4_394[@i_432]) && (x5_345 = x5_393[@i_432]))))) then
  (
    let sk_p: hash0 = r_392[@i_432] in
    out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
  )
  orfind @i_431 <= NU suchthat defined(x1_403[@i_431], x2_402[@i_431], x3_401[@i_431], x4_400[@i_431], x5_399[@i_431], r_398[@i_431]) && ((x1_349 = x1_403[@i_431]) && ((x2_348 = x2_402[@i_431]) && ((x3_347 = x3_401[@i_431]) && ((x4_346 = x4_400[@i_431]) && (x5_345 = x5_399[@i_431]))))) then
  (
    let sk_p: hash0 = r_398[@i_431] in
    out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
  )
  orfind @i_430 <= NU suchthat defined(x1_409[@i_430], x2_408[@i_430], x3_407[@i_430], x4_406[@i_430], x5_405[@i_430], r_404[@i_430]) && ((x1_349 = x1_409[@i_430]) && ((x2_348 = x2_408[@i_430]) && ((x3_347 = x3_407[@i_430]) && ((x4_346 = x4_406[@i_430]) && (x5_345 = x5_405[@i_430]))))) then
  (
    let sk_p: hash0 = r_404[@i_430] in
    out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
  )
  orfind @i_429 <= NU suchthat defined(x1_415[@i_429], x2_414[@i_429], x3_413[@i_429], x4_412[@i_429], x5_411[@i_429], r_410[@i_429]) && ((x1_349 = x1_415[@i_429]) && ((x2_348 = x2_414[@i_429]) && ((x3_347 = x3_413[@i_429]) && ((x4_346 = x4_412[@i_429]) && (x5_345 = x5_411[@i_429]))))) then
  (
    let sk_p: hash0 = r_410[@i_429] in
    out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
  )
  else
    new r_344: hash0;
    let sk_p: hash0 = r_344 in
    out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  let @2_x_181: G = cst_G in
  let @2_ke_180: passwd = cst_passwd in
  find [unique] @i_210 <= qD suchthat defined(@2_kd[@i_210], @2_m[@i_210], @2_m_178[@i_210], @2_kd_177[@i_210], @2_r4_176[@i_210]) && ((@2_x = @2_r4_176[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(pw, Ystar_u[@i_206], @2_m_190[@i_206], @2_kd_189[@i_206], @2_r4_188[@i_206]) && ((@2_x = @2_r4_188[@i_206]) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_ke_180[@i_204], @2_x_181[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], pw, xp[@i_203], xp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], pw, y[@i_202], y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  let @2_m_178: G = cst_G in
  let @2_kd_177: passwd = cst_passwd in
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @2_kd_177[@i_200], @2_m_178[@i_200], @2_r4_176[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @2_r4_176[@i_200])
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], pw, @2_kd_189[@i_196], @2_m_190[@i_196], @2_r4_188[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @2_r4_188[@i_196])
  orfind @i_194 <= qE suchthat defined(@2_ke[@i_194], @2_x[@i_194], @2_x_181[@i_194], @2_ke_180[@i_194], @2_r2_179[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(pw, Yp[@i_193], xp[@i_193], xp[@i_193], @2_r2_182[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(pw, Y[@i_192], y[@i_192], y[@i_192], @2_r2_185[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @2_r4_176: G;
    out(@2_c4[!_61], @2_r4_176)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_343: host = x1 in
  let x2_342: host = x2 in
  let x3_341: G = x3 in
  let x4_340: G = x4 in
  let x5_339: G = x5 in
  find [unique] @i_428 <= qH0 suchthat defined(x1_343[@i_428], x2_342[@i_428], x3_341[@i_428], x4_340[@i_428], x5_339[@i_428], r_338[@i_428]) && ((x1_343 = x1_343[@i_428]) && ((x2_342 = x2_342[@i_428]) && ((x3_341 = x3_341[@i_428]) && ((x4_340 = x4_340[@i_428]) && (x5_339 = x5_339[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(x1_349[@i_427], x2_348[@i_427], x3_347[@i_427], x4_346[@i_427], x5_345[@i_427], r_344[@i_427]) && ((x1_343 = x1_349[@i_427]) && ((x2_342 = x2_348[@i_427]) && ((x3_341 = x3_347[@i_427]) && ((x4_340 = x4_346[@i_427]) && (x5_339 = x5_345[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(x1_355[@i_426], x2_354[@i_426], x3_353[@i_426], x4_352[@i_426], x5_351[@i_426], r_350[@i_426]) && ((x1_343 = x1_355[@i_426]) && ((x2_342 = x2_354[@i_426]) && ((x3_341 = x3_353[@i_426]) && ((x4_340 = x4_352[@i_426]) && (x5_339 = x5_351[@i_426]))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(x1_361[@i_425], x2_360[@i_425], x3_359[@i_425], x4_358[@i_425], x5_357[@i_425], r_356[@i_425]) && ((x1_343 = x1_361[@i_425]) && ((x2_342 = x2_360[@i_425]) && ((x3_341 = x3_359[@i_425]) && ((x4_340 = x4_358[@i_425]) && (x5_339 = x5_357[@i_425]))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(x1_367[@i_424], x2_366[@i_424], x3_365[@i_424], x4_364[@i_424], x5_363[@i_424], r_362[@i_424]) && ((x1_343 = x1_367[@i_424]) && ((x2_342 = x2_366[@i_424]) && ((x3_341 = x3_365[@i_424]) && ((x4_340 = x4_364[@i_424]) && (x5_339 = x5_363[@i_424]))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(x1_373[@i_423], x2_372[@i_423], x3_371[@i_423], x4_370[@i_423], x5_369[@i_423], r_368[@i_423]) && ((x1_343 = x1_373[@i_423]) && ((x2_342 = x2_372[@i_423]) && ((x3_341 = x3_371[@i_423]) && ((x4_340 = x4_370[@i_423]) && (x5_339 = x5_369[@i_423]))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(x1_379[@i_422], x2_378[@i_422], x3_377[@i_422], x4_376[@i_422], x5_375[@i_422], r_374[@i_422]) && ((x1_343 = x1_379[@i_422]) && ((x2_342 = x2_378[@i_422]) && ((x3_341 = x3_377[@i_422]) && ((x4_340 = x4_376[@i_422]) && (x5_339 = x5_375[@i_422]))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(x1_385[@i_421], x2_384[@i_421], x3_383[@i_421], x4_382[@i_421], x5_381[@i_421], r_380[@i_421]) && ((x1_343 = x1_385[@i_421]) && ((x2_342 = x2_384[@i_421]) && ((x3_341 = x3_383[@i_421]) && ((x4_340 = x4_382[@i_421]) && (x5_339 = x5_381[@i_421]))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(x1_391[@i_420], x2_390[@i_420], x3_389[@i_420], x4_388[@i_420], x5_387[@i_420], r_386[@i_420]) && ((x1_343 = x1_391[@i_420]) && ((x2_342 = x2_390[@i_420]) && ((x3_341 = x3_389[@i_420]) && ((x4_340 = x4_388[@i_420]) && (x5_339 = x5_387[@i_420]))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(x1_397[@i_419], x2_396[@i_419], x3_395[@i_419], x4_394[@i_419], x5_393[@i_419], r_392[@i_419]) && ((x1_343 = x1_397[@i_419]) && ((x2_342 = x2_396[@i_419]) && ((x3_341 = x3_395[@i_419]) && ((x4_340 = x4_394[@i_419]) && (x5_339 = x5_393[@i_419]))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(x1_403[@i_418], x2_402[@i_418], x3_401[@i_418], x4_400[@i_418], x5_399[@i_418], r_398[@i_418]) && ((x1_343 = x1_403[@i_418]) && ((x2_342 = x2_402[@i_418]) && ((x3_341 = x3_401[@i_418]) && ((x4_340 = x4_400[@i_418]) && (x5_339 = x5_399[@i_418]))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(x1_409[@i_417], x2_408[@i_417], x3_407[@i_417], x4_406[@i_417], x5_405[@i_417], r_404[@i_417]) && ((x1_343 = x1_409[@i_417]) && ((x2_342 = x2_408[@i_417]) && ((x3_341 = x3_407[@i_417]) && ((x4_340 = x4_406[@i_417]) && (x5_339 = x5_405[@i_417]))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(x1_415[@i_416], x2_414[@i_416], x3_413[@i_416], x4_412[@i_416], x5_411[@i_416], r_410[@i_416]) && ((x1_343 = x1_415[@i_416]) && ((x2_342 = x2_414[@i_416]) && ((x3_341 = x3_413[@i_416]) && ((x4_340 = x4_412[@i_416]) && (x5_339 = x5_411[@i_416]))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying simplify [Excluding set(dist 14->15, proba <= 10. * NU * NP / |exponent| + 2. * NS * NP / |exponent| + qH0 * NP / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + 8.5 * NU * NU / |G| + 3. * NS * NU / |G| + 2. * NP * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NP * qD / |G| + qD * NP / |exponent| + 1. / |exponent| * NP + 15. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + NU * qH1 / |hash1| + NS * NP / |G| + qD * NU / |G| + 0.5 * qD * qD / |G|)] yields

Game 15 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  let @2_m_190: G = cst_G in
  let @2_kd_189: passwd = cst_passwd in
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @2_r4_176[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = @2_r4_176[@i_240] in
    let K_u: G = exp(@2_r4_176[@i_240], x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@2_r4_176[@i_240] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      let x3_377: G = X in
      let x4_376: G = @2_r4_176[@i_240] in
      let x5_375: G = K_u in
      find [unique] @i_506 <= qH0 suchthat defined(x1_343[@i_506], x2_342[@i_506], x3_341[@i_506], x4_340[@i_506], x5_339[@i_506], r_338[@i_506]) && ((x1_379 = x1_343[@i_506]) && ((x2_378 = x2_342[@i_506]) && ((x3_377 = x3_341[@i_506]) && ((x4_376 = x4_340[@i_506]) && (x5_375 = x5_339[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let x1_373: host = U in
      let x2_372: host = S in
      let x3_371: G = X in
      let x4_370: G = @2_r4_176[@i_240] in
      let x5_369: G = K_u in
      find [unique] @i_493 <= qH0 suchthat defined(x1_343[@i_493], x2_342[@i_493], x3_341[@i_493], x4_340[@i_493], x5_339[@i_493], r_338[@i_493]) && ((x1_373 = x1_343[@i_493]) && ((x2_372 = x2_342[@i_493]) && ((x3_371 = x3_341[@i_493]) && ((x4_370 = x4_340[@i_493]) && (x5_369 = x5_339[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @2_r4_188[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = @2_r4_188[@i_236] in
    let K_u: G = exp(@2_r4_188[@i_236], x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@2_r4_188[@i_236] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      let x3_389: G = X in
      let x4_388: G = @2_r4_188[@i_236] in
      let x5_387: G = K_u in
      find [unique] @i_532 <= qH0 suchthat defined(x1_343[@i_532], x2_342[@i_532], x3_341[@i_532], x4_340[@i_532], x5_339[@i_532], r_338[@i_532]) && ((x1_391 = x1_343[@i_532]) && ((x2_390 = x2_342[@i_532]) && ((x3_389 = x3_341[@i_532]) && ((x4_388 = x4_340[@i_532]) && (x5_387 = x5_339[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let x1_385: host = U in
      let x2_384: host = S in
      let x3_383: G = X in
      let x4_382: G = @2_r4_188[@i_236] in
      let x5_381: G = K_u in
      find [unique] @i_519 <= qH0 suchthat defined(x1_343[@i_519], x2_342[@i_519], x3_341[@i_519], x4_340[@i_519], x5_339[@i_519], r_338[@i_519]) && ((x1_385 = x1_343[@i_519]) && ((x2_384 = x2_342[@i_519]) && ((x3_383 = x3_341[@i_519]) && ((x4_382 = x4_340[@i_519]) && (x5_381 = x5_339[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      let x3_401: G = X in
      let x4_400: G = Yp[@i_233] in
      let x5_399: G = K_u in
      find [unique] @i_558 <= qH0 suchthat defined(x1_343[@i_558], x2_342[@i_558], x3_341[@i_558], x4_340[@i_558], x5_339[@i_558], r_338[@i_558]) && ((x1_403 = x1_343[@i_558]) && ((x2_402 = x2_342[@i_558]) && ((x3_401 = x3_341[@i_558]) && ((x4_400 = x4_340[@i_558]) && (x5_399 = x5_339[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let x1_397: host = U in
      let x2_396: host = S in
      let x3_395: G = X in
      let x4_394: G = Yp[@i_233] in
      let x5_393: G = K_u in
      find [unique] @i_545 <= qH0 suchthat defined(x1_343[@i_545], x2_342[@i_545], x3_341[@i_545], x4_340[@i_545], x5_339[@i_545], r_338[@i_545]) && ((x1_397 = x1_343[@i_545]) && ((x2_396 = x2_342[@i_545]) && ((x3_395 = x3_341[@i_545]) && ((x4_394 = x4_340[@i_545]) && (x5_393 = x5_339[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      let x3_413: G = X in
      let x4_412: G = Y[@i_232] in
      let x5_411: G = K_u in
      find [unique] @i_584 <= qH0 suchthat defined(x1_343[@i_584], x2_342[@i_584], x3_341[@i_584], x4_340[@i_584], x5_339[@i_584], r_338[@i_584]) && ((x1_415 = x1_343[@i_584]) && ((x2_414 = x2_342[@i_584]) && ((x3_413 = x3_341[@i_584]) && ((x4_412 = x4_340[@i_584]) && (x5_411 = x5_339[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let @i_582 <= NS = @i_232 in
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let x1_409: host = U in
      let x2_408: host = S in
      let x3_407: G = X in
      let x4_406: G = Y[@i_232] in
      let x5_405: G = K_u in
      find [unique] @i_571 <= qH0 suchthat defined(x1_343[@i_571], x2_342[@i_571], x3_341[@i_571], x4_340[@i_571], x5_339[@i_571], r_338[@i_571]) && ((x1_409 = x1_343[@i_571]) && ((x2_408 = x2_342[@i_571]) && ((x3_407 = x3_341[@i_571]) && ((x4_406 = x4_340[@i_571]) && (x5_405 = x5_339[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
  )
  else
    new @2_r4_188: G;
    let Y_u: G = @2_r4_188 in
    let K_u: G = exp(@2_r4_188, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    let x3_365: G = X in
    let x4_364: G = @2_r4_188 in
    let x5_363: G = K_u in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, sk_u);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      let x3_353: G = X_s in
      let x4_352: G = Y in
      let x5_351: G = K_s in
      find [unique] @i_454 <= qH0 suchthat defined(x1_343[@i_454], x2_342[@i_454], x3_341[@i_454], x4_340[@i_454], x5_339[@i_454], r_338[@i_454]) && ((x1_355 = x1_343[@i_454]) && ((x2_354 = x2_342[@i_454]) && ((x3_353 = x3_341[@i_454]) && ((x4_352 = x4_340[@i_454]) && (x5_351 = x5_339[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let @i_443 <= NU = j in
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let @i_442 <= NU = j in
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      let x3_359: G = X_s in
      let x4_358: G = Y in
      let x5_357: G = K_s in
      find [unique] @i_467 <= qH0 suchthat defined(x1_343[@i_467], x2_342[@i_467], x3_341[@i_467], x4_340[@i_467], x5_339[@i_467], r_338[@i_467]) && ((x1_361 = x1_343[@i_467]) && ((x2_360 = x2_342[@i_467]) && ((x3_359 = x3_341[@i_467]) && ((x4_358 = x4_340[@i_467]) && (x5_357 = x5_339[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let @i_456 <= NU = j in
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  let x3_347: G = Xp in
  let x4_346: G = Yp in
  let x5_345: G = Kp in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  let @2_x_181: G = cst_G in
  let @2_ke_180: passwd = cst_passwd in
  find [unique] @i_210 <= qD suchthat defined(@2_r4_176[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = @2_r4_176[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@2_r4_188[@i_206], Ystar_u[@i_206]) && ((@2_x = @2_r4_188[@i_206]) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  let @2_m_178: G = cst_G in
  let @2_kd_177: passwd = cst_passwd in
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @2_r4_176[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @2_r4_176[@i_200])
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @2_r4_188[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @2_r4_188[@i_196])
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @2_r4_176: G;
    out(@2_c4[!_61], @2_r4_176)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_343: host = x1 in
  let x2_342: host = x2 in
  let x3_341: G = x3 in
  let x4_340: G = x4 in
  let x5_339: G = x5 in
  find [unique] @i_428 <= qH0 suchthat defined(x1_343[@i_428], x2_342[@i_428], x3_341[@i_428], x4_340[@i_428], x5_339[@i_428], r_338[@i_428]) && ((x1_343 = x1_343[@i_428]) && ((x2_342 = x2_342[@i_428]) && ((x3_341 = x3_341[@i_428]) && ((x4_340 = x4_340[@i_428]) && (x5_339 = x5_339[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(x1_349[@i_427], x2_348[@i_427], x3_347[@i_427], x4_346[@i_427], x5_345[@i_427], r_344[@i_427]) && ((x1_343 = x1_349[@i_427]) && ((x2_342 = x2_348[@i_427]) && ((x3_341 = x3_347[@i_427]) && ((x4_340 = x4_346[@i_427]) && (x5_339 = x5_345[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(x1_355[@i_426], x2_354[@i_426], x3_353[@i_426], x4_352[@i_426], x5_351[@i_426], r_350[@i_426]) && ((x1_343 = x1_355[@i_426]) && ((x2_342 = x2_354[@i_426]) && ((x3_341 = x3_353[@i_426]) && ((x4_340 = x4_352[@i_426]) && (x5_339 = x5_351[@i_426]))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(x1_361[@i_425], x2_360[@i_425], x3_359[@i_425], x4_358[@i_425], x5_357[@i_425], r_356[@i_425]) && ((x1_343 = x1_361[@i_425]) && ((x2_342 = x2_360[@i_425]) && ((x3_341 = x3_359[@i_425]) && ((x4_340 = x4_358[@i_425]) && (x5_339 = x5_357[@i_425]))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(x1_367[@i_424], x2_366[@i_424], x3_365[@i_424], x4_364[@i_424], x5_363[@i_424], r_362[@i_424]) && ((x1_343 = x1_367[@i_424]) && ((x2_342 = x2_366[@i_424]) && ((x3_341 = x3_365[@i_424]) && ((x4_340 = x4_364[@i_424]) && (x5_339 = x5_363[@i_424]))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(x1_373[@i_423], x2_372[@i_423], x3_371[@i_423], x4_370[@i_423], x5_369[@i_423], r_368[@i_423]) && ((x1_343 = x1_373[@i_423]) && ((x2_342 = x2_372[@i_423]) && ((x3_341 = x3_371[@i_423]) && ((x4_340 = x4_370[@i_423]) && (x5_339 = x5_369[@i_423]))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(x1_379[@i_422], x2_378[@i_422], x3_377[@i_422], x4_376[@i_422], x5_375[@i_422], r_374[@i_422]) && ((x1_343 = x1_379[@i_422]) && ((x2_342 = x2_378[@i_422]) && ((x3_341 = x3_377[@i_422]) && ((x4_340 = x4_376[@i_422]) && (x5_339 = x5_375[@i_422]))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(x1_385[@i_421], x2_384[@i_421], x3_383[@i_421], x4_382[@i_421], x5_381[@i_421], r_380[@i_421]) && ((x1_343 = x1_385[@i_421]) && ((x2_342 = x2_384[@i_421]) && ((x3_341 = x3_383[@i_421]) && ((x4_340 = x4_382[@i_421]) && (x5_339 = x5_381[@i_421]))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(x1_391[@i_420], x2_390[@i_420], x3_389[@i_420], x4_388[@i_420], x5_387[@i_420], r_386[@i_420]) && ((x1_343 = x1_391[@i_420]) && ((x2_342 = x2_390[@i_420]) && ((x3_341 = x3_389[@i_420]) && ((x4_340 = x4_388[@i_420]) && (x5_339 = x5_387[@i_420]))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(x1_397[@i_419], x2_396[@i_419], x3_395[@i_419], x4_394[@i_419], x5_393[@i_419], r_392[@i_419]) && ((x1_343 = x1_397[@i_419]) && ((x2_342 = x2_396[@i_419]) && ((x3_341 = x3_395[@i_419]) && ((x4_340 = x4_394[@i_419]) && (x5_339 = x5_393[@i_419]))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(x1_403[@i_418], x2_402[@i_418], x3_401[@i_418], x4_400[@i_418], x5_399[@i_418], r_398[@i_418]) && ((x1_343 = x1_403[@i_418]) && ((x2_342 = x2_402[@i_418]) && ((x3_341 = x3_401[@i_418]) && ((x4_340 = x4_400[@i_418]) && (x5_339 = x5_399[@i_418]))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(x1_409[@i_417], x2_408[@i_417], x3_407[@i_417], x4_406[@i_417], x5_405[@i_417], r_404[@i_417]) && ((x1_343 = x1_409[@i_417]) && ((x2_342 = x2_408[@i_417]) && ((x3_341 = x3_407[@i_417]) && ((x4_340 = x4_406[@i_417]) && (x5_339 = x5_405[@i_417]))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(x1_415[@i_416], x2_414[@i_416], x3_413[@i_416], x4_412[@i_416], x5_411[@i_416], r_410[@i_416]) && ((x1_343 = x1_415[@i_416]) && ((x2_342 = x2_414[@i_416]) && ((x3_341 = x3_413[@i_416]) && ((x4_340 = x4_412[@i_416]) && (x5_339 = x5_411[@i_416]))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying move all binders yields

Game 16 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @2_r4_176[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = @2_r4_176[@i_240] in
    let K_u: G = exp(@2_r4_176[@i_240], x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@2_r4_176[@i_240] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      let x3_377: G = X in
      let x4_376: G = @2_r4_176[@i_240] in
      let x5_375: G = K_u in
      find [unique] @i_506 <= qH0 suchthat defined(x1_343[@i_506], x2_342[@i_506], x3_341[@i_506], x4_340[@i_506], x5_339[@i_506], r_338[@i_506]) && ((x1_379 = x1_343[@i_506]) && ((x2_378 = x2_342[@i_506]) && ((x3_377 = x3_341[@i_506]) && ((x4_376 = x4_340[@i_506]) && (x5_375 = x5_339[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      let x3_371: G = X in
      let x4_370: G = @2_r4_176[@i_240] in
      let x5_369: G = K_u in
      find [unique] @i_493 <= qH0 suchthat defined(x1_343[@i_493], x2_342[@i_493], x3_341[@i_493], x4_340[@i_493], x5_339[@i_493], r_338[@i_493]) && ((x1_373 = x1_343[@i_493]) && ((x2_372 = x2_342[@i_493]) && ((x3_371 = x3_341[@i_493]) && ((x4_370 = x4_340[@i_493]) && (x5_369 = x5_339[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @2_r4_188[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = @2_r4_188[@i_236] in
    let K_u: G = exp(@2_r4_188[@i_236], x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@2_r4_188[@i_236] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      let x3_389: G = X in
      let x4_388: G = @2_r4_188[@i_236] in
      let x5_387: G = K_u in
      find [unique] @i_532 <= qH0 suchthat defined(x1_343[@i_532], x2_342[@i_532], x3_341[@i_532], x4_340[@i_532], x5_339[@i_532], r_338[@i_532]) && ((x1_391 = x1_343[@i_532]) && ((x2_390 = x2_342[@i_532]) && ((x3_389 = x3_341[@i_532]) && ((x4_388 = x4_340[@i_532]) && (x5_387 = x5_339[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      let x3_383: G = X in
      let x4_382: G = @2_r4_188[@i_236] in
      let x5_381: G = K_u in
      find [unique] @i_519 <= qH0 suchthat defined(x1_343[@i_519], x2_342[@i_519], x3_341[@i_519], x4_340[@i_519], x5_339[@i_519], r_338[@i_519]) && ((x1_385 = x1_343[@i_519]) && ((x2_384 = x2_342[@i_519]) && ((x3_383 = x3_341[@i_519]) && ((x4_382 = x4_340[@i_519]) && (x5_381 = x5_339[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      let x3_401: G = X in
      let x4_400: G = Yp[@i_233] in
      let x5_399: G = K_u in
      find [unique] @i_558 <= qH0 suchthat defined(x1_343[@i_558], x2_342[@i_558], x3_341[@i_558], x4_340[@i_558], x5_339[@i_558], r_338[@i_558]) && ((x1_403 = x1_343[@i_558]) && ((x2_402 = x2_342[@i_558]) && ((x3_401 = x3_341[@i_558]) && ((x4_400 = x4_340[@i_558]) && (x5_399 = x5_339[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      let x3_395: G = X in
      let x4_394: G = Yp[@i_233] in
      let x5_393: G = K_u in
      find [unique] @i_545 <= qH0 suchthat defined(x1_343[@i_545], x2_342[@i_545], x3_341[@i_545], x4_340[@i_545], x5_339[@i_545], r_338[@i_545]) && ((x1_397 = x1_343[@i_545]) && ((x2_396 = x2_342[@i_545]) && ((x3_395 = x3_341[@i_545]) && ((x4_394 = x4_340[@i_545]) && (x5_393 = x5_339[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      let x3_413: G = X in
      let x4_412: G = Y[@i_232] in
      let x5_411: G = K_u in
      find [unique] @i_584 <= qH0 suchthat defined(x1_343[@i_584], x2_342[@i_584], x3_341[@i_584], x4_340[@i_584], x5_339[@i_584], r_338[@i_584]) && ((x1_415 = x1_343[@i_584]) && ((x2_414 = x2_342[@i_584]) && ((x3_413 = x3_341[@i_584]) && ((x4_412 = x4_340[@i_584]) && (x5_411 = x5_339[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let @i_582 <= NS = @i_232 in
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      let x3_407: G = X in
      let x4_406: G = Y[@i_232] in
      let x5_405: G = K_u in
      find [unique] @i_571 <= qH0 suchthat defined(x1_343[@i_571], x2_342[@i_571], x3_341[@i_571], x4_340[@i_571], x5_339[@i_571], r_338[@i_571]) && ((x1_409 = x1_343[@i_571]) && ((x2_408 = x2_342[@i_571]) && ((x3_407 = x3_341[@i_571]) && ((x4_406 = x4_340[@i_571]) && (x5_405 = x5_339[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
  )
  else
    new @2_r4_188: G;
    let Y_u: G = @2_r4_188 in
    let K_u: G = exp(@2_r4_188, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    let x3_365: G = X in
    let x4_364: G = @2_r4_188 in
    let x5_363: G = K_u in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, sk_u);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      let x3_353: G = X_s in
      let x4_352: G = Y in
      let x5_351: G = K_s in
      find [unique] @i_454 <= qH0 suchthat defined(x1_343[@i_454], x2_342[@i_454], x3_341[@i_454], x4_340[@i_454], x5_339[@i_454], r_338[@i_454]) && ((x1_355 = x1_343[@i_454]) && ((x2_354 = x2_342[@i_454]) && ((x3_353 = x3_341[@i_454]) && ((x4_352 = x4_340[@i_454]) && (x5_351 = x5_339[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let @i_443 <= NU = j in
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let @i_442 <= NU = j in
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      let x3_359: G = X_s in
      let x4_358: G = Y in
      let x5_357: G = K_s in
      find [unique] @i_467 <= qH0 suchthat defined(x1_343[@i_467], x2_342[@i_467], x3_341[@i_467], x4_340[@i_467], x5_339[@i_467], r_338[@i_467]) && ((x1_361 = x1_343[@i_467]) && ((x2_360 = x2_342[@i_467]) && ((x3_359 = x3_341[@i_467]) && ((x4_358 = x4_340[@i_467]) && (x5_357 = x5_339[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let @i_456 <= NU = j in
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  let x3_347: G = Xp in
  let x4_346: G = Yp in
  let x5_345: G = Kp in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@2_r4_176[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = @2_r4_176[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@2_r4_188[@i_206], Ystar_u[@i_206]) && ((@2_x = @2_r4_188[@i_206]) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @2_r4_176[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @2_r4_176[@i_200])
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @2_r4_188[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @2_r4_188[@i_196])
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @2_r4_176: G;
    out(@2_c4[!_61], @2_r4_176)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_343: host = x1 in
  let x2_342: host = x2 in
  let x3_341: G = x3 in
  let x4_340: G = x4 in
  let x5_339: G = x5 in
  find [unique] @i_428 <= qH0 suchthat defined(x1_343[@i_428], x2_342[@i_428], x3_341[@i_428], x4_340[@i_428], x5_339[@i_428], r_338[@i_428]) && ((x1_343 = x1_343[@i_428]) && ((x2_342 = x2_342[@i_428]) && ((x3_341 = x3_341[@i_428]) && ((x4_340 = x4_340[@i_428]) && (x5_339 = x5_339[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(x1_349[@i_427], x2_348[@i_427], x3_347[@i_427], x4_346[@i_427], x5_345[@i_427], r_344[@i_427]) && ((x1_343 = x1_349[@i_427]) && ((x2_342 = x2_348[@i_427]) && ((x3_341 = x3_347[@i_427]) && ((x4_340 = x4_346[@i_427]) && (x5_339 = x5_345[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(x1_355[@i_426], x2_354[@i_426], x3_353[@i_426], x4_352[@i_426], x5_351[@i_426], r_350[@i_426]) && ((x1_343 = x1_355[@i_426]) && ((x2_342 = x2_354[@i_426]) && ((x3_341 = x3_353[@i_426]) && ((x4_340 = x4_352[@i_426]) && (x5_339 = x5_351[@i_426]))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(x1_361[@i_425], x2_360[@i_425], x3_359[@i_425], x4_358[@i_425], x5_357[@i_425], r_356[@i_425]) && ((x1_343 = x1_361[@i_425]) && ((x2_342 = x2_360[@i_425]) && ((x3_341 = x3_359[@i_425]) && ((x4_340 = x4_358[@i_425]) && (x5_339 = x5_357[@i_425]))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(x1_367[@i_424], x2_366[@i_424], x3_365[@i_424], x4_364[@i_424], x5_363[@i_424], r_362[@i_424]) && ((x1_343 = x1_367[@i_424]) && ((x2_342 = x2_366[@i_424]) && ((x3_341 = x3_365[@i_424]) && ((x4_340 = x4_364[@i_424]) && (x5_339 = x5_363[@i_424]))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(x1_373[@i_423], x2_372[@i_423], x3_371[@i_423], x4_370[@i_423], x5_369[@i_423], r_368[@i_423]) && ((x1_343 = x1_373[@i_423]) && ((x2_342 = x2_372[@i_423]) && ((x3_341 = x3_371[@i_423]) && ((x4_340 = x4_370[@i_423]) && (x5_339 = x5_369[@i_423]))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(x1_379[@i_422], x2_378[@i_422], x3_377[@i_422], x4_376[@i_422], x5_375[@i_422], r_374[@i_422]) && ((x1_343 = x1_379[@i_422]) && ((x2_342 = x2_378[@i_422]) && ((x3_341 = x3_377[@i_422]) && ((x4_340 = x4_376[@i_422]) && (x5_339 = x5_375[@i_422]))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(x1_385[@i_421], x2_384[@i_421], x3_383[@i_421], x4_382[@i_421], x5_381[@i_421], r_380[@i_421]) && ((x1_343 = x1_385[@i_421]) && ((x2_342 = x2_384[@i_421]) && ((x3_341 = x3_383[@i_421]) && ((x4_340 = x4_382[@i_421]) && (x5_339 = x5_381[@i_421]))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(x1_391[@i_420], x2_390[@i_420], x3_389[@i_420], x4_388[@i_420], x5_387[@i_420], r_386[@i_420]) && ((x1_343 = x1_391[@i_420]) && ((x2_342 = x2_390[@i_420]) && ((x3_341 = x3_389[@i_420]) && ((x4_340 = x4_388[@i_420]) && (x5_339 = x5_387[@i_420]))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(x1_397[@i_419], x2_396[@i_419], x3_395[@i_419], x4_394[@i_419], x5_393[@i_419], r_392[@i_419]) && ((x1_343 = x1_397[@i_419]) && ((x2_342 = x2_396[@i_419]) && ((x3_341 = x3_395[@i_419]) && ((x4_340 = x4_394[@i_419]) && (x5_339 = x5_393[@i_419]))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(x1_403[@i_418], x2_402[@i_418], x3_401[@i_418], x4_400[@i_418], x5_399[@i_418], r_398[@i_418]) && ((x1_343 = x1_403[@i_418]) && ((x2_342 = x2_402[@i_418]) && ((x3_341 = x3_401[@i_418]) && ((x4_340 = x4_400[@i_418]) && (x5_339 = x5_399[@i_418]))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(x1_409[@i_417], x2_408[@i_417], x3_407[@i_417], x4_406[@i_417], x5_405[@i_417], r_404[@i_417]) && ((x1_343 = x1_409[@i_417]) && ((x2_342 = x2_408[@i_417]) && ((x3_341 = x3_407[@i_417]) && ((x4_340 = x4_406[@i_417]) && (x5_339 = x5_405[@i_417]))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(x1_415[@i_416], x2_414[@i_416], x3_413[@i_416], x4_412[@i_416], x5_411[@i_416], r_410[@i_416]) && ((x1_343 = x1_415[@i_416]) && ((x2_342 = x2_414[@i_416]) && ((x3_341 = x3_413[@i_416]) && ((x4_340 = x4_412[@i_416]) && (x5_339 = x5_411[@i_416]))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of useless yields

Game 17 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @2_r4_176[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = @2_r4_176[@i_240] in
    let K_u: G = exp(@2_r4_176[@i_240], x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@2_r4_176[@i_240] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      find [unique] @i_506 <= qH0 suchthat defined(x1[@i_506], x2[@i_506], x3[@i_506], x4[@i_506], x5[@i_506], x5_339[@i_506], x4_340[@i_506], x3_341[@i_506], x2_342[@i_506], x1_343[@i_506], r_338[@i_506]) && ((x1_379 = x1[@i_506]) && ((x2_378 = x2[@i_506]) && ((X = x3[@i_506]) && ((@2_r4_176[@i_240] = x4[@i_506]) && (K_u = x5[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_506]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_374);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      find [unique] @i_493 <= qH0 suchthat defined(x1[@i_493], x2[@i_493], x3[@i_493], x4[@i_493], x5[@i_493], x5_339[@i_493], x4_340[@i_493], x3_341[@i_493], x2_342[@i_493], x1_343[@i_493], r_338[@i_493]) && ((x1_373 = x1[@i_493]) && ((x2_372 = x2[@i_493]) && ((X = x3[@i_493]) && ((@2_r4_176[@i_240] = x4[@i_493]) && (K_u = x5[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_493]);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_368);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @2_r4_188[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = @2_r4_188[@i_236] in
    let K_u: G = exp(@2_r4_188[@i_236], x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@2_r4_188[@i_236] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      find [unique] @i_532 <= qH0 suchthat defined(x1[@i_532], x2[@i_532], x3[@i_532], x4[@i_532], x5[@i_532], x5_339[@i_532], x4_340[@i_532], x3_341[@i_532], x2_342[@i_532], x1_343[@i_532], r_338[@i_532]) && ((x1_391 = x1[@i_532]) && ((x2_390 = x2[@i_532]) && ((X = x3[@i_532]) && ((@2_r4_188[@i_236] = x4[@i_532]) && (K_u = x5[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_532]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_386);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      find [unique] @i_519 <= qH0 suchthat defined(x1[@i_519], x2[@i_519], x3[@i_519], x4[@i_519], x5[@i_519], x5_339[@i_519], x4_340[@i_519], x3_341[@i_519], x2_342[@i_519], x1_343[@i_519], r_338[@i_519]) && ((x1_385 = x1[@i_519]) && ((x2_384 = x2[@i_519]) && ((X = x3[@i_519]) && ((@2_r4_188[@i_236] = x4[@i_519]) && (K_u = x5[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_519]);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_380);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      find [unique] @i_558 <= qH0 suchthat defined(x1[@i_558], x2[@i_558], x3[@i_558], x4[@i_558], x5[@i_558], x5_339[@i_558], x4_340[@i_558], x3_341[@i_558], x2_342[@i_558], x1_343[@i_558], r_338[@i_558]) && ((x1_403 = x1[@i_558]) && ((x2_402 = x2[@i_558]) && ((X = x3[@i_558]) && ((Yp[@i_233] = x4[@i_558]) && (K_u = x5[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_558]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_398);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      find [unique] @i_545 <= qH0 suchthat defined(x1[@i_545], x2[@i_545], x3[@i_545], x4[@i_545], x5[@i_545], x5_339[@i_545], x4_340[@i_545], x3_341[@i_545], x2_342[@i_545], x1_343[@i_545], r_338[@i_545]) && ((x1_397 = x1[@i_545]) && ((x2_396 = x2[@i_545]) && ((X = x3[@i_545]) && ((Yp[@i_233] = x4[@i_545]) && (K_u = x5[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_545]);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_392);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      find [unique] @i_584 <= qH0 suchthat defined(x1[@i_584], x2[@i_584], x3[@i_584], x4[@i_584], x5[@i_584], x5_339[@i_584], x4_340[@i_584], x3_341[@i_584], x2_342[@i_584], x1_343[@i_584], r_338[@i_584]) && ((x1_415 = x1[@i_584]) && ((x2_414 = x2[@i_584]) && ((X = x3[@i_584]) && ((Y[@i_232] = x4[@i_584]) && (K_u = x5[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_584]);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_350[@i_232]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_410);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      find [unique] @i_571 <= qH0 suchthat defined(x1[@i_571], x2[@i_571], x3[@i_571], x4[@i_571], x5[@i_571], x5_339[@i_571], x4_340[@i_571], x3_341[@i_571], x2_342[@i_571], x1_343[@i_571], r_338[@i_571]) && ((x1_409 = x1[@i_571]) && ((x2_408 = x2[@i_571]) && ((X = x3[@i_571]) && ((Y[@i_232] = x4[@i_571]) && (K_u = x5[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_571]);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_404);
        out(c6[!_57], r1_94)
  )
  else
    new @2_r4_188: G;
    let Y_u: G = @2_r4_188 in
    let K_u: G = exp(@2_r4_188, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      find [unique] @i_454 <= qH0 suchthat defined(x1[@i_454], x2[@i_454], x3[@i_454], x4[@i_454], x5[@i_454], x5_339[@i_454], x4_340[@i_454], x3_341[@i_454], x2_342[@i_454], x1_343[@i_454], r_338[@i_454]) && ((x1_355 = x1[@i_454]) && ((x2_354 = x2[@i_454]) && ((X_s = x3[@i_454]) && ((Y = x4[@i_454]) && (K_s = x5[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_454])
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_410[j])
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_350)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], x5_339[@i_467], x4_340[@i_467], x3_341[@i_467], x2_342[@i_467], x1_343[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (K_s = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@2_r4_176[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = @2_r4_176[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@2_r4_188[@i_206], Ystar_u[@i_206]) && ((@2_x = @2_r4_188[@i_206]) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @2_r4_176[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @2_r4_176[@i_200])
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @2_r4_188[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @2_r4_188[@i_196])
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @2_r4_176: G;
    out(@2_c4[!_61], @2_r4_176)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_343: host = cst_host in
  let x2_342: host = cst_host in
  let x3_341: G = cst_G in
  let x4_340: G = cst_G in
  let x5_339: G = cst_G in
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], x5_339[@i_428], x4_340[@i_428], x3_341[@i_428], x2_342[@i_428], x1_343[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(Xp[@i_427], Yp[@i_427], Kp[@i_427], xp[@i_427], xp[@i_427], xp[@i_427], x1_349[@i_427], x2_348[@i_427], r_344[@i_427]) && ((x1 = x1_349[@i_427]) && ((x2 = x2_348[@i_427]) && ((x3 = Xp[@i_427]) && ((x4 = Yp[@i_427]) && (x5 = Kp[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(X_s[@i_426], Y[@i_426], K_s[@i_426], x1_355[@i_426], x1_355[@i_426], x1_355[@i_426], x1_355[@i_426], x2_354[@i_426], r_350[@i_426]) && ((x1 = x1_355[@i_426]) && ((x2 = x2_354[@i_426]) && ((x3 = X_s[@i_426]) && ((x4 = Y[@i_426]) && (x5 = K_s[@i_426]))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(X_s[@i_425], Y[@i_425], K_s[@i_425], x1_361[@i_425], x1_361[@i_425], x1_361[@i_425], x1_361[@i_425], x2_360[@i_425], r_356[@i_425]) && ((x1 = x1_361[@i_425]) && ((x2 = x2_360[@i_425]) && ((x3 = X_s[@i_425]) && ((x4 = Y[@i_425]) && (x5 = K_s[@i_425]))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(X[@i_424], @2_r4_188[@i_424], K_u[@i_424], @2_r4_188[@i_424], @2_r4_188[@i_424], @2_r4_188[@i_424], x1_367[@i_424], x2_366[@i_424], r_362[@i_424]) && ((x1 = x1_367[@i_424]) && ((x2 = x2_366[@i_424]) && ((x3 = X[@i_424]) && ((x4 = @2_r4_188[@i_424]) && (x5 = K_u[@i_424]))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(X[@i_423], @2_r4_176[@i_240[@i_423]], K_u[@i_423], x1_373[@i_423], x1_373[@i_423], x1_373[@i_423], x1_373[@i_423], x2_372[@i_423], r_368[@i_423]) && ((x1 = x1_373[@i_423]) && ((x2 = x2_372[@i_423]) && ((x3 = X[@i_423]) && ((x4 = @2_r4_176[@i_240[@i_423]]) && (x5 = K_u[@i_423]))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(X[@i_422], @2_r4_176[@i_240[@i_422]], K_u[@i_422], x1_379[@i_422], x1_379[@i_422], x1_379[@i_422], x1_379[@i_422], x2_378[@i_422], r_374[@i_422]) && ((x1 = x1_379[@i_422]) && ((x2 = x2_378[@i_422]) && ((x3 = X[@i_422]) && ((x4 = @2_r4_176[@i_240[@i_422]]) && (x5 = K_u[@i_422]))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(X[@i_421], @2_r4_188[@i_236[@i_421]], K_u[@i_421], x1_385[@i_421], x1_385[@i_421], x1_385[@i_421], x1_385[@i_421], x2_384[@i_421], r_380[@i_421]) && ((x1 = x1_385[@i_421]) && ((x2 = x2_384[@i_421]) && ((x3 = X[@i_421]) && ((x4 = @2_r4_188[@i_236[@i_421]]) && (x5 = K_u[@i_421]))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(X[@i_420], @2_r4_188[@i_236[@i_420]], K_u[@i_420], x1_391[@i_420], x1_391[@i_420], x1_391[@i_420], x1_391[@i_420], x2_390[@i_420], r_386[@i_420]) && ((x1 = x1_391[@i_420]) && ((x2 = x2_390[@i_420]) && ((x3 = X[@i_420]) && ((x4 = @2_r4_188[@i_236[@i_420]]) && (x5 = K_u[@i_420]))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(X[@i_419], Yp[@i_233[@i_419]], K_u[@i_419], x1_397[@i_419], x1_397[@i_419], x1_397[@i_419], x1_397[@i_419], x2_396[@i_419], r_392[@i_419]) && ((x1 = x1_397[@i_419]) && ((x2 = x2_396[@i_419]) && ((x3 = X[@i_419]) && ((x4 = Yp[@i_233[@i_419]]) && (x5 = K_u[@i_419]))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(X[@i_418], Yp[@i_233[@i_418]], K_u[@i_418], x1_403[@i_418], x1_403[@i_418], x1_403[@i_418], x1_403[@i_418], x2_402[@i_418], r_398[@i_418]) && ((x1 = x1_403[@i_418]) && ((x2 = x2_402[@i_418]) && ((x3 = X[@i_418]) && ((x4 = Yp[@i_233[@i_418]]) && (x5 = K_u[@i_418]))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(X[@i_417], Y[@i_232[@i_417]], K_u[@i_417], x1_409[@i_417], x1_409[@i_417], x1_409[@i_417], x1_409[@i_417], x2_408[@i_417], r_404[@i_417]) && ((x1 = x1_409[@i_417]) && ((x2 = x2_408[@i_417]) && ((x3 = X[@i_417]) && ((x4 = Y[@i_232[@i_417]]) && (x5 = K_u[@i_417]))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(X[@i_416], Y[@i_232[@i_416]], K_u[@i_416], x1_415[@i_416], x1_415[@i_416], x1_415[@i_416], x1_415[@i_416], x2_414[@i_416], r_410[@i_416]) && ((x1 = x1_415[@i_416]) && ((x2 = x2_414[@i_416]) && ((x3 = X[@i_416]) && ((x4 = Y[@i_232[@i_416]]) && (x5 = K_u[@i_416]))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying equivalence
equiv ! !_1 <= @1_N new @1_X: G; (
  @1_OX() := @1_X,
  ! !_2 <= @1_N' @1_OXm(@1_m: exponent) := exp(@1_X, @1_m))
<=(0)=>
      ! !_3 <= @1_N new @1_x: exponent; (
  @1_OX() := exp(g, @1_x),
  ! !_4 <= @1_N' @1_OXm(@1_m: exponent) := exp(g, mult(@1_x, @1_m)))
 yields

Game 18 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@1_x_737[@i_240], @2_m[@i_240], @2_kd[@i_240], @2_r4_176[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = exp(g, @1_x_737[@i_240]) in
    let K_u: G = exp(g, mult(@1_x_737[@i_240], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_737[@i_240]) = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      find [unique] @i_506 <= qH0 suchthat defined(x1[@i_506], x2[@i_506], x3[@i_506], x4[@i_506], x5[@i_506], x5_339[@i_506], x4_340[@i_506], x3_341[@i_506], x2_342[@i_506], x1_343[@i_506], r_338[@i_506]) && ((x1_379 = x1[@i_506]) && ((x2_378 = x2[@i_506]) && ((X = x3[@i_506]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_506]) && (K_u = x5[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_506]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_374);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      find [unique] @i_493 <= qH0 suchthat defined(x1[@i_493], x2[@i_493], x3[@i_493], x4[@i_493], x5[@i_493], x5_339[@i_493], x4_340[@i_493], x3_341[@i_493], x2_342[@i_493], x1_343[@i_493], r_338[@i_493]) && ((x1_373 = x1[@i_493]) && ((x2_372 = x2[@i_493]) && ((X = x3[@i_493]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_493]) && (K_u = x5[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_493]);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_368);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @2_r4_188[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = @2_r4_188[@i_236] in
    let K_u: G = exp(@2_r4_188[@i_236], x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@2_r4_188[@i_236] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      find [unique] @i_532 <= qH0 suchthat defined(x1[@i_532], x2[@i_532], x3[@i_532], x4[@i_532], x5[@i_532], x5_339[@i_532], x4_340[@i_532], x3_341[@i_532], x2_342[@i_532], x1_343[@i_532], r_338[@i_532]) && ((x1_391 = x1[@i_532]) && ((x2_390 = x2[@i_532]) && ((X = x3[@i_532]) && ((@2_r4_188[@i_236] = x4[@i_532]) && (K_u = x5[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_532]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_386);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      find [unique] @i_519 <= qH0 suchthat defined(x1[@i_519], x2[@i_519], x3[@i_519], x4[@i_519], x5[@i_519], x5_339[@i_519], x4_340[@i_519], x3_341[@i_519], x2_342[@i_519], x1_343[@i_519], r_338[@i_519]) && ((x1_385 = x1[@i_519]) && ((x2_384 = x2[@i_519]) && ((X = x3[@i_519]) && ((@2_r4_188[@i_236] = x4[@i_519]) && (K_u = x5[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_519]);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_380);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      find [unique] @i_558 <= qH0 suchthat defined(x1[@i_558], x2[@i_558], x3[@i_558], x4[@i_558], x5[@i_558], x5_339[@i_558], x4_340[@i_558], x3_341[@i_558], x2_342[@i_558], x1_343[@i_558], r_338[@i_558]) && ((x1_403 = x1[@i_558]) && ((x2_402 = x2[@i_558]) && ((X = x3[@i_558]) && ((Yp[@i_233] = x4[@i_558]) && (K_u = x5[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_558]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_398);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      find [unique] @i_545 <= qH0 suchthat defined(x1[@i_545], x2[@i_545], x3[@i_545], x4[@i_545], x5[@i_545], x5_339[@i_545], x4_340[@i_545], x3_341[@i_545], x2_342[@i_545], x1_343[@i_545], r_338[@i_545]) && ((x1_397 = x1[@i_545]) && ((x2_396 = x2[@i_545]) && ((X = x3[@i_545]) && ((Yp[@i_233] = x4[@i_545]) && (K_u = x5[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_545]);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_392);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      find [unique] @i_584 <= qH0 suchthat defined(x1[@i_584], x2[@i_584], x3[@i_584], x4[@i_584], x5[@i_584], x5_339[@i_584], x4_340[@i_584], x3_341[@i_584], x2_342[@i_584], x1_343[@i_584], r_338[@i_584]) && ((x1_415 = x1[@i_584]) && ((x2_414 = x2[@i_584]) && ((X = x3[@i_584]) && ((Y[@i_232] = x4[@i_584]) && (K_u = x5[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_584]);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_350[@i_232]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_410);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      find [unique] @i_571 <= qH0 suchthat defined(x1[@i_571], x2[@i_571], x3[@i_571], x4[@i_571], x5[@i_571], x5_339[@i_571], x4_340[@i_571], x3_341[@i_571], x2_342[@i_571], x1_343[@i_571], r_338[@i_571]) && ((x1_409 = x1[@i_571]) && ((x2_408 = x2[@i_571]) && ((X = x3[@i_571]) && ((Y[@i_232] = x4[@i_571]) && (K_u = x5[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_571]);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_404);
        out(c6[!_57], r1_94)
  )
  else
    new @2_r4_188: G;
    let Y_u: G = @2_r4_188 in
    let K_u: G = exp(@2_r4_188, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      find [unique] @i_454 <= qH0 suchthat defined(x1[@i_454], x2[@i_454], x3[@i_454], x4[@i_454], x5[@i_454], x5_339[@i_454], x4_340[@i_454], x3_341[@i_454], x2_342[@i_454], x1_343[@i_454], r_338[@i_454]) && ((x1_355 = x1[@i_454]) && ((x2_354 = x2[@i_454]) && ((X_s = x3[@i_454]) && ((Y = x4[@i_454]) && (K_s = x5[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_454])
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_410[j])
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_350)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], x5_339[@i_467], x4_340[@i_467], x3_341[@i_467], x2_342[@i_467], x1_343[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (K_s = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @2_r4_176[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = exp(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@2_r4_188[@i_206], Ystar_u[@i_206]) && ((@2_x = @2_r4_188[@i_206]) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@1_x_737[@i_200], @2_m[@i_200], @2_kd[@i_200], @2_r4_176[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], exp(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @2_r4_188[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @2_r4_188[@i_196])
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    let @2_r4_176: G = cst_G in
    out(@2_c4[!_61], exp(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_343: host = cst_host in
  let x2_342: host = cst_host in
  let x3_341: G = cst_G in
  let x4_340: G = cst_G in
  let x5_339: G = cst_G in
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], x5_339[@i_428], x4_340[@i_428], x3_341[@i_428], x2_342[@i_428], x1_343[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(Xp[@i_427], Yp[@i_427], Kp[@i_427], xp[@i_427], xp[@i_427], xp[@i_427], x1_349[@i_427], x2_348[@i_427], r_344[@i_427]) && ((x1 = x1_349[@i_427]) && ((x2 = x2_348[@i_427]) && ((x3 = Xp[@i_427]) && ((x4 = Yp[@i_427]) && (x5 = Kp[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(X_s[@i_426], Y[@i_426], K_s[@i_426], x1_355[@i_426], x1_355[@i_426], x1_355[@i_426], x1_355[@i_426], x2_354[@i_426], r_350[@i_426]) && ((x1 = x1_355[@i_426]) && ((x2 = x2_354[@i_426]) && ((x3 = X_s[@i_426]) && ((x4 = Y[@i_426]) && (x5 = K_s[@i_426]))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(X_s[@i_425], Y[@i_425], K_s[@i_425], x1_361[@i_425], x1_361[@i_425], x1_361[@i_425], x1_361[@i_425], x2_360[@i_425], r_356[@i_425]) && ((x1 = x1_361[@i_425]) && ((x2 = x2_360[@i_425]) && ((x3 = X_s[@i_425]) && ((x4 = Y[@i_425]) && (x5 = K_s[@i_425]))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(X[@i_424], @2_r4_188[@i_424], K_u[@i_424], @2_r4_188[@i_424], @2_r4_188[@i_424], @2_r4_188[@i_424], x1_367[@i_424], x2_366[@i_424], r_362[@i_424]) && ((x1 = x1_367[@i_424]) && ((x2 = x2_366[@i_424]) && ((x3 = X[@i_424]) && ((x4 = @2_r4_188[@i_424]) && (x5 = K_u[@i_424]))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(@1_x_737[@i_240[@i_423]], X[@i_423], @2_r4_176[@i_240[@i_423]], K_u[@i_423], x1_373[@i_423], x1_373[@i_423], x1_373[@i_423], x1_373[@i_423], x2_372[@i_423], r_368[@i_423]) && ((x1 = x1_373[@i_423]) && ((x2 = x2_372[@i_423]) && ((x3 = X[@i_423]) && ((x4 = exp(g, @1_x_737[@i_240[@i_423]])) && (x5 = K_u[@i_423]))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(@1_x_737[@i_240[@i_422]], X[@i_422], @2_r4_176[@i_240[@i_422]], K_u[@i_422], x1_379[@i_422], x1_379[@i_422], x1_379[@i_422], x1_379[@i_422], x2_378[@i_422], r_374[@i_422]) && ((x1 = x1_379[@i_422]) && ((x2 = x2_378[@i_422]) && ((x3 = X[@i_422]) && ((x4 = exp(g, @1_x_737[@i_240[@i_422]])) && (x5 = K_u[@i_422]))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(X[@i_421], @2_r4_188[@i_236[@i_421]], K_u[@i_421], x1_385[@i_421], x1_385[@i_421], x1_385[@i_421], x1_385[@i_421], x2_384[@i_421], r_380[@i_421]) && ((x1 = x1_385[@i_421]) && ((x2 = x2_384[@i_421]) && ((x3 = X[@i_421]) && ((x4 = @2_r4_188[@i_236[@i_421]]) && (x5 = K_u[@i_421]))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(X[@i_420], @2_r4_188[@i_236[@i_420]], K_u[@i_420], x1_391[@i_420], x1_391[@i_420], x1_391[@i_420], x1_391[@i_420], x2_390[@i_420], r_386[@i_420]) && ((x1 = x1_391[@i_420]) && ((x2 = x2_390[@i_420]) && ((x3 = X[@i_420]) && ((x4 = @2_r4_188[@i_236[@i_420]]) && (x5 = K_u[@i_420]))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(X[@i_419], Yp[@i_233[@i_419]], K_u[@i_419], x1_397[@i_419], x1_397[@i_419], x1_397[@i_419], x1_397[@i_419], x2_396[@i_419], r_392[@i_419]) && ((x1 = x1_397[@i_419]) && ((x2 = x2_396[@i_419]) && ((x3 = X[@i_419]) && ((x4 = Yp[@i_233[@i_419]]) && (x5 = K_u[@i_419]))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(X[@i_418], Yp[@i_233[@i_418]], K_u[@i_418], x1_403[@i_418], x1_403[@i_418], x1_403[@i_418], x1_403[@i_418], x2_402[@i_418], r_398[@i_418]) && ((x1 = x1_403[@i_418]) && ((x2 = x2_402[@i_418]) && ((x3 = X[@i_418]) && ((x4 = Yp[@i_233[@i_418]]) && (x5 = K_u[@i_418]))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(X[@i_417], Y[@i_232[@i_417]], K_u[@i_417], x1_409[@i_417], x1_409[@i_417], x1_409[@i_417], x1_409[@i_417], x2_408[@i_417], r_404[@i_417]) && ((x1 = x1_409[@i_417]) && ((x2 = x2_408[@i_417]) && ((x3 = X[@i_417]) && ((x4 = Y[@i_232[@i_417]]) && (x5 = K_u[@i_417]))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(X[@i_416], Y[@i_232[@i_416]], K_u[@i_416], x1_415[@i_416], x1_415[@i_416], x1_415[@i_416], x1_415[@i_416], x2_414[@i_416], r_410[@i_416]) && ((x1 = x1_415[@i_416]) && ((x2 = x2_414[@i_416]) && ((x3 = X[@i_416]) && ((x4 = Y[@i_232[@i_416]]) && (x5 = K_u[@i_416]))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of useless yields

Game 19 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@1_x_737[@i_240], @2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = exp(g, @1_x_737[@i_240]) in
    let K_u: G = exp(g, mult(@1_x_737[@i_240], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_737[@i_240]) = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      find [unique] @i_506 <= qH0 suchthat defined(x1[@i_506], x2[@i_506], x3[@i_506], x4[@i_506], x5[@i_506], x5_339[@i_506], x4_340[@i_506], x3_341[@i_506], x2_342[@i_506], x1_343[@i_506], r_338[@i_506]) && ((x1_379 = x1[@i_506]) && ((x2_378 = x2[@i_506]) && ((X = x3[@i_506]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_506]) && (K_u = x5[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_506]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_374);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      find [unique] @i_493 <= qH0 suchthat defined(x1[@i_493], x2[@i_493], x3[@i_493], x4[@i_493], x5[@i_493], x5_339[@i_493], x4_340[@i_493], x3_341[@i_493], x2_342[@i_493], x1_343[@i_493], r_338[@i_493]) && ((x1_373 = x1[@i_493]) && ((x2_372 = x2[@i_493]) && ((X = x3[@i_493]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_493]) && (K_u = x5[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_493]);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_368);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @2_r4_188[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = @2_r4_188[@i_236] in
    let K_u: G = exp(@2_r4_188[@i_236], x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@2_r4_188[@i_236] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      find [unique] @i_532 <= qH0 suchthat defined(x1[@i_532], x2[@i_532], x3[@i_532], x4[@i_532], x5[@i_532], x5_339[@i_532], x4_340[@i_532], x3_341[@i_532], x2_342[@i_532], x1_343[@i_532], r_338[@i_532]) && ((x1_391 = x1[@i_532]) && ((x2_390 = x2[@i_532]) && ((X = x3[@i_532]) && ((@2_r4_188[@i_236] = x4[@i_532]) && (K_u = x5[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_532]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_386);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      find [unique] @i_519 <= qH0 suchthat defined(x1[@i_519], x2[@i_519], x3[@i_519], x4[@i_519], x5[@i_519], x5_339[@i_519], x4_340[@i_519], x3_341[@i_519], x2_342[@i_519], x1_343[@i_519], r_338[@i_519]) && ((x1_385 = x1[@i_519]) && ((x2_384 = x2[@i_519]) && ((X = x3[@i_519]) && ((@2_r4_188[@i_236] = x4[@i_519]) && (K_u = x5[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_519]);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_380);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      find [unique] @i_558 <= qH0 suchthat defined(x1[@i_558], x2[@i_558], x3[@i_558], x4[@i_558], x5[@i_558], x5_339[@i_558], x4_340[@i_558], x3_341[@i_558], x2_342[@i_558], x1_343[@i_558], r_338[@i_558]) && ((x1_403 = x1[@i_558]) && ((x2_402 = x2[@i_558]) && ((X = x3[@i_558]) && ((Yp[@i_233] = x4[@i_558]) && (K_u = x5[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_558]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_398);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      find [unique] @i_545 <= qH0 suchthat defined(x1[@i_545], x2[@i_545], x3[@i_545], x4[@i_545], x5[@i_545], x5_339[@i_545], x4_340[@i_545], x3_341[@i_545], x2_342[@i_545], x1_343[@i_545], r_338[@i_545]) && ((x1_397 = x1[@i_545]) && ((x2_396 = x2[@i_545]) && ((X = x3[@i_545]) && ((Yp[@i_233] = x4[@i_545]) && (K_u = x5[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_545]);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_392);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      find [unique] @i_584 <= qH0 suchthat defined(x1[@i_584], x2[@i_584], x3[@i_584], x4[@i_584], x5[@i_584], x5_339[@i_584], x4_340[@i_584], x3_341[@i_584], x2_342[@i_584], x1_343[@i_584], r_338[@i_584]) && ((x1_415 = x1[@i_584]) && ((x2_414 = x2[@i_584]) && ((X = x3[@i_584]) && ((Y[@i_232] = x4[@i_584]) && (K_u = x5[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_584]);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_350[@i_232]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_410);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      find [unique] @i_571 <= qH0 suchthat defined(x1[@i_571], x2[@i_571], x3[@i_571], x4[@i_571], x5[@i_571], x5_339[@i_571], x4_340[@i_571], x3_341[@i_571], x2_342[@i_571], x1_343[@i_571], r_338[@i_571]) && ((x1_409 = x1[@i_571]) && ((x2_408 = x2[@i_571]) && ((X = x3[@i_571]) && ((Y[@i_232] = x4[@i_571]) && (K_u = x5[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_571]);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_404);
        out(c6[!_57], r1_94)
  )
  else
    new @2_r4_188: G;
    let Y_u: G = @2_r4_188 in
    let K_u: G = exp(@2_r4_188, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      find [unique] @i_454 <= qH0 suchthat defined(x1[@i_454], x2[@i_454], x3[@i_454], x4[@i_454], x5[@i_454], x5_339[@i_454], x4_340[@i_454], x3_341[@i_454], x2_342[@i_454], x1_343[@i_454], r_338[@i_454]) && ((x1_355 = x1[@i_454]) && ((x2_354 = x2[@i_454]) && ((X_s = x3[@i_454]) && ((Y = x4[@i_454]) && (K_s = x5[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_454])
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_410[j])
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_350)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], x5_339[@i_467], x4_340[@i_467], x3_341[@i_467], x2_342[@i_467], x1_343[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (K_s = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = exp(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@2_r4_188[@i_206], Ystar_u[@i_206]) && ((@2_x = @2_r4_188[@i_206]) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@1_x_737[@i_200], @2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], exp(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @2_r4_188[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @2_r4_188[@i_196])
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], exp(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_343: host = cst_host in
  let x2_342: host = cst_host in
  let x3_341: G = cst_G in
  let x4_340: G = cst_G in
  let x5_339: G = cst_G in
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], x5_339[@i_428], x4_340[@i_428], x3_341[@i_428], x2_342[@i_428], x1_343[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(Xp[@i_427], Yp[@i_427], Kp[@i_427], xp[@i_427], xp[@i_427], xp[@i_427], x1_349[@i_427], x2_348[@i_427], r_344[@i_427]) && ((x1 = x1_349[@i_427]) && ((x2 = x2_348[@i_427]) && ((x3 = Xp[@i_427]) && ((x4 = Yp[@i_427]) && (x5 = Kp[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(X_s[@i_426], Y[@i_426], K_s[@i_426], x1_355[@i_426], x1_355[@i_426], x1_355[@i_426], x1_355[@i_426], x2_354[@i_426], r_350[@i_426]) && ((x1 = x1_355[@i_426]) && ((x2 = x2_354[@i_426]) && ((x3 = X_s[@i_426]) && ((x4 = Y[@i_426]) && (x5 = K_s[@i_426]))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(X_s[@i_425], Y[@i_425], K_s[@i_425], x1_361[@i_425], x1_361[@i_425], x1_361[@i_425], x1_361[@i_425], x2_360[@i_425], r_356[@i_425]) && ((x1 = x1_361[@i_425]) && ((x2 = x2_360[@i_425]) && ((x3 = X_s[@i_425]) && ((x4 = Y[@i_425]) && (x5 = K_s[@i_425]))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(X[@i_424], @2_r4_188[@i_424], K_u[@i_424], @2_r4_188[@i_424], @2_r4_188[@i_424], @2_r4_188[@i_424], x1_367[@i_424], x2_366[@i_424], r_362[@i_424]) && ((x1 = x1_367[@i_424]) && ((x2 = x2_366[@i_424]) && ((x3 = X[@i_424]) && ((x4 = @2_r4_188[@i_424]) && (x5 = K_u[@i_424]))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(@1_x_737[@i_240[@i_423]], X[@i_423], @1_x_737[@i_240[@i_423]], K_u[@i_423], x1_373[@i_423], x1_373[@i_423], x1_373[@i_423], x1_373[@i_423], x2_372[@i_423], r_368[@i_423]) && ((x1 = x1_373[@i_423]) && ((x2 = x2_372[@i_423]) && ((x3 = X[@i_423]) && ((x4 = exp(g, @1_x_737[@i_240[@i_423]])) && (x5 = K_u[@i_423]))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(@1_x_737[@i_240[@i_422]], X[@i_422], @1_x_737[@i_240[@i_422]], K_u[@i_422], x1_379[@i_422], x1_379[@i_422], x1_379[@i_422], x1_379[@i_422], x2_378[@i_422], r_374[@i_422]) && ((x1 = x1_379[@i_422]) && ((x2 = x2_378[@i_422]) && ((x3 = X[@i_422]) && ((x4 = exp(g, @1_x_737[@i_240[@i_422]])) && (x5 = K_u[@i_422]))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(X[@i_421], @2_r4_188[@i_236[@i_421]], K_u[@i_421], x1_385[@i_421], x1_385[@i_421], x1_385[@i_421], x1_385[@i_421], x2_384[@i_421], r_380[@i_421]) && ((x1 = x1_385[@i_421]) && ((x2 = x2_384[@i_421]) && ((x3 = X[@i_421]) && ((x4 = @2_r4_188[@i_236[@i_421]]) && (x5 = K_u[@i_421]))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(X[@i_420], @2_r4_188[@i_236[@i_420]], K_u[@i_420], x1_391[@i_420], x1_391[@i_420], x1_391[@i_420], x1_391[@i_420], x2_390[@i_420], r_386[@i_420]) && ((x1 = x1_391[@i_420]) && ((x2 = x2_390[@i_420]) && ((x3 = X[@i_420]) && ((x4 = @2_r4_188[@i_236[@i_420]]) && (x5 = K_u[@i_420]))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(X[@i_419], Yp[@i_233[@i_419]], K_u[@i_419], x1_397[@i_419], x1_397[@i_419], x1_397[@i_419], x1_397[@i_419], x2_396[@i_419], r_392[@i_419]) && ((x1 = x1_397[@i_419]) && ((x2 = x2_396[@i_419]) && ((x3 = X[@i_419]) && ((x4 = Yp[@i_233[@i_419]]) && (x5 = K_u[@i_419]))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(X[@i_418], Yp[@i_233[@i_418]], K_u[@i_418], x1_403[@i_418], x1_403[@i_418], x1_403[@i_418], x1_403[@i_418], x2_402[@i_418], r_398[@i_418]) && ((x1 = x1_403[@i_418]) && ((x2 = x2_402[@i_418]) && ((x3 = X[@i_418]) && ((x4 = Yp[@i_233[@i_418]]) && (x5 = K_u[@i_418]))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(X[@i_417], Y[@i_232[@i_417]], K_u[@i_417], x1_409[@i_417], x1_409[@i_417], x1_409[@i_417], x1_409[@i_417], x2_408[@i_417], r_404[@i_417]) && ((x1 = x1_409[@i_417]) && ((x2 = x2_408[@i_417]) && ((x3 = X[@i_417]) && ((x4 = Y[@i_232[@i_417]]) && (x5 = K_u[@i_417]))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(X[@i_416], Y[@i_232[@i_416]], K_u[@i_416], x1_415[@i_416], x1_415[@i_416], x1_415[@i_416], x1_415[@i_416], x2_414[@i_416], r_410[@i_416]) && ((x1 = x1_415[@i_416]) && ((x2 = x2_414[@i_416]) && ((x3 = X[@i_416]) && ((x4 = Y[@i_232[@i_416]]) && (x5 = K_u[@i_416]))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying equivalence
equiv ! !_1 <= @1_N new @1_X: G; (
  @1_OX() := @1_X,
  ! !_2 <= @1_N' @1_OXm(@1_m: exponent) := exp(@1_X, @1_m))
<=(0)=>
      ! !_3 <= @1_N new @1_x: exponent; (
  @1_OX() := exp(g, @1_x),
  ! !_4 <= @1_N' @1_OXm(@1_m: exponent) := exp(g, mult(@1_x, @1_m)))
 yields

Game 20 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@1_x_737[@i_240], @2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = exp(g, @1_x_737[@i_240]) in
    let K_u: G = exp(g, mult(@1_x_737[@i_240], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_737[@i_240]) = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      find [unique] @i_506 <= qH0 suchthat defined(x1[@i_506], x2[@i_506], x3[@i_506], x4[@i_506], x5[@i_506], x5_339[@i_506], x4_340[@i_506], x3_341[@i_506], x2_342[@i_506], x1_343[@i_506], r_338[@i_506]) && ((x1_379 = x1[@i_506]) && ((x2_378 = x2[@i_506]) && ((X = x3[@i_506]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_506]) && (K_u = x5[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_506]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_374);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      find [unique] @i_493 <= qH0 suchthat defined(x1[@i_493], x2[@i_493], x3[@i_493], x4[@i_493], x5[@i_493], x5_339[@i_493], x4_340[@i_493], x3_341[@i_493], x2_342[@i_493], x1_343[@i_493], r_338[@i_493]) && ((x1_373 = x1[@i_493]) && ((x2_372 = x2[@i_493]) && ((X = x3[@i_493]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_493]) && (K_u = x5[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_493]);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_368);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(@1_x_874[@i_236], Ystar_u[@i_236], @2_r4_188[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = exp(g, @1_x_874[@i_236]) in
    let K_u: G = exp(g, mult(@1_x_874[@i_236], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_874[@i_236]) = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      find [unique] @i_532 <= qH0 suchthat defined(x1[@i_532], x2[@i_532], x3[@i_532], x4[@i_532], x5[@i_532], x5_339[@i_532], x4_340[@i_532], x3_341[@i_532], x2_342[@i_532], x1_343[@i_532], r_338[@i_532]) && ((x1_391 = x1[@i_532]) && ((x2_390 = x2[@i_532]) && ((X = x3[@i_532]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_532]) && (K_u = x5[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_532]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_386);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      find [unique] @i_519 <= qH0 suchthat defined(x1[@i_519], x2[@i_519], x3[@i_519], x4[@i_519], x5[@i_519], x5_339[@i_519], x4_340[@i_519], x3_341[@i_519], x2_342[@i_519], x1_343[@i_519], r_338[@i_519]) && ((x1_385 = x1[@i_519]) && ((x2_384 = x2[@i_519]) && ((X = x3[@i_519]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_519]) && (K_u = x5[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_519]);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_380);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      find [unique] @i_558 <= qH0 suchthat defined(x1[@i_558], x2[@i_558], x3[@i_558], x4[@i_558], x5[@i_558], x5_339[@i_558], x4_340[@i_558], x3_341[@i_558], x2_342[@i_558], x1_343[@i_558], r_338[@i_558]) && ((x1_403 = x1[@i_558]) && ((x2_402 = x2[@i_558]) && ((X = x3[@i_558]) && ((Yp[@i_233] = x4[@i_558]) && (K_u = x5[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_558]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_398);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      find [unique] @i_545 <= qH0 suchthat defined(x1[@i_545], x2[@i_545], x3[@i_545], x4[@i_545], x5[@i_545], x5_339[@i_545], x4_340[@i_545], x3_341[@i_545], x2_342[@i_545], x1_343[@i_545], r_338[@i_545]) && ((x1_397 = x1[@i_545]) && ((x2_396 = x2[@i_545]) && ((X = x3[@i_545]) && ((Yp[@i_233] = x4[@i_545]) && (K_u = x5[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_545]);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_392);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      find [unique] @i_584 <= qH0 suchthat defined(x1[@i_584], x2[@i_584], x3[@i_584], x4[@i_584], x5[@i_584], x5_339[@i_584], x4_340[@i_584], x3_341[@i_584], x2_342[@i_584], x1_343[@i_584], r_338[@i_584]) && ((x1_415 = x1[@i_584]) && ((x2_414 = x2[@i_584]) && ((X = x3[@i_584]) && ((Y[@i_232] = x4[@i_584]) && (K_u = x5[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_584]);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_350[@i_232]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_410);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      find [unique] @i_571 <= qH0 suchthat defined(x1[@i_571], x2[@i_571], x3[@i_571], x4[@i_571], x5[@i_571], x5_339[@i_571], x4_340[@i_571], x3_341[@i_571], x2_342[@i_571], x1_343[@i_571], r_338[@i_571]) && ((x1_409 = x1[@i_571]) && ((x2_408 = x2[@i_571]) && ((X = x3[@i_571]) && ((Y[@i_232] = x4[@i_571]) && (K_u = x5[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_571]);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_404);
        out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    let @2_r4_188: G = cst_G in
    let Y_u: G = exp(g, @1_x_874) in
    let K_u: G = exp(g, mult(@1_x_874, x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      find [unique] @i_454 <= qH0 suchthat defined(x1[@i_454], x2[@i_454], x3[@i_454], x4[@i_454], x5[@i_454], x5_339[@i_454], x4_340[@i_454], x3_341[@i_454], x2_342[@i_454], x1_343[@i_454], r_338[@i_454]) && ((x1_355 = x1[@i_454]) && ((x2_354 = x2[@i_454]) && ((X_s = x3[@i_454]) && ((Y = x4[@i_454]) && (K_s = x5[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_454])
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_410[j])
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_350)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], x5_339[@i_467], x4_340[@i_467], x3_341[@i_467], x2_342[@i_467], x1_343[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (K_s = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = exp(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], @2_r4_188[@i_206], Ystar_u[@i_206]) && ((@2_x = exp(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@1_x_737[@i_200], @2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], exp(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(@1_x_874[@i_196], Ystar_u[@i_196], @2_r4_188[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], exp(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], exp(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_343: host = cst_host in
  let x2_342: host = cst_host in
  let x3_341: G = cst_G in
  let x4_340: G = cst_G in
  let x5_339: G = cst_G in
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], x5_339[@i_428], x4_340[@i_428], x3_341[@i_428], x2_342[@i_428], x1_343[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(Xp[@i_427], Yp[@i_427], Kp[@i_427], xp[@i_427], xp[@i_427], xp[@i_427], x1_349[@i_427], x2_348[@i_427], r_344[@i_427]) && ((x1 = x1_349[@i_427]) && ((x2 = x2_348[@i_427]) && ((x3 = Xp[@i_427]) && ((x4 = Yp[@i_427]) && (x5 = Kp[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(X_s[@i_426], Y[@i_426], K_s[@i_426], x1_355[@i_426], x1_355[@i_426], x1_355[@i_426], x1_355[@i_426], x2_354[@i_426], r_350[@i_426]) && ((x1 = x1_355[@i_426]) && ((x2 = x2_354[@i_426]) && ((x3 = X_s[@i_426]) && ((x4 = Y[@i_426]) && (x5 = K_s[@i_426]))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(X_s[@i_425], Y[@i_425], K_s[@i_425], x1_361[@i_425], x1_361[@i_425], x1_361[@i_425], x1_361[@i_425], x2_360[@i_425], r_356[@i_425]) && ((x1 = x1_361[@i_425]) && ((x2 = x2_360[@i_425]) && ((x3 = X_s[@i_425]) && ((x4 = Y[@i_425]) && (x5 = K_s[@i_425]))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(@1_x_874[@i_424], @1_x_874[@i_424], @1_x_874[@i_424], @1_x_874[@i_424], X[@i_424], @2_r4_188[@i_424], K_u[@i_424], @2_r4_188[@i_424], @2_r4_188[@i_424], @2_r4_188[@i_424], x1_367[@i_424], x2_366[@i_424], r_362[@i_424]) && ((x1 = x1_367[@i_424]) && ((x2 = x2_366[@i_424]) && ((x3 = X[@i_424]) && ((x4 = exp(g, @1_x_874[@i_424])) && (x5 = K_u[@i_424]))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(@1_x_737[@i_240[@i_423]], X[@i_423], @1_x_737[@i_240[@i_423]], K_u[@i_423], x1_373[@i_423], x1_373[@i_423], x1_373[@i_423], x1_373[@i_423], x2_372[@i_423], r_368[@i_423]) && ((x1 = x1_373[@i_423]) && ((x2 = x2_372[@i_423]) && ((x3 = X[@i_423]) && ((x4 = exp(g, @1_x_737[@i_240[@i_423]])) && (x5 = K_u[@i_423]))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(@1_x_737[@i_240[@i_422]], X[@i_422], @1_x_737[@i_240[@i_422]], K_u[@i_422], x1_379[@i_422], x1_379[@i_422], x1_379[@i_422], x1_379[@i_422], x2_378[@i_422], r_374[@i_422]) && ((x1 = x1_379[@i_422]) && ((x2 = x2_378[@i_422]) && ((x3 = X[@i_422]) && ((x4 = exp(g, @1_x_737[@i_240[@i_422]])) && (x5 = K_u[@i_422]))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(@1_x_874[@i_236[@i_421]], X[@i_421], @2_r4_188[@i_236[@i_421]], K_u[@i_421], x1_385[@i_421], x1_385[@i_421], x1_385[@i_421], x1_385[@i_421], x2_384[@i_421], r_380[@i_421]) && ((x1 = x1_385[@i_421]) && ((x2 = x2_384[@i_421]) && ((x3 = X[@i_421]) && ((x4 = exp(g, @1_x_874[@i_236[@i_421]])) && (x5 = K_u[@i_421]))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(@1_x_874[@i_236[@i_420]], X[@i_420], @2_r4_188[@i_236[@i_420]], K_u[@i_420], x1_391[@i_420], x1_391[@i_420], x1_391[@i_420], x1_391[@i_420], x2_390[@i_420], r_386[@i_420]) && ((x1 = x1_391[@i_420]) && ((x2 = x2_390[@i_420]) && ((x3 = X[@i_420]) && ((x4 = exp(g, @1_x_874[@i_236[@i_420]])) && (x5 = K_u[@i_420]))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(X[@i_419], Yp[@i_233[@i_419]], K_u[@i_419], x1_397[@i_419], x1_397[@i_419], x1_397[@i_419], x1_397[@i_419], x2_396[@i_419], r_392[@i_419]) && ((x1 = x1_397[@i_419]) && ((x2 = x2_396[@i_419]) && ((x3 = X[@i_419]) && ((x4 = Yp[@i_233[@i_419]]) && (x5 = K_u[@i_419]))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(X[@i_418], Yp[@i_233[@i_418]], K_u[@i_418], x1_403[@i_418], x1_403[@i_418], x1_403[@i_418], x1_403[@i_418], x2_402[@i_418], r_398[@i_418]) && ((x1 = x1_403[@i_418]) && ((x2 = x2_402[@i_418]) && ((x3 = X[@i_418]) && ((x4 = Yp[@i_233[@i_418]]) && (x5 = K_u[@i_418]))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(X[@i_417], Y[@i_232[@i_417]], K_u[@i_417], x1_409[@i_417], x1_409[@i_417], x1_409[@i_417], x1_409[@i_417], x2_408[@i_417], r_404[@i_417]) && ((x1 = x1_409[@i_417]) && ((x2 = x2_408[@i_417]) && ((x3 = X[@i_417]) && ((x4 = Y[@i_232[@i_417]]) && (x5 = K_u[@i_417]))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(X[@i_416], Y[@i_232[@i_416]], K_u[@i_416], x1_415[@i_416], x1_415[@i_416], x1_415[@i_416], x1_415[@i_416], x2_414[@i_416], r_410[@i_416]) && ((x1 = x1_415[@i_416]) && ((x2 = x2_414[@i_416]) && ((x3 = X[@i_416]) && ((x4 = Y[@i_232[@i_416]]) && (x5 = K_u[@i_416]))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of useless yields

Game 21 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@1_x_737[@i_240], @2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = exp(g, @1_x_737[@i_240]) in
    let K_u: G = exp(g, mult(@1_x_737[@i_240], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_737[@i_240]) = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      find [unique] @i_506 <= qH0 suchthat defined(x1[@i_506], x2[@i_506], x3[@i_506], x4[@i_506], x5[@i_506], x5_339[@i_506], x4_340[@i_506], x3_341[@i_506], x2_342[@i_506], x1_343[@i_506], r_338[@i_506]) && ((x1_379 = x1[@i_506]) && ((x2_378 = x2[@i_506]) && ((X = x3[@i_506]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_506]) && (K_u = x5[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_506]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_374);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      find [unique] @i_493 <= qH0 suchthat defined(x1[@i_493], x2[@i_493], x3[@i_493], x4[@i_493], x5[@i_493], x5_339[@i_493], x4_340[@i_493], x3_341[@i_493], x2_342[@i_493], x1_343[@i_493], r_338[@i_493]) && ((x1_373 = x1[@i_493]) && ((x2_372 = x2[@i_493]) && ((X = x3[@i_493]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_493]) && (K_u = x5[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_493]);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_368);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(@1_x_874[@i_236], Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = exp(g, @1_x_874[@i_236]) in
    let K_u: G = exp(g, mult(@1_x_874[@i_236], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_874[@i_236]) = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      find [unique] @i_532 <= qH0 suchthat defined(x1[@i_532], x2[@i_532], x3[@i_532], x4[@i_532], x5[@i_532], x5_339[@i_532], x4_340[@i_532], x3_341[@i_532], x2_342[@i_532], x1_343[@i_532], r_338[@i_532]) && ((x1_391 = x1[@i_532]) && ((x2_390 = x2[@i_532]) && ((X = x3[@i_532]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_532]) && (K_u = x5[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_532]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_386);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      find [unique] @i_519 <= qH0 suchthat defined(x1[@i_519], x2[@i_519], x3[@i_519], x4[@i_519], x5[@i_519], x5_339[@i_519], x4_340[@i_519], x3_341[@i_519], x2_342[@i_519], x1_343[@i_519], r_338[@i_519]) && ((x1_385 = x1[@i_519]) && ((x2_384 = x2[@i_519]) && ((X = x3[@i_519]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_519]) && (K_u = x5[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_519]);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_380);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      find [unique] @i_558 <= qH0 suchthat defined(x1[@i_558], x2[@i_558], x3[@i_558], x4[@i_558], x5[@i_558], x5_339[@i_558], x4_340[@i_558], x3_341[@i_558], x2_342[@i_558], x1_343[@i_558], r_338[@i_558]) && ((x1_403 = x1[@i_558]) && ((x2_402 = x2[@i_558]) && ((X = x3[@i_558]) && ((Yp[@i_233] = x4[@i_558]) && (K_u = x5[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_558]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_398);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      find [unique] @i_545 <= qH0 suchthat defined(x1[@i_545], x2[@i_545], x3[@i_545], x4[@i_545], x5[@i_545], x5_339[@i_545], x4_340[@i_545], x3_341[@i_545], x2_342[@i_545], x1_343[@i_545], r_338[@i_545]) && ((x1_397 = x1[@i_545]) && ((x2_396 = x2[@i_545]) && ((X = x3[@i_545]) && ((Yp[@i_233] = x4[@i_545]) && (K_u = x5[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_545]);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_392);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      find [unique] @i_584 <= qH0 suchthat defined(x1[@i_584], x2[@i_584], x3[@i_584], x4[@i_584], x5[@i_584], x5_339[@i_584], x4_340[@i_584], x3_341[@i_584], x2_342[@i_584], x1_343[@i_584], r_338[@i_584]) && ((x1_415 = x1[@i_584]) && ((x2_414 = x2[@i_584]) && ((X = x3[@i_584]) && ((Y[@i_232] = x4[@i_584]) && (K_u = x5[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_584]);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_350[@i_232]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_410);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      find [unique] @i_571 <= qH0 suchthat defined(x1[@i_571], x2[@i_571], x3[@i_571], x4[@i_571], x5[@i_571], x5_339[@i_571], x4_340[@i_571], x3_341[@i_571], x2_342[@i_571], x1_343[@i_571], r_338[@i_571]) && ((x1_409 = x1[@i_571]) && ((x2_408 = x2[@i_571]) && ((X = x3[@i_571]) && ((Y[@i_232] = x4[@i_571]) && (K_u = x5[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_571]);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_404);
        out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    let Y_u: G = exp(g, @1_x_874) in
    let K_u: G = exp(g, mult(@1_x_874, x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      find [unique] @i_454 <= qH0 suchthat defined(x1[@i_454], x2[@i_454], x3[@i_454], x4[@i_454], x5[@i_454], x5_339[@i_454], x4_340[@i_454], x3_341[@i_454], x2_342[@i_454], x1_343[@i_454], r_338[@i_454]) && ((x1_355 = x1[@i_454]) && ((x2_354 = x2[@i_454]) && ((X_s = x3[@i_454]) && ((Y = x4[@i_454]) && (K_s = x5[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_454])
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_410[j])
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_350)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], x5_339[@i_467], x4_340[@i_467], x3_341[@i_467], x2_342[@i_467], x1_343[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (K_s = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = exp(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], @1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = exp(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@1_x_737[@i_200], @2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], exp(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(@1_x_874[@i_196], Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], exp(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], exp(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_343: host = cst_host in
  let x2_342: host = cst_host in
  let x3_341: G = cst_G in
  let x4_340: G = cst_G in
  let x5_339: G = cst_G in
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], x5_339[@i_428], x4_340[@i_428], x3_341[@i_428], x2_342[@i_428], x1_343[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(Xp[@i_427], Yp[@i_427], Kp[@i_427], xp[@i_427], xp[@i_427], xp[@i_427], x1_349[@i_427], x2_348[@i_427], r_344[@i_427]) && ((x1 = x1_349[@i_427]) && ((x2 = x2_348[@i_427]) && ((x3 = Xp[@i_427]) && ((x4 = Yp[@i_427]) && (x5 = Kp[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(X_s[@i_426], Y[@i_426], K_s[@i_426], x1_355[@i_426], x1_355[@i_426], x1_355[@i_426], x1_355[@i_426], x2_354[@i_426], r_350[@i_426]) && ((x1 = x1_355[@i_426]) && ((x2 = x2_354[@i_426]) && ((x3 = X_s[@i_426]) && ((x4 = Y[@i_426]) && (x5 = K_s[@i_426]))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(X_s[@i_425], Y[@i_425], K_s[@i_425], x1_361[@i_425], x1_361[@i_425], x1_361[@i_425], x1_361[@i_425], x2_360[@i_425], r_356[@i_425]) && ((x1 = x1_361[@i_425]) && ((x2 = x2_360[@i_425]) && ((x3 = X_s[@i_425]) && ((x4 = Y[@i_425]) && (x5 = K_s[@i_425]))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(@1_x_874[@i_424], @1_x_874[@i_424], @1_x_874[@i_424], @1_x_874[@i_424], X[@i_424], @1_x_874[@i_424], K_u[@i_424], @1_x_874[@i_424], @1_x_874[@i_424], @1_x_874[@i_424], x1_367[@i_424], x2_366[@i_424], r_362[@i_424]) && ((x1 = x1_367[@i_424]) && ((x2 = x2_366[@i_424]) && ((x3 = X[@i_424]) && ((x4 = exp(g, @1_x_874[@i_424])) && (x5 = K_u[@i_424]))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(@1_x_737[@i_240[@i_423]], X[@i_423], @1_x_737[@i_240[@i_423]], K_u[@i_423], x1_373[@i_423], x1_373[@i_423], x1_373[@i_423], x1_373[@i_423], x2_372[@i_423], r_368[@i_423]) && ((x1 = x1_373[@i_423]) && ((x2 = x2_372[@i_423]) && ((x3 = X[@i_423]) && ((x4 = exp(g, @1_x_737[@i_240[@i_423]])) && (x5 = K_u[@i_423]))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(@1_x_737[@i_240[@i_422]], X[@i_422], @1_x_737[@i_240[@i_422]], K_u[@i_422], x1_379[@i_422], x1_379[@i_422], x1_379[@i_422], x1_379[@i_422], x2_378[@i_422], r_374[@i_422]) && ((x1 = x1_379[@i_422]) && ((x2 = x2_378[@i_422]) && ((x3 = X[@i_422]) && ((x4 = exp(g, @1_x_737[@i_240[@i_422]])) && (x5 = K_u[@i_422]))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(@1_x_874[@i_236[@i_421]], X[@i_421], @1_x_874[@i_236[@i_421]], K_u[@i_421], x1_385[@i_421], x1_385[@i_421], x1_385[@i_421], x1_385[@i_421], x2_384[@i_421], r_380[@i_421]) && ((x1 = x1_385[@i_421]) && ((x2 = x2_384[@i_421]) && ((x3 = X[@i_421]) && ((x4 = exp(g, @1_x_874[@i_236[@i_421]])) && (x5 = K_u[@i_421]))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(@1_x_874[@i_236[@i_420]], X[@i_420], @1_x_874[@i_236[@i_420]], K_u[@i_420], x1_391[@i_420], x1_391[@i_420], x1_391[@i_420], x1_391[@i_420], x2_390[@i_420], r_386[@i_420]) && ((x1 = x1_391[@i_420]) && ((x2 = x2_390[@i_420]) && ((x3 = X[@i_420]) && ((x4 = exp(g, @1_x_874[@i_236[@i_420]])) && (x5 = K_u[@i_420]))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(X[@i_419], Yp[@i_233[@i_419]], K_u[@i_419], x1_397[@i_419], x1_397[@i_419], x1_397[@i_419], x1_397[@i_419], x2_396[@i_419], r_392[@i_419]) && ((x1 = x1_397[@i_419]) && ((x2 = x2_396[@i_419]) && ((x3 = X[@i_419]) && ((x4 = Yp[@i_233[@i_419]]) && (x5 = K_u[@i_419]))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(X[@i_418], Yp[@i_233[@i_418]], K_u[@i_418], x1_403[@i_418], x1_403[@i_418], x1_403[@i_418], x1_403[@i_418], x2_402[@i_418], r_398[@i_418]) && ((x1 = x1_403[@i_418]) && ((x2 = x2_402[@i_418]) && ((x3 = X[@i_418]) && ((x4 = Yp[@i_233[@i_418]]) && (x5 = K_u[@i_418]))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(X[@i_417], Y[@i_232[@i_417]], K_u[@i_417], x1_409[@i_417], x1_409[@i_417], x1_409[@i_417], x1_409[@i_417], x2_408[@i_417], r_404[@i_417]) && ((x1 = x1_409[@i_417]) && ((x2 = x2_408[@i_417]) && ((x3 = X[@i_417]) && ((x4 = Y[@i_232[@i_417]]) && (x5 = K_u[@i_417]))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(X[@i_416], Y[@i_232[@i_416]], K_u[@i_416], x1_415[@i_416], x1_415[@i_416], x1_415[@i_416], x1_415[@i_416], x2_414[@i_416], r_410[@i_416]) && ((x1 = x1_415[@i_416]) && ((x2 = x2_414[@i_416]) && ((x3 = X[@i_416]) && ((x4 = Y[@i_232[@i_416]]) && (x5 = K_u[@i_416]))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying SA rename K_u yields

Game 22 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@1_x_737[@i_240], @2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = exp(g, @1_x_737[@i_240]) in
    let K_u_1037: G = exp(g, mult(@1_x_737[@i_240], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_737[@i_240]) = x14[@i_115]) && (K_u_1037 = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      find [unique] @i_506 <= qH0 suchthat defined(x1[@i_506], x2[@i_506], x3[@i_506], x4[@i_506], x5[@i_506], x5_339[@i_506], x4_340[@i_506], x3_341[@i_506], x2_342[@i_506], x1_343[@i_506], r_338[@i_506]) && ((x1_379 = x1[@i_506]) && ((x2_378 = x2[@i_506]) && ((X = x3[@i_506]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_506]) && (K_u_1037 = x5[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_506]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_374);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      find [unique] @i_493 <= qH0 suchthat defined(x1[@i_493], x2[@i_493], x3[@i_493], x4[@i_493], x5[@i_493], x5_339[@i_493], x4_340[@i_493], x3_341[@i_493], x2_342[@i_493], x1_343[@i_493], r_338[@i_493]) && ((x1_373 = x1[@i_493]) && ((x2_372 = x2[@i_493]) && ((X = x3[@i_493]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_493]) && (K_u_1037 = x5[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_493]);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_368);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(@1_x_874[@i_236], Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = exp(g, @1_x_874[@i_236]) in
    let K_u_1038: G = exp(g, mult(@1_x_874[@i_236], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_874[@i_236]) = x14[@i_115]) && (K_u_1038 = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      find [unique] @i_532 <= qH0 suchthat defined(x1[@i_532], x2[@i_532], x3[@i_532], x4[@i_532], x5[@i_532], x5_339[@i_532], x4_340[@i_532], x3_341[@i_532], x2_342[@i_532], x1_343[@i_532], r_338[@i_532]) && ((x1_391 = x1[@i_532]) && ((x2_390 = x2[@i_532]) && ((X = x3[@i_532]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_532]) && (K_u_1038 = x5[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_532]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_386);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      find [unique] @i_519 <= qH0 suchthat defined(x1[@i_519], x2[@i_519], x3[@i_519], x4[@i_519], x5[@i_519], x5_339[@i_519], x4_340[@i_519], x3_341[@i_519], x2_342[@i_519], x1_343[@i_519], r_338[@i_519]) && ((x1_385 = x1[@i_519]) && ((x2_384 = x2[@i_519]) && ((X = x3[@i_519]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_519]) && (K_u_1038 = x5[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_519]);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_380);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u_1039: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u_1039 = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      find [unique] @i_558 <= qH0 suchthat defined(x1[@i_558], x2[@i_558], x3[@i_558], x4[@i_558], x5[@i_558], x5_339[@i_558], x4_340[@i_558], x3_341[@i_558], x2_342[@i_558], x1_343[@i_558], r_338[@i_558]) && ((x1_403 = x1[@i_558]) && ((x2_402 = x2[@i_558]) && ((X = x3[@i_558]) && ((Yp[@i_233] = x4[@i_558]) && (K_u_1039 = x5[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_558]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_398);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      find [unique] @i_545 <= qH0 suchthat defined(x1[@i_545], x2[@i_545], x3[@i_545], x4[@i_545], x5[@i_545], x5_339[@i_545], x4_340[@i_545], x3_341[@i_545], x2_342[@i_545], x1_343[@i_545], r_338[@i_545]) && ((x1_397 = x1[@i_545]) && ((x2_396 = x2[@i_545]) && ((X = x3[@i_545]) && ((Yp[@i_233] = x4[@i_545]) && (K_u_1039 = x5[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_545]);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_392);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u_1040: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u_1040 = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      find [unique] @i_584 <= qH0 suchthat defined(x1[@i_584], x2[@i_584], x3[@i_584], x4[@i_584], x5[@i_584], x5_339[@i_584], x4_340[@i_584], x3_341[@i_584], x2_342[@i_584], x1_343[@i_584], r_338[@i_584]) && ((x1_415 = x1[@i_584]) && ((x2_414 = x2[@i_584]) && ((X = x3[@i_584]) && ((Y[@i_232] = x4[@i_584]) && (K_u_1040 = x5[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_584]);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_350[@i_232]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_410);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      find [unique] @i_571 <= qH0 suchthat defined(x1[@i_571], x2[@i_571], x3[@i_571], x4[@i_571], x5[@i_571], x5_339[@i_571], x4_340[@i_571], x3_341[@i_571], x2_342[@i_571], x1_343[@i_571], r_338[@i_571]) && ((x1_409 = x1[@i_571]) && ((x2_408 = x2[@i_571]) && ((X = x3[@i_571]) && ((Y[@i_232] = x4[@i_571]) && (K_u_1040 = x5[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_571]);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_404);
        out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    let Y_u: G = exp(g, @1_x_874) in
    let K_u_1041: G = exp(g, mult(@1_x_874, x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      find [unique] @i_454 <= qH0 suchthat defined(x1[@i_454], x2[@i_454], x3[@i_454], x4[@i_454], x5[@i_454], x5_339[@i_454], x4_340[@i_454], x3_341[@i_454], x2_342[@i_454], x1_343[@i_454], r_338[@i_454]) && ((x1_355 = x1[@i_454]) && ((x2_354 = x2[@i_454]) && ((X_s = x3[@i_454]) && ((Y = x4[@i_454]) && (K_s = x5[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_454])
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_410[j])
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_350)
    )
    orfind  suchthat defined(Y_u[j], K_u_1037[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u_1037[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], x5_339[@i_467], x4_340[@i_467], x3_341[@i_467], x2_342[@i_467], x1_343[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (K_s = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
    orfind  suchthat defined(Y_u[j], K_u_1038[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u_1038[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], x5_339[@i_467], x4_340[@i_467], x3_341[@i_467], x2_342[@i_467], x1_343[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (K_s = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
    orfind  suchthat defined(Y_u[j], K_u_1039[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u_1039[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], x5_339[@i_467], x4_340[@i_467], x3_341[@i_467], x2_342[@i_467], x1_343[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (K_s = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
    orfind  suchthat defined(Y_u[j], K_u_1040[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u_1040[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], x5_339[@i_467], x4_340[@i_467], x3_341[@i_467], x2_342[@i_467], x1_343[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (K_s = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
    orfind  suchthat defined(Y_u[j], K_u_1041[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u_1041[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], x5_339[@i_467], x4_340[@i_467], x3_341[@i_467], x2_342[@i_467], x1_343[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (K_s = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = exp(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], @1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = exp(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@1_x_737[@i_200], @2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], exp(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(@1_x_874[@i_196], Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], exp(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], exp(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_343: host = cst_host in
  let x2_342: host = cst_host in
  let x3_341: G = cst_G in
  let x4_340: G = cst_G in
  let x5_339: G = cst_G in
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], x5_339[@i_428], x4_340[@i_428], x3_341[@i_428], x2_342[@i_428], x1_343[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(Xp[@i_427], Yp[@i_427], Kp[@i_427], xp[@i_427], xp[@i_427], xp[@i_427], x1_349[@i_427], x2_348[@i_427], r_344[@i_427]) && ((x1 = x1_349[@i_427]) && ((x2 = x2_348[@i_427]) && ((x3 = Xp[@i_427]) && ((x4 = Yp[@i_427]) && (x5 = Kp[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(X_s[@i_426], Y[@i_426], K_s[@i_426], x1_355[@i_426], x1_355[@i_426], x1_355[@i_426], x1_355[@i_426], x2_354[@i_426], r_350[@i_426]) && ((x1 = x1_355[@i_426]) && ((x2 = x2_354[@i_426]) && ((x3 = X_s[@i_426]) && ((x4 = Y[@i_426]) && (x5 = K_s[@i_426]))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(X_s[@i_425], Y[@i_425], K_s[@i_425], x1_361[@i_425], x1_361[@i_425], x1_361[@i_425], x1_361[@i_425], x2_360[@i_425], r_356[@i_425]) && ((x1 = x1_361[@i_425]) && ((x2 = x2_360[@i_425]) && ((x3 = X_s[@i_425]) && ((x4 = Y[@i_425]) && (x5 = K_s[@i_425]))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(@1_x_874[@i_424], @1_x_874[@i_424], @1_x_874[@i_424], @1_x_874[@i_424], X[@i_424], @1_x_874[@i_424], K_u_1041[@i_424], @1_x_874[@i_424], @1_x_874[@i_424], @1_x_874[@i_424], x1_367[@i_424], x2_366[@i_424], r_362[@i_424]) && ((x1 = x1_367[@i_424]) && ((x2 = x2_366[@i_424]) && ((x3 = X[@i_424]) && ((x4 = exp(g, @1_x_874[@i_424])) && (x5 = K_u_1041[@i_424]))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(@1_x_737[@i_240[@i_423]], X[@i_423], @1_x_737[@i_240[@i_423]], K_u_1037[@i_423], x1_373[@i_423], x1_373[@i_423], x1_373[@i_423], x1_373[@i_423], x2_372[@i_423], r_368[@i_423]) && ((x1 = x1_373[@i_423]) && ((x2 = x2_372[@i_423]) && ((x3 = X[@i_423]) && ((x4 = exp(g, @1_x_737[@i_240[@i_423]])) && (x5 = K_u_1037[@i_423]))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(@1_x_737[@i_240[@i_422]], X[@i_422], @1_x_737[@i_240[@i_422]], K_u_1037[@i_422], x1_379[@i_422], x1_379[@i_422], x1_379[@i_422], x1_379[@i_422], x2_378[@i_422], r_374[@i_422]) && ((x1 = x1_379[@i_422]) && ((x2 = x2_378[@i_422]) && ((x3 = X[@i_422]) && ((x4 = exp(g, @1_x_737[@i_240[@i_422]])) && (x5 = K_u_1037[@i_422]))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(@1_x_874[@i_236[@i_421]], X[@i_421], @1_x_874[@i_236[@i_421]], K_u_1038[@i_421], x1_385[@i_421], x1_385[@i_421], x1_385[@i_421], x1_385[@i_421], x2_384[@i_421], r_380[@i_421]) && ((x1 = x1_385[@i_421]) && ((x2 = x2_384[@i_421]) && ((x3 = X[@i_421]) && ((x4 = exp(g, @1_x_874[@i_236[@i_421]])) && (x5 = K_u_1038[@i_421]))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(@1_x_874[@i_236[@i_420]], X[@i_420], @1_x_874[@i_236[@i_420]], K_u_1038[@i_420], x1_391[@i_420], x1_391[@i_420], x1_391[@i_420], x1_391[@i_420], x2_390[@i_420], r_386[@i_420]) && ((x1 = x1_391[@i_420]) && ((x2 = x2_390[@i_420]) && ((x3 = X[@i_420]) && ((x4 = exp(g, @1_x_874[@i_236[@i_420]])) && (x5 = K_u_1038[@i_420]))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(X[@i_419], Yp[@i_233[@i_419]], K_u_1039[@i_419], x1_397[@i_419], x1_397[@i_419], x1_397[@i_419], x1_397[@i_419], x2_396[@i_419], r_392[@i_419]) && ((x1 = x1_397[@i_419]) && ((x2 = x2_396[@i_419]) && ((x3 = X[@i_419]) && ((x4 = Yp[@i_233[@i_419]]) && (x5 = K_u_1039[@i_419]))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(X[@i_418], Yp[@i_233[@i_418]], K_u_1039[@i_418], x1_403[@i_418], x1_403[@i_418], x1_403[@i_418], x1_403[@i_418], x2_402[@i_418], r_398[@i_418]) && ((x1 = x1_403[@i_418]) && ((x2 = x2_402[@i_418]) && ((x3 = X[@i_418]) && ((x4 = Yp[@i_233[@i_418]]) && (x5 = K_u_1039[@i_418]))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(X[@i_417], Y[@i_232[@i_417]], K_u_1040[@i_417], x1_409[@i_417], x1_409[@i_417], x1_409[@i_417], x1_409[@i_417], x2_408[@i_417], r_404[@i_417]) && ((x1 = x1_409[@i_417]) && ((x2 = x2_408[@i_417]) && ((x3 = X[@i_417]) && ((x4 = Y[@i_232[@i_417]]) && (x5 = K_u_1040[@i_417]))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(X[@i_416], Y[@i_232[@i_416]], K_u_1040[@i_416], x1_415[@i_416], x1_415[@i_416], x1_415[@i_416], x1_415[@i_416], x2_414[@i_416], r_410[@i_416]) && ((x1 = x1_415[@i_416]) && ((x2 = x2_414[@i_416]) && ((x3 = X[@i_416]) && ((x4 = Y[@i_232[@i_416]]) && (x5 = K_u_1040[@i_416]))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1037[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1037[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1038[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1038[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1039[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1039[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1040[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1040[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1041[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1041[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of useless yields

Game 23 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@1_x_737[@i_240], @2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = exp(g, @1_x_737[@i_240]) in
    let K_u_1037: G = exp(g, mult(@1_x_737[@i_240], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_737[@i_240]) = x14[@i_115]) && (K_u_1037 = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      find [unique] @i_506 <= qH0 suchthat defined(x1[@i_506], x2[@i_506], x3[@i_506], x4[@i_506], x5[@i_506], x5_339[@i_506], x4_340[@i_506], x3_341[@i_506], x2_342[@i_506], x1_343[@i_506], r_338[@i_506]) && ((x1_379 = x1[@i_506]) && ((x2_378 = x2[@i_506]) && ((X = x3[@i_506]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_506]) && (K_u_1037 = x5[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_506]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_374);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      find [unique] @i_493 <= qH0 suchthat defined(x1[@i_493], x2[@i_493], x3[@i_493], x4[@i_493], x5[@i_493], x5_339[@i_493], x4_340[@i_493], x3_341[@i_493], x2_342[@i_493], x1_343[@i_493], r_338[@i_493]) && ((x1_373 = x1[@i_493]) && ((x2_372 = x2[@i_493]) && ((X = x3[@i_493]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_493]) && (K_u_1037 = x5[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_493]);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_368);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(@1_x_874[@i_236], Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = exp(g, @1_x_874[@i_236]) in
    let K_u_1038: G = exp(g, mult(@1_x_874[@i_236], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_874[@i_236]) = x14[@i_115]) && (K_u_1038 = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      find [unique] @i_532 <= qH0 suchthat defined(x1[@i_532], x2[@i_532], x3[@i_532], x4[@i_532], x5[@i_532], x5_339[@i_532], x4_340[@i_532], x3_341[@i_532], x2_342[@i_532], x1_343[@i_532], r_338[@i_532]) && ((x1_391 = x1[@i_532]) && ((x2_390 = x2[@i_532]) && ((X = x3[@i_532]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_532]) && (K_u_1038 = x5[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_532]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_386);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      find [unique] @i_519 <= qH0 suchthat defined(x1[@i_519], x2[@i_519], x3[@i_519], x4[@i_519], x5[@i_519], x5_339[@i_519], x4_340[@i_519], x3_341[@i_519], x2_342[@i_519], x1_343[@i_519], r_338[@i_519]) && ((x1_385 = x1[@i_519]) && ((x2_384 = x2[@i_519]) && ((X = x3[@i_519]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_519]) && (K_u_1038 = x5[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_519]);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_380);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u_1039: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u_1039 = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      find [unique] @i_558 <= qH0 suchthat defined(x1[@i_558], x2[@i_558], x3[@i_558], x4[@i_558], x5[@i_558], x5_339[@i_558], x4_340[@i_558], x3_341[@i_558], x2_342[@i_558], x1_343[@i_558], r_338[@i_558]) && ((x1_403 = x1[@i_558]) && ((x2_402 = x2[@i_558]) && ((X = x3[@i_558]) && ((Yp[@i_233] = x4[@i_558]) && (K_u_1039 = x5[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_558]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_398);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      find [unique] @i_545 <= qH0 suchthat defined(x1[@i_545], x2[@i_545], x3[@i_545], x4[@i_545], x5[@i_545], x5_339[@i_545], x4_340[@i_545], x3_341[@i_545], x2_342[@i_545], x1_343[@i_545], r_338[@i_545]) && ((x1_397 = x1[@i_545]) && ((x2_396 = x2[@i_545]) && ((X = x3[@i_545]) && ((Yp[@i_233] = x4[@i_545]) && (K_u_1039 = x5[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_545]);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_392);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u_1040: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u_1040 = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      find [unique] @i_584 <= qH0 suchthat defined(x1[@i_584], x2[@i_584], x3[@i_584], x4[@i_584], x5[@i_584], x5_339[@i_584], x4_340[@i_584], x3_341[@i_584], x2_342[@i_584], x1_343[@i_584], r_338[@i_584]) && ((x1_415 = x1[@i_584]) && ((x2_414 = x2[@i_584]) && ((X = x3[@i_584]) && ((Y[@i_232] = x4[@i_584]) && (K_u_1040 = x5[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_584]);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_350[@i_232]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_410);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      find [unique] @i_571 <= qH0 suchthat defined(x1[@i_571], x2[@i_571], x3[@i_571], x4[@i_571], x5[@i_571], x5_339[@i_571], x4_340[@i_571], x3_341[@i_571], x2_342[@i_571], x1_343[@i_571], r_338[@i_571]) && ((x1_409 = x1[@i_571]) && ((x2_408 = x2[@i_571]) && ((X = x3[@i_571]) && ((Y[@i_232] = x4[@i_571]) && (K_u_1040 = x5[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_571]);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_404);
        out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    let Y_u: G = exp(g, @1_x_874) in
    let K_u_1041: G = exp(g, mult(@1_x_874, x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      find [unique] @i_454 <= qH0 suchthat defined(x1[@i_454], x2[@i_454], x3[@i_454], x4[@i_454], x5[@i_454], x5_339[@i_454], x4_340[@i_454], x3_341[@i_454], x2_342[@i_454], x1_343[@i_454], r_338[@i_454]) && ((x1_355 = x1[@i_454]) && ((x2_354 = x2[@i_454]) && ((X_s = x3[@i_454]) && ((Y = x4[@i_454]) && (K_s = x5[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_454])
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_410[j])
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_350)
    )
    orfind  suchthat defined(Y_u[j], K_u_1037[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u_1037[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], x5_339[@i_467], x4_340[@i_467], x3_341[@i_467], x2_342[@i_467], x1_343[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (K_s = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
    orfind  suchthat defined(Y_u[j], K_u_1038[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u_1038[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], x5_339[@i_467], x4_340[@i_467], x3_341[@i_467], x2_342[@i_467], x1_343[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (K_s = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
    orfind  suchthat defined(Y_u[j], K_u_1039[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u_1039[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], x5_339[@i_467], x4_340[@i_467], x3_341[@i_467], x2_342[@i_467], x1_343[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (K_s = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
    orfind  suchthat defined(Y_u[j], K_u_1040[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u_1040[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], x5_339[@i_467], x4_340[@i_467], x3_341[@i_467], x2_342[@i_467], x1_343[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (K_s = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
    orfind  suchthat defined(Y_u[j], K_u_1041[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u_1041[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], x5_339[@i_467], x4_340[@i_467], x3_341[@i_467], x2_342[@i_467], x1_343[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (K_s = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = exp(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], @1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = exp(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@1_x_737[@i_200], @2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], exp(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(@1_x_874[@i_196], Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], exp(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], exp(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_343: host = cst_host in
  let x2_342: host = cst_host in
  let x3_341: G = cst_G in
  let x4_340: G = cst_G in
  let x5_339: G = cst_G in
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], x5_339[@i_428], x4_340[@i_428], x3_341[@i_428], x2_342[@i_428], x1_343[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(Xp[@i_427], Yp[@i_427], Kp[@i_427], xp[@i_427], xp[@i_427], xp[@i_427], x1_349[@i_427], x2_348[@i_427], r_344[@i_427]) && ((x1 = x1_349[@i_427]) && ((x2 = x2_348[@i_427]) && ((x3 = Xp[@i_427]) && ((x4 = Yp[@i_427]) && (x5 = Kp[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(X_s[@i_426], Y[@i_426], K_s[@i_426], x1_355[@i_426], x1_355[@i_426], x1_355[@i_426], x1_355[@i_426], x2_354[@i_426], r_350[@i_426]) && ((x1 = x1_355[@i_426]) && ((x2 = x2_354[@i_426]) && ((x3 = X_s[@i_426]) && ((x4 = Y[@i_426]) && (x5 = K_s[@i_426]))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(X_s[@i_425], Y[@i_425], K_s[@i_425], x1_361[@i_425], x1_361[@i_425], x1_361[@i_425], x1_361[@i_425], x2_360[@i_425], r_356[@i_425]) && ((x1 = x1_361[@i_425]) && ((x2 = x2_360[@i_425]) && ((x3 = X_s[@i_425]) && ((x4 = Y[@i_425]) && (x5 = K_s[@i_425]))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(@1_x_874[@i_424], @1_x_874[@i_424], @1_x_874[@i_424], @1_x_874[@i_424], X[@i_424], @1_x_874[@i_424], K_u_1041[@i_424], @1_x_874[@i_424], @1_x_874[@i_424], @1_x_874[@i_424], x1_367[@i_424], x2_366[@i_424], r_362[@i_424]) && ((x1 = x1_367[@i_424]) && ((x2 = x2_366[@i_424]) && ((x3 = X[@i_424]) && ((x4 = exp(g, @1_x_874[@i_424])) && (x5 = K_u_1041[@i_424]))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(@1_x_737[@i_240[@i_423]], X[@i_423], @1_x_737[@i_240[@i_423]], K_u_1037[@i_423], x1_373[@i_423], x1_373[@i_423], x1_373[@i_423], x1_373[@i_423], x2_372[@i_423], r_368[@i_423]) && ((x1 = x1_373[@i_423]) && ((x2 = x2_372[@i_423]) && ((x3 = X[@i_423]) && ((x4 = exp(g, @1_x_737[@i_240[@i_423]])) && (x5 = K_u_1037[@i_423]))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(@1_x_737[@i_240[@i_422]], X[@i_422], @1_x_737[@i_240[@i_422]], K_u_1037[@i_422], x1_379[@i_422], x1_379[@i_422], x1_379[@i_422], x1_379[@i_422], x2_378[@i_422], r_374[@i_422]) && ((x1 = x1_379[@i_422]) && ((x2 = x2_378[@i_422]) && ((x3 = X[@i_422]) && ((x4 = exp(g, @1_x_737[@i_240[@i_422]])) && (x5 = K_u_1037[@i_422]))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(@1_x_874[@i_236[@i_421]], X[@i_421], @1_x_874[@i_236[@i_421]], K_u_1038[@i_421], x1_385[@i_421], x1_385[@i_421], x1_385[@i_421], x1_385[@i_421], x2_384[@i_421], r_380[@i_421]) && ((x1 = x1_385[@i_421]) && ((x2 = x2_384[@i_421]) && ((x3 = X[@i_421]) && ((x4 = exp(g, @1_x_874[@i_236[@i_421]])) && (x5 = K_u_1038[@i_421]))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(@1_x_874[@i_236[@i_420]], X[@i_420], @1_x_874[@i_236[@i_420]], K_u_1038[@i_420], x1_391[@i_420], x1_391[@i_420], x1_391[@i_420], x1_391[@i_420], x2_390[@i_420], r_386[@i_420]) && ((x1 = x1_391[@i_420]) && ((x2 = x2_390[@i_420]) && ((x3 = X[@i_420]) && ((x4 = exp(g, @1_x_874[@i_236[@i_420]])) && (x5 = K_u_1038[@i_420]))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(X[@i_419], Yp[@i_233[@i_419]], K_u_1039[@i_419], x1_397[@i_419], x1_397[@i_419], x1_397[@i_419], x1_397[@i_419], x2_396[@i_419], r_392[@i_419]) && ((x1 = x1_397[@i_419]) && ((x2 = x2_396[@i_419]) && ((x3 = X[@i_419]) && ((x4 = Yp[@i_233[@i_419]]) && (x5 = K_u_1039[@i_419]))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(X[@i_418], Yp[@i_233[@i_418]], K_u_1039[@i_418], x1_403[@i_418], x1_403[@i_418], x1_403[@i_418], x1_403[@i_418], x2_402[@i_418], r_398[@i_418]) && ((x1 = x1_403[@i_418]) && ((x2 = x2_402[@i_418]) && ((x3 = X[@i_418]) && ((x4 = Yp[@i_233[@i_418]]) && (x5 = K_u_1039[@i_418]))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(X[@i_417], Y[@i_232[@i_417]], K_u_1040[@i_417], x1_409[@i_417], x1_409[@i_417], x1_409[@i_417], x1_409[@i_417], x2_408[@i_417], r_404[@i_417]) && ((x1 = x1_409[@i_417]) && ((x2 = x2_408[@i_417]) && ((x3 = X[@i_417]) && ((x4 = Y[@i_232[@i_417]]) && (x5 = K_u_1040[@i_417]))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(X[@i_416], Y[@i_232[@i_416]], K_u_1040[@i_416], x1_415[@i_416], x1_415[@i_416], x1_415[@i_416], x1_415[@i_416], x2_414[@i_416], r_410[@i_416]) && ((x1 = x1_415[@i_416]) && ((x2 = x2_414[@i_416]) && ((x3 = X[@i_416]) && ((x4 = Y[@i_232[@i_416]]) && (x5 = K_u_1040[@i_416]))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1037[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1037[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1038[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1038[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1039[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1039[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1040[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1040[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1041[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1041[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying simplify [Excluding set(dist 23->24, proba <= 4. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|)] yields

Game 24 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = exp(g, @1_x_737[@i_240]) in
    let K_u_1037: G = exp(g, mult(@1_x_737[@i_240], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_737[@i_240]) = x14[@i_115]) && (K_u_1037 = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      find [unique] @i_506 <= qH0 suchthat defined(x1[@i_506], x2[@i_506], x3[@i_506], x4[@i_506], x5[@i_506], r_338[@i_506]) && ((x1_379 = x1[@i_506]) && ((x2_378 = x2[@i_506]) && ((X = x3[@i_506]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_506]) && (K_u_1037 = x5[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_506]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_374);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      find [unique] @i_493 <= qH0 suchthat defined(x1[@i_493], x2[@i_493], x3[@i_493], x4[@i_493], x5[@i_493], r_338[@i_493]) && ((x1_373 = x1[@i_493]) && ((x2_372 = x2[@i_493]) && ((X = x3[@i_493]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_493]) && (K_u_1037 = x5[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_493]);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_368);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = exp(g, @1_x_874[@i_236]) in
    let K_u_1038: G = exp(g, mult(@1_x_874[@i_236], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_874[@i_236]) = x14[@i_115]) && (K_u_1038 = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      find [unique] @i_532 <= qH0 suchthat defined(x1[@i_532], x2[@i_532], x3[@i_532], x4[@i_532], x5[@i_532], r_338[@i_532]) && ((x1_391 = x1[@i_532]) && ((x2_390 = x2[@i_532]) && ((X = x3[@i_532]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_532]) && (K_u_1038 = x5[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_532]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_386);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      find [unique] @i_519 <= qH0 suchthat defined(x1[@i_519], x2[@i_519], x3[@i_519], x4[@i_519], x5[@i_519], r_338[@i_519]) && ((x1_385 = x1[@i_519]) && ((x2_384 = x2[@i_519]) && ((X = x3[@i_519]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_519]) && (K_u_1038 = x5[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_519]);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_380);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u_1039: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u_1039 = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      find [unique] @i_558 <= qH0 suchthat defined(x1[@i_558], x2[@i_558], x3[@i_558], x4[@i_558], x5[@i_558], r_338[@i_558]) && ((x1_403 = x1[@i_558]) && ((x2_402 = x2[@i_558]) && ((X = x3[@i_558]) && ((Yp[@i_233] = x4[@i_558]) && (K_u_1039 = x5[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_558]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_398);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      find [unique] @i_545 <= qH0 suchthat defined(x1[@i_545], x2[@i_545], x3[@i_545], x4[@i_545], x5[@i_545], r_338[@i_545]) && ((x1_397 = x1[@i_545]) && ((x2_396 = x2[@i_545]) && ((X = x3[@i_545]) && ((Yp[@i_233] = x4[@i_545]) && (K_u_1039 = x5[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_545]);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_392);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u_1040: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u_1040 = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      find [unique] @i_584 <= qH0 suchthat defined(x1[@i_584], x2[@i_584], x3[@i_584], x4[@i_584], x5[@i_584], r_338[@i_584]) && ((x1_415 = x1[@i_584]) && ((x2_414 = x2[@i_584]) && ((X = x3[@i_584]) && ((Y[@i_232] = x4[@i_584]) && (K_u_1040 = x5[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_584]);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_350[@i_232]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_410);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      find [unique] @i_571 <= qH0 suchthat defined(x1[@i_571], x2[@i_571], x3[@i_571], x4[@i_571], x5[@i_571], r_338[@i_571]) && ((x1_409 = x1[@i_571]) && ((x2_408 = x2[@i_571]) && ((X = x3[@i_571]) && ((Y[@i_232] = x4[@i_571]) && (K_u_1040 = x5[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_571]);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_404);
        out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    let Y_u: G = exp(g, @1_x_874) in
    let K_u_1041: G = exp(g, mult(@1_x_874, x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      find [unique] @i_454 <= qH0 suchthat defined(x1[@i_454], x2[@i_454], x3[@i_454], x4[@i_454], x5[@i_454], r_338[@i_454]) && ((x1_355 = x1[@i_454]) && ((x2_354 = x2[@i_454]) && ((X_s = x3[@i_454]) && ((Y = x4[@i_454]) && (K_s = x5[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_454])
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_410[j])
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_350)
    )
    orfind  suchthat defined(@i_232[j], r1_94[j], K_u_1040[j]) && (!_58 = @i_232[j]) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (K_s = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = exp(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = exp(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], exp(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], exp(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], exp(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_343: host = cst_host in
  let x2_342: host = cst_host in
  let x3_341: G = cst_G in
  let x4_340: G = cst_G in
  let x5_339: G = cst_G in
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(x1_349[@i_427], x2_348[@i_427], Xp[@i_427], Yp[@i_427], Kp[@i_427], r_344[@i_427]) && ((x1 = x1_349[@i_427]) && ((x2 = x2_348[@i_427]) && ((x3 = Xp[@i_427]) && ((x4 = Yp[@i_427]) && (x5 = Kp[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(x1_355[@i_426], x2_354[@i_426], X_s[@i_426], Y[@i_426], K_s[@i_426], r_350[@i_426]) && ((x1 = x1_355[@i_426]) && ((x2 = x2_354[@i_426]) && ((x3 = X_s[@i_426]) && ((x4 = Y[@i_426]) && (x5 = K_s[@i_426]))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(x1_361[@i_425], x2_360[@i_425], X_s[@i_425], Y[@i_425], K_s[@i_425], r_356[@i_425]) && ((x1 = x1_361[@i_425]) && ((x2 = x2_360[@i_425]) && ((x3 = X_s[@i_425]) && ((x4 = Y[@i_425]) && (x5 = K_s[@i_425]))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(x1_367[@i_424], x2_366[@i_424], X[@i_424], @1_x_874[@i_424], K_u_1041[@i_424], r_362[@i_424]) && ((x1 = x1_367[@i_424]) && ((x2 = x2_366[@i_424]) && ((x3 = X[@i_424]) && ((x4 = exp(g, @1_x_874[@i_424])) && (x5 = K_u_1041[@i_424]))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(x1_373[@i_423], x2_372[@i_423], X[@i_423], @1_x_737[@i_240[@i_423]], K_u_1037[@i_423], r_368[@i_423]) && ((x1 = x1_373[@i_423]) && ((x2 = x2_372[@i_423]) && ((x3 = X[@i_423]) && ((x4 = exp(g, @1_x_737[@i_240[@i_423]])) && (x5 = K_u_1037[@i_423]))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(x1_379[@i_422], x2_378[@i_422], X[@i_422], @1_x_737[@i_240[@i_422]], K_u_1037[@i_422], r_374[@i_422]) && ((x1 = x1_379[@i_422]) && ((x2 = x2_378[@i_422]) && ((x3 = X[@i_422]) && ((x4 = exp(g, @1_x_737[@i_240[@i_422]])) && (x5 = K_u_1037[@i_422]))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(x1_385[@i_421], x2_384[@i_421], X[@i_421], @1_x_874[@i_236[@i_421]], K_u_1038[@i_421], r_380[@i_421]) && ((x1 = x1_385[@i_421]) && ((x2 = x2_384[@i_421]) && ((x3 = X[@i_421]) && ((x4 = exp(g, @1_x_874[@i_236[@i_421]])) && (x5 = K_u_1038[@i_421]))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(x1_391[@i_420], x2_390[@i_420], X[@i_420], @1_x_874[@i_236[@i_420]], K_u_1038[@i_420], r_386[@i_420]) && ((x1 = x1_391[@i_420]) && ((x2 = x2_390[@i_420]) && ((x3 = X[@i_420]) && ((x4 = exp(g, @1_x_874[@i_236[@i_420]])) && (x5 = K_u_1038[@i_420]))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(x1_397[@i_419], x2_396[@i_419], X[@i_419], Yp[@i_233[@i_419]], K_u_1039[@i_419], r_392[@i_419]) && ((x1 = x1_397[@i_419]) && ((x2 = x2_396[@i_419]) && ((x3 = X[@i_419]) && ((x4 = Yp[@i_233[@i_419]]) && (x5 = K_u_1039[@i_419]))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(x1_403[@i_418], x2_402[@i_418], X[@i_418], Yp[@i_233[@i_418]], K_u_1039[@i_418], r_398[@i_418]) && ((x1 = x1_403[@i_418]) && ((x2 = x2_402[@i_418]) && ((x3 = X[@i_418]) && ((x4 = Yp[@i_233[@i_418]]) && (x5 = K_u_1039[@i_418]))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(x1_409[@i_417], x2_408[@i_417], X[@i_417], Y[@i_232[@i_417]], K_u_1040[@i_417], r_404[@i_417]) && ((x1 = x1_409[@i_417]) && ((x2 = x2_408[@i_417]) && ((x3 = X[@i_417]) && ((x4 = Y[@i_232[@i_417]]) && (x5 = K_u_1040[@i_417]))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(x1_415[@i_416], x2_414[@i_416], X[@i_416], Y[@i_232[@i_416]], K_u_1040[@i_416], r_410[@i_416]) && ((x1 = x1_415[@i_416]) && ((x2 = x2_414[@i_416]) && ((x3 = X[@i_416]) && ((x4 = Y[@i_232[@i_416]]) && (x5 = K_u_1040[@i_416]))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1037[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1037[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1038[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1038[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1039[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1039[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1040[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1040[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1041[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1041[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of binder K_s yields

Game 25 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = exp(g, @1_x_737[@i_240]) in
    let K_u_1037: G = exp(g, mult(@1_x_737[@i_240], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_737[@i_240]) = x14[@i_115]) && (K_u_1037 = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      find [unique] @i_506 <= qH0 suchthat defined(x1[@i_506], x2[@i_506], x3[@i_506], x4[@i_506], x5[@i_506], r_338[@i_506]) && ((x1_379 = x1[@i_506]) && ((x2_378 = x2[@i_506]) && ((X = x3[@i_506]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_506]) && (K_u_1037 = x5[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_506]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_374);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      find [unique] @i_493 <= qH0 suchthat defined(x1[@i_493], x2[@i_493], x3[@i_493], x4[@i_493], x5[@i_493], r_338[@i_493]) && ((x1_373 = x1[@i_493]) && ((x2_372 = x2[@i_493]) && ((X = x3[@i_493]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_493]) && (K_u_1037 = x5[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_493]);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_368);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = exp(g, @1_x_874[@i_236]) in
    let K_u_1038: G = exp(g, mult(@1_x_874[@i_236], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_874[@i_236]) = x14[@i_115]) && (K_u_1038 = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      find [unique] @i_532 <= qH0 suchthat defined(x1[@i_532], x2[@i_532], x3[@i_532], x4[@i_532], x5[@i_532], r_338[@i_532]) && ((x1_391 = x1[@i_532]) && ((x2_390 = x2[@i_532]) && ((X = x3[@i_532]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_532]) && (K_u_1038 = x5[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_532]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_386);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      find [unique] @i_519 <= qH0 suchthat defined(x1[@i_519], x2[@i_519], x3[@i_519], x4[@i_519], x5[@i_519], r_338[@i_519]) && ((x1_385 = x1[@i_519]) && ((x2_384 = x2[@i_519]) && ((X = x3[@i_519]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_519]) && (K_u_1038 = x5[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_519]);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_380);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u_1039: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u_1039 = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      find [unique] @i_558 <= qH0 suchthat defined(x1[@i_558], x2[@i_558], x3[@i_558], x4[@i_558], x5[@i_558], r_338[@i_558]) && ((x1_403 = x1[@i_558]) && ((x2_402 = x2[@i_558]) && ((X = x3[@i_558]) && ((Yp[@i_233] = x4[@i_558]) && (K_u_1039 = x5[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_558]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_398);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      find [unique] @i_545 <= qH0 suchthat defined(x1[@i_545], x2[@i_545], x3[@i_545], x4[@i_545], x5[@i_545], r_338[@i_545]) && ((x1_397 = x1[@i_545]) && ((x2_396 = x2[@i_545]) && ((X = x3[@i_545]) && ((Yp[@i_233] = x4[@i_545]) && (K_u_1039 = x5[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_545]);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_392);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u_1040: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u_1040 = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      find [unique] @i_584 <= qH0 suchthat defined(x1[@i_584], x2[@i_584], x3[@i_584], x4[@i_584], x5[@i_584], r_338[@i_584]) && ((x1_415 = x1[@i_584]) && ((x2_414 = x2[@i_584]) && ((X = x3[@i_584]) && ((Y[@i_232] = x4[@i_584]) && (K_u_1040 = x5[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_584]);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_350[@i_232]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_410);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      find [unique] @i_571 <= qH0 suchthat defined(x1[@i_571], x2[@i_571], x3[@i_571], x4[@i_571], x5[@i_571], r_338[@i_571]) && ((x1_409 = x1[@i_571]) && ((x2_408 = x2[@i_571]) && ((X = x3[@i_571]) && ((Y[@i_232] = x4[@i_571]) && (K_u_1040 = x5[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_571]);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_404);
        out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    let Y_u: G = exp(g, @1_x_874) in
    let K_u_1041: G = exp(g, mult(@1_x_874, x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (exp(g, mult(x[j], y)) = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      find [unique] @i_454 <= qH0 suchthat defined(x1[@i_454], x2[@i_454], x3[@i_454], x4[@i_454], x5[@i_454], r_338[@i_454]) && ((x1_355 = x1[@i_454]) && ((x2_354 = x2[@i_454]) && ((X_s = x3[@i_454]) && ((Y = x4[@i_454]) && (exp(g, mult(x[j], y)) = x5[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_454])
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_410[j])
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_350)
    )
    orfind  suchthat defined(@i_232[j], r1_94[j], K_u_1040[j]) && (!_58 = @i_232[j]) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (exp(g, mult(x[j], y)) = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = exp(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = exp(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], exp(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], exp(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], exp(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(x1_349[@i_427], x2_348[@i_427], Xp[@i_427], Yp[@i_427], Kp[@i_427], r_344[@i_427]) && ((x1 = x1_349[@i_427]) && ((x2 = x2_348[@i_427]) && ((x3 = Xp[@i_427]) && ((x4 = Yp[@i_427]) && (x5 = Kp[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(y[@i_426], x[j[@i_426]], K_s[@i_426], x1_355[@i_426], x2_354[@i_426], X_s[@i_426], Y[@i_426], r_350[@i_426]) && ((x1 = x1_355[@i_426]) && ((x2 = x2_354[@i_426]) && ((x3 = X_s[@i_426]) && ((x4 = Y[@i_426]) && (x5 = exp(g, mult(x[j[@i_426]], y[@i_426]))))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(y[@i_425], x[j[@i_425]], K_s[@i_425], x1_361[@i_425], x2_360[@i_425], X_s[@i_425], Y[@i_425], r_356[@i_425]) && ((x1 = x1_361[@i_425]) && ((x2 = x2_360[@i_425]) && ((x3 = X_s[@i_425]) && ((x4 = Y[@i_425]) && (x5 = exp(g, mult(x[j[@i_425]], y[@i_425]))))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(x1_367[@i_424], x2_366[@i_424], X[@i_424], @1_x_874[@i_424], K_u_1041[@i_424], r_362[@i_424]) && ((x1 = x1_367[@i_424]) && ((x2 = x2_366[@i_424]) && ((x3 = X[@i_424]) && ((x4 = exp(g, @1_x_874[@i_424])) && (x5 = K_u_1041[@i_424]))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(x1_373[@i_423], x2_372[@i_423], X[@i_423], @1_x_737[@i_240[@i_423]], K_u_1037[@i_423], r_368[@i_423]) && ((x1 = x1_373[@i_423]) && ((x2 = x2_372[@i_423]) && ((x3 = X[@i_423]) && ((x4 = exp(g, @1_x_737[@i_240[@i_423]])) && (x5 = K_u_1037[@i_423]))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(x1_379[@i_422], x2_378[@i_422], X[@i_422], @1_x_737[@i_240[@i_422]], K_u_1037[@i_422], r_374[@i_422]) && ((x1 = x1_379[@i_422]) && ((x2 = x2_378[@i_422]) && ((x3 = X[@i_422]) && ((x4 = exp(g, @1_x_737[@i_240[@i_422]])) && (x5 = K_u_1037[@i_422]))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(x1_385[@i_421], x2_384[@i_421], X[@i_421], @1_x_874[@i_236[@i_421]], K_u_1038[@i_421], r_380[@i_421]) && ((x1 = x1_385[@i_421]) && ((x2 = x2_384[@i_421]) && ((x3 = X[@i_421]) && ((x4 = exp(g, @1_x_874[@i_236[@i_421]])) && (x5 = K_u_1038[@i_421]))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(x1_391[@i_420], x2_390[@i_420], X[@i_420], @1_x_874[@i_236[@i_420]], K_u_1038[@i_420], r_386[@i_420]) && ((x1 = x1_391[@i_420]) && ((x2 = x2_390[@i_420]) && ((x3 = X[@i_420]) && ((x4 = exp(g, @1_x_874[@i_236[@i_420]])) && (x5 = K_u_1038[@i_420]))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(x1_397[@i_419], x2_396[@i_419], X[@i_419], Yp[@i_233[@i_419]], K_u_1039[@i_419], r_392[@i_419]) && ((x1 = x1_397[@i_419]) && ((x2 = x2_396[@i_419]) && ((x3 = X[@i_419]) && ((x4 = Yp[@i_233[@i_419]]) && (x5 = K_u_1039[@i_419]))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(x1_403[@i_418], x2_402[@i_418], X[@i_418], Yp[@i_233[@i_418]], K_u_1039[@i_418], r_398[@i_418]) && ((x1 = x1_403[@i_418]) && ((x2 = x2_402[@i_418]) && ((x3 = X[@i_418]) && ((x4 = Yp[@i_233[@i_418]]) && (x5 = K_u_1039[@i_418]))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(x1_409[@i_417], x2_408[@i_417], X[@i_417], Y[@i_232[@i_417]], K_u_1040[@i_417], r_404[@i_417]) && ((x1 = x1_409[@i_417]) && ((x2 = x2_408[@i_417]) && ((x3 = X[@i_417]) && ((x4 = Y[@i_232[@i_417]]) && (x5 = K_u_1040[@i_417]))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(x1_415[@i_416], x2_414[@i_416], X[@i_416], Y[@i_232[@i_416]], K_u_1040[@i_416], r_410[@i_416]) && ((x1 = x1_415[@i_416]) && ((x2 = x2_414[@i_416]) && ((x3 = X[@i_416]) && ((x4 = Y[@i_232[@i_416]]) && (x5 = K_u_1040[@i_416]))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1037[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1037[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1038[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1038[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1039[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1039[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1040[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1040[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1041[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1041[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of binder K_u_1041 yields

Game 26 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = exp(g, @1_x_737[@i_240]) in
    let K_u_1037: G = exp(g, mult(@1_x_737[@i_240], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_737[@i_240]) = x14[@i_115]) && (K_u_1037 = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      find [unique] @i_506 <= qH0 suchthat defined(x1[@i_506], x2[@i_506], x3[@i_506], x4[@i_506], x5[@i_506], r_338[@i_506]) && ((x1_379 = x1[@i_506]) && ((x2_378 = x2[@i_506]) && ((X = x3[@i_506]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_506]) && (K_u_1037 = x5[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_506]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_374);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      find [unique] @i_493 <= qH0 suchthat defined(x1[@i_493], x2[@i_493], x3[@i_493], x4[@i_493], x5[@i_493], r_338[@i_493]) && ((x1_373 = x1[@i_493]) && ((x2_372 = x2[@i_493]) && ((X = x3[@i_493]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_493]) && (K_u_1037 = x5[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_493]);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_368);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = exp(g, @1_x_874[@i_236]) in
    let K_u_1038: G = exp(g, mult(@1_x_874[@i_236], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_874[@i_236]) = x14[@i_115]) && (K_u_1038 = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      find [unique] @i_532 <= qH0 suchthat defined(x1[@i_532], x2[@i_532], x3[@i_532], x4[@i_532], x5[@i_532], r_338[@i_532]) && ((x1_391 = x1[@i_532]) && ((x2_390 = x2[@i_532]) && ((X = x3[@i_532]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_532]) && (K_u_1038 = x5[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_532]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_386);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      find [unique] @i_519 <= qH0 suchthat defined(x1[@i_519], x2[@i_519], x3[@i_519], x4[@i_519], x5[@i_519], r_338[@i_519]) && ((x1_385 = x1[@i_519]) && ((x2_384 = x2[@i_519]) && ((X = x3[@i_519]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_519]) && (K_u_1038 = x5[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_519]);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_380);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u_1039: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u_1039 = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      find [unique] @i_558 <= qH0 suchthat defined(x1[@i_558], x2[@i_558], x3[@i_558], x4[@i_558], x5[@i_558], r_338[@i_558]) && ((x1_403 = x1[@i_558]) && ((x2_402 = x2[@i_558]) && ((X = x3[@i_558]) && ((Yp[@i_233] = x4[@i_558]) && (K_u_1039 = x5[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_558]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_398);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      find [unique] @i_545 <= qH0 suchthat defined(x1[@i_545], x2[@i_545], x3[@i_545], x4[@i_545], x5[@i_545], r_338[@i_545]) && ((x1_397 = x1[@i_545]) && ((x2_396 = x2[@i_545]) && ((X = x3[@i_545]) && ((Yp[@i_233] = x4[@i_545]) && (K_u_1039 = x5[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_545]);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_392);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u_1040: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u_1040 = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      find [unique] @i_584 <= qH0 suchthat defined(x1[@i_584], x2[@i_584], x3[@i_584], x4[@i_584], x5[@i_584], r_338[@i_584]) && ((x1_415 = x1[@i_584]) && ((x2_414 = x2[@i_584]) && ((X = x3[@i_584]) && ((Y[@i_232] = x4[@i_584]) && (K_u_1040 = x5[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_584]);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_350[@i_232]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_410);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      find [unique] @i_571 <= qH0 suchthat defined(x1[@i_571], x2[@i_571], x3[@i_571], x4[@i_571], x5[@i_571], r_338[@i_571]) && ((x1_409 = x1[@i_571]) && ((x2_408 = x2[@i_571]) && ((X = x3[@i_571]) && ((Y[@i_232] = x4[@i_571]) && (K_u_1040 = x5[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_571]);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_404);
        out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    let Y_u: G = exp(g, @1_x_874) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (exp(g, mult(x[j], y)) = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      find [unique] @i_454 <= qH0 suchthat defined(x1[@i_454], x2[@i_454], x3[@i_454], x4[@i_454], x5[@i_454], r_338[@i_454]) && ((x1_355 = x1[@i_454]) && ((x2_354 = x2[@i_454]) && ((X_s = x3[@i_454]) && ((Y = x4[@i_454]) && (exp(g, mult(x[j], y)) = x5[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_454])
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_410[j])
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_350)
    )
    orfind  suchthat defined(@i_232[j], r1_94[j], K_u_1040[j]) && (!_58 = @i_232[j]) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (exp(g, mult(x[j], y)) = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = exp(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = exp(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], exp(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], exp(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], exp(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(x1_349[@i_427], x2_348[@i_427], Xp[@i_427], Yp[@i_427], Kp[@i_427], r_344[@i_427]) && ((x1 = x1_349[@i_427]) && ((x2 = x2_348[@i_427]) && ((x3 = Xp[@i_427]) && ((x4 = Yp[@i_427]) && (x5 = Kp[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(y[@i_426], x[j[@i_426]], K_s[@i_426], x1_355[@i_426], x2_354[@i_426], X_s[@i_426], Y[@i_426], r_350[@i_426]) && ((x1 = x1_355[@i_426]) && ((x2 = x2_354[@i_426]) && ((x3 = X_s[@i_426]) && ((x4 = Y[@i_426]) && (x5 = exp(g, mult(x[j[@i_426]], y[@i_426]))))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(y[@i_425], x[j[@i_425]], K_s[@i_425], x1_361[@i_425], x2_360[@i_425], X_s[@i_425], Y[@i_425], r_356[@i_425]) && ((x1 = x1_361[@i_425]) && ((x2 = x2_360[@i_425]) && ((x3 = X_s[@i_425]) && ((x4 = Y[@i_425]) && (x5 = exp(g, mult(x[j[@i_425]], y[@i_425]))))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(x[@i_424], @1_x_874[@i_424], x1_367[@i_424], x2_366[@i_424], X[@i_424], @1_x_874[@i_424], r_362[@i_424]) && ((x1 = x1_367[@i_424]) && ((x2 = x2_366[@i_424]) && ((x3 = X[@i_424]) && ((x4 = exp(g, @1_x_874[@i_424])) && (x5 = exp(g, mult(@1_x_874[@i_424], x[@i_424]))))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(x1_373[@i_423], x2_372[@i_423], X[@i_423], @1_x_737[@i_240[@i_423]], K_u_1037[@i_423], r_368[@i_423]) && ((x1 = x1_373[@i_423]) && ((x2 = x2_372[@i_423]) && ((x3 = X[@i_423]) && ((x4 = exp(g, @1_x_737[@i_240[@i_423]])) && (x5 = K_u_1037[@i_423]))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(x1_379[@i_422], x2_378[@i_422], X[@i_422], @1_x_737[@i_240[@i_422]], K_u_1037[@i_422], r_374[@i_422]) && ((x1 = x1_379[@i_422]) && ((x2 = x2_378[@i_422]) && ((x3 = X[@i_422]) && ((x4 = exp(g, @1_x_737[@i_240[@i_422]])) && (x5 = K_u_1037[@i_422]))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(x1_385[@i_421], x2_384[@i_421], X[@i_421], @1_x_874[@i_236[@i_421]], K_u_1038[@i_421], r_380[@i_421]) && ((x1 = x1_385[@i_421]) && ((x2 = x2_384[@i_421]) && ((x3 = X[@i_421]) && ((x4 = exp(g, @1_x_874[@i_236[@i_421]])) && (x5 = K_u_1038[@i_421]))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(x1_391[@i_420], x2_390[@i_420], X[@i_420], @1_x_874[@i_236[@i_420]], K_u_1038[@i_420], r_386[@i_420]) && ((x1 = x1_391[@i_420]) && ((x2 = x2_390[@i_420]) && ((x3 = X[@i_420]) && ((x4 = exp(g, @1_x_874[@i_236[@i_420]])) && (x5 = K_u_1038[@i_420]))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(x1_397[@i_419], x2_396[@i_419], X[@i_419], Yp[@i_233[@i_419]], K_u_1039[@i_419], r_392[@i_419]) && ((x1 = x1_397[@i_419]) && ((x2 = x2_396[@i_419]) && ((x3 = X[@i_419]) && ((x4 = Yp[@i_233[@i_419]]) && (x5 = K_u_1039[@i_419]))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(x1_403[@i_418], x2_402[@i_418], X[@i_418], Yp[@i_233[@i_418]], K_u_1039[@i_418], r_398[@i_418]) && ((x1 = x1_403[@i_418]) && ((x2 = x2_402[@i_418]) && ((x3 = X[@i_418]) && ((x4 = Yp[@i_233[@i_418]]) && (x5 = K_u_1039[@i_418]))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(x1_409[@i_417], x2_408[@i_417], X[@i_417], Y[@i_232[@i_417]], K_u_1040[@i_417], r_404[@i_417]) && ((x1 = x1_409[@i_417]) && ((x2 = x2_408[@i_417]) && ((x3 = X[@i_417]) && ((x4 = Y[@i_232[@i_417]]) && (x5 = K_u_1040[@i_417]))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(x1_415[@i_416], x2_414[@i_416], X[@i_416], Y[@i_232[@i_416]], K_u_1040[@i_416], r_410[@i_416]) && ((x1 = x1_415[@i_416]) && ((x2 = x2_414[@i_416]) && ((x3 = X[@i_416]) && ((x4 = Y[@i_232[@i_416]]) && (x5 = K_u_1040[@i_416]))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1037[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1037[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1038[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1038[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1039[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1039[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1040[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1040[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_874[@i_100], @1_x_874[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(@1_x_874[@i_100], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of binder K_u_1037 yields

Game 27 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = exp(g, @1_x_737[@i_240]) in
    let K_u_1037: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_737[@i_240]) = x14[@i_115]) && (exp(g, mult(@1_x_737[@i_240], x)) = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      find [unique] @i_506 <= qH0 suchthat defined(x1[@i_506], x2[@i_506], x3[@i_506], x4[@i_506], x5[@i_506], r_338[@i_506]) && ((x1_379 = x1[@i_506]) && ((x2_378 = x2[@i_506]) && ((X = x3[@i_506]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_506]) && (exp(g, mult(@1_x_737[@i_240], x)) = x5[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_506]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_374);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      find [unique] @i_493 <= qH0 suchthat defined(x1[@i_493], x2[@i_493], x3[@i_493], x4[@i_493], x5[@i_493], r_338[@i_493]) && ((x1_373 = x1[@i_493]) && ((x2_372 = x2[@i_493]) && ((X = x3[@i_493]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_493]) && (exp(g, mult(@1_x_737[@i_240], x)) = x5[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_493]);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_368);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = exp(g, @1_x_874[@i_236]) in
    let K_u_1038: G = exp(g, mult(@1_x_874[@i_236], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_874[@i_236]) = x14[@i_115]) && (K_u_1038 = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      find [unique] @i_532 <= qH0 suchthat defined(x1[@i_532], x2[@i_532], x3[@i_532], x4[@i_532], x5[@i_532], r_338[@i_532]) && ((x1_391 = x1[@i_532]) && ((x2_390 = x2[@i_532]) && ((X = x3[@i_532]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_532]) && (K_u_1038 = x5[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_532]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_386);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      find [unique] @i_519 <= qH0 suchthat defined(x1[@i_519], x2[@i_519], x3[@i_519], x4[@i_519], x5[@i_519], r_338[@i_519]) && ((x1_385 = x1[@i_519]) && ((x2_384 = x2[@i_519]) && ((X = x3[@i_519]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_519]) && (K_u_1038 = x5[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_519]);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_380);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u_1039: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u_1039 = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      find [unique] @i_558 <= qH0 suchthat defined(x1[@i_558], x2[@i_558], x3[@i_558], x4[@i_558], x5[@i_558], r_338[@i_558]) && ((x1_403 = x1[@i_558]) && ((x2_402 = x2[@i_558]) && ((X = x3[@i_558]) && ((Yp[@i_233] = x4[@i_558]) && (K_u_1039 = x5[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_558]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_398);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      find [unique] @i_545 <= qH0 suchthat defined(x1[@i_545], x2[@i_545], x3[@i_545], x4[@i_545], x5[@i_545], r_338[@i_545]) && ((x1_397 = x1[@i_545]) && ((x2_396 = x2[@i_545]) && ((X = x3[@i_545]) && ((Yp[@i_233] = x4[@i_545]) && (K_u_1039 = x5[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_545]);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_392);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u_1040: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u_1040 = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      find [unique] @i_584 <= qH0 suchthat defined(x1[@i_584], x2[@i_584], x3[@i_584], x4[@i_584], x5[@i_584], r_338[@i_584]) && ((x1_415 = x1[@i_584]) && ((x2_414 = x2[@i_584]) && ((X = x3[@i_584]) && ((Y[@i_232] = x4[@i_584]) && (K_u_1040 = x5[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_584]);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_350[@i_232]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_410);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      find [unique] @i_571 <= qH0 suchthat defined(x1[@i_571], x2[@i_571], x3[@i_571], x4[@i_571], x5[@i_571], r_338[@i_571]) && ((x1_409 = x1[@i_571]) && ((x2_408 = x2[@i_571]) && ((X = x3[@i_571]) && ((Y[@i_232] = x4[@i_571]) && (K_u_1040 = x5[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_571]);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_404);
        out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    let Y_u: G = exp(g, @1_x_874) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (exp(g, mult(x[j], y)) = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      find [unique] @i_454 <= qH0 suchthat defined(x1[@i_454], x2[@i_454], x3[@i_454], x4[@i_454], x5[@i_454], r_338[@i_454]) && ((x1_355 = x1[@i_454]) && ((x2_354 = x2[@i_454]) && ((X_s = x3[@i_454]) && ((Y = x4[@i_454]) && (exp(g, mult(x[j], y)) = x5[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_454])
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_410[j])
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_350)
    )
    orfind  suchthat defined(@i_232[j], r1_94[j], K_u_1040[j]) && (!_58 = @i_232[j]) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (exp(g, mult(x[j], y)) = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = exp(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = exp(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], exp(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], exp(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], exp(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(x1_349[@i_427], x2_348[@i_427], Xp[@i_427], Yp[@i_427], Kp[@i_427], r_344[@i_427]) && ((x1 = x1_349[@i_427]) && ((x2 = x2_348[@i_427]) && ((x3 = Xp[@i_427]) && ((x4 = Yp[@i_427]) && (x5 = Kp[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(y[@i_426], x[j[@i_426]], K_s[@i_426], x1_355[@i_426], x2_354[@i_426], X_s[@i_426], Y[@i_426], r_350[@i_426]) && ((x1 = x1_355[@i_426]) && ((x2 = x2_354[@i_426]) && ((x3 = X_s[@i_426]) && ((x4 = Y[@i_426]) && (x5 = exp(g, mult(x[j[@i_426]], y[@i_426]))))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(y[@i_425], x[j[@i_425]], K_s[@i_425], x1_361[@i_425], x2_360[@i_425], X_s[@i_425], Y[@i_425], r_356[@i_425]) && ((x1 = x1_361[@i_425]) && ((x2 = x2_360[@i_425]) && ((x3 = X_s[@i_425]) && ((x4 = Y[@i_425]) && (x5 = exp(g, mult(x[j[@i_425]], y[@i_425]))))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(x[@i_424], @1_x_874[@i_424], x1_367[@i_424], x2_366[@i_424], X[@i_424], @1_x_874[@i_424], r_362[@i_424]) && ((x1 = x1_367[@i_424]) && ((x2 = x2_366[@i_424]) && ((x3 = X[@i_424]) && ((x4 = exp(g, @1_x_874[@i_424])) && (x5 = exp(g, mult(@1_x_874[@i_424], x[@i_424]))))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(x[@i_423], K_u_1037[@i_423], x1_373[@i_423], x2_372[@i_423], X[@i_423], @1_x_737[@i_240[@i_423]], r_368[@i_423]) && ((x1 = x1_373[@i_423]) && ((x2 = x2_372[@i_423]) && ((x3 = X[@i_423]) && ((x4 = exp(g, @1_x_737[@i_240[@i_423]])) && (x5 = exp(g, mult(@1_x_737[@i_240[@i_423]], x[@i_423]))))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(x[@i_422], K_u_1037[@i_422], x1_379[@i_422], x2_378[@i_422], X[@i_422], @1_x_737[@i_240[@i_422]], r_374[@i_422]) && ((x1 = x1_379[@i_422]) && ((x2 = x2_378[@i_422]) && ((x3 = X[@i_422]) && ((x4 = exp(g, @1_x_737[@i_240[@i_422]])) && (x5 = exp(g, mult(@1_x_737[@i_240[@i_422]], x[@i_422]))))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(x1_385[@i_421], x2_384[@i_421], X[@i_421], @1_x_874[@i_236[@i_421]], K_u_1038[@i_421], r_380[@i_421]) && ((x1 = x1_385[@i_421]) && ((x2 = x2_384[@i_421]) && ((x3 = X[@i_421]) && ((x4 = exp(g, @1_x_874[@i_236[@i_421]])) && (x5 = K_u_1038[@i_421]))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(x1_391[@i_420], x2_390[@i_420], X[@i_420], @1_x_874[@i_236[@i_420]], K_u_1038[@i_420], r_386[@i_420]) && ((x1 = x1_391[@i_420]) && ((x2 = x2_390[@i_420]) && ((x3 = X[@i_420]) && ((x4 = exp(g, @1_x_874[@i_236[@i_420]])) && (x5 = K_u_1038[@i_420]))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(x1_397[@i_419], x2_396[@i_419], X[@i_419], Yp[@i_233[@i_419]], K_u_1039[@i_419], r_392[@i_419]) && ((x1 = x1_397[@i_419]) && ((x2 = x2_396[@i_419]) && ((x3 = X[@i_419]) && ((x4 = Yp[@i_233[@i_419]]) && (x5 = K_u_1039[@i_419]))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(x1_403[@i_418], x2_402[@i_418], X[@i_418], Yp[@i_233[@i_418]], K_u_1039[@i_418], r_398[@i_418]) && ((x1 = x1_403[@i_418]) && ((x2 = x2_402[@i_418]) && ((x3 = X[@i_418]) && ((x4 = Yp[@i_233[@i_418]]) && (x5 = K_u_1039[@i_418]))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(x1_409[@i_417], x2_408[@i_417], X[@i_417], Y[@i_232[@i_417]], K_u_1040[@i_417], r_404[@i_417]) && ((x1 = x1_409[@i_417]) && ((x2 = x2_408[@i_417]) && ((x3 = X[@i_417]) && ((x4 = Y[@i_232[@i_417]]) && (x5 = K_u_1040[@i_417]))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(x1_415[@i_416], x2_414[@i_416], X[@i_416], Y[@i_232[@i_416]], K_u_1040[@i_416], r_410[@i_416]) && ((x1 = x1_415[@i_416]) && ((x2 = x2_414[@i_416]) && ((x3 = X[@i_416]) && ((x4 = Y[@i_232[@i_416]]) && (x5 = K_u_1040[@i_416]))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_737[@i_240[@i_100]], K_u_1037[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(@1_x_737[@i_240[@i_100]], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1038[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1038[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1039[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1039[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1040[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1040[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_874[@i_100], @1_x_874[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(@1_x_874[@i_100], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of binder K_u_1038 yields

Game 28 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = exp(g, @1_x_737[@i_240]) in
    let K_u_1037: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_737[@i_240]) = x14[@i_115]) && (exp(g, mult(@1_x_737[@i_240], x)) = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      find [unique] @i_506 <= qH0 suchthat defined(x1[@i_506], x2[@i_506], x3[@i_506], x4[@i_506], x5[@i_506], r_338[@i_506]) && ((x1_379 = x1[@i_506]) && ((x2_378 = x2[@i_506]) && ((X = x3[@i_506]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_506]) && (exp(g, mult(@1_x_737[@i_240], x)) = x5[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_506]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_374);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      find [unique] @i_493 <= qH0 suchthat defined(x1[@i_493], x2[@i_493], x3[@i_493], x4[@i_493], x5[@i_493], r_338[@i_493]) && ((x1_373 = x1[@i_493]) && ((x2_372 = x2[@i_493]) && ((X = x3[@i_493]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_493]) && (exp(g, mult(@1_x_737[@i_240], x)) = x5[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_493]);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_368);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = exp(g, @1_x_874[@i_236]) in
    let K_u_1038: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_874[@i_236]) = x14[@i_115]) && (exp(g, mult(@1_x_874[@i_236], x)) = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      find [unique] @i_532 <= qH0 suchthat defined(x1[@i_532], x2[@i_532], x3[@i_532], x4[@i_532], x5[@i_532], r_338[@i_532]) && ((x1_391 = x1[@i_532]) && ((x2_390 = x2[@i_532]) && ((X = x3[@i_532]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_532]) && (exp(g, mult(@1_x_874[@i_236], x)) = x5[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_532]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_386);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      find [unique] @i_519 <= qH0 suchthat defined(x1[@i_519], x2[@i_519], x3[@i_519], x4[@i_519], x5[@i_519], r_338[@i_519]) && ((x1_385 = x1[@i_519]) && ((x2_384 = x2[@i_519]) && ((X = x3[@i_519]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_519]) && (exp(g, mult(@1_x_874[@i_236], x)) = x5[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_519]);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_380);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u_1039: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u_1039 = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      find [unique] @i_558 <= qH0 suchthat defined(x1[@i_558], x2[@i_558], x3[@i_558], x4[@i_558], x5[@i_558], r_338[@i_558]) && ((x1_403 = x1[@i_558]) && ((x2_402 = x2[@i_558]) && ((X = x3[@i_558]) && ((Yp[@i_233] = x4[@i_558]) && (K_u_1039 = x5[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_558]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_398);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      find [unique] @i_545 <= qH0 suchthat defined(x1[@i_545], x2[@i_545], x3[@i_545], x4[@i_545], x5[@i_545], r_338[@i_545]) && ((x1_397 = x1[@i_545]) && ((x2_396 = x2[@i_545]) && ((X = x3[@i_545]) && ((Yp[@i_233] = x4[@i_545]) && (K_u_1039 = x5[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_545]);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_392);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u_1040: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u_1040 = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      find [unique] @i_584 <= qH0 suchthat defined(x1[@i_584], x2[@i_584], x3[@i_584], x4[@i_584], x5[@i_584], r_338[@i_584]) && ((x1_415 = x1[@i_584]) && ((x2_414 = x2[@i_584]) && ((X = x3[@i_584]) && ((Y[@i_232] = x4[@i_584]) && (K_u_1040 = x5[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_584]);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_350[@i_232]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_410);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      find [unique] @i_571 <= qH0 suchthat defined(x1[@i_571], x2[@i_571], x3[@i_571], x4[@i_571], x5[@i_571], r_338[@i_571]) && ((x1_409 = x1[@i_571]) && ((x2_408 = x2[@i_571]) && ((X = x3[@i_571]) && ((Y[@i_232] = x4[@i_571]) && (K_u_1040 = x5[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_571]);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_404);
        out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    let Y_u: G = exp(g, @1_x_874) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (exp(g, mult(x[j], y)) = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      find [unique] @i_454 <= qH0 suchthat defined(x1[@i_454], x2[@i_454], x3[@i_454], x4[@i_454], x5[@i_454], r_338[@i_454]) && ((x1_355 = x1[@i_454]) && ((x2_354 = x2[@i_454]) && ((X_s = x3[@i_454]) && ((Y = x4[@i_454]) && (exp(g, mult(x[j], y)) = x5[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_454])
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_410[j])
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_350)
    )
    orfind  suchthat defined(@i_232[j], r1_94[j], K_u_1040[j]) && (!_58 = @i_232[j]) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (exp(g, mult(x[j], y)) = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = exp(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = exp(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], exp(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], exp(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], exp(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(x1_349[@i_427], x2_348[@i_427], Xp[@i_427], Yp[@i_427], Kp[@i_427], r_344[@i_427]) && ((x1 = x1_349[@i_427]) && ((x2 = x2_348[@i_427]) && ((x3 = Xp[@i_427]) && ((x4 = Yp[@i_427]) && (x5 = Kp[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(y[@i_426], x[j[@i_426]], K_s[@i_426], x1_355[@i_426], x2_354[@i_426], X_s[@i_426], Y[@i_426], r_350[@i_426]) && ((x1 = x1_355[@i_426]) && ((x2 = x2_354[@i_426]) && ((x3 = X_s[@i_426]) && ((x4 = Y[@i_426]) && (x5 = exp(g, mult(x[j[@i_426]], y[@i_426]))))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(y[@i_425], x[j[@i_425]], K_s[@i_425], x1_361[@i_425], x2_360[@i_425], X_s[@i_425], Y[@i_425], r_356[@i_425]) && ((x1 = x1_361[@i_425]) && ((x2 = x2_360[@i_425]) && ((x3 = X_s[@i_425]) && ((x4 = Y[@i_425]) && (x5 = exp(g, mult(x[j[@i_425]], y[@i_425]))))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(x[@i_424], @1_x_874[@i_424], x1_367[@i_424], x2_366[@i_424], X[@i_424], @1_x_874[@i_424], r_362[@i_424]) && ((x1 = x1_367[@i_424]) && ((x2 = x2_366[@i_424]) && ((x3 = X[@i_424]) && ((x4 = exp(g, @1_x_874[@i_424])) && (x5 = exp(g, mult(@1_x_874[@i_424], x[@i_424]))))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(x[@i_423], K_u_1037[@i_423], x1_373[@i_423], x2_372[@i_423], X[@i_423], @1_x_737[@i_240[@i_423]], r_368[@i_423]) && ((x1 = x1_373[@i_423]) && ((x2 = x2_372[@i_423]) && ((x3 = X[@i_423]) && ((x4 = exp(g, @1_x_737[@i_240[@i_423]])) && (x5 = exp(g, mult(@1_x_737[@i_240[@i_423]], x[@i_423]))))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(x[@i_422], K_u_1037[@i_422], x1_379[@i_422], x2_378[@i_422], X[@i_422], @1_x_737[@i_240[@i_422]], r_374[@i_422]) && ((x1 = x1_379[@i_422]) && ((x2 = x2_378[@i_422]) && ((x3 = X[@i_422]) && ((x4 = exp(g, @1_x_737[@i_240[@i_422]])) && (x5 = exp(g, mult(@1_x_737[@i_240[@i_422]], x[@i_422]))))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(x[@i_421], K_u_1038[@i_421], x1_385[@i_421], x2_384[@i_421], X[@i_421], @1_x_874[@i_236[@i_421]], r_380[@i_421]) && ((x1 = x1_385[@i_421]) && ((x2 = x2_384[@i_421]) && ((x3 = X[@i_421]) && ((x4 = exp(g, @1_x_874[@i_236[@i_421]])) && (x5 = exp(g, mult(@1_x_874[@i_236[@i_421]], x[@i_421]))))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(x[@i_420], K_u_1038[@i_420], x1_391[@i_420], x2_390[@i_420], X[@i_420], @1_x_874[@i_236[@i_420]], r_386[@i_420]) && ((x1 = x1_391[@i_420]) && ((x2 = x2_390[@i_420]) && ((x3 = X[@i_420]) && ((x4 = exp(g, @1_x_874[@i_236[@i_420]])) && (x5 = exp(g, mult(@1_x_874[@i_236[@i_420]], x[@i_420]))))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(x1_397[@i_419], x2_396[@i_419], X[@i_419], Yp[@i_233[@i_419]], K_u_1039[@i_419], r_392[@i_419]) && ((x1 = x1_397[@i_419]) && ((x2 = x2_396[@i_419]) && ((x3 = X[@i_419]) && ((x4 = Yp[@i_233[@i_419]]) && (x5 = K_u_1039[@i_419]))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(x1_403[@i_418], x2_402[@i_418], X[@i_418], Yp[@i_233[@i_418]], K_u_1039[@i_418], r_398[@i_418]) && ((x1 = x1_403[@i_418]) && ((x2 = x2_402[@i_418]) && ((x3 = X[@i_418]) && ((x4 = Yp[@i_233[@i_418]]) && (x5 = K_u_1039[@i_418]))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(x1_409[@i_417], x2_408[@i_417], X[@i_417], Y[@i_232[@i_417]], K_u_1040[@i_417], r_404[@i_417]) && ((x1 = x1_409[@i_417]) && ((x2 = x2_408[@i_417]) && ((x3 = X[@i_417]) && ((x4 = Y[@i_232[@i_417]]) && (x5 = K_u_1040[@i_417]))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(x1_415[@i_416], x2_414[@i_416], X[@i_416], Y[@i_232[@i_416]], K_u_1040[@i_416], r_410[@i_416]) && ((x1 = x1_415[@i_416]) && ((x2 = x2_414[@i_416]) && ((x3 = X[@i_416]) && ((x4 = Y[@i_232[@i_416]]) && (x5 = K_u_1040[@i_416]))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_737[@i_240[@i_100]], K_u_1037[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(@1_x_737[@i_240[@i_100]], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_874[@i_236[@i_100]], K_u_1038[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(@1_x_874[@i_236[@i_100]], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1039[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1039[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1040[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1040[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_874[@i_100], @1_x_874[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(@1_x_874[@i_100], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of binder K_u_1039 yields

Game 29 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = exp(g, @1_x_737[@i_240]) in
    let K_u_1037: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_737[@i_240]) = x14[@i_115]) && (exp(g, mult(@1_x_737[@i_240], x)) = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      find [unique] @i_506 <= qH0 suchthat defined(x1[@i_506], x2[@i_506], x3[@i_506], x4[@i_506], x5[@i_506], r_338[@i_506]) && ((x1_379 = x1[@i_506]) && ((x2_378 = x2[@i_506]) && ((X = x3[@i_506]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_506]) && (exp(g, mult(@1_x_737[@i_240], x)) = x5[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_506]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_374);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      find [unique] @i_493 <= qH0 suchthat defined(x1[@i_493], x2[@i_493], x3[@i_493], x4[@i_493], x5[@i_493], r_338[@i_493]) && ((x1_373 = x1[@i_493]) && ((x2_372 = x2[@i_493]) && ((X = x3[@i_493]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_493]) && (exp(g, mult(@1_x_737[@i_240], x)) = x5[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_493]);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_368);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = exp(g, @1_x_874[@i_236]) in
    let K_u_1038: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_874[@i_236]) = x14[@i_115]) && (exp(g, mult(@1_x_874[@i_236], x)) = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      find [unique] @i_532 <= qH0 suchthat defined(x1[@i_532], x2[@i_532], x3[@i_532], x4[@i_532], x5[@i_532], r_338[@i_532]) && ((x1_391 = x1[@i_532]) && ((x2_390 = x2[@i_532]) && ((X = x3[@i_532]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_532]) && (exp(g, mult(@1_x_874[@i_236], x)) = x5[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_532]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_386);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      find [unique] @i_519 <= qH0 suchthat defined(x1[@i_519], x2[@i_519], x3[@i_519], x4[@i_519], x5[@i_519], r_338[@i_519]) && ((x1_385 = x1[@i_519]) && ((x2_384 = x2[@i_519]) && ((X = x3[@i_519]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_519]) && (exp(g, mult(@1_x_874[@i_236], x)) = x5[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_519]);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_380);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u_1039: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (exp(g, mult(yp[@i_233], x)) = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      find [unique] @i_558 <= qH0 suchthat defined(x1[@i_558], x2[@i_558], x3[@i_558], x4[@i_558], x5[@i_558], r_338[@i_558]) && ((x1_403 = x1[@i_558]) && ((x2_402 = x2[@i_558]) && ((X = x3[@i_558]) && ((Yp[@i_233] = x4[@i_558]) && (exp(g, mult(yp[@i_233], x)) = x5[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_558]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_398);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      find [unique] @i_545 <= qH0 suchthat defined(x1[@i_545], x2[@i_545], x3[@i_545], x4[@i_545], x5[@i_545], r_338[@i_545]) && ((x1_397 = x1[@i_545]) && ((x2_396 = x2[@i_545]) && ((X = x3[@i_545]) && ((Yp[@i_233] = x4[@i_545]) && (exp(g, mult(yp[@i_233], x)) = x5[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_545]);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_392);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u_1040: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u_1040 = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      find [unique] @i_584 <= qH0 suchthat defined(x1[@i_584], x2[@i_584], x3[@i_584], x4[@i_584], x5[@i_584], r_338[@i_584]) && ((x1_415 = x1[@i_584]) && ((x2_414 = x2[@i_584]) && ((X = x3[@i_584]) && ((Y[@i_232] = x4[@i_584]) && (K_u_1040 = x5[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_584]);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_350[@i_232]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_410);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      find [unique] @i_571 <= qH0 suchthat defined(x1[@i_571], x2[@i_571], x3[@i_571], x4[@i_571], x5[@i_571], r_338[@i_571]) && ((x1_409 = x1[@i_571]) && ((x2_408 = x2[@i_571]) && ((X = x3[@i_571]) && ((Y[@i_232] = x4[@i_571]) && (K_u_1040 = x5[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_571]);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_404);
        out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    let Y_u: G = exp(g, @1_x_874) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (exp(g, mult(x[j], y)) = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      find [unique] @i_454 <= qH0 suchthat defined(x1[@i_454], x2[@i_454], x3[@i_454], x4[@i_454], x5[@i_454], r_338[@i_454]) && ((x1_355 = x1[@i_454]) && ((x2_354 = x2[@i_454]) && ((X_s = x3[@i_454]) && ((Y = x4[@i_454]) && (exp(g, mult(x[j], y)) = x5[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_454])
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_410[j])
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_350)
    )
    orfind  suchthat defined(@i_232[j], r1_94[j], K_u_1040[j]) && (!_58 = @i_232[j]) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (exp(g, mult(x[j], y)) = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = exp(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = exp(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], exp(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], exp(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], exp(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(x1_349[@i_427], x2_348[@i_427], Xp[@i_427], Yp[@i_427], Kp[@i_427], r_344[@i_427]) && ((x1 = x1_349[@i_427]) && ((x2 = x2_348[@i_427]) && ((x3 = Xp[@i_427]) && ((x4 = Yp[@i_427]) && (x5 = Kp[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(y[@i_426], x[j[@i_426]], K_s[@i_426], x1_355[@i_426], x2_354[@i_426], X_s[@i_426], Y[@i_426], r_350[@i_426]) && ((x1 = x1_355[@i_426]) && ((x2 = x2_354[@i_426]) && ((x3 = X_s[@i_426]) && ((x4 = Y[@i_426]) && (x5 = exp(g, mult(x[j[@i_426]], y[@i_426]))))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(y[@i_425], x[j[@i_425]], K_s[@i_425], x1_361[@i_425], x2_360[@i_425], X_s[@i_425], Y[@i_425], r_356[@i_425]) && ((x1 = x1_361[@i_425]) && ((x2 = x2_360[@i_425]) && ((x3 = X_s[@i_425]) && ((x4 = Y[@i_425]) && (x5 = exp(g, mult(x[j[@i_425]], y[@i_425]))))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(x[@i_424], @1_x_874[@i_424], x1_367[@i_424], x2_366[@i_424], X[@i_424], @1_x_874[@i_424], r_362[@i_424]) && ((x1 = x1_367[@i_424]) && ((x2 = x2_366[@i_424]) && ((x3 = X[@i_424]) && ((x4 = exp(g, @1_x_874[@i_424])) && (x5 = exp(g, mult(@1_x_874[@i_424], x[@i_424]))))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(x[@i_423], K_u_1037[@i_423], x1_373[@i_423], x2_372[@i_423], X[@i_423], @1_x_737[@i_240[@i_423]], r_368[@i_423]) && ((x1 = x1_373[@i_423]) && ((x2 = x2_372[@i_423]) && ((x3 = X[@i_423]) && ((x4 = exp(g, @1_x_737[@i_240[@i_423]])) && (x5 = exp(g, mult(@1_x_737[@i_240[@i_423]], x[@i_423]))))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(x[@i_422], K_u_1037[@i_422], x1_379[@i_422], x2_378[@i_422], X[@i_422], @1_x_737[@i_240[@i_422]], r_374[@i_422]) && ((x1 = x1_379[@i_422]) && ((x2 = x2_378[@i_422]) && ((x3 = X[@i_422]) && ((x4 = exp(g, @1_x_737[@i_240[@i_422]])) && (x5 = exp(g, mult(@1_x_737[@i_240[@i_422]], x[@i_422]))))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(x[@i_421], K_u_1038[@i_421], x1_385[@i_421], x2_384[@i_421], X[@i_421], @1_x_874[@i_236[@i_421]], r_380[@i_421]) && ((x1 = x1_385[@i_421]) && ((x2 = x2_384[@i_421]) && ((x3 = X[@i_421]) && ((x4 = exp(g, @1_x_874[@i_236[@i_421]])) && (x5 = exp(g, mult(@1_x_874[@i_236[@i_421]], x[@i_421]))))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(x[@i_420], K_u_1038[@i_420], x1_391[@i_420], x2_390[@i_420], X[@i_420], @1_x_874[@i_236[@i_420]], r_386[@i_420]) && ((x1 = x1_391[@i_420]) && ((x2 = x2_390[@i_420]) && ((x3 = X[@i_420]) && ((x4 = exp(g, @1_x_874[@i_236[@i_420]])) && (x5 = exp(g, mult(@1_x_874[@i_236[@i_420]], x[@i_420]))))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(x[@i_419], yp[@i_233[@i_419]], K_u_1039[@i_419], x1_397[@i_419], x2_396[@i_419], X[@i_419], Yp[@i_233[@i_419]], r_392[@i_419]) && ((x1 = x1_397[@i_419]) && ((x2 = x2_396[@i_419]) && ((x3 = X[@i_419]) && ((x4 = Yp[@i_233[@i_419]]) && (x5 = exp(g, mult(yp[@i_233[@i_419]], x[@i_419]))))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(x[@i_418], yp[@i_233[@i_418]], K_u_1039[@i_418], x1_403[@i_418], x2_402[@i_418], X[@i_418], Yp[@i_233[@i_418]], r_398[@i_418]) && ((x1 = x1_403[@i_418]) && ((x2 = x2_402[@i_418]) && ((x3 = X[@i_418]) && ((x4 = Yp[@i_233[@i_418]]) && (x5 = exp(g, mult(yp[@i_233[@i_418]], x[@i_418]))))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(x1_409[@i_417], x2_408[@i_417], X[@i_417], Y[@i_232[@i_417]], K_u_1040[@i_417], r_404[@i_417]) && ((x1 = x1_409[@i_417]) && ((x2 = x2_408[@i_417]) && ((x3 = X[@i_417]) && ((x4 = Y[@i_232[@i_417]]) && (x5 = K_u_1040[@i_417]))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(x1_415[@i_416], x2_414[@i_416], X[@i_416], Y[@i_232[@i_416]], K_u_1040[@i_416], r_410[@i_416]) && ((x1 = x1_415[@i_416]) && ((x2 = x2_414[@i_416]) && ((x3 = X[@i_416]) && ((x4 = Y[@i_232[@i_416]]) && (x5 = K_u_1040[@i_416]))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_737[@i_240[@i_100]], K_u_1037[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(@1_x_737[@i_240[@i_100]], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_874[@i_236[@i_100]], K_u_1038[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(@1_x_874[@i_236[@i_100]], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], yp[@i_233[@i_100]], K_u_1039[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(yp[@i_233[@i_100]], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1040[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1040[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_874[@i_100], @1_x_874[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(@1_x_874[@i_100], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of binder K_u_1040 yields

Game 30 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = exp(g, @1_x_737[@i_240]) in
    let K_u_1037: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_737[@i_240]) = x14[@i_115]) && (exp(g, mult(@1_x_737[@i_240], x)) = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      find [unique] @i_506 <= qH0 suchthat defined(x1[@i_506], x2[@i_506], x3[@i_506], x4[@i_506], x5[@i_506], r_338[@i_506]) && ((x1_379 = x1[@i_506]) && ((x2_378 = x2[@i_506]) && ((X = x3[@i_506]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_506]) && (exp(g, mult(@1_x_737[@i_240], x)) = x5[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_506]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_374);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      find [unique] @i_493 <= qH0 suchthat defined(x1[@i_493], x2[@i_493], x3[@i_493], x4[@i_493], x5[@i_493], r_338[@i_493]) && ((x1_373 = x1[@i_493]) && ((x2_372 = x2[@i_493]) && ((X = x3[@i_493]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_493]) && (exp(g, mult(@1_x_737[@i_240], x)) = x5[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_493]);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_368);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = exp(g, @1_x_874[@i_236]) in
    let K_u_1038: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_874[@i_236]) = x14[@i_115]) && (exp(g, mult(@1_x_874[@i_236], x)) = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      find [unique] @i_532 <= qH0 suchthat defined(x1[@i_532], x2[@i_532], x3[@i_532], x4[@i_532], x5[@i_532], r_338[@i_532]) && ((x1_391 = x1[@i_532]) && ((x2_390 = x2[@i_532]) && ((X = x3[@i_532]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_532]) && (exp(g, mult(@1_x_874[@i_236], x)) = x5[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_532]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_386);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      find [unique] @i_519 <= qH0 suchthat defined(x1[@i_519], x2[@i_519], x3[@i_519], x4[@i_519], x5[@i_519], r_338[@i_519]) && ((x1_385 = x1[@i_519]) && ((x2_384 = x2[@i_519]) && ((X = x3[@i_519]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_519]) && (exp(g, mult(@1_x_874[@i_236], x)) = x5[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_519]);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_380);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u_1039: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (exp(g, mult(yp[@i_233], x)) = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      find [unique] @i_558 <= qH0 suchthat defined(x1[@i_558], x2[@i_558], x3[@i_558], x4[@i_558], x5[@i_558], r_338[@i_558]) && ((x1_403 = x1[@i_558]) && ((x2_402 = x2[@i_558]) && ((X = x3[@i_558]) && ((Yp[@i_233] = x4[@i_558]) && (exp(g, mult(yp[@i_233], x)) = x5[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_558]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_398);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      find [unique] @i_545 <= qH0 suchthat defined(x1[@i_545], x2[@i_545], x3[@i_545], x4[@i_545], x5[@i_545], r_338[@i_545]) && ((x1_397 = x1[@i_545]) && ((x2_396 = x2[@i_545]) && ((X = x3[@i_545]) && ((Yp[@i_233] = x4[@i_545]) && (exp(g, mult(yp[@i_233], x)) = x5[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_545]);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_392);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u_1040: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (exp(g, mult(y[@i_232], x)) = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      find [unique] @i_584 <= qH0 suchthat defined(x1[@i_584], x2[@i_584], x3[@i_584], x4[@i_584], x5[@i_584], r_338[@i_584]) && ((x1_415 = x1[@i_584]) && ((x2_414 = x2[@i_584]) && ((X = x3[@i_584]) && ((Y[@i_232] = x4[@i_584]) && (exp(g, mult(y[@i_232], x)) = x5[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_584]);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_350[@i_232]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_410);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      find [unique] @i_571 <= qH0 suchthat defined(x1[@i_571], x2[@i_571], x3[@i_571], x4[@i_571], x5[@i_571], r_338[@i_571]) && ((x1_409 = x1[@i_571]) && ((x2_408 = x2[@i_571]) && ((X = x3[@i_571]) && ((Y[@i_232] = x4[@i_571]) && (exp(g, mult(y[@i_232], x)) = x5[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_571]);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_404);
        out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    let Y_u: G = exp(g, @1_x_874) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (exp(g, mult(x[j], y)) = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      find [unique] @i_454 <= qH0 suchthat defined(x1[@i_454], x2[@i_454], x3[@i_454], x4[@i_454], x5[@i_454], r_338[@i_454]) && ((x1_355 = x1[@i_454]) && ((x2_354 = x2[@i_454]) && ((X_s = x3[@i_454]) && ((Y = x4[@i_454]) && (exp(g, mult(x[j], y)) = x5[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_454])
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_410[j])
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_350)
    )
    orfind  suchthat defined(x[j], y[@i_232[j]], K_u_1040[j], @i_232[j], r1_94[j]) && (!_58 = @i_232[j]) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (exp(g, mult(x[j], y)) = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = exp(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = exp(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], exp(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], exp(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], exp(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(x1_349[@i_427], x2_348[@i_427], Xp[@i_427], Yp[@i_427], Kp[@i_427], r_344[@i_427]) && ((x1 = x1_349[@i_427]) && ((x2 = x2_348[@i_427]) && ((x3 = Xp[@i_427]) && ((x4 = Yp[@i_427]) && (x5 = Kp[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(y[@i_426], x[j[@i_426]], K_s[@i_426], x1_355[@i_426], x2_354[@i_426], X_s[@i_426], Y[@i_426], r_350[@i_426]) && ((x1 = x1_355[@i_426]) && ((x2 = x2_354[@i_426]) && ((x3 = X_s[@i_426]) && ((x4 = Y[@i_426]) && (x5 = exp(g, mult(x[j[@i_426]], y[@i_426]))))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(y[@i_425], x[j[@i_425]], K_s[@i_425], x1_361[@i_425], x2_360[@i_425], X_s[@i_425], Y[@i_425], r_356[@i_425]) && ((x1 = x1_361[@i_425]) && ((x2 = x2_360[@i_425]) && ((x3 = X_s[@i_425]) && ((x4 = Y[@i_425]) && (x5 = exp(g, mult(x[j[@i_425]], y[@i_425]))))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(x[@i_424], @1_x_874[@i_424], x1_367[@i_424], x2_366[@i_424], X[@i_424], @1_x_874[@i_424], r_362[@i_424]) && ((x1 = x1_367[@i_424]) && ((x2 = x2_366[@i_424]) && ((x3 = X[@i_424]) && ((x4 = exp(g, @1_x_874[@i_424])) && (x5 = exp(g, mult(@1_x_874[@i_424], x[@i_424]))))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(x[@i_423], K_u_1037[@i_423], x1_373[@i_423], x2_372[@i_423], X[@i_423], @1_x_737[@i_240[@i_423]], r_368[@i_423]) && ((x1 = x1_373[@i_423]) && ((x2 = x2_372[@i_423]) && ((x3 = X[@i_423]) && ((x4 = exp(g, @1_x_737[@i_240[@i_423]])) && (x5 = exp(g, mult(@1_x_737[@i_240[@i_423]], x[@i_423]))))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(x[@i_422], K_u_1037[@i_422], x1_379[@i_422], x2_378[@i_422], X[@i_422], @1_x_737[@i_240[@i_422]], r_374[@i_422]) && ((x1 = x1_379[@i_422]) && ((x2 = x2_378[@i_422]) && ((x3 = X[@i_422]) && ((x4 = exp(g, @1_x_737[@i_240[@i_422]])) && (x5 = exp(g, mult(@1_x_737[@i_240[@i_422]], x[@i_422]))))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(x[@i_421], K_u_1038[@i_421], x1_385[@i_421], x2_384[@i_421], X[@i_421], @1_x_874[@i_236[@i_421]], r_380[@i_421]) && ((x1 = x1_385[@i_421]) && ((x2 = x2_384[@i_421]) && ((x3 = X[@i_421]) && ((x4 = exp(g, @1_x_874[@i_236[@i_421]])) && (x5 = exp(g, mult(@1_x_874[@i_236[@i_421]], x[@i_421]))))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(x[@i_420], K_u_1038[@i_420], x1_391[@i_420], x2_390[@i_420], X[@i_420], @1_x_874[@i_236[@i_420]], r_386[@i_420]) && ((x1 = x1_391[@i_420]) && ((x2 = x2_390[@i_420]) && ((x3 = X[@i_420]) && ((x4 = exp(g, @1_x_874[@i_236[@i_420]])) && (x5 = exp(g, mult(@1_x_874[@i_236[@i_420]], x[@i_420]))))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(x[@i_419], yp[@i_233[@i_419]], K_u_1039[@i_419], x1_397[@i_419], x2_396[@i_419], X[@i_419], Yp[@i_233[@i_419]], r_392[@i_419]) && ((x1 = x1_397[@i_419]) && ((x2 = x2_396[@i_419]) && ((x3 = X[@i_419]) && ((x4 = Yp[@i_233[@i_419]]) && (x5 = exp(g, mult(yp[@i_233[@i_419]], x[@i_419]))))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(x[@i_418], yp[@i_233[@i_418]], K_u_1039[@i_418], x1_403[@i_418], x2_402[@i_418], X[@i_418], Yp[@i_233[@i_418]], r_398[@i_418]) && ((x1 = x1_403[@i_418]) && ((x2 = x2_402[@i_418]) && ((x3 = X[@i_418]) && ((x4 = Yp[@i_233[@i_418]]) && (x5 = exp(g, mult(yp[@i_233[@i_418]], x[@i_418]))))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(x[@i_417], y[@i_232[@i_417]], K_u_1040[@i_417], x1_409[@i_417], x2_408[@i_417], X[@i_417], Y[@i_232[@i_417]], r_404[@i_417]) && ((x1 = x1_409[@i_417]) && ((x2 = x2_408[@i_417]) && ((x3 = X[@i_417]) && ((x4 = Y[@i_232[@i_417]]) && (x5 = exp(g, mult(y[@i_232[@i_417]], x[@i_417]))))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(x[@i_416], y[@i_232[@i_416]], K_u_1040[@i_416], x1_415[@i_416], x2_414[@i_416], X[@i_416], Y[@i_232[@i_416]], r_410[@i_416]) && ((x1 = x1_415[@i_416]) && ((x2 = x2_414[@i_416]) && ((x3 = X[@i_416]) && ((x4 = Y[@i_232[@i_416]]) && (x5 = exp(g, mult(y[@i_232[@i_416]], x[@i_416]))))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_737[@i_240[@i_100]], K_u_1037[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(@1_x_737[@i_240[@i_100]], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_874[@i_236[@i_100]], K_u_1038[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(@1_x_874[@i_236[@i_100]], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], yp[@i_233[@i_100]], K_u_1039[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(yp[@i_233[@i_100]], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], y[@i_232[@i_100]], K_u_1040[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(y[@i_232[@i_100]], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_874[@i_100], @1_x_874[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(@1_x_874[@i_100], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of binder Kp yields

Game 31 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = exp(g, @1_x_737[@i_240]) in
    let K_u_1037: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_737[@i_240]) = x14[@i_115]) && (exp(g, mult(@1_x_737[@i_240], x)) = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      find [unique] @i_506 <= qH0 suchthat defined(x1[@i_506], x2[@i_506], x3[@i_506], x4[@i_506], x5[@i_506], r_338[@i_506]) && ((x1_379 = x1[@i_506]) && ((x2_378 = x2[@i_506]) && ((X = x3[@i_506]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_506]) && (exp(g, mult(@1_x_737[@i_240], x)) = x5[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_506]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_374);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      find [unique] @i_493 <= qH0 suchthat defined(x1[@i_493], x2[@i_493], x3[@i_493], x4[@i_493], x5[@i_493], r_338[@i_493]) && ((x1_373 = x1[@i_493]) && ((x2_372 = x2[@i_493]) && ((X = x3[@i_493]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_493]) && (exp(g, mult(@1_x_737[@i_240], x)) = x5[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_493]);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_368);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = exp(g, @1_x_874[@i_236]) in
    let K_u_1038: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_874[@i_236]) = x14[@i_115]) && (exp(g, mult(@1_x_874[@i_236], x)) = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      find [unique] @i_532 <= qH0 suchthat defined(x1[@i_532], x2[@i_532], x3[@i_532], x4[@i_532], x5[@i_532], r_338[@i_532]) && ((x1_391 = x1[@i_532]) && ((x2_390 = x2[@i_532]) && ((X = x3[@i_532]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_532]) && (exp(g, mult(@1_x_874[@i_236], x)) = x5[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_532]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_386);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      find [unique] @i_519 <= qH0 suchthat defined(x1[@i_519], x2[@i_519], x3[@i_519], x4[@i_519], x5[@i_519], r_338[@i_519]) && ((x1_385 = x1[@i_519]) && ((x2_384 = x2[@i_519]) && ((X = x3[@i_519]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_519]) && (exp(g, mult(@1_x_874[@i_236], x)) = x5[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_519]);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_380);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u_1039: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (exp(g, mult(yp[@i_233], x)) = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      find [unique] @i_558 <= qH0 suchthat defined(x1[@i_558], x2[@i_558], x3[@i_558], x4[@i_558], x5[@i_558], r_338[@i_558]) && ((x1_403 = x1[@i_558]) && ((x2_402 = x2[@i_558]) && ((X = x3[@i_558]) && ((Yp[@i_233] = x4[@i_558]) && (exp(g, mult(yp[@i_233], x)) = x5[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_558]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_398);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      find [unique] @i_545 <= qH0 suchthat defined(x1[@i_545], x2[@i_545], x3[@i_545], x4[@i_545], x5[@i_545], r_338[@i_545]) && ((x1_397 = x1[@i_545]) && ((x2_396 = x2[@i_545]) && ((X = x3[@i_545]) && ((Yp[@i_233] = x4[@i_545]) && (exp(g, mult(yp[@i_233], x)) = x5[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_545]);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_392);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u_1040: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (exp(g, mult(y[@i_232], x)) = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      find [unique] @i_584 <= qH0 suchthat defined(x1[@i_584], x2[@i_584], x3[@i_584], x4[@i_584], x5[@i_584], r_338[@i_584]) && ((x1_415 = x1[@i_584]) && ((x2_414 = x2[@i_584]) && ((X = x3[@i_584]) && ((Y[@i_232] = x4[@i_584]) && (exp(g, mult(y[@i_232], x)) = x5[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_584]);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_350[@i_232]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_410);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      find [unique] @i_571 <= qH0 suchthat defined(x1[@i_571], x2[@i_571], x3[@i_571], x4[@i_571], x5[@i_571], r_338[@i_571]) && ((x1_409 = x1[@i_571]) && ((x2_408 = x2[@i_571]) && ((X = x3[@i_571]) && ((Y[@i_232] = x4[@i_571]) && (exp(g, mult(y[@i_232], x)) = x5[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_571]);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_404);
        out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    let Y_u: G = exp(g, @1_x_874) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (exp(g, mult(x[j], y)) = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      find [unique] @i_454 <= qH0 suchthat defined(x1[@i_454], x2[@i_454], x3[@i_454], x4[@i_454], x5[@i_454], r_338[@i_454]) && ((x1_355 = x1[@i_454]) && ((x2_354 = x2[@i_454]) && ((X_s = x3[@i_454]) && ((Y = x4[@i_454]) && (exp(g, mult(x[j], y)) = x5[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_454])
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_410[j])
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_350)
    )
    orfind  suchthat defined(x[j], y[@i_232[j]], K_u_1040[j], @i_232[j], r1_94[j]) && (!_58 = @i_232[j]) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (exp(g, mult(x[j], y)) = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = exp(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = exp(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], exp(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], exp(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], exp(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(yp[@i_427], xp[@i_427], xp[@i_427], x1_349[@i_427], x2_348[@i_427], Xp[@i_427], Yp[@i_427], r_344[@i_427]) && ((x1 = x1_349[@i_427]) && ((x2 = x2_348[@i_427]) && ((x3 = Xp[@i_427]) && ((x4 = Yp[@i_427]) && (x5 = exp(g, mult(xp[@i_427], yp[@i_427]))))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(y[@i_426], x[j[@i_426]], K_s[@i_426], x1_355[@i_426], x2_354[@i_426], X_s[@i_426], Y[@i_426], r_350[@i_426]) && ((x1 = x1_355[@i_426]) && ((x2 = x2_354[@i_426]) && ((x3 = X_s[@i_426]) && ((x4 = Y[@i_426]) && (x5 = exp(g, mult(x[j[@i_426]], y[@i_426]))))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(y[@i_425], x[j[@i_425]], K_s[@i_425], x1_361[@i_425], x2_360[@i_425], X_s[@i_425], Y[@i_425], r_356[@i_425]) && ((x1 = x1_361[@i_425]) && ((x2 = x2_360[@i_425]) && ((x3 = X_s[@i_425]) && ((x4 = Y[@i_425]) && (x5 = exp(g, mult(x[j[@i_425]], y[@i_425]))))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(x[@i_424], @1_x_874[@i_424], x1_367[@i_424], x2_366[@i_424], X[@i_424], @1_x_874[@i_424], r_362[@i_424]) && ((x1 = x1_367[@i_424]) && ((x2 = x2_366[@i_424]) && ((x3 = X[@i_424]) && ((x4 = exp(g, @1_x_874[@i_424])) && (x5 = exp(g, mult(@1_x_874[@i_424], x[@i_424]))))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(x[@i_423], K_u_1037[@i_423], x1_373[@i_423], x2_372[@i_423], X[@i_423], @1_x_737[@i_240[@i_423]], r_368[@i_423]) && ((x1 = x1_373[@i_423]) && ((x2 = x2_372[@i_423]) && ((x3 = X[@i_423]) && ((x4 = exp(g, @1_x_737[@i_240[@i_423]])) && (x5 = exp(g, mult(@1_x_737[@i_240[@i_423]], x[@i_423]))))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(x[@i_422], K_u_1037[@i_422], x1_379[@i_422], x2_378[@i_422], X[@i_422], @1_x_737[@i_240[@i_422]], r_374[@i_422]) && ((x1 = x1_379[@i_422]) && ((x2 = x2_378[@i_422]) && ((x3 = X[@i_422]) && ((x4 = exp(g, @1_x_737[@i_240[@i_422]])) && (x5 = exp(g, mult(@1_x_737[@i_240[@i_422]], x[@i_422]))))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(x[@i_421], K_u_1038[@i_421], x1_385[@i_421], x2_384[@i_421], X[@i_421], @1_x_874[@i_236[@i_421]], r_380[@i_421]) && ((x1 = x1_385[@i_421]) && ((x2 = x2_384[@i_421]) && ((x3 = X[@i_421]) && ((x4 = exp(g, @1_x_874[@i_236[@i_421]])) && (x5 = exp(g, mult(@1_x_874[@i_236[@i_421]], x[@i_421]))))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(x[@i_420], K_u_1038[@i_420], x1_391[@i_420], x2_390[@i_420], X[@i_420], @1_x_874[@i_236[@i_420]], r_386[@i_420]) && ((x1 = x1_391[@i_420]) && ((x2 = x2_390[@i_420]) && ((x3 = X[@i_420]) && ((x4 = exp(g, @1_x_874[@i_236[@i_420]])) && (x5 = exp(g, mult(@1_x_874[@i_236[@i_420]], x[@i_420]))))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(x[@i_419], yp[@i_233[@i_419]], K_u_1039[@i_419], x1_397[@i_419], x2_396[@i_419], X[@i_419], Yp[@i_233[@i_419]], r_392[@i_419]) && ((x1 = x1_397[@i_419]) && ((x2 = x2_396[@i_419]) && ((x3 = X[@i_419]) && ((x4 = Yp[@i_233[@i_419]]) && (x5 = exp(g, mult(yp[@i_233[@i_419]], x[@i_419]))))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(x[@i_418], yp[@i_233[@i_418]], K_u_1039[@i_418], x1_403[@i_418], x2_402[@i_418], X[@i_418], Yp[@i_233[@i_418]], r_398[@i_418]) && ((x1 = x1_403[@i_418]) && ((x2 = x2_402[@i_418]) && ((x3 = X[@i_418]) && ((x4 = Yp[@i_233[@i_418]]) && (x5 = exp(g, mult(yp[@i_233[@i_418]], x[@i_418]))))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(x[@i_417], y[@i_232[@i_417]], K_u_1040[@i_417], x1_409[@i_417], x2_408[@i_417], X[@i_417], Y[@i_232[@i_417]], r_404[@i_417]) && ((x1 = x1_409[@i_417]) && ((x2 = x2_408[@i_417]) && ((x3 = X[@i_417]) && ((x4 = Y[@i_232[@i_417]]) && (x5 = exp(g, mult(y[@i_232[@i_417]], x[@i_417]))))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(x[@i_416], y[@i_232[@i_416]], K_u_1040[@i_416], x1_415[@i_416], x2_414[@i_416], X[@i_416], Y[@i_232[@i_416]], r_410[@i_416]) && ((x1 = x1_415[@i_416]) && ((x2 = x2_414[@i_416]) && ((x3 = X[@i_416]) && ((x4 = Y[@i_232[@i_416]]) && (x5 = exp(g, mult(y[@i_232[@i_416]], x[@i_416]))))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(yp[@i_102], xp[@i_102], xp[@i_102], x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = exp(g, mult(xp[@i_102], yp[@i_102]))))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_737[@i_240[@i_100]], K_u_1037[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(@1_x_737[@i_240[@i_100]], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_874[@i_236[@i_100]], K_u_1038[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(@1_x_874[@i_236[@i_100]], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], yp[@i_233[@i_100]], K_u_1039[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(yp[@i_233[@i_100]], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], y[@i_232[@i_100]], K_u_1040[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(y[@i_232[@i_100]], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_874[@i_100], @1_x_874[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(@1_x_874[@i_100], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 7.4 * #@1_Oa) * max(1., 7.4 * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
with x, @1_x_874, yp, y, xp, @1_x_737 [Excluding set(dist 31->32, proba <= 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)))] yields

Game 32 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = @1_exp'(g, @1_x_737[@i_240]) in
    let K_u_1037: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && find  else find  else ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@1_exp'(g, @1_x_737[@i_240]) = x14[@i_115]) && false)))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      find [unique] @i_506 <= qH0 suchthat defined(x1[@i_506], x2[@i_506], x3[@i_506], x4[@i_506], x5[@i_506], r_338[@i_506]) && find  else find  else ((x1_379 = x1[@i_506]) && ((x2_378 = x2[@i_506]) && ((X = x3[@i_506]) && ((@1_exp'(g, @1_x_737[@i_240]) = x4[@i_506]) && false)))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_506]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_374);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      find [unique] @i_493 <= qH0 suchthat defined(x1[@i_493], x2[@i_493], x3[@i_493], x4[@i_493], x5[@i_493], r_338[@i_493]) && find  else find  else ((x1_373 = x1[@i_493]) && ((x2_372 = x2[@i_493]) && ((X = x3[@i_493]) && ((@1_exp'(g, @1_x_737[@i_240]) = x4[@i_493]) && false)))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_493]);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_368);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = @1_exp'(g, @1_x_874[@i_236]) in
    let K_u_1038: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && find  else find  else ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@1_exp'(g, @1_x_874[@i_236]) = x14[@i_115]) && false)))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      find [unique] @i_532 <= qH0 suchthat defined(x1[@i_532], x2[@i_532], x3[@i_532], x4[@i_532], x5[@i_532], r_338[@i_532]) && find  else find  else ((x1_391 = x1[@i_532]) && ((x2_390 = x2[@i_532]) && ((X = x3[@i_532]) && ((@1_exp'(g, @1_x_874[@i_236]) = x4[@i_532]) && false)))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_532]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_386);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      find [unique] @i_519 <= qH0 suchthat defined(x1[@i_519], x2[@i_519], x3[@i_519], x4[@i_519], x5[@i_519], r_338[@i_519]) && find  else find  else ((x1_385 = x1[@i_519]) && ((x2_384 = x2[@i_519]) && ((X = x3[@i_519]) && ((@1_exp'(g, @1_x_874[@i_236]) = x4[@i_519]) && false)))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_519]);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_380);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u_1039: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && find  else find  else ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && false)))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      find [unique] @i_558 <= qH0 suchthat defined(x1[@i_558], x2[@i_558], x3[@i_558], x4[@i_558], x5[@i_558], r_338[@i_558]) && find  else find  else ((x1_403 = x1[@i_558]) && ((x2_402 = x2[@i_558]) && ((X = x3[@i_558]) && ((Yp[@i_233] = x4[@i_558]) && false)))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_558]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_398);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      find [unique] @i_545 <= qH0 suchthat defined(x1[@i_545], x2[@i_545], x3[@i_545], x4[@i_545], x5[@i_545], r_338[@i_545]) && find  else find  else ((x1_397 = x1[@i_545]) && ((x2_396 = x2[@i_545]) && ((X = x3[@i_545]) && ((Yp[@i_233] = x4[@i_545]) && false)))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_545]);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_392);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u_1040: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && find  else find  else ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && false)))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      find [unique] @i_584 <= qH0 suchthat defined(x1[@i_584], x2[@i_584], x3[@i_584], x4[@i_584], x5[@i_584], r_338[@i_584]) && find  else find  else ((x1_415 = x1[@i_584]) && ((x2_414 = x2[@i_584]) && ((X = x3[@i_584]) && ((Y[@i_232] = x4[@i_584]) && false)))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_584]);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_350[@i_232]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_410);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      find [unique] @i_571 <= qH0 suchthat defined(x1[@i_571], x2[@i_571], x3[@i_571], x4[@i_571], x5[@i_571], r_338[@i_571]) && find  else find  else ((x1_409 = x1[@i_571]) && ((x2_408 = x2[@i_571]) && ((X = x3[@i_571]) && ((Y[@i_232] = x4[@i_571]) && false)))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_571]);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_404);
        out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    let Y_u: G = @1_exp'(g, @1_x_874) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && find  else find  else ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && false)))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      find [unique] @i_454 <= qH0 suchthat defined(x1[@i_454], x2[@i_454], x3[@i_454], x4[@i_454], x5[@i_454], r_338[@i_454]) && find  else find  else ((x1_355 = x1[@i_454]) && ((x2_354 = x2[@i_454]) && ((X_s = x3[@i_454]) && ((Y = x4[@i_454]) && false)))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_454])
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_410[j])
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_350)
    )
    orfind  suchthat defined(x[j], y[@i_232[j]], K_u_1040[j], @i_232[j], r1_94[j]) && (!_58 = @i_232[j]) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], r_338[@i_467]) && find  else find  else ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && false)))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = @1_exp'(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_exp'(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], @1_exp'(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(yp[@i_427], xp[@i_427], xp[@i_427], x1_349[@i_427], x2_348[@i_427], Xp[@i_427], Yp[@i_427], r_344[@i_427]) && find  else find  else ((x1 = x1_349[@i_427]) && ((x2 = x2_348[@i_427]) && ((x3 = Xp[@i_427]) && ((x4 = Yp[@i_427]) && false)))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(y[@i_426], x[j[@i_426]], K_s[@i_426], x1_355[@i_426], x2_354[@i_426], X_s[@i_426], Y[@i_426], r_350[@i_426]) && find  else find  else ((x1 = x1_355[@i_426]) && ((x2 = x2_354[@i_426]) && ((x3 = X_s[@i_426]) && ((x4 = Y[@i_426]) && false)))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(y[@i_425], x[j[@i_425]], K_s[@i_425], x1_361[@i_425], x2_360[@i_425], X_s[@i_425], Y[@i_425], r_356[@i_425]) && find  else find  else ((x1 = x1_361[@i_425]) && ((x2 = x2_360[@i_425]) && ((x3 = X_s[@i_425]) && ((x4 = Y[@i_425]) && false)))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(x[@i_424], @1_x_874[@i_424], x1_367[@i_424], x2_366[@i_424], X[@i_424], @1_x_874[@i_424], r_362[@i_424]) && find  else find  else ((x1 = x1_367[@i_424]) && ((x2 = x2_366[@i_424]) && ((x3 = X[@i_424]) && ((x4 = @1_exp'(g, @1_x_874[@i_424])) && false)))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(x[@i_423], K_u_1037[@i_423], x1_373[@i_423], x2_372[@i_423], X[@i_423], @1_x_737[@i_240[@i_423]], r_368[@i_423]) && find  else find  else ((x1 = x1_373[@i_423]) && ((x2 = x2_372[@i_423]) && ((x3 = X[@i_423]) && ((x4 = @1_exp'(g, @1_x_737[@i_240[@i_423]])) && false)))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(x[@i_422], K_u_1037[@i_422], x1_379[@i_422], x2_378[@i_422], X[@i_422], @1_x_737[@i_240[@i_422]], r_374[@i_422]) && find  else find  else ((x1 = x1_379[@i_422]) && ((x2 = x2_378[@i_422]) && ((x3 = X[@i_422]) && ((x4 = @1_exp'(g, @1_x_737[@i_240[@i_422]])) && false)))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(x[@i_421], K_u_1038[@i_421], x1_385[@i_421], x2_384[@i_421], X[@i_421], @1_x_874[@i_236[@i_421]], r_380[@i_421]) && find  else find  else ((x1 = x1_385[@i_421]) && ((x2 = x2_384[@i_421]) && ((x3 = X[@i_421]) && ((x4 = @1_exp'(g, @1_x_874[@i_236[@i_421]])) && false)))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(x[@i_420], K_u_1038[@i_420], x1_391[@i_420], x2_390[@i_420], X[@i_420], @1_x_874[@i_236[@i_420]], r_386[@i_420]) && find  else find  else ((x1 = x1_391[@i_420]) && ((x2 = x2_390[@i_420]) && ((x3 = X[@i_420]) && ((x4 = @1_exp'(g, @1_x_874[@i_236[@i_420]])) && false)))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(x[@i_419], yp[@i_233[@i_419]], K_u_1039[@i_419], x1_397[@i_419], x2_396[@i_419], X[@i_419], Yp[@i_233[@i_419]], r_392[@i_419]) && find  else find  else ((x1 = x1_397[@i_419]) && ((x2 = x2_396[@i_419]) && ((x3 = X[@i_419]) && ((x4 = Yp[@i_233[@i_419]]) && false)))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(x[@i_418], yp[@i_233[@i_418]], K_u_1039[@i_418], x1_403[@i_418], x2_402[@i_418], X[@i_418], Yp[@i_233[@i_418]], r_398[@i_418]) && find  else find  else ((x1 = x1_403[@i_418]) && ((x2 = x2_402[@i_418]) && ((x3 = X[@i_418]) && ((x4 = Yp[@i_233[@i_418]]) && false)))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(x[@i_417], y[@i_232[@i_417]], K_u_1040[@i_417], x1_409[@i_417], x2_408[@i_417], X[@i_417], Y[@i_232[@i_417]], r_404[@i_417]) && find  else find  else ((x1 = x1_409[@i_417]) && ((x2 = x2_408[@i_417]) && ((x3 = X[@i_417]) && ((x4 = Y[@i_232[@i_417]]) && false)))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(x[@i_416], y[@i_232[@i_416]], K_u_1040[@i_416], x1_415[@i_416], x2_414[@i_416], X[@i_416], Y[@i_232[@i_416]], r_410[@i_416]) && find  else find  else ((x1 = x1_415[@i_416]) && ((x2 = x2_414[@i_416]) && ((x3 = X[@i_416]) && ((x4 = Y[@i_232[@i_416]]) && false)))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(yp[@i_102], xp[@i_102], xp[@i_102], x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], r1_88[@i_102]) && find  else find  else ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && false)))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_737[@i_240[@i_100]], K_u_1037[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && find  else find  else ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && false)))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_874[@i_236[@i_100]], K_u_1038[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && find  else find  else ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && false)))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], yp[@i_233[@i_100]], K_u_1039[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && find  else find  else ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && false)))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], y[@i_232[@i_100]], K_u_1040[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && find  else find  else ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && false)))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_874[@i_100], @1_x_874[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && find  else find  else ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && false)))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying simplify yields

Game 33 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = @1_exp'(g, @1_x_737[@i_240]) in
    let K_u_1037: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    let x1_373: host = U in
    let x2_372: host = S in
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    event termU(U, X, S, Ystar_u, r1_94, r_368);
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = @1_exp'(g, @1_x_874[@i_236]) in
    let K_u_1038: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    let x1_385: host = U in
    let x2_384: host = S in
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    event termU(U, X, S, Ystar_u, r1_94, r_380);
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u_1039: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    let x1_397: host = U in
    let x2_396: host = S in
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    event termU(U, X, S, Ystar_u, r1_94, r_392);
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u_1040: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    let x1_409: host = U in
    let x2_408: host = S in
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    event termU(U, X, S, Ystar_u, r1_94, r_404);
    out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    let Y_u: G = @1_exp'(g, @1_x_874) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    let x1_361: host = U in
    let x2_360: host = S in
    if defined(r_404[j]) then
    let sk_s: hash0 = r_404[j] in
    event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = @1_exp'(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_exp'(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], @1_exp'(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying move all binders yields

Game 34 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = @1_exp'(g, @1_x_737[@i_240]) in
    let K_u_1037: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    let x1_373: host = U in
    let x2_372: host = S in
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    event termU(U, X, S, Ystar_u, r1_94, r_368);
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = @1_exp'(g, @1_x_874[@i_236]) in
    let K_u_1038: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    let x1_385: host = U in
    let x2_384: host = S in
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    event termU(U, X, S, Ystar_u, r1_94, r_380);
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u_1039: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    let x1_397: host = U in
    let x2_396: host = S in
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    event termU(U, X, S, Ystar_u, r1_94, r_392);
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u_1040: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    let x1_409: host = U in
    let x2_408: host = S in
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    event termU(U, X, S, Ystar_u, r1_94, r_404);
    out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    let Y_u: G = @1_exp'(g, @1_x_874) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    if defined(r_404[j]) then
    let sk_s: hash0 = r_404[j] in
    event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = @1_exp'(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_exp'(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], @1_exp'(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of useless yields

Game 35 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    event termU(U, X, S, Ystar_u, r1_94, r_368);
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    event termU(U, X, S, Ystar_u, r1_94, r_380);
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    event termU(U, X, S, Ystar_u, r1_94, r_392);
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    event termU(U, X, S, Ystar_u, r1_94, r_404);
    out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    if defined(r_404[j]) then
    let sk_s: hash0 = r_404[j] in
    event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = @1_exp'(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_exp'(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], @1_exp'(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


RESULT Proved event termS(x, X, y, Y, a, k) && termU(x, X, y, Y, a, k') ==> (k = k') excluding set(dist 1->2, proba <= NS / |hash1|) U set(dist 2->3, proba <= 2. * NU * NP / |exponent| + qH1 * NP / |exponent| + 1. / |exponent| * NP + NP * NP / |exponent| + NS * NP / |exponent| + 0.5 * NU * NU / |exponent|) U set(event Auth in game 7) U set(dist 8->9, proba <= (NS * NS + 2. * NP * NS + 2. * qE * NS + 2. * NU * NS + 2. * qD * NS + NP * NP + 2. * qE * NP + 2. * NU * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 2. * qD * qE + NU * NU + 2. * qD * NU + qD * qD + -1. * NS + -1. * NP + -1. * qE + -1. * NU + -1. * qD) / |G|) U set(dist 9->10, proba <= NS * NP / |exponent| + qE * NP / |exponent| + NU * NP / |exponent| + qD * NP / |exponent| + NP * NS / |exponent| + qE * NS / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G| + 0.5 * NS * NS / |exponent|) U set(event Encryptt in game 13) U set(dist 14->15, proba <= 10. * NU * NP / |exponent| + 2. * NS * NP / |exponent| + qH0 * NP / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + 8.5 * NU * NU / |G| + 3. * NS * NU / |G| + 2. * NP * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NP * qD / |G| + qD * NP / |exponent| + 1. / |exponent| * NP + 15. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + NU * qH1 / |hash1| + NS * NP / |G| + qD * NU / |G| + 0.5 * qD * qD / |G|) U set(dist 23->24, proba <= 4. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|) U set(dist 31->32, proba <= 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)))
RESULT However, I could not bound the probability of set(event Auth in game 7)
RESULT Proved event inj:termS(x, X, y, Y, a, k) ==> inj:termU(x, X, y, Y, a, k) excluding set(dist 1->2, proba <= NS / |hash1|) U set(dist 2->3, proba <= 2. * NU * NP / |exponent| + qH1 * NP / |exponent| + 1. / |exponent| * NP + NP * NP / |exponent| + NS * NP / |exponent| + 0.5 * NU * NU / |exponent|) U set(event Auth in game 7) U set(dist 8->9, proba <= (NS * NS + 2. * NP * NS + 2. * qE * NS + 2. * NU * NS + 2. * qD * NS + NP * NP + 2. * qE * NP + 2. * NU * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 2. * qD * qE + NU * NU + 2. * qD * NU + qD * qD + -1. * NS + -1. * NP + -1. * qE + -1. * NU + -1. * qD) / |G|) U set(dist 9->10, proba <= NS * NP / |exponent| + qE * NP / |exponent| + NU * NP / |exponent| + qD * NP / |exponent| + NP * NS / |exponent| + qE * NS / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G| + 0.5 * NS * NS / |exponent|) U set(event Encryptt in game 13) U set(dist 14->15, proba <= 10. * NU * NP / |exponent| + 2. * NS * NP / |exponent| + qH0 * NP / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + 8.5 * NU * NU / |G| + 3. * NS * NU / |G| + 2. * NP * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NP * qD / |G| + qD * NP / |exponent| + 1. / |exponent| * NP + 15. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + NU * qH1 / |hash1| + NS * NP / |G| + qD * NU / |G| + 0.5 * qD * qD / |G|) U set(dist 23->24, proba <= 4. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|) U set(dist 31->32, proba <= 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)))
RESULT However, I could not bound the probability of set(event Auth in game 7)
RESULT Proved secrecy of sk_p excluding set(dist 1->2, proba <= NS / |hash1|) U set(dist 2->3, proba <= 2. * NU * NP / |exponent| + qH1 * NP / |exponent| + 1. / |exponent| * NP + NP * NP / |exponent| + NS * NP / |exponent| + 0.5 * NU * NU / |exponent|) U set(event Auth in game 7) U set(dist 8->9, proba <= (NS * NS + 2. * NP * NS + 2. * qE * NS + 2. * NU * NS + 2. * qD * NS + NP * NP + 2. * qE * NP + 2. * NU * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 2. * qD * qE + NU * NU + 2. * qD * NU + qD * qD + -1. * NS + -1. * NP + -1. * qE + -1. * NU + -1. * qD) / |G|) U set(dist 9->10, proba <= NS * NP / |exponent| + qE * NP / |exponent| + NU * NP / |exponent| + qD * NP / |exponent| + NP * NS / |exponent| + qE * NS / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G| + 0.5 * NS * NS / |exponent|) U set(event Encryptt in game 13) U set(dist 14->15, proba <= 10. * NU * NP / |exponent| + 2. * NS * NP / |exponent| + qH0 * NP / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + 8.5 * NU * NU / |G| + 3. * NS * NU / |G| + 2. * NP * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NP * qD / |G| + qD * NP / |exponent| + 1. / |exponent| * NP + 15. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + NU * qH1 / |hash1| + NS * NP / |G| + qD * NU / |G| + 0.5 * qD * qD / |G|) U set(dist 23->24, proba <= 4. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|) U set(dist 31->32, proba <= 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)))
RESULT However, I could not bound the probability of set(event Auth in game 7)
RESULT Proved secrecy of sk_s excluding set(dist 1->2, proba <= NS / |hash1|) U set(dist 2->3, proba <= 2. * NU * NP / |exponent| + qH1 * NP / |exponent| + 1. / |exponent| * NP + NP * NP / |exponent| + NS * NP / |exponent| + 0.5 * NU * NU / |exponent|) U set(event Auth in game 7) U set(dist 8->9, proba <= (NS * NS + 2. * NP * NS + 2. * qE * NS + 2. * NU * NS + 2. * qD * NS + NP * NP + 2. * qE * NP + 2. * NU * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 2. * qD * qE + NU * NU + 2. * qD * NU + qD * qD + -1. * NS + -1. * NP + -1. * qE + -1. * NU + -1. * qD) / |G|) U set(dist 9->10, proba <= NS * NP / |exponent| + qE * NP / |exponent| + NU * NP / |exponent| + qD * NP / |exponent| + NP * NS / |exponent| + qE * NS / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G| + 0.5 * NS * NS / |exponent|) U set(event Encryptt in game 13) U set(dist 14->15, proba <= 10. * NU * NP / |exponent| + 2. * NS * NP / |exponent| + qH0 * NP / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + 8.5 * NU * NU / |G| + 3. * NS * NU / |G| + 2. * NP * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NP * qD / |G| + qD * NP / |exponent| + 1. / |exponent| * NP + 15. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + NU * qH1 / |hash1| + NS * NP / |G| + qD * NU / |G| + 0.5 * qD * qD / |G|) U set(dist 23->24, proba <= 4. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|) U set(dist 31->32, proba <= 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)))
RESULT However, I could not bound the probability of set(event Auth in game 7)
RESULT Proved secrecy of sk_u excluding set(dist 1->2, proba <= NS / |hash1|) U set(dist 2->3, proba <= 2. * NU * NP / |exponent| + qH1 * NP / |exponent| + 1. / |exponent| * NP + NP * NP / |exponent| + NS * NP / |exponent| + 0.5 * NU * NU / |exponent|) U set(event Auth in game 7) U set(dist 8->9, proba <= (NS * NS + 2. * NP * NS + 2. * qE * NS + 2. * NU * NS + 2. * qD * NS + NP * NP + 2. * qE * NP + 2. * NU * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 2. * qD * qE + NU * NU + 2. * qD * NU + qD * qD + -1. * NS + -1. * NP + -1. * qE + -1. * NU + -1. * qD) / |G|) U set(dist 9->10, proba <= NS * NP / |exponent| + qE * NP / |exponent| + NU * NP / |exponent| + qD * NP / |exponent| + NP * NS / |exponent| + qE * NS / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G| + 0.5 * NS * NS / |exponent|) U set(event Encryptt in game 13) U set(dist 14->15, proba <= 10. * NU * NP / |exponent| + 2. * NS * NP / |exponent| + qH0 * NP / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + 8.5 * NU * NU / |G| + 3. * NS * NU / |G| + 2. * NP * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NP * qD / |G| + qD * NP / |exponent| + 1. / |exponent| * NP + 15. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + NU * qH1 / |hash1| + NS * NP / |G| + qD * NU / |G| + 0.5 * qD * qD / |G|) U set(dist 23->24, proba <= 4. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|) U set(dist 31->32, proba <= 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)))
RESULT However, I could not bound the probability of set(event Auth in game 7)

Applying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
 yields

Game 36 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@1_X_3680[@i_240], @2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    event termU(U, X, S, Ystar_u, r1_94, r_368);
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    event termU(U, X, S, Ystar_u, r1_94, r_380);
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    event termU(U, X, S, Ystar_u, r1_94, r_392);
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    event termU(U, X, S, Ystar_u, r1_94, r_404);
    out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    if defined(r_404[j]) then
    let sk_s: hash0 = r_404[j] in
    event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_X_3680[@i_210], @1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = @1_X_3680[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_exp'(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@1_X_3680[@i_200], @2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_X_3680[@i_200])
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_X_3680: G;
    let @1_x_737: exponent = cst_exponent in
    out(@2_c4[!_61], @1_X_3680)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying simplify yields

Game 37 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    let sk_s: hash0 = r_404[j]
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_X_3680[@i_210], @2_kd[@i_210], @2_m[@i_210], @1_x_737[@i_210]) && ((@2_x = @1_X_3680[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_exp'(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_X_3680[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_X_3680[@i_200])
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_X_3680: G;
    let @1_x_737: exponent = cst_exponent in
    out(@2_c4[!_61], @1_X_3680)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of useless yields

Game 38 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_X_3680[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    let sk_s: hash0 = r_404[j]
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_X_3680[@i_210], @2_kd[@i_210], @2_m[@i_210], @1_X_3680[@i_210]) && ((@2_x = @1_X_3680[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_exp'(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_X_3680[@i_200], @1_X_3680[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_X_3680[@i_200])
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_X_3680: G;
    out(@2_c4[!_61], @1_X_3680)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
 yields

Game 39 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_X_3680[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    let sk_s: hash0 = r_404[j]
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new @1_X_3788: G;
  let Yp: G = @1_X_3788 in
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_X_3680[@i_210], @2_kd[@i_210], @2_m[@i_210], @1_X_3680[@i_210]) && ((@2_x = @1_X_3680[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_exp'(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_X_3680[@i_200], @1_X_3680[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_X_3680[@i_200])
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_X_3680: G;
    out(@2_c4[!_61], @1_X_3680)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of useless yields

Game 40 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_X_3680[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    let sk_s: hash0 = r_404[j]
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new @1_X_3788: G;
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_X_3680[@i_210], @2_kd[@i_210], @2_m[@i_210], @1_X_3680[@i_210]) && ((@2_x = @1_X_3680[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_exp'(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(@1_X_3788[@i_203], xp[@i_203], @2_r2_182[@i_203]) && ((@2_x = @1_X_3788[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_X_3680[@i_200], @1_X_3680[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_X_3680[@i_200])
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@1_X_3788[@i_193], xp[@i_193], @2_r2_182[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3788[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_X_3680: G;
    out(@2_c4[!_61], @1_X_3680)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
 yields

Game 41 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_X_3680[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    let sk_s: hash0 = r_404[j]
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new @1_X_3854: G;
  let xp: exponent = cst_exponent in
  let Xp: G = @1_X_3854 in
  new @1_X_3788: G;
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_X_3680[@i_210], @2_kd[@i_210], @2_m[@i_210], @1_X_3680[@i_210]) && ((@2_x = @1_X_3680[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_exp'(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(@1_X_3854[@i_203], @1_X_3788[@i_203], xp[@i_203], @2_r2_182[@i_203]) && ((@2_x = @1_X_3788[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_X_3680[@i_200], @1_X_3680[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_X_3680[@i_200])
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@1_X_3854[@i_193], @1_X_3788[@i_193], xp[@i_193], @2_r2_182[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3788[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_X_3680: G;
    out(@2_c4[!_61], @1_X_3680)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of useless yields

Game 42 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_X_3680[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    let sk_s: hash0 = r_404[j]
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new @1_X_3854: G;
  new @1_X_3788: G;
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, @1_X_3854, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_X_3680[@i_210], @2_kd[@i_210], @2_m[@i_210], @1_X_3680[@i_210]) && ((@2_x = @1_X_3680[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_exp'(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(@1_X_3854[@i_203], @1_X_3788[@i_203], @1_X_3854[@i_203], @2_r2_182[@i_203]) && ((@2_x = @1_X_3788[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_X_3680[@i_200], @1_X_3680[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_X_3680[@i_200])
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@1_X_3854[@i_193], @1_X_3788[@i_193], @1_X_3854[@i_193], @2_r2_182[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3788[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_X_3680: G;
    out(@2_c4[!_61], @1_X_3680)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
 yields

Game 43 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_X_3680[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new @1_X_3918: G;
  let Y: G = @1_X_3918 in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    let sk_s: hash0 = r_404[j]
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new @1_X_3854: G;
  new @1_X_3788: G;
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, @1_X_3854, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_X_3680[@i_210], @2_kd[@i_210], @2_m[@i_210], @1_X_3680[@i_210]) && ((@2_x = @1_X_3680[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_exp'(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(@1_X_3854[@i_203], @1_X_3788[@i_203], @1_X_3854[@i_203], @2_r2_182[@i_203]) && ((@2_x = @1_X_3788[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_X_3680[@i_200], @1_X_3680[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_X_3680[@i_200])
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@1_X_3854[@i_193], @1_X_3788[@i_193], @1_X_3854[@i_193], @2_r2_182[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3788[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_X_3680: G;
    out(@2_c4[!_61], @1_X_3680)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of useless yields

Game 44 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_X_3680[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new @1_X_3918: G;
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    let sk_s: hash0 = r_404[j]
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3918 = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new @1_X_3854: G;
  new @1_X_3788: G;
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, @1_X_3854, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_X_3680[@i_210], @2_kd[@i_210], @2_m[@i_210], @1_X_3680[@i_210]) && ((@2_x = @1_X_3680[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_exp'(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(@1_X_3854[@i_203], @1_X_3788[@i_203], @1_X_3854[@i_203], @2_r2_182[@i_203]) && ((@2_x = @1_X_3788[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(@1_X_3918[@i_202], @1_X_3918[@i_202], @2_r2_185[@i_202]) && ((@2_x = @1_X_3918[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_X_3680[@i_200], @1_X_3680[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_X_3680[@i_200])
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@1_X_3854[@i_193], @1_X_3788[@i_193], @1_X_3854[@i_193], @2_r2_182[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3788[@i_193])
  orfind @i_192 <= NS suchthat defined(@1_X_3918[@i_192], @1_X_3918[@i_192], @2_r2_185[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3918[@i_192])
  else
    new @1_X_3680: G;
    out(@2_c4[!_61], @1_X_3680)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
 yields

Game 45 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_X_3680[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(@1_X_3980[@i_236], Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  else
    new @1_X_3980: G;
    let @1_x_874: exponent = cst_exponent in
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new @1_X_3918: G;
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    let sk_s: hash0 = r_404[j]
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3918 = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new @1_X_3854: G;
  new @1_X_3788: G;
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, @1_X_3854, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_X_3680[@i_210], @2_kd[@i_210], @2_m[@i_210], @1_X_3680[@i_210]) && ((@2_x = @1_X_3680[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_X_3980[@i_206], @1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_X_3980[@i_206]) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(@1_X_3854[@i_203], @1_X_3788[@i_203], @1_X_3854[@i_203], @2_r2_182[@i_203]) && ((@2_x = @1_X_3788[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(@1_X_3918[@i_202], @1_X_3918[@i_202], @2_r2_185[@i_202]) && ((@2_x = @1_X_3918[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_X_3680[@i_200], @1_X_3680[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_X_3680[@i_200])
  orfind @i_196 <= NU suchthat defined(@1_X_3980[@i_196], Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3980[@i_196])
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@1_X_3854[@i_193], @1_X_3788[@i_193], @1_X_3854[@i_193], @2_r2_182[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3788[@i_193])
  orfind @i_192 <= NS suchthat defined(@1_X_3918[@i_192], @1_X_3918[@i_192], @2_r2_185[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3918[@i_192])
  else
    new @1_X_3680: G;
    out(@2_c4[!_61], @1_X_3680)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of useless yields

Game 46 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_X_3680[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(@1_X_3980[@i_236], Ystar_u[@i_236], @1_X_3980[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  else
    new @1_X_3980: G;
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new @1_X_3918: G;
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    let sk_s: hash0 = r_404[j]
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3918 = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new @1_X_3854: G;
  new @1_X_3788: G;
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, @1_X_3854, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_X_3680[@i_210], @2_kd[@i_210], @2_m[@i_210], @1_X_3680[@i_210]) && ((@2_x = @1_X_3680[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_X_3980[@i_206], @1_X_3980[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_X_3980[@i_206]) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(@1_X_3854[@i_203], @1_X_3788[@i_203], @1_X_3854[@i_203], @2_r2_182[@i_203]) && ((@2_x = @1_X_3788[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(@1_X_3918[@i_202], @1_X_3918[@i_202], @2_r2_185[@i_202]) && ((@2_x = @1_X_3918[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_X_3680[@i_200], @1_X_3680[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_X_3680[@i_200])
  orfind @i_196 <= NU suchthat defined(@1_X_3980[@i_196], Ystar_u[@i_196], @1_X_3980[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3980[@i_196])
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@1_X_3854[@i_193], @1_X_3788[@i_193], @1_X_3854[@i_193], @2_r2_182[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3788[@i_193])
  orfind @i_192 <= NS suchthat defined(@1_X_3918[@i_192], @1_X_3918[@i_192], @2_r2_185[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3918[@i_192])
  else
    new @1_X_3680: G;
    out(@2_c4[!_61], @1_X_3680)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
 yields

Game 47 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new @1_X_4047: G;
  let X: G = @1_X_4047 in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_X_3680[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(@1_X_3980[@i_236], Ystar_u[@i_236], @1_X_3980[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  else
    new @1_X_3980: G;
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new @1_X_3918: G;
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    let sk_s: hash0 = r_404[j]
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3918 = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new @1_X_3854: G;
  new @1_X_3788: G;
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, @1_X_3854, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_X_3680[@i_210], @2_kd[@i_210], @2_m[@i_210], @1_X_3680[@i_210]) && ((@2_x = @1_X_3680[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_X_3980[@i_206], @1_X_3980[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_X_3980[@i_206]) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(@1_X_3854[@i_203], @1_X_3788[@i_203], @1_X_3854[@i_203], @2_r2_182[@i_203]) && ((@2_x = @1_X_3788[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(@1_X_3918[@i_202], @1_X_3918[@i_202], @2_r2_185[@i_202]) && ((@2_x = @1_X_3918[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_X_3680[@i_200], @1_X_3680[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_X_3680[@i_200])
  orfind @i_196 <= NU suchthat defined(@1_X_3980[@i_196], Ystar_u[@i_196], @1_X_3980[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3980[@i_196])
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@1_X_3854[@i_193], @1_X_3788[@i_193], @1_X_3854[@i_193], @2_r2_182[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3788[@i_193])
  orfind @i_192 <= NS suchthat defined(@1_X_3918[@i_192], @1_X_3918[@i_192], @2_r2_185[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3918[@i_192])
  else
    new @1_X_3680: G;
    out(@2_c4[!_61], @1_X_3680)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of useless yields

Game 48 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new @1_X_4047: G;
  out(c2[!_57], (U, @1_X_4047));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_X_3680[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(@1_X_3980[@i_236], Ystar_u[@i_236], @1_X_3980[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  else
    new @1_X_3980: G;
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new @1_X_3918: G;
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(@1_X_4047[j], @1_X_4047[j]) && (@1_X_4047[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    let sk_s: hash0 = r_404[j]
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3918 = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new @1_X_3854: G;
  new @1_X_3788: G;
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, @1_X_3854, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_X_3680[@i_210], @2_kd[@i_210], @2_m[@i_210], @1_X_3680[@i_210]) && ((@2_x = @1_X_3680[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_X_3980[@i_206], @1_X_3980[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_X_3980[@i_206]) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(@1_X_3854[@i_203], @1_X_3788[@i_203], @1_X_3854[@i_203], @2_r2_182[@i_203]) && ((@2_x = @1_X_3788[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(@1_X_3918[@i_202], @1_X_3918[@i_202], @2_r2_185[@i_202]) && ((@2_x = @1_X_3918[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_X_3680[@i_200], @1_X_3680[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_X_3680[@i_200])
  orfind @i_196 <= NU suchthat defined(@1_X_3980[@i_196], Ystar_u[@i_196], @1_X_3980[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3980[@i_196])
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@1_X_3854[@i_193], @1_X_3788[@i_193], @1_X_3854[@i_193], @2_r2_182[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3788[@i_193])
  orfind @i_192 <= NS suchthat defined(@1_X_3918[@i_192], @1_X_3918[@i_192], @2_r2_185[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3918[@i_192])
  else
    new @1_X_3680: G;
    out(@2_c4[!_61], @1_X_3680)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)

RESULT time(context for game 31) = 0
RESULT Could not prove event Encryptt ==> false in game 13, event Auth ==> false in game 7.
Please enter a command: crypto 1 @1_X_3980
Trying equivalence
equiv ! !_49 <= N new X: G; (
  ! !_50 <= N2 OX() := X,
  ! !_51 <= N3 Oeq(X': G) := (X' = X))
<=(set(proba <= #Oeq / |G|))=> [manual]
      ! !_52 <= N (
  ! !_53 <= N2 OX() := find [unique] j_55 <= N2 suchthat defined(Y[j_55]) then Y[j_55] else new Y: G; Y,
  ! !_54 <= N3 Oeq(X': G) := find [unique] j_56 <= N2 suchthat defined(Y[j_56]) then (X' = Y[j_56]) else false)
with @1_X_3980... Succeeded.
Doing simplify... Run simplify 3 time(s). Maximum reached.
Done.
Doing SA rename @i_196... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 3 time(s). Fixpoint reached.
Done.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
No change.
Doing move all binders... No change.
Doing remove assignments of useless... Done.
Please enter a command: show_state
Initial state
Game 1 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let auth_u: hash1 = h1(U, S, X, Y_u, K_u) in
  let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
  event termU(U, X, S, Ystar_u, auth_u, sk_u);
  out(c6[!_57], auth_u)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_58], (S, Ystar));
  in(c7[!_58], auth_s: hash1);
  let K_s: G = exp(X_s, y) in
  if (auth_s = h1(U, S, X_s, Y, K_s)) then
  let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
  event termS(U, X_s, S, Ystar, auth_s, sk_s)
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let authp: hash1 = h1(U, S, Xp, Yp, Kp) in
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_59], (U, Xp, S, Ystarp, authp))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_60], enc(@2_x, @2_ke))
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_61], dec(@2_m, @2_kd))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_62], h0(x1, x2, x3, x4, x5))
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  out(c21[!_63], h1(x11, x12, x13, x14, x15))
)


Applying equivalence
equiv ! !_43 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all], ! !_44 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash1) -> (r' = h1(x1', x2', x3', x4', x5')) [all]
<=(set(proba <= Neq / |hash1|))=>
      ! !_45 <= N (x1_72: host, x2_71: host, x3_70: G, x4_69: G, x5_68: G) -> let x1: host = x1_72 in let x2: host = x2_71 in let x3: G = x3_70 in let x4: G = x4_69 in let x5: G = x5_68 in find [unique] j_47 <= N suchthat defined(x1[j_47], x2[j_47], x3[j_47], x4[j_47], x5[j_47], r1[j_47]) && ((x1 = x1[j_47]) && ((x2 = x2[j_47]) && ((x3 = x3[j_47]) && ((x4 = x4[j_47]) && (x5 = x5[j_47]))))) then r1[j_47] else new r1: hash1; r1, ! !_46 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash1) -> find [unique] j_48 <= N suchthat defined(x1[j_48], x2[j_48], x3[j_48], x4[j_48], x5[j_48], r1[j_48]) && ((x1' = x1[j_48]) && ((x2' = x2[j_48]) && ((x3' = x3[j_48]) && ((x4' = x4[j_48]) && (x5' = x5[j_48]))))) then (r' = r1[j_48]) else false
 [Excluding set(dist 1->2, proba <= NS / |hash1|)] yields

Game 2 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_99: host = U in
  let x2_98: host = S in
  let x3_97: G = X in
  let x4_96: G = Y_u in
  let x5_95: G = K_u in
  find [unique] @i_115 <= qH1 suchthat defined(x1_87[@i_115], x2_86[@i_115], x3_85[@i_115], x4_84[@i_115], x5_83[@i_115], r1_82[@i_115]) && ((x1_99 = x1_87[@i_115]) && ((x2_98 = x2_86[@i_115]) && ((x3_97 = x3_85[@i_115]) && ((x4_96 = x4_84[@i_115]) && (x5_95 = x5_83[@i_115]))))) then
  (
    let auth_u: hash1 = r1_82[@i_115] in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_57], auth_u)
  )
  orfind @i_114 <= NP suchthat defined(x1_93[@i_114], x2_92[@i_114], x3_91[@i_114], x4_90[@i_114], x5_89[@i_114], r1_88[@i_114]) && ((x1_99 = x1_93[@i_114]) && ((x2_98 = x2_92[@i_114]) && ((x3_97 = x3_91[@i_114]) && ((x4_96 = x4_90[@i_114]) && (x5_95 = x5_89[@i_114]))))) then
  (
    let auth_u: hash1 = r1_88[@i_114] in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_57], auth_u)
  )
  orfind @i_112 <= NU suchthat defined(x1_99[@i_112], x2_98[@i_112], x3_97[@i_112], x4_96[@i_112], x5_95[@i_112], r1_94[@i_112]) && ((x1_99 = x1_99[@i_112]) && ((x2_98 = x2_98[@i_112]) && ((x3_97 = x3_97[@i_112]) && ((x4_96 = x4_96[@i_112]) && (x5_95 = x5_95[@i_112]))))) then
  (
    let auth_u: hash1 = r1_94[@i_112] in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_57], auth_u)
  )
  else
    new r1_94: hash1;
    let auth_u: hash1 = r1_94 in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_57], auth_u)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_58], (S, Ystar));
  in(c7[!_58], auth_s: hash1);
  let K_s: G = exp(X_s, y) in
  find [unique] @i_111 <= qH1 suchthat defined(x1_87[@i_111], x2_86[@i_111], x3_85[@i_111], x4_84[@i_111], x5_83[@i_111], r1_82[@i_111]) && ((U = x1_87[@i_111]) && ((S = x2_86[@i_111]) && ((X_s = x3_85[@i_111]) && ((Y = x4_84[@i_111]) && (K_s = x5_83[@i_111]))))) then
  (
    if (auth_s = r1_82[@i_111]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  orfind @i_110 <= NP suchthat defined(x1_93[@i_110], x2_92[@i_110], x3_91[@i_110], x4_90[@i_110], x5_89[@i_110], r1_88[@i_110]) && ((U = x1_93[@i_110]) && ((S = x2_92[@i_110]) && ((X_s = x3_91[@i_110]) && ((Y = x4_90[@i_110]) && (K_s = x5_89[@i_110]))))) then
  (
    if (auth_s = r1_88[@i_110]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  orfind @i_108 <= NU suchthat defined(x1_99[@i_108], x2_98[@i_108], x3_97[@i_108], x4_96[@i_108], x5_95[@i_108], r1_94[@i_108]) && ((U = x1_99[@i_108]) && ((S = x2_98[@i_108]) && ((X_s = x3_97[@i_108]) && ((Y = x4_96[@i_108]) && (K_s = x5_95[@i_108]))))) then
  (
    if (auth_s = r1_94[@i_108]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  else
    if false then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let x1_93: host = U in
  let x2_92: host = S in
  let x3_91: G = Xp in
  let x4_90: G = Yp in
  let x5_89: G = Kp in
  find [unique] @i_107 <= qH1 suchthat defined(x1_87[@i_107], x2_86[@i_107], x3_85[@i_107], x4_84[@i_107], x5_83[@i_107], r1_82[@i_107]) && ((x1_93 = x1_87[@i_107]) && ((x2_92 = x2_86[@i_107]) && ((x3_91 = x3_85[@i_107]) && ((x4_90 = x4_84[@i_107]) && (x5_89 = x5_83[@i_107]))))) then
  (
    let authp: hash1 = r1_82[@i_107] in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_59], (U, Xp, S, Ystarp, authp))
  )
  orfind @i_106 <= NP suchthat defined(x1_93[@i_106], x2_92[@i_106], x3_91[@i_106], x4_90[@i_106], x5_89[@i_106], r1_88[@i_106]) && ((x1_93 = x1_93[@i_106]) && ((x2_92 = x2_92[@i_106]) && ((x3_91 = x3_91[@i_106]) && ((x4_90 = x4_90[@i_106]) && (x5_89 = x5_89[@i_106]))))) then
  (
    let authp: hash1 = r1_88[@i_106] in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_59], (U, Xp, S, Ystarp, authp))
  )
  orfind @i_104 <= NU suchthat defined(x1_99[@i_104], x2_98[@i_104], x3_97[@i_104], x4_96[@i_104], x5_95[@i_104], r1_94[@i_104]) && ((x1_93 = x1_99[@i_104]) && ((x2_92 = x2_98[@i_104]) && ((x3_91 = x3_97[@i_104]) && ((x4_90 = x4_96[@i_104]) && (x5_89 = x5_95[@i_104]))))) then
  (
    let authp: hash1 = r1_94[@i_104] in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_59], (U, Xp, S, Ystarp, authp))
  )
  else
    new r1_88: hash1;
    let authp: hash1 = r1_88 in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_59], (U, Xp, S, Ystarp, authp))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_60], enc(@2_x, @2_ke))
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_61], dec(@2_m, @2_kd))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_62], h0(x1, x2, x3, x4, x5))
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_87: host = x11 in
  let x2_86: host = x12 in
  let x3_85: G = x13 in
  let x4_84: G = x14 in
  let x5_83: G = x15 in
  find [unique] @i_103 <= qH1 suchthat defined(x1_87[@i_103], x2_86[@i_103], x3_85[@i_103], x4_84[@i_103], x5_83[@i_103], r1_82[@i_103]) && ((x1_87 = x1_87[@i_103]) && ((x2_86 = x2_86[@i_103]) && ((x3_85 = x3_85[@i_103]) && ((x4_84 = x4_84[@i_103]) && (x5_83 = x5_83[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], x3_91[@i_102], x4_90[@i_102], x5_89[@i_102], r1_88[@i_102]) && ((x1_87 = x1_93[@i_102]) && ((x2_86 = x2_92[@i_102]) && ((x3_85 = x3_91[@i_102]) && ((x4_84 = x4_90[@i_102]) && (x5_83 = x5_89[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], x3_97[@i_100], x4_96[@i_100], x5_95[@i_100], r1_94[@i_100]) && ((x1_87 = x1_99[@i_100]) && ((x2_86 = x2_98[@i_100]) && ((x3_85 = x3_97[@i_100]) && ((x4_84 = x4_96[@i_100]) && (x5_83 = x5_95[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying simplify [Excluding set(dist 2->3, proba <= 2. * NU * NP / |exponent| + qH1 * NP / |exponent| + 1. / |exponent| * NP + NP * NP / |exponent| + NS * NP / |exponent| + 0.5 * NU * NU / |exponent|)] yields

Game 3 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_99: host = U in
  let x2_98: host = S in
  let x3_97: G = X in
  let x4_96: G = Y_u in
  let x5_95: G = K_u in
  find [unique] @i_115 <= qH1 suchthat defined(x1_87[@i_115], x2_86[@i_115], x3_85[@i_115], x4_84[@i_115], x5_83[@i_115], r1_82[@i_115]) && ((x1_99 = x1_87[@i_115]) && ((x2_98 = x2_86[@i_115]) && ((x3_97 = x3_85[@i_115]) && ((x4_96 = x4_84[@i_115]) && (x5_95 = x5_83[@i_115]))))) then
  (
    let auth_u: hash1 = r1_82[@i_115] in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_57], auth_u)
  )
  else
    new r1_94: hash1;
    let auth_u: hash1 = r1_94 in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_57], auth_u)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_58], (S, Ystar));
  in(c7[!_58], auth_s: hash1);
  let K_s: G = exp(X_s, y) in
  find [unique] @i_111 <= qH1 suchthat defined(x1_87[@i_111], x2_86[@i_111], x3_85[@i_111], x4_84[@i_111], x5_83[@i_111], r1_82[@i_111]) && ((U = x1_87[@i_111]) && ((S = x2_86[@i_111]) && ((X_s = x3_85[@i_111]) && ((Y = x4_84[@i_111]) && (K_s = x5_83[@i_111]))))) then
  (
    if (auth_s = r1_82[@i_111]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  orfind @i_108 <= NU suchthat defined(x3_97[@i_108], x4_96[@i_108], x5_95[@i_108], r1_94[@i_108]) && ((X_s = x3_97[@i_108]) && ((Y = x4_96[@i_108]) && (K_s = x5_95[@i_108]))) then
  (
    if (auth_s = r1_94[@i_108]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let x1_93: host = U in
  let x2_92: host = S in
  let x3_91: G = Xp in
  let x4_90: G = Yp in
  let x5_89: G = Kp in
  new r1_88: hash1;
  let authp: hash1 = r1_88 in
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_59], (U, Xp, S, Ystarp, authp))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_60], enc(@2_x, @2_ke))
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_61], dec(@2_m, @2_kd))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_62], h0(x1, x2, x3, x4, x5))
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_87: host = x11 in
  let x2_86: host = x12 in
  let x3_85: G = x13 in
  let x4_84: G = x14 in
  let x5_83: G = x15 in
  find [unique] @i_103 <= qH1 suchthat defined(x1_87[@i_103], x2_86[@i_103], x3_85[@i_103], x4_84[@i_103], x5_83[@i_103], r1_82[@i_103]) && ((x1_87 = x1_87[@i_103]) && ((x2_86 = x2_86[@i_103]) && ((x3_85 = x3_85[@i_103]) && ((x4_84 = x4_84[@i_103]) && (x5_83 = x5_83[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], x3_91[@i_102], x4_90[@i_102], x5_89[@i_102], r1_88[@i_102]) && ((x1_87 = x1_93[@i_102]) && ((x2_86 = x2_92[@i_102]) && ((x3_85 = x3_91[@i_102]) && ((x4_84 = x4_90[@i_102]) && (x5_83 = x5_89[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], x3_97[@i_100], x4_96[@i_100], x5_95[@i_100], r1_94[@i_100]) && ((x1_87 = x1_99[@i_100]) && ((x2_86 = x2_98[@i_100]) && ((x3_85 = x3_97[@i_100]) && ((x4_84 = x4_96[@i_100]) && (x5_83 = x5_95[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of useless yields

Game 4 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_99: host = U in
  let x2_98: host = S in
  find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], x5_83[@i_115], x4_84[@i_115], x3_85[@i_115], x2_86[@i_115], x1_87[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
  (
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
    out(c6[!_57], r1_82[@i_115])
  )
  else
    new r1_94: hash1;
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_94, sk_u);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_58], (S, Ystar));
  in(c7[!_58], auth_s: hash1);
  let K_s: G = exp(X_s, y) in
  find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], x5_83[@i_111], x4_84[@i_111], x3_85[@i_111], x2_86[@i_111], x1_87[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
  (
    if (auth_s = r1_82[@i_111]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  orfind @i_108 <= NU suchthat defined(X[@i_108], Y_u[@i_108], K_u[@i_108], Y_u[@i_108], Y_u[@i_108], Y_u[@i_108], r1_94[@i_108]) && ((X_s = X[@i_108]) && ((Y = Y_u[@i_108]) && (K_s = K_u[@i_108]))) then
  (
    if (auth_s = r1_94[@i_108]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_59], (U, Xp, S, Ystarp, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_60], enc(@2_x, @2_ke))
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_61], dec(@2_m, @2_kd))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_62], h0(x1, x2, x3, x4, x5))
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_87: host = cst_host in
  let x2_86: host = cst_host in
  let x3_85: G = cst_G in
  let x4_84: G = cst_G in
  let x5_83: G = cst_G in
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], x5_83[@i_103], x4_84[@i_103], x3_85[@i_103], x2_86[@i_103], x1_87[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(Xp[@i_102], Yp[@i_102], Kp[@i_102], xp[@i_102], xp[@i_102], xp[@i_102], x1_93[@i_102], x2_92[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(X[@i_100], Y_u[@i_100], K_u[@i_100], Y_u[@i_100], Y_u[@i_100], Y_u[@i_100], x1_99[@i_100], x2_98[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying insert instruction find j <= NU suchthat defined(X[j]) && X[j] = X_s then at occurrence 472 yields

Game 5 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_99: host = U in
  let x2_98: host = S in
  find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], x5_83[@i_115], x4_84[@i_115], x3_85[@i_115], x2_86[@i_115], x1_87[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
  (
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
    out(c6[!_57], r1_82[@i_115])
  )
  else
    new r1_94: hash1;
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_94, sk_u);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_58], (S, Ystar));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(X_s, y) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], x5_83[@i_111], x4_84[@i_111], x3_85[@i_111], x2_86[@i_111], x1_87[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind @i_108 <= NU suchthat defined(X[@i_108], Y_u[@i_108], K_u[@i_108], Y_u[@i_108], Y_u[@i_108], Y_u[@i_108], r1_94[@i_108]) && ((X_s = X[@i_108]) && ((Y = Y_u[@i_108]) && (K_s = K_u[@i_108]))) then
    (
      if (auth_s = r1_94[@i_108]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  else
    let K_s: G = exp(X_s, y) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], x5_83[@i_111], x4_84[@i_111], x3_85[@i_111], x2_86[@i_111], x1_87[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind @i_108 <= NU suchthat defined(X[@i_108], Y_u[@i_108], K_u[@i_108], Y_u[@i_108], Y_u[@i_108], Y_u[@i_108], r1_94[@i_108]) && ((X_s = X[@i_108]) && ((Y = Y_u[@i_108]) && (K_s = K_u[@i_108]))) then
    (
      if (auth_s = r1_94[@i_108]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_59], (U, Xp, S, Ystarp, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_60], enc(@2_x, @2_ke))
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_61], dec(@2_m, @2_kd))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_62], h0(x1, x2, x3, x4, x5))
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_87: host = cst_host in
  let x2_86: host = cst_host in
  let x3_85: G = cst_G in
  let x4_84: G = cst_G in
  let x5_83: G = cst_G in
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], x5_83[@i_103], x4_84[@i_103], x3_85[@i_103], x2_86[@i_103], x1_87[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(Xp[@i_102], Yp[@i_102], Kp[@i_102], xp[@i_102], xp[@i_102], xp[@i_102], x1_93[@i_102], x2_92[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(X[@i_100], Y_u[@i_100], K_u[@i_100], Y_u[@i_100], Y_u[@i_100], Y_u[@i_100], x1_99[@i_100], x2_98[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying insert instruction find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && (U = x11[nj]) && (S = x12[nj]) && (X_s = x13[nj]) && (Y = x14[nj]) && (auth_s = r1_82[nj]) then at occurrence 472 yields

Game 6 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_99: host = U in
  let x2_98: host = S in
  find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], x5_83[@i_115], x4_84[@i_115], x3_85[@i_115], x2_86[@i_115], x1_87[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
  (
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
    out(c6[!_57], r1_82[@i_115])
  )
  else
    new r1_94: hash1;
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_94, sk_u);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_58], (S, Ystar));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(X_s, y) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], x5_83[@i_111], x4_84[@i_111], x3_85[@i_111], x2_86[@i_111], x1_87[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind @i_108 <= NU suchthat defined(X[@i_108], Y_u[@i_108], K_u[@i_108], Y_u[@i_108], Y_u[@i_108], Y_u[@i_108], r1_94[@i_108]) && ((X_s = X[@i_108]) && ((Y = Y_u[@i_108]) && (K_s = K_u[@i_108]))) then
    (
      if (auth_s = r1_94[@i_108]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    (
      let K_s: G = exp(X_s, y) in
      find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], x5_83[@i_111], x4_84[@i_111], x3_85[@i_111], x2_86[@i_111], x1_87[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
      (
        if (auth_s = r1_82[@i_111]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_108 <= NU suchthat defined(X[@i_108], Y_u[@i_108], K_u[@i_108], Y_u[@i_108], Y_u[@i_108], Y_u[@i_108], r1_94[@i_108]) && ((X_s = X[@i_108]) && ((Y = Y_u[@i_108]) && (K_s = K_u[@i_108]))) then
      (
        if (auth_s = r1_94[@i_108]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
    )
    else
      let K_s: G = exp(X_s, y) in
      find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], x5_83[@i_111], x4_84[@i_111], x3_85[@i_111], x2_86[@i_111], x1_87[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
      (
        if (auth_s = r1_82[@i_111]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_108 <= NU suchthat defined(X[@i_108], Y_u[@i_108], K_u[@i_108], Y_u[@i_108], Y_u[@i_108], Y_u[@i_108], r1_94[@i_108]) && ((X_s = X[@i_108]) && ((Y = Y_u[@i_108]) && (K_s = K_u[@i_108]))) then
      (
        if (auth_s = r1_94[@i_108]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_59], (U, Xp, S, Ystarp, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_60], enc(@2_x, @2_ke))
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_61], dec(@2_m, @2_kd))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_62], h0(x1, x2, x3, x4, x5))
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_87: host = cst_host in
  let x2_86: host = cst_host in
  let x3_85: G = cst_G in
  let x4_84: G = cst_G in
  let x5_83: G = cst_G in
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], x5_83[@i_103], x4_84[@i_103], x3_85[@i_103], x2_86[@i_103], x1_87[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(Xp[@i_102], Yp[@i_102], Kp[@i_102], xp[@i_102], xp[@i_102], xp[@i_102], x1_93[@i_102], x2_92[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(X[@i_100], Y_u[@i_100], K_u[@i_100], Y_u[@i_100], Y_u[@i_100], Y_u[@i_100], x1_99[@i_100], x2_98[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying insert event Auth at occurrence 637 [Excluding set(event Auth in game 7)] yields

Game 7 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_99: host = U in
  let x2_98: host = S in
  find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], x5_83[@i_115], x4_84[@i_115], x3_85[@i_115], x2_86[@i_115], x1_87[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
  (
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
    out(c6[!_57], r1_82[@i_115])
  )
  else
    new r1_94: hash1;
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_94, sk_u);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_58], (S, Ystar));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(X_s, y) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], x5_83[@i_111], x4_84[@i_111], x3_85[@i_111], x2_86[@i_111], x1_87[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind @i_108 <= NU suchthat defined(X[@i_108], Y_u[@i_108], K_u[@i_108], Y_u[@i_108], Y_u[@i_108], Y_u[@i_108], r1_94[@i_108]) && ((X_s = X[@i_108]) && ((Y = Y_u[@i_108]) && (K_s = K_u[@i_108]))) then
    (
      if (auth_s = r1_94[@i_108]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
      event Auth
    else
      let K_s: G = exp(X_s, y) in
      find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], x5_83[@i_111], x4_84[@i_111], x3_85[@i_111], x2_86[@i_111], x1_87[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
      (
        if (auth_s = r1_82[@i_111]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_108 <= NU suchthat defined(X[@i_108], Y_u[@i_108], K_u[@i_108], Y_u[@i_108], Y_u[@i_108], Y_u[@i_108], r1_94[@i_108]) && ((X_s = X[@i_108]) && ((Y = Y_u[@i_108]) && (K_s = K_u[@i_108]))) then
      (
        if (auth_s = r1_94[@i_108]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_59], (U, Xp, S, Ystarp, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_60], enc(@2_x, @2_ke))
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_61], dec(@2_m, @2_kd))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_62], h0(x1, x2, x3, x4, x5))
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_87: host = cst_host in
  let x2_86: host = cst_host in
  let x3_85: G = cst_G in
  let x4_84: G = cst_G in
  let x5_83: G = cst_G in
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], x5_83[@i_103], x4_84[@i_103], x3_85[@i_103], x2_86[@i_103], x1_87[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(Xp[@i_102], Yp[@i_102], Kp[@i_102], xp[@i_102], xp[@i_102], xp[@i_102], x1_93[@i_102], x2_92[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(X[@i_100], Y_u[@i_100], K_u[@i_100], Y_u[@i_100], Y_u[@i_100], Y_u[@i_100], x1_99[@i_100], x2_98[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying simplify yields

Game 8 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_99: host = U in
  let x2_98: host = S in
  find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
  (
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
    out(c6[!_57], r1_82[@i_115])
  )
  else
    new r1_94: hash1;
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_94, sk_u);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_58], (S, Ystar));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      let @i_108 <= NU = j in
      if (auth_s = r1_94[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_59], (U, Xp, S, Ystarp, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_60], enc(@2_x, @2_ke))
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_61], dec(@2_m, @2_kd))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_62], h0(x1, x2, x3, x4, x5))
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_87: host = cst_host in
  let x2_86: host = cst_host in
  let x3_85: G = cst_G in
  let x4_84: G = cst_G in
  let x5_83: G = cst_G in
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_79: G, @2_ke_78: passwd) := let @2_x: G = @2_x_79 in let @2_ke: passwd = @2_ke_78 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_81: G, @2_kd_80: passwd) := let @2_m: G = @2_m_81 in let @2_kd: passwd = @2_kd_80 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
 [Excluding set(dist 8->9, proba <= (NS * NS + 2. * NP * NS + 2. * qE * NS + 2. * NU * NS + 2. * qD * NS + NP * NP + 2. * qE * NP + 2. * NU * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 2. * qD * qE + NU * NU + 2. * qD * NU + qD * qD + -1. * NS + -1. * NP + -1. * qE + -1. * NU + -1. * qD) / |G|)] yields

Game 9 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  let @2_m_190: G = Ystar_u in
  let @2_kd_189: passwd = pw in
  find [unique] @i_240 <= qD suchthat defined(@2_r4_176[@i_240], @2_m_178[@i_240], @2_kd_177[@i_240]) && ((@2_m_190 = @2_m_178[@i_240]) && (@2_kd_189 = @2_kd_177[@i_240])) then
  (
    let Y_u: G = @2_r4_176[@i_240] in
    let K_u: G = exp(Y_u, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(@2_r4_188[@i_236], @2_m_190[@i_236], @2_kd_189[@i_236]) && ((@2_m_190 = @2_m_190[@i_236]) && (@2_kd_189 = @2_kd_189[@i_236])) then
  (
    let Y_u: G = @2_r4_188[@i_236] in
    let K_u: G = exp(Y_u, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_x_181[@i_234], @2_ke_180[@i_234], @2_r2_179[@i_234]) && ((@2_m_190 = @2_r2_179[@i_234]) && (@2_kd_189 = @2_ke_180[@i_234])) then
  (
    let Y_u: G = @2_x_181[@i_234] in
    let K_u: G = exp(Y_u, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_233 <= NP suchthat defined(@2_x_184[@i_233], @2_ke_183[@i_233], @2_r2_182[@i_233]) && ((@2_m_190 = @2_r2_182[@i_233]) && (@2_kd_189 = @2_ke_183[@i_233])) then
  (
    let Y_u: G = @2_x_184[@i_233] in
    let K_u: G = exp(Y_u, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_x_187[@i_232], @2_ke_186[@i_232], @2_r2_185[@i_232]) && ((@2_m_190 = @2_r2_185[@i_232]) && (@2_kd_189 = @2_ke_186[@i_232])) then
  (
    let Y_u: G = @2_x_187[@i_232] in
    let K_u: G = exp(Y_u, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  else
    new @2_r4_188: G;
    let Y_u: G = @2_r4_188 in
    let K_u: G = exp(Y_u, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let @2_x_187: G = Y in
  let @2_ke_186: passwd = pw in
  find [unique] @i_230 <= qD suchthat defined(@2_r4_176[@i_230], @2_m_178[@i_230], @2_kd_177[@i_230]) && ((@2_x_187 = @2_r4_176[@i_230]) && (@2_ke_186 = @2_kd_177[@i_230])) then
  (
    let Ystar: G = @2_m_178[@i_230] in
    out(c4[!_58], (S, Ystar));
    in(c7[!_58], auth_s: hash1);
    find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
    (
      let K_s: G = exp(g, mult(x[j], y)) in
      find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
      (
        if (auth_s = r1_82[@i_111]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
      (
        let @i_108 <= NU = j in
        if (auth_s = r1_94[j]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
    )
    else
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
      event Auth
  )
  orfind @i_226 <= NU suchthat defined(@2_r4_188[@i_226], @2_m_190[@i_226], @2_kd_189[@i_226]) && ((@2_x_187 = @2_r4_188[@i_226]) && (@2_ke_186 = @2_kd_189[@i_226])) then
  (
    let Ystar: G = @2_m_190[@i_226] in
    out(c4[!_58], (S, Ystar));
    in(c7[!_58], auth_s: hash1);
    find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
    (
      let K_s: G = exp(g, mult(x[j], y)) in
      find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
      (
        if (auth_s = r1_82[@i_111]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
      (
        let @i_108 <= NU = j in
        if (auth_s = r1_94[j]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
    )
    else
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
      event Auth
  )
  orfind @i_224 <= qE suchthat defined(@2_x_181[@i_224], @2_ke_180[@i_224], @2_r2_179[@i_224]) && ((@2_x_187 = @2_x_181[@i_224]) && (@2_ke_186 = @2_ke_180[@i_224])) then
  (
    let Ystar: G = @2_r2_179[@i_224] in
    out(c4[!_58], (S, Ystar));
    in(c7[!_58], auth_s: hash1);
    find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
    (
      let K_s: G = exp(g, mult(x[j], y)) in
      find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
      (
        if (auth_s = r1_82[@i_111]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
      (
        let @i_108 <= NU = j in
        if (auth_s = r1_94[j]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
    )
    else
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
      event Auth
  )
  orfind @i_223 <= NP suchthat defined(@2_x_184[@i_223], @2_ke_183[@i_223], @2_r2_182[@i_223]) && ((@2_x_187 = @2_x_184[@i_223]) && (@2_ke_186 = @2_ke_183[@i_223])) then
  (
    let Ystar: G = @2_r2_182[@i_223] in
    out(c4[!_58], (S, Ystar));
    in(c7[!_58], auth_s: hash1);
    find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
    (
      let K_s: G = exp(g, mult(x[j], y)) in
      find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
      (
        if (auth_s = r1_82[@i_111]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
      (
        let @i_108 <= NU = j in
        if (auth_s = r1_94[j]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
    )
    else
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
      event Auth
  )
  orfind @i_222 <= NS suchthat defined(@2_x_187[@i_222], @2_ke_186[@i_222], @2_r2_185[@i_222]) && ((@2_x_187 = @2_x_187[@i_222]) && (@2_ke_186 = @2_ke_186[@i_222])) then
  (
    let Ystar: G = @2_r2_185[@i_222] in
    out(c4[!_58], (S, Ystar));
    in(c7[!_58], auth_s: hash1);
    find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
    (
      let K_s: G = exp(g, mult(x[j], y)) in
      find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
      (
        if (auth_s = r1_82[@i_111]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
      (
        let @i_108 <= NU = j in
        if (auth_s = r1_94[j]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
    )
    else
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
      event Auth
  )
  else
    new @2_r2_185: G;
    let Ystar: G = @2_r2_185 in
    out(c4[!_58], (S, Ystar));
    in(c7[!_58], auth_s: hash1);
    find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
    (
      let K_s: G = exp(g, mult(x[j], y)) in
      find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
      (
        if (auth_s = r1_82[@i_111]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
      (
        let @i_108 <= NU = j in
        if (auth_s = r1_94[j]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
    )
    else
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
      event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let @2_x_184: G = Yp in
  let @2_ke_183: passwd = pw in
  find [unique] @i_220 <= qD suchthat defined(@2_r4_176[@i_220], @2_m_178[@i_220], @2_kd_177[@i_220]) && ((@2_x_184 = @2_r4_176[@i_220]) && (@2_ke_183 = @2_kd_177[@i_220])) then
  (
    let Ystarp: G = @2_m_178[@i_220] in
    let x1_93: host = U in
    let x2_92: host = S in
    new r1_88: hash1;
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_59], (U, Xp, S, Ystarp, r1_88))
  )
  orfind @i_216 <= NU suchthat defined(@2_r4_188[@i_216], @2_m_190[@i_216], @2_kd_189[@i_216]) && ((@2_x_184 = @2_r4_188[@i_216]) && (@2_ke_183 = @2_kd_189[@i_216])) then
  (
    let Ystarp: G = @2_m_190[@i_216] in
    let x1_93: host = U in
    let x2_92: host = S in
    new r1_88: hash1;
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_59], (U, Xp, S, Ystarp, r1_88))
  )
  orfind @i_214 <= qE suchthat defined(@2_x_181[@i_214], @2_ke_180[@i_214], @2_r2_179[@i_214]) && ((@2_x_184 = @2_x_181[@i_214]) && (@2_ke_183 = @2_ke_180[@i_214])) then
  (
    let Ystarp: G = @2_r2_179[@i_214] in
    let x1_93: host = U in
    let x2_92: host = S in
    new r1_88: hash1;
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_59], (U, Xp, S, Ystarp, r1_88))
  )
  orfind @i_213 <= NP suchthat defined(@2_x_184[@i_213], @2_ke_183[@i_213], @2_r2_182[@i_213]) && ((@2_x_184 = @2_x_184[@i_213]) && (@2_ke_183 = @2_ke_183[@i_213])) then
  (
    let Ystarp: G = @2_r2_182[@i_213] in
    let x1_93: host = U in
    let x2_92: host = S in
    new r1_88: hash1;
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_59], (U, Xp, S, Ystarp, r1_88))
  )
  orfind @i_212 <= NS suchthat defined(@2_x_187[@i_212], @2_ke_186[@i_212], @2_r2_185[@i_212]) && ((@2_x_184 = @2_x_187[@i_212]) && (@2_ke_183 = @2_ke_186[@i_212])) then
  (
    let Ystarp: G = @2_r2_185[@i_212] in
    let x1_93: host = U in
    let x2_92: host = S in
    new r1_88: hash1;
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_59], (U, Xp, S, Ystarp, r1_88))
  )
  else
    new @2_r2_182: G;
    let Ystarp: G = @2_r2_182 in
    let x1_93: host = U in
    let x2_92: host = S in
    new r1_88: hash1;
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_59], (U, Xp, S, Ystarp, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  let @2_x_181: G = @2_x in
  let @2_ke_180: passwd = @2_ke in
  find [unique] @i_210 <= qD suchthat defined(@2_r4_176[@i_210], @2_m_178[@i_210], @2_kd_177[@i_210]) && ((@2_x_181 = @2_r4_176[@i_210]) && (@2_ke_180 = @2_kd_177[@i_210])) then
    out(@2_c2[!_60], @2_m_178[@i_210])
  orfind @i_206 <= NU suchthat defined(@2_r4_188[@i_206], @2_m_190[@i_206], @2_kd_189[@i_206]) && ((@2_x_181 = @2_r4_188[@i_206]) && (@2_ke_180 = @2_kd_189[@i_206])) then
    out(@2_c2[!_60], @2_m_190[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x_181[@i_204], @2_ke_180[@i_204], @2_r2_179[@i_204]) && ((@2_x_181 = @2_x_181[@i_204]) && (@2_ke_180 = @2_ke_180[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(@2_x_184[@i_203], @2_ke_183[@i_203], @2_r2_182[@i_203]) && ((@2_x_181 = @2_x_184[@i_203]) && (@2_ke_180 = @2_ke_183[@i_203])) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(@2_x_187[@i_202], @2_ke_186[@i_202], @2_r2_185[@i_202]) && ((@2_x_181 = @2_x_187[@i_202]) && (@2_ke_180 = @2_ke_186[@i_202])) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  let @2_m_178: G = @2_m in
  let @2_kd_177: passwd = @2_kd in
  find [unique] @i_200 <= qD suchthat defined(@2_r4_176[@i_200], @2_m_178[@i_200], @2_kd_177[@i_200]) && ((@2_m_178 = @2_m_178[@i_200]) && (@2_kd_177 = @2_kd_177[@i_200])) then
    out(@2_c4[!_61], @2_r4_176[@i_200])
  orfind @i_196 <= NU suchthat defined(@2_r4_188[@i_196], @2_m_190[@i_196], @2_kd_189[@i_196]) && ((@2_m_178 = @2_m_190[@i_196]) && (@2_kd_177 = @2_kd_189[@i_196])) then
    out(@2_c4[!_61], @2_r4_188[@i_196])
  orfind @i_194 <= qE suchthat defined(@2_x_181[@i_194], @2_ke_180[@i_194], @2_r2_179[@i_194]) && ((@2_m_178 = @2_r2_179[@i_194]) && (@2_kd_177 = @2_ke_180[@i_194])) then
    out(@2_c4[!_61], @2_x_181[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_x_184[@i_193], @2_ke_183[@i_193], @2_r2_182[@i_193]) && ((@2_m_178 = @2_r2_182[@i_193]) && (@2_kd_177 = @2_ke_183[@i_193])) then
    out(@2_c4[!_61], @2_x_184[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_x_187[@i_192], @2_ke_186[@i_192], @2_r2_185[@i_192]) && ((@2_m_178 = @2_r2_185[@i_192]) && (@2_kd_177 = @2_ke_186[@i_192])) then
    out(@2_c4[!_61], @2_x_187[@i_192])
  else
    new @2_r4_176: G;
    out(@2_c4[!_61], @2_r4_176)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_62], h0(x1, x2, x3, x4, x5))
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_87: host = cst_host in
  let x2_86: host = cst_host in
  let x3_85: G = cst_G in
  let x4_84: G = cst_G in
  let x5_83: G = cst_G in
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying simplify [Excluding set(dist 9->10, proba <= NS * NP / |exponent| + qE * NP / |exponent| + NU * NP / |exponent| + qD * NP / |exponent| + NP * NS / |exponent| + qE * NS / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G| + 0.5 * NS * NS / |exponent|)] yields

Game 10 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  let @2_m_190: G = Ystar_u in
  let @2_kd_189: passwd = pw in
  find [unique] @i_240 <= qD suchthat defined(@2_m_178[@i_240], @2_kd_177[@i_240], @2_r4_176[@i_240]) && ((@2_m_190 = @2_m_178[@i_240]) && (@2_kd_189 = @2_kd_177[@i_240])) then
  (
    let Y_u: G = @2_r4_176[@i_240] in
    let K_u: G = exp(Y_u, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(@2_m_190[@i_236], @2_r4_188[@i_236]) && (@2_m_190 = @2_m_190[@i_236]) then
  (
    let Y_u: G = @2_r4_188[@i_236] in
    let K_u: G = exp(Y_u, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke_180[@i_234], @2_x_181[@i_234]) && ((@2_m_190 = @2_r2_179[@i_234]) && (@2_kd_189 = @2_ke_180[@i_234])) then
  (
    let Y_u: G = @2_x_181[@i_234] in
    let K_u: G = exp(Y_u, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], @2_x_184[@i_233], yp[@i_233]) && (@2_m_190 = @2_r2_182[@i_233]) then
  (
    let Y_u: G = @2_x_184[@i_233] in
    let K_u: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], @2_x_187[@i_232], y[@i_232]) && (@2_m_190 = @2_r2_185[@i_232]) then
  (
    let Y_u: G = @2_x_187[@i_232] in
    let K_u: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  else
    new @2_r4_188: G;
    let Y_u: G = @2_r4_188 in
    let K_u: G = exp(Y_u, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_94, sk_u);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let @2_x_187: G = Y in
  let @2_ke_186: passwd = pw in
  new @2_r2_185: G;
  let Ystar: G = @2_r2_185 in
  out(c4[!_58], (S, Ystar));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      let @i_108 <= NU = j in
      if (auth_s = r1_94[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let @2_x_184: G = Yp in
  let @2_ke_183: passwd = pw in
  new @2_r2_182: G;
  let Ystarp: G = @2_r2_182 in
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_59], (U, Xp, S, Ystarp, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  let @2_x_181: G = @2_x in
  let @2_ke_180: passwd = @2_ke in
  find [unique] @i_210 <= qD suchthat defined(@2_r4_176[@i_210], @2_kd_177[@i_210], @2_m_178[@i_210]) && ((@2_x_181 = @2_r4_176[@i_210]) && (@2_ke_180 = @2_kd_177[@i_210])) then
    out(@2_c2[!_60], @2_m_178[@i_210])
  orfind @i_206 <= NU suchthat defined(@2_r4_188[@i_206], @2_kd_189[@i_206], @2_m_190[@i_206]) && ((@2_x_181 = @2_r4_188[@i_206]) && (@2_ke_180 = @2_kd_189[@i_206])) then
    out(@2_c2[!_60], @2_m_190[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x_181[@i_204], @2_ke_180[@i_204], @2_r2_179[@i_204]) && ((@2_x_181 = @2_x_181[@i_204]) && (@2_ke_180 = @2_ke_180[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(@2_x_184[@i_203], @2_ke_183[@i_203], @2_r2_182[@i_203]) && ((@2_x_181 = @2_x_184[@i_203]) && (@2_ke_180 = @2_ke_183[@i_203])) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(@2_x_187[@i_202], @2_ke_186[@i_202], @2_r2_185[@i_202]) && ((@2_x_181 = @2_x_187[@i_202]) && (@2_ke_180 = @2_ke_186[@i_202])) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  let @2_m_178: G = @2_m in
  let @2_kd_177: passwd = @2_kd in
  find [unique] @i_200 <= qD suchthat defined(@2_m_178[@i_200], @2_kd_177[@i_200], @2_r4_176[@i_200]) && ((@2_m_178 = @2_m_178[@i_200]) && (@2_kd_177 = @2_kd_177[@i_200])) then
    out(@2_c4[!_61], @2_r4_176[@i_200])
  orfind @i_196 <= NU suchthat defined(@2_m_190[@i_196], @2_kd_189[@i_196], @2_r4_188[@i_196]) && ((@2_m_178 = @2_m_190[@i_196]) && (@2_kd_177 = @2_kd_189[@i_196])) then
    out(@2_c4[!_61], @2_r4_188[@i_196])
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke_180[@i_194], @2_x_181[@i_194]) && ((@2_m_178 = @2_r2_179[@i_194]) && (@2_kd_177 = @2_ke_180[@i_194])) then
    out(@2_c4[!_61], @2_x_181[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], @2_ke_183[@i_193], @2_x_184[@i_193]) && ((@2_m_178 = @2_r2_182[@i_193]) && (@2_kd_177 = @2_ke_183[@i_193])) then
    out(@2_c4[!_61], @2_x_184[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], @2_ke_186[@i_192], @2_x_187[@i_192]) && ((@2_m_178 = @2_r2_185[@i_192]) && (@2_kd_177 = @2_ke_186[@i_192])) then
    out(@2_c4[!_61], @2_x_187[@i_192])
  else
    new @2_r4_176: G;
    out(@2_c4[!_61], @2_r4_176)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_62], h0(x1, x2, x3, x4, x5))
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_87: host = cst_host in
  let x2_86: host = cst_host in
  let x3_85: G = cst_G in
  let x4_84: G = cst_G in
  let x5_83: G = cst_G in
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying move all binders yields

Game 11 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  let @2_m_190: G = Ystar_u in
  let @2_kd_189: passwd = pw in
  find [unique] @i_240 <= qD suchthat defined(@2_m_178[@i_240], @2_kd_177[@i_240], @2_r4_176[@i_240]) && ((@2_m_190 = @2_m_178[@i_240]) && (@2_kd_189 = @2_kd_177[@i_240])) then
  (
    let Y_u: G = @2_r4_176[@i_240] in
    let K_u: G = exp(Y_u, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(@2_m_190[@i_236], @2_r4_188[@i_236]) && (@2_m_190 = @2_m_190[@i_236]) then
  (
    let Y_u: G = @2_r4_188[@i_236] in
    let K_u: G = exp(Y_u, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke_180[@i_234], @2_x_181[@i_234]) && ((@2_m_190 = @2_r2_179[@i_234]) && (@2_kd_189 = @2_ke_180[@i_234])) then
  (
    let Y_u: G = @2_x_181[@i_234] in
    let K_u: G = exp(Y_u, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], @2_x_184[@i_233], yp[@i_233]) && (@2_m_190 = @2_r2_182[@i_233]) then
  (
    let Y_u: G = @2_x_184[@i_233] in
    let K_u: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], @2_x_187[@i_232], y[@i_232]) && (@2_m_190 = @2_r2_185[@i_232]) then
  (
    let Y_u: G = @2_x_187[@i_232] in
    let K_u: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y_u = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  else
    new @2_r4_188: G;
    let Y_u: G = @2_r4_188 in
    let K_u: G = exp(Y_u, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_94, sk_u);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let @2_x_187: G = Y in
  let @2_ke_186: passwd = pw in
  new @2_r2_185: G;
  let Ystar: G = @2_r2_185 in
  out(c4[!_58], (S, Ystar));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_94[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let @2_x_184: G = Yp in
  let @2_ke_183: passwd = pw in
  new @2_r2_182: G;
  let Ystarp: G = @2_r2_182 in
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_59], (U, Xp, S, Ystarp, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  let @2_x_181: G = @2_x in
  let @2_ke_180: passwd = @2_ke in
  find [unique] @i_210 <= qD suchthat defined(@2_r4_176[@i_210], @2_kd_177[@i_210], @2_m_178[@i_210]) && ((@2_x_181 = @2_r4_176[@i_210]) && (@2_ke_180 = @2_kd_177[@i_210])) then
    out(@2_c2[!_60], @2_m_178[@i_210])
  orfind @i_206 <= NU suchthat defined(@2_r4_188[@i_206], @2_kd_189[@i_206], @2_m_190[@i_206]) && ((@2_x_181 = @2_r4_188[@i_206]) && (@2_ke_180 = @2_kd_189[@i_206])) then
    out(@2_c2[!_60], @2_m_190[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x_181[@i_204], @2_ke_180[@i_204], @2_r2_179[@i_204]) && ((@2_x_181 = @2_x_181[@i_204]) && (@2_ke_180 = @2_ke_180[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(@2_x_184[@i_203], @2_ke_183[@i_203], @2_r2_182[@i_203]) && ((@2_x_181 = @2_x_184[@i_203]) && (@2_ke_180 = @2_ke_183[@i_203])) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(@2_x_187[@i_202], @2_ke_186[@i_202], @2_r2_185[@i_202]) && ((@2_x_181 = @2_x_187[@i_202]) && (@2_ke_180 = @2_ke_186[@i_202])) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  let @2_m_178: G = @2_m in
  let @2_kd_177: passwd = @2_kd in
  find [unique] @i_200 <= qD suchthat defined(@2_m_178[@i_200], @2_kd_177[@i_200], @2_r4_176[@i_200]) && ((@2_m_178 = @2_m_178[@i_200]) && (@2_kd_177 = @2_kd_177[@i_200])) then
    out(@2_c4[!_61], @2_r4_176[@i_200])
  orfind @i_196 <= NU suchthat defined(@2_m_190[@i_196], @2_kd_189[@i_196], @2_r4_188[@i_196]) && ((@2_m_178 = @2_m_190[@i_196]) && (@2_kd_177 = @2_kd_189[@i_196])) then
    out(@2_c4[!_61], @2_r4_188[@i_196])
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke_180[@i_194], @2_x_181[@i_194]) && ((@2_m_178 = @2_r2_179[@i_194]) && (@2_kd_177 = @2_ke_180[@i_194])) then
    out(@2_c4[!_61], @2_x_181[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], @2_ke_183[@i_193], @2_x_184[@i_193]) && ((@2_m_178 = @2_r2_182[@i_193]) && (@2_kd_177 = @2_ke_183[@i_193])) then
    out(@2_c4[!_61], @2_x_184[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], @2_ke_186[@i_192], @2_x_187[@i_192]) && ((@2_m_178 = @2_r2_185[@i_192]) && (@2_kd_177 = @2_ke_186[@i_192])) then
    out(@2_c4[!_61], @2_x_187[@i_192])
  else
    new @2_r4_176: G;
    out(@2_c4[!_61], @2_r4_176)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_62], h0(x1, x2, x3, x4, x5))
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of useless yields

Game 12 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  let @2_m_190: G = cst_G in
  let @2_kd_189: passwd = cst_passwd in
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @2_kd_177[@i_240], @2_m_178[@i_240], @2_r4_176[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = @2_r4_176[@i_240] in
    let K_u: G = exp(@2_r4_176[@i_240], x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@2_r4_176[@i_240] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, @2_r4_176[@i_240], K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, @2_r4_176[@i_240], K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @2_m_190[@i_236], @2_r4_188[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = @2_r4_188[@i_236] in
    let K_u: G = exp(@2_r4_188[@i_236], x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@2_r4_188[@i_236] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, @2_r4_188[@i_236], K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, @2_r4_188[@i_236], K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_ke[@i_234], @2_x[@i_234], @2_x_181[@i_234], @2_ke_180[@i_234], @2_r2_179[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
  (
    let Y_u: G = @2_x[@i_234] in
    let K_u: G = exp(@2_x[@i_234], x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@2_x[@i_234] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, @2_x[@i_234], K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, @2_x[@i_234], K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_233 <= NP suchthat defined(Yp[@i_233], xp[@i_233], @2_r2_182[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Yp[@i_233], K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Yp[@i_233], K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(Y[@i_232], y[@i_232], @2_r2_185[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y[@i_232], K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y[@i_232], K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  else
    new @2_r4_188: G;
    let Y_u: G = @2_r4_188 in
    let K_u: G = exp(@2_r4_188, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let sk_u: hash0 = h0(U, S, X, @2_r4_188, K_u) in
    event termU(U, X, S, Ystar_u, r1_94, sk_u);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_94[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  let @2_x_181: G = cst_G in
  let @2_ke_180: passwd = cst_passwd in
  find [unique] @i_210 <= qD suchthat defined(@2_kd[@i_210], @2_m[@i_210], @2_m_178[@i_210], @2_kd_177[@i_210], @2_r4_176[@i_210]) && ((@2_x = @2_r4_176[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(pw, Ystar_u[@i_206], @2_m_190[@i_206], @2_kd_189[@i_206], @2_r4_188[@i_206]) && ((@2_x = @2_r4_188[@i_206]) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_ke_180[@i_204], @2_x_181[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], pw, xp[@i_203], xp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], pw, y[@i_202], y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  let @2_m_178: G = cst_G in
  let @2_kd_177: passwd = cst_passwd in
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @2_kd_177[@i_200], @2_m_178[@i_200], @2_r4_176[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @2_r4_176[@i_200])
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], pw, @2_kd_189[@i_196], @2_m_190[@i_196], @2_r4_188[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @2_r4_188[@i_196])
  orfind @i_194 <= qE suchthat defined(@2_ke[@i_194], @2_x[@i_194], @2_x_181[@i_194], @2_ke_180[@i_194], @2_r2_179[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(pw, Yp[@i_193], xp[@i_193], xp[@i_193], @2_r2_182[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(pw, Y[@i_192], y[@i_192], y[@i_192], @2_r2_185[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @2_r4_176: G;
    out(@2_c4[!_61], @2_r4_176)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_62], h0(x1, x2, x3, x4, x5))
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying insert event Encryptt at occurrence 1243 [Excluding set(event Encryptt in game 13)] yields

Game 13 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  let @2_m_190: G = cst_G in
  let @2_kd_189: passwd = cst_passwd in
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @2_kd_177[@i_240], @2_m_178[@i_240], @2_r4_176[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = @2_r4_176[@i_240] in
    let K_u: G = exp(@2_r4_176[@i_240], x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@2_r4_176[@i_240] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, @2_r4_176[@i_240], K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, @2_r4_176[@i_240], K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @2_m_190[@i_236], @2_r4_188[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = @2_r4_188[@i_236] in
    let K_u: G = exp(@2_r4_188[@i_236], x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@2_r4_188[@i_236] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, @2_r4_188[@i_236], K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, @2_r4_188[@i_236], K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_ke[@i_234], @2_x[@i_234], @2_x_181[@i_234], @2_ke_180[@i_234], @2_r2_179[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(Yp[@i_233], xp[@i_233], @2_r2_182[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Yp[@i_233], K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Yp[@i_233], K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(Y[@i_232], y[@i_232], @2_r2_185[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y[@i_232], K_u) in
      event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
      out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let sk_u: hash0 = h0(U, S, X, Y[@i_232], K_u) in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
  )
  else
    new @2_r4_188: G;
    let Y_u: G = @2_r4_188 in
    let K_u: G = exp(@2_r4_188, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let sk_u: hash0 = h0(U, S, X, @2_r4_188, K_u) in
    event termU(U, X, S, Ystar_u, r1_94, sk_u);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_94[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  let @2_x_181: G = cst_G in
  let @2_ke_180: passwd = cst_passwd in
  find [unique] @i_210 <= qD suchthat defined(@2_kd[@i_210], @2_m[@i_210], @2_m_178[@i_210], @2_kd_177[@i_210], @2_r4_176[@i_210]) && ((@2_x = @2_r4_176[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(pw, Ystar_u[@i_206], @2_m_190[@i_206], @2_kd_189[@i_206], @2_r4_188[@i_206]) && ((@2_x = @2_r4_188[@i_206]) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_ke_180[@i_204], @2_x_181[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], pw, xp[@i_203], xp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], pw, y[@i_202], y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  let @2_m_178: G = cst_G in
  let @2_kd_177: passwd = cst_passwd in
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @2_kd_177[@i_200], @2_m_178[@i_200], @2_r4_176[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @2_r4_176[@i_200])
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], pw, @2_kd_189[@i_196], @2_m_190[@i_196], @2_r4_188[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @2_r4_188[@i_196])
  orfind @i_194 <= qE suchthat defined(@2_ke[@i_194], @2_x[@i_194], @2_x_181[@i_194], @2_ke_180[@i_194], @2_r2_179[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(pw, Yp[@i_193], xp[@i_193], xp[@i_193], @2_r2_182[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(pw, Y[@i_192], y[@i_192], y[@i_192], @2_r2_185[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @2_r4_176: G;
    out(@2_c4[!_61], @2_r4_176)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_62], h0(x1, x2, x3, x4, x5))
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all], ! !_38 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash0) -> (r' = h0(x1', x2', x3', x4', x5')) [all]
<=(set(proba <= Neq / |hash0|))=>
      ! !_39 <= N (x1_77: host, x2_76: host, x3_75: G, x4_74: G, x5_73: G) -> let x1: host = x1_77 in let x2: host = x2_76 in let x3: G = x3_75 in let x4: G = x4_74 in let x5: G = x5_73 in find [unique] j_41 <= N suchthat defined(x1[j_41], x2[j_41], x3[j_41], x4[j_41], x5[j_41], r[j_41]) && ((x1 = x1[j_41]) && ((x2 = x2[j_41]) && ((x3 = x3[j_41]) && ((x4 = x4[j_41]) && (x5 = x5[j_41]))))) then r[j_41] else new r: hash0; r, ! !_40 <= Neq (x1': host, x2': host, x3': G, x4': G, x5': G, r': hash0) -> find [unique] j_42 <= N suchthat defined(x1[j_42], x2[j_42], x3[j_42], x4[j_42], x5[j_42], r[j_42]) && ((x1' = x1[j_42]) && ((x2' = x2[j_42]) && ((x3' = x3[j_42]) && ((x4' = x4[j_42]) && (x5' = x5[j_42]))))) then (r' = r[j_42]) else false
 yields

Game 14 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  let @2_m_190: G = cst_G in
  let @2_kd_189: passwd = cst_passwd in
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @2_kd_177[@i_240], @2_m_178[@i_240], @2_r4_176[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = @2_r4_176[@i_240] in
    let K_u: G = exp(@2_r4_176[@i_240], x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@2_r4_176[@i_240] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      let x3_377: G = X in
      let x4_376: G = @2_r4_176[@i_240] in
      let x5_375: G = K_u in
      find [unique] @i_506 <= qH0 suchthat defined(x1_343[@i_506], x2_342[@i_506], x3_341[@i_506], x4_340[@i_506], x5_339[@i_506], r_338[@i_506]) && ((x1_379 = x1_343[@i_506]) && ((x2_378 = x2_342[@i_506]) && ((x3_377 = x3_341[@i_506]) && ((x4_376 = x4_340[@i_506]) && (x5_375 = x5_339[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_505 <= NP suchthat defined(x1_349[@i_505], x2_348[@i_505], x3_347[@i_505], x4_346[@i_505], x5_345[@i_505], r_344[@i_505]) && ((x1_379 = x1_349[@i_505]) && ((x2_378 = x2_348[@i_505]) && ((x3_377 = x3_347[@i_505]) && ((x4_376 = x4_346[@i_505]) && (x5_375 = x5_345[@i_505]))))) then
      (
        let sk_u: hash0 = r_344[@i_505] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_504 <= NS suchthat defined(x1_355[@i_504], x2_354[@i_504], x3_353[@i_504], x4_352[@i_504], x5_351[@i_504], r_350[@i_504]) && ((x1_379 = x1_355[@i_504]) && ((x2_378 = x2_354[@i_504]) && ((x3_377 = x3_353[@i_504]) && ((x4_376 = x4_352[@i_504]) && (x5_375 = x5_351[@i_504]))))) then
      (
        let sk_u: hash0 = r_350[@i_504] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_503 <= NS suchthat defined(x1_361[@i_503], x2_360[@i_503], x3_359[@i_503], x4_358[@i_503], x5_357[@i_503], r_356[@i_503]) && ((x1_379 = x1_361[@i_503]) && ((x2_378 = x2_360[@i_503]) && ((x3_377 = x3_359[@i_503]) && ((x4_376 = x4_358[@i_503]) && (x5_375 = x5_357[@i_503]))))) then
      (
        let sk_u: hash0 = r_356[@i_503] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_502 <= NU suchthat defined(x1_367[@i_502], x2_366[@i_502], x3_365[@i_502], x4_364[@i_502], x5_363[@i_502], r_362[@i_502]) && ((x1_379 = x1_367[@i_502]) && ((x2_378 = x2_366[@i_502]) && ((x3_377 = x3_365[@i_502]) && ((x4_376 = x4_364[@i_502]) && (x5_375 = x5_363[@i_502]))))) then
      (
        let sk_u: hash0 = r_362[@i_502] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_501 <= NU suchthat defined(x1_373[@i_501], x2_372[@i_501], x3_371[@i_501], x4_370[@i_501], x5_369[@i_501], r_368[@i_501]) && ((x1_379 = x1_373[@i_501]) && ((x2_378 = x2_372[@i_501]) && ((x3_377 = x3_371[@i_501]) && ((x4_376 = x4_370[@i_501]) && (x5_375 = x5_369[@i_501]))))) then
      (
        let sk_u: hash0 = r_368[@i_501] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_500 <= NU suchthat defined(x1_379[@i_500], x2_378[@i_500], x3_377[@i_500], x4_376[@i_500], x5_375[@i_500], r_374[@i_500]) && ((x1_379 = x1_379[@i_500]) && ((x2_378 = x2_378[@i_500]) && ((x3_377 = x3_377[@i_500]) && ((x4_376 = x4_376[@i_500]) && (x5_375 = x5_375[@i_500]))))) then
      (
        let sk_u: hash0 = r_374[@i_500] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_499 <= NU suchthat defined(x1_385[@i_499], x2_384[@i_499], x3_383[@i_499], x4_382[@i_499], x5_381[@i_499], r_380[@i_499]) && ((x1_379 = x1_385[@i_499]) && ((x2_378 = x2_384[@i_499]) && ((x3_377 = x3_383[@i_499]) && ((x4_376 = x4_382[@i_499]) && (x5_375 = x5_381[@i_499]))))) then
      (
        let sk_u: hash0 = r_380[@i_499] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_498 <= NU suchthat defined(x1_391[@i_498], x2_390[@i_498], x3_389[@i_498], x4_388[@i_498], x5_387[@i_498], r_386[@i_498]) && ((x1_379 = x1_391[@i_498]) && ((x2_378 = x2_390[@i_498]) && ((x3_377 = x3_389[@i_498]) && ((x4_376 = x4_388[@i_498]) && (x5_375 = x5_387[@i_498]))))) then
      (
        let sk_u: hash0 = r_386[@i_498] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_497 <= NU suchthat defined(x1_397[@i_497], x2_396[@i_497], x3_395[@i_497], x4_394[@i_497], x5_393[@i_497], r_392[@i_497]) && ((x1_379 = x1_397[@i_497]) && ((x2_378 = x2_396[@i_497]) && ((x3_377 = x3_395[@i_497]) && ((x4_376 = x4_394[@i_497]) && (x5_375 = x5_393[@i_497]))))) then
      (
        let sk_u: hash0 = r_392[@i_497] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_496 <= NU suchthat defined(x1_403[@i_496], x2_402[@i_496], x3_401[@i_496], x4_400[@i_496], x5_399[@i_496], r_398[@i_496]) && ((x1_379 = x1_403[@i_496]) && ((x2_378 = x2_402[@i_496]) && ((x3_377 = x3_401[@i_496]) && ((x4_376 = x4_400[@i_496]) && (x5_375 = x5_399[@i_496]))))) then
      (
        let sk_u: hash0 = r_398[@i_496] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_495 <= NU suchthat defined(x1_409[@i_495], x2_408[@i_495], x3_407[@i_495], x4_406[@i_495], x5_405[@i_495], r_404[@i_495]) && ((x1_379 = x1_409[@i_495]) && ((x2_378 = x2_408[@i_495]) && ((x3_377 = x3_407[@i_495]) && ((x4_376 = x4_406[@i_495]) && (x5_375 = x5_405[@i_495]))))) then
      (
        let sk_u: hash0 = r_404[@i_495] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_494 <= NU suchthat defined(x1_415[@i_494], x2_414[@i_494], x3_413[@i_494], x4_412[@i_494], x5_411[@i_494], r_410[@i_494]) && ((x1_379 = x1_415[@i_494]) && ((x2_378 = x2_414[@i_494]) && ((x3_377 = x3_413[@i_494]) && ((x4_376 = x4_412[@i_494]) && (x5_375 = x5_411[@i_494]))))) then
      (
        let sk_u: hash0 = r_410[@i_494] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let x1_373: host = U in
      let x2_372: host = S in
      let x3_371: G = X in
      let x4_370: G = @2_r4_176[@i_240] in
      let x5_369: G = K_u in
      find [unique] @i_493 <= qH0 suchthat defined(x1_343[@i_493], x2_342[@i_493], x3_341[@i_493], x4_340[@i_493], x5_339[@i_493], r_338[@i_493]) && ((x1_373 = x1_343[@i_493]) && ((x2_372 = x2_342[@i_493]) && ((x3_371 = x3_341[@i_493]) && ((x4_370 = x4_340[@i_493]) && (x5_369 = x5_339[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_492 <= NP suchthat defined(x1_349[@i_492], x2_348[@i_492], x3_347[@i_492], x4_346[@i_492], x5_345[@i_492], r_344[@i_492]) && ((x1_373 = x1_349[@i_492]) && ((x2_372 = x2_348[@i_492]) && ((x3_371 = x3_347[@i_492]) && ((x4_370 = x4_346[@i_492]) && (x5_369 = x5_345[@i_492]))))) then
      (
        let sk_u: hash0 = r_344[@i_492] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_491 <= NS suchthat defined(x1_355[@i_491], x2_354[@i_491], x3_353[@i_491], x4_352[@i_491], x5_351[@i_491], r_350[@i_491]) && ((x1_373 = x1_355[@i_491]) && ((x2_372 = x2_354[@i_491]) && ((x3_371 = x3_353[@i_491]) && ((x4_370 = x4_352[@i_491]) && (x5_369 = x5_351[@i_491]))))) then
      (
        let sk_u: hash0 = r_350[@i_491] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_490 <= NS suchthat defined(x1_361[@i_490], x2_360[@i_490], x3_359[@i_490], x4_358[@i_490], x5_357[@i_490], r_356[@i_490]) && ((x1_373 = x1_361[@i_490]) && ((x2_372 = x2_360[@i_490]) && ((x3_371 = x3_359[@i_490]) && ((x4_370 = x4_358[@i_490]) && (x5_369 = x5_357[@i_490]))))) then
      (
        let sk_u: hash0 = r_356[@i_490] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_489 <= NU suchthat defined(x1_367[@i_489], x2_366[@i_489], x3_365[@i_489], x4_364[@i_489], x5_363[@i_489], r_362[@i_489]) && ((x1_373 = x1_367[@i_489]) && ((x2_372 = x2_366[@i_489]) && ((x3_371 = x3_365[@i_489]) && ((x4_370 = x4_364[@i_489]) && (x5_369 = x5_363[@i_489]))))) then
      (
        let sk_u: hash0 = r_362[@i_489] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_488 <= NU suchthat defined(x1_373[@i_488], x2_372[@i_488], x3_371[@i_488], x4_370[@i_488], x5_369[@i_488], r_368[@i_488]) && ((x1_373 = x1_373[@i_488]) && ((x2_372 = x2_372[@i_488]) && ((x3_371 = x3_371[@i_488]) && ((x4_370 = x4_370[@i_488]) && (x5_369 = x5_369[@i_488]))))) then
      (
        let sk_u: hash0 = r_368[@i_488] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_487 <= NU suchthat defined(x1_379[@i_487], x2_378[@i_487], x3_377[@i_487], x4_376[@i_487], x5_375[@i_487], r_374[@i_487]) && ((x1_373 = x1_379[@i_487]) && ((x2_372 = x2_378[@i_487]) && ((x3_371 = x3_377[@i_487]) && ((x4_370 = x4_376[@i_487]) && (x5_369 = x5_375[@i_487]))))) then
      (
        let sk_u: hash0 = r_374[@i_487] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_486 <= NU suchthat defined(x1_385[@i_486], x2_384[@i_486], x3_383[@i_486], x4_382[@i_486], x5_381[@i_486], r_380[@i_486]) && ((x1_373 = x1_385[@i_486]) && ((x2_372 = x2_384[@i_486]) && ((x3_371 = x3_383[@i_486]) && ((x4_370 = x4_382[@i_486]) && (x5_369 = x5_381[@i_486]))))) then
      (
        let sk_u: hash0 = r_380[@i_486] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_485 <= NU suchthat defined(x1_391[@i_485], x2_390[@i_485], x3_389[@i_485], x4_388[@i_485], x5_387[@i_485], r_386[@i_485]) && ((x1_373 = x1_391[@i_485]) && ((x2_372 = x2_390[@i_485]) && ((x3_371 = x3_389[@i_485]) && ((x4_370 = x4_388[@i_485]) && (x5_369 = x5_387[@i_485]))))) then
      (
        let sk_u: hash0 = r_386[@i_485] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_484 <= NU suchthat defined(x1_397[@i_484], x2_396[@i_484], x3_395[@i_484], x4_394[@i_484], x5_393[@i_484], r_392[@i_484]) && ((x1_373 = x1_397[@i_484]) && ((x2_372 = x2_396[@i_484]) && ((x3_371 = x3_395[@i_484]) && ((x4_370 = x4_394[@i_484]) && (x5_369 = x5_393[@i_484]))))) then
      (
        let sk_u: hash0 = r_392[@i_484] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_483 <= NU suchthat defined(x1_403[@i_483], x2_402[@i_483], x3_401[@i_483], x4_400[@i_483], x5_399[@i_483], r_398[@i_483]) && ((x1_373 = x1_403[@i_483]) && ((x2_372 = x2_402[@i_483]) && ((x3_371 = x3_401[@i_483]) && ((x4_370 = x4_400[@i_483]) && (x5_369 = x5_399[@i_483]))))) then
      (
        let sk_u: hash0 = r_398[@i_483] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_482 <= NU suchthat defined(x1_409[@i_482], x2_408[@i_482], x3_407[@i_482], x4_406[@i_482], x5_405[@i_482], r_404[@i_482]) && ((x1_373 = x1_409[@i_482]) && ((x2_372 = x2_408[@i_482]) && ((x3_371 = x3_407[@i_482]) && ((x4_370 = x4_406[@i_482]) && (x5_369 = x5_405[@i_482]))))) then
      (
        let sk_u: hash0 = r_404[@i_482] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_481 <= NU suchthat defined(x1_415[@i_481], x2_414[@i_481], x3_413[@i_481], x4_412[@i_481], x5_411[@i_481], r_410[@i_481]) && ((x1_373 = x1_415[@i_481]) && ((x2_372 = x2_414[@i_481]) && ((x3_371 = x3_413[@i_481]) && ((x4_370 = x4_412[@i_481]) && (x5_369 = x5_411[@i_481]))))) then
      (
        let sk_u: hash0 = r_410[@i_481] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @2_m_190[@i_236], @2_r4_188[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = @2_r4_188[@i_236] in
    let K_u: G = exp(@2_r4_188[@i_236], x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@2_r4_188[@i_236] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      let x3_389: G = X in
      let x4_388: G = @2_r4_188[@i_236] in
      let x5_387: G = K_u in
      find [unique] @i_532 <= qH0 suchthat defined(x1_343[@i_532], x2_342[@i_532], x3_341[@i_532], x4_340[@i_532], x5_339[@i_532], r_338[@i_532]) && ((x1_391 = x1_343[@i_532]) && ((x2_390 = x2_342[@i_532]) && ((x3_389 = x3_341[@i_532]) && ((x4_388 = x4_340[@i_532]) && (x5_387 = x5_339[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_531 <= NP suchthat defined(x1_349[@i_531], x2_348[@i_531], x3_347[@i_531], x4_346[@i_531], x5_345[@i_531], r_344[@i_531]) && ((x1_391 = x1_349[@i_531]) && ((x2_390 = x2_348[@i_531]) && ((x3_389 = x3_347[@i_531]) && ((x4_388 = x4_346[@i_531]) && (x5_387 = x5_345[@i_531]))))) then
      (
        let sk_u: hash0 = r_344[@i_531] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_530 <= NS suchthat defined(x1_355[@i_530], x2_354[@i_530], x3_353[@i_530], x4_352[@i_530], x5_351[@i_530], r_350[@i_530]) && ((x1_391 = x1_355[@i_530]) && ((x2_390 = x2_354[@i_530]) && ((x3_389 = x3_353[@i_530]) && ((x4_388 = x4_352[@i_530]) && (x5_387 = x5_351[@i_530]))))) then
      (
        let sk_u: hash0 = r_350[@i_530] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_529 <= NS suchthat defined(x1_361[@i_529], x2_360[@i_529], x3_359[@i_529], x4_358[@i_529], x5_357[@i_529], r_356[@i_529]) && ((x1_391 = x1_361[@i_529]) && ((x2_390 = x2_360[@i_529]) && ((x3_389 = x3_359[@i_529]) && ((x4_388 = x4_358[@i_529]) && (x5_387 = x5_357[@i_529]))))) then
      (
        let sk_u: hash0 = r_356[@i_529] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_528 <= NU suchthat defined(x1_367[@i_528], x2_366[@i_528], x3_365[@i_528], x4_364[@i_528], x5_363[@i_528], r_362[@i_528]) && ((x1_391 = x1_367[@i_528]) && ((x2_390 = x2_366[@i_528]) && ((x3_389 = x3_365[@i_528]) && ((x4_388 = x4_364[@i_528]) && (x5_387 = x5_363[@i_528]))))) then
      (
        let sk_u: hash0 = r_362[@i_528] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_527 <= NU suchthat defined(x1_373[@i_527], x2_372[@i_527], x3_371[@i_527], x4_370[@i_527], x5_369[@i_527], r_368[@i_527]) && ((x1_391 = x1_373[@i_527]) && ((x2_390 = x2_372[@i_527]) && ((x3_389 = x3_371[@i_527]) && ((x4_388 = x4_370[@i_527]) && (x5_387 = x5_369[@i_527]))))) then
      (
        let sk_u: hash0 = r_368[@i_527] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_526 <= NU suchthat defined(x1_379[@i_526], x2_378[@i_526], x3_377[@i_526], x4_376[@i_526], x5_375[@i_526], r_374[@i_526]) && ((x1_391 = x1_379[@i_526]) && ((x2_390 = x2_378[@i_526]) && ((x3_389 = x3_377[@i_526]) && ((x4_388 = x4_376[@i_526]) && (x5_387 = x5_375[@i_526]))))) then
      (
        let sk_u: hash0 = r_374[@i_526] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_525 <= NU suchthat defined(x1_385[@i_525], x2_384[@i_525], x3_383[@i_525], x4_382[@i_525], x5_381[@i_525], r_380[@i_525]) && ((x1_391 = x1_385[@i_525]) && ((x2_390 = x2_384[@i_525]) && ((x3_389 = x3_383[@i_525]) && ((x4_388 = x4_382[@i_525]) && (x5_387 = x5_381[@i_525]))))) then
      (
        let sk_u: hash0 = r_380[@i_525] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_524 <= NU suchthat defined(x1_391[@i_524], x2_390[@i_524], x3_389[@i_524], x4_388[@i_524], x5_387[@i_524], r_386[@i_524]) && ((x1_391 = x1_391[@i_524]) && ((x2_390 = x2_390[@i_524]) && ((x3_389 = x3_389[@i_524]) && ((x4_388 = x4_388[@i_524]) && (x5_387 = x5_387[@i_524]))))) then
      (
        let sk_u: hash0 = r_386[@i_524] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_523 <= NU suchthat defined(x1_397[@i_523], x2_396[@i_523], x3_395[@i_523], x4_394[@i_523], x5_393[@i_523], r_392[@i_523]) && ((x1_391 = x1_397[@i_523]) && ((x2_390 = x2_396[@i_523]) && ((x3_389 = x3_395[@i_523]) && ((x4_388 = x4_394[@i_523]) && (x5_387 = x5_393[@i_523]))))) then
      (
        let sk_u: hash0 = r_392[@i_523] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_522 <= NU suchthat defined(x1_403[@i_522], x2_402[@i_522], x3_401[@i_522], x4_400[@i_522], x5_399[@i_522], r_398[@i_522]) && ((x1_391 = x1_403[@i_522]) && ((x2_390 = x2_402[@i_522]) && ((x3_389 = x3_401[@i_522]) && ((x4_388 = x4_400[@i_522]) && (x5_387 = x5_399[@i_522]))))) then
      (
        let sk_u: hash0 = r_398[@i_522] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_521 <= NU suchthat defined(x1_409[@i_521], x2_408[@i_521], x3_407[@i_521], x4_406[@i_521], x5_405[@i_521], r_404[@i_521]) && ((x1_391 = x1_409[@i_521]) && ((x2_390 = x2_408[@i_521]) && ((x3_389 = x3_407[@i_521]) && ((x4_388 = x4_406[@i_521]) && (x5_387 = x5_405[@i_521]))))) then
      (
        let sk_u: hash0 = r_404[@i_521] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_520 <= NU suchthat defined(x1_415[@i_520], x2_414[@i_520], x3_413[@i_520], x4_412[@i_520], x5_411[@i_520], r_410[@i_520]) && ((x1_391 = x1_415[@i_520]) && ((x2_390 = x2_414[@i_520]) && ((x3_389 = x3_413[@i_520]) && ((x4_388 = x4_412[@i_520]) && (x5_387 = x5_411[@i_520]))))) then
      (
        let sk_u: hash0 = r_410[@i_520] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let x1_385: host = U in
      let x2_384: host = S in
      let x3_383: G = X in
      let x4_382: G = @2_r4_188[@i_236] in
      let x5_381: G = K_u in
      find [unique] @i_519 <= qH0 suchthat defined(x1_343[@i_519], x2_342[@i_519], x3_341[@i_519], x4_340[@i_519], x5_339[@i_519], r_338[@i_519]) && ((x1_385 = x1_343[@i_519]) && ((x2_384 = x2_342[@i_519]) && ((x3_383 = x3_341[@i_519]) && ((x4_382 = x4_340[@i_519]) && (x5_381 = x5_339[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_518 <= NP suchthat defined(x1_349[@i_518], x2_348[@i_518], x3_347[@i_518], x4_346[@i_518], x5_345[@i_518], r_344[@i_518]) && ((x1_385 = x1_349[@i_518]) && ((x2_384 = x2_348[@i_518]) && ((x3_383 = x3_347[@i_518]) && ((x4_382 = x4_346[@i_518]) && (x5_381 = x5_345[@i_518]))))) then
      (
        let sk_u: hash0 = r_344[@i_518] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_517 <= NS suchthat defined(x1_355[@i_517], x2_354[@i_517], x3_353[@i_517], x4_352[@i_517], x5_351[@i_517], r_350[@i_517]) && ((x1_385 = x1_355[@i_517]) && ((x2_384 = x2_354[@i_517]) && ((x3_383 = x3_353[@i_517]) && ((x4_382 = x4_352[@i_517]) && (x5_381 = x5_351[@i_517]))))) then
      (
        let sk_u: hash0 = r_350[@i_517] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_516 <= NS suchthat defined(x1_361[@i_516], x2_360[@i_516], x3_359[@i_516], x4_358[@i_516], x5_357[@i_516], r_356[@i_516]) && ((x1_385 = x1_361[@i_516]) && ((x2_384 = x2_360[@i_516]) && ((x3_383 = x3_359[@i_516]) && ((x4_382 = x4_358[@i_516]) && (x5_381 = x5_357[@i_516]))))) then
      (
        let sk_u: hash0 = r_356[@i_516] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_515 <= NU suchthat defined(x1_367[@i_515], x2_366[@i_515], x3_365[@i_515], x4_364[@i_515], x5_363[@i_515], r_362[@i_515]) && ((x1_385 = x1_367[@i_515]) && ((x2_384 = x2_366[@i_515]) && ((x3_383 = x3_365[@i_515]) && ((x4_382 = x4_364[@i_515]) && (x5_381 = x5_363[@i_515]))))) then
      (
        let sk_u: hash0 = r_362[@i_515] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_514 <= NU suchthat defined(x1_373[@i_514], x2_372[@i_514], x3_371[@i_514], x4_370[@i_514], x5_369[@i_514], r_368[@i_514]) && ((x1_385 = x1_373[@i_514]) && ((x2_384 = x2_372[@i_514]) && ((x3_383 = x3_371[@i_514]) && ((x4_382 = x4_370[@i_514]) && (x5_381 = x5_369[@i_514]))))) then
      (
        let sk_u: hash0 = r_368[@i_514] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_513 <= NU suchthat defined(x1_379[@i_513], x2_378[@i_513], x3_377[@i_513], x4_376[@i_513], x5_375[@i_513], r_374[@i_513]) && ((x1_385 = x1_379[@i_513]) && ((x2_384 = x2_378[@i_513]) && ((x3_383 = x3_377[@i_513]) && ((x4_382 = x4_376[@i_513]) && (x5_381 = x5_375[@i_513]))))) then
      (
        let sk_u: hash0 = r_374[@i_513] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_512 <= NU suchthat defined(x1_385[@i_512], x2_384[@i_512], x3_383[@i_512], x4_382[@i_512], x5_381[@i_512], r_380[@i_512]) && ((x1_385 = x1_385[@i_512]) && ((x2_384 = x2_384[@i_512]) && ((x3_383 = x3_383[@i_512]) && ((x4_382 = x4_382[@i_512]) && (x5_381 = x5_381[@i_512]))))) then
      (
        let sk_u: hash0 = r_380[@i_512] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_511 <= NU suchthat defined(x1_391[@i_511], x2_390[@i_511], x3_389[@i_511], x4_388[@i_511], x5_387[@i_511], r_386[@i_511]) && ((x1_385 = x1_391[@i_511]) && ((x2_384 = x2_390[@i_511]) && ((x3_383 = x3_389[@i_511]) && ((x4_382 = x4_388[@i_511]) && (x5_381 = x5_387[@i_511]))))) then
      (
        let sk_u: hash0 = r_386[@i_511] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_510 <= NU suchthat defined(x1_397[@i_510], x2_396[@i_510], x3_395[@i_510], x4_394[@i_510], x5_393[@i_510], r_392[@i_510]) && ((x1_385 = x1_397[@i_510]) && ((x2_384 = x2_396[@i_510]) && ((x3_383 = x3_395[@i_510]) && ((x4_382 = x4_394[@i_510]) && (x5_381 = x5_393[@i_510]))))) then
      (
        let sk_u: hash0 = r_392[@i_510] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_509 <= NU suchthat defined(x1_403[@i_509], x2_402[@i_509], x3_401[@i_509], x4_400[@i_509], x5_399[@i_509], r_398[@i_509]) && ((x1_385 = x1_403[@i_509]) && ((x2_384 = x2_402[@i_509]) && ((x3_383 = x3_401[@i_509]) && ((x4_382 = x4_400[@i_509]) && (x5_381 = x5_399[@i_509]))))) then
      (
        let sk_u: hash0 = r_398[@i_509] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_508 <= NU suchthat defined(x1_409[@i_508], x2_408[@i_508], x3_407[@i_508], x4_406[@i_508], x5_405[@i_508], r_404[@i_508]) && ((x1_385 = x1_409[@i_508]) && ((x2_384 = x2_408[@i_508]) && ((x3_383 = x3_407[@i_508]) && ((x4_382 = x4_406[@i_508]) && (x5_381 = x5_405[@i_508]))))) then
      (
        let sk_u: hash0 = r_404[@i_508] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_507 <= NU suchthat defined(x1_415[@i_507], x2_414[@i_507], x3_413[@i_507], x4_412[@i_507], x5_411[@i_507], r_410[@i_507]) && ((x1_385 = x1_415[@i_507]) && ((x2_384 = x2_414[@i_507]) && ((x3_383 = x3_413[@i_507]) && ((x4_382 = x4_412[@i_507]) && (x5_381 = x5_411[@i_507]))))) then
      (
        let sk_u: hash0 = r_410[@i_507] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_ke[@i_234], @2_x[@i_234], @2_x_181[@i_234], @2_ke_180[@i_234], @2_r2_179[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(Yp[@i_233], xp[@i_233], @2_r2_182[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      let x3_401: G = X in
      let x4_400: G = Yp[@i_233] in
      let x5_399: G = K_u in
      find [unique] @i_558 <= qH0 suchthat defined(x1_343[@i_558], x2_342[@i_558], x3_341[@i_558], x4_340[@i_558], x5_339[@i_558], r_338[@i_558]) && ((x1_403 = x1_343[@i_558]) && ((x2_402 = x2_342[@i_558]) && ((x3_401 = x3_341[@i_558]) && ((x4_400 = x4_340[@i_558]) && (x5_399 = x5_339[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_557 <= NP suchthat defined(x1_349[@i_557], x2_348[@i_557], x3_347[@i_557], x4_346[@i_557], x5_345[@i_557], r_344[@i_557]) && ((x1_403 = x1_349[@i_557]) && ((x2_402 = x2_348[@i_557]) && ((x3_401 = x3_347[@i_557]) && ((x4_400 = x4_346[@i_557]) && (x5_399 = x5_345[@i_557]))))) then
      (
        let sk_u: hash0 = r_344[@i_557] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_556 <= NS suchthat defined(x1_355[@i_556], x2_354[@i_556], x3_353[@i_556], x4_352[@i_556], x5_351[@i_556], r_350[@i_556]) && ((x1_403 = x1_355[@i_556]) && ((x2_402 = x2_354[@i_556]) && ((x3_401 = x3_353[@i_556]) && ((x4_400 = x4_352[@i_556]) && (x5_399 = x5_351[@i_556]))))) then
      (
        let sk_u: hash0 = r_350[@i_556] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_555 <= NS suchthat defined(x1_361[@i_555], x2_360[@i_555], x3_359[@i_555], x4_358[@i_555], x5_357[@i_555], r_356[@i_555]) && ((x1_403 = x1_361[@i_555]) && ((x2_402 = x2_360[@i_555]) && ((x3_401 = x3_359[@i_555]) && ((x4_400 = x4_358[@i_555]) && (x5_399 = x5_357[@i_555]))))) then
      (
        let sk_u: hash0 = r_356[@i_555] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_554 <= NU suchthat defined(x1_367[@i_554], x2_366[@i_554], x3_365[@i_554], x4_364[@i_554], x5_363[@i_554], r_362[@i_554]) && ((x1_403 = x1_367[@i_554]) && ((x2_402 = x2_366[@i_554]) && ((x3_401 = x3_365[@i_554]) && ((x4_400 = x4_364[@i_554]) && (x5_399 = x5_363[@i_554]))))) then
      (
        let sk_u: hash0 = r_362[@i_554] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_553 <= NU suchthat defined(x1_373[@i_553], x2_372[@i_553], x3_371[@i_553], x4_370[@i_553], x5_369[@i_553], r_368[@i_553]) && ((x1_403 = x1_373[@i_553]) && ((x2_402 = x2_372[@i_553]) && ((x3_401 = x3_371[@i_553]) && ((x4_400 = x4_370[@i_553]) && (x5_399 = x5_369[@i_553]))))) then
      (
        let sk_u: hash0 = r_368[@i_553] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_552 <= NU suchthat defined(x1_379[@i_552], x2_378[@i_552], x3_377[@i_552], x4_376[@i_552], x5_375[@i_552], r_374[@i_552]) && ((x1_403 = x1_379[@i_552]) && ((x2_402 = x2_378[@i_552]) && ((x3_401 = x3_377[@i_552]) && ((x4_400 = x4_376[@i_552]) && (x5_399 = x5_375[@i_552]))))) then
      (
        let sk_u: hash0 = r_374[@i_552] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_551 <= NU suchthat defined(x1_385[@i_551], x2_384[@i_551], x3_383[@i_551], x4_382[@i_551], x5_381[@i_551], r_380[@i_551]) && ((x1_403 = x1_385[@i_551]) && ((x2_402 = x2_384[@i_551]) && ((x3_401 = x3_383[@i_551]) && ((x4_400 = x4_382[@i_551]) && (x5_399 = x5_381[@i_551]))))) then
      (
        let sk_u: hash0 = r_380[@i_551] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_550 <= NU suchthat defined(x1_391[@i_550], x2_390[@i_550], x3_389[@i_550], x4_388[@i_550], x5_387[@i_550], r_386[@i_550]) && ((x1_403 = x1_391[@i_550]) && ((x2_402 = x2_390[@i_550]) && ((x3_401 = x3_389[@i_550]) && ((x4_400 = x4_388[@i_550]) && (x5_399 = x5_387[@i_550]))))) then
      (
        let sk_u: hash0 = r_386[@i_550] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_549 <= NU suchthat defined(x1_397[@i_549], x2_396[@i_549], x3_395[@i_549], x4_394[@i_549], x5_393[@i_549], r_392[@i_549]) && ((x1_403 = x1_397[@i_549]) && ((x2_402 = x2_396[@i_549]) && ((x3_401 = x3_395[@i_549]) && ((x4_400 = x4_394[@i_549]) && (x5_399 = x5_393[@i_549]))))) then
      (
        let sk_u: hash0 = r_392[@i_549] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_548 <= NU suchthat defined(x1_403[@i_548], x2_402[@i_548], x3_401[@i_548], x4_400[@i_548], x5_399[@i_548], r_398[@i_548]) && ((x1_403 = x1_403[@i_548]) && ((x2_402 = x2_402[@i_548]) && ((x3_401 = x3_401[@i_548]) && ((x4_400 = x4_400[@i_548]) && (x5_399 = x5_399[@i_548]))))) then
      (
        let sk_u: hash0 = r_398[@i_548] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_547 <= NU suchthat defined(x1_409[@i_547], x2_408[@i_547], x3_407[@i_547], x4_406[@i_547], x5_405[@i_547], r_404[@i_547]) && ((x1_403 = x1_409[@i_547]) && ((x2_402 = x2_408[@i_547]) && ((x3_401 = x3_407[@i_547]) && ((x4_400 = x4_406[@i_547]) && (x5_399 = x5_405[@i_547]))))) then
      (
        let sk_u: hash0 = r_404[@i_547] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_546 <= NU suchthat defined(x1_415[@i_546], x2_414[@i_546], x3_413[@i_546], x4_412[@i_546], x5_411[@i_546], r_410[@i_546]) && ((x1_403 = x1_415[@i_546]) && ((x2_402 = x2_414[@i_546]) && ((x3_401 = x3_413[@i_546]) && ((x4_400 = x4_412[@i_546]) && (x5_399 = x5_411[@i_546]))))) then
      (
        let sk_u: hash0 = r_410[@i_546] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let x1_397: host = U in
      let x2_396: host = S in
      let x3_395: G = X in
      let x4_394: G = Yp[@i_233] in
      let x5_393: G = K_u in
      find [unique] @i_545 <= qH0 suchthat defined(x1_343[@i_545], x2_342[@i_545], x3_341[@i_545], x4_340[@i_545], x5_339[@i_545], r_338[@i_545]) && ((x1_397 = x1_343[@i_545]) && ((x2_396 = x2_342[@i_545]) && ((x3_395 = x3_341[@i_545]) && ((x4_394 = x4_340[@i_545]) && (x5_393 = x5_339[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_544 <= NP suchthat defined(x1_349[@i_544], x2_348[@i_544], x3_347[@i_544], x4_346[@i_544], x5_345[@i_544], r_344[@i_544]) && ((x1_397 = x1_349[@i_544]) && ((x2_396 = x2_348[@i_544]) && ((x3_395 = x3_347[@i_544]) && ((x4_394 = x4_346[@i_544]) && (x5_393 = x5_345[@i_544]))))) then
      (
        let sk_u: hash0 = r_344[@i_544] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_543 <= NS suchthat defined(x1_355[@i_543], x2_354[@i_543], x3_353[@i_543], x4_352[@i_543], x5_351[@i_543], r_350[@i_543]) && ((x1_397 = x1_355[@i_543]) && ((x2_396 = x2_354[@i_543]) && ((x3_395 = x3_353[@i_543]) && ((x4_394 = x4_352[@i_543]) && (x5_393 = x5_351[@i_543]))))) then
      (
        let sk_u: hash0 = r_350[@i_543] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_542 <= NS suchthat defined(x1_361[@i_542], x2_360[@i_542], x3_359[@i_542], x4_358[@i_542], x5_357[@i_542], r_356[@i_542]) && ((x1_397 = x1_361[@i_542]) && ((x2_396 = x2_360[@i_542]) && ((x3_395 = x3_359[@i_542]) && ((x4_394 = x4_358[@i_542]) && (x5_393 = x5_357[@i_542]))))) then
      (
        let sk_u: hash0 = r_356[@i_542] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_541 <= NU suchthat defined(x1_367[@i_541], x2_366[@i_541], x3_365[@i_541], x4_364[@i_541], x5_363[@i_541], r_362[@i_541]) && ((x1_397 = x1_367[@i_541]) && ((x2_396 = x2_366[@i_541]) && ((x3_395 = x3_365[@i_541]) && ((x4_394 = x4_364[@i_541]) && (x5_393 = x5_363[@i_541]))))) then
      (
        let sk_u: hash0 = r_362[@i_541] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_540 <= NU suchthat defined(x1_373[@i_540], x2_372[@i_540], x3_371[@i_540], x4_370[@i_540], x5_369[@i_540], r_368[@i_540]) && ((x1_397 = x1_373[@i_540]) && ((x2_396 = x2_372[@i_540]) && ((x3_395 = x3_371[@i_540]) && ((x4_394 = x4_370[@i_540]) && (x5_393 = x5_369[@i_540]))))) then
      (
        let sk_u: hash0 = r_368[@i_540] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_539 <= NU suchthat defined(x1_379[@i_539], x2_378[@i_539], x3_377[@i_539], x4_376[@i_539], x5_375[@i_539], r_374[@i_539]) && ((x1_397 = x1_379[@i_539]) && ((x2_396 = x2_378[@i_539]) && ((x3_395 = x3_377[@i_539]) && ((x4_394 = x4_376[@i_539]) && (x5_393 = x5_375[@i_539]))))) then
      (
        let sk_u: hash0 = r_374[@i_539] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_538 <= NU suchthat defined(x1_385[@i_538], x2_384[@i_538], x3_383[@i_538], x4_382[@i_538], x5_381[@i_538], r_380[@i_538]) && ((x1_397 = x1_385[@i_538]) && ((x2_396 = x2_384[@i_538]) && ((x3_395 = x3_383[@i_538]) && ((x4_394 = x4_382[@i_538]) && (x5_393 = x5_381[@i_538]))))) then
      (
        let sk_u: hash0 = r_380[@i_538] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_537 <= NU suchthat defined(x1_391[@i_537], x2_390[@i_537], x3_389[@i_537], x4_388[@i_537], x5_387[@i_537], r_386[@i_537]) && ((x1_397 = x1_391[@i_537]) && ((x2_396 = x2_390[@i_537]) && ((x3_395 = x3_389[@i_537]) && ((x4_394 = x4_388[@i_537]) && (x5_393 = x5_387[@i_537]))))) then
      (
        let sk_u: hash0 = r_386[@i_537] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_536 <= NU suchthat defined(x1_397[@i_536], x2_396[@i_536], x3_395[@i_536], x4_394[@i_536], x5_393[@i_536], r_392[@i_536]) && ((x1_397 = x1_397[@i_536]) && ((x2_396 = x2_396[@i_536]) && ((x3_395 = x3_395[@i_536]) && ((x4_394 = x4_394[@i_536]) && (x5_393 = x5_393[@i_536]))))) then
      (
        let sk_u: hash0 = r_392[@i_536] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_535 <= NU suchthat defined(x1_403[@i_535], x2_402[@i_535], x3_401[@i_535], x4_400[@i_535], x5_399[@i_535], r_398[@i_535]) && ((x1_397 = x1_403[@i_535]) && ((x2_396 = x2_402[@i_535]) && ((x3_395 = x3_401[@i_535]) && ((x4_394 = x4_400[@i_535]) && (x5_393 = x5_399[@i_535]))))) then
      (
        let sk_u: hash0 = r_398[@i_535] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_534 <= NU suchthat defined(x1_409[@i_534], x2_408[@i_534], x3_407[@i_534], x4_406[@i_534], x5_405[@i_534], r_404[@i_534]) && ((x1_397 = x1_409[@i_534]) && ((x2_396 = x2_408[@i_534]) && ((x3_395 = x3_407[@i_534]) && ((x4_394 = x4_406[@i_534]) && (x5_393 = x5_405[@i_534]))))) then
      (
        let sk_u: hash0 = r_404[@i_534] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_533 <= NU suchthat defined(x1_415[@i_533], x2_414[@i_533], x3_413[@i_533], x4_412[@i_533], x5_411[@i_533], r_410[@i_533]) && ((x1_397 = x1_415[@i_533]) && ((x2_396 = x2_414[@i_533]) && ((x3_395 = x3_413[@i_533]) && ((x4_394 = x4_412[@i_533]) && (x5_393 = x5_411[@i_533]))))) then
      (
        let sk_u: hash0 = r_410[@i_533] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(Y[@i_232], y[@i_232], @2_r2_185[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      let x3_413: G = X in
      let x4_412: G = Y[@i_232] in
      let x5_411: G = K_u in
      find [unique] @i_584 <= qH0 suchthat defined(x1_343[@i_584], x2_342[@i_584], x3_341[@i_584], x4_340[@i_584], x5_339[@i_584], r_338[@i_584]) && ((x1_415 = x1_343[@i_584]) && ((x2_414 = x2_342[@i_584]) && ((x3_413 = x3_341[@i_584]) && ((x4_412 = x4_340[@i_584]) && (x5_411 = x5_339[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_583 <= NP suchthat defined(x1_349[@i_583], x2_348[@i_583], x3_347[@i_583], x4_346[@i_583], x5_345[@i_583], r_344[@i_583]) && ((x1_415 = x1_349[@i_583]) && ((x2_414 = x2_348[@i_583]) && ((x3_413 = x3_347[@i_583]) && ((x4_412 = x4_346[@i_583]) && (x5_411 = x5_345[@i_583]))))) then
      (
        let sk_u: hash0 = r_344[@i_583] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_582 <= NS suchthat defined(x1_355[@i_582], x2_354[@i_582], x3_353[@i_582], x4_352[@i_582], x5_351[@i_582], r_350[@i_582]) && ((x1_415 = x1_355[@i_582]) && ((x2_414 = x2_354[@i_582]) && ((x3_413 = x3_353[@i_582]) && ((x4_412 = x4_352[@i_582]) && (x5_411 = x5_351[@i_582]))))) then
      (
        let sk_u: hash0 = r_350[@i_582] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_581 <= NS suchthat defined(x1_361[@i_581], x2_360[@i_581], x3_359[@i_581], x4_358[@i_581], x5_357[@i_581], r_356[@i_581]) && ((x1_415 = x1_361[@i_581]) && ((x2_414 = x2_360[@i_581]) && ((x3_413 = x3_359[@i_581]) && ((x4_412 = x4_358[@i_581]) && (x5_411 = x5_357[@i_581]))))) then
      (
        let sk_u: hash0 = r_356[@i_581] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_580 <= NU suchthat defined(x1_367[@i_580], x2_366[@i_580], x3_365[@i_580], x4_364[@i_580], x5_363[@i_580], r_362[@i_580]) && ((x1_415 = x1_367[@i_580]) && ((x2_414 = x2_366[@i_580]) && ((x3_413 = x3_365[@i_580]) && ((x4_412 = x4_364[@i_580]) && (x5_411 = x5_363[@i_580]))))) then
      (
        let sk_u: hash0 = r_362[@i_580] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_579 <= NU suchthat defined(x1_373[@i_579], x2_372[@i_579], x3_371[@i_579], x4_370[@i_579], x5_369[@i_579], r_368[@i_579]) && ((x1_415 = x1_373[@i_579]) && ((x2_414 = x2_372[@i_579]) && ((x3_413 = x3_371[@i_579]) && ((x4_412 = x4_370[@i_579]) && (x5_411 = x5_369[@i_579]))))) then
      (
        let sk_u: hash0 = r_368[@i_579] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_578 <= NU suchthat defined(x1_379[@i_578], x2_378[@i_578], x3_377[@i_578], x4_376[@i_578], x5_375[@i_578], r_374[@i_578]) && ((x1_415 = x1_379[@i_578]) && ((x2_414 = x2_378[@i_578]) && ((x3_413 = x3_377[@i_578]) && ((x4_412 = x4_376[@i_578]) && (x5_411 = x5_375[@i_578]))))) then
      (
        let sk_u: hash0 = r_374[@i_578] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_577 <= NU suchthat defined(x1_385[@i_577], x2_384[@i_577], x3_383[@i_577], x4_382[@i_577], x5_381[@i_577], r_380[@i_577]) && ((x1_415 = x1_385[@i_577]) && ((x2_414 = x2_384[@i_577]) && ((x3_413 = x3_383[@i_577]) && ((x4_412 = x4_382[@i_577]) && (x5_411 = x5_381[@i_577]))))) then
      (
        let sk_u: hash0 = r_380[@i_577] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_576 <= NU suchthat defined(x1_391[@i_576], x2_390[@i_576], x3_389[@i_576], x4_388[@i_576], x5_387[@i_576], r_386[@i_576]) && ((x1_415 = x1_391[@i_576]) && ((x2_414 = x2_390[@i_576]) && ((x3_413 = x3_389[@i_576]) && ((x4_412 = x4_388[@i_576]) && (x5_411 = x5_387[@i_576]))))) then
      (
        let sk_u: hash0 = r_386[@i_576] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_575 <= NU suchthat defined(x1_397[@i_575], x2_396[@i_575], x3_395[@i_575], x4_394[@i_575], x5_393[@i_575], r_392[@i_575]) && ((x1_415 = x1_397[@i_575]) && ((x2_414 = x2_396[@i_575]) && ((x3_413 = x3_395[@i_575]) && ((x4_412 = x4_394[@i_575]) && (x5_411 = x5_393[@i_575]))))) then
      (
        let sk_u: hash0 = r_392[@i_575] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_574 <= NU suchthat defined(x1_403[@i_574], x2_402[@i_574], x3_401[@i_574], x4_400[@i_574], x5_399[@i_574], r_398[@i_574]) && ((x1_415 = x1_403[@i_574]) && ((x2_414 = x2_402[@i_574]) && ((x3_413 = x3_401[@i_574]) && ((x4_412 = x4_400[@i_574]) && (x5_411 = x5_399[@i_574]))))) then
      (
        let sk_u: hash0 = r_398[@i_574] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_573 <= NU suchthat defined(x1_409[@i_573], x2_408[@i_573], x3_407[@i_573], x4_406[@i_573], x5_405[@i_573], r_404[@i_573]) && ((x1_415 = x1_409[@i_573]) && ((x2_414 = x2_408[@i_573]) && ((x3_413 = x3_407[@i_573]) && ((x4_412 = x4_406[@i_573]) && (x5_411 = x5_405[@i_573]))))) then
      (
        let sk_u: hash0 = r_404[@i_573] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind @i_572 <= NU suchthat defined(x1_415[@i_572], x2_414[@i_572], x3_413[@i_572], x4_412[@i_572], x5_411[@i_572], r_410[@i_572]) && ((x1_415 = x1_415[@i_572]) && ((x2_414 = x2_414[@i_572]) && ((x3_413 = x3_413[@i_572]) && ((x4_412 = x4_412[@i_572]) && (x5_411 = x5_411[@i_572]))))) then
      (
        let sk_u: hash0 = r_410[@i_572] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let x1_409: host = U in
      let x2_408: host = S in
      let x3_407: G = X in
      let x4_406: G = Y[@i_232] in
      let x5_405: G = K_u in
      find [unique] @i_571 <= qH0 suchthat defined(x1_343[@i_571], x2_342[@i_571], x3_341[@i_571], x4_340[@i_571], x5_339[@i_571], r_338[@i_571]) && ((x1_409 = x1_343[@i_571]) && ((x2_408 = x2_342[@i_571]) && ((x3_407 = x3_341[@i_571]) && ((x4_406 = x4_340[@i_571]) && (x5_405 = x5_339[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_570 <= NP suchthat defined(x1_349[@i_570], x2_348[@i_570], x3_347[@i_570], x4_346[@i_570], x5_345[@i_570], r_344[@i_570]) && ((x1_409 = x1_349[@i_570]) && ((x2_408 = x2_348[@i_570]) && ((x3_407 = x3_347[@i_570]) && ((x4_406 = x4_346[@i_570]) && (x5_405 = x5_345[@i_570]))))) then
      (
        let sk_u: hash0 = r_344[@i_570] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_569 <= NS suchthat defined(x1_355[@i_569], x2_354[@i_569], x3_353[@i_569], x4_352[@i_569], x5_351[@i_569], r_350[@i_569]) && ((x1_409 = x1_355[@i_569]) && ((x2_408 = x2_354[@i_569]) && ((x3_407 = x3_353[@i_569]) && ((x4_406 = x4_352[@i_569]) && (x5_405 = x5_351[@i_569]))))) then
      (
        let sk_u: hash0 = r_350[@i_569] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_568 <= NS suchthat defined(x1_361[@i_568], x2_360[@i_568], x3_359[@i_568], x4_358[@i_568], x5_357[@i_568], r_356[@i_568]) && ((x1_409 = x1_361[@i_568]) && ((x2_408 = x2_360[@i_568]) && ((x3_407 = x3_359[@i_568]) && ((x4_406 = x4_358[@i_568]) && (x5_405 = x5_357[@i_568]))))) then
      (
        let sk_u: hash0 = r_356[@i_568] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_567 <= NU suchthat defined(x1_367[@i_567], x2_366[@i_567], x3_365[@i_567], x4_364[@i_567], x5_363[@i_567], r_362[@i_567]) && ((x1_409 = x1_367[@i_567]) && ((x2_408 = x2_366[@i_567]) && ((x3_407 = x3_365[@i_567]) && ((x4_406 = x4_364[@i_567]) && (x5_405 = x5_363[@i_567]))))) then
      (
        let sk_u: hash0 = r_362[@i_567] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_566 <= NU suchthat defined(x1_373[@i_566], x2_372[@i_566], x3_371[@i_566], x4_370[@i_566], x5_369[@i_566], r_368[@i_566]) && ((x1_409 = x1_373[@i_566]) && ((x2_408 = x2_372[@i_566]) && ((x3_407 = x3_371[@i_566]) && ((x4_406 = x4_370[@i_566]) && (x5_405 = x5_369[@i_566]))))) then
      (
        let sk_u: hash0 = r_368[@i_566] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_565 <= NU suchthat defined(x1_379[@i_565], x2_378[@i_565], x3_377[@i_565], x4_376[@i_565], x5_375[@i_565], r_374[@i_565]) && ((x1_409 = x1_379[@i_565]) && ((x2_408 = x2_378[@i_565]) && ((x3_407 = x3_377[@i_565]) && ((x4_406 = x4_376[@i_565]) && (x5_405 = x5_375[@i_565]))))) then
      (
        let sk_u: hash0 = r_374[@i_565] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_564 <= NU suchthat defined(x1_385[@i_564], x2_384[@i_564], x3_383[@i_564], x4_382[@i_564], x5_381[@i_564], r_380[@i_564]) && ((x1_409 = x1_385[@i_564]) && ((x2_408 = x2_384[@i_564]) && ((x3_407 = x3_383[@i_564]) && ((x4_406 = x4_382[@i_564]) && (x5_405 = x5_381[@i_564]))))) then
      (
        let sk_u: hash0 = r_380[@i_564] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_563 <= NU suchthat defined(x1_391[@i_563], x2_390[@i_563], x3_389[@i_563], x4_388[@i_563], x5_387[@i_563], r_386[@i_563]) && ((x1_409 = x1_391[@i_563]) && ((x2_408 = x2_390[@i_563]) && ((x3_407 = x3_389[@i_563]) && ((x4_406 = x4_388[@i_563]) && (x5_405 = x5_387[@i_563]))))) then
      (
        let sk_u: hash0 = r_386[@i_563] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_562 <= NU suchthat defined(x1_397[@i_562], x2_396[@i_562], x3_395[@i_562], x4_394[@i_562], x5_393[@i_562], r_392[@i_562]) && ((x1_409 = x1_397[@i_562]) && ((x2_408 = x2_396[@i_562]) && ((x3_407 = x3_395[@i_562]) && ((x4_406 = x4_394[@i_562]) && (x5_405 = x5_393[@i_562]))))) then
      (
        let sk_u: hash0 = r_392[@i_562] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_561 <= NU suchthat defined(x1_403[@i_561], x2_402[@i_561], x3_401[@i_561], x4_400[@i_561], x5_399[@i_561], r_398[@i_561]) && ((x1_409 = x1_403[@i_561]) && ((x2_408 = x2_402[@i_561]) && ((x3_407 = x3_401[@i_561]) && ((x4_406 = x4_400[@i_561]) && (x5_405 = x5_399[@i_561]))))) then
      (
        let sk_u: hash0 = r_398[@i_561] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_560 <= NU suchthat defined(x1_409[@i_560], x2_408[@i_560], x3_407[@i_560], x4_406[@i_560], x5_405[@i_560], r_404[@i_560]) && ((x1_409 = x1_409[@i_560]) && ((x2_408 = x2_408[@i_560]) && ((x3_407 = x3_407[@i_560]) && ((x4_406 = x4_406[@i_560]) && (x5_405 = x5_405[@i_560]))))) then
      (
        let sk_u: hash0 = r_404[@i_560] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      orfind @i_559 <= NU suchthat defined(x1_415[@i_559], x2_414[@i_559], x3_413[@i_559], x4_412[@i_559], x5_411[@i_559], r_410[@i_559]) && ((x1_409 = x1_415[@i_559]) && ((x2_408 = x2_414[@i_559]) && ((x3_407 = x3_413[@i_559]) && ((x4_406 = x4_412[@i_559]) && (x5_405 = x5_411[@i_559]))))) then
      (
        let sk_u: hash0 = r_410[@i_559] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
  )
  else
    new @2_r4_188: G;
    let Y_u: G = @2_r4_188 in
    let K_u: G = exp(@2_r4_188, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    let x3_365: G = X in
    let x4_364: G = @2_r4_188 in
    let x5_363: G = K_u in
    find [unique] @i_480 <= qH0 suchthat defined(x1_343[@i_480], x2_342[@i_480], x3_341[@i_480], x4_340[@i_480], x5_339[@i_480], r_338[@i_480]) && ((x1_367 = x1_343[@i_480]) && ((x2_366 = x2_342[@i_480]) && ((x3_365 = x3_341[@i_480]) && ((x4_364 = x4_340[@i_480]) && (x5_363 = x5_339[@i_480]))))) then
    (
      let sk_u: hash0 = r_338[@i_480] in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
    )
    orfind @i_479 <= NP suchthat defined(x1_349[@i_479], x2_348[@i_479], x3_347[@i_479], x4_346[@i_479], x5_345[@i_479], r_344[@i_479]) && ((x1_367 = x1_349[@i_479]) && ((x2_366 = x2_348[@i_479]) && ((x3_365 = x3_347[@i_479]) && ((x4_364 = x4_346[@i_479]) && (x5_363 = x5_345[@i_479]))))) then
    (
      let sk_u: hash0 = r_344[@i_479] in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
    )
    orfind @i_478 <= NS suchthat defined(x1_355[@i_478], x2_354[@i_478], x3_353[@i_478], x4_352[@i_478], x5_351[@i_478], r_350[@i_478]) && ((x1_367 = x1_355[@i_478]) && ((x2_366 = x2_354[@i_478]) && ((x3_365 = x3_353[@i_478]) && ((x4_364 = x4_352[@i_478]) && (x5_363 = x5_351[@i_478]))))) then
    (
      let sk_u: hash0 = r_350[@i_478] in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
    )
    orfind @i_477 <= NS suchthat defined(x1_361[@i_477], x2_360[@i_477], x3_359[@i_477], x4_358[@i_477], x5_357[@i_477], r_356[@i_477]) && ((x1_367 = x1_361[@i_477]) && ((x2_366 = x2_360[@i_477]) && ((x3_365 = x3_359[@i_477]) && ((x4_364 = x4_358[@i_477]) && (x5_363 = x5_357[@i_477]))))) then
    (
      let sk_u: hash0 = r_356[@i_477] in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
    )
    orfind @i_476 <= NU suchthat defined(x1_367[@i_476], x2_366[@i_476], x3_365[@i_476], x4_364[@i_476], x5_363[@i_476], r_362[@i_476]) && ((x1_367 = x1_367[@i_476]) && ((x2_366 = x2_366[@i_476]) && ((x3_365 = x3_365[@i_476]) && ((x4_364 = x4_364[@i_476]) && (x5_363 = x5_363[@i_476]))))) then
    (
      let sk_u: hash0 = r_362[@i_476] in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
    )
    orfind @i_475 <= NU suchthat defined(x1_373[@i_475], x2_372[@i_475], x3_371[@i_475], x4_370[@i_475], x5_369[@i_475], r_368[@i_475]) && ((x1_367 = x1_373[@i_475]) && ((x2_366 = x2_372[@i_475]) && ((x3_365 = x3_371[@i_475]) && ((x4_364 = x4_370[@i_475]) && (x5_363 = x5_369[@i_475]))))) then
    (
      let sk_u: hash0 = r_368[@i_475] in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
    )
    orfind @i_474 <= NU suchthat defined(x1_379[@i_474], x2_378[@i_474], x3_377[@i_474], x4_376[@i_474], x5_375[@i_474], r_374[@i_474]) && ((x1_367 = x1_379[@i_474]) && ((x2_366 = x2_378[@i_474]) && ((x3_365 = x3_377[@i_474]) && ((x4_364 = x4_376[@i_474]) && (x5_363 = x5_375[@i_474]))))) then
    (
      let sk_u: hash0 = r_374[@i_474] in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
    )
    orfind @i_473 <= NU suchthat defined(x1_385[@i_473], x2_384[@i_473], x3_383[@i_473], x4_382[@i_473], x5_381[@i_473], r_380[@i_473]) && ((x1_367 = x1_385[@i_473]) && ((x2_366 = x2_384[@i_473]) && ((x3_365 = x3_383[@i_473]) && ((x4_364 = x4_382[@i_473]) && (x5_363 = x5_381[@i_473]))))) then
    (
      let sk_u: hash0 = r_380[@i_473] in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
    )
    orfind @i_472 <= NU suchthat defined(x1_391[@i_472], x2_390[@i_472], x3_389[@i_472], x4_388[@i_472], x5_387[@i_472], r_386[@i_472]) && ((x1_367 = x1_391[@i_472]) && ((x2_366 = x2_390[@i_472]) && ((x3_365 = x3_389[@i_472]) && ((x4_364 = x4_388[@i_472]) && (x5_363 = x5_387[@i_472]))))) then
    (
      let sk_u: hash0 = r_386[@i_472] in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
    )
    orfind @i_471 <= NU suchthat defined(x1_397[@i_471], x2_396[@i_471], x3_395[@i_471], x4_394[@i_471], x5_393[@i_471], r_392[@i_471]) && ((x1_367 = x1_397[@i_471]) && ((x2_366 = x2_396[@i_471]) && ((x3_365 = x3_395[@i_471]) && ((x4_364 = x4_394[@i_471]) && (x5_363 = x5_393[@i_471]))))) then
    (
      let sk_u: hash0 = r_392[@i_471] in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
    )
    orfind @i_470 <= NU suchthat defined(x1_403[@i_470], x2_402[@i_470], x3_401[@i_470], x4_400[@i_470], x5_399[@i_470], r_398[@i_470]) && ((x1_367 = x1_403[@i_470]) && ((x2_366 = x2_402[@i_470]) && ((x3_365 = x3_401[@i_470]) && ((x4_364 = x4_400[@i_470]) && (x5_363 = x5_399[@i_470]))))) then
    (
      let sk_u: hash0 = r_398[@i_470] in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
    )
    orfind @i_469 <= NU suchthat defined(x1_409[@i_469], x2_408[@i_469], x3_407[@i_469], x4_406[@i_469], x5_405[@i_469], r_404[@i_469]) && ((x1_367 = x1_409[@i_469]) && ((x2_366 = x2_408[@i_469]) && ((x3_365 = x3_407[@i_469]) && ((x4_364 = x4_406[@i_469]) && (x5_363 = x5_405[@i_469]))))) then
    (
      let sk_u: hash0 = r_404[@i_469] in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
    )
    orfind @i_468 <= NU suchthat defined(x1_415[@i_468], x2_414[@i_468], x3_413[@i_468], x4_412[@i_468], x5_411[@i_468], r_410[@i_468]) && ((x1_367 = x1_415[@i_468]) && ((x2_366 = x2_414[@i_468]) && ((x3_365 = x3_413[@i_468]) && ((x4_364 = x4_412[@i_468]) && (x5_363 = x5_411[@i_468]))))) then
    (
      let sk_u: hash0 = r_410[@i_468] in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
    )
    else
      new r_362: hash0;
      let sk_u: hash0 = r_362 in
      event termU(U, X, S, Ystar_u, r1_94, sk_u);
      out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      let x3_353: G = X_s in
      let x4_352: G = Y in
      let x5_351: G = K_s in
      find [unique] @i_454 <= qH0 suchthat defined(x1_343[@i_454], x2_342[@i_454], x3_341[@i_454], x4_340[@i_454], x5_339[@i_454], r_338[@i_454]) && ((x1_355 = x1_343[@i_454]) && ((x2_354 = x2_342[@i_454]) && ((x3_353 = x3_341[@i_454]) && ((x4_352 = x4_340[@i_454]) && (x5_351 = x5_339[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_453 <= NP suchthat defined(x1_349[@i_453], x2_348[@i_453], x3_347[@i_453], x4_346[@i_453], x5_345[@i_453], r_344[@i_453]) && ((x1_355 = x1_349[@i_453]) && ((x2_354 = x2_348[@i_453]) && ((x3_353 = x3_347[@i_453]) && ((x4_352 = x4_346[@i_453]) && (x5_351 = x5_345[@i_453]))))) then
      (
        let sk_s: hash0 = r_344[@i_453] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_452 <= NS suchthat defined(x1_355[@i_452], x2_354[@i_452], x3_353[@i_452], x4_352[@i_452], x5_351[@i_452], r_350[@i_452]) && ((x1_355 = x1_355[@i_452]) && ((x2_354 = x2_354[@i_452]) && ((x3_353 = x3_353[@i_452]) && ((x4_352 = x4_352[@i_452]) && (x5_351 = x5_351[@i_452]))))) then
      (
        let sk_s: hash0 = r_350[@i_452] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_451 <= NS suchthat defined(x1_361[@i_451], x2_360[@i_451], x3_359[@i_451], x4_358[@i_451], x5_357[@i_451], r_356[@i_451]) && ((x1_355 = x1_361[@i_451]) && ((x2_354 = x2_360[@i_451]) && ((x3_353 = x3_359[@i_451]) && ((x4_352 = x4_358[@i_451]) && (x5_351 = x5_357[@i_451]))))) then
      (
        let sk_s: hash0 = r_356[@i_451] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_450 <= NU suchthat defined(x1_367[@i_450], x2_366[@i_450], x3_365[@i_450], x4_364[@i_450], x5_363[@i_450], r_362[@i_450]) && ((x1_355 = x1_367[@i_450]) && ((x2_354 = x2_366[@i_450]) && ((x3_353 = x3_365[@i_450]) && ((x4_352 = x4_364[@i_450]) && (x5_351 = x5_363[@i_450]))))) then
      (
        let sk_s: hash0 = r_362[@i_450] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_449 <= NU suchthat defined(x1_373[@i_449], x2_372[@i_449], x3_371[@i_449], x4_370[@i_449], x5_369[@i_449], r_368[@i_449]) && ((x1_355 = x1_373[@i_449]) && ((x2_354 = x2_372[@i_449]) && ((x3_353 = x3_371[@i_449]) && ((x4_352 = x4_370[@i_449]) && (x5_351 = x5_369[@i_449]))))) then
      (
        let sk_s: hash0 = r_368[@i_449] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_448 <= NU suchthat defined(x1_379[@i_448], x2_378[@i_448], x3_377[@i_448], x4_376[@i_448], x5_375[@i_448], r_374[@i_448]) && ((x1_355 = x1_379[@i_448]) && ((x2_354 = x2_378[@i_448]) && ((x3_353 = x3_377[@i_448]) && ((x4_352 = x4_376[@i_448]) && (x5_351 = x5_375[@i_448]))))) then
      (
        let sk_s: hash0 = r_374[@i_448] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_447 <= NU suchthat defined(x1_385[@i_447], x2_384[@i_447], x3_383[@i_447], x4_382[@i_447], x5_381[@i_447], r_380[@i_447]) && ((x1_355 = x1_385[@i_447]) && ((x2_354 = x2_384[@i_447]) && ((x3_353 = x3_383[@i_447]) && ((x4_352 = x4_382[@i_447]) && (x5_351 = x5_381[@i_447]))))) then
      (
        let sk_s: hash0 = r_380[@i_447] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_446 <= NU suchthat defined(x1_391[@i_446], x2_390[@i_446], x3_389[@i_446], x4_388[@i_446], x5_387[@i_446], r_386[@i_446]) && ((x1_355 = x1_391[@i_446]) && ((x2_354 = x2_390[@i_446]) && ((x3_353 = x3_389[@i_446]) && ((x4_352 = x4_388[@i_446]) && (x5_351 = x5_387[@i_446]))))) then
      (
        let sk_s: hash0 = r_386[@i_446] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_445 <= NU suchthat defined(x1_397[@i_445], x2_396[@i_445], x3_395[@i_445], x4_394[@i_445], x5_393[@i_445], r_392[@i_445]) && ((x1_355 = x1_397[@i_445]) && ((x2_354 = x2_396[@i_445]) && ((x3_353 = x3_395[@i_445]) && ((x4_352 = x4_394[@i_445]) && (x5_351 = x5_393[@i_445]))))) then
      (
        let sk_s: hash0 = r_392[@i_445] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_444 <= NU suchthat defined(x1_403[@i_444], x2_402[@i_444], x3_401[@i_444], x4_400[@i_444], x5_399[@i_444], r_398[@i_444]) && ((x1_355 = x1_403[@i_444]) && ((x2_354 = x2_402[@i_444]) && ((x3_353 = x3_401[@i_444]) && ((x4_352 = x4_400[@i_444]) && (x5_351 = x5_399[@i_444]))))) then
      (
        let sk_s: hash0 = r_398[@i_444] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_443 <= NU suchthat defined(x1_409[@i_443], x2_408[@i_443], x3_407[@i_443], x4_406[@i_443], x5_405[@i_443], r_404[@i_443]) && ((x1_355 = x1_409[@i_443]) && ((x2_354 = x2_408[@i_443]) && ((x3_353 = x3_407[@i_443]) && ((x4_352 = x4_406[@i_443]) && (x5_351 = x5_405[@i_443]))))) then
      (
        let sk_s: hash0 = r_404[@i_443] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_442 <= NU suchthat defined(x1_415[@i_442], x2_414[@i_442], x3_413[@i_442], x4_412[@i_442], x5_411[@i_442], r_410[@i_442]) && ((x1_355 = x1_415[@i_442]) && ((x2_354 = x2_414[@i_442]) && ((x3_353 = x3_413[@i_442]) && ((x4_352 = x4_412[@i_442]) && (x5_351 = x5_411[@i_442]))))) then
      (
        let sk_s: hash0 = r_410[@i_442] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      let x3_359: G = X_s in
      let x4_358: G = Y in
      let x5_357: G = K_s in
      find [unique] @i_467 <= qH0 suchthat defined(x1_343[@i_467], x2_342[@i_467], x3_341[@i_467], x4_340[@i_467], x5_339[@i_467], r_338[@i_467]) && ((x1_361 = x1_343[@i_467]) && ((x2_360 = x2_342[@i_467]) && ((x3_359 = x3_341[@i_467]) && ((x4_358 = x4_340[@i_467]) && (x5_357 = x5_339[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_466 <= NP suchthat defined(x1_349[@i_466], x2_348[@i_466], x3_347[@i_466], x4_346[@i_466], x5_345[@i_466], r_344[@i_466]) && ((x1_361 = x1_349[@i_466]) && ((x2_360 = x2_348[@i_466]) && ((x3_359 = x3_347[@i_466]) && ((x4_358 = x4_346[@i_466]) && (x5_357 = x5_345[@i_466]))))) then
      (
        let sk_s: hash0 = r_344[@i_466] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_465 <= NS suchthat defined(x1_355[@i_465], x2_354[@i_465], x3_353[@i_465], x4_352[@i_465], x5_351[@i_465], r_350[@i_465]) && ((x1_361 = x1_355[@i_465]) && ((x2_360 = x2_354[@i_465]) && ((x3_359 = x3_353[@i_465]) && ((x4_358 = x4_352[@i_465]) && (x5_357 = x5_351[@i_465]))))) then
      (
        let sk_s: hash0 = r_350[@i_465] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_464 <= NS suchthat defined(x1_361[@i_464], x2_360[@i_464], x3_359[@i_464], x4_358[@i_464], x5_357[@i_464], r_356[@i_464]) && ((x1_361 = x1_361[@i_464]) && ((x2_360 = x2_360[@i_464]) && ((x3_359 = x3_359[@i_464]) && ((x4_358 = x4_358[@i_464]) && (x5_357 = x5_357[@i_464]))))) then
      (
        let sk_s: hash0 = r_356[@i_464] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_463 <= NU suchthat defined(x1_367[@i_463], x2_366[@i_463], x3_365[@i_463], x4_364[@i_463], x5_363[@i_463], r_362[@i_463]) && ((x1_361 = x1_367[@i_463]) && ((x2_360 = x2_366[@i_463]) && ((x3_359 = x3_365[@i_463]) && ((x4_358 = x4_364[@i_463]) && (x5_357 = x5_363[@i_463]))))) then
      (
        let sk_s: hash0 = r_362[@i_463] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_462 <= NU suchthat defined(x1_373[@i_462], x2_372[@i_462], x3_371[@i_462], x4_370[@i_462], x5_369[@i_462], r_368[@i_462]) && ((x1_361 = x1_373[@i_462]) && ((x2_360 = x2_372[@i_462]) && ((x3_359 = x3_371[@i_462]) && ((x4_358 = x4_370[@i_462]) && (x5_357 = x5_369[@i_462]))))) then
      (
        let sk_s: hash0 = r_368[@i_462] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_461 <= NU suchthat defined(x1_379[@i_461], x2_378[@i_461], x3_377[@i_461], x4_376[@i_461], x5_375[@i_461], r_374[@i_461]) && ((x1_361 = x1_379[@i_461]) && ((x2_360 = x2_378[@i_461]) && ((x3_359 = x3_377[@i_461]) && ((x4_358 = x4_376[@i_461]) && (x5_357 = x5_375[@i_461]))))) then
      (
        let sk_s: hash0 = r_374[@i_461] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_460 <= NU suchthat defined(x1_385[@i_460], x2_384[@i_460], x3_383[@i_460], x4_382[@i_460], x5_381[@i_460], r_380[@i_460]) && ((x1_361 = x1_385[@i_460]) && ((x2_360 = x2_384[@i_460]) && ((x3_359 = x3_383[@i_460]) && ((x4_358 = x4_382[@i_460]) && (x5_357 = x5_381[@i_460]))))) then
      (
        let sk_s: hash0 = r_380[@i_460] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_459 <= NU suchthat defined(x1_391[@i_459], x2_390[@i_459], x3_389[@i_459], x4_388[@i_459], x5_387[@i_459], r_386[@i_459]) && ((x1_361 = x1_391[@i_459]) && ((x2_360 = x2_390[@i_459]) && ((x3_359 = x3_389[@i_459]) && ((x4_358 = x4_388[@i_459]) && (x5_357 = x5_387[@i_459]))))) then
      (
        let sk_s: hash0 = r_386[@i_459] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_458 <= NU suchthat defined(x1_397[@i_458], x2_396[@i_458], x3_395[@i_458], x4_394[@i_458], x5_393[@i_458], r_392[@i_458]) && ((x1_361 = x1_397[@i_458]) && ((x2_360 = x2_396[@i_458]) && ((x3_359 = x3_395[@i_458]) && ((x4_358 = x4_394[@i_458]) && (x5_357 = x5_393[@i_458]))))) then
      (
        let sk_s: hash0 = r_392[@i_458] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_457 <= NU suchthat defined(x1_403[@i_457], x2_402[@i_457], x3_401[@i_457], x4_400[@i_457], x5_399[@i_457], r_398[@i_457]) && ((x1_361 = x1_403[@i_457]) && ((x2_360 = x2_402[@i_457]) && ((x3_359 = x3_401[@i_457]) && ((x4_358 = x4_400[@i_457]) && (x5_357 = x5_399[@i_457]))))) then
      (
        let sk_s: hash0 = r_398[@i_457] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_456 <= NU suchthat defined(x1_409[@i_456], x2_408[@i_456], x3_407[@i_456], x4_406[@i_456], x5_405[@i_456], r_404[@i_456]) && ((x1_361 = x1_409[@i_456]) && ((x2_360 = x2_408[@i_456]) && ((x3_359 = x3_407[@i_456]) && ((x4_358 = x4_406[@i_456]) && (x5_357 = x5_405[@i_456]))))) then
      (
        let sk_s: hash0 = r_404[@i_456] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind @i_455 <= NU suchthat defined(x1_415[@i_455], x2_414[@i_455], x3_413[@i_455], x4_412[@i_455], x5_411[@i_455], r_410[@i_455]) && ((x1_361 = x1_415[@i_455]) && ((x2_360 = x2_414[@i_455]) && ((x3_359 = x3_413[@i_455]) && ((x4_358 = x4_412[@i_455]) && (x5_357 = x5_411[@i_455]))))) then
      (
        let sk_s: hash0 = r_410[@i_455] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  let x3_347: G = Xp in
  let x4_346: G = Yp in
  let x5_345: G = Kp in
  find [unique] @i_441 <= qH0 suchthat defined(x1_343[@i_441], x2_342[@i_441], x3_341[@i_441], x4_340[@i_441], x5_339[@i_441], r_338[@i_441]) && ((x1_349 = x1_343[@i_441]) && ((x2_348 = x2_342[@i_441]) && ((x3_347 = x3_341[@i_441]) && ((x4_346 = x4_340[@i_441]) && (x5_345 = x5_339[@i_441]))))) then
  (
    let sk_p: hash0 = r_338[@i_441] in
    out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
  )
  orfind @i_440 <= NP suchthat defined(x1_349[@i_440], x2_348[@i_440], x3_347[@i_440], x4_346[@i_440], x5_345[@i_440], r_344[@i_440]) && ((x1_349 = x1_349[@i_440]) && ((x2_348 = x2_348[@i_440]) && ((x3_347 = x3_347[@i_440]) && ((x4_346 = x4_346[@i_440]) && (x5_345 = x5_345[@i_440]))))) then
  (
    let sk_p: hash0 = r_344[@i_440] in
    out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
  )
  orfind @i_439 <= NS suchthat defined(x1_355[@i_439], x2_354[@i_439], x3_353[@i_439], x4_352[@i_439], x5_351[@i_439], r_350[@i_439]) && ((x1_349 = x1_355[@i_439]) && ((x2_348 = x2_354[@i_439]) && ((x3_347 = x3_353[@i_439]) && ((x4_346 = x4_352[@i_439]) && (x5_345 = x5_351[@i_439]))))) then
  (
    let sk_p: hash0 = r_350[@i_439] in
    out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
  )
  orfind @i_438 <= NS suchthat defined(x1_361[@i_438], x2_360[@i_438], x3_359[@i_438], x4_358[@i_438], x5_357[@i_438], r_356[@i_438]) && ((x1_349 = x1_361[@i_438]) && ((x2_348 = x2_360[@i_438]) && ((x3_347 = x3_359[@i_438]) && ((x4_346 = x4_358[@i_438]) && (x5_345 = x5_357[@i_438]))))) then
  (
    let sk_p: hash0 = r_356[@i_438] in
    out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
  )
  orfind @i_437 <= NU suchthat defined(x1_367[@i_437], x2_366[@i_437], x3_365[@i_437], x4_364[@i_437], x5_363[@i_437], r_362[@i_437]) && ((x1_349 = x1_367[@i_437]) && ((x2_348 = x2_366[@i_437]) && ((x3_347 = x3_365[@i_437]) && ((x4_346 = x4_364[@i_437]) && (x5_345 = x5_363[@i_437]))))) then
  (
    let sk_p: hash0 = r_362[@i_437] in
    out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
  )
  orfind @i_436 <= NU suchthat defined(x1_373[@i_436], x2_372[@i_436], x3_371[@i_436], x4_370[@i_436], x5_369[@i_436], r_368[@i_436]) && ((x1_349 = x1_373[@i_436]) && ((x2_348 = x2_372[@i_436]) && ((x3_347 = x3_371[@i_436]) && ((x4_346 = x4_370[@i_436]) && (x5_345 = x5_369[@i_436]))))) then
  (
    let sk_p: hash0 = r_368[@i_436] in
    out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
  )
  orfind @i_435 <= NU suchthat defined(x1_379[@i_435], x2_378[@i_435], x3_377[@i_435], x4_376[@i_435], x5_375[@i_435], r_374[@i_435]) && ((x1_349 = x1_379[@i_435]) && ((x2_348 = x2_378[@i_435]) && ((x3_347 = x3_377[@i_435]) && ((x4_346 = x4_376[@i_435]) && (x5_345 = x5_375[@i_435]))))) then
  (
    let sk_p: hash0 = r_374[@i_435] in
    out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
  )
  orfind @i_434 <= NU suchthat defined(x1_385[@i_434], x2_384[@i_434], x3_383[@i_434], x4_382[@i_434], x5_381[@i_434], r_380[@i_434]) && ((x1_349 = x1_385[@i_434]) && ((x2_348 = x2_384[@i_434]) && ((x3_347 = x3_383[@i_434]) && ((x4_346 = x4_382[@i_434]) && (x5_345 = x5_381[@i_434]))))) then
  (
    let sk_p: hash0 = r_380[@i_434] in
    out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
  )
  orfind @i_433 <= NU suchthat defined(x1_391[@i_433], x2_390[@i_433], x3_389[@i_433], x4_388[@i_433], x5_387[@i_433], r_386[@i_433]) && ((x1_349 = x1_391[@i_433]) && ((x2_348 = x2_390[@i_433]) && ((x3_347 = x3_389[@i_433]) && ((x4_346 = x4_388[@i_433]) && (x5_345 = x5_387[@i_433]))))) then
  (
    let sk_p: hash0 = r_386[@i_433] in
    out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
  )
  orfind @i_432 <= NU suchthat defined(x1_397[@i_432], x2_396[@i_432], x3_395[@i_432], x4_394[@i_432], x5_393[@i_432], r_392[@i_432]) && ((x1_349 = x1_397[@i_432]) && ((x2_348 = x2_396[@i_432]) && ((x3_347 = x3_395[@i_432]) && ((x4_346 = x4_394[@i_432]) && (x5_345 = x5_393[@i_432]))))) then
  (
    let sk_p: hash0 = r_392[@i_432] in
    out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
  )
  orfind @i_431 <= NU suchthat defined(x1_403[@i_431], x2_402[@i_431], x3_401[@i_431], x4_400[@i_431], x5_399[@i_431], r_398[@i_431]) && ((x1_349 = x1_403[@i_431]) && ((x2_348 = x2_402[@i_431]) && ((x3_347 = x3_401[@i_431]) && ((x4_346 = x4_400[@i_431]) && (x5_345 = x5_399[@i_431]))))) then
  (
    let sk_p: hash0 = r_398[@i_431] in
    out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
  )
  orfind @i_430 <= NU suchthat defined(x1_409[@i_430], x2_408[@i_430], x3_407[@i_430], x4_406[@i_430], x5_405[@i_430], r_404[@i_430]) && ((x1_349 = x1_409[@i_430]) && ((x2_348 = x2_408[@i_430]) && ((x3_347 = x3_407[@i_430]) && ((x4_346 = x4_406[@i_430]) && (x5_345 = x5_405[@i_430]))))) then
  (
    let sk_p: hash0 = r_404[@i_430] in
    out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
  )
  orfind @i_429 <= NU suchthat defined(x1_415[@i_429], x2_414[@i_429], x3_413[@i_429], x4_412[@i_429], x5_411[@i_429], r_410[@i_429]) && ((x1_349 = x1_415[@i_429]) && ((x2_348 = x2_414[@i_429]) && ((x3_347 = x3_413[@i_429]) && ((x4_346 = x4_412[@i_429]) && (x5_345 = x5_411[@i_429]))))) then
  (
    let sk_p: hash0 = r_410[@i_429] in
    out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
  )
  else
    new r_344: hash0;
    let sk_p: hash0 = r_344 in
    out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  let @2_x_181: G = cst_G in
  let @2_ke_180: passwd = cst_passwd in
  find [unique] @i_210 <= qD suchthat defined(@2_kd[@i_210], @2_m[@i_210], @2_m_178[@i_210], @2_kd_177[@i_210], @2_r4_176[@i_210]) && ((@2_x = @2_r4_176[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(pw, Ystar_u[@i_206], @2_m_190[@i_206], @2_kd_189[@i_206], @2_r4_188[@i_206]) && ((@2_x = @2_r4_188[@i_206]) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_ke_180[@i_204], @2_x_181[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], pw, xp[@i_203], xp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], pw, y[@i_202], y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  let @2_m_178: G = cst_G in
  let @2_kd_177: passwd = cst_passwd in
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @2_kd_177[@i_200], @2_m_178[@i_200], @2_r4_176[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @2_r4_176[@i_200])
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], pw, @2_kd_189[@i_196], @2_m_190[@i_196], @2_r4_188[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @2_r4_188[@i_196])
  orfind @i_194 <= qE suchthat defined(@2_ke[@i_194], @2_x[@i_194], @2_x_181[@i_194], @2_ke_180[@i_194], @2_r2_179[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(pw, Yp[@i_193], xp[@i_193], xp[@i_193], @2_r2_182[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(pw, Y[@i_192], y[@i_192], y[@i_192], @2_r2_185[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @2_r4_176: G;
    out(@2_c4[!_61], @2_r4_176)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_343: host = x1 in
  let x2_342: host = x2 in
  let x3_341: G = x3 in
  let x4_340: G = x4 in
  let x5_339: G = x5 in
  find [unique] @i_428 <= qH0 suchthat defined(x1_343[@i_428], x2_342[@i_428], x3_341[@i_428], x4_340[@i_428], x5_339[@i_428], r_338[@i_428]) && ((x1_343 = x1_343[@i_428]) && ((x2_342 = x2_342[@i_428]) && ((x3_341 = x3_341[@i_428]) && ((x4_340 = x4_340[@i_428]) && (x5_339 = x5_339[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(x1_349[@i_427], x2_348[@i_427], x3_347[@i_427], x4_346[@i_427], x5_345[@i_427], r_344[@i_427]) && ((x1_343 = x1_349[@i_427]) && ((x2_342 = x2_348[@i_427]) && ((x3_341 = x3_347[@i_427]) && ((x4_340 = x4_346[@i_427]) && (x5_339 = x5_345[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(x1_355[@i_426], x2_354[@i_426], x3_353[@i_426], x4_352[@i_426], x5_351[@i_426], r_350[@i_426]) && ((x1_343 = x1_355[@i_426]) && ((x2_342 = x2_354[@i_426]) && ((x3_341 = x3_353[@i_426]) && ((x4_340 = x4_352[@i_426]) && (x5_339 = x5_351[@i_426]))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(x1_361[@i_425], x2_360[@i_425], x3_359[@i_425], x4_358[@i_425], x5_357[@i_425], r_356[@i_425]) && ((x1_343 = x1_361[@i_425]) && ((x2_342 = x2_360[@i_425]) && ((x3_341 = x3_359[@i_425]) && ((x4_340 = x4_358[@i_425]) && (x5_339 = x5_357[@i_425]))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(x1_367[@i_424], x2_366[@i_424], x3_365[@i_424], x4_364[@i_424], x5_363[@i_424], r_362[@i_424]) && ((x1_343 = x1_367[@i_424]) && ((x2_342 = x2_366[@i_424]) && ((x3_341 = x3_365[@i_424]) && ((x4_340 = x4_364[@i_424]) && (x5_339 = x5_363[@i_424]))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(x1_373[@i_423], x2_372[@i_423], x3_371[@i_423], x4_370[@i_423], x5_369[@i_423], r_368[@i_423]) && ((x1_343 = x1_373[@i_423]) && ((x2_342 = x2_372[@i_423]) && ((x3_341 = x3_371[@i_423]) && ((x4_340 = x4_370[@i_423]) && (x5_339 = x5_369[@i_423]))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(x1_379[@i_422], x2_378[@i_422], x3_377[@i_422], x4_376[@i_422], x5_375[@i_422], r_374[@i_422]) && ((x1_343 = x1_379[@i_422]) && ((x2_342 = x2_378[@i_422]) && ((x3_341 = x3_377[@i_422]) && ((x4_340 = x4_376[@i_422]) && (x5_339 = x5_375[@i_422]))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(x1_385[@i_421], x2_384[@i_421], x3_383[@i_421], x4_382[@i_421], x5_381[@i_421], r_380[@i_421]) && ((x1_343 = x1_385[@i_421]) && ((x2_342 = x2_384[@i_421]) && ((x3_341 = x3_383[@i_421]) && ((x4_340 = x4_382[@i_421]) && (x5_339 = x5_381[@i_421]))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(x1_391[@i_420], x2_390[@i_420], x3_389[@i_420], x4_388[@i_420], x5_387[@i_420], r_386[@i_420]) && ((x1_343 = x1_391[@i_420]) && ((x2_342 = x2_390[@i_420]) && ((x3_341 = x3_389[@i_420]) && ((x4_340 = x4_388[@i_420]) && (x5_339 = x5_387[@i_420]))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(x1_397[@i_419], x2_396[@i_419], x3_395[@i_419], x4_394[@i_419], x5_393[@i_419], r_392[@i_419]) && ((x1_343 = x1_397[@i_419]) && ((x2_342 = x2_396[@i_419]) && ((x3_341 = x3_395[@i_419]) && ((x4_340 = x4_394[@i_419]) && (x5_339 = x5_393[@i_419]))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(x1_403[@i_418], x2_402[@i_418], x3_401[@i_418], x4_400[@i_418], x5_399[@i_418], r_398[@i_418]) && ((x1_343 = x1_403[@i_418]) && ((x2_342 = x2_402[@i_418]) && ((x3_341 = x3_401[@i_418]) && ((x4_340 = x4_400[@i_418]) && (x5_339 = x5_399[@i_418]))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(x1_409[@i_417], x2_408[@i_417], x3_407[@i_417], x4_406[@i_417], x5_405[@i_417], r_404[@i_417]) && ((x1_343 = x1_409[@i_417]) && ((x2_342 = x2_408[@i_417]) && ((x3_341 = x3_407[@i_417]) && ((x4_340 = x4_406[@i_417]) && (x5_339 = x5_405[@i_417]))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(x1_415[@i_416], x2_414[@i_416], x3_413[@i_416], x4_412[@i_416], x5_411[@i_416], r_410[@i_416]) && ((x1_343 = x1_415[@i_416]) && ((x2_342 = x2_414[@i_416]) && ((x3_341 = x3_413[@i_416]) && ((x4_340 = x4_412[@i_416]) && (x5_339 = x5_411[@i_416]))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying simplify [Excluding set(dist 14->15, proba <= 10. * NU * NP / |exponent| + 2. * NS * NP / |exponent| + qH0 * NP / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + 8.5 * NU * NU / |G| + 3. * NS * NU / |G| + 2. * NP * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NP * qD / |G| + qD * NP / |exponent| + 1. / |exponent| * NP + 15. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + NU * qH1 / |hash1| + NS * NP / |G| + qD * NU / |G| + 0.5 * qD * qD / |G|)] yields

Game 15 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  let @2_m_190: G = cst_G in
  let @2_kd_189: passwd = cst_passwd in
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @2_r4_176[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = @2_r4_176[@i_240] in
    let K_u: G = exp(@2_r4_176[@i_240], x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@2_r4_176[@i_240] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      let x3_377: G = X in
      let x4_376: G = @2_r4_176[@i_240] in
      let x5_375: G = K_u in
      find [unique] @i_506 <= qH0 suchthat defined(x1_343[@i_506], x2_342[@i_506], x3_341[@i_506], x4_340[@i_506], x5_339[@i_506], r_338[@i_506]) && ((x1_379 = x1_343[@i_506]) && ((x2_378 = x2_342[@i_506]) && ((x3_377 = x3_341[@i_506]) && ((x4_376 = x4_340[@i_506]) && (x5_375 = x5_339[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let x1_373: host = U in
      let x2_372: host = S in
      let x3_371: G = X in
      let x4_370: G = @2_r4_176[@i_240] in
      let x5_369: G = K_u in
      find [unique] @i_493 <= qH0 suchthat defined(x1_343[@i_493], x2_342[@i_493], x3_341[@i_493], x4_340[@i_493], x5_339[@i_493], r_338[@i_493]) && ((x1_373 = x1_343[@i_493]) && ((x2_372 = x2_342[@i_493]) && ((x3_371 = x3_341[@i_493]) && ((x4_370 = x4_340[@i_493]) && (x5_369 = x5_339[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @2_r4_188[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = @2_r4_188[@i_236] in
    let K_u: G = exp(@2_r4_188[@i_236], x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@2_r4_188[@i_236] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      let x3_389: G = X in
      let x4_388: G = @2_r4_188[@i_236] in
      let x5_387: G = K_u in
      find [unique] @i_532 <= qH0 suchthat defined(x1_343[@i_532], x2_342[@i_532], x3_341[@i_532], x4_340[@i_532], x5_339[@i_532], r_338[@i_532]) && ((x1_391 = x1_343[@i_532]) && ((x2_390 = x2_342[@i_532]) && ((x3_389 = x3_341[@i_532]) && ((x4_388 = x4_340[@i_532]) && (x5_387 = x5_339[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let x1_385: host = U in
      let x2_384: host = S in
      let x3_383: G = X in
      let x4_382: G = @2_r4_188[@i_236] in
      let x5_381: G = K_u in
      find [unique] @i_519 <= qH0 suchthat defined(x1_343[@i_519], x2_342[@i_519], x3_341[@i_519], x4_340[@i_519], x5_339[@i_519], r_338[@i_519]) && ((x1_385 = x1_343[@i_519]) && ((x2_384 = x2_342[@i_519]) && ((x3_383 = x3_341[@i_519]) && ((x4_382 = x4_340[@i_519]) && (x5_381 = x5_339[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      let x3_401: G = X in
      let x4_400: G = Yp[@i_233] in
      let x5_399: G = K_u in
      find [unique] @i_558 <= qH0 suchthat defined(x1_343[@i_558], x2_342[@i_558], x3_341[@i_558], x4_340[@i_558], x5_339[@i_558], r_338[@i_558]) && ((x1_403 = x1_343[@i_558]) && ((x2_402 = x2_342[@i_558]) && ((x3_401 = x3_341[@i_558]) && ((x4_400 = x4_340[@i_558]) && (x5_399 = x5_339[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let x1_397: host = U in
      let x2_396: host = S in
      let x3_395: G = X in
      let x4_394: G = Yp[@i_233] in
      let x5_393: G = K_u in
      find [unique] @i_545 <= qH0 suchthat defined(x1_343[@i_545], x2_342[@i_545], x3_341[@i_545], x4_340[@i_545], x5_339[@i_545], r_338[@i_545]) && ((x1_397 = x1_343[@i_545]) && ((x2_396 = x2_342[@i_545]) && ((x3_395 = x3_341[@i_545]) && ((x4_394 = x4_340[@i_545]) && (x5_393 = x5_339[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      let x3_413: G = X in
      let x4_412: G = Y[@i_232] in
      let x5_411: G = K_u in
      find [unique] @i_584 <= qH0 suchthat defined(x1_343[@i_584], x2_342[@i_584], x3_341[@i_584], x4_340[@i_584], x5_339[@i_584], r_338[@i_584]) && ((x1_415 = x1_343[@i_584]) && ((x2_414 = x2_342[@i_584]) && ((x3_413 = x3_341[@i_584]) && ((x4_412 = x4_340[@i_584]) && (x5_411 = x5_339[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let @i_582 <= NS = @i_232 in
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      new r1_94: hash1;
      let x1_409: host = U in
      let x2_408: host = S in
      let x3_407: G = X in
      let x4_406: G = Y[@i_232] in
      let x5_405: G = K_u in
      find [unique] @i_571 <= qH0 suchthat defined(x1_343[@i_571], x2_342[@i_571], x3_341[@i_571], x4_340[@i_571], x5_339[@i_571], r_338[@i_571]) && ((x1_409 = x1_343[@i_571]) && ((x2_408 = x2_342[@i_571]) && ((x3_407 = x3_341[@i_571]) && ((x4_406 = x4_340[@i_571]) && (x5_405 = x5_339[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
  )
  else
    new @2_r4_188: G;
    let Y_u: G = @2_r4_188 in
    let K_u: G = exp(@2_r4_188, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    let x3_365: G = X in
    let x4_364: G = @2_r4_188 in
    let x5_363: G = K_u in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, sk_u);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      let x3_353: G = X_s in
      let x4_352: G = Y in
      let x5_351: G = K_s in
      find [unique] @i_454 <= qH0 suchthat defined(x1_343[@i_454], x2_342[@i_454], x3_341[@i_454], x4_340[@i_454], x5_339[@i_454], r_338[@i_454]) && ((x1_355 = x1_343[@i_454]) && ((x2_354 = x2_342[@i_454]) && ((x3_353 = x3_341[@i_454]) && ((x4_352 = x4_340[@i_454]) && (x5_351 = x5_339[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let @i_443 <= NU = j in
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let @i_442 <= NU = j in
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      let x3_359: G = X_s in
      let x4_358: G = Y in
      let x5_357: G = K_s in
      find [unique] @i_467 <= qH0 suchthat defined(x1_343[@i_467], x2_342[@i_467], x3_341[@i_467], x4_340[@i_467], x5_339[@i_467], r_338[@i_467]) && ((x1_361 = x1_343[@i_467]) && ((x2_360 = x2_342[@i_467]) && ((x3_359 = x3_341[@i_467]) && ((x4_358 = x4_340[@i_467]) && (x5_357 = x5_339[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let @i_456 <= NU = j in
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  let x3_347: G = Xp in
  let x4_346: G = Yp in
  let x5_345: G = Kp in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  let @2_x_181: G = cst_G in
  let @2_ke_180: passwd = cst_passwd in
  find [unique] @i_210 <= qD suchthat defined(@2_r4_176[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = @2_r4_176[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@2_r4_188[@i_206], Ystar_u[@i_206]) && ((@2_x = @2_r4_188[@i_206]) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  let @2_m_178: G = cst_G in
  let @2_kd_177: passwd = cst_passwd in
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @2_r4_176[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @2_r4_176[@i_200])
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @2_r4_188[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @2_r4_188[@i_196])
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @2_r4_176: G;
    out(@2_c4[!_61], @2_r4_176)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_343: host = x1 in
  let x2_342: host = x2 in
  let x3_341: G = x3 in
  let x4_340: G = x4 in
  let x5_339: G = x5 in
  find [unique] @i_428 <= qH0 suchthat defined(x1_343[@i_428], x2_342[@i_428], x3_341[@i_428], x4_340[@i_428], x5_339[@i_428], r_338[@i_428]) && ((x1_343 = x1_343[@i_428]) && ((x2_342 = x2_342[@i_428]) && ((x3_341 = x3_341[@i_428]) && ((x4_340 = x4_340[@i_428]) && (x5_339 = x5_339[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(x1_349[@i_427], x2_348[@i_427], x3_347[@i_427], x4_346[@i_427], x5_345[@i_427], r_344[@i_427]) && ((x1_343 = x1_349[@i_427]) && ((x2_342 = x2_348[@i_427]) && ((x3_341 = x3_347[@i_427]) && ((x4_340 = x4_346[@i_427]) && (x5_339 = x5_345[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(x1_355[@i_426], x2_354[@i_426], x3_353[@i_426], x4_352[@i_426], x5_351[@i_426], r_350[@i_426]) && ((x1_343 = x1_355[@i_426]) && ((x2_342 = x2_354[@i_426]) && ((x3_341 = x3_353[@i_426]) && ((x4_340 = x4_352[@i_426]) && (x5_339 = x5_351[@i_426]))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(x1_361[@i_425], x2_360[@i_425], x3_359[@i_425], x4_358[@i_425], x5_357[@i_425], r_356[@i_425]) && ((x1_343 = x1_361[@i_425]) && ((x2_342 = x2_360[@i_425]) && ((x3_341 = x3_359[@i_425]) && ((x4_340 = x4_358[@i_425]) && (x5_339 = x5_357[@i_425]))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(x1_367[@i_424], x2_366[@i_424], x3_365[@i_424], x4_364[@i_424], x5_363[@i_424], r_362[@i_424]) && ((x1_343 = x1_367[@i_424]) && ((x2_342 = x2_366[@i_424]) && ((x3_341 = x3_365[@i_424]) && ((x4_340 = x4_364[@i_424]) && (x5_339 = x5_363[@i_424]))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(x1_373[@i_423], x2_372[@i_423], x3_371[@i_423], x4_370[@i_423], x5_369[@i_423], r_368[@i_423]) && ((x1_343 = x1_373[@i_423]) && ((x2_342 = x2_372[@i_423]) && ((x3_341 = x3_371[@i_423]) && ((x4_340 = x4_370[@i_423]) && (x5_339 = x5_369[@i_423]))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(x1_379[@i_422], x2_378[@i_422], x3_377[@i_422], x4_376[@i_422], x5_375[@i_422], r_374[@i_422]) && ((x1_343 = x1_379[@i_422]) && ((x2_342 = x2_378[@i_422]) && ((x3_341 = x3_377[@i_422]) && ((x4_340 = x4_376[@i_422]) && (x5_339 = x5_375[@i_422]))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(x1_385[@i_421], x2_384[@i_421], x3_383[@i_421], x4_382[@i_421], x5_381[@i_421], r_380[@i_421]) && ((x1_343 = x1_385[@i_421]) && ((x2_342 = x2_384[@i_421]) && ((x3_341 = x3_383[@i_421]) && ((x4_340 = x4_382[@i_421]) && (x5_339 = x5_381[@i_421]))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(x1_391[@i_420], x2_390[@i_420], x3_389[@i_420], x4_388[@i_420], x5_387[@i_420], r_386[@i_420]) && ((x1_343 = x1_391[@i_420]) && ((x2_342 = x2_390[@i_420]) && ((x3_341 = x3_389[@i_420]) && ((x4_340 = x4_388[@i_420]) && (x5_339 = x5_387[@i_420]))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(x1_397[@i_419], x2_396[@i_419], x3_395[@i_419], x4_394[@i_419], x5_393[@i_419], r_392[@i_419]) && ((x1_343 = x1_397[@i_419]) && ((x2_342 = x2_396[@i_419]) && ((x3_341 = x3_395[@i_419]) && ((x4_340 = x4_394[@i_419]) && (x5_339 = x5_393[@i_419]))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(x1_403[@i_418], x2_402[@i_418], x3_401[@i_418], x4_400[@i_418], x5_399[@i_418], r_398[@i_418]) && ((x1_343 = x1_403[@i_418]) && ((x2_342 = x2_402[@i_418]) && ((x3_341 = x3_401[@i_418]) && ((x4_340 = x4_400[@i_418]) && (x5_339 = x5_399[@i_418]))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(x1_409[@i_417], x2_408[@i_417], x3_407[@i_417], x4_406[@i_417], x5_405[@i_417], r_404[@i_417]) && ((x1_343 = x1_409[@i_417]) && ((x2_342 = x2_408[@i_417]) && ((x3_341 = x3_407[@i_417]) && ((x4_340 = x4_406[@i_417]) && (x5_339 = x5_405[@i_417]))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(x1_415[@i_416], x2_414[@i_416], x3_413[@i_416], x4_412[@i_416], x5_411[@i_416], r_410[@i_416]) && ((x1_343 = x1_415[@i_416]) && ((x2_342 = x2_414[@i_416]) && ((x3_341 = x3_413[@i_416]) && ((x4_340 = x4_412[@i_416]) && (x5_339 = x5_411[@i_416]))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying move all binders yields

Game 16 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @2_r4_176[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = @2_r4_176[@i_240] in
    let K_u: G = exp(@2_r4_176[@i_240], x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@2_r4_176[@i_240] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      let x3_377: G = X in
      let x4_376: G = @2_r4_176[@i_240] in
      let x5_375: G = K_u in
      find [unique] @i_506 <= qH0 suchthat defined(x1_343[@i_506], x2_342[@i_506], x3_341[@i_506], x4_340[@i_506], x5_339[@i_506], r_338[@i_506]) && ((x1_379 = x1_343[@i_506]) && ((x2_378 = x2_342[@i_506]) && ((x3_377 = x3_341[@i_506]) && ((x4_376 = x4_340[@i_506]) && (x5_375 = x5_339[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      let x3_371: G = X in
      let x4_370: G = @2_r4_176[@i_240] in
      let x5_369: G = K_u in
      find [unique] @i_493 <= qH0 suchthat defined(x1_343[@i_493], x2_342[@i_493], x3_341[@i_493], x4_340[@i_493], x5_339[@i_493], r_338[@i_493]) && ((x1_373 = x1_343[@i_493]) && ((x2_372 = x2_342[@i_493]) && ((x3_371 = x3_341[@i_493]) && ((x4_370 = x4_340[@i_493]) && (x5_369 = x5_339[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @2_r4_188[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = @2_r4_188[@i_236] in
    let K_u: G = exp(@2_r4_188[@i_236], x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@2_r4_188[@i_236] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      let x3_389: G = X in
      let x4_388: G = @2_r4_188[@i_236] in
      let x5_387: G = K_u in
      find [unique] @i_532 <= qH0 suchthat defined(x1_343[@i_532], x2_342[@i_532], x3_341[@i_532], x4_340[@i_532], x5_339[@i_532], r_338[@i_532]) && ((x1_391 = x1_343[@i_532]) && ((x2_390 = x2_342[@i_532]) && ((x3_389 = x3_341[@i_532]) && ((x4_388 = x4_340[@i_532]) && (x5_387 = x5_339[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      let x3_383: G = X in
      let x4_382: G = @2_r4_188[@i_236] in
      let x5_381: G = K_u in
      find [unique] @i_519 <= qH0 suchthat defined(x1_343[@i_519], x2_342[@i_519], x3_341[@i_519], x4_340[@i_519], x5_339[@i_519], r_338[@i_519]) && ((x1_385 = x1_343[@i_519]) && ((x2_384 = x2_342[@i_519]) && ((x3_383 = x3_341[@i_519]) && ((x4_382 = x4_340[@i_519]) && (x5_381 = x5_339[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      let x3_401: G = X in
      let x4_400: G = Yp[@i_233] in
      let x5_399: G = K_u in
      find [unique] @i_558 <= qH0 suchthat defined(x1_343[@i_558], x2_342[@i_558], x3_341[@i_558], x4_340[@i_558], x5_339[@i_558], r_338[@i_558]) && ((x1_403 = x1_343[@i_558]) && ((x2_402 = x2_342[@i_558]) && ((x3_401 = x3_341[@i_558]) && ((x4_400 = x4_340[@i_558]) && (x5_399 = x5_339[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      let x3_395: G = X in
      let x4_394: G = Yp[@i_233] in
      let x5_393: G = K_u in
      find [unique] @i_545 <= qH0 suchthat defined(x1_343[@i_545], x2_342[@i_545], x3_341[@i_545], x4_340[@i_545], x5_339[@i_545], r_338[@i_545]) && ((x1_397 = x1_343[@i_545]) && ((x2_396 = x2_342[@i_545]) && ((x3_395 = x3_341[@i_545]) && ((x4_394 = x4_340[@i_545]) && (x5_393 = x5_339[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      let x3_413: G = X in
      let x4_412: G = Y[@i_232] in
      let x5_411: G = K_u in
      find [unique] @i_584 <= qH0 suchthat defined(x1_343[@i_584], x2_342[@i_584], x3_341[@i_584], x4_340[@i_584], x5_339[@i_584], r_338[@i_584]) && ((x1_415 = x1_343[@i_584]) && ((x2_414 = x2_342[@i_584]) && ((x3_413 = x3_341[@i_584]) && ((x4_412 = x4_340[@i_584]) && (x5_411 = x5_339[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let @i_582 <= NS = @i_232 in
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], sk_u);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      let x3_407: G = X in
      let x4_406: G = Y[@i_232] in
      let x5_405: G = K_u in
      find [unique] @i_571 <= qH0 suchthat defined(x1_343[@i_571], x2_342[@i_571], x3_341[@i_571], x4_340[@i_571], x5_339[@i_571], r_338[@i_571]) && ((x1_409 = x1_343[@i_571]) && ((x2_408 = x2_342[@i_571]) && ((x3_407 = x3_341[@i_571]) && ((x4_406 = x4_340[@i_571]) && (x5_405 = x5_339[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, sk_u);
        out(c6[!_57], r1_94)
  )
  else
    new @2_r4_188: G;
    let Y_u: G = @2_r4_188 in
    let K_u: G = exp(@2_r4_188, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    let x3_365: G = X in
    let x4_364: G = @2_r4_188 in
    let x5_363: G = K_u in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, sk_u);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      let x3_353: G = X_s in
      let x4_352: G = Y in
      let x5_351: G = K_s in
      find [unique] @i_454 <= qH0 suchthat defined(x1_343[@i_454], x2_342[@i_454], x3_341[@i_454], x4_340[@i_454], x5_339[@i_454], r_338[@i_454]) && ((x1_355 = x1_343[@i_454]) && ((x2_354 = x2_342[@i_454]) && ((x3_353 = x3_341[@i_454]) && ((x4_352 = x4_340[@i_454]) && (x5_351 = x5_339[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let @i_443 <= NU = j in
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let @i_442 <= NU = j in
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      let x3_359: G = X_s in
      let x4_358: G = Y in
      let x5_357: G = K_s in
      find [unique] @i_467 <= qH0 suchthat defined(x1_343[@i_467], x2_342[@i_467], x3_341[@i_467], x4_340[@i_467], x5_339[@i_467], r_338[@i_467]) && ((x1_361 = x1_343[@i_467]) && ((x2_360 = x2_342[@i_467]) && ((x3_359 = x3_341[@i_467]) && ((x4_358 = x4_340[@i_467]) && (x5_357 = x5_339[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let @i_456 <= NU = j in
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, sk_s)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  let x3_347: G = Xp in
  let x4_346: G = Yp in
  let x5_345: G = Kp in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@2_r4_176[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = @2_r4_176[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@2_r4_188[@i_206], Ystar_u[@i_206]) && ((@2_x = @2_r4_188[@i_206]) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @2_r4_176[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @2_r4_176[@i_200])
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @2_r4_188[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @2_r4_188[@i_196])
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @2_r4_176: G;
    out(@2_c4[!_61], @2_r4_176)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_343: host = x1 in
  let x2_342: host = x2 in
  let x3_341: G = x3 in
  let x4_340: G = x4 in
  let x5_339: G = x5 in
  find [unique] @i_428 <= qH0 suchthat defined(x1_343[@i_428], x2_342[@i_428], x3_341[@i_428], x4_340[@i_428], x5_339[@i_428], r_338[@i_428]) && ((x1_343 = x1_343[@i_428]) && ((x2_342 = x2_342[@i_428]) && ((x3_341 = x3_341[@i_428]) && ((x4_340 = x4_340[@i_428]) && (x5_339 = x5_339[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(x1_349[@i_427], x2_348[@i_427], x3_347[@i_427], x4_346[@i_427], x5_345[@i_427], r_344[@i_427]) && ((x1_343 = x1_349[@i_427]) && ((x2_342 = x2_348[@i_427]) && ((x3_341 = x3_347[@i_427]) && ((x4_340 = x4_346[@i_427]) && (x5_339 = x5_345[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(x1_355[@i_426], x2_354[@i_426], x3_353[@i_426], x4_352[@i_426], x5_351[@i_426], r_350[@i_426]) && ((x1_343 = x1_355[@i_426]) && ((x2_342 = x2_354[@i_426]) && ((x3_341 = x3_353[@i_426]) && ((x4_340 = x4_352[@i_426]) && (x5_339 = x5_351[@i_426]))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(x1_361[@i_425], x2_360[@i_425], x3_359[@i_425], x4_358[@i_425], x5_357[@i_425], r_356[@i_425]) && ((x1_343 = x1_361[@i_425]) && ((x2_342 = x2_360[@i_425]) && ((x3_341 = x3_359[@i_425]) && ((x4_340 = x4_358[@i_425]) && (x5_339 = x5_357[@i_425]))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(x1_367[@i_424], x2_366[@i_424], x3_365[@i_424], x4_364[@i_424], x5_363[@i_424], r_362[@i_424]) && ((x1_343 = x1_367[@i_424]) && ((x2_342 = x2_366[@i_424]) && ((x3_341 = x3_365[@i_424]) && ((x4_340 = x4_364[@i_424]) && (x5_339 = x5_363[@i_424]))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(x1_373[@i_423], x2_372[@i_423], x3_371[@i_423], x4_370[@i_423], x5_369[@i_423], r_368[@i_423]) && ((x1_343 = x1_373[@i_423]) && ((x2_342 = x2_372[@i_423]) && ((x3_341 = x3_371[@i_423]) && ((x4_340 = x4_370[@i_423]) && (x5_339 = x5_369[@i_423]))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(x1_379[@i_422], x2_378[@i_422], x3_377[@i_422], x4_376[@i_422], x5_375[@i_422], r_374[@i_422]) && ((x1_343 = x1_379[@i_422]) && ((x2_342 = x2_378[@i_422]) && ((x3_341 = x3_377[@i_422]) && ((x4_340 = x4_376[@i_422]) && (x5_339 = x5_375[@i_422]))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(x1_385[@i_421], x2_384[@i_421], x3_383[@i_421], x4_382[@i_421], x5_381[@i_421], r_380[@i_421]) && ((x1_343 = x1_385[@i_421]) && ((x2_342 = x2_384[@i_421]) && ((x3_341 = x3_383[@i_421]) && ((x4_340 = x4_382[@i_421]) && (x5_339 = x5_381[@i_421]))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(x1_391[@i_420], x2_390[@i_420], x3_389[@i_420], x4_388[@i_420], x5_387[@i_420], r_386[@i_420]) && ((x1_343 = x1_391[@i_420]) && ((x2_342 = x2_390[@i_420]) && ((x3_341 = x3_389[@i_420]) && ((x4_340 = x4_388[@i_420]) && (x5_339 = x5_387[@i_420]))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(x1_397[@i_419], x2_396[@i_419], x3_395[@i_419], x4_394[@i_419], x5_393[@i_419], r_392[@i_419]) && ((x1_343 = x1_397[@i_419]) && ((x2_342 = x2_396[@i_419]) && ((x3_341 = x3_395[@i_419]) && ((x4_340 = x4_394[@i_419]) && (x5_339 = x5_393[@i_419]))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(x1_403[@i_418], x2_402[@i_418], x3_401[@i_418], x4_400[@i_418], x5_399[@i_418], r_398[@i_418]) && ((x1_343 = x1_403[@i_418]) && ((x2_342 = x2_402[@i_418]) && ((x3_341 = x3_401[@i_418]) && ((x4_340 = x4_400[@i_418]) && (x5_339 = x5_399[@i_418]))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(x1_409[@i_417], x2_408[@i_417], x3_407[@i_417], x4_406[@i_417], x5_405[@i_417], r_404[@i_417]) && ((x1_343 = x1_409[@i_417]) && ((x2_342 = x2_408[@i_417]) && ((x3_341 = x3_407[@i_417]) && ((x4_340 = x4_406[@i_417]) && (x5_339 = x5_405[@i_417]))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(x1_415[@i_416], x2_414[@i_416], x3_413[@i_416], x4_412[@i_416], x5_411[@i_416], r_410[@i_416]) && ((x1_343 = x1_415[@i_416]) && ((x2_342 = x2_414[@i_416]) && ((x3_341 = x3_413[@i_416]) && ((x4_340 = x4_412[@i_416]) && (x5_339 = x5_411[@i_416]))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of useless yields

Game 17 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @2_r4_176[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = @2_r4_176[@i_240] in
    let K_u: G = exp(@2_r4_176[@i_240], x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@2_r4_176[@i_240] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      find [unique] @i_506 <= qH0 suchthat defined(x1[@i_506], x2[@i_506], x3[@i_506], x4[@i_506], x5[@i_506], x5_339[@i_506], x4_340[@i_506], x3_341[@i_506], x2_342[@i_506], x1_343[@i_506], r_338[@i_506]) && ((x1_379 = x1[@i_506]) && ((x2_378 = x2[@i_506]) && ((X = x3[@i_506]) && ((@2_r4_176[@i_240] = x4[@i_506]) && (K_u = x5[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_506]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_374);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      find [unique] @i_493 <= qH0 suchthat defined(x1[@i_493], x2[@i_493], x3[@i_493], x4[@i_493], x5[@i_493], x5_339[@i_493], x4_340[@i_493], x3_341[@i_493], x2_342[@i_493], x1_343[@i_493], r_338[@i_493]) && ((x1_373 = x1[@i_493]) && ((x2_372 = x2[@i_493]) && ((X = x3[@i_493]) && ((@2_r4_176[@i_240] = x4[@i_493]) && (K_u = x5[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_493]);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_368);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @2_r4_188[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = @2_r4_188[@i_236] in
    let K_u: G = exp(@2_r4_188[@i_236], x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@2_r4_188[@i_236] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      find [unique] @i_532 <= qH0 suchthat defined(x1[@i_532], x2[@i_532], x3[@i_532], x4[@i_532], x5[@i_532], x5_339[@i_532], x4_340[@i_532], x3_341[@i_532], x2_342[@i_532], x1_343[@i_532], r_338[@i_532]) && ((x1_391 = x1[@i_532]) && ((x2_390 = x2[@i_532]) && ((X = x3[@i_532]) && ((@2_r4_188[@i_236] = x4[@i_532]) && (K_u = x5[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_532]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_386);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      find [unique] @i_519 <= qH0 suchthat defined(x1[@i_519], x2[@i_519], x3[@i_519], x4[@i_519], x5[@i_519], x5_339[@i_519], x4_340[@i_519], x3_341[@i_519], x2_342[@i_519], x1_343[@i_519], r_338[@i_519]) && ((x1_385 = x1[@i_519]) && ((x2_384 = x2[@i_519]) && ((X = x3[@i_519]) && ((@2_r4_188[@i_236] = x4[@i_519]) && (K_u = x5[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_519]);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_380);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      find [unique] @i_558 <= qH0 suchthat defined(x1[@i_558], x2[@i_558], x3[@i_558], x4[@i_558], x5[@i_558], x5_339[@i_558], x4_340[@i_558], x3_341[@i_558], x2_342[@i_558], x1_343[@i_558], r_338[@i_558]) && ((x1_403 = x1[@i_558]) && ((x2_402 = x2[@i_558]) && ((X = x3[@i_558]) && ((Yp[@i_233] = x4[@i_558]) && (K_u = x5[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_558]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_398);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      find [unique] @i_545 <= qH0 suchthat defined(x1[@i_545], x2[@i_545], x3[@i_545], x4[@i_545], x5[@i_545], x5_339[@i_545], x4_340[@i_545], x3_341[@i_545], x2_342[@i_545], x1_343[@i_545], r_338[@i_545]) && ((x1_397 = x1[@i_545]) && ((x2_396 = x2[@i_545]) && ((X = x3[@i_545]) && ((Yp[@i_233] = x4[@i_545]) && (K_u = x5[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_545]);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_392);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      find [unique] @i_584 <= qH0 suchthat defined(x1[@i_584], x2[@i_584], x3[@i_584], x4[@i_584], x5[@i_584], x5_339[@i_584], x4_340[@i_584], x3_341[@i_584], x2_342[@i_584], x1_343[@i_584], r_338[@i_584]) && ((x1_415 = x1[@i_584]) && ((x2_414 = x2[@i_584]) && ((X = x3[@i_584]) && ((Y[@i_232] = x4[@i_584]) && (K_u = x5[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_584]);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_350[@i_232]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_410);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      find [unique] @i_571 <= qH0 suchthat defined(x1[@i_571], x2[@i_571], x3[@i_571], x4[@i_571], x5[@i_571], x5_339[@i_571], x4_340[@i_571], x3_341[@i_571], x2_342[@i_571], x1_343[@i_571], r_338[@i_571]) && ((x1_409 = x1[@i_571]) && ((x2_408 = x2[@i_571]) && ((X = x3[@i_571]) && ((Y[@i_232] = x4[@i_571]) && (K_u = x5[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_571]);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_404);
        out(c6[!_57], r1_94)
  )
  else
    new @2_r4_188: G;
    let Y_u: G = @2_r4_188 in
    let K_u: G = exp(@2_r4_188, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      find [unique] @i_454 <= qH0 suchthat defined(x1[@i_454], x2[@i_454], x3[@i_454], x4[@i_454], x5[@i_454], x5_339[@i_454], x4_340[@i_454], x3_341[@i_454], x2_342[@i_454], x1_343[@i_454], r_338[@i_454]) && ((x1_355 = x1[@i_454]) && ((x2_354 = x2[@i_454]) && ((X_s = x3[@i_454]) && ((Y = x4[@i_454]) && (K_s = x5[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_454])
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_410[j])
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_350)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], x5_339[@i_467], x4_340[@i_467], x3_341[@i_467], x2_342[@i_467], x1_343[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (K_s = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@2_r4_176[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = @2_r4_176[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@2_r4_188[@i_206], Ystar_u[@i_206]) && ((@2_x = @2_r4_188[@i_206]) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @2_r4_176[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @2_r4_176[@i_200])
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @2_r4_188[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @2_r4_188[@i_196])
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @2_r4_176: G;
    out(@2_c4[!_61], @2_r4_176)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_343: host = cst_host in
  let x2_342: host = cst_host in
  let x3_341: G = cst_G in
  let x4_340: G = cst_G in
  let x5_339: G = cst_G in
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], x5_339[@i_428], x4_340[@i_428], x3_341[@i_428], x2_342[@i_428], x1_343[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(Xp[@i_427], Yp[@i_427], Kp[@i_427], xp[@i_427], xp[@i_427], xp[@i_427], x1_349[@i_427], x2_348[@i_427], r_344[@i_427]) && ((x1 = x1_349[@i_427]) && ((x2 = x2_348[@i_427]) && ((x3 = Xp[@i_427]) && ((x4 = Yp[@i_427]) && (x5 = Kp[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(X_s[@i_426], Y[@i_426], K_s[@i_426], x1_355[@i_426], x1_355[@i_426], x1_355[@i_426], x1_355[@i_426], x2_354[@i_426], r_350[@i_426]) && ((x1 = x1_355[@i_426]) && ((x2 = x2_354[@i_426]) && ((x3 = X_s[@i_426]) && ((x4 = Y[@i_426]) && (x5 = K_s[@i_426]))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(X_s[@i_425], Y[@i_425], K_s[@i_425], x1_361[@i_425], x1_361[@i_425], x1_361[@i_425], x1_361[@i_425], x2_360[@i_425], r_356[@i_425]) && ((x1 = x1_361[@i_425]) && ((x2 = x2_360[@i_425]) && ((x3 = X_s[@i_425]) && ((x4 = Y[@i_425]) && (x5 = K_s[@i_425]))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(X[@i_424], @2_r4_188[@i_424], K_u[@i_424], @2_r4_188[@i_424], @2_r4_188[@i_424], @2_r4_188[@i_424], x1_367[@i_424], x2_366[@i_424], r_362[@i_424]) && ((x1 = x1_367[@i_424]) && ((x2 = x2_366[@i_424]) && ((x3 = X[@i_424]) && ((x4 = @2_r4_188[@i_424]) && (x5 = K_u[@i_424]))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(X[@i_423], @2_r4_176[@i_240[@i_423]], K_u[@i_423], x1_373[@i_423], x1_373[@i_423], x1_373[@i_423], x1_373[@i_423], x2_372[@i_423], r_368[@i_423]) && ((x1 = x1_373[@i_423]) && ((x2 = x2_372[@i_423]) && ((x3 = X[@i_423]) && ((x4 = @2_r4_176[@i_240[@i_423]]) && (x5 = K_u[@i_423]))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(X[@i_422], @2_r4_176[@i_240[@i_422]], K_u[@i_422], x1_379[@i_422], x1_379[@i_422], x1_379[@i_422], x1_379[@i_422], x2_378[@i_422], r_374[@i_422]) && ((x1 = x1_379[@i_422]) && ((x2 = x2_378[@i_422]) && ((x3 = X[@i_422]) && ((x4 = @2_r4_176[@i_240[@i_422]]) && (x5 = K_u[@i_422]))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(X[@i_421], @2_r4_188[@i_236[@i_421]], K_u[@i_421], x1_385[@i_421], x1_385[@i_421], x1_385[@i_421], x1_385[@i_421], x2_384[@i_421], r_380[@i_421]) && ((x1 = x1_385[@i_421]) && ((x2 = x2_384[@i_421]) && ((x3 = X[@i_421]) && ((x4 = @2_r4_188[@i_236[@i_421]]) && (x5 = K_u[@i_421]))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(X[@i_420], @2_r4_188[@i_236[@i_420]], K_u[@i_420], x1_391[@i_420], x1_391[@i_420], x1_391[@i_420], x1_391[@i_420], x2_390[@i_420], r_386[@i_420]) && ((x1 = x1_391[@i_420]) && ((x2 = x2_390[@i_420]) && ((x3 = X[@i_420]) && ((x4 = @2_r4_188[@i_236[@i_420]]) && (x5 = K_u[@i_420]))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(X[@i_419], Yp[@i_233[@i_419]], K_u[@i_419], x1_397[@i_419], x1_397[@i_419], x1_397[@i_419], x1_397[@i_419], x2_396[@i_419], r_392[@i_419]) && ((x1 = x1_397[@i_419]) && ((x2 = x2_396[@i_419]) && ((x3 = X[@i_419]) && ((x4 = Yp[@i_233[@i_419]]) && (x5 = K_u[@i_419]))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(X[@i_418], Yp[@i_233[@i_418]], K_u[@i_418], x1_403[@i_418], x1_403[@i_418], x1_403[@i_418], x1_403[@i_418], x2_402[@i_418], r_398[@i_418]) && ((x1 = x1_403[@i_418]) && ((x2 = x2_402[@i_418]) && ((x3 = X[@i_418]) && ((x4 = Yp[@i_233[@i_418]]) && (x5 = K_u[@i_418]))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(X[@i_417], Y[@i_232[@i_417]], K_u[@i_417], x1_409[@i_417], x1_409[@i_417], x1_409[@i_417], x1_409[@i_417], x2_408[@i_417], r_404[@i_417]) && ((x1 = x1_409[@i_417]) && ((x2 = x2_408[@i_417]) && ((x3 = X[@i_417]) && ((x4 = Y[@i_232[@i_417]]) && (x5 = K_u[@i_417]))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(X[@i_416], Y[@i_232[@i_416]], K_u[@i_416], x1_415[@i_416], x1_415[@i_416], x1_415[@i_416], x1_415[@i_416], x2_414[@i_416], r_410[@i_416]) && ((x1 = x1_415[@i_416]) && ((x2 = x2_414[@i_416]) && ((x3 = X[@i_416]) && ((x4 = Y[@i_232[@i_416]]) && (x5 = K_u[@i_416]))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying equivalence
equiv ! !_1 <= @1_N new @1_X: G; (
  @1_OX() := @1_X,
  ! !_2 <= @1_N' @1_OXm(@1_m: exponent) := exp(@1_X, @1_m))
<=(0)=>
      ! !_3 <= @1_N new @1_x: exponent; (
  @1_OX() := exp(g, @1_x),
  ! !_4 <= @1_N' @1_OXm(@1_m: exponent) := exp(g, mult(@1_x, @1_m)))
 yields

Game 18 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@1_x_737[@i_240], @2_m[@i_240], @2_kd[@i_240], @2_r4_176[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = exp(g, @1_x_737[@i_240]) in
    let K_u: G = exp(g, mult(@1_x_737[@i_240], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_737[@i_240]) = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      find [unique] @i_506 <= qH0 suchthat defined(x1[@i_506], x2[@i_506], x3[@i_506], x4[@i_506], x5[@i_506], x5_339[@i_506], x4_340[@i_506], x3_341[@i_506], x2_342[@i_506], x1_343[@i_506], r_338[@i_506]) && ((x1_379 = x1[@i_506]) && ((x2_378 = x2[@i_506]) && ((X = x3[@i_506]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_506]) && (K_u = x5[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_506]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_374);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      find [unique] @i_493 <= qH0 suchthat defined(x1[@i_493], x2[@i_493], x3[@i_493], x4[@i_493], x5[@i_493], x5_339[@i_493], x4_340[@i_493], x3_341[@i_493], x2_342[@i_493], x1_343[@i_493], r_338[@i_493]) && ((x1_373 = x1[@i_493]) && ((x2_372 = x2[@i_493]) && ((X = x3[@i_493]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_493]) && (K_u = x5[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_493]);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_368);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @2_r4_188[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = @2_r4_188[@i_236] in
    let K_u: G = exp(@2_r4_188[@i_236], x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@2_r4_188[@i_236] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      find [unique] @i_532 <= qH0 suchthat defined(x1[@i_532], x2[@i_532], x3[@i_532], x4[@i_532], x5[@i_532], x5_339[@i_532], x4_340[@i_532], x3_341[@i_532], x2_342[@i_532], x1_343[@i_532], r_338[@i_532]) && ((x1_391 = x1[@i_532]) && ((x2_390 = x2[@i_532]) && ((X = x3[@i_532]) && ((@2_r4_188[@i_236] = x4[@i_532]) && (K_u = x5[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_532]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_386);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      find [unique] @i_519 <= qH0 suchthat defined(x1[@i_519], x2[@i_519], x3[@i_519], x4[@i_519], x5[@i_519], x5_339[@i_519], x4_340[@i_519], x3_341[@i_519], x2_342[@i_519], x1_343[@i_519], r_338[@i_519]) && ((x1_385 = x1[@i_519]) && ((x2_384 = x2[@i_519]) && ((X = x3[@i_519]) && ((@2_r4_188[@i_236] = x4[@i_519]) && (K_u = x5[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_519]);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_380);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      find [unique] @i_558 <= qH0 suchthat defined(x1[@i_558], x2[@i_558], x3[@i_558], x4[@i_558], x5[@i_558], x5_339[@i_558], x4_340[@i_558], x3_341[@i_558], x2_342[@i_558], x1_343[@i_558], r_338[@i_558]) && ((x1_403 = x1[@i_558]) && ((x2_402 = x2[@i_558]) && ((X = x3[@i_558]) && ((Yp[@i_233] = x4[@i_558]) && (K_u = x5[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_558]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_398);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      find [unique] @i_545 <= qH0 suchthat defined(x1[@i_545], x2[@i_545], x3[@i_545], x4[@i_545], x5[@i_545], x5_339[@i_545], x4_340[@i_545], x3_341[@i_545], x2_342[@i_545], x1_343[@i_545], r_338[@i_545]) && ((x1_397 = x1[@i_545]) && ((x2_396 = x2[@i_545]) && ((X = x3[@i_545]) && ((Yp[@i_233] = x4[@i_545]) && (K_u = x5[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_545]);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_392);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      find [unique] @i_584 <= qH0 suchthat defined(x1[@i_584], x2[@i_584], x3[@i_584], x4[@i_584], x5[@i_584], x5_339[@i_584], x4_340[@i_584], x3_341[@i_584], x2_342[@i_584], x1_343[@i_584], r_338[@i_584]) && ((x1_415 = x1[@i_584]) && ((x2_414 = x2[@i_584]) && ((X = x3[@i_584]) && ((Y[@i_232] = x4[@i_584]) && (K_u = x5[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_584]);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_350[@i_232]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_410);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      find [unique] @i_571 <= qH0 suchthat defined(x1[@i_571], x2[@i_571], x3[@i_571], x4[@i_571], x5[@i_571], x5_339[@i_571], x4_340[@i_571], x3_341[@i_571], x2_342[@i_571], x1_343[@i_571], r_338[@i_571]) && ((x1_409 = x1[@i_571]) && ((x2_408 = x2[@i_571]) && ((X = x3[@i_571]) && ((Y[@i_232] = x4[@i_571]) && (K_u = x5[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_571]);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_404);
        out(c6[!_57], r1_94)
  )
  else
    new @2_r4_188: G;
    let Y_u: G = @2_r4_188 in
    let K_u: G = exp(@2_r4_188, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      find [unique] @i_454 <= qH0 suchthat defined(x1[@i_454], x2[@i_454], x3[@i_454], x4[@i_454], x5[@i_454], x5_339[@i_454], x4_340[@i_454], x3_341[@i_454], x2_342[@i_454], x1_343[@i_454], r_338[@i_454]) && ((x1_355 = x1[@i_454]) && ((x2_354 = x2[@i_454]) && ((X_s = x3[@i_454]) && ((Y = x4[@i_454]) && (K_s = x5[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_454])
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_410[j])
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_350)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], x5_339[@i_467], x4_340[@i_467], x3_341[@i_467], x2_342[@i_467], x1_343[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (K_s = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @2_r4_176[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = exp(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@2_r4_188[@i_206], Ystar_u[@i_206]) && ((@2_x = @2_r4_188[@i_206]) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@1_x_737[@i_200], @2_m[@i_200], @2_kd[@i_200], @2_r4_176[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], exp(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @2_r4_188[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @2_r4_188[@i_196])
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    let @2_r4_176: G = cst_G in
    out(@2_c4[!_61], exp(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_343: host = cst_host in
  let x2_342: host = cst_host in
  let x3_341: G = cst_G in
  let x4_340: G = cst_G in
  let x5_339: G = cst_G in
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], x5_339[@i_428], x4_340[@i_428], x3_341[@i_428], x2_342[@i_428], x1_343[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(Xp[@i_427], Yp[@i_427], Kp[@i_427], xp[@i_427], xp[@i_427], xp[@i_427], x1_349[@i_427], x2_348[@i_427], r_344[@i_427]) && ((x1 = x1_349[@i_427]) && ((x2 = x2_348[@i_427]) && ((x3 = Xp[@i_427]) && ((x4 = Yp[@i_427]) && (x5 = Kp[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(X_s[@i_426], Y[@i_426], K_s[@i_426], x1_355[@i_426], x1_355[@i_426], x1_355[@i_426], x1_355[@i_426], x2_354[@i_426], r_350[@i_426]) && ((x1 = x1_355[@i_426]) && ((x2 = x2_354[@i_426]) && ((x3 = X_s[@i_426]) && ((x4 = Y[@i_426]) && (x5 = K_s[@i_426]))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(X_s[@i_425], Y[@i_425], K_s[@i_425], x1_361[@i_425], x1_361[@i_425], x1_361[@i_425], x1_361[@i_425], x2_360[@i_425], r_356[@i_425]) && ((x1 = x1_361[@i_425]) && ((x2 = x2_360[@i_425]) && ((x3 = X_s[@i_425]) && ((x4 = Y[@i_425]) && (x5 = K_s[@i_425]))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(X[@i_424], @2_r4_188[@i_424], K_u[@i_424], @2_r4_188[@i_424], @2_r4_188[@i_424], @2_r4_188[@i_424], x1_367[@i_424], x2_366[@i_424], r_362[@i_424]) && ((x1 = x1_367[@i_424]) && ((x2 = x2_366[@i_424]) && ((x3 = X[@i_424]) && ((x4 = @2_r4_188[@i_424]) && (x5 = K_u[@i_424]))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(@1_x_737[@i_240[@i_423]], X[@i_423], @2_r4_176[@i_240[@i_423]], K_u[@i_423], x1_373[@i_423], x1_373[@i_423], x1_373[@i_423], x1_373[@i_423], x2_372[@i_423], r_368[@i_423]) && ((x1 = x1_373[@i_423]) && ((x2 = x2_372[@i_423]) && ((x3 = X[@i_423]) && ((x4 = exp(g, @1_x_737[@i_240[@i_423]])) && (x5 = K_u[@i_423]))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(@1_x_737[@i_240[@i_422]], X[@i_422], @2_r4_176[@i_240[@i_422]], K_u[@i_422], x1_379[@i_422], x1_379[@i_422], x1_379[@i_422], x1_379[@i_422], x2_378[@i_422], r_374[@i_422]) && ((x1 = x1_379[@i_422]) && ((x2 = x2_378[@i_422]) && ((x3 = X[@i_422]) && ((x4 = exp(g, @1_x_737[@i_240[@i_422]])) && (x5 = K_u[@i_422]))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(X[@i_421], @2_r4_188[@i_236[@i_421]], K_u[@i_421], x1_385[@i_421], x1_385[@i_421], x1_385[@i_421], x1_385[@i_421], x2_384[@i_421], r_380[@i_421]) && ((x1 = x1_385[@i_421]) && ((x2 = x2_384[@i_421]) && ((x3 = X[@i_421]) && ((x4 = @2_r4_188[@i_236[@i_421]]) && (x5 = K_u[@i_421]))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(X[@i_420], @2_r4_188[@i_236[@i_420]], K_u[@i_420], x1_391[@i_420], x1_391[@i_420], x1_391[@i_420], x1_391[@i_420], x2_390[@i_420], r_386[@i_420]) && ((x1 = x1_391[@i_420]) && ((x2 = x2_390[@i_420]) && ((x3 = X[@i_420]) && ((x4 = @2_r4_188[@i_236[@i_420]]) && (x5 = K_u[@i_420]))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(X[@i_419], Yp[@i_233[@i_419]], K_u[@i_419], x1_397[@i_419], x1_397[@i_419], x1_397[@i_419], x1_397[@i_419], x2_396[@i_419], r_392[@i_419]) && ((x1 = x1_397[@i_419]) && ((x2 = x2_396[@i_419]) && ((x3 = X[@i_419]) && ((x4 = Yp[@i_233[@i_419]]) && (x5 = K_u[@i_419]))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(X[@i_418], Yp[@i_233[@i_418]], K_u[@i_418], x1_403[@i_418], x1_403[@i_418], x1_403[@i_418], x1_403[@i_418], x2_402[@i_418], r_398[@i_418]) && ((x1 = x1_403[@i_418]) && ((x2 = x2_402[@i_418]) && ((x3 = X[@i_418]) && ((x4 = Yp[@i_233[@i_418]]) && (x5 = K_u[@i_418]))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(X[@i_417], Y[@i_232[@i_417]], K_u[@i_417], x1_409[@i_417], x1_409[@i_417], x1_409[@i_417], x1_409[@i_417], x2_408[@i_417], r_404[@i_417]) && ((x1 = x1_409[@i_417]) && ((x2 = x2_408[@i_417]) && ((x3 = X[@i_417]) && ((x4 = Y[@i_232[@i_417]]) && (x5 = K_u[@i_417]))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(X[@i_416], Y[@i_232[@i_416]], K_u[@i_416], x1_415[@i_416], x1_415[@i_416], x1_415[@i_416], x1_415[@i_416], x2_414[@i_416], r_410[@i_416]) && ((x1 = x1_415[@i_416]) && ((x2 = x2_414[@i_416]) && ((x3 = X[@i_416]) && ((x4 = Y[@i_232[@i_416]]) && (x5 = K_u[@i_416]))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of useless yields

Game 19 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@1_x_737[@i_240], @2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = exp(g, @1_x_737[@i_240]) in
    let K_u: G = exp(g, mult(@1_x_737[@i_240], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_737[@i_240]) = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      find [unique] @i_506 <= qH0 suchthat defined(x1[@i_506], x2[@i_506], x3[@i_506], x4[@i_506], x5[@i_506], x5_339[@i_506], x4_340[@i_506], x3_341[@i_506], x2_342[@i_506], x1_343[@i_506], r_338[@i_506]) && ((x1_379 = x1[@i_506]) && ((x2_378 = x2[@i_506]) && ((X = x3[@i_506]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_506]) && (K_u = x5[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_506]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_374);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      find [unique] @i_493 <= qH0 suchthat defined(x1[@i_493], x2[@i_493], x3[@i_493], x4[@i_493], x5[@i_493], x5_339[@i_493], x4_340[@i_493], x3_341[@i_493], x2_342[@i_493], x1_343[@i_493], r_338[@i_493]) && ((x1_373 = x1[@i_493]) && ((x2_372 = x2[@i_493]) && ((X = x3[@i_493]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_493]) && (K_u = x5[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_493]);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_368);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @2_r4_188[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = @2_r4_188[@i_236] in
    let K_u: G = exp(@2_r4_188[@i_236], x) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@2_r4_188[@i_236] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      find [unique] @i_532 <= qH0 suchthat defined(x1[@i_532], x2[@i_532], x3[@i_532], x4[@i_532], x5[@i_532], x5_339[@i_532], x4_340[@i_532], x3_341[@i_532], x2_342[@i_532], x1_343[@i_532], r_338[@i_532]) && ((x1_391 = x1[@i_532]) && ((x2_390 = x2[@i_532]) && ((X = x3[@i_532]) && ((@2_r4_188[@i_236] = x4[@i_532]) && (K_u = x5[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_532]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_386);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      find [unique] @i_519 <= qH0 suchthat defined(x1[@i_519], x2[@i_519], x3[@i_519], x4[@i_519], x5[@i_519], x5_339[@i_519], x4_340[@i_519], x3_341[@i_519], x2_342[@i_519], x1_343[@i_519], r_338[@i_519]) && ((x1_385 = x1[@i_519]) && ((x2_384 = x2[@i_519]) && ((X = x3[@i_519]) && ((@2_r4_188[@i_236] = x4[@i_519]) && (K_u = x5[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_519]);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_380);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      find [unique] @i_558 <= qH0 suchthat defined(x1[@i_558], x2[@i_558], x3[@i_558], x4[@i_558], x5[@i_558], x5_339[@i_558], x4_340[@i_558], x3_341[@i_558], x2_342[@i_558], x1_343[@i_558], r_338[@i_558]) && ((x1_403 = x1[@i_558]) && ((x2_402 = x2[@i_558]) && ((X = x3[@i_558]) && ((Yp[@i_233] = x4[@i_558]) && (K_u = x5[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_558]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_398);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      find [unique] @i_545 <= qH0 suchthat defined(x1[@i_545], x2[@i_545], x3[@i_545], x4[@i_545], x5[@i_545], x5_339[@i_545], x4_340[@i_545], x3_341[@i_545], x2_342[@i_545], x1_343[@i_545], r_338[@i_545]) && ((x1_397 = x1[@i_545]) && ((x2_396 = x2[@i_545]) && ((X = x3[@i_545]) && ((Yp[@i_233] = x4[@i_545]) && (K_u = x5[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_545]);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_392);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      find [unique] @i_584 <= qH0 suchthat defined(x1[@i_584], x2[@i_584], x3[@i_584], x4[@i_584], x5[@i_584], x5_339[@i_584], x4_340[@i_584], x3_341[@i_584], x2_342[@i_584], x1_343[@i_584], r_338[@i_584]) && ((x1_415 = x1[@i_584]) && ((x2_414 = x2[@i_584]) && ((X = x3[@i_584]) && ((Y[@i_232] = x4[@i_584]) && (K_u = x5[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_584]);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_350[@i_232]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_410);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      find [unique] @i_571 <= qH0 suchthat defined(x1[@i_571], x2[@i_571], x3[@i_571], x4[@i_571], x5[@i_571], x5_339[@i_571], x4_340[@i_571], x3_341[@i_571], x2_342[@i_571], x1_343[@i_571], r_338[@i_571]) && ((x1_409 = x1[@i_571]) && ((x2_408 = x2[@i_571]) && ((X = x3[@i_571]) && ((Y[@i_232] = x4[@i_571]) && (K_u = x5[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_571]);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_404);
        out(c6[!_57], r1_94)
  )
  else
    new @2_r4_188: G;
    let Y_u: G = @2_r4_188 in
    let K_u: G = exp(@2_r4_188, x) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      find [unique] @i_454 <= qH0 suchthat defined(x1[@i_454], x2[@i_454], x3[@i_454], x4[@i_454], x5[@i_454], x5_339[@i_454], x4_340[@i_454], x3_341[@i_454], x2_342[@i_454], x1_343[@i_454], r_338[@i_454]) && ((x1_355 = x1[@i_454]) && ((x2_354 = x2[@i_454]) && ((X_s = x3[@i_454]) && ((Y = x4[@i_454]) && (K_s = x5[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_454])
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_410[j])
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_350)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], x5_339[@i_467], x4_340[@i_467], x3_341[@i_467], x2_342[@i_467], x1_343[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (K_s = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = exp(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@2_r4_188[@i_206], Ystar_u[@i_206]) && ((@2_x = @2_r4_188[@i_206]) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@1_x_737[@i_200], @2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], exp(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @2_r4_188[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @2_r4_188[@i_196])
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], exp(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_343: host = cst_host in
  let x2_342: host = cst_host in
  let x3_341: G = cst_G in
  let x4_340: G = cst_G in
  let x5_339: G = cst_G in
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], x5_339[@i_428], x4_340[@i_428], x3_341[@i_428], x2_342[@i_428], x1_343[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(Xp[@i_427], Yp[@i_427], Kp[@i_427], xp[@i_427], xp[@i_427], xp[@i_427], x1_349[@i_427], x2_348[@i_427], r_344[@i_427]) && ((x1 = x1_349[@i_427]) && ((x2 = x2_348[@i_427]) && ((x3 = Xp[@i_427]) && ((x4 = Yp[@i_427]) && (x5 = Kp[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(X_s[@i_426], Y[@i_426], K_s[@i_426], x1_355[@i_426], x1_355[@i_426], x1_355[@i_426], x1_355[@i_426], x2_354[@i_426], r_350[@i_426]) && ((x1 = x1_355[@i_426]) && ((x2 = x2_354[@i_426]) && ((x3 = X_s[@i_426]) && ((x4 = Y[@i_426]) && (x5 = K_s[@i_426]))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(X_s[@i_425], Y[@i_425], K_s[@i_425], x1_361[@i_425], x1_361[@i_425], x1_361[@i_425], x1_361[@i_425], x2_360[@i_425], r_356[@i_425]) && ((x1 = x1_361[@i_425]) && ((x2 = x2_360[@i_425]) && ((x3 = X_s[@i_425]) && ((x4 = Y[@i_425]) && (x5 = K_s[@i_425]))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(X[@i_424], @2_r4_188[@i_424], K_u[@i_424], @2_r4_188[@i_424], @2_r4_188[@i_424], @2_r4_188[@i_424], x1_367[@i_424], x2_366[@i_424], r_362[@i_424]) && ((x1 = x1_367[@i_424]) && ((x2 = x2_366[@i_424]) && ((x3 = X[@i_424]) && ((x4 = @2_r4_188[@i_424]) && (x5 = K_u[@i_424]))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(@1_x_737[@i_240[@i_423]], X[@i_423], @1_x_737[@i_240[@i_423]], K_u[@i_423], x1_373[@i_423], x1_373[@i_423], x1_373[@i_423], x1_373[@i_423], x2_372[@i_423], r_368[@i_423]) && ((x1 = x1_373[@i_423]) && ((x2 = x2_372[@i_423]) && ((x3 = X[@i_423]) && ((x4 = exp(g, @1_x_737[@i_240[@i_423]])) && (x5 = K_u[@i_423]))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(@1_x_737[@i_240[@i_422]], X[@i_422], @1_x_737[@i_240[@i_422]], K_u[@i_422], x1_379[@i_422], x1_379[@i_422], x1_379[@i_422], x1_379[@i_422], x2_378[@i_422], r_374[@i_422]) && ((x1 = x1_379[@i_422]) && ((x2 = x2_378[@i_422]) && ((x3 = X[@i_422]) && ((x4 = exp(g, @1_x_737[@i_240[@i_422]])) && (x5 = K_u[@i_422]))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(X[@i_421], @2_r4_188[@i_236[@i_421]], K_u[@i_421], x1_385[@i_421], x1_385[@i_421], x1_385[@i_421], x1_385[@i_421], x2_384[@i_421], r_380[@i_421]) && ((x1 = x1_385[@i_421]) && ((x2 = x2_384[@i_421]) && ((x3 = X[@i_421]) && ((x4 = @2_r4_188[@i_236[@i_421]]) && (x5 = K_u[@i_421]))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(X[@i_420], @2_r4_188[@i_236[@i_420]], K_u[@i_420], x1_391[@i_420], x1_391[@i_420], x1_391[@i_420], x1_391[@i_420], x2_390[@i_420], r_386[@i_420]) && ((x1 = x1_391[@i_420]) && ((x2 = x2_390[@i_420]) && ((x3 = X[@i_420]) && ((x4 = @2_r4_188[@i_236[@i_420]]) && (x5 = K_u[@i_420]))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(X[@i_419], Yp[@i_233[@i_419]], K_u[@i_419], x1_397[@i_419], x1_397[@i_419], x1_397[@i_419], x1_397[@i_419], x2_396[@i_419], r_392[@i_419]) && ((x1 = x1_397[@i_419]) && ((x2 = x2_396[@i_419]) && ((x3 = X[@i_419]) && ((x4 = Yp[@i_233[@i_419]]) && (x5 = K_u[@i_419]))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(X[@i_418], Yp[@i_233[@i_418]], K_u[@i_418], x1_403[@i_418], x1_403[@i_418], x1_403[@i_418], x1_403[@i_418], x2_402[@i_418], r_398[@i_418]) && ((x1 = x1_403[@i_418]) && ((x2 = x2_402[@i_418]) && ((x3 = X[@i_418]) && ((x4 = Yp[@i_233[@i_418]]) && (x5 = K_u[@i_418]))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(X[@i_417], Y[@i_232[@i_417]], K_u[@i_417], x1_409[@i_417], x1_409[@i_417], x1_409[@i_417], x1_409[@i_417], x2_408[@i_417], r_404[@i_417]) && ((x1 = x1_409[@i_417]) && ((x2 = x2_408[@i_417]) && ((x3 = X[@i_417]) && ((x4 = Y[@i_232[@i_417]]) && (x5 = K_u[@i_417]))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(X[@i_416], Y[@i_232[@i_416]], K_u[@i_416], x1_415[@i_416], x1_415[@i_416], x1_415[@i_416], x1_415[@i_416], x2_414[@i_416], r_410[@i_416]) && ((x1 = x1_415[@i_416]) && ((x2 = x2_414[@i_416]) && ((x3 = X[@i_416]) && ((x4 = Y[@i_232[@i_416]]) && (x5 = K_u[@i_416]))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying equivalence
equiv ! !_1 <= @1_N new @1_X: G; (
  @1_OX() := @1_X,
  ! !_2 <= @1_N' @1_OXm(@1_m: exponent) := exp(@1_X, @1_m))
<=(0)=>
      ! !_3 <= @1_N new @1_x: exponent; (
  @1_OX() := exp(g, @1_x),
  ! !_4 <= @1_N' @1_OXm(@1_m: exponent) := exp(g, mult(@1_x, @1_m)))
 yields

Game 20 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@1_x_737[@i_240], @2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = exp(g, @1_x_737[@i_240]) in
    let K_u: G = exp(g, mult(@1_x_737[@i_240], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_737[@i_240]) = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      find [unique] @i_506 <= qH0 suchthat defined(x1[@i_506], x2[@i_506], x3[@i_506], x4[@i_506], x5[@i_506], x5_339[@i_506], x4_340[@i_506], x3_341[@i_506], x2_342[@i_506], x1_343[@i_506], r_338[@i_506]) && ((x1_379 = x1[@i_506]) && ((x2_378 = x2[@i_506]) && ((X = x3[@i_506]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_506]) && (K_u = x5[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_506]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_374);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      find [unique] @i_493 <= qH0 suchthat defined(x1[@i_493], x2[@i_493], x3[@i_493], x4[@i_493], x5[@i_493], x5_339[@i_493], x4_340[@i_493], x3_341[@i_493], x2_342[@i_493], x1_343[@i_493], r_338[@i_493]) && ((x1_373 = x1[@i_493]) && ((x2_372 = x2[@i_493]) && ((X = x3[@i_493]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_493]) && (K_u = x5[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_493]);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_368);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(@1_x_874[@i_236], Ystar_u[@i_236], @2_r4_188[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = exp(g, @1_x_874[@i_236]) in
    let K_u: G = exp(g, mult(@1_x_874[@i_236], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_874[@i_236]) = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      find [unique] @i_532 <= qH0 suchthat defined(x1[@i_532], x2[@i_532], x3[@i_532], x4[@i_532], x5[@i_532], x5_339[@i_532], x4_340[@i_532], x3_341[@i_532], x2_342[@i_532], x1_343[@i_532], r_338[@i_532]) && ((x1_391 = x1[@i_532]) && ((x2_390 = x2[@i_532]) && ((X = x3[@i_532]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_532]) && (K_u = x5[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_532]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_386);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      find [unique] @i_519 <= qH0 suchthat defined(x1[@i_519], x2[@i_519], x3[@i_519], x4[@i_519], x5[@i_519], x5_339[@i_519], x4_340[@i_519], x3_341[@i_519], x2_342[@i_519], x1_343[@i_519], r_338[@i_519]) && ((x1_385 = x1[@i_519]) && ((x2_384 = x2[@i_519]) && ((X = x3[@i_519]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_519]) && (K_u = x5[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_519]);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_380);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      find [unique] @i_558 <= qH0 suchthat defined(x1[@i_558], x2[@i_558], x3[@i_558], x4[@i_558], x5[@i_558], x5_339[@i_558], x4_340[@i_558], x3_341[@i_558], x2_342[@i_558], x1_343[@i_558], r_338[@i_558]) && ((x1_403 = x1[@i_558]) && ((x2_402 = x2[@i_558]) && ((X = x3[@i_558]) && ((Yp[@i_233] = x4[@i_558]) && (K_u = x5[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_558]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_398);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      find [unique] @i_545 <= qH0 suchthat defined(x1[@i_545], x2[@i_545], x3[@i_545], x4[@i_545], x5[@i_545], x5_339[@i_545], x4_340[@i_545], x3_341[@i_545], x2_342[@i_545], x1_343[@i_545], r_338[@i_545]) && ((x1_397 = x1[@i_545]) && ((x2_396 = x2[@i_545]) && ((X = x3[@i_545]) && ((Yp[@i_233] = x4[@i_545]) && (K_u = x5[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_545]);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_392);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      find [unique] @i_584 <= qH0 suchthat defined(x1[@i_584], x2[@i_584], x3[@i_584], x4[@i_584], x5[@i_584], x5_339[@i_584], x4_340[@i_584], x3_341[@i_584], x2_342[@i_584], x1_343[@i_584], r_338[@i_584]) && ((x1_415 = x1[@i_584]) && ((x2_414 = x2[@i_584]) && ((X = x3[@i_584]) && ((Y[@i_232] = x4[@i_584]) && (K_u = x5[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_584]);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_350[@i_232]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_410);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      find [unique] @i_571 <= qH0 suchthat defined(x1[@i_571], x2[@i_571], x3[@i_571], x4[@i_571], x5[@i_571], x5_339[@i_571], x4_340[@i_571], x3_341[@i_571], x2_342[@i_571], x1_343[@i_571], r_338[@i_571]) && ((x1_409 = x1[@i_571]) && ((x2_408 = x2[@i_571]) && ((X = x3[@i_571]) && ((Y[@i_232] = x4[@i_571]) && (K_u = x5[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_571]);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_404);
        out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    let @2_r4_188: G = cst_G in
    let Y_u: G = exp(g, @1_x_874) in
    let K_u: G = exp(g, mult(@1_x_874, x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      find [unique] @i_454 <= qH0 suchthat defined(x1[@i_454], x2[@i_454], x3[@i_454], x4[@i_454], x5[@i_454], x5_339[@i_454], x4_340[@i_454], x3_341[@i_454], x2_342[@i_454], x1_343[@i_454], r_338[@i_454]) && ((x1_355 = x1[@i_454]) && ((x2_354 = x2[@i_454]) && ((X_s = x3[@i_454]) && ((Y = x4[@i_454]) && (K_s = x5[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_454])
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_410[j])
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_350)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], x5_339[@i_467], x4_340[@i_467], x3_341[@i_467], x2_342[@i_467], x1_343[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (K_s = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = exp(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], @2_r4_188[@i_206], Ystar_u[@i_206]) && ((@2_x = exp(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@1_x_737[@i_200], @2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], exp(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(@1_x_874[@i_196], Ystar_u[@i_196], @2_r4_188[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], exp(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], exp(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_343: host = cst_host in
  let x2_342: host = cst_host in
  let x3_341: G = cst_G in
  let x4_340: G = cst_G in
  let x5_339: G = cst_G in
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], x5_339[@i_428], x4_340[@i_428], x3_341[@i_428], x2_342[@i_428], x1_343[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(Xp[@i_427], Yp[@i_427], Kp[@i_427], xp[@i_427], xp[@i_427], xp[@i_427], x1_349[@i_427], x2_348[@i_427], r_344[@i_427]) && ((x1 = x1_349[@i_427]) && ((x2 = x2_348[@i_427]) && ((x3 = Xp[@i_427]) && ((x4 = Yp[@i_427]) && (x5 = Kp[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(X_s[@i_426], Y[@i_426], K_s[@i_426], x1_355[@i_426], x1_355[@i_426], x1_355[@i_426], x1_355[@i_426], x2_354[@i_426], r_350[@i_426]) && ((x1 = x1_355[@i_426]) && ((x2 = x2_354[@i_426]) && ((x3 = X_s[@i_426]) && ((x4 = Y[@i_426]) && (x5 = K_s[@i_426]))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(X_s[@i_425], Y[@i_425], K_s[@i_425], x1_361[@i_425], x1_361[@i_425], x1_361[@i_425], x1_361[@i_425], x2_360[@i_425], r_356[@i_425]) && ((x1 = x1_361[@i_425]) && ((x2 = x2_360[@i_425]) && ((x3 = X_s[@i_425]) && ((x4 = Y[@i_425]) && (x5 = K_s[@i_425]))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(@1_x_874[@i_424], @1_x_874[@i_424], @1_x_874[@i_424], @1_x_874[@i_424], X[@i_424], @2_r4_188[@i_424], K_u[@i_424], @2_r4_188[@i_424], @2_r4_188[@i_424], @2_r4_188[@i_424], x1_367[@i_424], x2_366[@i_424], r_362[@i_424]) && ((x1 = x1_367[@i_424]) && ((x2 = x2_366[@i_424]) && ((x3 = X[@i_424]) && ((x4 = exp(g, @1_x_874[@i_424])) && (x5 = K_u[@i_424]))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(@1_x_737[@i_240[@i_423]], X[@i_423], @1_x_737[@i_240[@i_423]], K_u[@i_423], x1_373[@i_423], x1_373[@i_423], x1_373[@i_423], x1_373[@i_423], x2_372[@i_423], r_368[@i_423]) && ((x1 = x1_373[@i_423]) && ((x2 = x2_372[@i_423]) && ((x3 = X[@i_423]) && ((x4 = exp(g, @1_x_737[@i_240[@i_423]])) && (x5 = K_u[@i_423]))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(@1_x_737[@i_240[@i_422]], X[@i_422], @1_x_737[@i_240[@i_422]], K_u[@i_422], x1_379[@i_422], x1_379[@i_422], x1_379[@i_422], x1_379[@i_422], x2_378[@i_422], r_374[@i_422]) && ((x1 = x1_379[@i_422]) && ((x2 = x2_378[@i_422]) && ((x3 = X[@i_422]) && ((x4 = exp(g, @1_x_737[@i_240[@i_422]])) && (x5 = K_u[@i_422]))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(@1_x_874[@i_236[@i_421]], X[@i_421], @2_r4_188[@i_236[@i_421]], K_u[@i_421], x1_385[@i_421], x1_385[@i_421], x1_385[@i_421], x1_385[@i_421], x2_384[@i_421], r_380[@i_421]) && ((x1 = x1_385[@i_421]) && ((x2 = x2_384[@i_421]) && ((x3 = X[@i_421]) && ((x4 = exp(g, @1_x_874[@i_236[@i_421]])) && (x5 = K_u[@i_421]))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(@1_x_874[@i_236[@i_420]], X[@i_420], @2_r4_188[@i_236[@i_420]], K_u[@i_420], x1_391[@i_420], x1_391[@i_420], x1_391[@i_420], x1_391[@i_420], x2_390[@i_420], r_386[@i_420]) && ((x1 = x1_391[@i_420]) && ((x2 = x2_390[@i_420]) && ((x3 = X[@i_420]) && ((x4 = exp(g, @1_x_874[@i_236[@i_420]])) && (x5 = K_u[@i_420]))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(X[@i_419], Yp[@i_233[@i_419]], K_u[@i_419], x1_397[@i_419], x1_397[@i_419], x1_397[@i_419], x1_397[@i_419], x2_396[@i_419], r_392[@i_419]) && ((x1 = x1_397[@i_419]) && ((x2 = x2_396[@i_419]) && ((x3 = X[@i_419]) && ((x4 = Yp[@i_233[@i_419]]) && (x5 = K_u[@i_419]))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(X[@i_418], Yp[@i_233[@i_418]], K_u[@i_418], x1_403[@i_418], x1_403[@i_418], x1_403[@i_418], x1_403[@i_418], x2_402[@i_418], r_398[@i_418]) && ((x1 = x1_403[@i_418]) && ((x2 = x2_402[@i_418]) && ((x3 = X[@i_418]) && ((x4 = Yp[@i_233[@i_418]]) && (x5 = K_u[@i_418]))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(X[@i_417], Y[@i_232[@i_417]], K_u[@i_417], x1_409[@i_417], x1_409[@i_417], x1_409[@i_417], x1_409[@i_417], x2_408[@i_417], r_404[@i_417]) && ((x1 = x1_409[@i_417]) && ((x2 = x2_408[@i_417]) && ((x3 = X[@i_417]) && ((x4 = Y[@i_232[@i_417]]) && (x5 = K_u[@i_417]))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(X[@i_416], Y[@i_232[@i_416]], K_u[@i_416], x1_415[@i_416], x1_415[@i_416], x1_415[@i_416], x1_415[@i_416], x2_414[@i_416], r_410[@i_416]) && ((x1 = x1_415[@i_416]) && ((x2 = x2_414[@i_416]) && ((x3 = X[@i_416]) && ((x4 = Y[@i_232[@i_416]]) && (x5 = K_u[@i_416]))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of useless yields

Game 21 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@1_x_737[@i_240], @2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = exp(g, @1_x_737[@i_240]) in
    let K_u: G = exp(g, mult(@1_x_737[@i_240], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_737[@i_240]) = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      find [unique] @i_506 <= qH0 suchthat defined(x1[@i_506], x2[@i_506], x3[@i_506], x4[@i_506], x5[@i_506], x5_339[@i_506], x4_340[@i_506], x3_341[@i_506], x2_342[@i_506], x1_343[@i_506], r_338[@i_506]) && ((x1_379 = x1[@i_506]) && ((x2_378 = x2[@i_506]) && ((X = x3[@i_506]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_506]) && (K_u = x5[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_506]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_374);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      find [unique] @i_493 <= qH0 suchthat defined(x1[@i_493], x2[@i_493], x3[@i_493], x4[@i_493], x5[@i_493], x5_339[@i_493], x4_340[@i_493], x3_341[@i_493], x2_342[@i_493], x1_343[@i_493], r_338[@i_493]) && ((x1_373 = x1[@i_493]) && ((x2_372 = x2[@i_493]) && ((X = x3[@i_493]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_493]) && (K_u = x5[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_493]);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_368);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(@1_x_874[@i_236], Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = exp(g, @1_x_874[@i_236]) in
    let K_u: G = exp(g, mult(@1_x_874[@i_236], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_874[@i_236]) = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      find [unique] @i_532 <= qH0 suchthat defined(x1[@i_532], x2[@i_532], x3[@i_532], x4[@i_532], x5[@i_532], x5_339[@i_532], x4_340[@i_532], x3_341[@i_532], x2_342[@i_532], x1_343[@i_532], r_338[@i_532]) && ((x1_391 = x1[@i_532]) && ((x2_390 = x2[@i_532]) && ((X = x3[@i_532]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_532]) && (K_u = x5[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_532]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_386);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      find [unique] @i_519 <= qH0 suchthat defined(x1[@i_519], x2[@i_519], x3[@i_519], x4[@i_519], x5[@i_519], x5_339[@i_519], x4_340[@i_519], x3_341[@i_519], x2_342[@i_519], x1_343[@i_519], r_338[@i_519]) && ((x1_385 = x1[@i_519]) && ((x2_384 = x2[@i_519]) && ((X = x3[@i_519]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_519]) && (K_u = x5[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_519]);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_380);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      find [unique] @i_558 <= qH0 suchthat defined(x1[@i_558], x2[@i_558], x3[@i_558], x4[@i_558], x5[@i_558], x5_339[@i_558], x4_340[@i_558], x3_341[@i_558], x2_342[@i_558], x1_343[@i_558], r_338[@i_558]) && ((x1_403 = x1[@i_558]) && ((x2_402 = x2[@i_558]) && ((X = x3[@i_558]) && ((Yp[@i_233] = x4[@i_558]) && (K_u = x5[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_558]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_398);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      find [unique] @i_545 <= qH0 suchthat defined(x1[@i_545], x2[@i_545], x3[@i_545], x4[@i_545], x5[@i_545], x5_339[@i_545], x4_340[@i_545], x3_341[@i_545], x2_342[@i_545], x1_343[@i_545], r_338[@i_545]) && ((x1_397 = x1[@i_545]) && ((x2_396 = x2[@i_545]) && ((X = x3[@i_545]) && ((Yp[@i_233] = x4[@i_545]) && (K_u = x5[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_545]);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_392);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      find [unique] @i_584 <= qH0 suchthat defined(x1[@i_584], x2[@i_584], x3[@i_584], x4[@i_584], x5[@i_584], x5_339[@i_584], x4_340[@i_584], x3_341[@i_584], x2_342[@i_584], x1_343[@i_584], r_338[@i_584]) && ((x1_415 = x1[@i_584]) && ((x2_414 = x2[@i_584]) && ((X = x3[@i_584]) && ((Y[@i_232] = x4[@i_584]) && (K_u = x5[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_584]);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_350[@i_232]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_410);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      find [unique] @i_571 <= qH0 suchthat defined(x1[@i_571], x2[@i_571], x3[@i_571], x4[@i_571], x5[@i_571], x5_339[@i_571], x4_340[@i_571], x3_341[@i_571], x2_342[@i_571], x1_343[@i_571], r_338[@i_571]) && ((x1_409 = x1[@i_571]) && ((x2_408 = x2[@i_571]) && ((X = x3[@i_571]) && ((Y[@i_232] = x4[@i_571]) && (K_u = x5[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_571]);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_404);
        out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    let Y_u: G = exp(g, @1_x_874) in
    let K_u: G = exp(g, mult(@1_x_874, x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      find [unique] @i_454 <= qH0 suchthat defined(x1[@i_454], x2[@i_454], x3[@i_454], x4[@i_454], x5[@i_454], x5_339[@i_454], x4_340[@i_454], x3_341[@i_454], x2_342[@i_454], x1_343[@i_454], r_338[@i_454]) && ((x1_355 = x1[@i_454]) && ((x2_354 = x2[@i_454]) && ((X_s = x3[@i_454]) && ((Y = x4[@i_454]) && (K_s = x5[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_454])
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_410[j])
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_350)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], x5_339[@i_467], x4_340[@i_467], x3_341[@i_467], x2_342[@i_467], x1_343[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (K_s = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = exp(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], @1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = exp(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@1_x_737[@i_200], @2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], exp(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(@1_x_874[@i_196], Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], exp(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], exp(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_343: host = cst_host in
  let x2_342: host = cst_host in
  let x3_341: G = cst_G in
  let x4_340: G = cst_G in
  let x5_339: G = cst_G in
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], x5_339[@i_428], x4_340[@i_428], x3_341[@i_428], x2_342[@i_428], x1_343[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(Xp[@i_427], Yp[@i_427], Kp[@i_427], xp[@i_427], xp[@i_427], xp[@i_427], x1_349[@i_427], x2_348[@i_427], r_344[@i_427]) && ((x1 = x1_349[@i_427]) && ((x2 = x2_348[@i_427]) && ((x3 = Xp[@i_427]) && ((x4 = Yp[@i_427]) && (x5 = Kp[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(X_s[@i_426], Y[@i_426], K_s[@i_426], x1_355[@i_426], x1_355[@i_426], x1_355[@i_426], x1_355[@i_426], x2_354[@i_426], r_350[@i_426]) && ((x1 = x1_355[@i_426]) && ((x2 = x2_354[@i_426]) && ((x3 = X_s[@i_426]) && ((x4 = Y[@i_426]) && (x5 = K_s[@i_426]))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(X_s[@i_425], Y[@i_425], K_s[@i_425], x1_361[@i_425], x1_361[@i_425], x1_361[@i_425], x1_361[@i_425], x2_360[@i_425], r_356[@i_425]) && ((x1 = x1_361[@i_425]) && ((x2 = x2_360[@i_425]) && ((x3 = X_s[@i_425]) && ((x4 = Y[@i_425]) && (x5 = K_s[@i_425]))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(@1_x_874[@i_424], @1_x_874[@i_424], @1_x_874[@i_424], @1_x_874[@i_424], X[@i_424], @1_x_874[@i_424], K_u[@i_424], @1_x_874[@i_424], @1_x_874[@i_424], @1_x_874[@i_424], x1_367[@i_424], x2_366[@i_424], r_362[@i_424]) && ((x1 = x1_367[@i_424]) && ((x2 = x2_366[@i_424]) && ((x3 = X[@i_424]) && ((x4 = exp(g, @1_x_874[@i_424])) && (x5 = K_u[@i_424]))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(@1_x_737[@i_240[@i_423]], X[@i_423], @1_x_737[@i_240[@i_423]], K_u[@i_423], x1_373[@i_423], x1_373[@i_423], x1_373[@i_423], x1_373[@i_423], x2_372[@i_423], r_368[@i_423]) && ((x1 = x1_373[@i_423]) && ((x2 = x2_372[@i_423]) && ((x3 = X[@i_423]) && ((x4 = exp(g, @1_x_737[@i_240[@i_423]])) && (x5 = K_u[@i_423]))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(@1_x_737[@i_240[@i_422]], X[@i_422], @1_x_737[@i_240[@i_422]], K_u[@i_422], x1_379[@i_422], x1_379[@i_422], x1_379[@i_422], x1_379[@i_422], x2_378[@i_422], r_374[@i_422]) && ((x1 = x1_379[@i_422]) && ((x2 = x2_378[@i_422]) && ((x3 = X[@i_422]) && ((x4 = exp(g, @1_x_737[@i_240[@i_422]])) && (x5 = K_u[@i_422]))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(@1_x_874[@i_236[@i_421]], X[@i_421], @1_x_874[@i_236[@i_421]], K_u[@i_421], x1_385[@i_421], x1_385[@i_421], x1_385[@i_421], x1_385[@i_421], x2_384[@i_421], r_380[@i_421]) && ((x1 = x1_385[@i_421]) && ((x2 = x2_384[@i_421]) && ((x3 = X[@i_421]) && ((x4 = exp(g, @1_x_874[@i_236[@i_421]])) && (x5 = K_u[@i_421]))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(@1_x_874[@i_236[@i_420]], X[@i_420], @1_x_874[@i_236[@i_420]], K_u[@i_420], x1_391[@i_420], x1_391[@i_420], x1_391[@i_420], x1_391[@i_420], x2_390[@i_420], r_386[@i_420]) && ((x1 = x1_391[@i_420]) && ((x2 = x2_390[@i_420]) && ((x3 = X[@i_420]) && ((x4 = exp(g, @1_x_874[@i_236[@i_420]])) && (x5 = K_u[@i_420]))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(X[@i_419], Yp[@i_233[@i_419]], K_u[@i_419], x1_397[@i_419], x1_397[@i_419], x1_397[@i_419], x1_397[@i_419], x2_396[@i_419], r_392[@i_419]) && ((x1 = x1_397[@i_419]) && ((x2 = x2_396[@i_419]) && ((x3 = X[@i_419]) && ((x4 = Yp[@i_233[@i_419]]) && (x5 = K_u[@i_419]))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(X[@i_418], Yp[@i_233[@i_418]], K_u[@i_418], x1_403[@i_418], x1_403[@i_418], x1_403[@i_418], x1_403[@i_418], x2_402[@i_418], r_398[@i_418]) && ((x1 = x1_403[@i_418]) && ((x2 = x2_402[@i_418]) && ((x3 = X[@i_418]) && ((x4 = Yp[@i_233[@i_418]]) && (x5 = K_u[@i_418]))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(X[@i_417], Y[@i_232[@i_417]], K_u[@i_417], x1_409[@i_417], x1_409[@i_417], x1_409[@i_417], x1_409[@i_417], x2_408[@i_417], r_404[@i_417]) && ((x1 = x1_409[@i_417]) && ((x2 = x2_408[@i_417]) && ((x3 = X[@i_417]) && ((x4 = Y[@i_232[@i_417]]) && (x5 = K_u[@i_417]))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(X[@i_416], Y[@i_232[@i_416]], K_u[@i_416], x1_415[@i_416], x1_415[@i_416], x1_415[@i_416], x1_415[@i_416], x2_414[@i_416], r_410[@i_416]) && ((x1 = x1_415[@i_416]) && ((x2 = x2_414[@i_416]) && ((x3 = X[@i_416]) && ((x4 = Y[@i_232[@i_416]]) && (x5 = K_u[@i_416]))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying SA rename K_u yields

Game 22 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@1_x_737[@i_240], @2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = exp(g, @1_x_737[@i_240]) in
    let K_u_1037: G = exp(g, mult(@1_x_737[@i_240], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_737[@i_240]) = x14[@i_115]) && (K_u_1037 = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      find [unique] @i_506 <= qH0 suchthat defined(x1[@i_506], x2[@i_506], x3[@i_506], x4[@i_506], x5[@i_506], x5_339[@i_506], x4_340[@i_506], x3_341[@i_506], x2_342[@i_506], x1_343[@i_506], r_338[@i_506]) && ((x1_379 = x1[@i_506]) && ((x2_378 = x2[@i_506]) && ((X = x3[@i_506]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_506]) && (K_u_1037 = x5[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_506]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_374);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      find [unique] @i_493 <= qH0 suchthat defined(x1[@i_493], x2[@i_493], x3[@i_493], x4[@i_493], x5[@i_493], x5_339[@i_493], x4_340[@i_493], x3_341[@i_493], x2_342[@i_493], x1_343[@i_493], r_338[@i_493]) && ((x1_373 = x1[@i_493]) && ((x2_372 = x2[@i_493]) && ((X = x3[@i_493]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_493]) && (K_u_1037 = x5[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_493]);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_368);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(@1_x_874[@i_236], Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = exp(g, @1_x_874[@i_236]) in
    let K_u_1038: G = exp(g, mult(@1_x_874[@i_236], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_874[@i_236]) = x14[@i_115]) && (K_u_1038 = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      find [unique] @i_532 <= qH0 suchthat defined(x1[@i_532], x2[@i_532], x3[@i_532], x4[@i_532], x5[@i_532], x5_339[@i_532], x4_340[@i_532], x3_341[@i_532], x2_342[@i_532], x1_343[@i_532], r_338[@i_532]) && ((x1_391 = x1[@i_532]) && ((x2_390 = x2[@i_532]) && ((X = x3[@i_532]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_532]) && (K_u_1038 = x5[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_532]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_386);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      find [unique] @i_519 <= qH0 suchthat defined(x1[@i_519], x2[@i_519], x3[@i_519], x4[@i_519], x5[@i_519], x5_339[@i_519], x4_340[@i_519], x3_341[@i_519], x2_342[@i_519], x1_343[@i_519], r_338[@i_519]) && ((x1_385 = x1[@i_519]) && ((x2_384 = x2[@i_519]) && ((X = x3[@i_519]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_519]) && (K_u_1038 = x5[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_519]);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_380);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u_1039: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u_1039 = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      find [unique] @i_558 <= qH0 suchthat defined(x1[@i_558], x2[@i_558], x3[@i_558], x4[@i_558], x5[@i_558], x5_339[@i_558], x4_340[@i_558], x3_341[@i_558], x2_342[@i_558], x1_343[@i_558], r_338[@i_558]) && ((x1_403 = x1[@i_558]) && ((x2_402 = x2[@i_558]) && ((X = x3[@i_558]) && ((Yp[@i_233] = x4[@i_558]) && (K_u_1039 = x5[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_558]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_398);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      find [unique] @i_545 <= qH0 suchthat defined(x1[@i_545], x2[@i_545], x3[@i_545], x4[@i_545], x5[@i_545], x5_339[@i_545], x4_340[@i_545], x3_341[@i_545], x2_342[@i_545], x1_343[@i_545], r_338[@i_545]) && ((x1_397 = x1[@i_545]) && ((x2_396 = x2[@i_545]) && ((X = x3[@i_545]) && ((Yp[@i_233] = x4[@i_545]) && (K_u_1039 = x5[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_545]);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_392);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u_1040: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u_1040 = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      find [unique] @i_584 <= qH0 suchthat defined(x1[@i_584], x2[@i_584], x3[@i_584], x4[@i_584], x5[@i_584], x5_339[@i_584], x4_340[@i_584], x3_341[@i_584], x2_342[@i_584], x1_343[@i_584], r_338[@i_584]) && ((x1_415 = x1[@i_584]) && ((x2_414 = x2[@i_584]) && ((X = x3[@i_584]) && ((Y[@i_232] = x4[@i_584]) && (K_u_1040 = x5[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_584]);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_350[@i_232]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_410);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      find [unique] @i_571 <= qH0 suchthat defined(x1[@i_571], x2[@i_571], x3[@i_571], x4[@i_571], x5[@i_571], x5_339[@i_571], x4_340[@i_571], x3_341[@i_571], x2_342[@i_571], x1_343[@i_571], r_338[@i_571]) && ((x1_409 = x1[@i_571]) && ((x2_408 = x2[@i_571]) && ((X = x3[@i_571]) && ((Y[@i_232] = x4[@i_571]) && (K_u_1040 = x5[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_571]);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_404);
        out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    let Y_u: G = exp(g, @1_x_874) in
    let K_u_1041: G = exp(g, mult(@1_x_874, x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      find [unique] @i_454 <= qH0 suchthat defined(x1[@i_454], x2[@i_454], x3[@i_454], x4[@i_454], x5[@i_454], x5_339[@i_454], x4_340[@i_454], x3_341[@i_454], x2_342[@i_454], x1_343[@i_454], r_338[@i_454]) && ((x1_355 = x1[@i_454]) && ((x2_354 = x2[@i_454]) && ((X_s = x3[@i_454]) && ((Y = x4[@i_454]) && (K_s = x5[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_454])
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_410[j])
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_350)
    )
    orfind  suchthat defined(Y_u[j], K_u_1037[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u_1037[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], x5_339[@i_467], x4_340[@i_467], x3_341[@i_467], x2_342[@i_467], x1_343[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (K_s = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
    orfind  suchthat defined(Y_u[j], K_u_1038[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u_1038[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], x5_339[@i_467], x4_340[@i_467], x3_341[@i_467], x2_342[@i_467], x1_343[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (K_s = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
    orfind  suchthat defined(Y_u[j], K_u_1039[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u_1039[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], x5_339[@i_467], x4_340[@i_467], x3_341[@i_467], x2_342[@i_467], x1_343[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (K_s = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
    orfind  suchthat defined(Y_u[j], K_u_1040[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u_1040[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], x5_339[@i_467], x4_340[@i_467], x3_341[@i_467], x2_342[@i_467], x1_343[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (K_s = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
    orfind  suchthat defined(Y_u[j], K_u_1041[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u_1041[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], x5_339[@i_467], x4_340[@i_467], x3_341[@i_467], x2_342[@i_467], x1_343[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (K_s = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = exp(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], @1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = exp(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@1_x_737[@i_200], @2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], exp(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(@1_x_874[@i_196], Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], exp(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], exp(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_343: host = cst_host in
  let x2_342: host = cst_host in
  let x3_341: G = cst_G in
  let x4_340: G = cst_G in
  let x5_339: G = cst_G in
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], x5_339[@i_428], x4_340[@i_428], x3_341[@i_428], x2_342[@i_428], x1_343[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(Xp[@i_427], Yp[@i_427], Kp[@i_427], xp[@i_427], xp[@i_427], xp[@i_427], x1_349[@i_427], x2_348[@i_427], r_344[@i_427]) && ((x1 = x1_349[@i_427]) && ((x2 = x2_348[@i_427]) && ((x3 = Xp[@i_427]) && ((x4 = Yp[@i_427]) && (x5 = Kp[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(X_s[@i_426], Y[@i_426], K_s[@i_426], x1_355[@i_426], x1_355[@i_426], x1_355[@i_426], x1_355[@i_426], x2_354[@i_426], r_350[@i_426]) && ((x1 = x1_355[@i_426]) && ((x2 = x2_354[@i_426]) && ((x3 = X_s[@i_426]) && ((x4 = Y[@i_426]) && (x5 = K_s[@i_426]))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(X_s[@i_425], Y[@i_425], K_s[@i_425], x1_361[@i_425], x1_361[@i_425], x1_361[@i_425], x1_361[@i_425], x2_360[@i_425], r_356[@i_425]) && ((x1 = x1_361[@i_425]) && ((x2 = x2_360[@i_425]) && ((x3 = X_s[@i_425]) && ((x4 = Y[@i_425]) && (x5 = K_s[@i_425]))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(@1_x_874[@i_424], @1_x_874[@i_424], @1_x_874[@i_424], @1_x_874[@i_424], X[@i_424], @1_x_874[@i_424], K_u_1041[@i_424], @1_x_874[@i_424], @1_x_874[@i_424], @1_x_874[@i_424], x1_367[@i_424], x2_366[@i_424], r_362[@i_424]) && ((x1 = x1_367[@i_424]) && ((x2 = x2_366[@i_424]) && ((x3 = X[@i_424]) && ((x4 = exp(g, @1_x_874[@i_424])) && (x5 = K_u_1041[@i_424]))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(@1_x_737[@i_240[@i_423]], X[@i_423], @1_x_737[@i_240[@i_423]], K_u_1037[@i_423], x1_373[@i_423], x1_373[@i_423], x1_373[@i_423], x1_373[@i_423], x2_372[@i_423], r_368[@i_423]) && ((x1 = x1_373[@i_423]) && ((x2 = x2_372[@i_423]) && ((x3 = X[@i_423]) && ((x4 = exp(g, @1_x_737[@i_240[@i_423]])) && (x5 = K_u_1037[@i_423]))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(@1_x_737[@i_240[@i_422]], X[@i_422], @1_x_737[@i_240[@i_422]], K_u_1037[@i_422], x1_379[@i_422], x1_379[@i_422], x1_379[@i_422], x1_379[@i_422], x2_378[@i_422], r_374[@i_422]) && ((x1 = x1_379[@i_422]) && ((x2 = x2_378[@i_422]) && ((x3 = X[@i_422]) && ((x4 = exp(g, @1_x_737[@i_240[@i_422]])) && (x5 = K_u_1037[@i_422]))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(@1_x_874[@i_236[@i_421]], X[@i_421], @1_x_874[@i_236[@i_421]], K_u_1038[@i_421], x1_385[@i_421], x1_385[@i_421], x1_385[@i_421], x1_385[@i_421], x2_384[@i_421], r_380[@i_421]) && ((x1 = x1_385[@i_421]) && ((x2 = x2_384[@i_421]) && ((x3 = X[@i_421]) && ((x4 = exp(g, @1_x_874[@i_236[@i_421]])) && (x5 = K_u_1038[@i_421]))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(@1_x_874[@i_236[@i_420]], X[@i_420], @1_x_874[@i_236[@i_420]], K_u_1038[@i_420], x1_391[@i_420], x1_391[@i_420], x1_391[@i_420], x1_391[@i_420], x2_390[@i_420], r_386[@i_420]) && ((x1 = x1_391[@i_420]) && ((x2 = x2_390[@i_420]) && ((x3 = X[@i_420]) && ((x4 = exp(g, @1_x_874[@i_236[@i_420]])) && (x5 = K_u_1038[@i_420]))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(X[@i_419], Yp[@i_233[@i_419]], K_u_1039[@i_419], x1_397[@i_419], x1_397[@i_419], x1_397[@i_419], x1_397[@i_419], x2_396[@i_419], r_392[@i_419]) && ((x1 = x1_397[@i_419]) && ((x2 = x2_396[@i_419]) && ((x3 = X[@i_419]) && ((x4 = Yp[@i_233[@i_419]]) && (x5 = K_u_1039[@i_419]))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(X[@i_418], Yp[@i_233[@i_418]], K_u_1039[@i_418], x1_403[@i_418], x1_403[@i_418], x1_403[@i_418], x1_403[@i_418], x2_402[@i_418], r_398[@i_418]) && ((x1 = x1_403[@i_418]) && ((x2 = x2_402[@i_418]) && ((x3 = X[@i_418]) && ((x4 = Yp[@i_233[@i_418]]) && (x5 = K_u_1039[@i_418]))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(X[@i_417], Y[@i_232[@i_417]], K_u_1040[@i_417], x1_409[@i_417], x1_409[@i_417], x1_409[@i_417], x1_409[@i_417], x2_408[@i_417], r_404[@i_417]) && ((x1 = x1_409[@i_417]) && ((x2 = x2_408[@i_417]) && ((x3 = X[@i_417]) && ((x4 = Y[@i_232[@i_417]]) && (x5 = K_u_1040[@i_417]))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(X[@i_416], Y[@i_232[@i_416]], K_u_1040[@i_416], x1_415[@i_416], x1_415[@i_416], x1_415[@i_416], x1_415[@i_416], x2_414[@i_416], r_410[@i_416]) && ((x1 = x1_415[@i_416]) && ((x2 = x2_414[@i_416]) && ((x3 = X[@i_416]) && ((x4 = Y[@i_232[@i_416]]) && (x5 = K_u_1040[@i_416]))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1037[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1037[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1038[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1038[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1039[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1039[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1040[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1040[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1041[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1041[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of useless yields

Game 23 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@1_x_737[@i_240], @2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = exp(g, @1_x_737[@i_240]) in
    let K_u_1037: G = exp(g, mult(@1_x_737[@i_240], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_737[@i_240]) = x14[@i_115]) && (K_u_1037 = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      find [unique] @i_506 <= qH0 suchthat defined(x1[@i_506], x2[@i_506], x3[@i_506], x4[@i_506], x5[@i_506], x5_339[@i_506], x4_340[@i_506], x3_341[@i_506], x2_342[@i_506], x1_343[@i_506], r_338[@i_506]) && ((x1_379 = x1[@i_506]) && ((x2_378 = x2[@i_506]) && ((X = x3[@i_506]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_506]) && (K_u_1037 = x5[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_506]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_374);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      find [unique] @i_493 <= qH0 suchthat defined(x1[@i_493], x2[@i_493], x3[@i_493], x4[@i_493], x5[@i_493], x5_339[@i_493], x4_340[@i_493], x3_341[@i_493], x2_342[@i_493], x1_343[@i_493], r_338[@i_493]) && ((x1_373 = x1[@i_493]) && ((x2_372 = x2[@i_493]) && ((X = x3[@i_493]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_493]) && (K_u_1037 = x5[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_493]);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_368);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(@1_x_874[@i_236], Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = exp(g, @1_x_874[@i_236]) in
    let K_u_1038: G = exp(g, mult(@1_x_874[@i_236], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_874[@i_236]) = x14[@i_115]) && (K_u_1038 = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      find [unique] @i_532 <= qH0 suchthat defined(x1[@i_532], x2[@i_532], x3[@i_532], x4[@i_532], x5[@i_532], x5_339[@i_532], x4_340[@i_532], x3_341[@i_532], x2_342[@i_532], x1_343[@i_532], r_338[@i_532]) && ((x1_391 = x1[@i_532]) && ((x2_390 = x2[@i_532]) && ((X = x3[@i_532]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_532]) && (K_u_1038 = x5[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_532]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_386);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      find [unique] @i_519 <= qH0 suchthat defined(x1[@i_519], x2[@i_519], x3[@i_519], x4[@i_519], x5[@i_519], x5_339[@i_519], x4_340[@i_519], x3_341[@i_519], x2_342[@i_519], x1_343[@i_519], r_338[@i_519]) && ((x1_385 = x1[@i_519]) && ((x2_384 = x2[@i_519]) && ((X = x3[@i_519]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_519]) && (K_u_1038 = x5[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_519]);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_380);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u_1039: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u_1039 = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      find [unique] @i_558 <= qH0 suchthat defined(x1[@i_558], x2[@i_558], x3[@i_558], x4[@i_558], x5[@i_558], x5_339[@i_558], x4_340[@i_558], x3_341[@i_558], x2_342[@i_558], x1_343[@i_558], r_338[@i_558]) && ((x1_403 = x1[@i_558]) && ((x2_402 = x2[@i_558]) && ((X = x3[@i_558]) && ((Yp[@i_233] = x4[@i_558]) && (K_u_1039 = x5[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_558]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_398);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      find [unique] @i_545 <= qH0 suchthat defined(x1[@i_545], x2[@i_545], x3[@i_545], x4[@i_545], x5[@i_545], x5_339[@i_545], x4_340[@i_545], x3_341[@i_545], x2_342[@i_545], x1_343[@i_545], r_338[@i_545]) && ((x1_397 = x1[@i_545]) && ((x2_396 = x2[@i_545]) && ((X = x3[@i_545]) && ((Yp[@i_233] = x4[@i_545]) && (K_u_1039 = x5[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_545]);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_392);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u_1040: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u_1040 = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      find [unique] @i_584 <= qH0 suchthat defined(x1[@i_584], x2[@i_584], x3[@i_584], x4[@i_584], x5[@i_584], x5_339[@i_584], x4_340[@i_584], x3_341[@i_584], x2_342[@i_584], x1_343[@i_584], r_338[@i_584]) && ((x1_415 = x1[@i_584]) && ((x2_414 = x2[@i_584]) && ((X = x3[@i_584]) && ((Y[@i_232] = x4[@i_584]) && (K_u_1040 = x5[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_584]);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_350[@i_232]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_410);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      find [unique] @i_571 <= qH0 suchthat defined(x1[@i_571], x2[@i_571], x3[@i_571], x4[@i_571], x5[@i_571], x5_339[@i_571], x4_340[@i_571], x3_341[@i_571], x2_342[@i_571], x1_343[@i_571], r_338[@i_571]) && ((x1_409 = x1[@i_571]) && ((x2_408 = x2[@i_571]) && ((X = x3[@i_571]) && ((Y[@i_232] = x4[@i_571]) && (K_u_1040 = x5[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_571]);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_404);
        out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    let Y_u: G = exp(g, @1_x_874) in
    let K_u_1041: G = exp(g, mult(@1_x_874, x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      find [unique] @i_454 <= qH0 suchthat defined(x1[@i_454], x2[@i_454], x3[@i_454], x4[@i_454], x5[@i_454], x5_339[@i_454], x4_340[@i_454], x3_341[@i_454], x2_342[@i_454], x1_343[@i_454], r_338[@i_454]) && ((x1_355 = x1[@i_454]) && ((x2_354 = x2[@i_454]) && ((X_s = x3[@i_454]) && ((Y = x4[@i_454]) && (K_s = x5[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_454])
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_410[j])
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_350)
    )
    orfind  suchthat defined(Y_u[j], K_u_1037[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u_1037[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], x5_339[@i_467], x4_340[@i_467], x3_341[@i_467], x2_342[@i_467], x1_343[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (K_s = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
    orfind  suchthat defined(Y_u[j], K_u_1038[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u_1038[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], x5_339[@i_467], x4_340[@i_467], x3_341[@i_467], x2_342[@i_467], x1_343[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (K_s = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
    orfind  suchthat defined(Y_u[j], K_u_1039[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u_1039[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], x5_339[@i_467], x4_340[@i_467], x3_341[@i_467], x2_342[@i_467], x1_343[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (K_s = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
    orfind  suchthat defined(Y_u[j], K_u_1040[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u_1040[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], x5_339[@i_467], x4_340[@i_467], x3_341[@i_467], x2_342[@i_467], x1_343[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (K_s = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
    orfind  suchthat defined(Y_u[j], K_u_1041[j], r1_94[j]) && ((Y = Y_u[j]) && (K_s = K_u_1041[j])) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], x5_339[@i_467], x4_340[@i_467], x3_341[@i_467], x2_342[@i_467], x1_343[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (K_s = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = exp(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], @1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = exp(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@1_x_737[@i_200], @2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], exp(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(@1_x_874[@i_196], Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], exp(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], exp(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_343: host = cst_host in
  let x2_342: host = cst_host in
  let x3_341: G = cst_G in
  let x4_340: G = cst_G in
  let x5_339: G = cst_G in
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], x5_339[@i_428], x4_340[@i_428], x3_341[@i_428], x2_342[@i_428], x1_343[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(Xp[@i_427], Yp[@i_427], Kp[@i_427], xp[@i_427], xp[@i_427], xp[@i_427], x1_349[@i_427], x2_348[@i_427], r_344[@i_427]) && ((x1 = x1_349[@i_427]) && ((x2 = x2_348[@i_427]) && ((x3 = Xp[@i_427]) && ((x4 = Yp[@i_427]) && (x5 = Kp[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(X_s[@i_426], Y[@i_426], K_s[@i_426], x1_355[@i_426], x1_355[@i_426], x1_355[@i_426], x1_355[@i_426], x2_354[@i_426], r_350[@i_426]) && ((x1 = x1_355[@i_426]) && ((x2 = x2_354[@i_426]) && ((x3 = X_s[@i_426]) && ((x4 = Y[@i_426]) && (x5 = K_s[@i_426]))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(X_s[@i_425], Y[@i_425], K_s[@i_425], x1_361[@i_425], x1_361[@i_425], x1_361[@i_425], x1_361[@i_425], x2_360[@i_425], r_356[@i_425]) && ((x1 = x1_361[@i_425]) && ((x2 = x2_360[@i_425]) && ((x3 = X_s[@i_425]) && ((x4 = Y[@i_425]) && (x5 = K_s[@i_425]))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(@1_x_874[@i_424], @1_x_874[@i_424], @1_x_874[@i_424], @1_x_874[@i_424], X[@i_424], @1_x_874[@i_424], K_u_1041[@i_424], @1_x_874[@i_424], @1_x_874[@i_424], @1_x_874[@i_424], x1_367[@i_424], x2_366[@i_424], r_362[@i_424]) && ((x1 = x1_367[@i_424]) && ((x2 = x2_366[@i_424]) && ((x3 = X[@i_424]) && ((x4 = exp(g, @1_x_874[@i_424])) && (x5 = K_u_1041[@i_424]))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(@1_x_737[@i_240[@i_423]], X[@i_423], @1_x_737[@i_240[@i_423]], K_u_1037[@i_423], x1_373[@i_423], x1_373[@i_423], x1_373[@i_423], x1_373[@i_423], x2_372[@i_423], r_368[@i_423]) && ((x1 = x1_373[@i_423]) && ((x2 = x2_372[@i_423]) && ((x3 = X[@i_423]) && ((x4 = exp(g, @1_x_737[@i_240[@i_423]])) && (x5 = K_u_1037[@i_423]))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(@1_x_737[@i_240[@i_422]], X[@i_422], @1_x_737[@i_240[@i_422]], K_u_1037[@i_422], x1_379[@i_422], x1_379[@i_422], x1_379[@i_422], x1_379[@i_422], x2_378[@i_422], r_374[@i_422]) && ((x1 = x1_379[@i_422]) && ((x2 = x2_378[@i_422]) && ((x3 = X[@i_422]) && ((x4 = exp(g, @1_x_737[@i_240[@i_422]])) && (x5 = K_u_1037[@i_422]))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(@1_x_874[@i_236[@i_421]], X[@i_421], @1_x_874[@i_236[@i_421]], K_u_1038[@i_421], x1_385[@i_421], x1_385[@i_421], x1_385[@i_421], x1_385[@i_421], x2_384[@i_421], r_380[@i_421]) && ((x1 = x1_385[@i_421]) && ((x2 = x2_384[@i_421]) && ((x3 = X[@i_421]) && ((x4 = exp(g, @1_x_874[@i_236[@i_421]])) && (x5 = K_u_1038[@i_421]))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(@1_x_874[@i_236[@i_420]], X[@i_420], @1_x_874[@i_236[@i_420]], K_u_1038[@i_420], x1_391[@i_420], x1_391[@i_420], x1_391[@i_420], x1_391[@i_420], x2_390[@i_420], r_386[@i_420]) && ((x1 = x1_391[@i_420]) && ((x2 = x2_390[@i_420]) && ((x3 = X[@i_420]) && ((x4 = exp(g, @1_x_874[@i_236[@i_420]])) && (x5 = K_u_1038[@i_420]))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(X[@i_419], Yp[@i_233[@i_419]], K_u_1039[@i_419], x1_397[@i_419], x1_397[@i_419], x1_397[@i_419], x1_397[@i_419], x2_396[@i_419], r_392[@i_419]) && ((x1 = x1_397[@i_419]) && ((x2 = x2_396[@i_419]) && ((x3 = X[@i_419]) && ((x4 = Yp[@i_233[@i_419]]) && (x5 = K_u_1039[@i_419]))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(X[@i_418], Yp[@i_233[@i_418]], K_u_1039[@i_418], x1_403[@i_418], x1_403[@i_418], x1_403[@i_418], x1_403[@i_418], x2_402[@i_418], r_398[@i_418]) && ((x1 = x1_403[@i_418]) && ((x2 = x2_402[@i_418]) && ((x3 = X[@i_418]) && ((x4 = Yp[@i_233[@i_418]]) && (x5 = K_u_1039[@i_418]))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(X[@i_417], Y[@i_232[@i_417]], K_u_1040[@i_417], x1_409[@i_417], x1_409[@i_417], x1_409[@i_417], x1_409[@i_417], x2_408[@i_417], r_404[@i_417]) && ((x1 = x1_409[@i_417]) && ((x2 = x2_408[@i_417]) && ((x3 = X[@i_417]) && ((x4 = Y[@i_232[@i_417]]) && (x5 = K_u_1040[@i_417]))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(X[@i_416], Y[@i_232[@i_416]], K_u_1040[@i_416], x1_415[@i_416], x1_415[@i_416], x1_415[@i_416], x1_415[@i_416], x2_414[@i_416], r_410[@i_416]) && ((x1 = x1_415[@i_416]) && ((x2 = x2_414[@i_416]) && ((x3 = X[@i_416]) && ((x4 = Y[@i_232[@i_416]]) && (x5 = K_u_1040[@i_416]))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1037[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1037[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1038[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1038[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1039[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1039[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1040[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1040[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1041[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1041[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying simplify [Excluding set(dist 23->24, proba <= 4. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|)] yields

Game 24 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = exp(g, @1_x_737[@i_240]) in
    let K_u_1037: G = exp(g, mult(@1_x_737[@i_240], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_737[@i_240]) = x14[@i_115]) && (K_u_1037 = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      find [unique] @i_506 <= qH0 suchthat defined(x1[@i_506], x2[@i_506], x3[@i_506], x4[@i_506], x5[@i_506], r_338[@i_506]) && ((x1_379 = x1[@i_506]) && ((x2_378 = x2[@i_506]) && ((X = x3[@i_506]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_506]) && (K_u_1037 = x5[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_506]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_374);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      find [unique] @i_493 <= qH0 suchthat defined(x1[@i_493], x2[@i_493], x3[@i_493], x4[@i_493], x5[@i_493], r_338[@i_493]) && ((x1_373 = x1[@i_493]) && ((x2_372 = x2[@i_493]) && ((X = x3[@i_493]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_493]) && (K_u_1037 = x5[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_493]);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_368);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = exp(g, @1_x_874[@i_236]) in
    let K_u_1038: G = exp(g, mult(@1_x_874[@i_236], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_874[@i_236]) = x14[@i_115]) && (K_u_1038 = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      find [unique] @i_532 <= qH0 suchthat defined(x1[@i_532], x2[@i_532], x3[@i_532], x4[@i_532], x5[@i_532], r_338[@i_532]) && ((x1_391 = x1[@i_532]) && ((x2_390 = x2[@i_532]) && ((X = x3[@i_532]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_532]) && (K_u_1038 = x5[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_532]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_386);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      find [unique] @i_519 <= qH0 suchthat defined(x1[@i_519], x2[@i_519], x3[@i_519], x4[@i_519], x5[@i_519], r_338[@i_519]) && ((x1_385 = x1[@i_519]) && ((x2_384 = x2[@i_519]) && ((X = x3[@i_519]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_519]) && (K_u_1038 = x5[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_519]);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_380);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u_1039: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u_1039 = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      find [unique] @i_558 <= qH0 suchthat defined(x1[@i_558], x2[@i_558], x3[@i_558], x4[@i_558], x5[@i_558], r_338[@i_558]) && ((x1_403 = x1[@i_558]) && ((x2_402 = x2[@i_558]) && ((X = x3[@i_558]) && ((Yp[@i_233] = x4[@i_558]) && (K_u_1039 = x5[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_558]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_398);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      find [unique] @i_545 <= qH0 suchthat defined(x1[@i_545], x2[@i_545], x3[@i_545], x4[@i_545], x5[@i_545], r_338[@i_545]) && ((x1_397 = x1[@i_545]) && ((x2_396 = x2[@i_545]) && ((X = x3[@i_545]) && ((Yp[@i_233] = x4[@i_545]) && (K_u_1039 = x5[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_545]);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_392);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u_1040: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u_1040 = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      find [unique] @i_584 <= qH0 suchthat defined(x1[@i_584], x2[@i_584], x3[@i_584], x4[@i_584], x5[@i_584], r_338[@i_584]) && ((x1_415 = x1[@i_584]) && ((x2_414 = x2[@i_584]) && ((X = x3[@i_584]) && ((Y[@i_232] = x4[@i_584]) && (K_u_1040 = x5[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_584]);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_350[@i_232]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_410);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      find [unique] @i_571 <= qH0 suchthat defined(x1[@i_571], x2[@i_571], x3[@i_571], x4[@i_571], x5[@i_571], r_338[@i_571]) && ((x1_409 = x1[@i_571]) && ((x2_408 = x2[@i_571]) && ((X = x3[@i_571]) && ((Y[@i_232] = x4[@i_571]) && (K_u_1040 = x5[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_571]);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_404);
        out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    let Y_u: G = exp(g, @1_x_874) in
    let K_u_1041: G = exp(g, mult(@1_x_874, x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (K_s = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      find [unique] @i_454 <= qH0 suchthat defined(x1[@i_454], x2[@i_454], x3[@i_454], x4[@i_454], x5[@i_454], r_338[@i_454]) && ((x1_355 = x1[@i_454]) && ((x2_354 = x2[@i_454]) && ((X_s = x3[@i_454]) && ((Y = x4[@i_454]) && (K_s = x5[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_454])
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_410[j])
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_350)
    )
    orfind  suchthat defined(@i_232[j], r1_94[j], K_u_1040[j]) && (!_58 = @i_232[j]) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (K_s = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = exp(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = exp(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], exp(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], exp(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], exp(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_343: host = cst_host in
  let x2_342: host = cst_host in
  let x3_341: G = cst_G in
  let x4_340: G = cst_G in
  let x5_339: G = cst_G in
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(x1_349[@i_427], x2_348[@i_427], Xp[@i_427], Yp[@i_427], Kp[@i_427], r_344[@i_427]) && ((x1 = x1_349[@i_427]) && ((x2 = x2_348[@i_427]) && ((x3 = Xp[@i_427]) && ((x4 = Yp[@i_427]) && (x5 = Kp[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(x1_355[@i_426], x2_354[@i_426], X_s[@i_426], Y[@i_426], K_s[@i_426], r_350[@i_426]) && ((x1 = x1_355[@i_426]) && ((x2 = x2_354[@i_426]) && ((x3 = X_s[@i_426]) && ((x4 = Y[@i_426]) && (x5 = K_s[@i_426]))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(x1_361[@i_425], x2_360[@i_425], X_s[@i_425], Y[@i_425], K_s[@i_425], r_356[@i_425]) && ((x1 = x1_361[@i_425]) && ((x2 = x2_360[@i_425]) && ((x3 = X_s[@i_425]) && ((x4 = Y[@i_425]) && (x5 = K_s[@i_425]))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(x1_367[@i_424], x2_366[@i_424], X[@i_424], @1_x_874[@i_424], K_u_1041[@i_424], r_362[@i_424]) && ((x1 = x1_367[@i_424]) && ((x2 = x2_366[@i_424]) && ((x3 = X[@i_424]) && ((x4 = exp(g, @1_x_874[@i_424])) && (x5 = K_u_1041[@i_424]))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(x1_373[@i_423], x2_372[@i_423], X[@i_423], @1_x_737[@i_240[@i_423]], K_u_1037[@i_423], r_368[@i_423]) && ((x1 = x1_373[@i_423]) && ((x2 = x2_372[@i_423]) && ((x3 = X[@i_423]) && ((x4 = exp(g, @1_x_737[@i_240[@i_423]])) && (x5 = K_u_1037[@i_423]))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(x1_379[@i_422], x2_378[@i_422], X[@i_422], @1_x_737[@i_240[@i_422]], K_u_1037[@i_422], r_374[@i_422]) && ((x1 = x1_379[@i_422]) && ((x2 = x2_378[@i_422]) && ((x3 = X[@i_422]) && ((x4 = exp(g, @1_x_737[@i_240[@i_422]])) && (x5 = K_u_1037[@i_422]))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(x1_385[@i_421], x2_384[@i_421], X[@i_421], @1_x_874[@i_236[@i_421]], K_u_1038[@i_421], r_380[@i_421]) && ((x1 = x1_385[@i_421]) && ((x2 = x2_384[@i_421]) && ((x3 = X[@i_421]) && ((x4 = exp(g, @1_x_874[@i_236[@i_421]])) && (x5 = K_u_1038[@i_421]))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(x1_391[@i_420], x2_390[@i_420], X[@i_420], @1_x_874[@i_236[@i_420]], K_u_1038[@i_420], r_386[@i_420]) && ((x1 = x1_391[@i_420]) && ((x2 = x2_390[@i_420]) && ((x3 = X[@i_420]) && ((x4 = exp(g, @1_x_874[@i_236[@i_420]])) && (x5 = K_u_1038[@i_420]))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(x1_397[@i_419], x2_396[@i_419], X[@i_419], Yp[@i_233[@i_419]], K_u_1039[@i_419], r_392[@i_419]) && ((x1 = x1_397[@i_419]) && ((x2 = x2_396[@i_419]) && ((x3 = X[@i_419]) && ((x4 = Yp[@i_233[@i_419]]) && (x5 = K_u_1039[@i_419]))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(x1_403[@i_418], x2_402[@i_418], X[@i_418], Yp[@i_233[@i_418]], K_u_1039[@i_418], r_398[@i_418]) && ((x1 = x1_403[@i_418]) && ((x2 = x2_402[@i_418]) && ((x3 = X[@i_418]) && ((x4 = Yp[@i_233[@i_418]]) && (x5 = K_u_1039[@i_418]))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(x1_409[@i_417], x2_408[@i_417], X[@i_417], Y[@i_232[@i_417]], K_u_1040[@i_417], r_404[@i_417]) && ((x1 = x1_409[@i_417]) && ((x2 = x2_408[@i_417]) && ((x3 = X[@i_417]) && ((x4 = Y[@i_232[@i_417]]) && (x5 = K_u_1040[@i_417]))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(x1_415[@i_416], x2_414[@i_416], X[@i_416], Y[@i_232[@i_416]], K_u_1040[@i_416], r_410[@i_416]) && ((x1 = x1_415[@i_416]) && ((x2 = x2_414[@i_416]) && ((x3 = X[@i_416]) && ((x4 = Y[@i_232[@i_416]]) && (x5 = K_u_1040[@i_416]))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1037[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1037[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1038[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1038[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1039[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1039[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1040[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1040[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1041[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1041[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of binder K_s yields

Game 25 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = exp(g, @1_x_737[@i_240]) in
    let K_u_1037: G = exp(g, mult(@1_x_737[@i_240], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_737[@i_240]) = x14[@i_115]) && (K_u_1037 = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      find [unique] @i_506 <= qH0 suchthat defined(x1[@i_506], x2[@i_506], x3[@i_506], x4[@i_506], x5[@i_506], r_338[@i_506]) && ((x1_379 = x1[@i_506]) && ((x2_378 = x2[@i_506]) && ((X = x3[@i_506]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_506]) && (K_u_1037 = x5[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_506]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_374);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      find [unique] @i_493 <= qH0 suchthat defined(x1[@i_493], x2[@i_493], x3[@i_493], x4[@i_493], x5[@i_493], r_338[@i_493]) && ((x1_373 = x1[@i_493]) && ((x2_372 = x2[@i_493]) && ((X = x3[@i_493]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_493]) && (K_u_1037 = x5[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_493]);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_368);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = exp(g, @1_x_874[@i_236]) in
    let K_u_1038: G = exp(g, mult(@1_x_874[@i_236], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_874[@i_236]) = x14[@i_115]) && (K_u_1038 = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      find [unique] @i_532 <= qH0 suchthat defined(x1[@i_532], x2[@i_532], x3[@i_532], x4[@i_532], x5[@i_532], r_338[@i_532]) && ((x1_391 = x1[@i_532]) && ((x2_390 = x2[@i_532]) && ((X = x3[@i_532]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_532]) && (K_u_1038 = x5[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_532]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_386);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      find [unique] @i_519 <= qH0 suchthat defined(x1[@i_519], x2[@i_519], x3[@i_519], x4[@i_519], x5[@i_519], r_338[@i_519]) && ((x1_385 = x1[@i_519]) && ((x2_384 = x2[@i_519]) && ((X = x3[@i_519]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_519]) && (K_u_1038 = x5[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_519]);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_380);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u_1039: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u_1039 = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      find [unique] @i_558 <= qH0 suchthat defined(x1[@i_558], x2[@i_558], x3[@i_558], x4[@i_558], x5[@i_558], r_338[@i_558]) && ((x1_403 = x1[@i_558]) && ((x2_402 = x2[@i_558]) && ((X = x3[@i_558]) && ((Yp[@i_233] = x4[@i_558]) && (K_u_1039 = x5[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_558]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_398);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      find [unique] @i_545 <= qH0 suchthat defined(x1[@i_545], x2[@i_545], x3[@i_545], x4[@i_545], x5[@i_545], r_338[@i_545]) && ((x1_397 = x1[@i_545]) && ((x2_396 = x2[@i_545]) && ((X = x3[@i_545]) && ((Yp[@i_233] = x4[@i_545]) && (K_u_1039 = x5[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_545]);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_392);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u_1040: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u_1040 = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      find [unique] @i_584 <= qH0 suchthat defined(x1[@i_584], x2[@i_584], x3[@i_584], x4[@i_584], x5[@i_584], r_338[@i_584]) && ((x1_415 = x1[@i_584]) && ((x2_414 = x2[@i_584]) && ((X = x3[@i_584]) && ((Y[@i_232] = x4[@i_584]) && (K_u_1040 = x5[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_584]);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_350[@i_232]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_410);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      find [unique] @i_571 <= qH0 suchthat defined(x1[@i_571], x2[@i_571], x3[@i_571], x4[@i_571], x5[@i_571], r_338[@i_571]) && ((x1_409 = x1[@i_571]) && ((x2_408 = x2[@i_571]) && ((X = x3[@i_571]) && ((Y[@i_232] = x4[@i_571]) && (K_u_1040 = x5[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_571]);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_404);
        out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    let Y_u: G = exp(g, @1_x_874) in
    let K_u_1041: G = exp(g, mult(@1_x_874, x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (exp(g, mult(x[j], y)) = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      find [unique] @i_454 <= qH0 suchthat defined(x1[@i_454], x2[@i_454], x3[@i_454], x4[@i_454], x5[@i_454], r_338[@i_454]) && ((x1_355 = x1[@i_454]) && ((x2_354 = x2[@i_454]) && ((X_s = x3[@i_454]) && ((Y = x4[@i_454]) && (exp(g, mult(x[j], y)) = x5[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_454])
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_410[j])
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_350)
    )
    orfind  suchthat defined(@i_232[j], r1_94[j], K_u_1040[j]) && (!_58 = @i_232[j]) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (exp(g, mult(x[j], y)) = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = exp(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = exp(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], exp(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], exp(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], exp(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(x1_349[@i_427], x2_348[@i_427], Xp[@i_427], Yp[@i_427], Kp[@i_427], r_344[@i_427]) && ((x1 = x1_349[@i_427]) && ((x2 = x2_348[@i_427]) && ((x3 = Xp[@i_427]) && ((x4 = Yp[@i_427]) && (x5 = Kp[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(y[@i_426], x[j[@i_426]], K_s[@i_426], x1_355[@i_426], x2_354[@i_426], X_s[@i_426], Y[@i_426], r_350[@i_426]) && ((x1 = x1_355[@i_426]) && ((x2 = x2_354[@i_426]) && ((x3 = X_s[@i_426]) && ((x4 = Y[@i_426]) && (x5 = exp(g, mult(x[j[@i_426]], y[@i_426]))))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(y[@i_425], x[j[@i_425]], K_s[@i_425], x1_361[@i_425], x2_360[@i_425], X_s[@i_425], Y[@i_425], r_356[@i_425]) && ((x1 = x1_361[@i_425]) && ((x2 = x2_360[@i_425]) && ((x3 = X_s[@i_425]) && ((x4 = Y[@i_425]) && (x5 = exp(g, mult(x[j[@i_425]], y[@i_425]))))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(x1_367[@i_424], x2_366[@i_424], X[@i_424], @1_x_874[@i_424], K_u_1041[@i_424], r_362[@i_424]) && ((x1 = x1_367[@i_424]) && ((x2 = x2_366[@i_424]) && ((x3 = X[@i_424]) && ((x4 = exp(g, @1_x_874[@i_424])) && (x5 = K_u_1041[@i_424]))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(x1_373[@i_423], x2_372[@i_423], X[@i_423], @1_x_737[@i_240[@i_423]], K_u_1037[@i_423], r_368[@i_423]) && ((x1 = x1_373[@i_423]) && ((x2 = x2_372[@i_423]) && ((x3 = X[@i_423]) && ((x4 = exp(g, @1_x_737[@i_240[@i_423]])) && (x5 = K_u_1037[@i_423]))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(x1_379[@i_422], x2_378[@i_422], X[@i_422], @1_x_737[@i_240[@i_422]], K_u_1037[@i_422], r_374[@i_422]) && ((x1 = x1_379[@i_422]) && ((x2 = x2_378[@i_422]) && ((x3 = X[@i_422]) && ((x4 = exp(g, @1_x_737[@i_240[@i_422]])) && (x5 = K_u_1037[@i_422]))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(x1_385[@i_421], x2_384[@i_421], X[@i_421], @1_x_874[@i_236[@i_421]], K_u_1038[@i_421], r_380[@i_421]) && ((x1 = x1_385[@i_421]) && ((x2 = x2_384[@i_421]) && ((x3 = X[@i_421]) && ((x4 = exp(g, @1_x_874[@i_236[@i_421]])) && (x5 = K_u_1038[@i_421]))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(x1_391[@i_420], x2_390[@i_420], X[@i_420], @1_x_874[@i_236[@i_420]], K_u_1038[@i_420], r_386[@i_420]) && ((x1 = x1_391[@i_420]) && ((x2 = x2_390[@i_420]) && ((x3 = X[@i_420]) && ((x4 = exp(g, @1_x_874[@i_236[@i_420]])) && (x5 = K_u_1038[@i_420]))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(x1_397[@i_419], x2_396[@i_419], X[@i_419], Yp[@i_233[@i_419]], K_u_1039[@i_419], r_392[@i_419]) && ((x1 = x1_397[@i_419]) && ((x2 = x2_396[@i_419]) && ((x3 = X[@i_419]) && ((x4 = Yp[@i_233[@i_419]]) && (x5 = K_u_1039[@i_419]))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(x1_403[@i_418], x2_402[@i_418], X[@i_418], Yp[@i_233[@i_418]], K_u_1039[@i_418], r_398[@i_418]) && ((x1 = x1_403[@i_418]) && ((x2 = x2_402[@i_418]) && ((x3 = X[@i_418]) && ((x4 = Yp[@i_233[@i_418]]) && (x5 = K_u_1039[@i_418]))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(x1_409[@i_417], x2_408[@i_417], X[@i_417], Y[@i_232[@i_417]], K_u_1040[@i_417], r_404[@i_417]) && ((x1 = x1_409[@i_417]) && ((x2 = x2_408[@i_417]) && ((x3 = X[@i_417]) && ((x4 = Y[@i_232[@i_417]]) && (x5 = K_u_1040[@i_417]))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(x1_415[@i_416], x2_414[@i_416], X[@i_416], Y[@i_232[@i_416]], K_u_1040[@i_416], r_410[@i_416]) && ((x1 = x1_415[@i_416]) && ((x2 = x2_414[@i_416]) && ((x3 = X[@i_416]) && ((x4 = Y[@i_232[@i_416]]) && (x5 = K_u_1040[@i_416]))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1037[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1037[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1038[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1038[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1039[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1039[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1040[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1040[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1041[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1041[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of binder K_u_1041 yields

Game 26 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = exp(g, @1_x_737[@i_240]) in
    let K_u_1037: G = exp(g, mult(@1_x_737[@i_240], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_737[@i_240]) = x14[@i_115]) && (K_u_1037 = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      find [unique] @i_506 <= qH0 suchthat defined(x1[@i_506], x2[@i_506], x3[@i_506], x4[@i_506], x5[@i_506], r_338[@i_506]) && ((x1_379 = x1[@i_506]) && ((x2_378 = x2[@i_506]) && ((X = x3[@i_506]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_506]) && (K_u_1037 = x5[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_506]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_374);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      find [unique] @i_493 <= qH0 suchthat defined(x1[@i_493], x2[@i_493], x3[@i_493], x4[@i_493], x5[@i_493], r_338[@i_493]) && ((x1_373 = x1[@i_493]) && ((x2_372 = x2[@i_493]) && ((X = x3[@i_493]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_493]) && (K_u_1037 = x5[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_493]);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_368);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = exp(g, @1_x_874[@i_236]) in
    let K_u_1038: G = exp(g, mult(@1_x_874[@i_236], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_874[@i_236]) = x14[@i_115]) && (K_u_1038 = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      find [unique] @i_532 <= qH0 suchthat defined(x1[@i_532], x2[@i_532], x3[@i_532], x4[@i_532], x5[@i_532], r_338[@i_532]) && ((x1_391 = x1[@i_532]) && ((x2_390 = x2[@i_532]) && ((X = x3[@i_532]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_532]) && (K_u_1038 = x5[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_532]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_386);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      find [unique] @i_519 <= qH0 suchthat defined(x1[@i_519], x2[@i_519], x3[@i_519], x4[@i_519], x5[@i_519], r_338[@i_519]) && ((x1_385 = x1[@i_519]) && ((x2_384 = x2[@i_519]) && ((X = x3[@i_519]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_519]) && (K_u_1038 = x5[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_519]);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_380);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u_1039: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u_1039 = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      find [unique] @i_558 <= qH0 suchthat defined(x1[@i_558], x2[@i_558], x3[@i_558], x4[@i_558], x5[@i_558], r_338[@i_558]) && ((x1_403 = x1[@i_558]) && ((x2_402 = x2[@i_558]) && ((X = x3[@i_558]) && ((Yp[@i_233] = x4[@i_558]) && (K_u_1039 = x5[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_558]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_398);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      find [unique] @i_545 <= qH0 suchthat defined(x1[@i_545], x2[@i_545], x3[@i_545], x4[@i_545], x5[@i_545], r_338[@i_545]) && ((x1_397 = x1[@i_545]) && ((x2_396 = x2[@i_545]) && ((X = x3[@i_545]) && ((Yp[@i_233] = x4[@i_545]) && (K_u_1039 = x5[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_545]);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_392);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u_1040: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u_1040 = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      find [unique] @i_584 <= qH0 suchthat defined(x1[@i_584], x2[@i_584], x3[@i_584], x4[@i_584], x5[@i_584], r_338[@i_584]) && ((x1_415 = x1[@i_584]) && ((x2_414 = x2[@i_584]) && ((X = x3[@i_584]) && ((Y[@i_232] = x4[@i_584]) && (K_u_1040 = x5[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_584]);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_350[@i_232]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_410);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      find [unique] @i_571 <= qH0 suchthat defined(x1[@i_571], x2[@i_571], x3[@i_571], x4[@i_571], x5[@i_571], r_338[@i_571]) && ((x1_409 = x1[@i_571]) && ((x2_408 = x2[@i_571]) && ((X = x3[@i_571]) && ((Y[@i_232] = x4[@i_571]) && (K_u_1040 = x5[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_571]);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_404);
        out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    let Y_u: G = exp(g, @1_x_874) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (exp(g, mult(x[j], y)) = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      find [unique] @i_454 <= qH0 suchthat defined(x1[@i_454], x2[@i_454], x3[@i_454], x4[@i_454], x5[@i_454], r_338[@i_454]) && ((x1_355 = x1[@i_454]) && ((x2_354 = x2[@i_454]) && ((X_s = x3[@i_454]) && ((Y = x4[@i_454]) && (exp(g, mult(x[j], y)) = x5[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_454])
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_410[j])
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_350)
    )
    orfind  suchthat defined(@i_232[j], r1_94[j], K_u_1040[j]) && (!_58 = @i_232[j]) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (exp(g, mult(x[j], y)) = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = exp(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = exp(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], exp(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], exp(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], exp(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(x1_349[@i_427], x2_348[@i_427], Xp[@i_427], Yp[@i_427], Kp[@i_427], r_344[@i_427]) && ((x1 = x1_349[@i_427]) && ((x2 = x2_348[@i_427]) && ((x3 = Xp[@i_427]) && ((x4 = Yp[@i_427]) && (x5 = Kp[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(y[@i_426], x[j[@i_426]], K_s[@i_426], x1_355[@i_426], x2_354[@i_426], X_s[@i_426], Y[@i_426], r_350[@i_426]) && ((x1 = x1_355[@i_426]) && ((x2 = x2_354[@i_426]) && ((x3 = X_s[@i_426]) && ((x4 = Y[@i_426]) && (x5 = exp(g, mult(x[j[@i_426]], y[@i_426]))))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(y[@i_425], x[j[@i_425]], K_s[@i_425], x1_361[@i_425], x2_360[@i_425], X_s[@i_425], Y[@i_425], r_356[@i_425]) && ((x1 = x1_361[@i_425]) && ((x2 = x2_360[@i_425]) && ((x3 = X_s[@i_425]) && ((x4 = Y[@i_425]) && (x5 = exp(g, mult(x[j[@i_425]], y[@i_425]))))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(x[@i_424], @1_x_874[@i_424], x1_367[@i_424], x2_366[@i_424], X[@i_424], @1_x_874[@i_424], r_362[@i_424]) && ((x1 = x1_367[@i_424]) && ((x2 = x2_366[@i_424]) && ((x3 = X[@i_424]) && ((x4 = exp(g, @1_x_874[@i_424])) && (x5 = exp(g, mult(@1_x_874[@i_424], x[@i_424]))))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(x1_373[@i_423], x2_372[@i_423], X[@i_423], @1_x_737[@i_240[@i_423]], K_u_1037[@i_423], r_368[@i_423]) && ((x1 = x1_373[@i_423]) && ((x2 = x2_372[@i_423]) && ((x3 = X[@i_423]) && ((x4 = exp(g, @1_x_737[@i_240[@i_423]])) && (x5 = K_u_1037[@i_423]))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(x1_379[@i_422], x2_378[@i_422], X[@i_422], @1_x_737[@i_240[@i_422]], K_u_1037[@i_422], r_374[@i_422]) && ((x1 = x1_379[@i_422]) && ((x2 = x2_378[@i_422]) && ((x3 = X[@i_422]) && ((x4 = exp(g, @1_x_737[@i_240[@i_422]])) && (x5 = K_u_1037[@i_422]))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(x1_385[@i_421], x2_384[@i_421], X[@i_421], @1_x_874[@i_236[@i_421]], K_u_1038[@i_421], r_380[@i_421]) && ((x1 = x1_385[@i_421]) && ((x2 = x2_384[@i_421]) && ((x3 = X[@i_421]) && ((x4 = exp(g, @1_x_874[@i_236[@i_421]])) && (x5 = K_u_1038[@i_421]))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(x1_391[@i_420], x2_390[@i_420], X[@i_420], @1_x_874[@i_236[@i_420]], K_u_1038[@i_420], r_386[@i_420]) && ((x1 = x1_391[@i_420]) && ((x2 = x2_390[@i_420]) && ((x3 = X[@i_420]) && ((x4 = exp(g, @1_x_874[@i_236[@i_420]])) && (x5 = K_u_1038[@i_420]))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(x1_397[@i_419], x2_396[@i_419], X[@i_419], Yp[@i_233[@i_419]], K_u_1039[@i_419], r_392[@i_419]) && ((x1 = x1_397[@i_419]) && ((x2 = x2_396[@i_419]) && ((x3 = X[@i_419]) && ((x4 = Yp[@i_233[@i_419]]) && (x5 = K_u_1039[@i_419]))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(x1_403[@i_418], x2_402[@i_418], X[@i_418], Yp[@i_233[@i_418]], K_u_1039[@i_418], r_398[@i_418]) && ((x1 = x1_403[@i_418]) && ((x2 = x2_402[@i_418]) && ((x3 = X[@i_418]) && ((x4 = Yp[@i_233[@i_418]]) && (x5 = K_u_1039[@i_418]))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(x1_409[@i_417], x2_408[@i_417], X[@i_417], Y[@i_232[@i_417]], K_u_1040[@i_417], r_404[@i_417]) && ((x1 = x1_409[@i_417]) && ((x2 = x2_408[@i_417]) && ((x3 = X[@i_417]) && ((x4 = Y[@i_232[@i_417]]) && (x5 = K_u_1040[@i_417]))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(x1_415[@i_416], x2_414[@i_416], X[@i_416], Y[@i_232[@i_416]], K_u_1040[@i_416], r_410[@i_416]) && ((x1 = x1_415[@i_416]) && ((x2 = x2_414[@i_416]) && ((x3 = X[@i_416]) && ((x4 = Y[@i_232[@i_416]]) && (x5 = K_u_1040[@i_416]))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1037[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1037[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1038[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1038[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1039[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1039[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1040[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1040[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_874[@i_100], @1_x_874[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(@1_x_874[@i_100], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of binder K_u_1037 yields

Game 27 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = exp(g, @1_x_737[@i_240]) in
    let K_u_1037: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_737[@i_240]) = x14[@i_115]) && (exp(g, mult(@1_x_737[@i_240], x)) = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      find [unique] @i_506 <= qH0 suchthat defined(x1[@i_506], x2[@i_506], x3[@i_506], x4[@i_506], x5[@i_506], r_338[@i_506]) && ((x1_379 = x1[@i_506]) && ((x2_378 = x2[@i_506]) && ((X = x3[@i_506]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_506]) && (exp(g, mult(@1_x_737[@i_240], x)) = x5[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_506]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_374);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      find [unique] @i_493 <= qH0 suchthat defined(x1[@i_493], x2[@i_493], x3[@i_493], x4[@i_493], x5[@i_493], r_338[@i_493]) && ((x1_373 = x1[@i_493]) && ((x2_372 = x2[@i_493]) && ((X = x3[@i_493]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_493]) && (exp(g, mult(@1_x_737[@i_240], x)) = x5[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_493]);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_368);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = exp(g, @1_x_874[@i_236]) in
    let K_u_1038: G = exp(g, mult(@1_x_874[@i_236], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_874[@i_236]) = x14[@i_115]) && (K_u_1038 = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      find [unique] @i_532 <= qH0 suchthat defined(x1[@i_532], x2[@i_532], x3[@i_532], x4[@i_532], x5[@i_532], r_338[@i_532]) && ((x1_391 = x1[@i_532]) && ((x2_390 = x2[@i_532]) && ((X = x3[@i_532]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_532]) && (K_u_1038 = x5[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_532]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_386);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      find [unique] @i_519 <= qH0 suchthat defined(x1[@i_519], x2[@i_519], x3[@i_519], x4[@i_519], x5[@i_519], r_338[@i_519]) && ((x1_385 = x1[@i_519]) && ((x2_384 = x2[@i_519]) && ((X = x3[@i_519]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_519]) && (K_u_1038 = x5[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_519]);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_380);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u_1039: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u_1039 = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      find [unique] @i_558 <= qH0 suchthat defined(x1[@i_558], x2[@i_558], x3[@i_558], x4[@i_558], x5[@i_558], r_338[@i_558]) && ((x1_403 = x1[@i_558]) && ((x2_402 = x2[@i_558]) && ((X = x3[@i_558]) && ((Yp[@i_233] = x4[@i_558]) && (K_u_1039 = x5[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_558]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_398);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      find [unique] @i_545 <= qH0 suchthat defined(x1[@i_545], x2[@i_545], x3[@i_545], x4[@i_545], x5[@i_545], r_338[@i_545]) && ((x1_397 = x1[@i_545]) && ((x2_396 = x2[@i_545]) && ((X = x3[@i_545]) && ((Yp[@i_233] = x4[@i_545]) && (K_u_1039 = x5[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_545]);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_392);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u_1040: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u_1040 = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      find [unique] @i_584 <= qH0 suchthat defined(x1[@i_584], x2[@i_584], x3[@i_584], x4[@i_584], x5[@i_584], r_338[@i_584]) && ((x1_415 = x1[@i_584]) && ((x2_414 = x2[@i_584]) && ((X = x3[@i_584]) && ((Y[@i_232] = x4[@i_584]) && (K_u_1040 = x5[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_584]);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_350[@i_232]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_410);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      find [unique] @i_571 <= qH0 suchthat defined(x1[@i_571], x2[@i_571], x3[@i_571], x4[@i_571], x5[@i_571], r_338[@i_571]) && ((x1_409 = x1[@i_571]) && ((x2_408 = x2[@i_571]) && ((X = x3[@i_571]) && ((Y[@i_232] = x4[@i_571]) && (K_u_1040 = x5[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_571]);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_404);
        out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    let Y_u: G = exp(g, @1_x_874) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (exp(g, mult(x[j], y)) = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      find [unique] @i_454 <= qH0 suchthat defined(x1[@i_454], x2[@i_454], x3[@i_454], x4[@i_454], x5[@i_454], r_338[@i_454]) && ((x1_355 = x1[@i_454]) && ((x2_354 = x2[@i_454]) && ((X_s = x3[@i_454]) && ((Y = x4[@i_454]) && (exp(g, mult(x[j], y)) = x5[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_454])
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_410[j])
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_350)
    )
    orfind  suchthat defined(@i_232[j], r1_94[j], K_u_1040[j]) && (!_58 = @i_232[j]) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (exp(g, mult(x[j], y)) = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = exp(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = exp(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], exp(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], exp(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], exp(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(x1_349[@i_427], x2_348[@i_427], Xp[@i_427], Yp[@i_427], Kp[@i_427], r_344[@i_427]) && ((x1 = x1_349[@i_427]) && ((x2 = x2_348[@i_427]) && ((x3 = Xp[@i_427]) && ((x4 = Yp[@i_427]) && (x5 = Kp[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(y[@i_426], x[j[@i_426]], K_s[@i_426], x1_355[@i_426], x2_354[@i_426], X_s[@i_426], Y[@i_426], r_350[@i_426]) && ((x1 = x1_355[@i_426]) && ((x2 = x2_354[@i_426]) && ((x3 = X_s[@i_426]) && ((x4 = Y[@i_426]) && (x5 = exp(g, mult(x[j[@i_426]], y[@i_426]))))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(y[@i_425], x[j[@i_425]], K_s[@i_425], x1_361[@i_425], x2_360[@i_425], X_s[@i_425], Y[@i_425], r_356[@i_425]) && ((x1 = x1_361[@i_425]) && ((x2 = x2_360[@i_425]) && ((x3 = X_s[@i_425]) && ((x4 = Y[@i_425]) && (x5 = exp(g, mult(x[j[@i_425]], y[@i_425]))))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(x[@i_424], @1_x_874[@i_424], x1_367[@i_424], x2_366[@i_424], X[@i_424], @1_x_874[@i_424], r_362[@i_424]) && ((x1 = x1_367[@i_424]) && ((x2 = x2_366[@i_424]) && ((x3 = X[@i_424]) && ((x4 = exp(g, @1_x_874[@i_424])) && (x5 = exp(g, mult(@1_x_874[@i_424], x[@i_424]))))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(x[@i_423], K_u_1037[@i_423], x1_373[@i_423], x2_372[@i_423], X[@i_423], @1_x_737[@i_240[@i_423]], r_368[@i_423]) && ((x1 = x1_373[@i_423]) && ((x2 = x2_372[@i_423]) && ((x3 = X[@i_423]) && ((x4 = exp(g, @1_x_737[@i_240[@i_423]])) && (x5 = exp(g, mult(@1_x_737[@i_240[@i_423]], x[@i_423]))))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(x[@i_422], K_u_1037[@i_422], x1_379[@i_422], x2_378[@i_422], X[@i_422], @1_x_737[@i_240[@i_422]], r_374[@i_422]) && ((x1 = x1_379[@i_422]) && ((x2 = x2_378[@i_422]) && ((x3 = X[@i_422]) && ((x4 = exp(g, @1_x_737[@i_240[@i_422]])) && (x5 = exp(g, mult(@1_x_737[@i_240[@i_422]], x[@i_422]))))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(x1_385[@i_421], x2_384[@i_421], X[@i_421], @1_x_874[@i_236[@i_421]], K_u_1038[@i_421], r_380[@i_421]) && ((x1 = x1_385[@i_421]) && ((x2 = x2_384[@i_421]) && ((x3 = X[@i_421]) && ((x4 = exp(g, @1_x_874[@i_236[@i_421]])) && (x5 = K_u_1038[@i_421]))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(x1_391[@i_420], x2_390[@i_420], X[@i_420], @1_x_874[@i_236[@i_420]], K_u_1038[@i_420], r_386[@i_420]) && ((x1 = x1_391[@i_420]) && ((x2 = x2_390[@i_420]) && ((x3 = X[@i_420]) && ((x4 = exp(g, @1_x_874[@i_236[@i_420]])) && (x5 = K_u_1038[@i_420]))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(x1_397[@i_419], x2_396[@i_419], X[@i_419], Yp[@i_233[@i_419]], K_u_1039[@i_419], r_392[@i_419]) && ((x1 = x1_397[@i_419]) && ((x2 = x2_396[@i_419]) && ((x3 = X[@i_419]) && ((x4 = Yp[@i_233[@i_419]]) && (x5 = K_u_1039[@i_419]))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(x1_403[@i_418], x2_402[@i_418], X[@i_418], Yp[@i_233[@i_418]], K_u_1039[@i_418], r_398[@i_418]) && ((x1 = x1_403[@i_418]) && ((x2 = x2_402[@i_418]) && ((x3 = X[@i_418]) && ((x4 = Yp[@i_233[@i_418]]) && (x5 = K_u_1039[@i_418]))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(x1_409[@i_417], x2_408[@i_417], X[@i_417], Y[@i_232[@i_417]], K_u_1040[@i_417], r_404[@i_417]) && ((x1 = x1_409[@i_417]) && ((x2 = x2_408[@i_417]) && ((x3 = X[@i_417]) && ((x4 = Y[@i_232[@i_417]]) && (x5 = K_u_1040[@i_417]))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(x1_415[@i_416], x2_414[@i_416], X[@i_416], Y[@i_232[@i_416]], K_u_1040[@i_416], r_410[@i_416]) && ((x1 = x1_415[@i_416]) && ((x2 = x2_414[@i_416]) && ((x3 = X[@i_416]) && ((x4 = Y[@i_232[@i_416]]) && (x5 = K_u_1040[@i_416]))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_737[@i_240[@i_100]], K_u_1037[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(@1_x_737[@i_240[@i_100]], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1038[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1038[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1039[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1039[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1040[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1040[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_874[@i_100], @1_x_874[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(@1_x_874[@i_100], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of binder K_u_1038 yields

Game 28 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = exp(g, @1_x_737[@i_240]) in
    let K_u_1037: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_737[@i_240]) = x14[@i_115]) && (exp(g, mult(@1_x_737[@i_240], x)) = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      find [unique] @i_506 <= qH0 suchthat defined(x1[@i_506], x2[@i_506], x3[@i_506], x4[@i_506], x5[@i_506], r_338[@i_506]) && ((x1_379 = x1[@i_506]) && ((x2_378 = x2[@i_506]) && ((X = x3[@i_506]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_506]) && (exp(g, mult(@1_x_737[@i_240], x)) = x5[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_506]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_374);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      find [unique] @i_493 <= qH0 suchthat defined(x1[@i_493], x2[@i_493], x3[@i_493], x4[@i_493], x5[@i_493], r_338[@i_493]) && ((x1_373 = x1[@i_493]) && ((x2_372 = x2[@i_493]) && ((X = x3[@i_493]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_493]) && (exp(g, mult(@1_x_737[@i_240], x)) = x5[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_493]);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_368);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = exp(g, @1_x_874[@i_236]) in
    let K_u_1038: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_874[@i_236]) = x14[@i_115]) && (exp(g, mult(@1_x_874[@i_236], x)) = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      find [unique] @i_532 <= qH0 suchthat defined(x1[@i_532], x2[@i_532], x3[@i_532], x4[@i_532], x5[@i_532], r_338[@i_532]) && ((x1_391 = x1[@i_532]) && ((x2_390 = x2[@i_532]) && ((X = x3[@i_532]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_532]) && (exp(g, mult(@1_x_874[@i_236], x)) = x5[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_532]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_386);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      find [unique] @i_519 <= qH0 suchthat defined(x1[@i_519], x2[@i_519], x3[@i_519], x4[@i_519], x5[@i_519], r_338[@i_519]) && ((x1_385 = x1[@i_519]) && ((x2_384 = x2[@i_519]) && ((X = x3[@i_519]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_519]) && (exp(g, mult(@1_x_874[@i_236], x)) = x5[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_519]);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_380);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u_1039: G = exp(g, mult(yp[@i_233], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (K_u_1039 = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      find [unique] @i_558 <= qH0 suchthat defined(x1[@i_558], x2[@i_558], x3[@i_558], x4[@i_558], x5[@i_558], r_338[@i_558]) && ((x1_403 = x1[@i_558]) && ((x2_402 = x2[@i_558]) && ((X = x3[@i_558]) && ((Yp[@i_233] = x4[@i_558]) && (K_u_1039 = x5[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_558]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_398);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      find [unique] @i_545 <= qH0 suchthat defined(x1[@i_545], x2[@i_545], x3[@i_545], x4[@i_545], x5[@i_545], r_338[@i_545]) && ((x1_397 = x1[@i_545]) && ((x2_396 = x2[@i_545]) && ((X = x3[@i_545]) && ((Yp[@i_233] = x4[@i_545]) && (K_u_1039 = x5[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_545]);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_392);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u_1040: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u_1040 = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      find [unique] @i_584 <= qH0 suchthat defined(x1[@i_584], x2[@i_584], x3[@i_584], x4[@i_584], x5[@i_584], r_338[@i_584]) && ((x1_415 = x1[@i_584]) && ((x2_414 = x2[@i_584]) && ((X = x3[@i_584]) && ((Y[@i_232] = x4[@i_584]) && (K_u_1040 = x5[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_584]);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_350[@i_232]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_410);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      find [unique] @i_571 <= qH0 suchthat defined(x1[@i_571], x2[@i_571], x3[@i_571], x4[@i_571], x5[@i_571], r_338[@i_571]) && ((x1_409 = x1[@i_571]) && ((x2_408 = x2[@i_571]) && ((X = x3[@i_571]) && ((Y[@i_232] = x4[@i_571]) && (K_u_1040 = x5[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_571]);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_404);
        out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    let Y_u: G = exp(g, @1_x_874) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (exp(g, mult(x[j], y)) = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      find [unique] @i_454 <= qH0 suchthat defined(x1[@i_454], x2[@i_454], x3[@i_454], x4[@i_454], x5[@i_454], r_338[@i_454]) && ((x1_355 = x1[@i_454]) && ((x2_354 = x2[@i_454]) && ((X_s = x3[@i_454]) && ((Y = x4[@i_454]) && (exp(g, mult(x[j], y)) = x5[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_454])
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_410[j])
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_350)
    )
    orfind  suchthat defined(@i_232[j], r1_94[j], K_u_1040[j]) && (!_58 = @i_232[j]) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (exp(g, mult(x[j], y)) = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = exp(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = exp(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], exp(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], exp(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], exp(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(x1_349[@i_427], x2_348[@i_427], Xp[@i_427], Yp[@i_427], Kp[@i_427], r_344[@i_427]) && ((x1 = x1_349[@i_427]) && ((x2 = x2_348[@i_427]) && ((x3 = Xp[@i_427]) && ((x4 = Yp[@i_427]) && (x5 = Kp[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(y[@i_426], x[j[@i_426]], K_s[@i_426], x1_355[@i_426], x2_354[@i_426], X_s[@i_426], Y[@i_426], r_350[@i_426]) && ((x1 = x1_355[@i_426]) && ((x2 = x2_354[@i_426]) && ((x3 = X_s[@i_426]) && ((x4 = Y[@i_426]) && (x5 = exp(g, mult(x[j[@i_426]], y[@i_426]))))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(y[@i_425], x[j[@i_425]], K_s[@i_425], x1_361[@i_425], x2_360[@i_425], X_s[@i_425], Y[@i_425], r_356[@i_425]) && ((x1 = x1_361[@i_425]) && ((x2 = x2_360[@i_425]) && ((x3 = X_s[@i_425]) && ((x4 = Y[@i_425]) && (x5 = exp(g, mult(x[j[@i_425]], y[@i_425]))))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(x[@i_424], @1_x_874[@i_424], x1_367[@i_424], x2_366[@i_424], X[@i_424], @1_x_874[@i_424], r_362[@i_424]) && ((x1 = x1_367[@i_424]) && ((x2 = x2_366[@i_424]) && ((x3 = X[@i_424]) && ((x4 = exp(g, @1_x_874[@i_424])) && (x5 = exp(g, mult(@1_x_874[@i_424], x[@i_424]))))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(x[@i_423], K_u_1037[@i_423], x1_373[@i_423], x2_372[@i_423], X[@i_423], @1_x_737[@i_240[@i_423]], r_368[@i_423]) && ((x1 = x1_373[@i_423]) && ((x2 = x2_372[@i_423]) && ((x3 = X[@i_423]) && ((x4 = exp(g, @1_x_737[@i_240[@i_423]])) && (x5 = exp(g, mult(@1_x_737[@i_240[@i_423]], x[@i_423]))))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(x[@i_422], K_u_1037[@i_422], x1_379[@i_422], x2_378[@i_422], X[@i_422], @1_x_737[@i_240[@i_422]], r_374[@i_422]) && ((x1 = x1_379[@i_422]) && ((x2 = x2_378[@i_422]) && ((x3 = X[@i_422]) && ((x4 = exp(g, @1_x_737[@i_240[@i_422]])) && (x5 = exp(g, mult(@1_x_737[@i_240[@i_422]], x[@i_422]))))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(x[@i_421], K_u_1038[@i_421], x1_385[@i_421], x2_384[@i_421], X[@i_421], @1_x_874[@i_236[@i_421]], r_380[@i_421]) && ((x1 = x1_385[@i_421]) && ((x2 = x2_384[@i_421]) && ((x3 = X[@i_421]) && ((x4 = exp(g, @1_x_874[@i_236[@i_421]])) && (x5 = exp(g, mult(@1_x_874[@i_236[@i_421]], x[@i_421]))))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(x[@i_420], K_u_1038[@i_420], x1_391[@i_420], x2_390[@i_420], X[@i_420], @1_x_874[@i_236[@i_420]], r_386[@i_420]) && ((x1 = x1_391[@i_420]) && ((x2 = x2_390[@i_420]) && ((x3 = X[@i_420]) && ((x4 = exp(g, @1_x_874[@i_236[@i_420]])) && (x5 = exp(g, mult(@1_x_874[@i_236[@i_420]], x[@i_420]))))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(x1_397[@i_419], x2_396[@i_419], X[@i_419], Yp[@i_233[@i_419]], K_u_1039[@i_419], r_392[@i_419]) && ((x1 = x1_397[@i_419]) && ((x2 = x2_396[@i_419]) && ((x3 = X[@i_419]) && ((x4 = Yp[@i_233[@i_419]]) && (x5 = K_u_1039[@i_419]))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(x1_403[@i_418], x2_402[@i_418], X[@i_418], Yp[@i_233[@i_418]], K_u_1039[@i_418], r_398[@i_418]) && ((x1 = x1_403[@i_418]) && ((x2 = x2_402[@i_418]) && ((x3 = X[@i_418]) && ((x4 = Yp[@i_233[@i_418]]) && (x5 = K_u_1039[@i_418]))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(x1_409[@i_417], x2_408[@i_417], X[@i_417], Y[@i_232[@i_417]], K_u_1040[@i_417], r_404[@i_417]) && ((x1 = x1_409[@i_417]) && ((x2 = x2_408[@i_417]) && ((x3 = X[@i_417]) && ((x4 = Y[@i_232[@i_417]]) && (x5 = K_u_1040[@i_417]))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(x1_415[@i_416], x2_414[@i_416], X[@i_416], Y[@i_232[@i_416]], K_u_1040[@i_416], r_410[@i_416]) && ((x1 = x1_415[@i_416]) && ((x2 = x2_414[@i_416]) && ((x3 = X[@i_416]) && ((x4 = Y[@i_232[@i_416]]) && (x5 = K_u_1040[@i_416]))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_737[@i_240[@i_100]], K_u_1037[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(@1_x_737[@i_240[@i_100]], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_874[@i_236[@i_100]], K_u_1038[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(@1_x_874[@i_236[@i_100]], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1039[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1039[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1040[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1040[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_874[@i_100], @1_x_874[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(@1_x_874[@i_100], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of binder K_u_1039 yields

Game 29 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = exp(g, @1_x_737[@i_240]) in
    let K_u_1037: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_737[@i_240]) = x14[@i_115]) && (exp(g, mult(@1_x_737[@i_240], x)) = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      find [unique] @i_506 <= qH0 suchthat defined(x1[@i_506], x2[@i_506], x3[@i_506], x4[@i_506], x5[@i_506], r_338[@i_506]) && ((x1_379 = x1[@i_506]) && ((x2_378 = x2[@i_506]) && ((X = x3[@i_506]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_506]) && (exp(g, mult(@1_x_737[@i_240], x)) = x5[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_506]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_374);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      find [unique] @i_493 <= qH0 suchthat defined(x1[@i_493], x2[@i_493], x3[@i_493], x4[@i_493], x5[@i_493], r_338[@i_493]) && ((x1_373 = x1[@i_493]) && ((x2_372 = x2[@i_493]) && ((X = x3[@i_493]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_493]) && (exp(g, mult(@1_x_737[@i_240], x)) = x5[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_493]);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_368);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = exp(g, @1_x_874[@i_236]) in
    let K_u_1038: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_874[@i_236]) = x14[@i_115]) && (exp(g, mult(@1_x_874[@i_236], x)) = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      find [unique] @i_532 <= qH0 suchthat defined(x1[@i_532], x2[@i_532], x3[@i_532], x4[@i_532], x5[@i_532], r_338[@i_532]) && ((x1_391 = x1[@i_532]) && ((x2_390 = x2[@i_532]) && ((X = x3[@i_532]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_532]) && (exp(g, mult(@1_x_874[@i_236], x)) = x5[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_532]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_386);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      find [unique] @i_519 <= qH0 suchthat defined(x1[@i_519], x2[@i_519], x3[@i_519], x4[@i_519], x5[@i_519], r_338[@i_519]) && ((x1_385 = x1[@i_519]) && ((x2_384 = x2[@i_519]) && ((X = x3[@i_519]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_519]) && (exp(g, mult(@1_x_874[@i_236], x)) = x5[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_519]);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_380);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u_1039: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (exp(g, mult(yp[@i_233], x)) = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      find [unique] @i_558 <= qH0 suchthat defined(x1[@i_558], x2[@i_558], x3[@i_558], x4[@i_558], x5[@i_558], r_338[@i_558]) && ((x1_403 = x1[@i_558]) && ((x2_402 = x2[@i_558]) && ((X = x3[@i_558]) && ((Yp[@i_233] = x4[@i_558]) && (exp(g, mult(yp[@i_233], x)) = x5[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_558]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_398);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      find [unique] @i_545 <= qH0 suchthat defined(x1[@i_545], x2[@i_545], x3[@i_545], x4[@i_545], x5[@i_545], r_338[@i_545]) && ((x1_397 = x1[@i_545]) && ((x2_396 = x2[@i_545]) && ((X = x3[@i_545]) && ((Yp[@i_233] = x4[@i_545]) && (exp(g, mult(yp[@i_233], x)) = x5[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_545]);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_392);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u_1040: G = exp(g, mult(y[@i_232], x)) in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (K_u_1040 = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      find [unique] @i_584 <= qH0 suchthat defined(x1[@i_584], x2[@i_584], x3[@i_584], x4[@i_584], x5[@i_584], r_338[@i_584]) && ((x1_415 = x1[@i_584]) && ((x2_414 = x2[@i_584]) && ((X = x3[@i_584]) && ((Y[@i_232] = x4[@i_584]) && (K_u_1040 = x5[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_584]);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_350[@i_232]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_410);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      find [unique] @i_571 <= qH0 suchthat defined(x1[@i_571], x2[@i_571], x3[@i_571], x4[@i_571], x5[@i_571], r_338[@i_571]) && ((x1_409 = x1[@i_571]) && ((x2_408 = x2[@i_571]) && ((X = x3[@i_571]) && ((Y[@i_232] = x4[@i_571]) && (K_u_1040 = x5[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_571]);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_404);
        out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    let Y_u: G = exp(g, @1_x_874) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (exp(g, mult(x[j], y)) = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      find [unique] @i_454 <= qH0 suchthat defined(x1[@i_454], x2[@i_454], x3[@i_454], x4[@i_454], x5[@i_454], r_338[@i_454]) && ((x1_355 = x1[@i_454]) && ((x2_354 = x2[@i_454]) && ((X_s = x3[@i_454]) && ((Y = x4[@i_454]) && (exp(g, mult(x[j], y)) = x5[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_454])
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_410[j])
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_350)
    )
    orfind  suchthat defined(@i_232[j], r1_94[j], K_u_1040[j]) && (!_58 = @i_232[j]) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (exp(g, mult(x[j], y)) = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = exp(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = exp(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], exp(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], exp(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], exp(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(x1_349[@i_427], x2_348[@i_427], Xp[@i_427], Yp[@i_427], Kp[@i_427], r_344[@i_427]) && ((x1 = x1_349[@i_427]) && ((x2 = x2_348[@i_427]) && ((x3 = Xp[@i_427]) && ((x4 = Yp[@i_427]) && (x5 = Kp[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(y[@i_426], x[j[@i_426]], K_s[@i_426], x1_355[@i_426], x2_354[@i_426], X_s[@i_426], Y[@i_426], r_350[@i_426]) && ((x1 = x1_355[@i_426]) && ((x2 = x2_354[@i_426]) && ((x3 = X_s[@i_426]) && ((x4 = Y[@i_426]) && (x5 = exp(g, mult(x[j[@i_426]], y[@i_426]))))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(y[@i_425], x[j[@i_425]], K_s[@i_425], x1_361[@i_425], x2_360[@i_425], X_s[@i_425], Y[@i_425], r_356[@i_425]) && ((x1 = x1_361[@i_425]) && ((x2 = x2_360[@i_425]) && ((x3 = X_s[@i_425]) && ((x4 = Y[@i_425]) && (x5 = exp(g, mult(x[j[@i_425]], y[@i_425]))))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(x[@i_424], @1_x_874[@i_424], x1_367[@i_424], x2_366[@i_424], X[@i_424], @1_x_874[@i_424], r_362[@i_424]) && ((x1 = x1_367[@i_424]) && ((x2 = x2_366[@i_424]) && ((x3 = X[@i_424]) && ((x4 = exp(g, @1_x_874[@i_424])) && (x5 = exp(g, mult(@1_x_874[@i_424], x[@i_424]))))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(x[@i_423], K_u_1037[@i_423], x1_373[@i_423], x2_372[@i_423], X[@i_423], @1_x_737[@i_240[@i_423]], r_368[@i_423]) && ((x1 = x1_373[@i_423]) && ((x2 = x2_372[@i_423]) && ((x3 = X[@i_423]) && ((x4 = exp(g, @1_x_737[@i_240[@i_423]])) && (x5 = exp(g, mult(@1_x_737[@i_240[@i_423]], x[@i_423]))))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(x[@i_422], K_u_1037[@i_422], x1_379[@i_422], x2_378[@i_422], X[@i_422], @1_x_737[@i_240[@i_422]], r_374[@i_422]) && ((x1 = x1_379[@i_422]) && ((x2 = x2_378[@i_422]) && ((x3 = X[@i_422]) && ((x4 = exp(g, @1_x_737[@i_240[@i_422]])) && (x5 = exp(g, mult(@1_x_737[@i_240[@i_422]], x[@i_422]))))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(x[@i_421], K_u_1038[@i_421], x1_385[@i_421], x2_384[@i_421], X[@i_421], @1_x_874[@i_236[@i_421]], r_380[@i_421]) && ((x1 = x1_385[@i_421]) && ((x2 = x2_384[@i_421]) && ((x3 = X[@i_421]) && ((x4 = exp(g, @1_x_874[@i_236[@i_421]])) && (x5 = exp(g, mult(@1_x_874[@i_236[@i_421]], x[@i_421]))))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(x[@i_420], K_u_1038[@i_420], x1_391[@i_420], x2_390[@i_420], X[@i_420], @1_x_874[@i_236[@i_420]], r_386[@i_420]) && ((x1 = x1_391[@i_420]) && ((x2 = x2_390[@i_420]) && ((x3 = X[@i_420]) && ((x4 = exp(g, @1_x_874[@i_236[@i_420]])) && (x5 = exp(g, mult(@1_x_874[@i_236[@i_420]], x[@i_420]))))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(x[@i_419], yp[@i_233[@i_419]], K_u_1039[@i_419], x1_397[@i_419], x2_396[@i_419], X[@i_419], Yp[@i_233[@i_419]], r_392[@i_419]) && ((x1 = x1_397[@i_419]) && ((x2 = x2_396[@i_419]) && ((x3 = X[@i_419]) && ((x4 = Yp[@i_233[@i_419]]) && (x5 = exp(g, mult(yp[@i_233[@i_419]], x[@i_419]))))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(x[@i_418], yp[@i_233[@i_418]], K_u_1039[@i_418], x1_403[@i_418], x2_402[@i_418], X[@i_418], Yp[@i_233[@i_418]], r_398[@i_418]) && ((x1 = x1_403[@i_418]) && ((x2 = x2_402[@i_418]) && ((x3 = X[@i_418]) && ((x4 = Yp[@i_233[@i_418]]) && (x5 = exp(g, mult(yp[@i_233[@i_418]], x[@i_418]))))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(x1_409[@i_417], x2_408[@i_417], X[@i_417], Y[@i_232[@i_417]], K_u_1040[@i_417], r_404[@i_417]) && ((x1 = x1_409[@i_417]) && ((x2 = x2_408[@i_417]) && ((x3 = X[@i_417]) && ((x4 = Y[@i_232[@i_417]]) && (x5 = K_u_1040[@i_417]))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(x1_415[@i_416], x2_414[@i_416], X[@i_416], Y[@i_232[@i_416]], K_u_1040[@i_416], r_410[@i_416]) && ((x1 = x1_415[@i_416]) && ((x2 = x2_414[@i_416]) && ((x3 = X[@i_416]) && ((x4 = Y[@i_232[@i_416]]) && (x5 = K_u_1040[@i_416]))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_737[@i_240[@i_100]], K_u_1037[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(@1_x_737[@i_240[@i_100]], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_874[@i_236[@i_100]], K_u_1038[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(@1_x_874[@i_236[@i_100]], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], yp[@i_233[@i_100]], K_u_1039[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(yp[@i_233[@i_100]], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], K_u_1040[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = K_u_1040[@i_100]))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_874[@i_100], @1_x_874[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(@1_x_874[@i_100], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of binder K_u_1040 yields

Game 30 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = exp(g, @1_x_737[@i_240]) in
    let K_u_1037: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_737[@i_240]) = x14[@i_115]) && (exp(g, mult(@1_x_737[@i_240], x)) = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      find [unique] @i_506 <= qH0 suchthat defined(x1[@i_506], x2[@i_506], x3[@i_506], x4[@i_506], x5[@i_506], r_338[@i_506]) && ((x1_379 = x1[@i_506]) && ((x2_378 = x2[@i_506]) && ((X = x3[@i_506]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_506]) && (exp(g, mult(@1_x_737[@i_240], x)) = x5[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_506]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_374);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      find [unique] @i_493 <= qH0 suchthat defined(x1[@i_493], x2[@i_493], x3[@i_493], x4[@i_493], x5[@i_493], r_338[@i_493]) && ((x1_373 = x1[@i_493]) && ((x2_372 = x2[@i_493]) && ((X = x3[@i_493]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_493]) && (exp(g, mult(@1_x_737[@i_240], x)) = x5[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_493]);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_368);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = exp(g, @1_x_874[@i_236]) in
    let K_u_1038: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_874[@i_236]) = x14[@i_115]) && (exp(g, mult(@1_x_874[@i_236], x)) = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      find [unique] @i_532 <= qH0 suchthat defined(x1[@i_532], x2[@i_532], x3[@i_532], x4[@i_532], x5[@i_532], r_338[@i_532]) && ((x1_391 = x1[@i_532]) && ((x2_390 = x2[@i_532]) && ((X = x3[@i_532]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_532]) && (exp(g, mult(@1_x_874[@i_236], x)) = x5[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_532]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_386);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      find [unique] @i_519 <= qH0 suchthat defined(x1[@i_519], x2[@i_519], x3[@i_519], x4[@i_519], x5[@i_519], r_338[@i_519]) && ((x1_385 = x1[@i_519]) && ((x2_384 = x2[@i_519]) && ((X = x3[@i_519]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_519]) && (exp(g, mult(@1_x_874[@i_236], x)) = x5[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_519]);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_380);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u_1039: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (exp(g, mult(yp[@i_233], x)) = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      find [unique] @i_558 <= qH0 suchthat defined(x1[@i_558], x2[@i_558], x3[@i_558], x4[@i_558], x5[@i_558], r_338[@i_558]) && ((x1_403 = x1[@i_558]) && ((x2_402 = x2[@i_558]) && ((X = x3[@i_558]) && ((Yp[@i_233] = x4[@i_558]) && (exp(g, mult(yp[@i_233], x)) = x5[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_558]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_398);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      find [unique] @i_545 <= qH0 suchthat defined(x1[@i_545], x2[@i_545], x3[@i_545], x4[@i_545], x5[@i_545], r_338[@i_545]) && ((x1_397 = x1[@i_545]) && ((x2_396 = x2[@i_545]) && ((X = x3[@i_545]) && ((Yp[@i_233] = x4[@i_545]) && (exp(g, mult(yp[@i_233], x)) = x5[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_545]);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_392);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u_1040: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (exp(g, mult(y[@i_232], x)) = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      find [unique] @i_584 <= qH0 suchthat defined(x1[@i_584], x2[@i_584], x3[@i_584], x4[@i_584], x5[@i_584], r_338[@i_584]) && ((x1_415 = x1[@i_584]) && ((x2_414 = x2[@i_584]) && ((X = x3[@i_584]) && ((Y[@i_232] = x4[@i_584]) && (exp(g, mult(y[@i_232], x)) = x5[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_584]);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_350[@i_232]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_410);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      find [unique] @i_571 <= qH0 suchthat defined(x1[@i_571], x2[@i_571], x3[@i_571], x4[@i_571], x5[@i_571], r_338[@i_571]) && ((x1_409 = x1[@i_571]) && ((x2_408 = x2[@i_571]) && ((X = x3[@i_571]) && ((Y[@i_232] = x4[@i_571]) && (exp(g, mult(y[@i_232], x)) = x5[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_571]);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_404);
        out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    let Y_u: G = exp(g, @1_x_874) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (exp(g, mult(x[j], y)) = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      find [unique] @i_454 <= qH0 suchthat defined(x1[@i_454], x2[@i_454], x3[@i_454], x4[@i_454], x5[@i_454], r_338[@i_454]) && ((x1_355 = x1[@i_454]) && ((x2_354 = x2[@i_454]) && ((X_s = x3[@i_454]) && ((Y = x4[@i_454]) && (exp(g, mult(x[j], y)) = x5[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_454])
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_410[j])
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_350)
    )
    orfind  suchthat defined(x[j], y[@i_232[j]], K_u_1040[j], @i_232[j], r1_94[j]) && (!_58 = @i_232[j]) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (exp(g, mult(x[j], y)) = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = exp(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = exp(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], exp(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], exp(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], exp(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(x1_349[@i_427], x2_348[@i_427], Xp[@i_427], Yp[@i_427], Kp[@i_427], r_344[@i_427]) && ((x1 = x1_349[@i_427]) && ((x2 = x2_348[@i_427]) && ((x3 = Xp[@i_427]) && ((x4 = Yp[@i_427]) && (x5 = Kp[@i_427]))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(y[@i_426], x[j[@i_426]], K_s[@i_426], x1_355[@i_426], x2_354[@i_426], X_s[@i_426], Y[@i_426], r_350[@i_426]) && ((x1 = x1_355[@i_426]) && ((x2 = x2_354[@i_426]) && ((x3 = X_s[@i_426]) && ((x4 = Y[@i_426]) && (x5 = exp(g, mult(x[j[@i_426]], y[@i_426]))))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(y[@i_425], x[j[@i_425]], K_s[@i_425], x1_361[@i_425], x2_360[@i_425], X_s[@i_425], Y[@i_425], r_356[@i_425]) && ((x1 = x1_361[@i_425]) && ((x2 = x2_360[@i_425]) && ((x3 = X_s[@i_425]) && ((x4 = Y[@i_425]) && (x5 = exp(g, mult(x[j[@i_425]], y[@i_425]))))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(x[@i_424], @1_x_874[@i_424], x1_367[@i_424], x2_366[@i_424], X[@i_424], @1_x_874[@i_424], r_362[@i_424]) && ((x1 = x1_367[@i_424]) && ((x2 = x2_366[@i_424]) && ((x3 = X[@i_424]) && ((x4 = exp(g, @1_x_874[@i_424])) && (x5 = exp(g, mult(@1_x_874[@i_424], x[@i_424]))))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(x[@i_423], K_u_1037[@i_423], x1_373[@i_423], x2_372[@i_423], X[@i_423], @1_x_737[@i_240[@i_423]], r_368[@i_423]) && ((x1 = x1_373[@i_423]) && ((x2 = x2_372[@i_423]) && ((x3 = X[@i_423]) && ((x4 = exp(g, @1_x_737[@i_240[@i_423]])) && (x5 = exp(g, mult(@1_x_737[@i_240[@i_423]], x[@i_423]))))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(x[@i_422], K_u_1037[@i_422], x1_379[@i_422], x2_378[@i_422], X[@i_422], @1_x_737[@i_240[@i_422]], r_374[@i_422]) && ((x1 = x1_379[@i_422]) && ((x2 = x2_378[@i_422]) && ((x3 = X[@i_422]) && ((x4 = exp(g, @1_x_737[@i_240[@i_422]])) && (x5 = exp(g, mult(@1_x_737[@i_240[@i_422]], x[@i_422]))))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(x[@i_421], K_u_1038[@i_421], x1_385[@i_421], x2_384[@i_421], X[@i_421], @1_x_874[@i_236[@i_421]], r_380[@i_421]) && ((x1 = x1_385[@i_421]) && ((x2 = x2_384[@i_421]) && ((x3 = X[@i_421]) && ((x4 = exp(g, @1_x_874[@i_236[@i_421]])) && (x5 = exp(g, mult(@1_x_874[@i_236[@i_421]], x[@i_421]))))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(x[@i_420], K_u_1038[@i_420], x1_391[@i_420], x2_390[@i_420], X[@i_420], @1_x_874[@i_236[@i_420]], r_386[@i_420]) && ((x1 = x1_391[@i_420]) && ((x2 = x2_390[@i_420]) && ((x3 = X[@i_420]) && ((x4 = exp(g, @1_x_874[@i_236[@i_420]])) && (x5 = exp(g, mult(@1_x_874[@i_236[@i_420]], x[@i_420]))))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(x[@i_419], yp[@i_233[@i_419]], K_u_1039[@i_419], x1_397[@i_419], x2_396[@i_419], X[@i_419], Yp[@i_233[@i_419]], r_392[@i_419]) && ((x1 = x1_397[@i_419]) && ((x2 = x2_396[@i_419]) && ((x3 = X[@i_419]) && ((x4 = Yp[@i_233[@i_419]]) && (x5 = exp(g, mult(yp[@i_233[@i_419]], x[@i_419]))))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(x[@i_418], yp[@i_233[@i_418]], K_u_1039[@i_418], x1_403[@i_418], x2_402[@i_418], X[@i_418], Yp[@i_233[@i_418]], r_398[@i_418]) && ((x1 = x1_403[@i_418]) && ((x2 = x2_402[@i_418]) && ((x3 = X[@i_418]) && ((x4 = Yp[@i_233[@i_418]]) && (x5 = exp(g, mult(yp[@i_233[@i_418]], x[@i_418]))))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(x[@i_417], y[@i_232[@i_417]], K_u_1040[@i_417], x1_409[@i_417], x2_408[@i_417], X[@i_417], Y[@i_232[@i_417]], r_404[@i_417]) && ((x1 = x1_409[@i_417]) && ((x2 = x2_408[@i_417]) && ((x3 = X[@i_417]) && ((x4 = Y[@i_232[@i_417]]) && (x5 = exp(g, mult(y[@i_232[@i_417]], x[@i_417]))))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(x[@i_416], y[@i_232[@i_416]], K_u_1040[@i_416], x1_415[@i_416], x2_414[@i_416], X[@i_416], Y[@i_232[@i_416]], r_410[@i_416]) && ((x1 = x1_415[@i_416]) && ((x2 = x2_414[@i_416]) && ((x3 = X[@i_416]) && ((x4 = Y[@i_232[@i_416]]) && (x5 = exp(g, mult(y[@i_232[@i_416]], x[@i_416]))))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], Kp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = Kp[@i_102]))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_737[@i_240[@i_100]], K_u_1037[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(@1_x_737[@i_240[@i_100]], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_874[@i_236[@i_100]], K_u_1038[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(@1_x_874[@i_236[@i_100]], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], yp[@i_233[@i_100]], K_u_1039[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(yp[@i_233[@i_100]], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], y[@i_232[@i_100]], K_u_1040[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(y[@i_232[@i_100]], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_874[@i_100], @1_x_874[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(@1_x_874[@i_100], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of binder Kp yields

Game 31 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = exp(g, @1_x_737[@i_240]) in
    let K_u_1037: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_737[@i_240]) = x14[@i_115]) && (exp(g, mult(@1_x_737[@i_240], x)) = x15[@i_115]))))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      find [unique] @i_506 <= qH0 suchthat defined(x1[@i_506], x2[@i_506], x3[@i_506], x4[@i_506], x5[@i_506], r_338[@i_506]) && ((x1_379 = x1[@i_506]) && ((x2_378 = x2[@i_506]) && ((X = x3[@i_506]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_506]) && (exp(g, mult(@1_x_737[@i_240], x)) = x5[@i_506]))))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_506]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_374);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      find [unique] @i_493 <= qH0 suchthat defined(x1[@i_493], x2[@i_493], x3[@i_493], x4[@i_493], x5[@i_493], r_338[@i_493]) && ((x1_373 = x1[@i_493]) && ((x2_372 = x2[@i_493]) && ((X = x3[@i_493]) && ((exp(g, @1_x_737[@i_240]) = x4[@i_493]) && (exp(g, mult(@1_x_737[@i_240], x)) = x5[@i_493]))))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_493]);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_368);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = exp(g, @1_x_874[@i_236]) in
    let K_u_1038: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((exp(g, @1_x_874[@i_236]) = x14[@i_115]) && (exp(g, mult(@1_x_874[@i_236], x)) = x15[@i_115]))))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      find [unique] @i_532 <= qH0 suchthat defined(x1[@i_532], x2[@i_532], x3[@i_532], x4[@i_532], x5[@i_532], r_338[@i_532]) && ((x1_391 = x1[@i_532]) && ((x2_390 = x2[@i_532]) && ((X = x3[@i_532]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_532]) && (exp(g, mult(@1_x_874[@i_236], x)) = x5[@i_532]))))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_532]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_386);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      find [unique] @i_519 <= qH0 suchthat defined(x1[@i_519], x2[@i_519], x3[@i_519], x4[@i_519], x5[@i_519], r_338[@i_519]) && ((x1_385 = x1[@i_519]) && ((x2_384 = x2[@i_519]) && ((X = x3[@i_519]) && ((exp(g, @1_x_874[@i_236]) = x4[@i_519]) && (exp(g, mult(@1_x_874[@i_236], x)) = x5[@i_519]))))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_519]);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_380);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u_1039: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && (exp(g, mult(yp[@i_233], x)) = x15[@i_115]))))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      find [unique] @i_558 <= qH0 suchthat defined(x1[@i_558], x2[@i_558], x3[@i_558], x4[@i_558], x5[@i_558], r_338[@i_558]) && ((x1_403 = x1[@i_558]) && ((x2_402 = x2[@i_558]) && ((X = x3[@i_558]) && ((Yp[@i_233] = x4[@i_558]) && (exp(g, mult(yp[@i_233], x)) = x5[@i_558]))))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_558]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_398);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      find [unique] @i_545 <= qH0 suchthat defined(x1[@i_545], x2[@i_545], x3[@i_545], x4[@i_545], x5[@i_545], r_338[@i_545]) && ((x1_397 = x1[@i_545]) && ((x2_396 = x2[@i_545]) && ((X = x3[@i_545]) && ((Yp[@i_233] = x4[@i_545]) && (exp(g, mult(yp[@i_233], x)) = x5[@i_545]))))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_545]);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_392);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u_1040: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && (exp(g, mult(y[@i_232], x)) = x15[@i_115]))))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      find [unique] @i_584 <= qH0 suchthat defined(x1[@i_584], x2[@i_584], x3[@i_584], x4[@i_584], x5[@i_584], r_338[@i_584]) && ((x1_415 = x1[@i_584]) && ((x2_414 = x2[@i_584]) && ((X = x3[@i_584]) && ((Y[@i_232] = x4[@i_584]) && (exp(g, mult(y[@i_232], x)) = x5[@i_584]))))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_584]);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_350[@i_232]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_410);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      find [unique] @i_571 <= qH0 suchthat defined(x1[@i_571], x2[@i_571], x3[@i_571], x4[@i_571], x5[@i_571], r_338[@i_571]) && ((x1_409 = x1[@i_571]) && ((x2_408 = x2[@i_571]) && ((X = x3[@i_571]) && ((Y[@i_232] = x4[@i_571]) && (exp(g, mult(y[@i_232], x)) = x5[@i_571]))))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_571]);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_404);
        out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    let Y_u: G = exp(g, @1_x_874) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && (exp(g, mult(x[j], y)) = x15[@i_111]))))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      find [unique] @i_454 <= qH0 suchthat defined(x1[@i_454], x2[@i_454], x3[@i_454], x4[@i_454], x5[@i_454], r_338[@i_454]) && ((x1_355 = x1[@i_454]) && ((x2_354 = x2[@i_454]) && ((X_s = x3[@i_454]) && ((Y = x4[@i_454]) && (exp(g, mult(x[j], y)) = x5[@i_454]))))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_454])
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_410[j])
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_350)
    )
    orfind  suchthat defined(x[j], y[@i_232[j]], K_u_1040[j], @i_232[j], r1_94[j]) && (!_58 = @i_232[j]) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], r_338[@i_467]) && ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && (exp(g, mult(x[j], y)) = x5[@i_467]))))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = exp(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = exp(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], exp(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], exp(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], exp(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(yp[@i_427], xp[@i_427], xp[@i_427], x1_349[@i_427], x2_348[@i_427], Xp[@i_427], Yp[@i_427], r_344[@i_427]) && ((x1 = x1_349[@i_427]) && ((x2 = x2_348[@i_427]) && ((x3 = Xp[@i_427]) && ((x4 = Yp[@i_427]) && (x5 = exp(g, mult(xp[@i_427], yp[@i_427]))))))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(y[@i_426], x[j[@i_426]], K_s[@i_426], x1_355[@i_426], x2_354[@i_426], X_s[@i_426], Y[@i_426], r_350[@i_426]) && ((x1 = x1_355[@i_426]) && ((x2 = x2_354[@i_426]) && ((x3 = X_s[@i_426]) && ((x4 = Y[@i_426]) && (x5 = exp(g, mult(x[j[@i_426]], y[@i_426]))))))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(y[@i_425], x[j[@i_425]], K_s[@i_425], x1_361[@i_425], x2_360[@i_425], X_s[@i_425], Y[@i_425], r_356[@i_425]) && ((x1 = x1_361[@i_425]) && ((x2 = x2_360[@i_425]) && ((x3 = X_s[@i_425]) && ((x4 = Y[@i_425]) && (x5 = exp(g, mult(x[j[@i_425]], y[@i_425]))))))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(x[@i_424], @1_x_874[@i_424], x1_367[@i_424], x2_366[@i_424], X[@i_424], @1_x_874[@i_424], r_362[@i_424]) && ((x1 = x1_367[@i_424]) && ((x2 = x2_366[@i_424]) && ((x3 = X[@i_424]) && ((x4 = exp(g, @1_x_874[@i_424])) && (x5 = exp(g, mult(@1_x_874[@i_424], x[@i_424]))))))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(x[@i_423], K_u_1037[@i_423], x1_373[@i_423], x2_372[@i_423], X[@i_423], @1_x_737[@i_240[@i_423]], r_368[@i_423]) && ((x1 = x1_373[@i_423]) && ((x2 = x2_372[@i_423]) && ((x3 = X[@i_423]) && ((x4 = exp(g, @1_x_737[@i_240[@i_423]])) && (x5 = exp(g, mult(@1_x_737[@i_240[@i_423]], x[@i_423]))))))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(x[@i_422], K_u_1037[@i_422], x1_379[@i_422], x2_378[@i_422], X[@i_422], @1_x_737[@i_240[@i_422]], r_374[@i_422]) && ((x1 = x1_379[@i_422]) && ((x2 = x2_378[@i_422]) && ((x3 = X[@i_422]) && ((x4 = exp(g, @1_x_737[@i_240[@i_422]])) && (x5 = exp(g, mult(@1_x_737[@i_240[@i_422]], x[@i_422]))))))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(x[@i_421], K_u_1038[@i_421], x1_385[@i_421], x2_384[@i_421], X[@i_421], @1_x_874[@i_236[@i_421]], r_380[@i_421]) && ((x1 = x1_385[@i_421]) && ((x2 = x2_384[@i_421]) && ((x3 = X[@i_421]) && ((x4 = exp(g, @1_x_874[@i_236[@i_421]])) && (x5 = exp(g, mult(@1_x_874[@i_236[@i_421]], x[@i_421]))))))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(x[@i_420], K_u_1038[@i_420], x1_391[@i_420], x2_390[@i_420], X[@i_420], @1_x_874[@i_236[@i_420]], r_386[@i_420]) && ((x1 = x1_391[@i_420]) && ((x2 = x2_390[@i_420]) && ((x3 = X[@i_420]) && ((x4 = exp(g, @1_x_874[@i_236[@i_420]])) && (x5 = exp(g, mult(@1_x_874[@i_236[@i_420]], x[@i_420]))))))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(x[@i_419], yp[@i_233[@i_419]], K_u_1039[@i_419], x1_397[@i_419], x2_396[@i_419], X[@i_419], Yp[@i_233[@i_419]], r_392[@i_419]) && ((x1 = x1_397[@i_419]) && ((x2 = x2_396[@i_419]) && ((x3 = X[@i_419]) && ((x4 = Yp[@i_233[@i_419]]) && (x5 = exp(g, mult(yp[@i_233[@i_419]], x[@i_419]))))))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(x[@i_418], yp[@i_233[@i_418]], K_u_1039[@i_418], x1_403[@i_418], x2_402[@i_418], X[@i_418], Yp[@i_233[@i_418]], r_398[@i_418]) && ((x1 = x1_403[@i_418]) && ((x2 = x2_402[@i_418]) && ((x3 = X[@i_418]) && ((x4 = Yp[@i_233[@i_418]]) && (x5 = exp(g, mult(yp[@i_233[@i_418]], x[@i_418]))))))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(x[@i_417], y[@i_232[@i_417]], K_u_1040[@i_417], x1_409[@i_417], x2_408[@i_417], X[@i_417], Y[@i_232[@i_417]], r_404[@i_417]) && ((x1 = x1_409[@i_417]) && ((x2 = x2_408[@i_417]) && ((x3 = X[@i_417]) && ((x4 = Y[@i_232[@i_417]]) && (x5 = exp(g, mult(y[@i_232[@i_417]], x[@i_417]))))))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(x[@i_416], y[@i_232[@i_416]], K_u_1040[@i_416], x1_415[@i_416], x2_414[@i_416], X[@i_416], Y[@i_232[@i_416]], r_410[@i_416]) && ((x1 = x1_415[@i_416]) && ((x2 = x2_414[@i_416]) && ((x3 = X[@i_416]) && ((x4 = Y[@i_232[@i_416]]) && (x5 = exp(g, mult(y[@i_232[@i_416]], x[@i_416]))))))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(yp[@i_102], xp[@i_102], xp[@i_102], x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], r1_88[@i_102]) && ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && (x15 = exp(g, mult(xp[@i_102], yp[@i_102]))))))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_737[@i_240[@i_100]], K_u_1037[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(@1_x_737[@i_240[@i_100]], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_874[@i_236[@i_100]], K_u_1038[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(@1_x_874[@i_236[@i_100]], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], yp[@i_233[@i_100]], K_u_1039[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(yp[@i_233[@i_100]], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], y[@i_232[@i_100]], K_u_1040[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(y[@i_232[@i_100]], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_874[@i_100], @1_x_874[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && (x15 = exp(g, mult(@1_x_874[@i_100], x[@i_100]))))))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 7.4 * #@1_Oa) * max(1., 7.4 * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
with x, @1_x_874, yp, y, xp, @1_x_737 [Excluding set(dist 31->32, proba <= 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)))] yields

Game 32 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = @1_exp'(g, @1_x_737[@i_240]) in
    let K_u_1037: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && find  else find  else ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@1_exp'(g, @1_x_737[@i_240]) = x14[@i_115]) && false)))) then
    (
      let x1_379: host = U in
      let x2_378: host = S in
      find [unique] @i_506 <= qH0 suchthat defined(x1[@i_506], x2[@i_506], x3[@i_506], x4[@i_506], x5[@i_506], r_338[@i_506]) && find  else find  else ((x1_379 = x1[@i_506]) && ((x2_378 = x2[@i_506]) && ((X = x3[@i_506]) && ((@1_exp'(g, @1_x_737[@i_240]) = x4[@i_506]) && false)))) then
      (
        let sk_u: hash0 = r_338[@i_506] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_506]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_374: hash0;
        let sk_u: hash0 = r_374 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_374);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_373: host = U in
      let x2_372: host = S in
      find [unique] @i_493 <= qH0 suchthat defined(x1[@i_493], x2[@i_493], x3[@i_493], x4[@i_493], x5[@i_493], r_338[@i_493]) && find  else find  else ((x1_373 = x1[@i_493]) && ((x2_372 = x2[@i_493]) && ((X = x3[@i_493]) && ((@1_exp'(g, @1_x_737[@i_240]) = x4[@i_493]) && false)))) then
      (
        let sk_u: hash0 = r_338[@i_493] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_493]);
        out(c6[!_57], r1_94)
      )
      else
        new r_368: hash0;
        let sk_u: hash0 = r_368 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_368);
        out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = @1_exp'(g, @1_x_874[@i_236]) in
    let K_u_1038: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && find  else find  else ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((@1_exp'(g, @1_x_874[@i_236]) = x14[@i_115]) && false)))) then
    (
      let x1_391: host = U in
      let x2_390: host = S in
      find [unique] @i_532 <= qH0 suchthat defined(x1[@i_532], x2[@i_532], x3[@i_532], x4[@i_532], x5[@i_532], r_338[@i_532]) && find  else find  else ((x1_391 = x1[@i_532]) && ((x2_390 = x2[@i_532]) && ((X = x3[@i_532]) && ((@1_exp'(g, @1_x_874[@i_236]) = x4[@i_532]) && false)))) then
      (
        let sk_u: hash0 = r_338[@i_532] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_532]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_386: hash0;
        let sk_u: hash0 = r_386 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_386);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_385: host = U in
      let x2_384: host = S in
      find [unique] @i_519 <= qH0 suchthat defined(x1[@i_519], x2[@i_519], x3[@i_519], x4[@i_519], x5[@i_519], r_338[@i_519]) && find  else find  else ((x1_385 = x1[@i_519]) && ((x2_384 = x2[@i_519]) && ((X = x3[@i_519]) && ((@1_exp'(g, @1_x_874[@i_236]) = x4[@i_519]) && false)))) then
      (
        let sk_u: hash0 = r_338[@i_519] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_519]);
        out(c6[!_57], r1_94)
      )
      else
        new r_380: hash0;
        let sk_u: hash0 = r_380 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_380);
        out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233], yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u_1039: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && find  else find  else ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Yp[@i_233] = x14[@i_115]) && false)))) then
    (
      let x1_403: host = U in
      let x2_402: host = S in
      find [unique] @i_558 <= qH0 suchthat defined(x1[@i_558], x2[@i_558], x3[@i_558], x4[@i_558], x5[@i_558], r_338[@i_558]) && find  else find  else ((x1_403 = x1[@i_558]) && ((x2_402 = x2[@i_558]) && ((X = x3[@i_558]) && ((Yp[@i_233] = x4[@i_558]) && false)))) then
      (
        let sk_u: hash0 = r_338[@i_558] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_558]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_398: hash0;
        let sk_u: hash0 = r_398 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_398);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_397: host = U in
      let x2_396: host = S in
      find [unique] @i_545 <= qH0 suchthat defined(x1[@i_545], x2[@i_545], x3[@i_545], x4[@i_545], x5[@i_545], r_338[@i_545]) && find  else find  else ((x1_397 = x1[@i_545]) && ((x2_396 = x2[@i_545]) && ((X = x3[@i_545]) && ((Yp[@i_233] = x4[@i_545]) && false)))) then
      (
        let sk_u: hash0 = r_338[@i_545] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_545]);
        out(c6[!_57], r1_94)
      )
      else
        new r_392: hash0;
        let sk_u: hash0 = r_392 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_392);
        out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232], y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u_1040: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_82[@i_115]) && find  else find  else ((x1_99 = x11[@i_115]) && ((x2_98 = x12[@i_115]) && ((X = x13[@i_115]) && ((Y[@i_232] = x14[@i_115]) && false)))) then
    (
      let x1_415: host = U in
      let x2_414: host = S in
      find [unique] @i_584 <= qH0 suchthat defined(x1[@i_584], x2[@i_584], x3[@i_584], x4[@i_584], x5[@i_584], r_338[@i_584]) && find  else find  else ((x1_415 = x1[@i_584]) && ((x2_414 = x2[@i_584]) && ((X = x3[@i_584]) && ((Y[@i_232] = x4[@i_584]) && false)))) then
      (
        let sk_u: hash0 = r_338[@i_584] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_338[@i_584]);
        out(c6[!_57], r1_82[@i_115])
      )
      orfind  suchthat defined(j[@i_232], r_350[@i_232]) && (!_57 = j[@i_232]) then
      (
        let sk_u: hash0 = r_350[@i_232] in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_350[@i_232]);
        out(c6[!_57], r1_82[@i_115])
      )
      else
        new r_410: hash0;
        let sk_u: hash0 = r_410 in
        event termU(U, X, S, Ystar_u, r1_82[@i_115], r_410);
        out(c6[!_57], r1_82[@i_115])
    )
    else
      let x1_409: host = U in
      let x2_408: host = S in
      find [unique] @i_571 <= qH0 suchthat defined(x1[@i_571], x2[@i_571], x3[@i_571], x4[@i_571], x5[@i_571], r_338[@i_571]) && find  else find  else ((x1_409 = x1[@i_571]) && ((x2_408 = x2[@i_571]) && ((X = x3[@i_571]) && ((Y[@i_232] = x4[@i_571]) && false)))) then
      (
        let sk_u: hash0 = r_338[@i_571] in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_338[@i_571]);
        out(c6[!_57], r1_94)
      )
      else
        new r_404: hash0;
        let sk_u: hash0 = r_404 in
        new r1_94: hash1;
        event termU(U, X, S, Ystar_u, r1_94, r_404);
        out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    let Y_u: G = @1_exp'(g, @1_x_874) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    find [unique] @i_111 <= qH1 suchthat defined(x11[@i_111], x12[@i_111], x13[@i_111], x14[@i_111], x15[@i_111], r1_82[@i_111]) && find  else find  else ((U = x11[@i_111]) && ((S = x12[@i_111]) && ((X_s = x13[@i_111]) && ((Y = x14[@i_111]) && false)))) then
    (
      if (auth_s = r1_82[@i_111]) then
      let x1_355: host = U in
      let x2_354: host = S in
      find [unique] @i_454 <= qH0 suchthat defined(x1[@i_454], x2[@i_454], x3[@i_454], x4[@i_454], x5[@i_454], r_338[@i_454]) && find  else find  else ((x1_355 = x1[@i_454]) && ((x2_354 = x2[@i_454]) && ((X_s = x3[@i_454]) && ((Y = x4[@i_454]) && false)))) then
      (
        let sk_s: hash0 = r_338[@i_454] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_454])
      )
      orfind  suchthat defined(@i_232[j], r_404[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      orfind  suchthat defined(@i_232[j], r_410[j]) && (!_58 = @i_232[j]) then
      (
        let sk_s: hash0 = r_410[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_410[j])
      )
      else
        new r_350: hash0;
        let sk_s: hash0 = r_350 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_350)
    )
    orfind  suchthat defined(x[j], y[@i_232[j]], K_u_1040[j], @i_232[j], r1_94[j]) && (!_58 = @i_232[j]) then
    (
      if (auth_s = r1_94[j]) then
      let x1_361: host = U in
      let x2_360: host = S in
      find [unique] @i_467 <= qH0 suchthat defined(x1[@i_467], x2[@i_467], x3[@i_467], x4[@i_467], x5[@i_467], r_338[@i_467]) && find  else find  else ((x1_361 = x1[@i_467]) && ((x2_360 = x2[@i_467]) && ((X_s = x3[@i_467]) && ((Y = x4[@i_467]) && false)))) then
      (
        let sk_s: hash0 = r_338[@i_467] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_338[@i_467])
      )
      orfind  suchthat defined(r_404[j]) then
      (
        let sk_s: hash0 = r_404[j] in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
      )
      else
        new r_356: hash0;
        let sk_s: hash0 = r_356 in
        event termS(U, X_s, S, @2_r2_185, auth_s, r_356)
    )
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = @1_exp'(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_exp'(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], @1_exp'(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  orfind @i_427 <= NP suchthat defined(yp[@i_427], xp[@i_427], xp[@i_427], x1_349[@i_427], x2_348[@i_427], Xp[@i_427], Yp[@i_427], r_344[@i_427]) && find  else find  else ((x1 = x1_349[@i_427]) && ((x2 = x2_348[@i_427]) && ((x3 = Xp[@i_427]) && ((x4 = Yp[@i_427]) && false)))) then
    out(c20[!_62], r_344[@i_427])
  orfind @i_426 <= NS suchthat defined(y[@i_426], x[j[@i_426]], K_s[@i_426], x1_355[@i_426], x2_354[@i_426], X_s[@i_426], Y[@i_426], r_350[@i_426]) && find  else find  else ((x1 = x1_355[@i_426]) && ((x2 = x2_354[@i_426]) && ((x3 = X_s[@i_426]) && ((x4 = Y[@i_426]) && false)))) then
    out(c20[!_62], r_350[@i_426])
  orfind @i_425 <= NS suchthat defined(y[@i_425], x[j[@i_425]], K_s[@i_425], x1_361[@i_425], x2_360[@i_425], X_s[@i_425], Y[@i_425], r_356[@i_425]) && find  else find  else ((x1 = x1_361[@i_425]) && ((x2 = x2_360[@i_425]) && ((x3 = X_s[@i_425]) && ((x4 = Y[@i_425]) && false)))) then
    out(c20[!_62], r_356[@i_425])
  orfind @i_424 <= NU suchthat defined(x[@i_424], @1_x_874[@i_424], x1_367[@i_424], x2_366[@i_424], X[@i_424], @1_x_874[@i_424], r_362[@i_424]) && find  else find  else ((x1 = x1_367[@i_424]) && ((x2 = x2_366[@i_424]) && ((x3 = X[@i_424]) && ((x4 = @1_exp'(g, @1_x_874[@i_424])) && false)))) then
    out(c20[!_62], r_362[@i_424])
  orfind @i_423 <= NU suchthat defined(x[@i_423], K_u_1037[@i_423], x1_373[@i_423], x2_372[@i_423], X[@i_423], @1_x_737[@i_240[@i_423]], r_368[@i_423]) && find  else find  else ((x1 = x1_373[@i_423]) && ((x2 = x2_372[@i_423]) && ((x3 = X[@i_423]) && ((x4 = @1_exp'(g, @1_x_737[@i_240[@i_423]])) && false)))) then
    out(c20[!_62], r_368[@i_423])
  orfind @i_422 <= NU suchthat defined(x[@i_422], K_u_1037[@i_422], x1_379[@i_422], x2_378[@i_422], X[@i_422], @1_x_737[@i_240[@i_422]], r_374[@i_422]) && find  else find  else ((x1 = x1_379[@i_422]) && ((x2 = x2_378[@i_422]) && ((x3 = X[@i_422]) && ((x4 = @1_exp'(g, @1_x_737[@i_240[@i_422]])) && false)))) then
    out(c20[!_62], r_374[@i_422])
  orfind @i_421 <= NU suchthat defined(x[@i_421], K_u_1038[@i_421], x1_385[@i_421], x2_384[@i_421], X[@i_421], @1_x_874[@i_236[@i_421]], r_380[@i_421]) && find  else find  else ((x1 = x1_385[@i_421]) && ((x2 = x2_384[@i_421]) && ((x3 = X[@i_421]) && ((x4 = @1_exp'(g, @1_x_874[@i_236[@i_421]])) && false)))) then
    out(c20[!_62], r_380[@i_421])
  orfind @i_420 <= NU suchthat defined(x[@i_420], K_u_1038[@i_420], x1_391[@i_420], x2_390[@i_420], X[@i_420], @1_x_874[@i_236[@i_420]], r_386[@i_420]) && find  else find  else ((x1 = x1_391[@i_420]) && ((x2 = x2_390[@i_420]) && ((x3 = X[@i_420]) && ((x4 = @1_exp'(g, @1_x_874[@i_236[@i_420]])) && false)))) then
    out(c20[!_62], r_386[@i_420])
  orfind @i_419 <= NU suchthat defined(x[@i_419], yp[@i_233[@i_419]], K_u_1039[@i_419], x1_397[@i_419], x2_396[@i_419], X[@i_419], Yp[@i_233[@i_419]], r_392[@i_419]) && find  else find  else ((x1 = x1_397[@i_419]) && ((x2 = x2_396[@i_419]) && ((x3 = X[@i_419]) && ((x4 = Yp[@i_233[@i_419]]) && false)))) then
    out(c20[!_62], r_392[@i_419])
  orfind @i_418 <= NU suchthat defined(x[@i_418], yp[@i_233[@i_418]], K_u_1039[@i_418], x1_403[@i_418], x2_402[@i_418], X[@i_418], Yp[@i_233[@i_418]], r_398[@i_418]) && find  else find  else ((x1 = x1_403[@i_418]) && ((x2 = x2_402[@i_418]) && ((x3 = X[@i_418]) && ((x4 = Yp[@i_233[@i_418]]) && false)))) then
    out(c20[!_62], r_398[@i_418])
  orfind @i_417 <= NU suchthat defined(x[@i_417], y[@i_232[@i_417]], K_u_1040[@i_417], x1_409[@i_417], x2_408[@i_417], X[@i_417], Y[@i_232[@i_417]], r_404[@i_417]) && find  else find  else ((x1 = x1_409[@i_417]) && ((x2 = x2_408[@i_417]) && ((x3 = X[@i_417]) && ((x4 = Y[@i_232[@i_417]]) && false)))) then
    out(c20[!_62], r_404[@i_417])
  orfind @i_416 <= NU suchthat defined(x[@i_416], y[@i_232[@i_416]], K_u_1040[@i_416], x1_415[@i_416], x2_414[@i_416], X[@i_416], Y[@i_232[@i_416]], r_410[@i_416]) && find  else find  else ((x1 = x1_415[@i_416]) && ((x2 = x2_414[@i_416]) && ((x3 = X[@i_416]) && ((x4 = Y[@i_232[@i_416]]) && false)))) then
    out(c20[!_62], r_410[@i_416])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  orfind @i_102 <= NP suchthat defined(yp[@i_102], xp[@i_102], xp[@i_102], x1_93[@i_102], x2_92[@i_102], Xp[@i_102], Yp[@i_102], r1_88[@i_102]) && find  else find  else ((x11 = x1_93[@i_102]) && ((x12 = x2_92[@i_102]) && ((x13 = Xp[@i_102]) && ((x14 = Yp[@i_102]) && false)))) then
    out(c21[!_63], r1_88[@i_102])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_737[@i_240[@i_100]], K_u_1037[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && find  else find  else ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && false)))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_874[@i_236[@i_100]], K_u_1038[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && find  else find  else ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && false)))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], yp[@i_233[@i_100]], K_u_1039[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && find  else find  else ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && false)))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], y[@i_232[@i_100]], K_u_1040[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && find  else find  else ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && false)))) then
    out(c21[!_63], r1_94[@i_100])
  orfind @i_100 <= NU suchthat defined(x[@i_100], @1_x_874[@i_100], @1_x_874[@i_100], x1_99[@i_100], x2_98[@i_100], X[@i_100], Y_u[@i_100], r1_94[@i_100]) && find  else find  else ((x11 = x1_99[@i_100]) && ((x12 = x2_98[@i_100]) && ((x13 = X[@i_100]) && ((x14 = Y_u[@i_100]) && false)))) then
    out(c21[!_63], r1_94[@i_100])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying simplify yields

Game 33 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = @1_exp'(g, @1_x_737[@i_240]) in
    let K_u_1037: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    let x1_373: host = U in
    let x2_372: host = S in
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    event termU(U, X, S, Ystar_u, r1_94, r_368);
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = @1_exp'(g, @1_x_874[@i_236]) in
    let K_u_1038: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    let x1_385: host = U in
    let x2_384: host = S in
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    event termU(U, X, S, Ystar_u, r1_94, r_380);
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u_1039: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    let x1_397: host = U in
    let x2_396: host = S in
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    event termU(U, X, S, Ystar_u, r1_94, r_392);
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u_1040: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    let x1_409: host = U in
    let x2_408: host = S in
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    event termU(U, X, S, Ystar_u, r1_94, r_404);
    out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    let Y_u: G = @1_exp'(g, @1_x_874) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    let x1_361: host = U in
    let x2_360: host = S in
    if defined(r_404[j]) then
    let sk_s: hash0 = r_404[j] in
    event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = @1_exp'(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_exp'(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], @1_exp'(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying move all binders yields

Game 34 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    let Y_u: G = @1_exp'(g, @1_x_737[@i_240]) in
    let K_u_1037: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    let x1_373: host = U in
    let x2_372: host = S in
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    event termU(U, X, S, Ystar_u, r1_94, r_368);
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    let Y_u: G = @1_exp'(g, @1_x_874[@i_236]) in
    let K_u_1038: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    let x1_385: host = U in
    let x2_384: host = S in
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    event termU(U, X, S, Ystar_u, r1_94, r_380);
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    let Y_u: G = Yp[@i_233] in
    let K_u_1039: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    let x1_397: host = U in
    let x2_396: host = S in
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    event termU(U, X, S, Ystar_u, r1_94, r_392);
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    let Y_u: G = Y[@i_232] in
    let K_u_1040: G = cst_G in
    let x1_99: host = U in
    let x2_98: host = S in
    let x1_409: host = U in
    let x2_408: host = S in
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    event termU(U, X, S, Ystar_u, r1_94, r_404);
    out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    let Y_u: G = @1_exp'(g, @1_x_874) in
    let x1_99: host = U in
    let x2_98: host = S in
    new r1_94: hash1;
    let x1_367: host = U in
    let x2_366: host = S in
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    if defined(r_404[j]) then
    let sk_s: hash0 = r_404[j] in
    event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  new @2_r2_182: G;
  let x1_93: host = U in
  let x2_92: host = S in
  new r1_88: hash1;
  let x1_349: host = U in
  let x2_348: host = S in
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = @1_exp'(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_exp'(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], @1_exp'(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of useless yields

Game 35 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    event termU(U, X, S, Ystar_u, r1_94, r_368);
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    event termU(U, X, S, Ystar_u, r1_94, r_380);
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    event termU(U, X, S, Ystar_u, r1_94, r_392);
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    event termU(U, X, S, Ystar_u, r1_94, r_404);
    out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    if defined(r_404[j]) then
    let sk_s: hash0 = r_404[j] in
    event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = @1_exp'(g, @1_x_737[@i_210])) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_exp'(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_737[@i_200]))
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_x_737: exponent;
    out(@2_c4[!_61], @1_exp'(g, @1_x_737))
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


RESULT Proved event termS(x, X, y, Y, a, k) && termU(x, X, y, Y, a, k') ==> (k = k') excluding set(dist 1->2, proba <= NS / |hash1|) U set(dist 2->3, proba <= 2. * NU * NP / |exponent| + qH1 * NP / |exponent| + 1. / |exponent| * NP + NP * NP / |exponent| + NS * NP / |exponent| + 0.5 * NU * NU / |exponent|) U set(event Auth in game 7) U set(dist 8->9, proba <= (NS * NS + 2. * NP * NS + 2. * qE * NS + 2. * NU * NS + 2. * qD * NS + NP * NP + 2. * qE * NP + 2. * NU * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 2. * qD * qE + NU * NU + 2. * qD * NU + qD * qD + -1. * NS + -1. * NP + -1. * qE + -1. * NU + -1. * qD) / |G|) U set(dist 9->10, proba <= NS * NP / |exponent| + qE * NP / |exponent| + NU * NP / |exponent| + qD * NP / |exponent| + NP * NS / |exponent| + qE * NS / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G| + 0.5 * NS * NS / |exponent|) U set(event Encryptt in game 13) U set(dist 14->15, proba <= 10. * NU * NP / |exponent| + 2. * NS * NP / |exponent| + qH0 * NP / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + 8.5 * NU * NU / |G| + 3. * NS * NU / |G| + 2. * NP * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NP * qD / |G| + qD * NP / |exponent| + 1. / |exponent| * NP + 15. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + NU * qH1 / |hash1| + NS * NP / |G| + qD * NU / |G| + 0.5 * qD * qD / |G|) U set(dist 23->24, proba <= 4. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|) U set(dist 31->32, proba <= 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)))
RESULT However, I could not bound the probability of set(event Auth in game 7)
RESULT Proved event inj:termS(x, X, y, Y, a, k) ==> inj:termU(x, X, y, Y, a, k) excluding set(dist 1->2, proba <= NS / |hash1|) U set(dist 2->3, proba <= 2. * NU * NP / |exponent| + qH1 * NP / |exponent| + 1. / |exponent| * NP + NP * NP / |exponent| + NS * NP / |exponent| + 0.5 * NU * NU / |exponent|) U set(event Auth in game 7) U set(dist 8->9, proba <= (NS * NS + 2. * NP * NS + 2. * qE * NS + 2. * NU * NS + 2. * qD * NS + NP * NP + 2. * qE * NP + 2. * NU * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 2. * qD * qE + NU * NU + 2. * qD * NU + qD * qD + -1. * NS + -1. * NP + -1. * qE + -1. * NU + -1. * qD) / |G|) U set(dist 9->10, proba <= NS * NP / |exponent| + qE * NP / |exponent| + NU * NP / |exponent| + qD * NP / |exponent| + NP * NS / |exponent| + qE * NS / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G| + 0.5 * NS * NS / |exponent|) U set(event Encryptt in game 13) U set(dist 14->15, proba <= 10. * NU * NP / |exponent| + 2. * NS * NP / |exponent| + qH0 * NP / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + 8.5 * NU * NU / |G| + 3. * NS * NU / |G| + 2. * NP * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NP * qD / |G| + qD * NP / |exponent| + 1. / |exponent| * NP + 15. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + NU * qH1 / |hash1| + NS * NP / |G| + qD * NU / |G| + 0.5 * qD * qD / |G|) U set(dist 23->24, proba <= 4. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|) U set(dist 31->32, proba <= 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)))
RESULT However, I could not bound the probability of set(event Auth in game 7)
RESULT Proved secrecy of sk_p excluding set(dist 1->2, proba <= NS / |hash1|) U set(dist 2->3, proba <= 2. * NU * NP / |exponent| + qH1 * NP / |exponent| + 1. / |exponent| * NP + NP * NP / |exponent| + NS * NP / |exponent| + 0.5 * NU * NU / |exponent|) U set(event Auth in game 7) U set(dist 8->9, proba <= (NS * NS + 2. * NP * NS + 2. * qE * NS + 2. * NU * NS + 2. * qD * NS + NP * NP + 2. * qE * NP + 2. * NU * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 2. * qD * qE + NU * NU + 2. * qD * NU + qD * qD + -1. * NS + -1. * NP + -1. * qE + -1. * NU + -1. * qD) / |G|) U set(dist 9->10, proba <= NS * NP / |exponent| + qE * NP / |exponent| + NU * NP / |exponent| + qD * NP / |exponent| + NP * NS / |exponent| + qE * NS / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G| + 0.5 * NS * NS / |exponent|) U set(event Encryptt in game 13) U set(dist 14->15, proba <= 10. * NU * NP / |exponent| + 2. * NS * NP / |exponent| + qH0 * NP / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + 8.5 * NU * NU / |G| + 3. * NS * NU / |G| + 2. * NP * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NP * qD / |G| + qD * NP / |exponent| + 1. / |exponent| * NP + 15. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + NU * qH1 / |hash1| + NS * NP / |G| + qD * NU / |G| + 0.5 * qD * qD / |G|) U set(dist 23->24, proba <= 4. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|) U set(dist 31->32, proba <= 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)))
RESULT However, I could not bound the probability of set(event Auth in game 7)
RESULT Proved secrecy of sk_s excluding set(dist 1->2, proba <= NS / |hash1|) U set(dist 2->3, proba <= 2. * NU * NP / |exponent| + qH1 * NP / |exponent| + 1. / |exponent| * NP + NP * NP / |exponent| + NS * NP / |exponent| + 0.5 * NU * NU / |exponent|) U set(event Auth in game 7) U set(dist 8->9, proba <= (NS * NS + 2. * NP * NS + 2. * qE * NS + 2. * NU * NS + 2. * qD * NS + NP * NP + 2. * qE * NP + 2. * NU * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 2. * qD * qE + NU * NU + 2. * qD * NU + qD * qD + -1. * NS + -1. * NP + -1. * qE + -1. * NU + -1. * qD) / |G|) U set(dist 9->10, proba <= NS * NP / |exponent| + qE * NP / |exponent| + NU * NP / |exponent| + qD * NP / |exponent| + NP * NS / |exponent| + qE * NS / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G| + 0.5 * NS * NS / |exponent|) U set(event Encryptt in game 13) U set(dist 14->15, proba <= 10. * NU * NP / |exponent| + 2. * NS * NP / |exponent| + qH0 * NP / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + 8.5 * NU * NU / |G| + 3. * NS * NU / |G| + 2. * NP * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NP * qD / |G| + qD * NP / |exponent| + 1. / |exponent| * NP + 15. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + NU * qH1 / |hash1| + NS * NP / |G| + qD * NU / |G| + 0.5 * qD * qD / |G|) U set(dist 23->24, proba <= 4. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|) U set(dist 31->32, proba <= 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)))
RESULT However, I could not bound the probability of set(event Auth in game 7)
RESULT Proved secrecy of sk_u excluding set(dist 1->2, proba <= NS / |hash1|) U set(dist 2->3, proba <= 2. * NU * NP / |exponent| + qH1 * NP / |exponent| + 1. / |exponent| * NP + NP * NP / |exponent| + NS * NP / |exponent| + 0.5 * NU * NU / |exponent|) U set(event Auth in game 7) U set(dist 8->9, proba <= (NS * NS + 2. * NP * NS + 2. * qE * NS + 2. * NU * NS + 2. * qD * NS + NP * NP + 2. * qE * NP + 2. * NU * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 2. * qD * qE + NU * NU + 2. * qD * NU + qD * qD + -1. * NS + -1. * NP + -1. * qE + -1. * NU + -1. * qD) / |G|) U set(dist 9->10, proba <= NS * NP / |exponent| + qE * NP / |exponent| + NU * NP / |exponent| + qD * NP / |exponent| + NP * NS / |exponent| + qE * NS / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G| + 0.5 * NS * NS / |exponent|) U set(event Encryptt in game 13) U set(dist 14->15, proba <= 10. * NU * NP / |exponent| + 2. * NS * NP / |exponent| + qH0 * NP / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + 8.5 * NU * NU / |G| + 3. * NS * NU / |G| + 2. * NP * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NP * qD / |G| + qD * NP / |exponent| + 1. / |exponent| * NP + 15. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + NU * qH1 / |hash1| + NS * NP / |G| + qD * NU / |G| + 0.5 * qD * qD / |G|) U set(dist 23->24, proba <= 4. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|) U set(dist 31->32, proba <= 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)))
RESULT However, I could not bound the probability of set(event Auth in game 7)

Applying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
 yields

Game 36 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@1_X_3680[@i_240], @2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    event termU(U, X, S, Ystar_u, r1_94, r_368);
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    event termU(U, X, S, Ystar_u, r1_94, r_380);
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233], Yp[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    event termU(U, X, S, Ystar_u, r1_94, r_392);
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232], Y[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    event termU(U, X, S, Ystar_u, r1_94, r_404);
    out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    event termU(U, X, S, Ystar_u, r1_94, r_362);
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    if defined(r_404[j]) then
    let sk_s: hash0 = r_404[j] in
    event termS(U, X_s, S, @2_r2_185, auth_s, r_404[j])
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_X_3680[@i_210], @1_x_737[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = @1_X_3680[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_exp'(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@1_X_3680[@i_200], @2_m[@i_200], @2_kd[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_X_3680[@i_200])
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_X_3680: G;
    let @1_x_737: exponent = cst_exponent in
    out(@2_c4[!_61], @1_X_3680)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying simplify yields

Game 37 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_x_737[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    let sk_s: hash0 = r_404[j]
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_X_3680[@i_210], @2_kd[@i_210], @2_m[@i_210], @1_x_737[@i_210]) && ((@2_x = @1_X_3680[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_exp'(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_X_3680[@i_200], @1_x_737[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_X_3680[@i_200])
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_X_3680: G;
    let @1_x_737: exponent = cst_exponent in
    out(@2_c4[!_61], @1_X_3680)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of useless yields

Game 38 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_X_3680[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    let sk_s: hash0 = r_404[j]
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_X_3680[@i_210], @2_kd[@i_210], @2_m[@i_210], @1_X_3680[@i_210]) && ((@2_x = @1_X_3680[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_exp'(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_X_3680[@i_200], @1_X_3680[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_X_3680[@i_200])
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_X_3680: G;
    out(@2_c4[!_61], @1_X_3680)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
 yields

Game 39 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_X_3680[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    let sk_s: hash0 = r_404[j]
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new @1_X_3788: G;
  let Yp: G = @1_X_3788 in
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_X_3680[@i_210], @2_kd[@i_210], @2_m[@i_210], @1_X_3680[@i_210]) && ((@2_x = @1_X_3680[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_exp'(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(Yp[@i_203], @2_r2_182[@i_203]) && ((@2_x = Yp[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_X_3680[@i_200], @1_X_3680[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_X_3680[@i_200])
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], Yp[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Yp[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_X_3680: G;
    out(@2_c4[!_61], @1_X_3680)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of useless yields

Game 40 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_X_3680[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    let sk_s: hash0 = r_404[j]
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new @1_X_3788: G;
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_X_3680[@i_210], @2_kd[@i_210], @2_m[@i_210], @1_X_3680[@i_210]) && ((@2_x = @1_X_3680[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_exp'(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(@1_X_3788[@i_203], xp[@i_203], @2_r2_182[@i_203]) && ((@2_x = @1_X_3788[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_X_3680[@i_200], @1_X_3680[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_X_3680[@i_200])
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@1_X_3788[@i_193], xp[@i_193], @2_r2_182[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3788[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_X_3680: G;
    out(@2_c4[!_61], @1_X_3680)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
 yields

Game 41 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_X_3680[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    let sk_s: hash0 = r_404[j]
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new @1_X_3854: G;
  let xp: exponent = cst_exponent in
  let Xp: G = @1_X_3854 in
  new @1_X_3788: G;
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, Xp, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_X_3680[@i_210], @2_kd[@i_210], @2_m[@i_210], @1_X_3680[@i_210]) && ((@2_x = @1_X_3680[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_exp'(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(@1_X_3854[@i_203], @1_X_3788[@i_203], xp[@i_203], @2_r2_182[@i_203]) && ((@2_x = @1_X_3788[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_X_3680[@i_200], @1_X_3680[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_X_3680[@i_200])
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@1_X_3854[@i_193], @1_X_3788[@i_193], xp[@i_193], @2_r2_182[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3788[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_X_3680: G;
    out(@2_c4[!_61], @1_X_3680)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of useless yields

Game 42 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_X_3680[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    let sk_s: hash0 = r_404[j]
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new @1_X_3854: G;
  new @1_X_3788: G;
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, @1_X_3854, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_X_3680[@i_210], @2_kd[@i_210], @2_m[@i_210], @1_X_3680[@i_210]) && ((@2_x = @1_X_3680[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_exp'(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(@1_X_3854[@i_203], @1_X_3788[@i_203], @1_X_3854[@i_203], @2_r2_182[@i_203]) && ((@2_x = @1_X_3788[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_X_3680[@i_200], @1_X_3680[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_X_3680[@i_200])
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@1_X_3854[@i_193], @1_X_3788[@i_193], @1_X_3854[@i_193], @2_r2_182[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3788[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_X_3680: G;
    out(@2_c4[!_61], @1_X_3680)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
 yields

Game 43 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_X_3680[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new @1_X_3918: G;
  let Y: G = @1_X_3918 in
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    let sk_s: hash0 = r_404[j]
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new @1_X_3854: G;
  new @1_X_3788: G;
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, @1_X_3854, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_X_3680[@i_210], @2_kd[@i_210], @2_m[@i_210], @1_X_3680[@i_210]) && ((@2_x = @1_X_3680[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_exp'(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(@1_X_3854[@i_203], @1_X_3788[@i_203], @1_X_3854[@i_203], @2_r2_182[@i_203]) && ((@2_x = @1_X_3788[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(Y[@i_202], @2_r2_185[@i_202]) && ((@2_x = Y[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_X_3680[@i_200], @1_X_3680[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_X_3680[@i_200])
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@1_X_3854[@i_193], @1_X_3788[@i_193], @1_X_3854[@i_193], @2_r2_182[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3788[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], Y[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y[@i_192])
  else
    new @1_X_3680: G;
    out(@2_c4[!_61], @1_X_3680)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of useless yields

Game 44 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_X_3680[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  else
    new @1_x_874: exponent;
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new @1_X_3918: G;
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    let sk_s: hash0 = r_404[j]
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3918 = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new @1_X_3854: G;
  new @1_X_3788: G;
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, @1_X_3854, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_X_3680[@i_210], @2_kd[@i_210], @2_m[@i_210], @1_X_3680[@i_210]) && ((@2_x = @1_X_3680[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_exp'(g, @1_x_874[@i_206])) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(@1_X_3854[@i_203], @1_X_3788[@i_203], @1_X_3854[@i_203], @2_r2_182[@i_203]) && ((@2_x = @1_X_3788[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(@1_X_3918[@i_202], @1_X_3918[@i_202], @2_r2_185[@i_202]) && ((@2_x = @1_X_3918[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_X_3680[@i_200], @1_X_3680[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_X_3680[@i_200])
  orfind @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_exp'(g, @1_x_874[@i_196]))
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@1_X_3854[@i_193], @1_X_3788[@i_193], @1_X_3854[@i_193], @2_r2_182[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3788[@i_193])
  orfind @i_192 <= NS suchthat defined(@1_X_3918[@i_192], @1_X_3918[@i_192], @2_r2_185[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3918[@i_192])
  else
    new @1_X_3680: G;
    out(@2_c4[!_61], @1_X_3680)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
 yields

Game 45 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_X_3680[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(@1_X_3980[@i_236], Ystar_u[@i_236], @1_x_874[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  else
    new @1_X_3980: G;
    let @1_x_874: exponent = cst_exponent in
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new @1_X_3918: G;
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    let sk_s: hash0 = r_404[j]
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3918 = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new @1_X_3854: G;
  new @1_X_3788: G;
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, @1_X_3854, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_X_3680[@i_210], @2_kd[@i_210], @2_m[@i_210], @1_X_3680[@i_210]) && ((@2_x = @1_X_3680[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_X_3980[@i_206], @1_x_874[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_X_3980[@i_206]) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(@1_X_3854[@i_203], @1_X_3788[@i_203], @1_X_3854[@i_203], @2_r2_182[@i_203]) && ((@2_x = @1_X_3788[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(@1_X_3918[@i_202], @1_X_3918[@i_202], @2_r2_185[@i_202]) && ((@2_x = @1_X_3918[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_X_3680[@i_200], @1_X_3680[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_X_3680[@i_200])
  orfind @i_196 <= NU suchthat defined(@1_X_3980[@i_196], Ystar_u[@i_196], @1_x_874[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3980[@i_196])
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@1_X_3854[@i_193], @1_X_3788[@i_193], @1_X_3854[@i_193], @2_r2_182[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3788[@i_193])
  orfind @i_192 <= NS suchthat defined(@1_X_3918[@i_192], @1_X_3918[@i_192], @2_r2_185[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3918[@i_192])
  else
    new @1_X_3680: G;
    out(@2_c4[!_61], @1_X_3680)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of useless yields

Game 46 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_X_3680[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(@1_X_3980[@i_236], Ystar_u[@i_236], @1_X_3980[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  else
    new @1_X_3980: G;
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new @1_X_3918: G;
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    let sk_s: hash0 = r_404[j]
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3918 = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new @1_X_3854: G;
  new @1_X_3788: G;
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, @1_X_3854, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_X_3680[@i_210], @2_kd[@i_210], @2_m[@i_210], @1_X_3680[@i_210]) && ((@2_x = @1_X_3680[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_X_3980[@i_206], @1_X_3980[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_X_3980[@i_206]) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(@1_X_3854[@i_203], @1_X_3788[@i_203], @1_X_3854[@i_203], @2_r2_182[@i_203]) && ((@2_x = @1_X_3788[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(@1_X_3918[@i_202], @1_X_3918[@i_202], @2_r2_185[@i_202]) && ((@2_x = @1_X_3918[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_X_3680[@i_200], @1_X_3680[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_X_3680[@i_200])
  orfind @i_196 <= NU suchthat defined(@1_X_3980[@i_196], Ystar_u[@i_196], @1_X_3980[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3980[@i_196])
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@1_X_3854[@i_193], @1_X_3788[@i_193], @1_X_3854[@i_193], @2_r2_182[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3788[@i_193])
  orfind @i_192 <= NS suchthat defined(@1_X_3918[@i_192], @1_X_3918[@i_192], @2_r2_185[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3918[@i_192])
  else
    new @1_X_3680: G;
    out(@2_c4[!_61], @1_X_3680)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
 yields

Game 47 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new @1_X_4047: G;
  let X: G = @1_X_4047 in
  out(c2[!_57], (U, X));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_X_3680[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(@1_X_3980[@i_236], Ystar_u[@i_236], @1_X_3980[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  else
    new @1_X_3980: G;
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new @1_X_3918: G;
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    let sk_s: hash0 = r_404[j]
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3918 = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new @1_X_3854: G;
  new @1_X_3788: G;
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, @1_X_3854, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_X_3680[@i_210], @2_kd[@i_210], @2_m[@i_210], @1_X_3680[@i_210]) && ((@2_x = @1_X_3680[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_X_3980[@i_206], @1_X_3980[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_X_3980[@i_206]) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(@1_X_3854[@i_203], @1_X_3788[@i_203], @1_X_3854[@i_203], @2_r2_182[@i_203]) && ((@2_x = @1_X_3788[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(@1_X_3918[@i_202], @1_X_3918[@i_202], @2_r2_185[@i_202]) && ((@2_x = @1_X_3918[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_X_3680[@i_200], @1_X_3680[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_X_3680[@i_200])
  orfind @i_196 <= NU suchthat defined(@1_X_3980[@i_196], Ystar_u[@i_196], @1_X_3980[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3980[@i_196])
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@1_X_3854[@i_193], @1_X_3788[@i_193], @1_X_3854[@i_193], @2_r2_182[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3788[@i_193])
  orfind @i_192 <= NS suchthat defined(@1_X_3918[@i_192], @1_X_3918[@i_192], @2_r2_185[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3918[@i_192])
  else
    new @1_X_3680: G;
    out(@2_c4[!_61], @1_X_3680)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of useless yields

Game 48 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new @1_X_4047: G;
  out(c2[!_57], (U, @1_X_4047));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_X_3680[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(@1_X_3980[@i_236], Ystar_u[@i_236], @1_X_3980[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  else
    new @1_X_3980: G;
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new @1_X_3918: G;
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(@1_X_4047[j], @1_X_4047[j]) && (@1_X_4047[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    let sk_s: hash0 = r_404[j]
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3918 = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new @1_X_3854: G;
  new @1_X_3788: G;
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, @1_X_3854, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_X_3680[@i_210], @2_kd[@i_210], @2_m[@i_210], @1_X_3680[@i_210]) && ((@2_x = @1_X_3680[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_X_3980[@i_206], @1_X_3980[@i_206], Ystar_u[@i_206]) && ((@2_x = @1_X_3980[@i_206]) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(@1_X_3854[@i_203], @1_X_3788[@i_203], @1_X_3854[@i_203], @2_r2_182[@i_203]) && ((@2_x = @1_X_3788[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(@1_X_3918[@i_202], @1_X_3918[@i_202], @2_r2_185[@i_202]) && ((@2_x = @1_X_3918[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_X_3680[@i_200], @1_X_3680[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_X_3680[@i_200])
  orfind @i_196 <= NU suchthat defined(@1_X_3980[@i_196], Ystar_u[@i_196], @1_X_3980[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3980[@i_196])
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@1_X_3854[@i_193], @1_X_3788[@i_193], @1_X_3854[@i_193], @2_r2_182[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3788[@i_193])
  orfind @i_192 <= NS suchthat defined(@1_X_3918[@i_192], @1_X_3918[@i_192], @2_r2_185[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3918[@i_192])
  else
    new @1_X_3680: G;
    out(@2_c4[!_61], @1_X_3680)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying equivalence
equiv ! !_49 <= N new X: G; (
  ! !_50 <= N2 OX() := X,
  ! !_51 <= N3 Oeq(X': G) := (X' = X))
<=(set(proba <= #Oeq / |G|))=> [manual]
      ! !_52 <= N (
  ! !_53 <= N2 OX() := find [unique] j_55 <= N2 suchthat defined(Y[j_55]) then Y[j_55] else new Y: G; Y,
  ! !_54 <= N3 Oeq(X': G) := find [unique] j_56 <= N2 suchthat defined(Y[j_56]) then (X' = Y[j_56]) else false)
with @1_X_3980 [Excluding set(dist 48->49, proba <= NU * qE / |G|)] yields

Game 49 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new @1_X_4047: G;
  out(c2[!_57], (U, @1_X_4047));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_X_3680[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(@1_X_3980[@i_236], Ystar_u[@i_236], @1_X_3980[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  else
    let @1_X_3980: G = cst_G in
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new @1_X_3918: G;
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(@1_X_4047[j], @1_X_4047[j]) && (@1_X_4047[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    let sk_s: hash0 = r_404[j]
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3918 = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new @1_X_3854: G;
  new @1_X_3788: G;
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, @1_X_3854, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_X_3680[@i_210], @2_kd[@i_210], @2_m[@i_210], @1_X_3680[@i_210]) && ((@2_x = @1_X_3680[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_206 <= NU suchthat defined(@1_X_3980[@i_206], @1_X_3980[@i_206], Ystar_u[@i_206]) && find [unique] @i_4151 <= qD suchthat defined(@i_206, @i_196[@i_4151], Y_4147[@i_4151]) && (@i_196[@i_4151] = @i_206) then ((@2_x = Y_4147[@i_4151]) && (@2_ke = pw)) else (false && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_206])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(@1_X_3854[@i_203], @1_X_3788[@i_203], @1_X_3854[@i_203], @2_r2_182[@i_203]) && ((@2_x = @1_X_3788[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(@1_X_3918[@i_202], @1_X_3918[@i_202], @2_r2_185[@i_202]) && ((@2_x = @1_X_3918[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_X_3680[@i_200], @1_X_3680[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_X_3680[@i_200])
  orfind @i_196 <= NU suchthat defined(@1_X_3980[@i_196], Ystar_u[@i_196], @1_X_3980[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
  (
    find [unique] @i_4149 <= qD suchthat defined(@i_196, @i_196[@i_4149], Y_4147[@i_4149]) && (@i_196[@i_4149] = @i_196) then
      out(@2_c4[!_61], Y_4147[@i_4149])
    else
      new Y_4147: G;
      out(@2_c4[!_61], Y_4147)
  )
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@1_X_3854[@i_193], @1_X_3788[@i_193], @1_X_3854[@i_193], @2_r2_182[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3788[@i_193])
  orfind @i_192 <= NS suchthat defined(@1_X_3918[@i_192], @1_X_3918[@i_192], @2_r2_185[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3918[@i_192])
  else
    new @1_X_3680: G;
    out(@2_c4[!_61], @1_X_3680)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying simplify yields

Game 50 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new @1_X_4047: G;
  out(c2[!_57], (U, @1_X_4047));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_X_3680[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_X_3980[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  else
    let @1_X_3980: G = cst_G in
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new @1_X_3918: G;
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(@1_X_4047[j]) && (@1_X_4047[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    let sk_s: hash0 = r_404[j]
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3918 = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new @1_X_3854: G;
  new @1_X_3788: G;
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, @1_X_3854, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_X_3680[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = @1_X_3680[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_4151 <= qD suchthat defined(@i_196[@i_4151], Y_4147[@i_4151], Ystar_u[@i_196[@i_4151]], @1_X_3980[@i_196[@i_4151]]) && ((@i_196[@i_4151] = @i_196[@i_4151]) && ((@2_x = Y_4147[@i_4151]) && (@2_ke = pw))) then
  (
    let @i_206 <= NU = @i_196[@i_4151] in
    out(@2_c2[!_60], Ystar_u[@i_196[@i_4151]])
  )
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(@1_X_3788[@i_203], @2_r2_182[@i_203]) && ((@2_x = @1_X_3788[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(@1_X_3918[@i_202], @2_r2_185[@i_202]) && ((@2_x = @1_X_3918[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_X_3680[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_X_3680[@i_200])
  orfind @i_196 <= NU, @i_4149 <= qD suchthat defined(Ystar_u[@i_196], @i_196[@i_4149], Y_4147[@i_4149], @1_X_3980[@i_196]) && (((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) && (@i_196[@i_4149] = @i_196)) then
    out(@2_c4[!_61], Y_4147[@i_4149])
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], @1_X_3788[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3788[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], @1_X_3918[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3918[@i_192])
  else
    find @i_196 <= NU suchthat defined(Ystar_u[@i_196], @1_X_3980[@i_196]) && ((@2_m = Ystar_u[@i_196]) && (@2_kd = pw)) then
      new Y_4147: G;
      out(@2_c4[!_61], Y_4147)
    else
      new @1_X_3680: G;
      out(@2_c4[!_61], @1_X_3680)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying SA rename @i_196 yields

Game 51 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new @1_X_4047: G;
  out(c2[!_57], (U, @1_X_4047));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_X_3680[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], @1_X_3980[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  else
    let @1_X_3980: G = cst_G in
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new @1_X_3918: G;
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(@1_X_4047[j]) && (@1_X_4047[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    let sk_s: hash0 = r_404[j]
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3918 = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new @1_X_3854: G;
  new @1_X_3788: G;
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, @1_X_3854, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_X_3680[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = @1_X_3680[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_4151 <= qD suchthat defined(@i_4320[@i_4151], Y_4147[@i_4151], Ystar_u[@i_4320[@i_4151]], @1_X_3980[@i_4320[@i_4151]]) && ((@i_4320[@i_4151] = @i_4320[@i_4151]) && ((@2_x = Y_4147[@i_4151]) && (@2_ke = pw))) then
  (
    let @i_206 <= NU = @i_4320[@i_4151] in
    out(@2_c2[!_60], Ystar_u[@i_4320[@i_4151]])
  )
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(@1_X_3788[@i_203], @2_r2_182[@i_203]) && ((@2_x = @1_X_3788[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(@1_X_3918[@i_202], @2_r2_185[@i_202]) && ((@2_x = @1_X_3918[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_X_3680[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_X_3680[@i_200])
  orfind @i_4319 <= NU, @i_4149 <= qD suchthat defined(Ystar_u[@i_4319], @i_4320[@i_4149], Y_4147[@i_4149], @1_X_3980[@i_4319]) && (((@2_m = Ystar_u[@i_4319]) && (@2_kd = pw)) && (@i_4320[@i_4149] = @i_4319)) then
    out(@2_c4[!_61], Y_4147[@i_4149])
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], @1_X_3788[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3788[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], @1_X_3918[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3918[@i_192])
  else
    find @i_4320 <= NU suchthat defined(Ystar_u[@i_4320], @1_X_3980[@i_4320]) && ((@2_m = Ystar_u[@i_4320]) && (@2_kd = pw)) then
      new Y_4147: G;
      out(@2_c4[!_61], Y_4147)
    else
      new @1_X_3680: G;
      out(@2_c4[!_61], @1_X_3680)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of useless yields

Game 52 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new @1_X_4047: G;
  out(c2[!_57], (U, @1_X_4047));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_X_3680[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], r_362[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  else
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new @1_X_3918: G;
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(@1_X_4047[j]) && (@1_X_4047[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    let sk_s: hash0 = r_404[j]
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3918 = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new @1_X_3854: G;
  new @1_X_3788: G;
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, @1_X_3854, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_X_3680[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = @1_X_3680[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_4151 <= qD suchthat defined(@i_4320[@i_4151], Y_4147[@i_4151], Ystar_u[@i_4320[@i_4151]], r_362[@i_4320[@i_4151]]) && ((@i_4320[@i_4151] = @i_4320[@i_4151]) && ((@2_x = Y_4147[@i_4151]) && (@2_ke = pw))) then
    out(@2_c2[!_60], Ystar_u[@i_4320[@i_4151]])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(@1_X_3788[@i_203], @2_r2_182[@i_203]) && ((@2_x = @1_X_3788[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(@1_X_3918[@i_202], @2_r2_185[@i_202]) && ((@2_x = @1_X_3918[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_X_3680[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_X_3680[@i_200])
  orfind @i_4319 <= NU, @i_4149 <= qD suchthat defined(Ystar_u[@i_4319], @i_4320[@i_4149], Y_4147[@i_4149], r_362[@i_4319]) && (((@2_m = Ystar_u[@i_4319]) && (@2_kd = pw)) && (@i_4320[@i_4149] = @i_4319)) then
    out(@2_c4[!_61], Y_4147[@i_4149])
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], @1_X_3788[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3788[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], @1_X_3918[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3918[@i_192])
  else
    find @i_4320 <= NU suchthat defined(Ystar_u[@i_4320], r_362[@i_4320]) && ((@2_m = Ystar_u[@i_4320]) && (@2_kd = pw)) then
      new Y_4147: G;
      out(@2_c4[!_61], Y_4147)
    else
      new @1_X_3680: G;
      out(@2_c4[!_61], @1_X_3680)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying simplify yields

Game 53 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new @1_X_4047: G;
  out(c2[!_57], (U, @1_X_4047));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_X_3680[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], r_362[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  else
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new @1_X_3918: G;
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(@1_X_4047[j]) && (@1_X_4047[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    let sk_s: hash0 = r_404[j]
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3918 = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new @1_X_3854: G;
  new @1_X_3788: G;
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, @1_X_3854, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_X_3680[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = @1_X_3680[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_4151 <= qD suchthat defined(Y_4147[@i_4151], Ystar_u[@i_4320[@i_4151]]) && ((@2_x = Y_4147[@i_4151]) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_4320[@i_4151]])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(@1_X_3788[@i_203], @2_r2_182[@i_203]) && ((@2_x = @1_X_3788[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(@1_X_3918[@i_202], @2_r2_185[@i_202]) && ((@2_x = @1_X_3918[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_X_3680[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_X_3680[@i_200])
  orfind @i_4149 <= qD suchthat defined(Ystar_u[@i_4320[@i_4149]], Y_4147[@i_4149]) && ((@2_m = Ystar_u[@i_4320[@i_4149]]) && (@2_kd = pw)) then
  (
    let @i_4319 <= NU = @i_4320[@i_4149] in
    out(@2_c4[!_61], Y_4147[@i_4149])
  )
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], @1_X_3788[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3788[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], @1_X_3918[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3918[@i_192])
  else
    find @i_4320 <= NU suchthat defined(Ystar_u[@i_4320], r_362[@i_4320]) && ((@2_m = Ystar_u[@i_4320]) && (@2_kd = pw)) then
      new Y_4147: G;
      out(@2_c4[!_61], Y_4147)
    else
      new @1_X_3680: G;
      out(@2_c4[!_61], @1_X_3680)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)


Applying remove assignments of useless yields

Game 54 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_57 <= NU
  in(c1[!_57], ());
  new @1_X_4047: G;
  out(c2[!_57], (U, @1_X_4047));
  in(c5[!_57], (=S, Ystar_u: G));
  find [unique] @i_240 <= qD suchthat defined(@2_m[@i_240], @2_kd[@i_240], @1_X_3680[@i_240]) && ((Ystar_u = @2_m[@i_240]) && (pw = @2_kd[@i_240])) then
  (
    new r_368: hash0;
    let sk_u: hash0 = r_368 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_236 <= NU suchthat defined(Ystar_u[@i_236], r_362[@i_236]) && (Ystar_u = Ystar_u[@i_236]) then
  (
    new r_380: hash0;
    let sk_u: hash0 = r_380 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_234 <= qE suchthat defined(@2_r2_179[@i_234], @2_ke[@i_234]) && ((Ystar_u = @2_r2_179[@i_234]) && (pw = @2_ke[@i_234])) then
    event Encryptt
  orfind @i_233 <= NP suchthat defined(@2_r2_182[@i_233]) && (Ystar_u = @2_r2_182[@i_233]) then
  (
    new r_392: hash0;
    let sk_u: hash0 = r_392 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  orfind @i_232 <= NS suchthat defined(@2_r2_185[@i_232]) && (Ystar_u = @2_r2_185[@i_232]) then
  (
    new r_404: hash0;
    let sk_u: hash0 = r_404 in
    new r1_94: hash1;
    out(c6[!_57], r1_94)
  )
  else
    new r1_94: hash1;
    new r_362: hash0;
    let sk_u: hash0 = r_362 in
    out(c6[!_57], r1_94)
) | (
  ! !_58 <= NS
  in(c3[!_58], (=U, X_s: G));
  new @1_X_3918: G;
  new @2_r2_185: G;
  out(c4[!_58], (S, @2_r2_185));
  in(c7[!_58], auth_s: hash1);
  find j <= NU suchthat defined(@1_X_4047[j]) && (@1_X_4047[j] = X_s) then
  (
    if defined(@i_232[j], r1_94[j], r_404[j]) && (!_58 = @i_232[j]) then
    if (auth_s = r1_94[j]) then
    let sk_s: hash0 = r_404[j]
  )
  else
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_82[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3918 = x14[nj]) && (auth_s = r1_82[nj]))))) then
    event Auth
) | (
  ! !_59 <= NP
  in(cp[!_59], ());
  new @1_X_3854: G;
  new @1_X_3788: G;
  new @2_r2_182: G;
  new r1_88: hash1;
  new r_344: hash0;
  let sk_p: hash0 = r_344 in
  out(cp[!_59], (U, @1_X_3854, S, @2_r2_182, r1_88))
) | (
  ! !_60 <= qE
  in(@2_c1[!_60], (@2_x: G, @2_ke: passwd));
  find [unique] @i_210 <= qD suchthat defined(@1_X_3680[@i_210], @2_kd[@i_210], @2_m[@i_210]) && ((@2_x = @1_X_3680[@i_210]) && (@2_ke = @2_kd[@i_210])) then
    out(@2_c2[!_60], @2_m[@i_210])
  orfind @i_4151 <= qD suchthat defined(Y_4147[@i_4151], Ystar_u[@i_4320[@i_4151]]) && ((@2_x = Y_4147[@i_4151]) && (@2_ke = pw)) then
    out(@2_c2[!_60], Ystar_u[@i_4320[@i_4151]])
  orfind @i_204 <= qE suchthat defined(@2_x[@i_204], @2_ke[@i_204], @2_r2_179[@i_204]) && ((@2_x = @2_x[@i_204]) && (@2_ke = @2_ke[@i_204])) then
    out(@2_c2[!_60], @2_r2_179[@i_204])
  orfind @i_203 <= NP suchthat defined(@1_X_3788[@i_203], @2_r2_182[@i_203]) && ((@2_x = @1_X_3788[@i_203]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_182[@i_203])
  orfind @i_202 <= NS suchthat defined(@1_X_3918[@i_202], @2_r2_185[@i_202]) && ((@2_x = @1_X_3918[@i_202]) && (@2_ke = pw)) then
    out(@2_c2[!_60], @2_r2_185[@i_202])
  else
    new @2_r2_179: G;
    out(@2_c2[!_60], @2_r2_179)
) | (
  ! !_61 <= qD
  in(@2_c3[!_61], (@2_m: G, @2_kd: passwd));
  find [unique] @i_200 <= qD suchthat defined(@2_m[@i_200], @2_kd[@i_200], @1_X_3680[@i_200]) && ((@2_m = @2_m[@i_200]) && (@2_kd = @2_kd[@i_200])) then
    out(@2_c4[!_61], @1_X_3680[@i_200])
  orfind @i_4149 <= qD suchthat defined(Ystar_u[@i_4320[@i_4149]], Y_4147[@i_4149]) && ((@2_m = Ystar_u[@i_4320[@i_4149]]) && (@2_kd = pw)) then
    out(@2_c4[!_61], Y_4147[@i_4149])
  orfind @i_194 <= qE suchthat defined(@2_r2_179[@i_194], @2_ke[@i_194], @2_x[@i_194]) && ((@2_m = @2_r2_179[@i_194]) && (@2_kd = @2_ke[@i_194])) then
    out(@2_c4[!_61], @2_x[@i_194])
  orfind @i_193 <= NP suchthat defined(@2_r2_182[@i_193], @1_X_3788[@i_193]) && ((@2_m = @2_r2_182[@i_193]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3788[@i_193])
  orfind @i_192 <= NS suchthat defined(@2_r2_185[@i_192], @1_X_3918[@i_192]) && ((@2_m = @2_r2_185[@i_192]) && (@2_kd = pw)) then
    out(@2_c4[!_61], @1_X_3918[@i_192])
  else
    find @i_4320 <= NU suchthat defined(Ystar_u[@i_4320], r_362[@i_4320]) && ((@2_m = Ystar_u[@i_4320]) && (@2_kd = pw)) then
      new Y_4147: G;
      out(@2_c4[!_61], Y_4147)
    else
      new @1_X_3680: G;
      out(@2_c4[!_61], @1_X_3680)
) | (
  ! !_62 <= qH0
  in(c10[!_62], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_428 <= qH0 suchthat defined(x1[@i_428], x2[@i_428], x3[@i_428], x4[@i_428], x5[@i_428], r_338[@i_428]) && ((x1 = x1[@i_428]) && ((x2 = x2[@i_428]) && ((x3 = x3[@i_428]) && ((x4 = x4[@i_428]) && (x5 = x5[@i_428]))))) then
    out(c20[!_62], r_338[@i_428])
  else
    new r_338: hash0;
    out(c20[!_62], r_338)
) | (
  ! !_63 <= qH1
  in(c11[!_63], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_103 <= qH1 suchthat defined(x11[@i_103], x12[@i_103], x13[@i_103], x14[@i_103], x15[@i_103], r1_82[@i_103]) && ((x11 = x11[@i_103]) && ((x12 = x12[@i_103]) && ((x13 = x13[@i_103]) && ((x14 = x14[@i_103]) && (x15 = x15[@i_103]))))) then
    out(c21[!_63], r1_82[@i_103])
  else
    new r1_82: hash1;
    out(c21[!_63], r1_82)
)

RESULT time(context for game 31) = 0
Please enter a command: quit
blanchet@laurier:/import/absint3/blanchet/dev/cryptoverif$ exit

Process shell finished
