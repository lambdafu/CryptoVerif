Doing expand if, let, find... No change.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
No change.
Doing move all binders... No change.
Doing remove assignments of useless... No change.
{277}in(start, ());
{276}new pw: passwd;
{275}out(c8, {274}());
{273}(
{268}  ! !_41 <= NU
{267}  in(c1[{266}!_41], ());
{265}  new x: exponent;
{264}  let X: G = {263}exp({260}g, {262}x) in
{259}  out(c2[{258}!_41], {257}({254}U, {256}X));
{253}  in(c5[{252}!_41], (={251}S, Ystar_u: G));
{250}  let Y_u: G = {249}dec({247}Ystar_u, {248}pw) in
{245}  let K_u: G = {244}exp({241}Y_u, {243}x) in
{239}  let auth_u: hash1 = {238}h1({230}U, {231}S, {233}X, {235}Y_u, {237}K_u) in
{229}  let sk_u: hash0 = {228}h0({220}U, {221}S, {223}X, {225}Y_u, {227}K_u) in
{219}  event {218}termU({208}U, {210}X, {211}S, {213}Ystar_u, {215}auth_u, {217}sk_u);
{205}  out(c6[{204}!_41], {203}auth_u)
) | (
{195}  ! !_42 <= NS
{194}  in(c3[{193}!_42], (={192}U, X_s: G));
{191}  new y: exponent;
{190}  let Y: G = {189}exp({186}g, {188}y) in
{185}  let Ystar: G = {184}enc({182}Y, {183}pw) in
{180}  out(c4[{179}!_42], {178}({175}S, {177}Ystar));
{174}  in(c7[{173}!_42], auth_s: hash1);
{172}  let K_s: G = {171}exp({168}X_s, {170}y) in
{166}  if {165}({155}auth_s = {164}h1({156}U, {157}S, {159}X_s, {161}Y, {163}K_s)) then
{153}  let sk_s: hash0 = {152}h0({144}U, {145}S, {147}X_s, {149}Y, {151}K_s) in
{143}  event {142}termS({132}U, {134}X_s, {135}S, {137}Ystar, {139}auth_s, {141}sk_s)
) | (
{123}  ! !_43 <= NP
{122}  in(cp[{121}!_43], ());
{120}  new xp: exponent;
{119}  let Xp: G = {118}exp({115}g, {117}xp) in
{114}  new yp: exponent;
{113}  let Yp: G = {112}exp({109}g, {111}yp) in
{108}  let Kp: G = {107}exp({101}g, {106}mult({103}xp, {105}yp)) in
{100}  let Ystarp: G = {99}enc({97}Yp, {98}pw) in
{95}  let authp: hash1 = {94}h1({86}U, {87}S, {89}Xp, {91}Yp, {93}Kp) in
{85}  let sk_p: hash0 = {84}h0({76}U, {77}S, {79}Xp, {81}Yp, {83}Kp) in
{75}  out(cp[{74}!_43], {73}({65}U, {67}Xp, {68}S, {70}Ystarp, {72}authp))
) | (
{56}  ! !_44 <= qE
{55}  in(@2_c1[{54}!_44], (@2_x: G, @2_ke: passwd));
{53}  out(@2_c2[{52}!_44], {51}enc({48}@2_x, {50}@2_ke))
) | (
{45}  ! !_45 <= qD
{44}  in(@2_c3[{43}!_45], (@2_m: G, @2_kd: passwd));
{42}  out(@2_c4[{41}!_45], {40}dec({37}@2_m, {39}@2_kd))
) | (
{34}  ! !_46 <= qH0
{33}  in(c10[{32}!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
{31}  out(c20[{30}!_46], {29}h0({20}x1, {22}x2, {24}x3, {26}x4, {28}x5))
) | (
{17}  ! !_47 <= qH1
{16}  in(c11[{15}!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
{14}  out(c21[{13}!_47], {12}h1({3}x11, {5}x12, {7}x13, {9}x14, {11}x15))
)

Doing insert instruction find j <= NU suchthat defined(X[j]) && X[j] = X_s then at occurrence 172... Done.
Trying equivalence
equiv ! !_39 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_40 <= N (x1_56: host, x2_55: host, x3_54: G, x4_53: G, x5_52: G) -> let x1: host = x1_56 in let x2: host = x2_55 in let x3: G = x3_54 in let x4: G = x4_53 in let x5: G = x5_52 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r1[j]) && otheruses(r1[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r1[j] else new r1: hash1; r1
... Succeeded.
Doing simplify... Run simplify 3 time(s). Maximum reached.
Eliminated collisions between x and xp Probability: NU * NP / |exponent|
Eliminated collisions between x and x Probability: 0.5 * NU * NU / |exponent|
Eliminated collisions between y and yp Probability: NS * NP / |exponent|
Eliminated collisions between y and y Probability: 0.5 * NS * NS / |exponent|
Eliminated collisions between yp and yp Probability: 0.5 * NP * NP / |exponent|
Eliminated collisions between xp and xp Probability: 0.5 * NP * NP / |exponent|
Eliminated collisions between r1_84[!_42] and auth_s[!_42] Probability: NS / |hash1|
(r1_84[!_42] characterizes a part of r1_84[!_42] of type(s) hash1;
 auth_s[!_42] does not depend on r1_84[!_42])
Eliminated collisions between r1_78[!_42] and auth_s[!_42] Probability: NS / |hash1|
(r1_78[!_42] characterizes a part of r1_78[!_42] of type(s) hash1;
 auth_s[!_42] does not depend on r1_78[!_42])
Eliminated collisions between exp(g, yp[!_43]) and x4_68[!2_148] Probability: qH1 * NP / |exponent|
(exp(g, yp[!_43]) characterizes a part of yp[!_43] of type(s) exponent;
 x4_68[!2_148] does not depend on yp[!_43])
Eliminated collisions between exp(g, yp[!_43]) and x4_80[!2_146] Probability: NS * NP / |exponent|
(exp(g, yp[!_43]) characterizes a part of yp[!_43] of type(s) exponent;
 x4_80[!2_146] does not depend on yp[!_43])
Eliminated collisions between exp(g, yp[!_43]) and x4_86[!2_145] Probability: NS * NP / |exponent|
(exp(g, yp[!_43]) characterizes a part of yp[!_43] of type(s) exponent;
 x4_86[!2_145] does not depend on yp[!_43])
Eliminated collisions between exp(g, yp[!_43]) and x4_92[!2_144] Probability: NU * NP / |exponent|
(exp(g, yp[!_43]) characterizes a part of yp[!_43] of type(s) exponent;
 x4_92[!2_144] does not depend on yp[!_43])
Reduced (mult(x[j[!_42]], y[!_42]) = mult(xp[@i_114[!_42]], yp[@i_114[!_42]])) to (((x[j[!_42]] = xp[@i_114[!_42]]) && (y[!_42] = yp[@i_114[!_42]])) || ((x[j[!_42]] = yp[@i_114[!_42]]) && (y[!_42] = xp[@i_114[!_42]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_42]], y[!_42]) = mult(x[j[!_42]], y[@i_113[!_42]])) to (((x[j[!_42]] = x[j[!_42]]) && (y[!_42] = y[@i_113[!_42]])) || ((x[j[!_42]] = y[@i_113[!_42]]) && (y[!_42] = x[j[!_42]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_42]], y[!_42]) = mult(x[j[@i_112[!_42]]], y[@i_112[!_42]])) to (((x[j[!_42]] = x[j[@i_112[!_42]]]) && (y[!_42] = y[@i_112[!_42]])) || ((x[j[!_42]] = y[@i_112[!_42]]) && (y[!_42] = x[j[@i_112[!_42]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[@i_107[!_42]]], y[!_42]) = mult(x[j[@i_107[!_42]]], y[@i_107[!_42]])) to (((x[j[@i_107[!_42]]] = x[j[@i_107[!_42]]]) && (y[!_42] = y[@i_107[!_42]])) || ((x[j[@i_107[!_42]]] = y[@i_107[!_42]]) && (y[!_42] = x[j[@i_107[!_42]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(xp[!_43], yp[!_43]) = mult(xp[@i_104[!_43]], yp[@i_104[!_43]])) to (((xp[!_43] = xp[@i_104[!_43]]) && (yp[!_43] = yp[@i_104[!_43]])) || ((xp[!_43] = yp[@i_104[!_43]]) && (yp[!_43] = xp[@i_104[!_43]]))) Probability: 1. / |exponent| * NP
Done.
Doing move all binders... Done.
Doing remove assignments of useless... Done.
{810}in(start, ());
{809}new pw: passwd;
{808}out(c8, {807}());
{806}(
{801}  ! !_41 <= NU
{800}  in(c1[{799}!_41], ());
{798}  new x: exponent;
{797}  let X: G = {796}exp({793}g, {795}x) in
{792}  out(c2[{791}!_41], {790}({787}U, {789}X));
{786}  in(c5[{785}!_41], (={784}S, Ystar_u: G));
{783}  let Y_u: G = {782}dec({780}Ystar_u, {781}pw) in
{778}  let K_u: G = {777}exp({774}Y_u, {776}x) in
{772}  let x1_95: host = {771}U in
{770}  let x2_94: host = {769}S in
{768}  let x3_93: G = {767}cst_G in
{766}  let x4_92: G = {765}cst_G in
{764}  let x5_91: G = {763}cst_G in
{762}  find [unique] @i_120 <= qH1 suchthat defined(x11[{741}@i_120], x12[{743}@i_120], x13[{745}@i_120], x14[{747}@i_120], x15[{749}@i_120], x5_67[{751}@i_120], x4_68[{753}@i_120], x3_69[{755}@i_120], x2_70[{757}@i_120], x1_71[{759}@i_120], r1_66[{761}@i_120]) && otheruses(r1_66[{739}@i_120]) && {737}({709}({705}x1_95 = {708}x11[{707}@i_120]) && {736}({715}({711}x2_94 = {714}x12[{713}@i_120]) && {735}({721}({717}X = {720}x13[{719}@i_120]) && {734}({727}({723}Y_u = {726}x14[{725}@i_120]) && {733}({729}K_u = {732}x15[{731}@i_120]))))) then
  (
{703}    let sk_u: hash0 = {702}h0({694}U, {695}S, {697}X, {699}Y_u, {701}K_u) in
{693}    event {692}termU({681}U, {683}X, {684}S, {686}Ystar_u, {689}r1_66[{688}@i_120], {691}sk_u);
{678}    out(c6[{677}!_41], {676}r1_66[{675}@i_120])
  )
  else
{671}    new r1_90: hash1;
{670}    let sk_u: hash0 = {669}h0({661}U, {662}S, {664}X, {666}Y_u, {668}K_u) in
{660}    event {659}termU({649}U, {651}X, {652}S, {654}Ystar_u, {656}r1_90, {658}sk_u);
{646}    out(c6[{645}!_41], {644}r1_90)
) | (
{632}  ! !_42 <= NS
{631}  in(c3[{630}!_42], (={629}U, X_s: G));
{628}  new y: exponent;
{627}  let Y: G = {626}exp({623}g, {625}y) in
{622}  let Ystar: G = {621}enc({619}Y, {620}pw) in
{617}  out(c4[{616}!_42], {615}({612}S, {614}Ystar));
{611}  in(c7[{610}!_42], auth_s: hash1);
{609}  find j <= NU suchthat defined(X[{606}j], x[{608}j]) && {604}({601}X[{600}j] = {603}X_s) then
  (
{598}    let K_s: G = {597}exp({590}g, {596}mult({593}x[{592}j], {595}y)) in
{589}    let x1_89: host = {588}U in
{587}    let x2_88: host = {586}S in
{585}    find [unique] @i_115 <= qH1 suchthat defined(x11[{505}@i_115], x12[{507}@i_115], x13[{509}@i_115], x14[{511}@i_115], x15[{513}@i_115], x5_67[{515}@i_115], x4_68[{517}@i_115], x3_69[{519}@i_115], x2_70[{521}@i_115], x1_71[{523}@i_115], r1_66[{525}@i_115]) && otheruses(r1_66[{503}@i_115]) && {501}({473}({469}x1_89 = {472}x11[{471}@i_115]) && {500}({479}({475}x2_88 = {478}x12[{477}@i_115]) && {499}({485}({481}X_s = {484}x13[{483}@i_115]) && {498}({491}({487}Y = {490}x14[{489}@i_115]) && {497}({493}K_s = {496}x15[{495}@i_115]))))) then
    (
{467}      if {466}({462}auth_s = {465}r1_66[{464}@i_115]) then
{460}      let sk_s: hash0 = {459}h0({451}U, {452}S, {454}X_s, {456}Y, {458}K_s) in
{450}      event {449}termS({439}U, {441}X_s, {442}S, {444}Ystar, {446}auth_s, {448}sk_s)
    )
    orfind  suchthat defined(Y_u[{576}j], K_u[{578}j], x5_91[{580}j], x4_92[{582}j], r1_90[{584}j]) && otheruses(r1_90[{574}j]) && {572}({565}({561}Y = {564}Y_u[{563}j]) && {571}({567}K_s = {570}K_u[{569}j])) then
    (
{559}      if {558}({554}auth_s = {557}r1_90[{556}j]) then
{552}      let sk_s: hash0 = {551}h0({543}U, {544}S, {546}X_s, {548}Y, {550}K_s) in
{542}      event {541}termS({531}U, {533}X_s, {534}S, {536}Ystar, {538}auth_s, {540}sk_s)
    )
  )
  else
{429}    let K_s: G = {428}exp({425}X_s, {427}y) in
{423}    let x1_83: host = {422}U in
{421}    let x2_82: host = {420}S in
{419}    find [unique] @i_110 <= qH1 suchthat defined(x11[{398}@i_110], x12[{400}@i_110], x13[{402}@i_110], x14[{404}@i_110], x15[{406}@i_110], x5_67[{408}@i_110], x4_68[{410}@i_110], x3_69[{412}@i_110], x2_70[{414}@i_110], x1_71[{416}@i_110], r1_66[{418}@i_110]) && otheruses(r1_66[{396}@i_110]) && {394}({366}({362}x1_83 = {365}x11[{364}@i_110]) && {393}({372}({368}x2_82 = {371}x12[{370}@i_110]) && {392}({378}({374}X_s = {377}x13[{376}@i_110]) && {391}({384}({380}Y = {383}x14[{382}@i_110]) && {390}({386}K_s = {389}x15[{388}@i_110]))))) then
{360}    if {359}({355}auth_s = {358}r1_66[{357}@i_110]) then
{353}    let sk_s: hash0 = {352}h0({344}U, {345}S, {347}X_s, {349}Y, {351}K_s) in
{343}    event {342}termS({332}U, {334}X_s, {335}S, {337}Ystar, {339}auth_s, {341}sk_s)
) | (
{320}  ! !_43 <= NP
{319}  in(cp[{318}!_43], ());
{317}  new xp: exponent;
{316}  let Xp: G = {315}exp({312}g, {314}xp) in
{311}  new yp: exponent;
{310}  let Yp: G = {309}exp({306}g, {308}yp) in
{305}  let Kp: G = {304}exp({298}g, {303}mult({300}xp, {302}yp)) in
{297}  let Ystarp: G = {296}enc({294}Yp, {295}pw) in
{292}  let x1_77: host = {291}U in
{290}  let x2_76: host = {289}S in
{288}  let x3_75: G = {287}cst_G in
{286}  let x4_74: G = {285}cst_G in
{284}  let x5_73: G = {283}cst_G in
{282}  new r1_72: hash1;
{281}  let sk_p: hash0 = {280}h0({272}U, {273}S, {275}Xp, {277}Yp, {279}Kp) in
{271}  out(cp[{270}!_43], {269}({261}U, {263}Xp, {264}S, {266}Ystarp, {268}r1_72))
) | (
{248}  ! !_44 <= qE
{247}  in(@2_c1[{246}!_44], (@2_x: G, @2_ke: passwd));
{245}  out(@2_c2[{244}!_44], {243}enc({240}@2_x, {242}@2_ke))
) | (
{237}  ! !_45 <= qD
{236}  in(@2_c3[{235}!_45], (@2_m: G, @2_kd: passwd));
{234}  out(@2_c4[{233}!_45], {232}dec({229}@2_m, {231}@2_kd))
) | (
{226}  ! !_46 <= qH0
{225}  in(c10[{224}!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
{223}  out(c20[{222}!_46], {221}h0({212}x1, {214}x2, {216}x3, {218}x4, {220}x5))
) | (
{209}  ! !_47 <= qH1
{208}  in(c11[{207}!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
{206}  let x1_71: host = {205}cst_host in
{204}  let x2_70: host = {203}cst_host in
{202}  let x3_69: G = {201}cst_G in
{200}  let x4_68: G = {199}cst_G in
{198}  let x5_67: G = {197}cst_G in
{196}  find [unique] @i_100 <= qH1 suchthat defined(x11[{55}@i_100], x12[{57}@i_100], x13[{59}@i_100], x14[{61}@i_100], x15[{63}@i_100], x5_67[{65}@i_100], x4_68[{67}@i_100], x3_69[{69}@i_100], x2_70[{71}@i_100], x1_71[{73}@i_100], r1_66[{75}@i_100]) && otheruses(r1_66[{53}@i_100]) && {51}({23}({19}x11 = {22}x11[{21}@i_100]) && {50}({29}({25}x12 = {28}x12[{27}@i_100]) && {49}({35}({31}x13 = {34}x13[{33}@i_100]) && {48}({41}({37}x14 = {40}x14[{39}@i_100]) && {47}({43}x15 = {46}x15[{45}@i_100]))))) then
{17}    out(c21[{16}!_47], {15}r1_66[{14}@i_100])
  orfind @i_99 <= NP suchthat defined(Xp[{119}@i_99], Yp[{121}@i_99], Kp[{123}@i_99], x5_73[{125}@i_99], x4_74[{127}@i_99], x3_75[{129}@i_99], x1_77[{131}@i_99], x2_76[{133}@i_99], r1_72[{135}@i_99]) && otheruses(r1_72[{117}@i_99]) && {115}({87}({83}x11 = {86}x1_77[{85}@i_99]) && {114}({93}({89}x12 = {92}x2_76[{91}@i_99]) && {113}({99}({95}x13 = {98}Xp[{97}@i_99]) && {112}({105}({101}x14 = {104}Yp[{103}@i_99]) && {111}({107}x15 = {110}Kp[{109}@i_99]))))) then
{81}    out(c21[{80}!_47], {79}r1_72[{78}@i_99])
  orfind @i_96 <= NU suchthat defined(X[{179}@i_96], Y_u[{181}@i_96], K_u[{183}@i_96], x5_91[{185}@i_96], x4_92[{187}@i_96], x3_93[{189}@i_96], x1_95[{191}@i_96], x2_94[{193}@i_96], r1_90[{195}@i_96]) && otheruses(r1_90[{177}@i_96]) && {175}({147}({143}x11 = {146}x1_95[{145}@i_96]) && {174}({153}({149}x12 = {152}x2_94[{151}@i_96]) && {173}({159}({155}x13 = {158}X[{157}@i_96]) && {172}({165}({161}x14 = {164}Y_u[{163}@i_96]) && {171}({167}x15 = {170}K_u[{169}@i_96]))))) then
{141}    out(c21[{140}!_47], {139}r1_90[{138}@i_96])
  else
{11}    new r1_66: hash1;
{10}    out(c21[{9}!_47], {8}r1_66)
)

Doing insert instruction let Y' = dec(Ystar, pw) in at occurrence 429... Done.
{816}in(start, ());
{815}new pw: passwd;
{814}out(c8, {813}());
{812}(
{807}  ! !_41 <= NU
{806}  in(c1[{805}!_41], ());
{804}  new x: exponent;
{803}  let X: G = {802}exp({799}g, {801}x) in
{798}  out(c2[{797}!_41], {796}({793}U, {795}X));
{792}  in(c5[{791}!_41], (={790}S, Ystar_u: G));
{789}  let Y_u: G = {788}dec({786}Ystar_u, {787}pw) in
{784}  let K_u: G = {783}exp({780}Y_u, {782}x) in
{778}  let x1_95: host = {777}U in
{776}  let x2_94: host = {775}S in
{774}  let x3_93: G = {773}cst_G in
{772}  let x4_92: G = {771}cst_G in
{770}  let x5_91: G = {769}cst_G in
{768}  find [unique] @i_120 <= qH1 suchthat defined(x11[{747}@i_120], x12[{749}@i_120], x13[{751}@i_120], x14[{753}@i_120], x15[{755}@i_120], x5_67[{757}@i_120], x4_68[{759}@i_120], x3_69[{761}@i_120], x2_70[{763}@i_120], x1_71[{765}@i_120], r1_66[{767}@i_120]) && otheruses(r1_66[{745}@i_120]) && {743}({715}({711}x1_95 = {714}x11[{713}@i_120]) && {742}({721}({717}x2_94 = {720}x12[{719}@i_120]) && {741}({727}({723}X = {726}x13[{725}@i_120]) && {740}({733}({729}Y_u = {732}x14[{731}@i_120]) && {739}({735}K_u = {738}x15[{737}@i_120]))))) then
  (
{709}    let sk_u: hash0 = {708}h0({700}U, {701}S, {703}X, {705}Y_u, {707}K_u) in
{699}    event {698}termU({687}U, {689}X, {690}S, {692}Ystar_u, {695}r1_66[{694}@i_120], {697}sk_u);
{684}    out(c6[{683}!_41], {682}r1_66[{681}@i_120])
  )
  else
{677}    new r1_90: hash1;
{676}    let sk_u: hash0 = {675}h0({667}U, {668}S, {670}X, {672}Y_u, {674}K_u) in
{666}    event {665}termU({655}U, {657}X, {658}S, {660}Ystar_u, {662}r1_90, {664}sk_u);
{652}    out(c6[{651}!_41], {650}r1_90)
) | (
{638}  ! !_42 <= NS
{637}  in(c3[{636}!_42], (={635}U, X_s: G));
{634}  new y: exponent;
{633}  let Y: G = {632}exp({629}g, {631}y) in
{628}  let Ystar: G = {627}enc({625}Y, {626}pw) in
{623}  out(c4[{622}!_42], {621}({618}S, {620}Ystar));
{617}  in(c7[{616}!_42], auth_s: hash1);
{615}  find j <= NU suchthat defined(X[{612}j], x[{614}j]) && {610}({607}X[{606}j] = {609}X_s) then
  (
{604}    let K_s: G = {603}exp({596}g, {602}mult({599}x[{598}j], {601}y)) in
{595}    let x1_89: host = {594}U in
{593}    let x2_88: host = {592}S in
{591}    find [unique] @i_115 <= qH1 suchthat defined(x11[{511}@i_115], x12[{513}@i_115], x13[{515}@i_115], x14[{517}@i_115], x15[{519}@i_115], x5_67[{521}@i_115], x4_68[{523}@i_115], x3_69[{525}@i_115], x2_70[{527}@i_115], x1_71[{529}@i_115], r1_66[{531}@i_115]) && otheruses(r1_66[{509}@i_115]) && {507}({479}({475}x1_89 = {478}x11[{477}@i_115]) && {506}({485}({481}x2_88 = {484}x12[{483}@i_115]) && {505}({491}({487}X_s = {490}x13[{489}@i_115]) && {504}({497}({493}Y = {496}x14[{495}@i_115]) && {503}({499}K_s = {502}x15[{501}@i_115]))))) then
    (
{473}      if {472}({468}auth_s = {471}r1_66[{470}@i_115]) then
{466}      let sk_s: hash0 = {465}h0({457}U, {458}S, {460}X_s, {462}Y, {464}K_s) in
{456}      event {455}termS({445}U, {447}X_s, {448}S, {450}Ystar, {452}auth_s, {454}sk_s)
    )
    orfind  suchthat defined(Y_u[{582}j], K_u[{584}j], x5_91[{586}j], x4_92[{588}j], r1_90[{590}j]) && otheruses(r1_90[{580}j]) && {578}({571}({567}Y = {570}Y_u[{569}j]) && {577}({573}K_s = {576}K_u[{575}j])) then
    (
{565}      if {564}({560}auth_s = {563}r1_90[{562}j]) then
{558}      let sk_s: hash0 = {557}h0({549}U, {550}S, {552}X_s, {554}Y, {556}K_s) in
{548}      event {547}termS({537}U, {539}X_s, {540}S, {542}Ystar, {544}auth_s, {546}sk_s)
    )
  )
  else
{435}    let Y': G = {434}dec({432}Ystar, {433}pw) in
{430}    let K_s: G = {429}exp({426}X_s, {428}y) in
{424}    let x1_83: host = {423}U in
{422}    let x2_82: host = {421}S in
{420}    find [unique] @i_110 <= qH1 suchthat defined(x11[{399}@i_110], x12[{401}@i_110], x13[{403}@i_110], x14[{405}@i_110], x15[{407}@i_110], x5_67[{409}@i_110], x4_68[{411}@i_110], x3_69[{413}@i_110], x2_70[{415}@i_110], x1_71[{417}@i_110], r1_66[{419}@i_110]) && otheruses(r1_66[{397}@i_110]) && {395}({367}({363}x1_83 = {366}x11[{365}@i_110]) && {394}({373}({369}x2_82 = {372}x12[{371}@i_110]) && {393}({379}({375}X_s = {378}x13[{377}@i_110]) && {392}({385}({381}Y = {384}x14[{383}@i_110]) && {391}({387}K_s = {390}x15[{389}@i_110]))))) then
{361}    if {360}({356}auth_s = {359}r1_66[{358}@i_110]) then
{354}    let sk_s: hash0 = {353}h0({345}U, {346}S, {348}X_s, {350}Y, {352}K_s) in
{344}    event {343}termS({333}U, {335}X_s, {336}S, {338}Ystar, {340}auth_s, {342}sk_s)
) | (
{320}  ! !_43 <= NP
{319}  in(cp[{318}!_43], ());
{317}  new xp: exponent;
{316}  let Xp: G = {315}exp({312}g, {314}xp) in
{311}  new yp: exponent;
{310}  let Yp: G = {309}exp({306}g, {308}yp) in
{305}  let Kp: G = {304}exp({298}g, {303}mult({300}xp, {302}yp)) in
{297}  let Ystarp: G = {296}enc({294}Yp, {295}pw) in
{292}  let x1_77: host = {291}U in
{290}  let x2_76: host = {289}S in
{288}  let x3_75: G = {287}cst_G in
{286}  let x4_74: G = {285}cst_G in
{284}  let x5_73: G = {283}cst_G in
{282}  new r1_72: hash1;
{281}  let sk_p: hash0 = {280}h0({272}U, {273}S, {275}Xp, {277}Yp, {279}Kp) in
{271}  out(cp[{270}!_43], {269}({261}U, {263}Xp, {264}S, {266}Ystarp, {268}r1_72))
) | (
{248}  ! !_44 <= qE
{247}  in(@2_c1[{246}!_44], (@2_x: G, @2_ke: passwd));
{245}  out(@2_c2[{244}!_44], {243}enc({240}@2_x, {242}@2_ke))
) | (
{237}  ! !_45 <= qD
{236}  in(@2_c3[{235}!_45], (@2_m: G, @2_kd: passwd));
{234}  out(@2_c4[{233}!_45], {232}dec({229}@2_m, {231}@2_kd))
) | (
{226}  ! !_46 <= qH0
{225}  in(c10[{224}!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
{223}  out(c20[{222}!_46], {221}h0({212}x1, {214}x2, {216}x3, {218}x4, {220}x5))
) | (
{209}  ! !_47 <= qH1
{208}  in(c11[{207}!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
{206}  let x1_71: host = {205}cst_host in
{204}  let x2_70: host = {203}cst_host in
{202}  let x3_69: G = {201}cst_G in
{200}  let x4_68: G = {199}cst_G in
{198}  let x5_67: G = {197}cst_G in
{196}  find [unique] @i_100 <= qH1 suchthat defined(x11[{55}@i_100], x12[{57}@i_100], x13[{59}@i_100], x14[{61}@i_100], x15[{63}@i_100], x5_67[{65}@i_100], x4_68[{67}@i_100], x3_69[{69}@i_100], x2_70[{71}@i_100], x1_71[{73}@i_100], r1_66[{75}@i_100]) && otheruses(r1_66[{53}@i_100]) && {51}({23}({19}x11 = {22}x11[{21}@i_100]) && {50}({29}({25}x12 = {28}x12[{27}@i_100]) && {49}({35}({31}x13 = {34}x13[{33}@i_100]) && {48}({41}({37}x14 = {40}x14[{39}@i_100]) && {47}({43}x15 = {46}x15[{45}@i_100]))))) then
{17}    out(c21[{16}!_47], {15}r1_66[{14}@i_100])
  orfind @i_99 <= NP suchthat defined(Xp[{119}@i_99], Yp[{121}@i_99], Kp[{123}@i_99], x5_73[{125}@i_99], x4_74[{127}@i_99], x3_75[{129}@i_99], x1_77[{131}@i_99], x2_76[{133}@i_99], r1_72[{135}@i_99]) && otheruses(r1_72[{117}@i_99]) && {115}({87}({83}x11 = {86}x1_77[{85}@i_99]) && {114}({93}({89}x12 = {92}x2_76[{91}@i_99]) && {113}({99}({95}x13 = {98}Xp[{97}@i_99]) && {112}({105}({101}x14 = {104}Yp[{103}@i_99]) && {111}({107}x15 = {110}Kp[{109}@i_99]))))) then
{81}    out(c21[{80}!_47], {79}r1_72[{78}@i_99])
  orfind @i_96 <= NU suchthat defined(X[{179}@i_96], Y_u[{181}@i_96], K_u[{183}@i_96], x5_91[{185}@i_96], x4_92[{187}@i_96], x3_93[{189}@i_96], x1_95[{191}@i_96], x2_94[{193}@i_96], r1_90[{195}@i_96]) && otheruses(r1_90[{177}@i_96]) && {175}({147}({143}x11 = {146}x1_95[{145}@i_96]) && {174}({153}({149}x12 = {152}x2_94[{151}@i_96]) && {173}({159}({155}x13 = {158}X[{157}@i_96]) && {172}({165}({161}x14 = {164}Y_u[{163}@i_96]) && {171}({167}x15 = {170}K_u[{169}@i_96]))))) then
{141}    out(c21[{140}!_47], {139}r1_90[{138}@i_96])
  else
{11}    new r1_66: hash1;
{10}    out(c21[{9}!_47], {8}r1_66)
)

Doing replace term at occurrence 381 with Y'... Done.
{816}in(start, ());
{815}new pw: passwd;
{814}out(c8, {813}());
{812}(
{807}  ! !_41 <= NU
{806}  in(c1[{805}!_41], ());
{804}  new x: exponent;
{803}  let X: G = {802}exp({799}g, {801}x) in
{798}  out(c2[{797}!_41], {796}({793}U, {795}X));
{792}  in(c5[{791}!_41], (={790}S, Ystar_u: G));
{789}  let Y_u: G = {788}dec({786}Ystar_u, {787}pw) in
{784}  let K_u: G = {783}exp({780}Y_u, {782}x) in
{778}  let x1_95: host = {777}U in
{776}  let x2_94: host = {775}S in
{774}  let x3_93: G = {773}cst_G in
{772}  let x4_92: G = {771}cst_G in
{770}  let x5_91: G = {769}cst_G in
{768}  find [unique] @i_120 <= qH1 suchthat defined(x11[{747}@i_120], x12[{749}@i_120], x13[{751}@i_120], x14[{753}@i_120], x15[{755}@i_120], x5_67[{757}@i_120], x4_68[{759}@i_120], x3_69[{761}@i_120], x2_70[{763}@i_120], x1_71[{765}@i_120], r1_66[{767}@i_120]) && otheruses(r1_66[{745}@i_120]) && {743}({715}({711}x1_95 = {714}x11[{713}@i_120]) && {742}({721}({717}x2_94 = {720}x12[{719}@i_120]) && {741}({727}({723}X = {726}x13[{725}@i_120]) && {740}({733}({729}Y_u = {732}x14[{731}@i_120]) && {739}({735}K_u = {738}x15[{737}@i_120]))))) then
  (
{709}    let sk_u: hash0 = {708}h0({700}U, {701}S, {703}X, {705}Y_u, {707}K_u) in
{699}    event {698}termU({687}U, {689}X, {690}S, {692}Ystar_u, {695}r1_66[{694}@i_120], {697}sk_u);
{684}    out(c6[{683}!_41], {682}r1_66[{681}@i_120])
  )
  else
{677}    new r1_90: hash1;
{676}    let sk_u: hash0 = {675}h0({667}U, {668}S, {670}X, {672}Y_u, {674}K_u) in
{666}    event {665}termU({655}U, {657}X, {658}S, {660}Ystar_u, {662}r1_90, {664}sk_u);
{652}    out(c6[{651}!_41], {650}r1_90)
) | (
{638}  ! !_42 <= NS
{637}  in(c3[{636}!_42], (={635}U, X_s: G));
{634}  new y: exponent;
{633}  let Y: G = {632}exp({629}g, {631}y) in
{628}  let Ystar: G = {627}enc({625}Y, {626}pw) in
{623}  out(c4[{622}!_42], {621}({618}S, {620}Ystar));
{617}  in(c7[{616}!_42], auth_s: hash1);
{615}  find j <= NU suchthat defined(X[{612}j], x[{614}j]) && {610}({607}X[{606}j] = {609}X_s) then
  (
{604}    let K_s: G = {603}exp({596}g, {602}mult({599}x[{598}j], {601}y)) in
{595}    let x1_89: host = {594}U in
{593}    let x2_88: host = {592}S in
{591}    find [unique] @i_115 <= qH1 suchthat defined(x11[{511}@i_115], x12[{513}@i_115], x13[{515}@i_115], x14[{517}@i_115], x15[{519}@i_115], x5_67[{521}@i_115], x4_68[{523}@i_115], x3_69[{525}@i_115], x2_70[{527}@i_115], x1_71[{529}@i_115], r1_66[{531}@i_115]) && otheruses(r1_66[{509}@i_115]) && {507}({479}({475}x1_89 = {478}x11[{477}@i_115]) && {506}({485}({481}x2_88 = {484}x12[{483}@i_115]) && {505}({491}({487}X_s = {490}x13[{489}@i_115]) && {504}({497}({493}Y = {496}x14[{495}@i_115]) && {503}({499}K_s = {502}x15[{501}@i_115]))))) then
    (
{473}      if {472}({468}auth_s = {471}r1_66[{470}@i_115]) then
{466}      let sk_s: hash0 = {465}h0({457}U, {458}S, {460}X_s, {462}Y, {464}K_s) in
{456}      event {455}termS({445}U, {447}X_s, {448}S, {450}Ystar, {452}auth_s, {454}sk_s)
    )
    orfind  suchthat defined(Y_u[{582}j], K_u[{584}j], x5_91[{586}j], x4_92[{588}j], r1_90[{590}j]) && otheruses(r1_90[{580}j]) && {578}({571}({567}Y = {570}Y_u[{569}j]) && {577}({573}K_s = {576}K_u[{575}j])) then
    (
{565}      if {564}({560}auth_s = {563}r1_90[{562}j]) then
{558}      let sk_s: hash0 = {557}h0({549}U, {550}S, {552}X_s, {554}Y, {556}K_s) in
{548}      event {547}termS({537}U, {539}X_s, {540}S, {542}Ystar, {544}auth_s, {546}sk_s)
    )
  )
  else
{435}    let Y': G = {434}dec({432}Ystar, {433}pw) in
{430}    let K_s: G = {429}exp({426}X_s, {428}y) in
{424}    let x1_83: host = {423}U in
{422}    let x2_82: host = {421}S in
{420}    find [unique] @i_110 <= qH1 suchthat defined(x11[{399}@i_110], x12[{401}@i_110], x13[{403}@i_110], x14[{405}@i_110], x15[{407}@i_110], x5_67[{409}@i_110], x4_68[{411}@i_110], x3_69[{413}@i_110], x2_70[{415}@i_110], x1_71[{417}@i_110], r1_66[{419}@i_110]) && otheruses(r1_66[{397}@i_110]) && {395}({367}({363}x1_83 = {366}x11[{365}@i_110]) && {394}({373}({369}x2_82 = {372}x12[{371}@i_110]) && {393}({379}({375}X_s = {378}x13[{377}@i_110]) && {392}({385}({381}Y' = {384}x14[{383}@i_110]) && {391}({387}K_s = {390}x15[{389}@i_110]))))) then
{361}    if {360}({356}auth_s = {359}r1_66[{358}@i_110]) then
{354}    let sk_s: hash0 = {353}h0({345}U, {346}S, {348}X_s, {350}Y, {352}K_s) in
{344}    event {343}termS({333}U, {335}X_s, {336}S, {338}Ystar, {340}auth_s, {342}sk_s)
) | (
{320}  ! !_43 <= NP
{319}  in(cp[{318}!_43], ());
{317}  new xp: exponent;
{316}  let Xp: G = {315}exp({312}g, {314}xp) in
{311}  new yp: exponent;
{310}  let Yp: G = {309}exp({306}g, {308}yp) in
{305}  let Kp: G = {304}exp({298}g, {303}mult({300}xp, {302}yp)) in
{297}  let Ystarp: G = {296}enc({294}Yp, {295}pw) in
{292}  let x1_77: host = {291}U in
{290}  let x2_76: host = {289}S in
{288}  let x3_75: G = {287}cst_G in
{286}  let x4_74: G = {285}cst_G in
{284}  let x5_73: G = {283}cst_G in
{282}  new r1_72: hash1;
{281}  let sk_p: hash0 = {280}h0({272}U, {273}S, {275}Xp, {277}Yp, {279}Kp) in
{271}  out(cp[{270}!_43], {269}({261}U, {263}Xp, {264}S, {266}Ystarp, {268}r1_72))
) | (
{248}  ! !_44 <= qE
{247}  in(@2_c1[{246}!_44], (@2_x: G, @2_ke: passwd));
{245}  out(@2_c2[{244}!_44], {243}enc({240}@2_x, {242}@2_ke))
) | (
{237}  ! !_45 <= qD
{236}  in(@2_c3[{235}!_45], (@2_m: G, @2_kd: passwd));
{234}  out(@2_c4[{233}!_45], {232}dec({229}@2_m, {231}@2_kd))
) | (
{226}  ! !_46 <= qH0
{225}  in(c10[{224}!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
{223}  out(c20[{222}!_46], {221}h0({212}x1, {214}x2, {216}x3, {218}x4, {220}x5))
) | (
{209}  ! !_47 <= qH1
{208}  in(c11[{207}!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
{206}  let x1_71: host = {205}cst_host in
{204}  let x2_70: host = {203}cst_host in
{202}  let x3_69: G = {201}cst_G in
{200}  let x4_68: G = {199}cst_G in
{198}  let x5_67: G = {197}cst_G in
{196}  find [unique] @i_100 <= qH1 suchthat defined(x11[{55}@i_100], x12[{57}@i_100], x13[{59}@i_100], x14[{61}@i_100], x15[{63}@i_100], x5_67[{65}@i_100], x4_68[{67}@i_100], x3_69[{69}@i_100], x2_70[{71}@i_100], x1_71[{73}@i_100], r1_66[{75}@i_100]) && otheruses(r1_66[{53}@i_100]) && {51}({23}({19}x11 = {22}x11[{21}@i_100]) && {50}({29}({25}x12 = {28}x12[{27}@i_100]) && {49}({35}({31}x13 = {34}x13[{33}@i_100]) && {48}({41}({37}x14 = {40}x14[{39}@i_100]) && {47}({43}x15 = {46}x15[{45}@i_100]))))) then
{17}    out(c21[{16}!_47], {15}r1_66[{14}@i_100])
  orfind @i_99 <= NP suchthat defined(Xp[{119}@i_99], Yp[{121}@i_99], Kp[{123}@i_99], x5_73[{125}@i_99], x4_74[{127}@i_99], x3_75[{129}@i_99], x1_77[{131}@i_99], x2_76[{133}@i_99], r1_72[{135}@i_99]) && otheruses(r1_72[{117}@i_99]) && {115}({87}({83}x11 = {86}x1_77[{85}@i_99]) && {114}({93}({89}x12 = {92}x2_76[{91}@i_99]) && {113}({99}({95}x13 = {98}Xp[{97}@i_99]) && {112}({105}({101}x14 = {104}Yp[{103}@i_99]) && {111}({107}x15 = {110}Kp[{109}@i_99]))))) then
{81}    out(c21[{80}!_47], {79}r1_72[{78}@i_99])
  orfind @i_96 <= NU suchthat defined(X[{179}@i_96], Y_u[{181}@i_96], K_u[{183}@i_96], x5_91[{185}@i_96], x4_92[{187}@i_96], x3_93[{189}@i_96], x1_95[{191}@i_96], x2_94[{193}@i_96], r1_90[{195}@i_96]) && otheruses(r1_90[{177}@i_96]) && {175}({147}({143}x11 = {146}x1_95[{145}@i_96]) && {174}({153}({149}x12 = {152}x2_94[{151}@i_96]) && {173}({159}({155}x13 = {158}X[{157}@i_96]) && {172}({165}({161}x14 = {164}Y_u[{163}@i_96]) && {171}({167}x15 = {170}K_u[{169}@i_96]))))) then
{141}    out(c21[{140}!_47], {139}r1_90[{138}@i_96])
  else
{11}    new r1_66: hash1;
{10}    out(c21[{9}!_47], {8}r1_66)
)

Doing insert instruction find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && (U = x11[nj]) && (S = x12[nj]) && (X_s = x13[nj]) && (Y' = x14[nj]) && (auth_s = r1_66[nj]) then at occurrence 430... Done.
{966}in(start, ());
{965}new pw: passwd;
{964}out(c8, {963}());
{962}(
{957}  ! !_41 <= NU
{956}  in(c1[{955}!_41], ());
{954}  new x: exponent;
{953}  let X: G = {952}exp({949}g, {951}x) in
{948}  out(c2[{947}!_41], {946}({943}U, {945}X));
{942}  in(c5[{941}!_41], (={940}S, Ystar_u: G));
{939}  let Y_u: G = {938}dec({936}Ystar_u, {937}pw) in
{934}  let K_u: G = {933}exp({930}Y_u, {932}x) in
{928}  let x1_95: host = {927}U in
{926}  let x2_94: host = {925}S in
{924}  let x3_93: G = {923}cst_G in
{922}  let x4_92: G = {921}cst_G in
{920}  let x5_91: G = {919}cst_G in
{918}  find [unique] @i_120 <= qH1 suchthat defined(x11[{897}@i_120], x12[{899}@i_120], x13[{901}@i_120], x14[{903}@i_120], x15[{905}@i_120], x5_67[{907}@i_120], x4_68[{909}@i_120], x3_69[{911}@i_120], x2_70[{913}@i_120], x1_71[{915}@i_120], r1_66[{917}@i_120]) && otheruses(r1_66[{895}@i_120]) && {893}({865}({861}x1_95 = {864}x11[{863}@i_120]) && {892}({871}({867}x2_94 = {870}x12[{869}@i_120]) && {891}({877}({873}X = {876}x13[{875}@i_120]) && {890}({883}({879}Y_u = {882}x14[{881}@i_120]) && {889}({885}K_u = {888}x15[{887}@i_120]))))) then
  (
{859}    let sk_u: hash0 = {858}h0({850}U, {851}S, {853}X, {855}Y_u, {857}K_u) in
{849}    event {848}termU({837}U, {839}X, {840}S, {842}Ystar_u, {845}r1_66[{844}@i_120], {847}sk_u);
{834}    out(c6[{833}!_41], {832}r1_66[{831}@i_120])
  )
  else
{827}    new r1_90: hash1;
{826}    let sk_u: hash0 = {825}h0({817}U, {818}S, {820}X, {822}Y_u, {824}K_u) in
{816}    event {815}termU({805}U, {807}X, {808}S, {810}Ystar_u, {812}r1_90, {814}sk_u);
{802}    out(c6[{801}!_41], {800}r1_90)
) | (
{788}  ! !_42 <= NS
{787}  in(c3[{786}!_42], (={785}U, X_s: G));
{784}  new y: exponent;
{783}  let Y: G = {782}exp({779}g, {781}y) in
{778}  let Ystar: G = {777}enc({775}Y, {776}pw) in
{773}  out(c4[{772}!_42], {771}({768}S, {770}Ystar));
{767}  in(c7[{766}!_42], auth_s: hash1);
{765}  find j <= NU suchthat defined(X[{762}j], x[{764}j]) && {760}({757}X[{756}j] = {759}X_s) then
  (
{754}    let K_s: G = {753}exp({746}g, {752}mult({749}x[{748}j], {751}y)) in
{745}    let x1_89: host = {744}U in
{743}    let x2_88: host = {742}S in
{741}    find [unique] @i_115 <= qH1 suchthat defined(x11[{661}@i_115], x12[{663}@i_115], x13[{665}@i_115], x14[{667}@i_115], x15[{669}@i_115], x5_67[{671}@i_115], x4_68[{673}@i_115], x3_69[{675}@i_115], x2_70[{677}@i_115], x1_71[{679}@i_115], r1_66[{681}@i_115]) && otheruses(r1_66[{659}@i_115]) && {657}({629}({625}x1_89 = {628}x11[{627}@i_115]) && {656}({635}({631}x2_88 = {634}x12[{633}@i_115]) && {655}({641}({637}X_s = {640}x13[{639}@i_115]) && {654}({647}({643}Y = {646}x14[{645}@i_115]) && {653}({649}K_s = {652}x15[{651}@i_115]))))) then
    (
{623}      if {622}({618}auth_s = {621}r1_66[{620}@i_115]) then
{616}      let sk_s: hash0 = {615}h0({607}U, {608}S, {610}X_s, {612}Y, {614}K_s) in
{606}      event {605}termS({595}U, {597}X_s, {598}S, {600}Ystar, {602}auth_s, {604}sk_s)
    )
    orfind  suchthat defined(Y_u[{732}j], K_u[{734}j], x5_91[{736}j], x4_92[{738}j], r1_90[{740}j]) && otheruses(r1_90[{730}j]) && {728}({721}({717}Y = {720}Y_u[{719}j]) && {727}({723}K_s = {726}K_u[{725}j])) then
    (
{715}      if {714}({710}auth_s = {713}r1_90[{712}j]) then
{708}      let sk_s: hash0 = {707}h0({699}U, {700}S, {702}X_s, {704}Y, {706}K_s) in
{698}      event {697}termS({687}U, {689}X_s, {690}S, {692}Ystar, {694}auth_s, {696}sk_s)
    )
  )
  else
{585}    let Y': G = {584}dec({582}Ystar, {583}pw) in
{580}    find nj <= qH1 suchthat defined(x11[{571}nj], x12[{573}nj], x13[{575}nj], x14[{577}nj], r1_66[{579}nj]) && {569}({542}({538}U = {541}x11[{540}nj]) && {568}({547}({543}S = {546}x12[{545}nj]) && {567}({553}({549}X_s = {552}x13[{551}nj]) && {566}({559}({555}Y' = {558}x14[{557}nj]) && {565}({561}auth_s = {564}r1_66[{563}nj]))))) then
    (
{537}      let K_s: G = {536}exp({533}X_s, {535}y) in
{531}      let x1_83: host = {530}U in
{529}      let x2_82: host = {528}S in
{527}      find [unique] @i_110 <= qH1 suchthat defined(x11[{506}@i_110], x12[{508}@i_110], x13[{510}@i_110], x14[{512}@i_110], x15[{514}@i_110], x5_67[{516}@i_110], x4_68[{518}@i_110], x3_69[{520}@i_110], x2_70[{522}@i_110], x1_71[{524}@i_110], r1_66[{526}@i_110]) && otheruses(r1_66[{504}@i_110]) && {502}({474}({470}x1_83 = {473}x11[{472}@i_110]) && {501}({480}({476}x2_82 = {479}x12[{478}@i_110]) && {500}({486}({482}X_s = {485}x13[{484}@i_110]) && {499}({492}({488}Y' = {491}x14[{490}@i_110]) && {498}({494}K_s = {497}x15[{496}@i_110]))))) then
{468}      if {467}({463}auth_s = {466}r1_66[{465}@i_110]) then
{461}      let sk_s: hash0 = {460}h0({452}U, {453}S, {455}X_s, {457}Y, {459}K_s) in
{451}      event {450}termS({440}U, {442}X_s, {443}S, {445}Ystar, {447}auth_s, {449}sk_s)
    )
    else
{430}      let K_s: G = {429}exp({426}X_s, {428}y) in
{424}      let x1_83: host = {423}U in
{422}      let x2_82: host = {421}S in
{420}      find [unique] @i_110 <= qH1 suchthat defined(x11[{399}@i_110], x12[{401}@i_110], x13[{403}@i_110], x14[{405}@i_110], x15[{407}@i_110], x5_67[{409}@i_110], x4_68[{411}@i_110], x3_69[{413}@i_110], x2_70[{415}@i_110], x1_71[{417}@i_110], r1_66[{419}@i_110]) && otheruses(r1_66[{397}@i_110]) && {395}({367}({363}x1_83 = {366}x11[{365}@i_110]) && {394}({373}({369}x2_82 = {372}x12[{371}@i_110]) && {393}({379}({375}X_s = {378}x13[{377}@i_110]) && {392}({385}({381}Y' = {384}x14[{383}@i_110]) && {391}({387}K_s = {390}x15[{389}@i_110]))))) then
{361}      if {360}({356}auth_s = {359}r1_66[{358}@i_110]) then
{354}      let sk_s: hash0 = {353}h0({345}U, {346}S, {348}X_s, {350}Y, {352}K_s) in
{344}      event {343}termS({333}U, {335}X_s, {336}S, {338}Ystar, {340}auth_s, {342}sk_s)
) | (
{320}  ! !_43 <= NP
{319}  in(cp[{318}!_43], ());
{317}  new xp: exponent;
{316}  let Xp: G = {315}exp({312}g, {314}xp) in
{311}  new yp: exponent;
{310}  let Yp: G = {309}exp({306}g, {308}yp) in
{305}  let Kp: G = {304}exp({298}g, {303}mult({300}xp, {302}yp)) in
{297}  let Ystarp: G = {296}enc({294}Yp, {295}pw) in
{292}  let x1_77: host = {291}U in
{290}  let x2_76: host = {289}S in
{288}  let x3_75: G = {287}cst_G in
{286}  let x4_74: G = {285}cst_G in
{284}  let x5_73: G = {283}cst_G in
{282}  new r1_72: hash1;
{281}  let sk_p: hash0 = {280}h0({272}U, {273}S, {275}Xp, {277}Yp, {279}Kp) in
{271}  out(cp[{270}!_43], {269}({261}U, {263}Xp, {264}S, {266}Ystarp, {268}r1_72))
) | (
{248}  ! !_44 <= qE
{247}  in(@2_c1[{246}!_44], (@2_x: G, @2_ke: passwd));
{245}  out(@2_c2[{244}!_44], {243}enc({240}@2_x, {242}@2_ke))
) | (
{237}  ! !_45 <= qD
{236}  in(@2_c3[{235}!_45], (@2_m: G, @2_kd: passwd));
{234}  out(@2_c4[{233}!_45], {232}dec({229}@2_m, {231}@2_kd))
) | (
{226}  ! !_46 <= qH0
{225}  in(c10[{224}!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
{223}  out(c20[{222}!_46], {221}h0({212}x1, {214}x2, {216}x3, {218}x4, {220}x5))
) | (
{209}  ! !_47 <= qH1
{208}  in(c11[{207}!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
{206}  let x1_71: host = {205}cst_host in
{204}  let x2_70: host = {203}cst_host in
{202}  let x3_69: G = {201}cst_G in
{200}  let x4_68: G = {199}cst_G in
{198}  let x5_67: G = {197}cst_G in
{196}  find [unique] @i_100 <= qH1 suchthat defined(x11[{55}@i_100], x12[{57}@i_100], x13[{59}@i_100], x14[{61}@i_100], x15[{63}@i_100], x5_67[{65}@i_100], x4_68[{67}@i_100], x3_69[{69}@i_100], x2_70[{71}@i_100], x1_71[{73}@i_100], r1_66[{75}@i_100]) && otheruses(r1_66[{53}@i_100]) && {51}({23}({19}x11 = {22}x11[{21}@i_100]) && {50}({29}({25}x12 = {28}x12[{27}@i_100]) && {49}({35}({31}x13 = {34}x13[{33}@i_100]) && {48}({41}({37}x14 = {40}x14[{39}@i_100]) && {47}({43}x15 = {46}x15[{45}@i_100]))))) then
{17}    out(c21[{16}!_47], {15}r1_66[{14}@i_100])
  orfind @i_99 <= NP suchthat defined(Xp[{119}@i_99], Yp[{121}@i_99], Kp[{123}@i_99], x5_73[{125}@i_99], x4_74[{127}@i_99], x3_75[{129}@i_99], x1_77[{131}@i_99], x2_76[{133}@i_99], r1_72[{135}@i_99]) && otheruses(r1_72[{117}@i_99]) && {115}({87}({83}x11 = {86}x1_77[{85}@i_99]) && {114}({93}({89}x12 = {92}x2_76[{91}@i_99]) && {113}({99}({95}x13 = {98}Xp[{97}@i_99]) && {112}({105}({101}x14 = {104}Yp[{103}@i_99]) && {111}({107}x15 = {110}Kp[{109}@i_99]))))) then
{81}    out(c21[{80}!_47], {79}r1_72[{78}@i_99])
  orfind @i_96 <= NU suchthat defined(X[{179}@i_96], Y_u[{181}@i_96], K_u[{183}@i_96], x5_91[{185}@i_96], x4_92[{187}@i_96], x3_93[{189}@i_96], x1_95[{191}@i_96], x2_94[{193}@i_96], r1_90[{195}@i_96]) && otheruses(r1_90[{177}@i_96]) && {175}({147}({143}x11 = {146}x1_95[{145}@i_96]) && {174}({153}({149}x12 = {152}x2_94[{151}@i_96]) && {173}({159}({155}x13 = {158}X[{157}@i_96]) && {172}({165}({161}x14 = {164}Y_u[{163}@i_96]) && {171}({167}x15 = {170}K_u[{169}@i_96]))))) then
{141}    out(c21[{140}!_47], {139}r1_90[{138}@i_96])
  else
{11}    new r1_66: hash1;
{10}    out(c21[{9}!_47], {8}r1_66)
)

Doing insert event Auth at occurrence 537... Done.
Trying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_63: G, @2_ke_62: passwd) := let @2_x: G = @2_x_63 in let @2_ke: passwd = @2_ke_62 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && otheruses(@2_x[@2_j_33] -> @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && otheruses(@2_m[@2_k_34] -> @2_r4[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_65: G, @2_kd_64: passwd) := let @2_m: G = @2_m_65 in let @2_kd: passwd = @2_kd_64 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && otheruses(@2_x[@2_j_35] -> @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && otheruses(@2_m[@2_k_36] -> @2_r4[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
... Succeeded.
Doing simplify... Run simplify 3 time(s). Maximum reached.
Eliminated collisions between @2_r2_169 and @2_r2_160 Probability: NS * qE / |G|
Eliminated collisions between @2_r2_169 and @2_r2_163 Probability: NS * NP / |G|
Eliminated collisions between @2_r2_169 and @2_r2_169 Probability: 0.5 * NS * NS / |G|
Eliminated collisions between @2_r4_172[!_41] and x14[!2_1507] Probability: qH1 * NU / |G|
(@2_r4_172[!_41] characterizes a part of @2_r4_172[!_41] of type(s) G;
 x14[!2_1507] does not depend on @2_r4_172[!_41])
Eliminated collisions between exp(g, y[!_42]) and @2_r4_157[!2_1160] Probability: qD * NS / |exponent|
(exp(g, y[!_42]) characterizes a part of y[!_42] of type(s) exponent;
 @2_r4_157[!2_1160] does not depend on y[!_42])
Eliminated collisions between exp(g, y[!_42]) and @2_r4_166[!2_1159] Probability: NS * NS / |exponent|
(exp(g, y[!_42]) characterizes a part of y[!_42] of type(s) exponent;
 @2_r4_166[!2_1159] does not depend on y[!_42])
Eliminated collisions between exp(g, y[!_42]) and @2_r4_172[!2_1158] Probability: NU * NS / |exponent|
(exp(g, y[!_42]) characterizes a part of y[!_42] of type(s) exponent;
 @2_r4_172[!2_1158] does not depend on y[!_42])
Eliminated collisions between exp(g, y[!_42]) and @2_x_162[!2_1157] Probability: qE * NS / |exponent|
(exp(g, y[!_42]) characterizes a part of y[!_42] of type(s) exponent;
 @2_x_162[!2_1157] does not depend on y[!_42])
Eliminated collisions between exp(g, y[!_42]) and @2_x_165[!2_1156] Probability: NP * NS / |exponent|
(exp(g, y[!_42]) characterizes a part of y[!_42] of type(s) exponent;
 @2_x_165[!2_1156] does not depend on y[!_42])
Eliminated collisions between exp(g, yp[!_43]) and @2_r4_157[!2_1153] Probability: qD * NP / |exponent|
(exp(g, yp[!_43]) characterizes a part of yp[!_43] of type(s) exponent;
 @2_r4_157[!2_1153] does not depend on yp[!_43])
Eliminated collisions between exp(g, yp[!_43]) and @2_r4_166[!2_1152] Probability: NS * NP / |exponent|
(exp(g, yp[!_43]) characterizes a part of yp[!_43] of type(s) exponent;
 @2_r4_166[!2_1152] does not depend on yp[!_43])
Eliminated collisions between exp(g, yp[!_43]) and @2_r4_172[!2_1151] Probability: NU * NP / |exponent|
(exp(g, yp[!_43]) characterizes a part of yp[!_43] of type(s) exponent;
 @2_r4_172[!2_1151] does not depend on yp[!_43])
Eliminated collisions between exp(g, yp[!_43]) and @2_x_162[!2_1150] Probability: qE * NP / |exponent|
(exp(g, yp[!_43]) characterizes a part of yp[!_43] of type(s) exponent;
 @2_x_162[!2_1150] does not depend on yp[!_43])
Eliminated collisions between exp(g, yp[!_43]) and @2_x_171[!2_1148] Probability: NS * NP / |exponent|
(exp(g, yp[!_43]) characterizes a part of yp[!_43] of type(s) exponent;
 @2_x_171[!2_1148] does not depend on yp[!_43])
Done.
Doing move all binders... Done.
Doing remove assignments of useless... Done.
{1838}in(start, ());
{1837}new pw: passwd;
{1836}out(c8, {1835}());
{1834}(
{1829}  ! !_41 <= NU
{1828}  in(c1[{1827}!_41], ());
{1826}  new x: exponent;
{1825}  let X: G = {1824}exp({1821}g, {1823}x) in
{1820}  out(c2[{1819}!_41], {1818}({1815}U, {1817}X));
{1814}  in(c5[{1813}!_41], (={1812}S, Ystar_u: G));
{1811}  let @2_m_174: G = {1810}cst_G in
{1809}  let @2_kd_173: passwd = {1808}cst_passwd in
{1807}  find [unique] @i_246 <= qD suchthat defined(@2_m[{1180}@i_246], @2_kd[{1182}@i_246], @2_kd_158[{1184}@i_246], @2_m_159[{1186}@i_246], @2_r4_157[{1188}@i_246]) && otheruses(@2_m[{1178}@i_246] -> @2_r4_157[{1176}@i_246]) && {1174}({1168}({1164}Ystar_u = {1167}@2_m[{1166}@i_246]) && {1173}({1169}pw = {1172}@2_kd[{1171}@i_246])) then
  (
{1162}    let Y_u: G = {1161}@2_r4_157[{1160}@i_246] in
{1158}    let K_u: G = {1157}exp({1154}@2_r4_157[{1153}@i_246], {1156}x) in
{1151}    let x1_95: host = {1150}U in
{1149}    let x2_94: host = {1148}S in
{1147}    find [unique] @i_120 <= qH1 suchthat defined(x11[{1136}@i_120], x12[{1138}@i_120], x13[{1140}@i_120], x14[{1142}@i_120], x15[{1144}@i_120], r1_66[{1146}@i_120]) && otheruses(r1_66[{1134}@i_120]) && {1132}({1103}({1099}x1_95 = {1102}x11[{1101}@i_120]) && {1131}({1109}({1105}x2_94 = {1108}x12[{1107}@i_120]) && {1130}({1115}({1111}X = {1114}x13[{1113}@i_120]) && {1129}({1122}({1118}@2_r4_157[{1117}@i_246] = {1121}x14[{1120}@i_120]) && {1128}({1124}K_u = {1127}x15[{1126}@i_120]))))) then
    (
{1097}      let sk_u: hash0 = {1096}h0({1087}U, {1088}S, {1090}X, {1093}@2_r4_157[{1092}@i_246], {1095}K_u) in
{1086}      event {1085}termU({1074}U, {1076}X, {1077}S, {1079}Ystar_u, {1082}r1_66[{1081}@i_120], {1084}sk_u);
{1071}      out(c6[{1070}!_41], {1069}r1_66[{1068}@i_120])
    )
    else
{1064}      new r1_90: hash1;
{1063}      let sk_u: hash0 = {1062}h0({1053}U, {1054}S, {1056}X, {1059}@2_r4_157[{1058}@i_246], {1061}K_u) in
{1052}      event {1051}termU({1041}U, {1043}X, {1044}S, {1046}Ystar_u, {1048}r1_90, {1050}sk_u);
{1038}      out(c6[{1037}!_41], {1036}r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[{1334}@i_241], @2_m_174[{1336}@i_241], @2_r4_172[{1338}@i_241]) && otheruses(Ystar_u[{1332}@i_241] -> @2_r4_172[{1330}@i_241]) && {1328}({1324}Ystar_u = {1327}Ystar_u[{1326}@i_241]) then
  (
{1322}    let Y_u: G = {1321}@2_r4_172[{1320}@i_241] in
{1318}    let K_u: G = {1317}exp({1314}@2_r4_172[{1313}@i_241], {1316}x) in
{1311}    let x1_95: host = {1310}U in
{1309}    let x2_94: host = {1308}S in
{1307}    find [unique] @i_120 <= qH1 suchthat defined(x11[{1296}@i_120], x12[{1298}@i_120], x13[{1300}@i_120], x14[{1302}@i_120], x15[{1304}@i_120], r1_66[{1306}@i_120]) && otheruses(r1_66[{1294}@i_120]) && {1292}({1263}({1259}x1_95 = {1262}x11[{1261}@i_120]) && {1291}({1269}({1265}x2_94 = {1268}x12[{1267}@i_120]) && {1290}({1275}({1271}X = {1274}x13[{1273}@i_120]) && {1289}({1282}({1278}@2_r4_172[{1277}@i_241] = {1281}x14[{1280}@i_120]) && {1288}({1284}K_u = {1287}x15[{1286}@i_120]))))) then
    (
{1257}      let sk_u: hash0 = {1256}h0({1247}U, {1248}S, {1250}X, {1253}@2_r4_172[{1252}@i_241], {1255}K_u) in
{1246}      event {1245}termU({1234}U, {1236}X, {1237}S, {1239}Ystar_u, {1242}r1_66[{1241}@i_120], {1244}sk_u);
{1231}      out(c6[{1230}!_41], {1229}r1_66[{1228}@i_120])
    )
    else
{1224}      new r1_90: hash1;
{1223}      let sk_u: hash0 = {1222}h0({1213}U, {1214}S, {1216}X, {1219}@2_r4_172[{1218}@i_241], {1221}K_u) in
{1212}      event {1211}termU({1201}U, {1203}X, {1204}S, {1206}Ystar_u, {1208}r1_90, {1210}sk_u);
{1198}      out(c6[{1197}!_41], {1196}r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_ke[{1490}@i_239], @2_x[{1492}@i_239], @2_x_162[{1494}@i_239], @2_ke_161[{1496}@i_239], @2_r2_160[{1498}@i_239]) && otheruses(@2_x[{1488}@i_239] -> @2_r2_160[{1486}@i_239]) && {1484}({1478}({1474}Ystar_u = {1477}@2_r2_160[{1476}@i_239]) && {1483}({1479}pw = {1482}@2_ke[{1481}@i_239])) then
  (
{1472}    let Y_u: G = {1471}@2_x[{1470}@i_239] in
{1468}    let K_u: G = {1467}exp({1464}@2_x[{1463}@i_239], {1466}x) in
{1461}    let x1_95: host = {1460}U in
{1459}    let x2_94: host = {1458}S in
{1457}    find [unique] @i_120 <= qH1 suchthat defined(x11[{1446}@i_120], x12[{1448}@i_120], x13[{1450}@i_120], x14[{1452}@i_120], x15[{1454}@i_120], r1_66[{1456}@i_120]) && otheruses(r1_66[{1444}@i_120]) && {1442}({1413}({1409}x1_95 = {1412}x11[{1411}@i_120]) && {1441}({1419}({1415}x2_94 = {1418}x12[{1417}@i_120]) && {1440}({1425}({1421}X = {1424}x13[{1423}@i_120]) && {1439}({1432}({1428}@2_x[{1427}@i_239] = {1431}x14[{1430}@i_120]) && {1438}({1434}K_u = {1437}x15[{1436}@i_120]))))) then
    (
{1407}      let sk_u: hash0 = {1406}h0({1397}U, {1398}S, {1400}X, {1403}@2_x[{1402}@i_239], {1405}K_u) in
{1396}      event {1395}termU({1384}U, {1386}X, {1387}S, {1389}Ystar_u, {1392}r1_66[{1391}@i_120], {1394}sk_u);
{1381}      out(c6[{1380}!_41], {1379}r1_66[{1378}@i_120])
    )
    else
{1374}      new r1_90: hash1;
{1373}      let sk_u: hash0 = {1372}h0({1363}U, {1364}S, {1366}X, {1369}@2_x[{1368}@i_239], {1371}K_u) in
{1362}      event {1361}termU({1351}U, {1353}X, {1354}S, {1356}Ystar_u, {1358}r1_90, {1360}sk_u);
{1348}      out(c6[{1347}!_41], {1346}r1_90)
  )
  orfind @i_238 <= NP suchthat defined(Yp[{1646}@i_238], @2_x_165[{1648}@i_238], @2_r2_163[{1650}@i_238], yp[{1652}@i_238]) && otheruses(Yp[{1644}@i_238] -> @2_r2_163[{1642}@i_238]) && {1640}({1636}Ystar_u = {1639}@2_r2_163[{1638}@i_238]) then
  (
{1634}    let Y_u: G = {1633}Yp[{1632}@i_238] in
{1630}    let K_u: G = {1629}exp({1622}g, {1628}mult({1625}yp[{1624}@i_238], {1627}x)) in
{1621}    let x1_95: host = {1620}U in
{1619}    let x2_94: host = {1618}S in
{1617}    find [unique] @i_120 <= qH1 suchthat defined(x11[{1606}@i_120], x12[{1608}@i_120], x13[{1610}@i_120], x14[{1612}@i_120], x15[{1614}@i_120], r1_66[{1616}@i_120]) && otheruses(r1_66[{1604}@i_120]) && {1602}({1573}({1569}x1_95 = {1572}x11[{1571}@i_120]) && {1601}({1579}({1575}x2_94 = {1578}x12[{1577}@i_120]) && {1600}({1585}({1581}X = {1584}x13[{1583}@i_120]) && {1599}({1592}({1588}Yp[{1587}@i_238] = {1591}x14[{1590}@i_120]) && {1598}({1594}K_u = {1597}x15[{1596}@i_120]))))) then
    (
{1567}      let sk_u: hash0 = {1566}h0({1557}U, {1558}S, {1560}X, {1563}Yp[{1562}@i_238], {1565}K_u) in
{1556}      event {1555}termU({1544}U, {1546}X, {1547}S, {1549}Ystar_u, {1552}r1_66[{1551}@i_120], {1554}sk_u);
{1541}      out(c6[{1540}!_41], {1539}r1_66[{1538}@i_120])
    )
    else
{1534}      new r1_90: hash1;
{1533}      let sk_u: hash0 = {1532}h0({1523}U, {1524}S, {1526}X, {1529}Yp[{1528}@i_238], {1531}K_u) in
{1522}      event {1521}termU({1511}U, {1513}X, {1514}S, {1516}Ystar_u, {1518}r1_90, {1520}sk_u);
{1508}      out(c6[{1507}!_41], {1506}r1_90)
  )
  orfind @i_236 <= NS suchthat defined(Y[{1800}@i_236], @2_x_171[{1802}@i_236], @2_r2_169[{1804}@i_236], y[{1806}@i_236]) && otheruses(Y[{1798}@i_236] -> @2_r2_169[{1796}@i_236]) && {1794}({1790}Ystar_u = {1793}@2_r2_169[{1792}@i_236]) then
  (
{1788}    let Y_u: G = {1787}Y[{1786}@i_236] in
{1784}    let K_u: G = {1783}exp({1776}g, {1782}mult({1779}y[{1778}@i_236], {1781}x)) in
{1775}    let x1_95: host = {1774}U in
{1773}    let x2_94: host = {1772}S in
{1771}    find [unique] @i_120 <= qH1 suchthat defined(x11[{1760}@i_120], x12[{1762}@i_120], x13[{1764}@i_120], x14[{1766}@i_120], x15[{1768}@i_120], r1_66[{1770}@i_120]) && otheruses(r1_66[{1758}@i_120]) && {1756}({1727}({1723}x1_95 = {1726}x11[{1725}@i_120]) && {1755}({1733}({1729}x2_94 = {1732}x12[{1731}@i_120]) && {1754}({1739}({1735}X = {1738}x13[{1737}@i_120]) && {1753}({1746}({1742}Y[{1741}@i_236] = {1745}x14[{1744}@i_120]) && {1752}({1748}K_u = {1751}x15[{1750}@i_120]))))) then
    (
{1721}      let sk_u: hash0 = {1720}h0({1711}U, {1712}S, {1714}X, {1717}Y[{1716}@i_236], {1719}K_u) in
{1710}      event {1709}termU({1698}U, {1700}X, {1701}S, {1703}Ystar_u, {1706}r1_66[{1705}@i_120], {1708}sk_u);
{1695}      out(c6[{1694}!_41], {1693}r1_66[{1692}@i_120])
    )
    else
{1688}      new r1_90: hash1;
{1687}      let sk_u: hash0 = {1686}h0({1677}U, {1678}S, {1680}X, {1683}Y[{1682}@i_236], {1685}K_u) in
{1676}      event {1675}termU({1665}U, {1667}X, {1668}S, {1670}Ystar_u, {1672}r1_90, {1674}sk_u);
{1662}      out(c6[{1661}!_41], {1660}r1_90)
  )
  else
{1028}    new @2_r4_172: G;
{1027}    let Y_u: G = {1026}@2_r4_172 in
{1024}    let K_u: G = {1023}exp({1020}@2_r4_172, {1022}x) in
{1018}    let x1_95: host = {1017}U in
{1016}    let x2_94: host = {1015}S in
{1014}    new r1_90: hash1;
{1013}    let sk_u: hash0 = {1012}h0({1004}U, {1005}S, {1007}X, {1009}@2_r4_172, {1011}K_u) in
{1003}    event {1002}termU({992}U, {994}X, {995}S, {997}Ystar_u, {999}r1_90, {1001}sk_u);
{989}    out(c6[{988}!_41], {987}r1_90)
) | (
{976}  ! !_42 <= NS
{975}  in(c3[{974}!_42], (={973}U, X_s: G));
{972}  new y: exponent;
{971}  let Y: G = {970}exp({967}g, {969}y) in
{966}  let @2_x_171: G = {965}cst_G in
{964}  let @2_ke_170: passwd = {963}cst_passwd in
{962}  new @2_r2_169: G;
{961}  out(c4[{960}!_42], {959}({956}S, {958}@2_r2_169));
{955}  in(c7[{954}!_42], auth_s: hash1);
{953}  find j <= NU suchthat defined(X[{950}j], x[{952}j]) && {948}({945}X[{944}j] = {947}X_s) then
  (
{942}    let K_s: G = {941}exp({934}g, {940}mult({937}x[{936}j], {939}y)) in
{933}    let x1_89: host = {932}U in
{931}    let x2_88: host = {930}S in
{929}    find [unique] @i_115 <= qH1 suchthat defined(x11[{863}@i_115], x12[{865}@i_115], x13[{867}@i_115], x14[{869}@i_115], x15[{871}@i_115], r1_66[{873}@i_115]) && otheruses(r1_66[{861}@i_115]) && {859}({831}({827}x1_89 = {830}x11[{829}@i_115]) && {858}({837}({833}x2_88 = {836}x12[{835}@i_115]) && {857}({843}({839}X_s = {842}x13[{841}@i_115]) && {856}({849}({845}Y = {848}x14[{847}@i_115]) && {855}({851}K_s = {854}x15[{853}@i_115]))))) then
    (
{825}      if {824}({820}auth_s = {823}r1_66[{822}@i_115]) then
{818}      let sk_s: hash0 = {817}h0({809}U, {810}S, {812}X_s, {814}Y, {816}K_s) in
{808}      event {807}termS({797}U, {799}X_s, {800}S, {802}@2_r2_169, {804}auth_s, {806}sk_s)
    )
    orfind  suchthat defined(Y_u[{924}j], K_u[{926}j], r1_90[{928}j]) && otheruses(r1_90[{922}j]) && {920}({913}({909}Y = {912}Y_u[{911}j]) && {919}({915}K_s = {918}K_u[{917}j])) then
    (
{907}      if {906}({902}auth_s = {905}r1_90[{904}j]) then
{900}      let sk_s: hash0 = {899}h0({891}U, {892}S, {894}X_s, {896}Y, {898}K_s) in
{890}      event {889}termS({879}U, {881}X_s, {882}S, {884}@2_r2_169, {886}auth_s, {888}sk_s)
    )
  )
  else
{787}    find [unique] @i_222 <= qD suchthat defined(@2_m[{662}@i_222], @2_kd[{664}@i_222], @2_kd_158[{666}@i_222], @2_m_159[{668}@i_222], @2_r4_157[{670}@i_222]) && otheruses(@2_m[{660}@i_222] -> @2_r4_157[{658}@i_222]) && {656}({650}({646}@2_r2_169 = {649}@2_m[{648}@i_222]) && {655}({651}pw = {654}@2_kd[{653}@i_222])) then
    (
{644}      find nj <= qH1 suchthat defined(x11[{635}nj], x12[{637}nj], x13[{639}nj], x14[{641}nj], r1_66[{643}nj]) && {633}({605}({601}U = {604}x11[{603}nj]) && {632}({610}({606}S = {609}x12[{608}nj]) && {631}({616}({612}X_s = {615}x13[{614}nj]) && {630}({623}({619}@2_r4_157[{618}@i_222] = {622}x14[{621}nj]) && {629}({625}auth_s = {628}r1_66[{627}nj]))))) then
{600}      event {599}Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[{731}@i_217], @2_m_174[{733}@i_217], @2_r4_172[{735}@i_217]) && otheruses(Ystar_u[{729}@i_217] -> @2_r4_172[{727}@i_217]) && {725}({721}@2_r2_169 = {724}Ystar_u[{723}@i_217]) then
    (
{719}      find nj <= qH1 suchthat defined(x11[{710}nj], x12[{712}nj], x13[{714}nj], x14[{716}nj], r1_66[{718}nj]) && {708}({680}({676}U = {679}x11[{678}nj]) && {707}({685}({681}S = {684}x12[{683}nj]) && {706}({691}({687}X_s = {690}x13[{689}nj]) && {705}({698}({694}@2_r4_172[{693}@i_217] = {697}x14[{696}nj]) && {704}({700}auth_s = {703}r1_66[{702}nj]))))) then
{675}      event {674}Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
{783}      find nj <= qH1 suchthat defined(x11[{774}nj], x12[{776}nj], x13[{778}nj], x14[{780}nj], r1_66[{782}nj]) && {772}({745}({741}U = {744}x11[{743}nj]) && {771}({750}({746}S = {749}x12[{748}nj]) && {770}({756}({752}X_s = {755}x13[{754}nj]) && {769}({762}({758}Y = {761}x14[{760}nj]) && {768}({764}auth_s = {767}r1_66[{766}nj]))))) then
{740}      event {739}Auth
    )
) | (
{591}  ! !_43 <= NP
{590}  in(cp[{589}!_43], ());
{588}  new xp: exponent;
{587}  let Xp: G = {586}exp({583}g, {585}xp) in
{582}  new yp: exponent;
{581}  let Yp: G = {580}exp({577}g, {579}yp) in
{576}  let Kp: G = {575}exp({569}g, {574}mult({571}xp, {573}yp)) in
{568}  let @2_x_165: G = {567}cst_G in
{566}  let @2_ke_164: passwd = {565}cst_passwd in
{564}  new @2_r2_163: G;
{563}  let x1_77: host = {562}U in
{561}  let x2_76: host = {560}S in
{559}  new r1_72: hash1;
{558}  let sk_p: hash0 = {557}h0({549}U, {550}S, {552}Xp, {554}Yp, {556}Kp) in
{548}  out(cp[{547}!_43], {546}({538}U, {540}Xp, {541}S, {543}@2_r2_163, {545}r1_72))
) | (
{527}  ! !_44 <= qE
{526}  in(@2_c1[{525}!_44], (@2_x: G, @2_ke: passwd));
{524}  let @2_x_162: G = {523}cst_G in
{522}  let @2_ke_161: passwd = {521}cst_passwd in
{520}  find [unique] @i_198 <= qD suchthat defined(@2_kd[{391}@i_198], @2_m[{393}@i_198], @2_m_159[{395}@i_198], @2_kd_158[{397}@i_198], @2_r4_157[{399}@i_198]) && otheruses(@2_m[{389}@i_198] -> @2_r4_157[{387}@i_198]) && {385}({378}({374}@2_x = {377}@2_r4_157[{376}@i_198]) && {384}({380}@2_ke = {383}@2_kd[{382}@i_198])) then
{372}    out(@2_c2[{371}!_44], {370}@2_m[{369}@i_198])
  orfind @i_193 <= NU suchthat defined(pw, Ystar_u[{422}@i_193], @2_m_174[{424}@i_193], @2_kd_173[{426}@i_193], @2_r4_172[{428}@i_193]) && otheruses(Ystar_u[{420}@i_193] -> @2_r4_172[{418}@i_193]) && {416}({411}({407}@2_x = {410}@2_r4_172[{409}@i_193]) && {415}({413}@2_ke = {414}pw)) then
{405}    out(@2_c2[{404}!_44], {403}Ystar_u[{402}@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[{453}@i_191], @2_ke[{455}@i_191], @2_ke_161[{457}@i_191], @2_x_162[{459}@i_191], @2_r2_160[{461}@i_191]) && otheruses(@2_x[{451}@i_191] -> @2_r2_160[{449}@i_191]) && {447}({440}({436}@2_x = {439}@2_x[{438}@i_191]) && {446}({442}@2_ke = {445}@2_ke[{444}@i_191])) then
{434}    out(@2_c2[{433}!_44], {432}@2_r2_160[{431}@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[{484}@i_190], pw, @2_ke_164[{486}@i_190], @2_x_165[{488}@i_190], @2_r2_163[{490}@i_190]) && otheruses(Yp[{482}@i_190] -> @2_r2_163[{480}@i_190]) && {478}({473}({469}@2_x = {472}Yp[{471}@i_190]) && {477}({475}@2_ke = {476}pw)) then
{467}    out(@2_c2[{466}!_44], {465}@2_r2_163[{464}@i_190])
  orfind @i_188 <= NS suchthat defined(Y[{513}@i_188], pw, @2_ke_170[{515}@i_188], @2_x_171[{517}@i_188], @2_r2_169[{519}@i_188]) && otheruses(Y[{511}@i_188] -> @2_r2_169[{509}@i_188]) && {507}({502}({498}@2_x = {501}Y[{500}@i_188]) && {506}({504}@2_ke = {505}pw)) then
{496}    out(@2_c2[{495}!_44], {494}@2_r2_169[{493}@i_188])
  else
{366}    new @2_r2_160: G;
{365}    out(@2_c2[{364}!_44], {363}@2_r2_160)
) | (
{358}  ! !_45 <= qD
{357}  in(@2_c3[{356}!_45], (@2_m: G, @2_kd: passwd));
{355}  let @2_m_159: G = {354}cst_G in
{353}  let @2_kd_158: passwd = {352}cst_passwd in
{351}  find [unique] @i_186 <= qD suchthat defined(@2_m[{222}@i_186], @2_kd[{224}@i_186], @2_kd_158[{226}@i_186], @2_m_159[{228}@i_186], @2_r4_157[{230}@i_186]) && otheruses(@2_m[{220}@i_186] -> @2_r4_157[{218}@i_186]) && {216}({209}({205}@2_m = {208}@2_m[{207}@i_186]) && {215}({211}@2_kd = {214}@2_kd[{213}@i_186])) then
{203}    out(@2_c4[{202}!_45], {201}@2_r4_157[{200}@i_186])
  orfind @i_181 <= NU suchthat defined(Ystar_u[{253}@i_181], pw, @2_kd_173[{255}@i_181], @2_m_174[{257}@i_181], @2_r4_172[{259}@i_181]) && otheruses(Ystar_u[{251}@i_181] -> @2_r4_172[{249}@i_181]) && {247}({242}({238}@2_m = {241}Ystar_u[{240}@i_181]) && {246}({244}@2_kd = {245}pw)) then
{236}    out(@2_c4[{235}!_45], {234}@2_r4_172[{233}@i_181])
  orfind @i_179 <= qE suchthat defined(@2_ke[{284}@i_179], @2_x[{286}@i_179], @2_x_162[{288}@i_179], @2_ke_161[{290}@i_179], @2_r2_160[{292}@i_179]) && otheruses(@2_x[{282}@i_179] -> @2_r2_160[{280}@i_179]) && {278}({271}({267}@2_m = {270}@2_r2_160[{269}@i_179]) && {277}({273}@2_kd = {276}@2_ke[{275}@i_179])) then
{265}    out(@2_c4[{264}!_45], {263}@2_x[{262}@i_179])
  orfind @i_178 <= NP suchthat defined(pw, Yp[{315}@i_178], @2_x_165[{317}@i_178], @2_ke_164[{319}@i_178], @2_r2_163[{321}@i_178]) && otheruses(Yp[{313}@i_178] -> @2_r2_163[{311}@i_178]) && {309}({304}({300}@2_m = {303}@2_r2_163[{302}@i_178]) && {308}({306}@2_kd = {307}pw)) then
{298}    out(@2_c4[{297}!_45], {296}Yp[{295}@i_178])
  orfind @i_176 <= NS suchthat defined(pw, Y[{344}@i_176], @2_x_171[{346}@i_176], @2_ke_170[{348}@i_176], @2_r2_169[{350}@i_176]) && otheruses(Y[{342}@i_176] -> @2_r2_169[{340}@i_176]) && {338}({333}({329}@2_m = {332}@2_r2_169[{331}@i_176]) && {337}({335}@2_kd = {336}pw)) then
{327}    out(@2_c4[{326}!_45], {325}Y[{324}@i_176])
  else
{197}    new @2_r4_157: G;
{196}    out(@2_c4[{195}!_45], {194}@2_r4_157)
) | (
{189}  ! !_46 <= qH0
{188}  in(c10[{187}!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
{186}  out(c20[{185}!_46], {184}h0({175}x1, {177}x2, {179}x3, {181}x4, {183}x5))
) | (
{172}  ! !_47 <= qH1
{171}  in(c11[{170}!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
{169}  find [unique] @i_100 <= qH1 suchthat defined(x11[{50}@i_100], x12[{52}@i_100], x13[{54}@i_100], x14[{56}@i_100], x15[{58}@i_100], r1_66[{60}@i_100]) && otheruses(r1_66[{48}@i_100]) && {46}({18}({14}x11 = {17}x11[{16}@i_100]) && {45}({24}({20}x12 = {23}x12[{22}@i_100]) && {44}({30}({26}x13 = {29}x13[{28}@i_100]) && {43}({36}({32}x14 = {35}x14[{34}@i_100]) && {42}({38}x15 = {41}x15[{40}@i_100]))))) then
{12}    out(c21[{11}!_47], {10}r1_66[{9}@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[{104}@i_99], x2_76[{106}@i_99], Xp[{108}@i_99], Yp[{110}@i_99], Kp[{112}@i_99], r1_72[{114}@i_99]) && otheruses(r1_72[{102}@i_99]) && {100}({72}({68}x11 = {71}x1_77[{70}@i_99]) && {99}({78}({74}x12 = {77}x2_76[{76}@i_99]) && {98}({84}({80}x13 = {83}Xp[{82}@i_99]) && {97}({90}({86}x14 = {89}Yp[{88}@i_99]) && {96}({92}x15 = {95}Kp[{94}@i_99]))))) then
{66}    out(c21[{65}!_47], {64}r1_72[{63}@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[{158}@i_96], x2_94[{160}@i_96], X[{162}@i_96], Y_u[{164}@i_96], K_u[{166}@i_96], r1_90[{168}@i_96]) && otheruses(r1_90[{156}@i_96]) && {154}({126}({122}x11 = {125}x1_95[{124}@i_96]) && {153}({132}({128}x12 = {131}x2_94[{130}@i_96]) && {152}({138}({134}x13 = {137}X[{136}@i_96]) && {151}({144}({140}x14 = {143}Y_u[{142}@i_96]) && {150}({146}x15 = {149}K_u[{148}@i_96]))))) then
{120}    out(c21[{119}!_47], {118}r1_90[{117}@i_96])
  else
{6}    new r1_66: hash1;
{5}    out(c21[{4}!_47], {3}r1_66)
)

Doing insert event Encrypt at occurrence 1472... Done.
Trying equivalence
equiv ! !_39 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_40 <= N (x1_56: host, x2_55: host, x3_54: G, x4_53: G, x5_52: G) -> let x1: host = x1_56 in let x2: host = x2_55 in let x3: G = x3_54 in let x4: G = x4_53 in let x5: G = x5_52 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r1[j]) && otheruses(r1[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r1[j] else new r1: hash1; r1
... Failed.
Trying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_38 <= N (x1_61: host, x2_60: host, x3_59: G, x4_58: G, x5_57: G) -> let x1: host = x1_61 in let x2: host = x2_60 in let x3: G = x3_59 in let x4: G = x4_58 in let x5: G = x5_57 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash0; r
... Succeeded.
Doing simplify... Run simplify 3 time(s). Fixpoint reached.
Eliminated collisions between @2_r4_157 and @2_r4_157 Probability: 0.5 * qD * qD / |G|
Eliminated collisions between @2_r4_157 and @2_r4_172 Probability: qD * NU / |G|
Eliminated collisions between @2_r4_172 and @2_r4_172 Probability: 0.5 * NU * NU / |G|
Eliminated collisions between r1_90 and r1_66 Probability: NU * qH1 / |hash1|
Eliminated collisions between exp(g, yp[!2_5967]) and @2_r4_172[!2_5968] Probability: NU * NP / |exponent|
(exp(g, yp[!2_5967]) characterizes a part of yp[!2_5967] of type(s) exponent;
 @2_r4_172[!2_5968] does not depend on yp[!2_5967])
Eliminated collisions between exp(g, yp[!2_5808]) and @2_r4_157[!2_5809] Probability: qD * NP / |exponent|
(exp(g, yp[!2_5808]) characterizes a part of yp[!2_5808] of type(s) exponent;
 @2_r4_157[!2_5809] does not depend on yp[!2_5808])
Eliminated collisions between @2_r4_157[!2_5596] and exp(g, yp[!2_5597]) Probability: NP * qD / |G|
(@2_r4_157[!2_5596] characterizes a part of @2_r4_157[!2_5596] of type(s) G;
 exp(g, yp[!2_5597]) does not depend on @2_r4_157[!2_5596])
Eliminated collisions between @2_r4_172[!2_5548] and exp(g, yp[!2_5549]) Probability: NP * NU / |G|
(@2_r4_172[!2_5548] characterizes a part of @2_r4_172[!2_5548] of type(s) G;
 exp(g, yp[!2_5549]) does not depend on @2_r4_172[!2_5548])
Eliminated collisions between r1_90[!_41] and auth_s[!2_5019] Probability: NS * NU / |hash1|
(r1_90[!_41] characterizes a part of r1_90[!_41] of type(s) hash1;
 auth_s[!2_5019] does not depend on r1_90[!_41])
Eliminated collisions between @2_r4_157[!2_4997] and exp(g, y[!2_4998]) Probability: NS * qD / |G|
(@2_r4_157[!2_4997] characterizes a part of @2_r4_157[!2_4997] of type(s) G;
 exp(g, y[!2_4998]) does not depend on @2_r4_157[!2_4997])
Eliminated collisions between @2_r4_172[!2_4949] and exp(g, y[!2_4950]) Probability: NS * NU / |G|
(@2_r4_172[!2_4949] characterizes a part of @2_r4_172[!2_4949] of type(s) G;
 exp(g, y[!2_4950]) does not depend on @2_r4_172[!2_4949])
Eliminated collisions between @2_r4_172[!_41] and x4_386[!2_4842] Probability: qH0 * NU / |G|
(@2_r4_172[!_41] characterizes a part of @2_r4_172[!_41] of type(s) G;
 x4_386[!2_4842] does not depend on @2_r4_172[!_41])
Eliminated collisions between @2_r4_172[!_41] and x4_392[!2_4841] Probability: NP * NU / |G|
(@2_r4_172[!_41] characterizes a part of @2_r4_172[!_41] of type(s) G;
 x4_392[!2_4841] does not depend on @2_r4_172[!_41])
Eliminated collisions between @2_r4_172[!_41] and x4_398[!2_4840] Probability: NS * NU / |G|
(@2_r4_172[!_41] characterizes a part of @2_r4_172[!_41] of type(s) G;
 x4_398[!2_4840] does not depend on @2_r4_172[!_41])
Eliminated collisions between @2_r4_172[!_41] and x4_404[!2_4839] Probability: NS * NU / |G|
(@2_r4_172[!_41] characterizes a part of @2_r4_172[!_41] of type(s) G;
 x4_404[!2_4839] does not depend on @2_r4_172[!_41])
Eliminated collisions between @2_r4_172[!_41] and x4_416[!2_4837] Probability: NU * NU / |G|
(@2_r4_172[!_41] characterizes a part of @2_r4_172[!_41] of type(s) G;
 x4_416[!2_4837] does not depend on @2_r4_172[!_41])
Eliminated collisions between @2_r4_172[!_41] and x4_422[!2_4836] Probability: NU * NU / |G|
(@2_r4_172[!_41] characterizes a part of @2_r4_172[!_41] of type(s) G;
 x4_422[!2_4836] does not depend on @2_r4_172[!_41])
Eliminated collisions between @2_r4_172[!_41] and x4_428[!2_4835] Probability: NU * NU / |G|
(@2_r4_172[!_41] characterizes a part of @2_r4_172[!_41] of type(s) G;
 x4_428[!2_4835] does not depend on @2_r4_172[!_41])
Eliminated collisions between @2_r4_172[!_41] and x4_434[!2_4834] Probability: NU * NU / |G|
(@2_r4_172[!_41] characterizes a part of @2_r4_172[!_41] of type(s) G;
 x4_434[!2_4834] does not depend on @2_r4_172[!_41])
Eliminated collisions between @2_r4_172[!_41] and x4_440[!2_4833] Probability: NU * NU / |G|
(@2_r4_172[!_41] characterizes a part of @2_r4_172[!_41] of type(s) G;
 x4_440[!2_4833] does not depend on @2_r4_172[!_41])
Eliminated collisions between @2_r4_172[!_41] and x4_446[!2_4832] Probability: NU * NU / |G|
(@2_r4_172[!_41] characterizes a part of @2_r4_172[!_41] of type(s) G;
 x4_446[!2_4832] does not depend on @2_r4_172[!_41])
Eliminated collisions between @2_r4_172[!_41] and x4_452[!2_4831] Probability: NU * NU / |G|
(@2_r4_172[!_41] characterizes a part of @2_r4_172[!_41] of type(s) G;
 x4_452[!2_4831] does not depend on @2_r4_172[!_41])
Eliminated collisions between @2_r4_172[!_41] and x4_458[!2_4830] Probability: NU * NU / |G|
(@2_r4_172[!_41] characterizes a part of @2_r4_172[!_41] of type(s) G;
 x4_458[!2_4830] does not depend on @2_r4_172[!_41])
Eliminated collisions between exp(g, y[!_42]) and @2_r4_157[!2_4391] Probability: qD * NS / |exponent|
(exp(g, y[!_42]) characterizes a part of y[!_42] of type(s) exponent;
 @2_r4_157[!2_4391] does not depend on y[!_42])
Eliminated collisions between exp(g, y[!_42]) and @2_r4_172[!2_4346] Probability: NU * NS / |exponent|
(exp(g, y[!_42]) characterizes a part of y[!_42] of type(s) exponent;
 @2_r4_172[!2_4346] does not depend on y[!_42])
Eliminated collisions between exp(g, yp[!_43]) and x4_386[!2_4019] Probability: qH0 * NP / |exponent|
(exp(g, yp[!_43]) characterizes a part of yp[!_43] of type(s) exponent;
 x4_386[!2_4019] does not depend on yp[!_43])
Eliminated collisions between exp(g, yp[!_43]) and x4_398[!2_4017] Probability: NS * NP / |exponent|
(exp(g, yp[!_43]) characterizes a part of yp[!_43] of type(s) exponent;
 x4_398[!2_4017] does not depend on yp[!_43])
Eliminated collisions between exp(g, yp[!_43]) and x4_404[!2_4016] Probability: NS * NP / |exponent|
(exp(g, yp[!_43]) characterizes a part of yp[!_43] of type(s) exponent;
 x4_404[!2_4016] does not depend on yp[!_43])
Eliminated collisions between exp(g, yp[!_43]) and x4_410[!2_4015] Probability: NU * NP / |exponent|
(exp(g, yp[!_43]) characterizes a part of yp[!_43] of type(s) exponent;
 x4_410[!2_4015] does not depend on yp[!_43])
Eliminated collisions between exp(g, yp[!_43]) and x4_416[!2_4014] Probability: NU * NP / |exponent|
(exp(g, yp[!_43]) characterizes a part of yp[!_43] of type(s) exponent;
 x4_416[!2_4014] does not depend on yp[!_43])
Eliminated collisions between exp(g, yp[!_43]) and x4_422[!2_4013] Probability: NU * NP / |exponent|
(exp(g, yp[!_43]) characterizes a part of yp[!_43] of type(s) exponent;
 x4_422[!2_4013] does not depend on yp[!_43])
Eliminated collisions between exp(g, yp[!_43]) and x4_428[!2_4012] Probability: NU * NP / |exponent|
(exp(g, yp[!_43]) characterizes a part of yp[!_43] of type(s) exponent;
 x4_428[!2_4012] does not depend on yp[!_43])
Eliminated collisions between exp(g, yp[!_43]) and x4_434[!2_4011] Probability: NU * NP / |exponent|
(exp(g, yp[!_43]) characterizes a part of yp[!_43] of type(s) exponent;
 x4_434[!2_4011] does not depend on yp[!_43])
Eliminated collisions between exp(g, yp[!_43]) and x4_440[!2_4010] Probability: NU * NP / |exponent|
(exp(g, yp[!_43]) characterizes a part of yp[!_43] of type(s) exponent;
 x4_440[!2_4010] does not depend on yp[!_43])
Eliminated collisions between exp(g, yp[!_43]) and x4_446[!2_4009] Probability: NU * NP / |exponent|
(exp(g, yp[!_43]) characterizes a part of yp[!_43] of type(s) exponent;
 x4_446[!2_4009] does not depend on yp[!_43])
Eliminated collisions between exp(g, yp[!_43]) and x4_452[!2_4008] Probability: NU * NP / |exponent|
(exp(g, yp[!_43]) characterizes a part of yp[!_43] of type(s) exponent;
 x4_452[!2_4008] does not depend on yp[!_43])
Eliminated collisions between exp(g, yp[!_43]) and x4_458[!2_4007] Probability: NU * NP / |exponent|
(exp(g, yp[!_43]) characterizes a part of yp[!_43] of type(s) exponent;
 x4_458[!2_4007] does not depend on yp[!_43])
Reduced (mult(y[@i_236[j[!_42]]], x[j[!_42]]) = mult(x[j[!_42]], y[!_42])) to (((y[@i_236[j[!_42]]] = x[j[!_42]]) && (x[j[!_42]] = y[!_42])) || ((y[@i_236[j[!_42]]] = y[!_42]) && (x[j[!_42]] = x[j[!_42]]))) Probability: 1. / |exponent| * NS
Reduced (mult(yp[@i_238[!_41]], x[!_41]) = mult(xp[@i_603[!_41]], yp[@i_603[!_41]])) to (((yp[@i_238[!_41]] = xp[@i_603[!_41]]) && (x[!_41] = yp[@i_603[!_41]])) || ((yp[@i_238[!_41]] = yp[@i_603[!_41]]) && (x[!_41] = xp[@i_603[!_41]]))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_238[!_41]], x[!_41]) = mult(x[j[@i_602[!_41]]], y[@i_602[!_41]])) to (((yp[@i_238[!_41]] = x[j[@i_602[!_41]]]) && (x[!_41] = y[@i_602[!_41]])) || ((yp[@i_238[!_41]] = y[@i_602[!_41]]) && (x[!_41] = x[j[@i_602[!_41]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_238[!_41]], x[!_41]) = mult(x[j[@i_601[!_41]]], y[@i_601[!_41]])) to (((yp[@i_238[!_41]] = x[j[@i_601[!_41]]]) && (x[!_41] = y[@i_601[!_41]])) || ((yp[@i_238[!_41]] = y[@i_601[!_41]]) && (x[!_41] = x[j[@i_601[!_41]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_238[!_41]], x[!_41]) = mult(yp[@i_238[@i_595[!_41]]], x[@i_595[!_41]])) to (((yp[@i_238[!_41]] = yp[@i_238[@i_595[!_41]]]) && (x[!_41] = x[@i_595[!_41]])) || ((yp[@i_238[!_41]] = x[@i_595[!_41]]) && (x[!_41] = yp[@i_238[@i_595[!_41]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_238[!_41]], x[!_41]) = mult(yp[@i_238[@i_594[!_41]]], x[@i_594[!_41]])) to (((yp[@i_238[!_41]] = yp[@i_238[@i_594[!_41]]]) && (x[!_41] = x[@i_594[!_41]])) || ((yp[@i_238[!_41]] = x[@i_594[!_41]]) && (x[!_41] = yp[@i_238[@i_594[!_41]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_238[!_41]], x[!_41]) = mult(y[@i_236[@i_593[!_41]]], x[@i_593[!_41]])) to (((yp[@i_238[!_41]] = y[@i_236[@i_593[!_41]]]) && (x[!_41] = x[@i_593[!_41]])) || ((yp[@i_238[!_41]] = x[@i_593[!_41]]) && (x[!_41] = y[@i_236[@i_593[!_41]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_238[!_41]], x[!_41]) = mult(y[@i_236[@i_592[!_41]]], x[@i_592[!_41]])) to (((yp[@i_238[!_41]] = y[@i_236[@i_592[!_41]]]) && (x[!_41] = x[@i_592[!_41]])) || ((yp[@i_238[!_41]] = x[@i_592[!_41]]) && (x[!_41] = y[@i_236[@i_592[!_41]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_238[!_41]], x[!_41]) = mult(xp[@i_590[!_41]], yp[@i_590[!_41]])) to (((yp[@i_238[!_41]] = xp[@i_590[!_41]]) && (x[!_41] = yp[@i_590[!_41]])) || ((yp[@i_238[!_41]] = yp[@i_590[!_41]]) && (x[!_41] = xp[@i_590[!_41]]))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_238[!_41]], x[!_41]) = mult(x[j[@i_589[!_41]]], y[@i_589[!_41]])) to (((yp[@i_238[!_41]] = x[j[@i_589[!_41]]]) && (x[!_41] = y[@i_589[!_41]])) || ((yp[@i_238[!_41]] = y[@i_589[!_41]]) && (x[!_41] = x[j[@i_589[!_41]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_238[!_41]], x[!_41]) = mult(x[j[@i_588[!_41]]], y[@i_588[!_41]])) to (((yp[@i_238[!_41]] = x[j[@i_588[!_41]]]) && (x[!_41] = y[@i_588[!_41]])) || ((yp[@i_238[!_41]] = y[@i_588[!_41]]) && (x[!_41] = x[j[@i_588[!_41]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_238[!_41]], x[!_41]) = mult(yp[@i_238[@i_582[!_41]]], x[@i_582[!_41]])) to (((yp[@i_238[!_41]] = yp[@i_238[@i_582[!_41]]]) && (x[!_41] = x[@i_582[!_41]])) || ((yp[@i_238[!_41]] = x[@i_582[!_41]]) && (x[!_41] = yp[@i_238[@i_582[!_41]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_238[!_41]], x[!_41]) = mult(yp[@i_238[@i_581[!_41]]], x[@i_581[!_41]])) to (((yp[@i_238[!_41]] = yp[@i_238[@i_581[!_41]]]) && (x[!_41] = x[@i_581[!_41]])) || ((yp[@i_238[!_41]] = x[@i_581[!_41]]) && (x[!_41] = yp[@i_238[@i_581[!_41]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_238[!_41]], x[!_41]) = mult(y[@i_236[@i_580[!_41]]], x[@i_580[!_41]])) to (((yp[@i_238[!_41]] = y[@i_236[@i_580[!_41]]]) && (x[!_41] = x[@i_580[!_41]])) || ((yp[@i_238[!_41]] = x[@i_580[!_41]]) && (x[!_41] = y[@i_236[@i_580[!_41]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(yp[@i_238[!_41]], x[!_41]) = mult(y[@i_236[@i_579[!_41]]], x[@i_579[!_41]])) to (((yp[@i_238[!_41]] = y[@i_236[@i_579[!_41]]]) && (x[!_41] = x[@i_579[!_41]])) || ((yp[@i_238[!_41]] = x[@i_579[!_41]]) && (x[!_41] = y[@i_236[@i_579[!_41]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_236[!_41]], x[!_41]) = mult(xp[@i_629[!_41]], yp[@i_629[!_41]])) to (((y[@i_236[!_41]] = xp[@i_629[!_41]]) && (x[!_41] = yp[@i_629[!_41]])) || ((y[@i_236[!_41]] = yp[@i_629[!_41]]) && (x[!_41] = xp[@i_629[!_41]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_236[!_41]], x[!_41]) = mult(x[j[@i_628[!_41]]], y[@i_628[!_41]])) to (((y[@i_236[!_41]] = x[j[@i_628[!_41]]]) && (x[!_41] = y[@i_628[!_41]])) || ((y[@i_236[!_41]] = y[@i_628[!_41]]) && (x[!_41] = x[j[@i_628[!_41]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_236[!_41]], x[!_41]) = mult(x[j[@i_627[!_41]]], y[@i_627[!_41]])) to (((y[@i_236[!_41]] = x[j[@i_627[!_41]]]) && (x[!_41] = y[@i_627[!_41]])) || ((y[@i_236[!_41]] = y[@i_627[!_41]]) && (x[!_41] = x[j[@i_627[!_41]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_236[!_41]], x[!_41]) = mult(yp[@i_238[@i_621[!_41]]], x[@i_621[!_41]])) to (((y[@i_236[!_41]] = yp[@i_238[@i_621[!_41]]]) && (x[!_41] = x[@i_621[!_41]])) || ((y[@i_236[!_41]] = x[@i_621[!_41]]) && (x[!_41] = yp[@i_238[@i_621[!_41]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_236[!_41]], x[!_41]) = mult(yp[@i_238[@i_620[!_41]]], x[@i_620[!_41]])) to (((y[@i_236[!_41]] = yp[@i_238[@i_620[!_41]]]) && (x[!_41] = x[@i_620[!_41]])) || ((y[@i_236[!_41]] = x[@i_620[!_41]]) && (x[!_41] = yp[@i_238[@i_620[!_41]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_236[!_41]], x[!_41]) = mult(y[@i_236[@i_619[!_41]]], x[@i_619[!_41]])) to (((y[@i_236[!_41]] = y[@i_236[@i_619[!_41]]]) && (x[!_41] = x[@i_619[!_41]])) || ((y[@i_236[!_41]] = x[@i_619[!_41]]) && (x[!_41] = y[@i_236[@i_619[!_41]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_236[!_41]], x[!_41]) = mult(y[@i_236[@i_618[!_41]]], x[@i_618[!_41]])) to (((y[@i_236[!_41]] = y[@i_236[@i_618[!_41]]]) && (x[!_41] = x[@i_618[!_41]])) || ((y[@i_236[!_41]] = x[@i_618[!_41]]) && (x[!_41] = y[@i_236[@i_618[!_41]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_236[!_41]], x[!_41]) = mult(xp[@i_616[!_41]], yp[@i_616[!_41]])) to (((y[@i_236[!_41]] = xp[@i_616[!_41]]) && (x[!_41] = yp[@i_616[!_41]])) || ((y[@i_236[!_41]] = yp[@i_616[!_41]]) && (x[!_41] = xp[@i_616[!_41]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_236[!_41]], x[!_41]) = mult(x[j[@i_615[!_41]]], y[@i_615[!_41]])) to (((y[@i_236[!_41]] = x[j[@i_615[!_41]]]) && (x[!_41] = y[@i_615[!_41]])) || ((y[@i_236[!_41]] = y[@i_615[!_41]]) && (x[!_41] = x[j[@i_615[!_41]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_236[!_41]], x[!_41]) = mult(x[j[@i_614[!_41]]], y[@i_614[!_41]])) to (((y[@i_236[!_41]] = x[j[@i_614[!_41]]]) && (x[!_41] = y[@i_614[!_41]])) || ((y[@i_236[!_41]] = y[@i_614[!_41]]) && (x[!_41] = x[j[@i_614[!_41]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_236[!_41]], x[!_41]) = mult(yp[@i_238[@i_608[!_41]]], x[@i_608[!_41]])) to (((y[@i_236[!_41]] = yp[@i_238[@i_608[!_41]]]) && (x[!_41] = x[@i_608[!_41]])) || ((y[@i_236[!_41]] = x[@i_608[!_41]]) && (x[!_41] = yp[@i_238[@i_608[!_41]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_236[!_41]], x[!_41]) = mult(yp[@i_238[@i_607[!_41]]], x[@i_607[!_41]])) to (((y[@i_236[!_41]] = yp[@i_238[@i_607[!_41]]]) && (x[!_41] = x[@i_607[!_41]])) || ((y[@i_236[!_41]] = x[@i_607[!_41]]) && (x[!_41] = yp[@i_238[@i_607[!_41]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_236[!_41]], x[!_41]) = mult(y[@i_236[@i_606[!_41]]], x[@i_606[!_41]])) to (((y[@i_236[!_41]] = y[@i_236[@i_606[!_41]]]) && (x[!_41] = x[@i_606[!_41]])) || ((y[@i_236[!_41]] = x[@i_606[!_41]]) && (x[!_41] = y[@i_236[@i_606[!_41]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(y[@i_236[!_41]], x[!_41]) = mult(y[@i_236[@i_605[!_41]]], x[@i_605[!_41]])) to (((y[@i_236[!_41]] = y[@i_236[@i_605[!_41]]]) && (x[!_41] = x[@i_605[!_41]])) || ((y[@i_236[!_41]] = x[@i_605[!_41]]) && (x[!_41] = y[@i_236[@i_605[!_41]]]))) Probability: 1. / |exponent| * NU
Reduced (mult(x[j[!_42]], y[!_42]) = mult(xp[@i_499[!_42]], yp[@i_499[!_42]])) to (((x[j[!_42]] = xp[@i_499[!_42]]) && (y[!_42] = yp[@i_499[!_42]])) || ((x[j[!_42]] = yp[@i_499[!_42]]) && (y[!_42] = xp[@i_499[!_42]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_42]], y[!_42]) = mult(x[j[@i_498[!_42]]], y[@i_498[!_42]])) to (((x[j[!_42]] = x[j[@i_498[!_42]]]) && (y[!_42] = y[@i_498[!_42]])) || ((x[j[!_42]] = y[@i_498[!_42]]) && (y[!_42] = x[j[@i_498[!_42]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_42]], y[!_42]) = mult(x[j[@i_497[!_42]]], y[@i_497[!_42]])) to (((x[j[!_42]] = x[j[@i_497[!_42]]]) && (y[!_42] = y[@i_497[!_42]])) || ((x[j[!_42]] = y[@i_497[!_42]]) && (y[!_42] = x[j[@i_497[!_42]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_42]], y[!_42]) = mult(yp[@i_238[@i_491[!_42]]], x[@i_491[!_42]])) to (((x[j[!_42]] = yp[@i_238[@i_491[!_42]]]) && (y[!_42] = x[@i_491[!_42]])) || ((x[j[!_42]] = x[@i_491[!_42]]) && (y[!_42] = yp[@i_238[@i_491[!_42]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_42]], y[!_42]) = mult(yp[@i_238[@i_490[!_42]]], x[@i_490[!_42]])) to (((x[j[!_42]] = yp[@i_238[@i_490[!_42]]]) && (y[!_42] = x[@i_490[!_42]])) || ((x[j[!_42]] = x[@i_490[!_42]]) && (y[!_42] = yp[@i_238[@i_490[!_42]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_42]], y[!_42]) = mult(y[@i_236[@i_489[!_42]]], x[@i_489[!_42]])) to (((x[j[!_42]] = y[@i_236[@i_489[!_42]]]) && (y[!_42] = x[@i_489[!_42]])) || ((x[j[!_42]] = x[@i_489[!_42]]) && (y[!_42] = y[@i_236[@i_489[!_42]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_42]], y[!_42]) = mult(y[@i_236[@i_488[!_42]]], x[@i_488[!_42]])) to (((x[j[!_42]] = y[@i_236[@i_488[!_42]]]) && (y[!_42] = x[@i_488[!_42]])) || ((x[j[!_42]] = x[@i_488[!_42]]) && (y[!_42] = y[@i_236[@i_488[!_42]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_42]], y[!_42]) = mult(xp[@i_512[!_42]], yp[@i_512[!_42]])) to (((x[j[!_42]] = xp[@i_512[!_42]]) && (y[!_42] = yp[@i_512[!_42]])) || ((x[j[!_42]] = yp[@i_512[!_42]]) && (y[!_42] = xp[@i_512[!_42]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_42]], y[!_42]) = mult(x[j[@i_511[!_42]]], y[@i_511[!_42]])) to (((x[j[!_42]] = x[j[@i_511[!_42]]]) && (y[!_42] = y[@i_511[!_42]])) || ((x[j[!_42]] = y[@i_511[!_42]]) && (y[!_42] = x[j[@i_511[!_42]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_42]], y[!_42]) = mult(x[j[@i_510[!_42]]], y[@i_510[!_42]])) to (((x[j[!_42]] = x[j[@i_510[!_42]]]) && (y[!_42] = y[@i_510[!_42]])) || ((x[j[!_42]] = y[@i_510[!_42]]) && (y[!_42] = x[j[@i_510[!_42]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_42]], y[!_42]) = mult(yp[@i_238[@i_504[!_42]]], x[@i_504[!_42]])) to (((x[j[!_42]] = yp[@i_238[@i_504[!_42]]]) && (y[!_42] = x[@i_504[!_42]])) || ((x[j[!_42]] = x[@i_504[!_42]]) && (y[!_42] = yp[@i_238[@i_504[!_42]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_42]], y[!_42]) = mult(yp[@i_238[@i_503[!_42]]], x[@i_503[!_42]])) to (((x[j[!_42]] = yp[@i_238[@i_503[!_42]]]) && (y[!_42] = x[@i_503[!_42]])) || ((x[j[!_42]] = x[@i_503[!_42]]) && (y[!_42] = yp[@i_238[@i_503[!_42]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_42]], y[!_42]) = mult(y[@i_236[@i_502[!_42]]], x[@i_502[!_42]])) to (((x[j[!_42]] = y[@i_236[@i_502[!_42]]]) && (y[!_42] = x[@i_502[!_42]])) || ((x[j[!_42]] = x[@i_502[!_42]]) && (y[!_42] = y[@i_236[@i_502[!_42]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_42]], y[!_42]) = mult(y[@i_236[@i_501[!_42]]], x[@i_501[!_42]])) to (((x[j[!_42]] = y[@i_236[@i_501[!_42]]]) && (y[!_42] = x[@i_501[!_42]])) || ((x[j[!_42]] = x[@i_501[!_42]]) && (y[!_42] = y[@i_236[@i_501[!_42]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(xp[!_43], yp[!_43]) = mult(xp[@i_486[!_43]], yp[@i_486[!_43]])) to (((xp[!_43] = xp[@i_486[!_43]]) && (yp[!_43] = yp[@i_486[!_43]])) || ((xp[!_43] = yp[@i_486[!_43]]) && (yp[!_43] = xp[@i_486[!_43]]))) Probability: 1. / |exponent| * NP
Done.
Doing move all binders... Done.
Doing remove assignments of useless... Done.
Trying equivalence
equiv ! !_39 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_40 <= N (x1_56: host, x2_55: host, x3_54: G, x4_53: G, x5_52: G) -> let x1: host = x1_56 in let x2: host = x2_55 in let x3: G = x3_54 in let x4: G = x4_53 in let x5: G = x5_52 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r1[j]) && otheruses(r1[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r1[j] else new r1: hash1; r1
... Failed.
Trying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_38 <= N (x1_61: host, x2_60: host, x3_59: G, x4_58: G, x5_57: G) -> let x1: host = x1_61 in let x2: host = x2_60 in let x3: G = x3_59 in let x4: G = x4_58 in let x5: G = x5_57 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash0; r
... Failed.
Trying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_63: G, @2_ke_62: passwd) := let @2_x: G = @2_x_63 in let @2_ke: passwd = @2_ke_62 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && otheruses(@2_x[@2_j_33] -> @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && otheruses(@2_m[@2_k_34] -> @2_r4[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_65: G, @2_kd_64: passwd) := let @2_m: G = @2_m_65 in let @2_kd: passwd = @2_kd_64 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && otheruses(@2_x[@2_j_35] -> @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && otheruses(@2_m[@2_k_36] -> @2_r4[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 74. / 10. * #@1_Oa) * max(1., 74. / 10. * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
... Failed.
Trying equivalence
equiv ! !_7 <= @1_N new @1_x: exponent; @1_OX() := exp(g, @1_x)
<=(0)=>
      ! !_8 <= @1_N new @1_X: G; @1_OX() := @1_X
... Failed.
Trying equivalence
equiv ! !_1 <= @1_N new @1_X: G; (
  @1_OX() := @1_X,
  ! !_2 <= @1_N' @1_OXm(@1_m: exponent) := exp(@1_X, @1_m))
<=(0)=>
      ! !_3 <= @1_N new @1_x: exponent; (
  @1_OX() := exp(g, @1_x),
  ! !_4 <= @1_N' @1_OXm(@1_m: exponent) := exp(g, mult(@1_x, @1_m)))
... Succeeded.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
No change.
Doing move all binders... No change.
Doing remove assignments of useless... No change.
Trying equivalence
equiv ! !_39 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_40 <= N (x1_56: host, x2_55: host, x3_54: G, x4_53: G, x5_52: G) -> let x1: host = x1_56 in let x2: host = x2_55 in let x3: G = x3_54 in let x4: G = x4_53 in let x5: G = x5_52 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r1[j]) && otheruses(r1[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r1[j] else new r1: hash1; r1
... Failed.
Trying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_38 <= N (x1_61: host, x2_60: host, x3_59: G, x4_58: G, x5_57: G) -> let x1: host = x1_61 in let x2: host = x2_60 in let x3: G = x3_59 in let x4: G = x4_58 in let x5: G = x5_57 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash0; r
... Failed.
Trying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_63: G, @2_ke_62: passwd) := let @2_x: G = @2_x_63 in let @2_ke: passwd = @2_ke_62 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && otheruses(@2_x[@2_j_33] -> @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && otheruses(@2_m[@2_k_34] -> @2_r4[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_65: G, @2_kd_64: passwd) := let @2_m: G = @2_m_65 in let @2_kd: passwd = @2_kd_64 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && otheruses(@2_x[@2_j_35] -> @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && otheruses(@2_m[@2_k_36] -> @2_r4[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 74. / 10. * #@1_Oa) * max(1., 74. / 10. * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
... Failed.
Trying equivalence
equiv ! !_7 <= @1_N new @1_x: exponent; @1_OX() := exp(g, @1_x)
<=(0)=>
      ! !_8 <= @1_N new @1_X: G; @1_OX() := @1_X
... Failed.
Trying equivalence
equiv ! !_1 <= @1_N new @1_X: G; (
  @1_OX() := @1_X,
  ! !_2 <= @1_N' @1_OXm(@1_m: exponent) := exp(@1_X, @1_m))
<=(0)=>
      ! !_3 <= @1_N new @1_x: exponent; (
  @1_OX() := exp(g, @1_x),
  ! !_4 <= @1_N' @1_OXm(@1_m: exponent) := exp(g, mult(@1_x, @1_m)))
... Succeeded.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
No change.
Doing move all binders... No change.
Doing remove assignments of useless... No change.
Trying equivalence
equiv ! !_39 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_40 <= N (x1_56: host, x2_55: host, x3_54: G, x4_53: G, x5_52: G) -> let x1: host = x1_56 in let x2: host = x2_55 in let x3: G = x3_54 in let x4: G = x4_53 in let x5: G = x5_52 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r1[j]) && otheruses(r1[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r1[j] else new r1: hash1; r1
... Failed.
Trying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_38 <= N (x1_61: host, x2_60: host, x3_59: G, x4_58: G, x5_57: G) -> let x1: host = x1_61 in let x2: host = x2_60 in let x3: G = x3_59 in let x4: G = x4_58 in let x5: G = x5_57 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash0; r
... Failed.
Trying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_63: G, @2_ke_62: passwd) := let @2_x: G = @2_x_63 in let @2_ke: passwd = @2_ke_62 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && otheruses(@2_x[@2_j_33] -> @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && otheruses(@2_m[@2_k_34] -> @2_r4[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_65: G, @2_kd_64: passwd) := let @2_m: G = @2_m_65 in let @2_kd: passwd = @2_kd_64 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && otheruses(@2_x[@2_j_35] -> @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && otheruses(@2_m[@2_k_36] -> @2_r4[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 74. / 10. * #@1_Oa) * max(1., 74. / 10. * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
... Failed.
Trying equivalence
equiv ! !_7 <= @1_N new @1_x: exponent; @1_OX() := exp(g, @1_x)
<=(0)=>
      ! !_8 <= @1_N new @1_X: G; @1_OX() := @1_X
... Failed.
Trying equivalence
equiv ! !_1 <= @1_N new @1_X: G; (
  @1_OX() := @1_X,
  ! !_2 <= @1_N' @1_OXm(@1_m: exponent) := exp(@1_X, @1_m))
<=(0)=>
      ! !_3 <= @1_N new @1_x: exponent; (
  @1_OX() := exp(g, @1_x),
  ! !_4 <= @1_N' @1_OXm(@1_m: exponent) := exp(g, mult(@1_x, @1_m)))
... Failed.
Doing SA rename K_u... Done.
Doing remove assignments of useless... Done.
Doing simplify... Run simplify 2 time(s). Fixpoint reached.
Eliminated collisions between y and @1_x_783 Probability: NS * qD / |exponent|
Eliminated collisions between y and @1_x_925 Probability: NS * NU / |exponent|
Reduced (mult(x[j[!_42]], y[!_42]) = mult(@1_x_783[@i_246[j[!_42]]], x[j[!_42]])) to (((x[j[!_42]] = @1_x_783[@i_246[j[!_42]]]) && (y[!_42] = x[j[!_42]])) || ((x[j[!_42]] = x[j[!_42]]) && (y[!_42] = @1_x_783[@i_246[j[!_42]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_42]], y[!_42]) = mult(@1_x_925[@i_241[j[!_42]]], x[j[!_42]])) to (((x[j[!_42]] = @1_x_925[@i_241[j[!_42]]]) && (y[!_42] = x[j[!_42]])) || ((x[j[!_42]] = x[j[!_42]]) && (y[!_42] = @1_x_925[@i_241[j[!_42]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_42]], y[!_42]) = mult(yp[@i_238[j[!_42]]], x[j[!_42]])) to (((x[j[!_42]] = yp[@i_238[j[!_42]]]) && (y[!_42] = x[j[!_42]])) || ((x[j[!_42]] = x[j[!_42]]) && (y[!_42] = yp[@i_238[j[!_42]]]))) Probability: 1. / |exponent| * NS
Reduced (mult(x[j[!_42]], y[!_42]) = mult(@1_x_925[j[!_42]], x[j[!_42]])) to (((x[j[!_42]] = @1_x_925[j[!_42]]) && (y[!_42] = x[j[!_42]])) || ((x[j[!_42]] = x[j[!_42]]) && (y[!_42] = @1_x_925[j[!_42]]))) Probability: 1. / |exponent| * NS
Done.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 74. / 10. * #@1_Oa) * max(1., 74. / 10. * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
with x, @1_x_783... Failed.
Doing remove assignments of binder K_s... Done.
Doing remove assignments of binder K_u_1099... Done.
Doing remove assignments of binder K_u_1095... Done.
Doing remove assignments of binder K_u_1096... Done.
Doing remove assignments of binder K_u_1097... Done.
Doing remove assignments of binder K_u_1098... Done.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 74. / 10. * #@1_Oa) * max(1., 74. / 10. * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
with @1_x_925, yp, y, x, @1_x_783... Failed.
Doing remove assignments of binder Kp... Done.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 74. / 10. * #@1_Oa) * max(1., 74. / 10. * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
with x, @1_x_925, yp, y, xp, @1_x_783... Eliminated collisions between @1_x_925 and @1_x_925 Probability: 0.5 * NU * NU / |exponent|
Eliminated collisions between @1_x_783 and @1_x_783 Probability: 0.5 * qD * qD / |exponent|
Eliminated collisions between @1_x_925 and yp Probability: NU * NP / |exponent|
Eliminated collisions between @1_x_925 and @1_x_783 Probability: NU * qD / |exponent|
Eliminated collisions between yp and @1_x_783 Probability: NP * qD / |exponent|
Succeeded.
Doing simplify... Run simplify 3 time(s). Maximum reached.
Done.
Doing move all binders... Done.
Doing remove assignments of useless... Done.
Proved one-session secrecy of sk_u
Proved secrecy of sk_u
Proved one-session secrecy of sk_s
Proved secrecy of sk_s
Proved one-session secrecy of sk_p
Proved secrecy of sk_p
Proved query event inj:termS(x, X, y, Y, a, k) ==> inj:termU(x, X, y, Y, a, k)
Proved query event termS(x, X, y, Y, a, k) && termU(x, X, y, Y, a, k') ==> (k = k')
Trying equivalence
equiv ! !_39 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_40 <= N (x1_56: host, x2_55: host, x3_54: G, x4_53: G, x5_52: G) -> let x1: host = x1_56 in let x2: host = x2_55 in let x3: G = x3_54 in let x4: G = x4_53 in let x5: G = x5_52 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r1[j]) && otheruses(r1[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r1[j] else new r1: hash1; r1
... Failed.
Trying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_38 <= N (x1_61: host, x2_60: host, x3_59: G, x4_58: G, x5_57: G) -> let x1: host = x1_61 in let x2: host = x2_60 in let x3: G = x3_59 in let x4: G = x4_58 in let x5: G = x5_57 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash0; r
... Failed.
Trying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_63: G, @2_ke_62: passwd) := let @2_x: G = @2_x_63 in let @2_ke: passwd = @2_ke_62 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && otheruses(@2_x[@2_j_33] -> @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && otheruses(@2_m[@2_k_34] -> @2_r4[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_65: G, @2_kd_64: passwd) := let @2_m: G = @2_m_65 in let @2_kd: passwd = @2_kd_64 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && otheruses(@2_x[@2_j_35] -> @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && otheruses(@2_m[@2_k_36] -> @2_r4[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 74. / 10. * #@1_Oa) * max(1., 74. / 10. * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
... Succeeded.
Doing simplify... Run simplify 3 time(s). Fixpoint reached.
Done.
Doing move all binders... No change.
Doing remove assignments of useless... Done.
Trying equivalence
equiv ! !_39 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_40 <= N (x1_56: host, x2_55: host, x3_54: G, x4_53: G, x5_52: G) -> let x1: host = x1_56 in let x2: host = x2_55 in let x3: G = x3_54 in let x4: G = x4_53 in let x5: G = x5_52 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r1[j]) && otheruses(r1[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r1[j] else new r1: hash1; r1
... Failed.
Trying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_38 <= N (x1_61: host, x2_60: host, x3_59: G, x4_58: G, x5_57: G) -> let x1: host = x1_61 in let x2: host = x2_60 in let x3: G = x3_59 in let x4: G = x4_58 in let x5: G = x5_57 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash0; r
... Failed.
Trying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_63: G, @2_ke_62: passwd) := let @2_x: G = @2_x_63 in let @2_ke: passwd = @2_ke_62 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && otheruses(@2_x[@2_j_33] -> @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && otheruses(@2_m[@2_k_34] -> @2_r4[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_65: G, @2_kd_64: passwd) := let @2_m: G = @2_m_65 in let @2_kd: passwd = @2_kd_64 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && otheruses(@2_x[@2_j_35] -> @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && otheruses(@2_m[@2_k_36] -> @2_r4[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 74. / 10. * #@1_Oa) * max(1., 74. / 10. * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
... Succeeded.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
No change.
Doing move all binders... No change.
Doing remove assignments of useless... Done.
Trying equivalence
equiv ! !_39 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_40 <= N (x1_56: host, x2_55: host, x3_54: G, x4_53: G, x5_52: G) -> let x1: host = x1_56 in let x2: host = x2_55 in let x3: G = x3_54 in let x4: G = x4_53 in let x5: G = x5_52 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r1[j]) && otheruses(r1[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r1[j] else new r1: hash1; r1
... Failed.
Trying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_38 <= N (x1_61: host, x2_60: host, x3_59: G, x4_58: G, x5_57: G) -> let x1: host = x1_61 in let x2: host = x2_60 in let x3: G = x3_59 in let x4: G = x4_58 in let x5: G = x5_57 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash0; r
... Failed.
Trying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_63: G, @2_ke_62: passwd) := let @2_x: G = @2_x_63 in let @2_ke: passwd = @2_ke_62 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && otheruses(@2_x[@2_j_33] -> @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && otheruses(@2_m[@2_k_34] -> @2_r4[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_65: G, @2_kd_64: passwd) := let @2_m: G = @2_m_65 in let @2_kd: passwd = @2_kd_64 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && otheruses(@2_x[@2_j_35] -> @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && otheruses(@2_m[@2_k_36] -> @2_r4[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 74. / 10. * #@1_Oa) * max(1., 74. / 10. * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
... Succeeded.
Doing simplify... Run simplify 3 time(s). Fixpoint reached.
Done.
Doing move all binders... No change.
Doing remove assignments of useless... Done.
Trying equivalence
equiv ! !_39 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_40 <= N (x1_56: host, x2_55: host, x3_54: G, x4_53: G, x5_52: G) -> let x1: host = x1_56 in let x2: host = x2_55 in let x3: G = x3_54 in let x4: G = x4_53 in let x5: G = x5_52 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r1[j]) && otheruses(r1[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r1[j] else new r1: hash1; r1
... Failed.
Trying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_38 <= N (x1_61: host, x2_60: host, x3_59: G, x4_58: G, x5_57: G) -> let x1: host = x1_61 in let x2: host = x2_60 in let x3: G = x3_59 in let x4: G = x4_58 in let x5: G = x5_57 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash0; r
... Failed.
Trying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_63: G, @2_ke_62: passwd) := let @2_x: G = @2_x_63 in let @2_ke: passwd = @2_ke_62 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && otheruses(@2_x[@2_j_33] -> @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && otheruses(@2_m[@2_k_34] -> @2_r4[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_65: G, @2_kd_64: passwd) := let @2_m: G = @2_m_65 in let @2_kd: passwd = @2_kd_64 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && otheruses(@2_x[@2_j_35] -> @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && otheruses(@2_m[@2_k_36] -> @2_r4[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 74. / 10. * #@1_Oa) * max(1., 74. / 10. * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
... Succeeded.
Doing simplify... Run simplify 1 time(s). Fixpoint reached.
No change.
Doing move all binders... No change.
Doing remove assignments of useless... Done.
Trying equivalence
equiv ! !_39 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_40 <= N (x1_56: host, x2_55: host, x3_54: G, x4_53: G, x5_52: G) -> let x1: host = x1_56 in let x2: host = x2_55 in let x3: G = x3_54 in let x4: G = x4_53 in let x5: G = x5_52 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r1[j]) && otheruses(r1[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r1[j] else new r1: hash1; r1
... Failed.
Trying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_38 <= N (x1_61: host, x2_60: host, x3_59: G, x4_58: G, x5_57: G) -> let x1: host = x1_61 in let x2: host = x2_60 in let x3: G = x3_59 in let x4: G = x4_58 in let x5: G = x5_57 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash0; r
... Failed.
Trying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_63: G, @2_ke_62: passwd) := let @2_x: G = @2_x_63 in let @2_ke: passwd = @2_ke_62 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && otheruses(@2_x[@2_j_33] -> @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && otheruses(@2_m[@2_k_34] -> @2_r4[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_65: G, @2_kd_64: passwd) := let @2_m: G = @2_m_65 in let @2_kd: passwd = @2_kd_64 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && otheruses(@2_x[@2_j_35] -> @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && otheruses(@2_m[@2_k_36] -> @2_r4[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 74. / 10. * #@1_Oa) * max(1., 74. / 10. * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
... Succeeded.
Doing simplify... Run simplify 3 time(s). Fixpoint reached.
Done.
Doing move all binders... Done.
Doing remove assignments of useless... Done.
Trying equivalence
equiv ! !_39 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_40 <= N (x1_56: host, x2_55: host, x3_54: G, x4_53: G, x5_52: G) -> let x1: host = x1_56 in let x2: host = x2_55 in let x3: G = x3_54 in let x4: G = x4_53 in let x5: G = x5_52 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r1[j]) && otheruses(r1[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r1[j] else new r1: hash1; r1
... Failed.
Trying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_38 <= N (x1_61: host, x2_60: host, x3_59: G, x4_58: G, x5_57: G) -> let x1: host = x1_61 in let x2: host = x2_60 in let x3: G = x3_59 in let x4: G = x4_58 in let x5: G = x5_57 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash0; r
... Failed.
Trying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_63: G, @2_ke_62: passwd) := let @2_x: G = @2_x_63 in let @2_ke: passwd = @2_ke_62 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && otheruses(@2_x[@2_j_33] -> @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && otheruses(@2_m[@2_k_34] -> @2_r4[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_65: G, @2_kd_64: passwd) := let @2_m: G = @2_m_65 in let @2_kd: passwd = @2_kd_64 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && otheruses(@2_x[@2_j_35] -> @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && otheruses(@2_m[@2_k_36] -> @2_r4[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
... Failed.
Trying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 74. / 10. * #@1_Oa) * max(1., 74. / 10. * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
... Failed.
Trying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
... Failed.
Trying equivalence
equiv ! !_7 <= @1_N new @1_x: exponent; @1_OX() := exp(g, @1_x)
<=(0)=>
      ! !_8 <= @1_N new @1_X: G; @1_OX() := @1_X
... Failed.
Trying equivalence
equiv ! !_1 <= @1_N new @1_X: G; (
  @1_OX() := @1_X,
  ! !_2 <= @1_N' @1_OXm(@1_m: exponent) := exp(@1_X, @1_m))
<=(0)=>
      ! !_3 <= @1_N new @1_x: exponent; (
  @1_OX() := exp(g, @1_x),
  ! !_4 <= @1_N' @1_OXm(@1_m: exponent) := exp(g, mult(@1_x, @1_m)))
... Failed.
===================== Proof starts =======================
Initial state
Game 1 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let auth_u: hash1 = h1(U, S, X, Y_u, K_u) in
  let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
  event termU(U, X, S, Ystar_u, auth_u, sk_u);
  out(c6[!_41], auth_u)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_42], (S, Ystar));
  in(c7[!_42], auth_s: hash1);
  let K_s: G = exp(X_s, y) in
  if (auth_s = h1(U, S, X_s, Y, K_s)) then
  let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
  event termS(U, X_s, S, Ystar, auth_s, sk_s)
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let authp: hash1 = h1(U, S, Xp, Yp, Kp) in
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_43], (U, Xp, S, Ystarp, authp))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_44], enc(@2_x, @2_ke))
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_45], dec(@2_m, @2_kd))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_46], h0(x1, x2, x3, x4, x5))
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  out(c21[!_47], h1(x11, x12, x13, x14, x15))
)


Applying insert instruction find j <= NU suchthat defined(X[j]) && X[j] = X_s then at occurrence 172 yields

Game 2 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let auth_u: hash1 = h1(U, S, X, Y_u, K_u) in
  let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
  event termU(U, X, S, Ystar_u, auth_u, sk_u);
  out(c6[!_41], auth_u)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_42], (S, Ystar));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(X_s, y) in
    if (auth_s = h1(U, S, X_s, Y, K_s)) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  else
    let K_s: G = exp(X_s, y) in
    if (auth_s = h1(U, S, X_s, Y, K_s)) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let authp: hash1 = h1(U, S, Xp, Yp, Kp) in
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_43], (U, Xp, S, Ystarp, authp))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_44], enc(@2_x, @2_ke))
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_45], dec(@2_m, @2_kd))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_46], h0(x1, x2, x3, x4, x5))
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  out(c21[!_47], h1(x11, x12, x13, x14, x15))
)


Applying equivalence
equiv ! !_39 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_40 <= N (x1_56: host, x2_55: host, x3_54: G, x4_53: G, x5_52: G) -> let x1: host = x1_56 in let x2: host = x2_55 in let x3: G = x3_54 in let x4: G = x4_53 in let x5: G = x5_52 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r1[j]) && otheruses(r1[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r1[j] else new r1: hash1; r1
 yields

Game 3 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_95: host = U in
  let x2_94: host = S in
  let x3_93: G = X in
  let x4_92: G = Y_u in
  let x5_91: G = K_u in
  find [unique] @i_120 <= qH1 suchthat defined(x1_71[@i_120], x2_70[@i_120], x3_69[@i_120], x4_68[@i_120], x5_67[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x1_71[@i_120]) && ((x2_94 = x2_70[@i_120]) && ((x3_93 = x3_69[@i_120]) && ((x4_92 = x4_68[@i_120]) && (x5_91 = x5_67[@i_120]))))) then
  (
    let auth_u: hash1 = r1_66[@i_120] in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_41], auth_u)
  )
  orfind @i_119 <= NP suchthat defined(x1_77[@i_119], x2_76[@i_119], x3_75[@i_119], x4_74[@i_119], x5_73[@i_119], r1_72[@i_119]) && otheruses(r1_72[@i_119]) && ((x1_95 = x1_77[@i_119]) && ((x2_94 = x2_76[@i_119]) && ((x3_93 = x3_75[@i_119]) && ((x4_92 = x4_74[@i_119]) && (x5_91 = x5_73[@i_119]))))) then
  (
    let auth_u: hash1 = r1_72[@i_119] in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_41], auth_u)
  )
  orfind @i_118 <= NS suchthat defined(x1_83[@i_118], x2_82[@i_118], x3_81[@i_118], x4_80[@i_118], x5_79[@i_118], r1_78[@i_118]) && otheruses(r1_78[@i_118]) && ((x1_95 = x1_83[@i_118]) && ((x2_94 = x2_82[@i_118]) && ((x3_93 = x3_81[@i_118]) && ((x4_92 = x4_80[@i_118]) && (x5_91 = x5_79[@i_118]))))) then
  (
    let auth_u: hash1 = r1_78[@i_118] in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_41], auth_u)
  )
  orfind @i_117 <= NS suchthat defined(x1_89[@i_117], x2_88[@i_117], x3_87[@i_117], x4_86[@i_117], x5_85[@i_117], r1_84[@i_117]) && otheruses(r1_84[@i_117]) && ((x1_95 = x1_89[@i_117]) && ((x2_94 = x2_88[@i_117]) && ((x3_93 = x3_87[@i_117]) && ((x4_92 = x4_86[@i_117]) && (x5_91 = x5_85[@i_117]))))) then
  (
    let auth_u: hash1 = r1_84[@i_117] in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_41], auth_u)
  )
  orfind @i_116 <= NU suchthat defined(x1_95[@i_116], x2_94[@i_116], x3_93[@i_116], x4_92[@i_116], x5_91[@i_116], r1_90[@i_116]) && otheruses(r1_90[@i_116]) && ((x1_95 = x1_95[@i_116]) && ((x2_94 = x2_94[@i_116]) && ((x3_93 = x3_93[@i_116]) && ((x4_92 = x4_92[@i_116]) && (x5_91 = x5_91[@i_116]))))) then
  (
    let auth_u: hash1 = r1_90[@i_116] in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_41], auth_u)
  )
  else
    new r1_90: hash1;
    let auth_u: hash1 = r1_90 in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_41], auth_u)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_42], (S, Ystar));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(X_s, y) in
    let x1_89: host = U in
    let x2_88: host = S in
    let x3_87: G = X_s in
    let x4_86: G = Y in
    let x5_85: G = K_s in
    find [unique] @i_115 <= qH1 suchthat defined(x1_71[@i_115], x2_70[@i_115], x3_69[@i_115], x4_68[@i_115], x5_67[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x1_71[@i_115]) && ((x2_88 = x2_70[@i_115]) && ((x3_87 = x3_69[@i_115]) && ((x4_86 = x4_68[@i_115]) && (x5_85 = x5_67[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind @i_114 <= NP suchthat defined(x1_77[@i_114], x2_76[@i_114], x3_75[@i_114], x4_74[@i_114], x5_73[@i_114], r1_72[@i_114]) && otheruses(r1_72[@i_114]) && ((x1_89 = x1_77[@i_114]) && ((x2_88 = x2_76[@i_114]) && ((x3_87 = x3_75[@i_114]) && ((x4_86 = x4_74[@i_114]) && (x5_85 = x5_73[@i_114]))))) then
    (
      if (auth_s = r1_72[@i_114]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind @i_113 <= NS suchthat defined(x1_83[@i_113], x2_82[@i_113], x3_81[@i_113], x4_80[@i_113], x5_79[@i_113], r1_78[@i_113]) && otheruses(r1_78[@i_113]) && ((x1_89 = x1_83[@i_113]) && ((x2_88 = x2_82[@i_113]) && ((x3_87 = x3_81[@i_113]) && ((x4_86 = x4_80[@i_113]) && (x5_85 = x5_79[@i_113]))))) then
    (
      if (auth_s = r1_78[@i_113]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind @i_112 <= NS suchthat defined(x1_89[@i_112], x2_88[@i_112], x3_87[@i_112], x4_86[@i_112], x5_85[@i_112], r1_84[@i_112]) && otheruses(r1_84[@i_112]) && ((x1_89 = x1_89[@i_112]) && ((x2_88 = x2_88[@i_112]) && ((x3_87 = x3_87[@i_112]) && ((x4_86 = x4_86[@i_112]) && (x5_85 = x5_85[@i_112]))))) then
    (
      if (auth_s = r1_84[@i_112]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind @i_111 <= NU suchthat defined(x1_95[@i_111], x2_94[@i_111], x3_93[@i_111], x4_92[@i_111], x5_91[@i_111], r1_90[@i_111]) && otheruses(r1_90[@i_111]) && ((x1_89 = x1_95[@i_111]) && ((x2_88 = x2_94[@i_111]) && ((x3_87 = x3_93[@i_111]) && ((x4_86 = x4_92[@i_111]) && (x5_85 = x5_91[@i_111]))))) then
    (
      if (auth_s = r1_90[@i_111]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    else
      new r1_84: hash1;
      if (auth_s = r1_84) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  else
    let K_s: G = exp(X_s, y) in
    let x1_83: host = U in
    let x2_82: host = S in
    let x3_81: G = X_s in
    let x4_80: G = Y in
    let x5_79: G = K_s in
    find [unique] @i_110 <= qH1 suchthat defined(x1_71[@i_110], x2_70[@i_110], x3_69[@i_110], x4_68[@i_110], x5_67[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x1_71[@i_110]) && ((x2_82 = x2_70[@i_110]) && ((x3_81 = x3_69[@i_110]) && ((x4_80 = x4_68[@i_110]) && (x5_79 = x5_67[@i_110]))))) then
    (
      if (auth_s = r1_66[@i_110]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind @i_109 <= NP suchthat defined(x1_77[@i_109], x2_76[@i_109], x3_75[@i_109], x4_74[@i_109], x5_73[@i_109], r1_72[@i_109]) && otheruses(r1_72[@i_109]) && ((x1_83 = x1_77[@i_109]) && ((x2_82 = x2_76[@i_109]) && ((x3_81 = x3_75[@i_109]) && ((x4_80 = x4_74[@i_109]) && (x5_79 = x5_73[@i_109]))))) then
    (
      if (auth_s = r1_72[@i_109]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind @i_108 <= NS suchthat defined(x1_83[@i_108], x2_82[@i_108], x3_81[@i_108], x4_80[@i_108], x5_79[@i_108], r1_78[@i_108]) && otheruses(r1_78[@i_108]) && ((x1_83 = x1_83[@i_108]) && ((x2_82 = x2_82[@i_108]) && ((x3_81 = x3_81[@i_108]) && ((x4_80 = x4_80[@i_108]) && (x5_79 = x5_79[@i_108]))))) then
    (
      if (auth_s = r1_78[@i_108]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind @i_107 <= NS suchthat defined(x1_89[@i_107], x2_88[@i_107], x3_87[@i_107], x4_86[@i_107], x5_85[@i_107], r1_84[@i_107]) && otheruses(r1_84[@i_107]) && ((x1_83 = x1_89[@i_107]) && ((x2_82 = x2_88[@i_107]) && ((x3_81 = x3_87[@i_107]) && ((x4_80 = x4_86[@i_107]) && (x5_79 = x5_85[@i_107]))))) then
    (
      if (auth_s = r1_84[@i_107]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind @i_106 <= NU suchthat defined(x1_95[@i_106], x2_94[@i_106], x3_93[@i_106], x4_92[@i_106], x5_91[@i_106], r1_90[@i_106]) && otheruses(r1_90[@i_106]) && ((x1_83 = x1_95[@i_106]) && ((x2_82 = x2_94[@i_106]) && ((x3_81 = x3_93[@i_106]) && ((x4_80 = x4_92[@i_106]) && (x5_79 = x5_91[@i_106]))))) then
    (
      if (auth_s = r1_90[@i_106]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    else
      new r1_78: hash1;
      if (auth_s = r1_78) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let x1_77: host = U in
  let x2_76: host = S in
  let x3_75: G = Xp in
  let x4_74: G = Yp in
  let x5_73: G = Kp in
  find [unique] @i_105 <= qH1 suchthat defined(x1_71[@i_105], x2_70[@i_105], x3_69[@i_105], x4_68[@i_105], x5_67[@i_105], r1_66[@i_105]) && otheruses(r1_66[@i_105]) && ((x1_77 = x1_71[@i_105]) && ((x2_76 = x2_70[@i_105]) && ((x3_75 = x3_69[@i_105]) && ((x4_74 = x4_68[@i_105]) && (x5_73 = x5_67[@i_105]))))) then
  (
    let authp: hash1 = r1_66[@i_105] in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_43], (U, Xp, S, Ystarp, authp))
  )
  orfind @i_104 <= NP suchthat defined(x1_77[@i_104], x2_76[@i_104], x3_75[@i_104], x4_74[@i_104], x5_73[@i_104], r1_72[@i_104]) && otheruses(r1_72[@i_104]) && ((x1_77 = x1_77[@i_104]) && ((x2_76 = x2_76[@i_104]) && ((x3_75 = x3_75[@i_104]) && ((x4_74 = x4_74[@i_104]) && (x5_73 = x5_73[@i_104]))))) then
  (
    let authp: hash1 = r1_72[@i_104] in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_43], (U, Xp, S, Ystarp, authp))
  )
  orfind @i_103 <= NS suchthat defined(x1_83[@i_103], x2_82[@i_103], x3_81[@i_103], x4_80[@i_103], x5_79[@i_103], r1_78[@i_103]) && otheruses(r1_78[@i_103]) && ((x1_77 = x1_83[@i_103]) && ((x2_76 = x2_82[@i_103]) && ((x3_75 = x3_81[@i_103]) && ((x4_74 = x4_80[@i_103]) && (x5_73 = x5_79[@i_103]))))) then
  (
    let authp: hash1 = r1_78[@i_103] in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_43], (U, Xp, S, Ystarp, authp))
  )
  orfind @i_102 <= NS suchthat defined(x1_89[@i_102], x2_88[@i_102], x3_87[@i_102], x4_86[@i_102], x5_85[@i_102], r1_84[@i_102]) && otheruses(r1_84[@i_102]) && ((x1_77 = x1_89[@i_102]) && ((x2_76 = x2_88[@i_102]) && ((x3_75 = x3_87[@i_102]) && ((x4_74 = x4_86[@i_102]) && (x5_73 = x5_85[@i_102]))))) then
  (
    let authp: hash1 = r1_84[@i_102] in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_43], (U, Xp, S, Ystarp, authp))
  )
  orfind @i_101 <= NU suchthat defined(x1_95[@i_101], x2_94[@i_101], x3_93[@i_101], x4_92[@i_101], x5_91[@i_101], r1_90[@i_101]) && otheruses(r1_90[@i_101]) && ((x1_77 = x1_95[@i_101]) && ((x2_76 = x2_94[@i_101]) && ((x3_75 = x3_93[@i_101]) && ((x4_74 = x4_92[@i_101]) && (x5_73 = x5_91[@i_101]))))) then
  (
    let authp: hash1 = r1_90[@i_101] in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_43], (U, Xp, S, Ystarp, authp))
  )
  else
    new r1_72: hash1;
    let authp: hash1 = r1_72 in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_43], (U, Xp, S, Ystarp, authp))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_44], enc(@2_x, @2_ke))
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_45], dec(@2_m, @2_kd))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_46], h0(x1, x2, x3, x4, x5))
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_71: host = x11 in
  let x2_70: host = x12 in
  let x3_69: G = x13 in
  let x4_68: G = x14 in
  let x5_67: G = x15 in
  find [unique] @i_100 <= qH1 suchthat defined(x1_71[@i_100], x2_70[@i_100], x3_69[@i_100], x4_68[@i_100], x5_67[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x1_71 = x1_71[@i_100]) && ((x2_70 = x2_70[@i_100]) && ((x3_69 = x3_69[@i_100]) && ((x4_68 = x4_68[@i_100]) && (x5_67 = x5_67[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], x3_75[@i_99], x4_74[@i_99], x5_73[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x1_71 = x1_77[@i_99]) && ((x2_70 = x2_76[@i_99]) && ((x3_69 = x3_75[@i_99]) && ((x4_68 = x4_74[@i_99]) && (x5_67 = x5_73[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_98 <= NS suchthat defined(x1_83[@i_98], x2_82[@i_98], x3_81[@i_98], x4_80[@i_98], x5_79[@i_98], r1_78[@i_98]) && otheruses(r1_78[@i_98]) && ((x1_71 = x1_83[@i_98]) && ((x2_70 = x2_82[@i_98]) && ((x3_69 = x3_81[@i_98]) && ((x4_68 = x4_80[@i_98]) && (x5_67 = x5_79[@i_98]))))) then
    out(c21[!_47], r1_78[@i_98])
  orfind @i_97 <= NS suchthat defined(x1_89[@i_97], x2_88[@i_97], x3_87[@i_97], x4_86[@i_97], x5_85[@i_97], r1_84[@i_97]) && otheruses(r1_84[@i_97]) && ((x1_71 = x1_89[@i_97]) && ((x2_70 = x2_88[@i_97]) && ((x3_69 = x3_87[@i_97]) && ((x4_68 = x4_86[@i_97]) && (x5_67 = x5_85[@i_97]))))) then
    out(c21[!_47], r1_84[@i_97])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], x3_93[@i_96], x4_92[@i_96], x5_91[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x1_71 = x1_95[@i_96]) && ((x2_70 = x2_94[@i_96]) && ((x3_69 = x3_93[@i_96]) && ((x4_68 = x4_92[@i_96]) && (x5_67 = x5_91[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying simplify [Excluding set(dist 3->4, proba <= 1. / |exponent| * NP + 4. * 1. / |exponent| * NS + 2. * NU * NP / |exponent| + 3. * NS * NP / |exponent| + qH1 * NP / |exponent| + 2. * NS / |hash1| + NP * NP / |exponent| + 0.5 * NS * NS / |exponent| + 0.5 * NU * NU / |exponent|)] yields

Game 4 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_95: host = U in
  let x2_94: host = S in
  let x3_93: G = X in
  let x4_92: G = Y_u in
  let x5_91: G = K_u in
  find [unique] @i_120 <= qH1 suchthat defined(x1_71[@i_120], x2_70[@i_120], x3_69[@i_120], x4_68[@i_120], x5_67[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x1_71[@i_120]) && ((x2_94 = x2_70[@i_120]) && ((x3_93 = x3_69[@i_120]) && ((x4_92 = x4_68[@i_120]) && (x5_91 = x5_67[@i_120]))))) then
  (
    let auth_u: hash1 = r1_66[@i_120] in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_41], auth_u)
  )
  else
    new r1_90: hash1;
    let auth_u: hash1 = r1_90 in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_41], auth_u)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_42], (S, Ystar));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    let x3_87: G = X_s in
    let x4_86: G = Y in
    let x5_85: G = K_s in
    find [unique] @i_115 <= qH1 suchthat defined(x1_71[@i_115], x2_70[@i_115], x3_69[@i_115], x4_68[@i_115], x5_67[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x1_71[@i_115]) && ((x2_88 = x2_70[@i_115]) && ((x3_87 = x3_69[@i_115]) && ((x4_86 = x4_68[@i_115]) && (x5_85 = x5_67[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind  suchthat defined(x4_92[j], x5_91[j], r1_90[j]) && otheruses(r1_90[j]) && ((x4_86 = x4_92[j]) && (x5_85 = x5_91[j])) then
    (
      let @i_111 <= NU = j in
      if (auth_s = r1_90[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  else
    let K_s: G = exp(X_s, y) in
    let x1_83: host = U in
    let x2_82: host = S in
    let x3_81: G = X_s in
    let x4_80: G = Y in
    let x5_79: G = K_s in
    find [unique] @i_110 <= qH1 suchthat defined(x1_71[@i_110], x2_70[@i_110], x3_69[@i_110], x4_68[@i_110], x5_67[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x1_71[@i_110]) && ((x2_82 = x2_70[@i_110]) && ((x3_81 = x3_69[@i_110]) && ((x4_80 = x4_68[@i_110]) && (x5_79 = x5_67[@i_110]))))) then
    if (auth_s = r1_66[@i_110]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let x1_77: host = U in
  let x2_76: host = S in
  let x3_75: G = Xp in
  let x4_74: G = Yp in
  let x5_73: G = Kp in
  new r1_72: hash1;
  let authp: hash1 = r1_72 in
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_43], (U, Xp, S, Ystarp, authp))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_44], enc(@2_x, @2_ke))
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_45], dec(@2_m, @2_kd))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_46], h0(x1, x2, x3, x4, x5))
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_71: host = x11 in
  let x2_70: host = x12 in
  let x3_69: G = x13 in
  let x4_68: G = x14 in
  let x5_67: G = x15 in
  find [unique] @i_100 <= qH1 suchthat defined(x1_71[@i_100], x2_70[@i_100], x3_69[@i_100], x4_68[@i_100], x5_67[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x1_71 = x1_71[@i_100]) && ((x2_70 = x2_70[@i_100]) && ((x3_69 = x3_69[@i_100]) && ((x4_68 = x4_68[@i_100]) && (x5_67 = x5_67[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], x3_75[@i_99], x4_74[@i_99], x5_73[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x1_71 = x1_77[@i_99]) && ((x2_70 = x2_76[@i_99]) && ((x3_69 = x3_75[@i_99]) && ((x4_68 = x4_74[@i_99]) && (x5_67 = x5_73[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], x3_93[@i_96], x4_92[@i_96], x5_91[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x1_71 = x1_95[@i_96]) && ((x2_70 = x2_94[@i_96]) && ((x3_69 = x3_93[@i_96]) && ((x4_68 = x4_92[@i_96]) && (x5_67 = x5_91[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying move all binders yields

Game 5 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_95: host = U in
  let x2_94: host = S in
  let x3_93: G = X in
  let x4_92: G = Y_u in
  let x5_91: G = K_u in
  find [unique] @i_120 <= qH1 suchthat defined(x1_71[@i_120], x2_70[@i_120], x3_69[@i_120], x4_68[@i_120], x5_67[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x1_71[@i_120]) && ((x2_94 = x2_70[@i_120]) && ((x3_93 = x3_69[@i_120]) && ((x4_92 = x4_68[@i_120]) && (x5_91 = x5_67[@i_120]))))) then
  (
    let auth_u: hash1 = r1_66[@i_120] in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_41], auth_u)
  )
  else
    new r1_90: hash1;
    let auth_u: hash1 = r1_90 in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_41], auth_u)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_42], (S, Ystar));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    let x3_87: G = X_s in
    let x4_86: G = Y in
    let x5_85: G = K_s in
    find [unique] @i_115 <= qH1 suchthat defined(x1_71[@i_115], x2_70[@i_115], x3_69[@i_115], x4_68[@i_115], x5_67[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x1_71[@i_115]) && ((x2_88 = x2_70[@i_115]) && ((x3_87 = x3_69[@i_115]) && ((x4_86 = x4_68[@i_115]) && (x5_85 = x5_67[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind  suchthat defined(x4_92[j], x5_91[j], r1_90[j]) && otheruses(r1_90[j]) && ((x4_86 = x4_92[j]) && (x5_85 = x5_91[j])) then
    (
      if (auth_s = r1_90[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  else
    let K_s: G = exp(X_s, y) in
    let x1_83: host = U in
    let x2_82: host = S in
    let x3_81: G = X_s in
    let x4_80: G = Y in
    let x5_79: G = K_s in
    find [unique] @i_110 <= qH1 suchthat defined(x1_71[@i_110], x2_70[@i_110], x3_69[@i_110], x4_68[@i_110], x5_67[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x1_71[@i_110]) && ((x2_82 = x2_70[@i_110]) && ((x3_81 = x3_69[@i_110]) && ((x4_80 = x4_68[@i_110]) && (x5_79 = x5_67[@i_110]))))) then
    if (auth_s = r1_66[@i_110]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let x1_77: host = U in
  let x2_76: host = S in
  let x3_75: G = Xp in
  let x4_74: G = Yp in
  let x5_73: G = Kp in
  new r1_72: hash1;
  let authp: hash1 = r1_72 in
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_43], (U, Xp, S, Ystarp, authp))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_44], enc(@2_x, @2_ke))
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_45], dec(@2_m, @2_kd))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_46], h0(x1, x2, x3, x4, x5))
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_71: host = x11 in
  let x2_70: host = x12 in
  let x3_69: G = x13 in
  let x4_68: G = x14 in
  let x5_67: G = x15 in
  find [unique] @i_100 <= qH1 suchthat defined(x1_71[@i_100], x2_70[@i_100], x3_69[@i_100], x4_68[@i_100], x5_67[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x1_71 = x1_71[@i_100]) && ((x2_70 = x2_70[@i_100]) && ((x3_69 = x3_69[@i_100]) && ((x4_68 = x4_68[@i_100]) && (x5_67 = x5_67[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], x3_75[@i_99], x4_74[@i_99], x5_73[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x1_71 = x1_77[@i_99]) && ((x2_70 = x2_76[@i_99]) && ((x3_69 = x3_75[@i_99]) && ((x4_68 = x4_74[@i_99]) && (x5_67 = x5_73[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], x3_93[@i_96], x4_92[@i_96], x5_91[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x1_71 = x1_95[@i_96]) && ((x2_70 = x2_94[@i_96]) && ((x3_69 = x3_93[@i_96]) && ((x4_68 = x4_92[@i_96]) && (x5_67 = x5_91[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of useless yields

Game 6 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_95: host = U in
  let x2_94: host = S in
  let x3_93: G = cst_G in
  let x4_92: G = cst_G in
  let x5_91: G = cst_G in
  find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], x5_67[@i_120], x4_68[@i_120], x3_69[@i_120], x2_70[@i_120], x1_71[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
  (
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
    out(c6[!_41], r1_66[@i_120])
  )
  else
    new r1_90: hash1;
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_90, sk_u);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_42], (S, Ystar));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], x5_67[@i_115], x4_68[@i_115], x3_69[@i_115], x2_70[@i_115], x1_71[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], x5_91[j], x4_92[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_90[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  else
    let K_s: G = exp(X_s, y) in
    let x1_83: host = U in
    let x2_82: host = S in
    find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y = x14[@i_110]) && (K_s = x15[@i_110]))))) then
    if (auth_s = r1_66[@i_110]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let x1_77: host = U in
  let x2_76: host = S in
  let x3_75: G = cst_G in
  let x4_74: G = cst_G in
  let x5_73: G = cst_G in
  new r1_72: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_43], (U, Xp, S, Ystarp, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_44], enc(@2_x, @2_ke))
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_45], dec(@2_m, @2_kd))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_46], h0(x1, x2, x3, x4, x5))
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_71: host = cst_host in
  let x2_70: host = cst_host in
  let x3_69: G = cst_G in
  let x4_68: G = cst_G in
  let x5_67: G = cst_G in
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], x5_67[@i_100], x4_68[@i_100], x3_69[@i_100], x2_70[@i_100], x1_71[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(Xp[@i_99], Yp[@i_99], Kp[@i_99], x5_73[@i_99], x4_74[@i_99], x3_75[@i_99], x1_77[@i_99], x2_76[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(X[@i_96], Y_u[@i_96], K_u[@i_96], x5_91[@i_96], x4_92[@i_96], x3_93[@i_96], x1_95[@i_96], x2_94[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying insert instruction let Y' = dec(Ystar, pw) in at occurrence 429 yields

Game 7 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_95: host = U in
  let x2_94: host = S in
  let x3_93: G = cst_G in
  let x4_92: G = cst_G in
  let x5_91: G = cst_G in
  find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], x5_67[@i_120], x4_68[@i_120], x3_69[@i_120], x2_70[@i_120], x1_71[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
  (
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
    out(c6[!_41], r1_66[@i_120])
  )
  else
    new r1_90: hash1;
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_90, sk_u);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_42], (S, Ystar));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], x5_67[@i_115], x4_68[@i_115], x3_69[@i_115], x2_70[@i_115], x1_71[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], x5_91[j], x4_92[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_90[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  else
    let Y': G = dec(Ystar, pw) in
    let K_s: G = exp(X_s, y) in
    let x1_83: host = U in
    let x2_82: host = S in
    find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y = x14[@i_110]) && (K_s = x15[@i_110]))))) then
    if (auth_s = r1_66[@i_110]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let x1_77: host = U in
  let x2_76: host = S in
  let x3_75: G = cst_G in
  let x4_74: G = cst_G in
  let x5_73: G = cst_G in
  new r1_72: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_43], (U, Xp, S, Ystarp, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_44], enc(@2_x, @2_ke))
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_45], dec(@2_m, @2_kd))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_46], h0(x1, x2, x3, x4, x5))
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_71: host = cst_host in
  let x2_70: host = cst_host in
  let x3_69: G = cst_G in
  let x4_68: G = cst_G in
  let x5_67: G = cst_G in
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], x5_67[@i_100], x4_68[@i_100], x3_69[@i_100], x2_70[@i_100], x1_71[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(Xp[@i_99], Yp[@i_99], Kp[@i_99], x5_73[@i_99], x4_74[@i_99], x3_75[@i_99], x1_77[@i_99], x2_76[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(X[@i_96], Y_u[@i_96], K_u[@i_96], x5_91[@i_96], x4_92[@i_96], x3_93[@i_96], x1_95[@i_96], x2_94[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying replace term at occurrence 381 with Y' yields

Game 8 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_95: host = U in
  let x2_94: host = S in
  let x3_93: G = cst_G in
  let x4_92: G = cst_G in
  let x5_91: G = cst_G in
  find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], x5_67[@i_120], x4_68[@i_120], x3_69[@i_120], x2_70[@i_120], x1_71[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
  (
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
    out(c6[!_41], r1_66[@i_120])
  )
  else
    new r1_90: hash1;
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_90, sk_u);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_42], (S, Ystar));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], x5_67[@i_115], x4_68[@i_115], x3_69[@i_115], x2_70[@i_115], x1_71[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], x5_91[j], x4_92[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_90[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  else
    let Y': G = dec(Ystar, pw) in
    let K_s: G = exp(X_s, y) in
    let x1_83: host = U in
    let x2_82: host = S in
    find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
    if (auth_s = r1_66[@i_110]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let x1_77: host = U in
  let x2_76: host = S in
  let x3_75: G = cst_G in
  let x4_74: G = cst_G in
  let x5_73: G = cst_G in
  new r1_72: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_43], (U, Xp, S, Ystarp, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_44], enc(@2_x, @2_ke))
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_45], dec(@2_m, @2_kd))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_46], h0(x1, x2, x3, x4, x5))
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_71: host = cst_host in
  let x2_70: host = cst_host in
  let x3_69: G = cst_G in
  let x4_68: G = cst_G in
  let x5_67: G = cst_G in
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], x5_67[@i_100], x4_68[@i_100], x3_69[@i_100], x2_70[@i_100], x1_71[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(Xp[@i_99], Yp[@i_99], Kp[@i_99], x5_73[@i_99], x4_74[@i_99], x3_75[@i_99], x1_77[@i_99], x2_76[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(X[@i_96], Y_u[@i_96], K_u[@i_96], x5_91[@i_96], x4_92[@i_96], x3_93[@i_96], x1_95[@i_96], x2_94[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying insert instruction find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && (U = x11[nj]) && (S = x12[nj]) && (X_s = x13[nj]) && (Y' = x14[nj]) && (auth_s = r1_66[nj]) then at occurrence 430 yields

Game 9 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_95: host = U in
  let x2_94: host = S in
  let x3_93: G = cst_G in
  let x4_92: G = cst_G in
  let x5_91: G = cst_G in
  find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], x5_67[@i_120], x4_68[@i_120], x3_69[@i_120], x2_70[@i_120], x1_71[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
  (
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
    out(c6[!_41], r1_66[@i_120])
  )
  else
    new r1_90: hash1;
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_90, sk_u);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_42], (S, Ystar));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], x5_67[@i_115], x4_68[@i_115], x3_69[@i_115], x2_70[@i_115], x1_71[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], x5_91[j], x4_92[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_90[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  else
    let Y': G = dec(Ystar, pw) in
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
    (
      let K_s: G = exp(X_s, y) in
      let x1_83: host = U in
      let x2_82: host = S in
      find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
      if (auth_s = r1_66[@i_110]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    else
      let K_s: G = exp(X_s, y) in
      let x1_83: host = U in
      let x2_82: host = S in
      find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
      if (auth_s = r1_66[@i_110]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let x1_77: host = U in
  let x2_76: host = S in
  let x3_75: G = cst_G in
  let x4_74: G = cst_G in
  let x5_73: G = cst_G in
  new r1_72: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_43], (U, Xp, S, Ystarp, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_44], enc(@2_x, @2_ke))
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_45], dec(@2_m, @2_kd))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_46], h0(x1, x2, x3, x4, x5))
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_71: host = cst_host in
  let x2_70: host = cst_host in
  let x3_69: G = cst_G in
  let x4_68: G = cst_G in
  let x5_67: G = cst_G in
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], x5_67[@i_100], x4_68[@i_100], x3_69[@i_100], x2_70[@i_100], x1_71[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(Xp[@i_99], Yp[@i_99], Kp[@i_99], x5_73[@i_99], x4_74[@i_99], x3_75[@i_99], x1_77[@i_99], x2_76[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(X[@i_96], Y_u[@i_96], K_u[@i_96], x5_91[@i_96], x4_92[@i_96], x3_93[@i_96], x1_95[@i_96], x2_94[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying insert event Auth at occurrence 537 [Excluding set(event Auth in game 10)] yields

Game 10 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_95: host = U in
  let x2_94: host = S in
  let x3_93: G = cst_G in
  let x4_92: G = cst_G in
  let x5_91: G = cst_G in
  find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], x5_67[@i_120], x4_68[@i_120], x3_69[@i_120], x2_70[@i_120], x1_71[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
  (
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
    out(c6[!_41], r1_66[@i_120])
  )
  else
    new r1_90: hash1;
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_90, sk_u);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_42], (S, Ystar));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], x5_67[@i_115], x4_68[@i_115], x3_69[@i_115], x2_70[@i_115], x1_71[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], x5_91[j], x4_92[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_90[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  else
    let Y': G = dec(Ystar, pw) in
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    else
      let K_s: G = exp(X_s, y) in
      let x1_83: host = U in
      let x2_82: host = S in
      find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
      if (auth_s = r1_66[@i_110]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let x1_77: host = U in
  let x2_76: host = S in
  let x3_75: G = cst_G in
  let x4_74: G = cst_G in
  let x5_73: G = cst_G in
  new r1_72: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_43], (U, Xp, S, Ystarp, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_44], enc(@2_x, @2_ke))
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_45], dec(@2_m, @2_kd))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_46], h0(x1, x2, x3, x4, x5))
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_71: host = cst_host in
  let x2_70: host = cst_host in
  let x3_69: G = cst_G in
  let x4_68: G = cst_G in
  let x5_67: G = cst_G in
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], x5_67[@i_100], x4_68[@i_100], x3_69[@i_100], x2_70[@i_100], x1_71[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(Xp[@i_99], Yp[@i_99], Kp[@i_99], x5_73[@i_99], x4_74[@i_99], x3_75[@i_99], x1_77[@i_99], x2_76[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(X[@i_96], Y_u[@i_96], K_u[@i_96], x5_91[@i_96], x4_92[@i_96], x3_93[@i_96], x1_95[@i_96], x2_94[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_63: G, @2_ke_62: passwd) := let @2_x: G = @2_x_63 in let @2_ke: passwd = @2_ke_62 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && otheruses(@2_x[@2_j_33] -> @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && otheruses(@2_m[@2_k_34] -> @2_r4[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_65: G, @2_kd_64: passwd) := let @2_m: G = @2_m_65 in let @2_kd: passwd = @2_kd_64 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && otheruses(@2_x[@2_j_35] -> @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && otheruses(@2_m[@2_k_36] -> @2_r4[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
 [Excluding set(dist 10->11, proba <= (NP * NP + 2. * qE * NP + 2. * NU * NP + 4. * NS * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 4. * NS * qE + 2. * qD * qE + NU * NU + 4. * NS * NU + 2. * qD * NU + 4. * NS * NS + 4. * qD * NS + qD * qD + -1. * NP + -1. * qE + -1. * NU + -2. * NS + -1. * qD) / |G|)] yields

Game 11 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let @2_m_174: G = Ystar_u in
  let @2_kd_173: passwd = pw in
  find [unique] @i_246 <= qD suchthat defined(@2_r4_157[@i_246], @2_m_159[@i_246], @2_kd_158[@i_246]) && otheruses(@2_m_159[@i_246] -> @2_r4_157[@i_246]) && ((@2_m_174 = @2_m_159[@i_246]) && (@2_kd_173 = @2_kd_158[@i_246])) then
  (
    let Y_u: G = @2_r4_157[@i_246] in
    let K_u: G = exp(Y_u, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    let x3_93: G = cst_G in
    let x4_92: G = cst_G in
    let x5_91: G = cst_G in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], x5_67[@i_120], x4_68[@i_120], x3_69[@i_120], x2_70[@i_120], x1_71[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_243 <= NS suchthat defined(@2_r4_166[@i_243], @2_m_168[@i_243], @2_kd_167[@i_243]) && otheruses(@2_m_168[@i_243] -> @2_r4_166[@i_243]) && ((@2_m_174 = @2_m_168[@i_243]) && (@2_kd_173 = @2_kd_167[@i_243])) then
  (
    let Y_u: G = @2_r4_166[@i_243] in
    let K_u: G = exp(Y_u, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    let x3_93: G = cst_G in
    let x4_92: G = cst_G in
    let x5_91: G = cst_G in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], x5_67[@i_120], x4_68[@i_120], x3_69[@i_120], x2_70[@i_120], x1_71[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(@2_r4_172[@i_241], @2_m_174[@i_241], @2_kd_173[@i_241]) && otheruses(@2_m_174[@i_241] -> @2_r4_172[@i_241]) && ((@2_m_174 = @2_m_174[@i_241]) && (@2_kd_173 = @2_kd_173[@i_241])) then
  (
    let Y_u: G = @2_r4_172[@i_241] in
    let K_u: G = exp(Y_u, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    let x3_93: G = cst_G in
    let x4_92: G = cst_G in
    let x5_91: G = cst_G in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], x5_67[@i_120], x4_68[@i_120], x3_69[@i_120], x2_70[@i_120], x1_71[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_x_162[@i_239], @2_ke_161[@i_239], @2_r2_160[@i_239]) && otheruses(@2_x_162[@i_239] -> @2_r2_160[@i_239]) && ((@2_m_174 = @2_r2_160[@i_239]) && (@2_kd_173 = @2_ke_161[@i_239])) then
  (
    let Y_u: G = @2_x_162[@i_239] in
    let K_u: G = exp(Y_u, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    let x3_93: G = cst_G in
    let x4_92: G = cst_G in
    let x5_91: G = cst_G in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], x5_67[@i_120], x4_68[@i_120], x3_69[@i_120], x2_70[@i_120], x1_71[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_238 <= NP suchthat defined(@2_x_165[@i_238], @2_ke_164[@i_238], @2_r2_163[@i_238]) && otheruses(@2_x_165[@i_238] -> @2_r2_163[@i_238]) && ((@2_m_174 = @2_r2_163[@i_238]) && (@2_kd_173 = @2_ke_164[@i_238])) then
  (
    let Y_u: G = @2_x_165[@i_238] in
    let K_u: G = exp(Y_u, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    let x3_93: G = cst_G in
    let x4_92: G = cst_G in
    let x5_91: G = cst_G in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], x5_67[@i_120], x4_68[@i_120], x3_69[@i_120], x2_70[@i_120], x1_71[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_x_171[@i_236], @2_ke_170[@i_236], @2_r2_169[@i_236]) && otheruses(@2_x_171[@i_236] -> @2_r2_169[@i_236]) && ((@2_m_174 = @2_r2_169[@i_236]) && (@2_kd_173 = @2_ke_170[@i_236])) then
  (
    let Y_u: G = @2_x_171[@i_236] in
    let K_u: G = exp(Y_u, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    let x3_93: G = cst_G in
    let x4_92: G = cst_G in
    let x5_91: G = cst_G in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], x5_67[@i_120], x4_68[@i_120], x3_69[@i_120], x2_70[@i_120], x1_71[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  else
    new @2_r4_172: G;
    let Y_u: G = @2_r4_172 in
    let K_u: G = exp(Y_u, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    let x3_93: G = cst_G in
    let x4_92: G = cst_G in
    let x5_91: G = cst_G in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], x5_67[@i_120], x4_68[@i_120], x3_69[@i_120], x2_70[@i_120], x1_71[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let @2_x_171: G = Y in
  let @2_ke_170: passwd = pw in
  find [unique] @i_234 <= qD suchthat defined(@2_r4_157[@i_234], @2_m_159[@i_234], @2_kd_158[@i_234]) && otheruses(@2_m_159[@i_234] -> @2_r4_157[@i_234]) && ((@2_x_171 = @2_r4_157[@i_234]) && (@2_ke_170 = @2_kd_158[@i_234])) then
  (
    let Ystar: G = @2_m_159[@i_234] in
    out(c4[!_42], (S, Ystar));
    in(c7[!_42], auth_s: hash1);
    find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
    (
      let K_s: G = exp(g, mult(x[j], y)) in
      let x1_89: host = U in
      let x2_88: host = S in
      find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], x5_67[@i_115], x4_68[@i_115], x3_69[@i_115], x2_70[@i_115], x1_71[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
      (
        if (auth_s = r1_66[@i_115]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind  suchthat defined(Y_u[j], K_u[j], x5_91[j], x4_92[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
      (
        if (auth_s = r1_90[j]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
    )
    else
      let @2_m_168: G = Ystar in
      let @2_kd_167: passwd = pw in
      find [unique] @i_222 <= qD suchthat defined(@2_r4_157[@i_222], @2_m_159[@i_222], @2_kd_158[@i_222]) && otheruses(@2_m_159[@i_222] -> @2_r4_157[@i_222]) && ((@2_m_168 = @2_m_159[@i_222]) && (@2_kd_167 = @2_kd_158[@i_222])) then
      (
        let Y': G = @2_r4_157[@i_222] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_219 <= NS suchthat defined(@2_r4_166[@i_219], @2_m_168[@i_219], @2_kd_167[@i_219]) && otheruses(@2_m_168[@i_219] -> @2_r4_166[@i_219]) && ((@2_m_168 = @2_m_168[@i_219]) && (@2_kd_167 = @2_kd_167[@i_219])) then
      (
        let Y': G = @2_r4_166[@i_219] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_217 <= NU suchthat defined(@2_r4_172[@i_217], @2_m_174[@i_217], @2_kd_173[@i_217]) && otheruses(@2_m_174[@i_217] -> @2_r4_172[@i_217]) && ((@2_m_168 = @2_m_174[@i_217]) && (@2_kd_167 = @2_kd_173[@i_217])) then
      (
        let Y': G = @2_r4_172[@i_217] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_215 <= qE suchthat defined(@2_x_162[@i_215], @2_ke_161[@i_215], @2_r2_160[@i_215]) && otheruses(@2_x_162[@i_215] -> @2_r2_160[@i_215]) && ((@2_m_168 = @2_r2_160[@i_215]) && (@2_kd_167 = @2_ke_161[@i_215])) then
      (
        let Y': G = @2_x_162[@i_215] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_214 <= NP suchthat defined(@2_x_165[@i_214], @2_ke_164[@i_214], @2_r2_163[@i_214]) && otheruses(@2_x_165[@i_214] -> @2_r2_163[@i_214]) && ((@2_m_168 = @2_r2_163[@i_214]) && (@2_kd_167 = @2_ke_164[@i_214])) then
      (
        let Y': G = @2_x_165[@i_214] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_212 <= NS suchthat defined(@2_x_171[@i_212], @2_ke_170[@i_212], @2_r2_169[@i_212]) && otheruses(@2_x_171[@i_212] -> @2_r2_169[@i_212]) && ((@2_m_168 = @2_r2_169[@i_212]) && (@2_kd_167 = @2_ke_170[@i_212])) then
      (
        let Y': G = @2_x_171[@i_212] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      else
        new @2_r4_166: G;
        let Y': G = @2_r4_166 in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  orfind @i_231 <= NS suchthat defined(@2_r4_166[@i_231], @2_m_168[@i_231], @2_kd_167[@i_231]) && otheruses(@2_m_168[@i_231] -> @2_r4_166[@i_231]) && ((@2_x_171 = @2_r4_166[@i_231]) && (@2_ke_170 = @2_kd_167[@i_231])) then
  (
    let Ystar: G = @2_m_168[@i_231] in
    out(c4[!_42], (S, Ystar));
    in(c7[!_42], auth_s: hash1);
    find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
    (
      let K_s: G = exp(g, mult(x[j], y)) in
      let x1_89: host = U in
      let x2_88: host = S in
      find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], x5_67[@i_115], x4_68[@i_115], x3_69[@i_115], x2_70[@i_115], x1_71[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
      (
        if (auth_s = r1_66[@i_115]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind  suchthat defined(Y_u[j], K_u[j], x5_91[j], x4_92[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
      (
        if (auth_s = r1_90[j]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
    )
    else
      let @2_m_168: G = Ystar in
      let @2_kd_167: passwd = pw in
      find [unique] @i_222 <= qD suchthat defined(@2_r4_157[@i_222], @2_m_159[@i_222], @2_kd_158[@i_222]) && otheruses(@2_m_159[@i_222] -> @2_r4_157[@i_222]) && ((@2_m_168 = @2_m_159[@i_222]) && (@2_kd_167 = @2_kd_158[@i_222])) then
      (
        let Y': G = @2_r4_157[@i_222] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_219 <= NS suchthat defined(@2_r4_166[@i_219], @2_m_168[@i_219], @2_kd_167[@i_219]) && otheruses(@2_m_168[@i_219] -> @2_r4_166[@i_219]) && ((@2_m_168 = @2_m_168[@i_219]) && (@2_kd_167 = @2_kd_167[@i_219])) then
      (
        let Y': G = @2_r4_166[@i_219] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_217 <= NU suchthat defined(@2_r4_172[@i_217], @2_m_174[@i_217], @2_kd_173[@i_217]) && otheruses(@2_m_174[@i_217] -> @2_r4_172[@i_217]) && ((@2_m_168 = @2_m_174[@i_217]) && (@2_kd_167 = @2_kd_173[@i_217])) then
      (
        let Y': G = @2_r4_172[@i_217] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_215 <= qE suchthat defined(@2_x_162[@i_215], @2_ke_161[@i_215], @2_r2_160[@i_215]) && otheruses(@2_x_162[@i_215] -> @2_r2_160[@i_215]) && ((@2_m_168 = @2_r2_160[@i_215]) && (@2_kd_167 = @2_ke_161[@i_215])) then
      (
        let Y': G = @2_x_162[@i_215] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_214 <= NP suchthat defined(@2_x_165[@i_214], @2_ke_164[@i_214], @2_r2_163[@i_214]) && otheruses(@2_x_165[@i_214] -> @2_r2_163[@i_214]) && ((@2_m_168 = @2_r2_163[@i_214]) && (@2_kd_167 = @2_ke_164[@i_214])) then
      (
        let Y': G = @2_x_165[@i_214] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_212 <= NS suchthat defined(@2_x_171[@i_212], @2_ke_170[@i_212], @2_r2_169[@i_212]) && otheruses(@2_x_171[@i_212] -> @2_r2_169[@i_212]) && ((@2_m_168 = @2_r2_169[@i_212]) && (@2_kd_167 = @2_ke_170[@i_212])) then
      (
        let Y': G = @2_x_171[@i_212] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      else
        new @2_r4_166: G;
        let Y': G = @2_r4_166 in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  orfind @i_229 <= NU suchthat defined(@2_r4_172[@i_229], @2_m_174[@i_229], @2_kd_173[@i_229]) && otheruses(@2_m_174[@i_229] -> @2_r4_172[@i_229]) && ((@2_x_171 = @2_r4_172[@i_229]) && (@2_ke_170 = @2_kd_173[@i_229])) then
  (
    let Ystar: G = @2_m_174[@i_229] in
    out(c4[!_42], (S, Ystar));
    in(c7[!_42], auth_s: hash1);
    find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
    (
      let K_s: G = exp(g, mult(x[j], y)) in
      let x1_89: host = U in
      let x2_88: host = S in
      find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], x5_67[@i_115], x4_68[@i_115], x3_69[@i_115], x2_70[@i_115], x1_71[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
      (
        if (auth_s = r1_66[@i_115]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind  suchthat defined(Y_u[j], K_u[j], x5_91[j], x4_92[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
      (
        if (auth_s = r1_90[j]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
    )
    else
      let @2_m_168: G = Ystar in
      let @2_kd_167: passwd = pw in
      find [unique] @i_222 <= qD suchthat defined(@2_r4_157[@i_222], @2_m_159[@i_222], @2_kd_158[@i_222]) && otheruses(@2_m_159[@i_222] -> @2_r4_157[@i_222]) && ((@2_m_168 = @2_m_159[@i_222]) && (@2_kd_167 = @2_kd_158[@i_222])) then
      (
        let Y': G = @2_r4_157[@i_222] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_219 <= NS suchthat defined(@2_r4_166[@i_219], @2_m_168[@i_219], @2_kd_167[@i_219]) && otheruses(@2_m_168[@i_219] -> @2_r4_166[@i_219]) && ((@2_m_168 = @2_m_168[@i_219]) && (@2_kd_167 = @2_kd_167[@i_219])) then
      (
        let Y': G = @2_r4_166[@i_219] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_217 <= NU suchthat defined(@2_r4_172[@i_217], @2_m_174[@i_217], @2_kd_173[@i_217]) && otheruses(@2_m_174[@i_217] -> @2_r4_172[@i_217]) && ((@2_m_168 = @2_m_174[@i_217]) && (@2_kd_167 = @2_kd_173[@i_217])) then
      (
        let Y': G = @2_r4_172[@i_217] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_215 <= qE suchthat defined(@2_x_162[@i_215], @2_ke_161[@i_215], @2_r2_160[@i_215]) && otheruses(@2_x_162[@i_215] -> @2_r2_160[@i_215]) && ((@2_m_168 = @2_r2_160[@i_215]) && (@2_kd_167 = @2_ke_161[@i_215])) then
      (
        let Y': G = @2_x_162[@i_215] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_214 <= NP suchthat defined(@2_x_165[@i_214], @2_ke_164[@i_214], @2_r2_163[@i_214]) && otheruses(@2_x_165[@i_214] -> @2_r2_163[@i_214]) && ((@2_m_168 = @2_r2_163[@i_214]) && (@2_kd_167 = @2_ke_164[@i_214])) then
      (
        let Y': G = @2_x_165[@i_214] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_212 <= NS suchthat defined(@2_x_171[@i_212], @2_ke_170[@i_212], @2_r2_169[@i_212]) && otheruses(@2_x_171[@i_212] -> @2_r2_169[@i_212]) && ((@2_m_168 = @2_r2_169[@i_212]) && (@2_kd_167 = @2_ke_170[@i_212])) then
      (
        let Y': G = @2_x_171[@i_212] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      else
        new @2_r4_166: G;
        let Y': G = @2_r4_166 in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  orfind @i_227 <= qE suchthat defined(@2_x_162[@i_227], @2_ke_161[@i_227], @2_r2_160[@i_227]) && otheruses(@2_x_162[@i_227] -> @2_r2_160[@i_227]) && ((@2_x_171 = @2_x_162[@i_227]) && (@2_ke_170 = @2_ke_161[@i_227])) then
  (
    let Ystar: G = @2_r2_160[@i_227] in
    out(c4[!_42], (S, Ystar));
    in(c7[!_42], auth_s: hash1);
    find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
    (
      let K_s: G = exp(g, mult(x[j], y)) in
      let x1_89: host = U in
      let x2_88: host = S in
      find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], x5_67[@i_115], x4_68[@i_115], x3_69[@i_115], x2_70[@i_115], x1_71[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
      (
        if (auth_s = r1_66[@i_115]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind  suchthat defined(Y_u[j], K_u[j], x5_91[j], x4_92[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
      (
        if (auth_s = r1_90[j]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
    )
    else
      let @2_m_168: G = Ystar in
      let @2_kd_167: passwd = pw in
      find [unique] @i_222 <= qD suchthat defined(@2_r4_157[@i_222], @2_m_159[@i_222], @2_kd_158[@i_222]) && otheruses(@2_m_159[@i_222] -> @2_r4_157[@i_222]) && ((@2_m_168 = @2_m_159[@i_222]) && (@2_kd_167 = @2_kd_158[@i_222])) then
      (
        let Y': G = @2_r4_157[@i_222] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_219 <= NS suchthat defined(@2_r4_166[@i_219], @2_m_168[@i_219], @2_kd_167[@i_219]) && otheruses(@2_m_168[@i_219] -> @2_r4_166[@i_219]) && ((@2_m_168 = @2_m_168[@i_219]) && (@2_kd_167 = @2_kd_167[@i_219])) then
      (
        let Y': G = @2_r4_166[@i_219] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_217 <= NU suchthat defined(@2_r4_172[@i_217], @2_m_174[@i_217], @2_kd_173[@i_217]) && otheruses(@2_m_174[@i_217] -> @2_r4_172[@i_217]) && ((@2_m_168 = @2_m_174[@i_217]) && (@2_kd_167 = @2_kd_173[@i_217])) then
      (
        let Y': G = @2_r4_172[@i_217] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_215 <= qE suchthat defined(@2_x_162[@i_215], @2_ke_161[@i_215], @2_r2_160[@i_215]) && otheruses(@2_x_162[@i_215] -> @2_r2_160[@i_215]) && ((@2_m_168 = @2_r2_160[@i_215]) && (@2_kd_167 = @2_ke_161[@i_215])) then
      (
        let Y': G = @2_x_162[@i_215] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_214 <= NP suchthat defined(@2_x_165[@i_214], @2_ke_164[@i_214], @2_r2_163[@i_214]) && otheruses(@2_x_165[@i_214] -> @2_r2_163[@i_214]) && ((@2_m_168 = @2_r2_163[@i_214]) && (@2_kd_167 = @2_ke_164[@i_214])) then
      (
        let Y': G = @2_x_165[@i_214] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_212 <= NS suchthat defined(@2_x_171[@i_212], @2_ke_170[@i_212], @2_r2_169[@i_212]) && otheruses(@2_x_171[@i_212] -> @2_r2_169[@i_212]) && ((@2_m_168 = @2_r2_169[@i_212]) && (@2_kd_167 = @2_ke_170[@i_212])) then
      (
        let Y': G = @2_x_171[@i_212] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      else
        new @2_r4_166: G;
        let Y': G = @2_r4_166 in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  orfind @i_226 <= NP suchthat defined(@2_x_165[@i_226], @2_ke_164[@i_226], @2_r2_163[@i_226]) && otheruses(@2_x_165[@i_226] -> @2_r2_163[@i_226]) && ((@2_x_171 = @2_x_165[@i_226]) && (@2_ke_170 = @2_ke_164[@i_226])) then
  (
    let Ystar: G = @2_r2_163[@i_226] in
    out(c4[!_42], (S, Ystar));
    in(c7[!_42], auth_s: hash1);
    find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
    (
      let K_s: G = exp(g, mult(x[j], y)) in
      let x1_89: host = U in
      let x2_88: host = S in
      find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], x5_67[@i_115], x4_68[@i_115], x3_69[@i_115], x2_70[@i_115], x1_71[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
      (
        if (auth_s = r1_66[@i_115]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind  suchthat defined(Y_u[j], K_u[j], x5_91[j], x4_92[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
      (
        if (auth_s = r1_90[j]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
    )
    else
      let @2_m_168: G = Ystar in
      let @2_kd_167: passwd = pw in
      find [unique] @i_222 <= qD suchthat defined(@2_r4_157[@i_222], @2_m_159[@i_222], @2_kd_158[@i_222]) && otheruses(@2_m_159[@i_222] -> @2_r4_157[@i_222]) && ((@2_m_168 = @2_m_159[@i_222]) && (@2_kd_167 = @2_kd_158[@i_222])) then
      (
        let Y': G = @2_r4_157[@i_222] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_219 <= NS suchthat defined(@2_r4_166[@i_219], @2_m_168[@i_219], @2_kd_167[@i_219]) && otheruses(@2_m_168[@i_219] -> @2_r4_166[@i_219]) && ((@2_m_168 = @2_m_168[@i_219]) && (@2_kd_167 = @2_kd_167[@i_219])) then
      (
        let Y': G = @2_r4_166[@i_219] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_217 <= NU suchthat defined(@2_r4_172[@i_217], @2_m_174[@i_217], @2_kd_173[@i_217]) && otheruses(@2_m_174[@i_217] -> @2_r4_172[@i_217]) && ((@2_m_168 = @2_m_174[@i_217]) && (@2_kd_167 = @2_kd_173[@i_217])) then
      (
        let Y': G = @2_r4_172[@i_217] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_215 <= qE suchthat defined(@2_x_162[@i_215], @2_ke_161[@i_215], @2_r2_160[@i_215]) && otheruses(@2_x_162[@i_215] -> @2_r2_160[@i_215]) && ((@2_m_168 = @2_r2_160[@i_215]) && (@2_kd_167 = @2_ke_161[@i_215])) then
      (
        let Y': G = @2_x_162[@i_215] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_214 <= NP suchthat defined(@2_x_165[@i_214], @2_ke_164[@i_214], @2_r2_163[@i_214]) && otheruses(@2_x_165[@i_214] -> @2_r2_163[@i_214]) && ((@2_m_168 = @2_r2_163[@i_214]) && (@2_kd_167 = @2_ke_164[@i_214])) then
      (
        let Y': G = @2_x_165[@i_214] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_212 <= NS suchthat defined(@2_x_171[@i_212], @2_ke_170[@i_212], @2_r2_169[@i_212]) && otheruses(@2_x_171[@i_212] -> @2_r2_169[@i_212]) && ((@2_m_168 = @2_r2_169[@i_212]) && (@2_kd_167 = @2_ke_170[@i_212])) then
      (
        let Y': G = @2_x_171[@i_212] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      else
        new @2_r4_166: G;
        let Y': G = @2_r4_166 in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  orfind @i_224 <= NS suchthat defined(@2_x_171[@i_224], @2_ke_170[@i_224], @2_r2_169[@i_224]) && otheruses(@2_x_171[@i_224] -> @2_r2_169[@i_224]) && ((@2_x_171 = @2_x_171[@i_224]) && (@2_ke_170 = @2_ke_170[@i_224])) then
  (
    let Ystar: G = @2_r2_169[@i_224] in
    out(c4[!_42], (S, Ystar));
    in(c7[!_42], auth_s: hash1);
    find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
    (
      let K_s: G = exp(g, mult(x[j], y)) in
      let x1_89: host = U in
      let x2_88: host = S in
      find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], x5_67[@i_115], x4_68[@i_115], x3_69[@i_115], x2_70[@i_115], x1_71[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
      (
        if (auth_s = r1_66[@i_115]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind  suchthat defined(Y_u[j], K_u[j], x5_91[j], x4_92[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
      (
        if (auth_s = r1_90[j]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
    )
    else
      let @2_m_168: G = Ystar in
      let @2_kd_167: passwd = pw in
      find [unique] @i_222 <= qD suchthat defined(@2_r4_157[@i_222], @2_m_159[@i_222], @2_kd_158[@i_222]) && otheruses(@2_m_159[@i_222] -> @2_r4_157[@i_222]) && ((@2_m_168 = @2_m_159[@i_222]) && (@2_kd_167 = @2_kd_158[@i_222])) then
      (
        let Y': G = @2_r4_157[@i_222] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_219 <= NS suchthat defined(@2_r4_166[@i_219], @2_m_168[@i_219], @2_kd_167[@i_219]) && otheruses(@2_m_168[@i_219] -> @2_r4_166[@i_219]) && ((@2_m_168 = @2_m_168[@i_219]) && (@2_kd_167 = @2_kd_167[@i_219])) then
      (
        let Y': G = @2_r4_166[@i_219] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_217 <= NU suchthat defined(@2_r4_172[@i_217], @2_m_174[@i_217], @2_kd_173[@i_217]) && otheruses(@2_m_174[@i_217] -> @2_r4_172[@i_217]) && ((@2_m_168 = @2_m_174[@i_217]) && (@2_kd_167 = @2_kd_173[@i_217])) then
      (
        let Y': G = @2_r4_172[@i_217] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_215 <= qE suchthat defined(@2_x_162[@i_215], @2_ke_161[@i_215], @2_r2_160[@i_215]) && otheruses(@2_x_162[@i_215] -> @2_r2_160[@i_215]) && ((@2_m_168 = @2_r2_160[@i_215]) && (@2_kd_167 = @2_ke_161[@i_215])) then
      (
        let Y': G = @2_x_162[@i_215] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_214 <= NP suchthat defined(@2_x_165[@i_214], @2_ke_164[@i_214], @2_r2_163[@i_214]) && otheruses(@2_x_165[@i_214] -> @2_r2_163[@i_214]) && ((@2_m_168 = @2_r2_163[@i_214]) && (@2_kd_167 = @2_ke_164[@i_214])) then
      (
        let Y': G = @2_x_165[@i_214] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_212 <= NS suchthat defined(@2_x_171[@i_212], @2_ke_170[@i_212], @2_r2_169[@i_212]) && otheruses(@2_x_171[@i_212] -> @2_r2_169[@i_212]) && ((@2_m_168 = @2_r2_169[@i_212]) && (@2_kd_167 = @2_ke_170[@i_212])) then
      (
        let Y': G = @2_x_171[@i_212] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      else
        new @2_r4_166: G;
        let Y': G = @2_r4_166 in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  else
    new @2_r2_169: G;
    let Ystar: G = @2_r2_169 in
    out(c4[!_42], (S, Ystar));
    in(c7[!_42], auth_s: hash1);
    find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
    (
      let K_s: G = exp(g, mult(x[j], y)) in
      let x1_89: host = U in
      let x2_88: host = S in
      find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], x5_67[@i_115], x4_68[@i_115], x3_69[@i_115], x2_70[@i_115], x1_71[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
      (
        if (auth_s = r1_66[@i_115]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind  suchthat defined(Y_u[j], K_u[j], x5_91[j], x4_92[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
      (
        if (auth_s = r1_90[j]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
    )
    else
      let @2_m_168: G = Ystar in
      let @2_kd_167: passwd = pw in
      find [unique] @i_222 <= qD suchthat defined(@2_r4_157[@i_222], @2_m_159[@i_222], @2_kd_158[@i_222]) && otheruses(@2_m_159[@i_222] -> @2_r4_157[@i_222]) && ((@2_m_168 = @2_m_159[@i_222]) && (@2_kd_167 = @2_kd_158[@i_222])) then
      (
        let Y': G = @2_r4_157[@i_222] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_219 <= NS suchthat defined(@2_r4_166[@i_219], @2_m_168[@i_219], @2_kd_167[@i_219]) && otheruses(@2_m_168[@i_219] -> @2_r4_166[@i_219]) && ((@2_m_168 = @2_m_168[@i_219]) && (@2_kd_167 = @2_kd_167[@i_219])) then
      (
        let Y': G = @2_r4_166[@i_219] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_217 <= NU suchthat defined(@2_r4_172[@i_217], @2_m_174[@i_217], @2_kd_173[@i_217]) && otheruses(@2_m_174[@i_217] -> @2_r4_172[@i_217]) && ((@2_m_168 = @2_m_174[@i_217]) && (@2_kd_167 = @2_kd_173[@i_217])) then
      (
        let Y': G = @2_r4_172[@i_217] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_215 <= qE suchthat defined(@2_x_162[@i_215], @2_ke_161[@i_215], @2_r2_160[@i_215]) && otheruses(@2_x_162[@i_215] -> @2_r2_160[@i_215]) && ((@2_m_168 = @2_r2_160[@i_215]) && (@2_kd_167 = @2_ke_161[@i_215])) then
      (
        let Y': G = @2_x_162[@i_215] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_214 <= NP suchthat defined(@2_x_165[@i_214], @2_ke_164[@i_214], @2_r2_163[@i_214]) && otheruses(@2_x_165[@i_214] -> @2_r2_163[@i_214]) && ((@2_m_168 = @2_r2_163[@i_214]) && (@2_kd_167 = @2_ke_164[@i_214])) then
      (
        let Y': G = @2_x_165[@i_214] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_212 <= NS suchthat defined(@2_x_171[@i_212], @2_ke_170[@i_212], @2_r2_169[@i_212]) && otheruses(@2_x_171[@i_212] -> @2_r2_169[@i_212]) && ((@2_m_168 = @2_r2_169[@i_212]) && (@2_kd_167 = @2_ke_170[@i_212])) then
      (
        let Y': G = @2_x_171[@i_212] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      else
        new @2_r4_166: G;
        let Y': G = @2_r4_166 in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let @2_x_165: G = Yp in
  let @2_ke_164: passwd = pw in
  find [unique] @i_210 <= qD suchthat defined(@2_r4_157[@i_210], @2_m_159[@i_210], @2_kd_158[@i_210]) && otheruses(@2_m_159[@i_210] -> @2_r4_157[@i_210]) && ((@2_x_165 = @2_r4_157[@i_210]) && (@2_ke_164 = @2_kd_158[@i_210])) then
  (
    let Ystarp: G = @2_m_159[@i_210] in
    let x1_77: host = U in
    let x2_76: host = S in
    let x3_75: G = cst_G in
    let x4_74: G = cst_G in
    let x5_73: G = cst_G in
    new r1_72: hash1;
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_43], (U, Xp, S, Ystarp, r1_72))
  )
  orfind @i_207 <= NS suchthat defined(@2_r4_166[@i_207], @2_m_168[@i_207], @2_kd_167[@i_207]) && otheruses(@2_m_168[@i_207] -> @2_r4_166[@i_207]) && ((@2_x_165 = @2_r4_166[@i_207]) && (@2_ke_164 = @2_kd_167[@i_207])) then
  (
    let Ystarp: G = @2_m_168[@i_207] in
    let x1_77: host = U in
    let x2_76: host = S in
    let x3_75: G = cst_G in
    let x4_74: G = cst_G in
    let x5_73: G = cst_G in
    new r1_72: hash1;
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_43], (U, Xp, S, Ystarp, r1_72))
  )
  orfind @i_205 <= NU suchthat defined(@2_r4_172[@i_205], @2_m_174[@i_205], @2_kd_173[@i_205]) && otheruses(@2_m_174[@i_205] -> @2_r4_172[@i_205]) && ((@2_x_165 = @2_r4_172[@i_205]) && (@2_ke_164 = @2_kd_173[@i_205])) then
  (
    let Ystarp: G = @2_m_174[@i_205] in
    let x1_77: host = U in
    let x2_76: host = S in
    let x3_75: G = cst_G in
    let x4_74: G = cst_G in
    let x5_73: G = cst_G in
    new r1_72: hash1;
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_43], (U, Xp, S, Ystarp, r1_72))
  )
  orfind @i_203 <= qE suchthat defined(@2_x_162[@i_203], @2_ke_161[@i_203], @2_r2_160[@i_203]) && otheruses(@2_x_162[@i_203] -> @2_r2_160[@i_203]) && ((@2_x_165 = @2_x_162[@i_203]) && (@2_ke_164 = @2_ke_161[@i_203])) then
  (
    let Ystarp: G = @2_r2_160[@i_203] in
    let x1_77: host = U in
    let x2_76: host = S in
    let x3_75: G = cst_G in
    let x4_74: G = cst_G in
    let x5_73: G = cst_G in
    new r1_72: hash1;
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_43], (U, Xp, S, Ystarp, r1_72))
  )
  orfind @i_202 <= NP suchthat defined(@2_x_165[@i_202], @2_ke_164[@i_202], @2_r2_163[@i_202]) && otheruses(@2_x_165[@i_202] -> @2_r2_163[@i_202]) && ((@2_x_165 = @2_x_165[@i_202]) && (@2_ke_164 = @2_ke_164[@i_202])) then
  (
    let Ystarp: G = @2_r2_163[@i_202] in
    let x1_77: host = U in
    let x2_76: host = S in
    let x3_75: G = cst_G in
    let x4_74: G = cst_G in
    let x5_73: G = cst_G in
    new r1_72: hash1;
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_43], (U, Xp, S, Ystarp, r1_72))
  )
  orfind @i_200 <= NS suchthat defined(@2_x_171[@i_200], @2_ke_170[@i_200], @2_r2_169[@i_200]) && otheruses(@2_x_171[@i_200] -> @2_r2_169[@i_200]) && ((@2_x_165 = @2_x_171[@i_200]) && (@2_ke_164 = @2_ke_170[@i_200])) then
  (
    let Ystarp: G = @2_r2_169[@i_200] in
    let x1_77: host = U in
    let x2_76: host = S in
    let x3_75: G = cst_G in
    let x4_74: G = cst_G in
    let x5_73: G = cst_G in
    new r1_72: hash1;
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_43], (U, Xp, S, Ystarp, r1_72))
  )
  else
    new @2_r2_163: G;
    let Ystarp: G = @2_r2_163 in
    let x1_77: host = U in
    let x2_76: host = S in
    let x3_75: G = cst_G in
    let x4_74: G = cst_G in
    let x5_73: G = cst_G in
    new r1_72: hash1;
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_43], (U, Xp, S, Ystarp, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  let @2_x_162: G = @2_x in
  let @2_ke_161: passwd = @2_ke in
  find [unique] @i_198 <= qD suchthat defined(@2_r4_157[@i_198], @2_m_159[@i_198], @2_kd_158[@i_198]) && otheruses(@2_m_159[@i_198] -> @2_r4_157[@i_198]) && ((@2_x_162 = @2_r4_157[@i_198]) && (@2_ke_161 = @2_kd_158[@i_198])) then
    out(@2_c2[!_44], @2_m_159[@i_198])
  orfind @i_195 <= NS suchthat defined(@2_r4_166[@i_195], @2_m_168[@i_195], @2_kd_167[@i_195]) && otheruses(@2_m_168[@i_195] -> @2_r4_166[@i_195]) && ((@2_x_162 = @2_r4_166[@i_195]) && (@2_ke_161 = @2_kd_167[@i_195])) then
    out(@2_c2[!_44], @2_m_168[@i_195])
  orfind @i_193 <= NU suchthat defined(@2_r4_172[@i_193], @2_m_174[@i_193], @2_kd_173[@i_193]) && otheruses(@2_m_174[@i_193] -> @2_r4_172[@i_193]) && ((@2_x_162 = @2_r4_172[@i_193]) && (@2_ke_161 = @2_kd_173[@i_193])) then
    out(@2_c2[!_44], @2_m_174[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x_162[@i_191], @2_ke_161[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x_162[@i_191] -> @2_r2_160[@i_191]) && ((@2_x_162 = @2_x_162[@i_191]) && (@2_ke_161 = @2_ke_161[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(@2_x_165[@i_190], @2_ke_164[@i_190], @2_r2_163[@i_190]) && otheruses(@2_x_165[@i_190] -> @2_r2_163[@i_190]) && ((@2_x_162 = @2_x_165[@i_190]) && (@2_ke_161 = @2_ke_164[@i_190])) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(@2_x_171[@i_188], @2_ke_170[@i_188], @2_r2_169[@i_188]) && otheruses(@2_x_171[@i_188] -> @2_r2_169[@i_188]) && ((@2_x_162 = @2_x_171[@i_188]) && (@2_ke_161 = @2_ke_170[@i_188])) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  let @2_m_159: G = @2_m in
  let @2_kd_158: passwd = @2_kd in
  find [unique] @i_186 <= qD suchthat defined(@2_r4_157[@i_186], @2_m_159[@i_186], @2_kd_158[@i_186]) && otheruses(@2_m_159[@i_186] -> @2_r4_157[@i_186]) && ((@2_m_159 = @2_m_159[@i_186]) && (@2_kd_158 = @2_kd_158[@i_186])) then
    out(@2_c4[!_45], @2_r4_157[@i_186])
  orfind @i_183 <= NS suchthat defined(@2_r4_166[@i_183], @2_m_168[@i_183], @2_kd_167[@i_183]) && otheruses(@2_m_168[@i_183] -> @2_r4_166[@i_183]) && ((@2_m_159 = @2_m_168[@i_183]) && (@2_kd_158 = @2_kd_167[@i_183])) then
    out(@2_c4[!_45], @2_r4_166[@i_183])
  orfind @i_181 <= NU suchthat defined(@2_r4_172[@i_181], @2_m_174[@i_181], @2_kd_173[@i_181]) && otheruses(@2_m_174[@i_181] -> @2_r4_172[@i_181]) && ((@2_m_159 = @2_m_174[@i_181]) && (@2_kd_158 = @2_kd_173[@i_181])) then
    out(@2_c4[!_45], @2_r4_172[@i_181])
  orfind @i_179 <= qE suchthat defined(@2_x_162[@i_179], @2_ke_161[@i_179], @2_r2_160[@i_179]) && otheruses(@2_x_162[@i_179] -> @2_r2_160[@i_179]) && ((@2_m_159 = @2_r2_160[@i_179]) && (@2_kd_158 = @2_ke_161[@i_179])) then
    out(@2_c4[!_45], @2_x_162[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_x_165[@i_178], @2_ke_164[@i_178], @2_r2_163[@i_178]) && otheruses(@2_x_165[@i_178] -> @2_r2_163[@i_178]) && ((@2_m_159 = @2_r2_163[@i_178]) && (@2_kd_158 = @2_ke_164[@i_178])) then
    out(@2_c4[!_45], @2_x_165[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_x_171[@i_176], @2_ke_170[@i_176], @2_r2_169[@i_176]) && otheruses(@2_x_171[@i_176] -> @2_r2_169[@i_176]) && ((@2_m_159 = @2_r2_169[@i_176]) && (@2_kd_158 = @2_ke_170[@i_176])) then
    out(@2_c4[!_45], @2_x_171[@i_176])
  else
    new @2_r4_157: G;
    out(@2_c4[!_45], @2_r4_157)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_46], h0(x1, x2, x3, x4, x5))
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_71: host = cst_host in
  let x2_70: host = cst_host in
  let x3_69: G = cst_G in
  let x4_68: G = cst_G in
  let x5_67: G = cst_G in
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], x5_67[@i_100], x4_68[@i_100], x3_69[@i_100], x2_70[@i_100], x1_71[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(Xp[@i_99], Yp[@i_99], Kp[@i_99], x5_73[@i_99], x4_74[@i_99], x3_75[@i_99], x1_77[@i_99], x2_76[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(X[@i_96], Y_u[@i_96], K_u[@i_96], x5_91[@i_96], x4_92[@i_96], x3_93[@i_96], x1_95[@i_96], x2_94[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying simplify [Excluding set(dist 11->12, proba <= 2. * NS * NP / |exponent| + qE * NP / |exponent| + NU * NP / |exponent| + qD * NP / |exponent| + NP * NS / |exponent| + qE * NS / |exponent| + NU * NS / |exponent| + NS * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G| + 0.5 * NS * NS / |G| + NS * NP / |G| + NS * qE / |G|)] yields

Game 12 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let @2_m_174: G = Ystar_u in
  let @2_kd_173: passwd = pw in
  find [unique] @i_246 <= qD suchthat defined(@2_m_159[@i_246], @2_kd_158[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m_159[@i_246] -> @2_r4_157[@i_246]) && ((@2_m_174 = @2_m_159[@i_246]) && (@2_kd_173 = @2_kd_158[@i_246])) then
  (
    let Y_u: G = @2_r4_157[@i_246] in
    let K_u: G = exp(Y_u, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    let x3_93: G = cst_G in
    let x4_92: G = cst_G in
    let x5_91: G = cst_G in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(@2_m_174[@i_241], @2_r4_172[@i_241]) && otheruses(@2_m_174[@i_241] -> @2_r4_172[@i_241]) && (@2_m_174 = @2_m_174[@i_241]) then
  (
    let Y_u: G = @2_r4_172[@i_241] in
    let K_u: G = exp(Y_u, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    let x3_93: G = cst_G in
    let x4_92: G = cst_G in
    let x5_91: G = cst_G in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke_161[@i_239], @2_x_162[@i_239]) && otheruses(@2_x_162[@i_239] -> @2_r2_160[@i_239]) && ((@2_m_174 = @2_r2_160[@i_239]) && (@2_kd_173 = @2_ke_161[@i_239])) then
  (
    let Y_u: G = @2_x_162[@i_239] in
    let K_u: G = exp(Y_u, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    let x3_93: G = cst_G in
    let x4_92: G = cst_G in
    let x5_91: G = cst_G in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], @2_x_165[@i_238], yp[@i_238]) && otheruses(@2_x_165[@i_238] -> @2_r2_163[@i_238]) && (@2_m_174 = @2_r2_163[@i_238]) then
  (
    let Y_u: G = @2_x_165[@i_238] in
    let K_u: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    let x3_93: G = cst_G in
    let x4_92: G = cst_G in
    let x5_91: G = cst_G in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], @2_x_171[@i_236], y[@i_236]) && otheruses(@2_x_171[@i_236] -> @2_r2_169[@i_236]) && (@2_m_174 = @2_r2_169[@i_236]) then
  (
    let Y_u: G = @2_x_171[@i_236] in
    let K_u: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    let x3_93: G = cst_G in
    let x4_92: G = cst_G in
    let x5_91: G = cst_G in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  else
    new @2_r4_172: G;
    let Y_u: G = @2_r4_172 in
    let K_u: G = exp(Y_u, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    let x3_93: G = cst_G in
    let x4_92: G = cst_G in
    let x5_91: G = cst_G in
    new r1_90: hash1;
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_90, sk_u);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let @2_x_171: G = Y in
  let @2_ke_170: passwd = pw in
  new @2_r2_169: G;
  let Ystar: G = @2_r2_169 in
  out(c4[!_42], (S, Ystar));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_90[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  else
    let @2_m_168: G = Ystar in
    let @2_kd_167: passwd = pw in
    find [unique] @i_222 <= qD suchthat defined(@2_m_159[@i_222], @2_kd_158[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m_159[@i_222] -> @2_r4_157[@i_222]) && ((@2_m_168 = @2_m_159[@i_222]) && (@2_kd_167 = @2_kd_158[@i_222])) then
    (
      let Y': G = @2_r4_157[@i_222] in
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
        event Auth
      else
        let K_s: G = exp(X_s, y)
    )
    orfind @i_217 <= NU suchthat defined(@2_m_174[@i_217], @2_r4_172[@i_217]) && otheruses(@2_m_174[@i_217] -> @2_r4_172[@i_217]) && (@2_m_168 = @2_m_174[@i_217]) then
    (
      let Y': G = @2_r4_172[@i_217] in
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
        event Auth
      else
        let K_s: G = exp(X_s, y)
    )
    orfind  suchthat otheruses(@2_x_171 -> @2_r2_169) then
    (
      let @i_212 <= NS = !_42 in
      let Y': G = @2_x_171 in
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
        event Auth
      else
        let K_s: G = exp(X_s, y)
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let @2_x_165: G = Yp in
  let @2_ke_164: passwd = pw in
  new @2_r2_163: G;
  let Ystarp: G = @2_r2_163 in
  let x1_77: host = U in
  let x2_76: host = S in
  let x3_75: G = cst_G in
  let x4_74: G = cst_G in
  let x5_73: G = cst_G in
  new r1_72: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_43], (U, Xp, S, Ystarp, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  let @2_x_162: G = @2_x in
  let @2_ke_161: passwd = @2_ke in
  find [unique] @i_198 <= qD suchthat defined(@2_r4_157[@i_198], @2_kd_158[@i_198], @2_m_159[@i_198]) && otheruses(@2_m_159[@i_198] -> @2_r4_157[@i_198]) && ((@2_x_162 = @2_r4_157[@i_198]) && (@2_ke_161 = @2_kd_158[@i_198])) then
    out(@2_c2[!_44], @2_m_159[@i_198])
  orfind @i_193 <= NU suchthat defined(@2_r4_172[@i_193], @2_kd_173[@i_193], @2_m_174[@i_193]) && otheruses(@2_m_174[@i_193] -> @2_r4_172[@i_193]) && ((@2_x_162 = @2_r4_172[@i_193]) && (@2_ke_161 = @2_kd_173[@i_193])) then
    out(@2_c2[!_44], @2_m_174[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x_162[@i_191], @2_ke_161[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x_162[@i_191] -> @2_r2_160[@i_191]) && ((@2_x_162 = @2_x_162[@i_191]) && (@2_ke_161 = @2_ke_161[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(@2_x_165[@i_190], @2_ke_164[@i_190], @2_r2_163[@i_190]) && otheruses(@2_x_165[@i_190] -> @2_r2_163[@i_190]) && ((@2_x_162 = @2_x_165[@i_190]) && (@2_ke_161 = @2_ke_164[@i_190])) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(@2_x_171[@i_188], @2_ke_170[@i_188], @2_r2_169[@i_188]) && otheruses(@2_x_171[@i_188] -> @2_r2_169[@i_188]) && ((@2_x_162 = @2_x_171[@i_188]) && (@2_ke_161 = @2_ke_170[@i_188])) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  let @2_m_159: G = @2_m in
  let @2_kd_158: passwd = @2_kd in
  find [unique] @i_186 <= qD suchthat defined(@2_m_159[@i_186], @2_kd_158[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m_159[@i_186] -> @2_r4_157[@i_186]) && ((@2_m_159 = @2_m_159[@i_186]) && (@2_kd_158 = @2_kd_158[@i_186])) then
    out(@2_c4[!_45], @2_r4_157[@i_186])
  orfind @i_181 <= NU suchthat defined(@2_m_174[@i_181], @2_kd_173[@i_181], @2_r4_172[@i_181]) && otheruses(@2_m_174[@i_181] -> @2_r4_172[@i_181]) && ((@2_m_159 = @2_m_174[@i_181]) && (@2_kd_158 = @2_kd_173[@i_181])) then
    out(@2_c4[!_45], @2_r4_172[@i_181])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke_161[@i_179], @2_x_162[@i_179]) && otheruses(@2_x_162[@i_179] -> @2_r2_160[@i_179]) && ((@2_m_159 = @2_r2_160[@i_179]) && (@2_kd_158 = @2_ke_161[@i_179])) then
    out(@2_c4[!_45], @2_x_162[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], @2_ke_164[@i_178], @2_x_165[@i_178]) && otheruses(@2_x_165[@i_178] -> @2_r2_163[@i_178]) && ((@2_m_159 = @2_r2_163[@i_178]) && (@2_kd_158 = @2_ke_164[@i_178])) then
    out(@2_c4[!_45], @2_x_165[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], @2_ke_170[@i_176], @2_x_171[@i_176]) && otheruses(@2_x_171[@i_176] -> @2_r2_169[@i_176]) && ((@2_m_159 = @2_r2_169[@i_176]) && (@2_kd_158 = @2_ke_170[@i_176])) then
    out(@2_c4[!_45], @2_x_171[@i_176])
  else
    new @2_r4_157: G;
    out(@2_c4[!_45], @2_r4_157)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_46], h0(x1, x2, x3, x4, x5))
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_71: host = cst_host in
  let x2_70: host = cst_host in
  let x3_69: G = cst_G in
  let x4_68: G = cst_G in
  let x5_67: G = cst_G in
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying move all binders yields

Game 13 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let @2_m_174: G = Ystar_u in
  let @2_kd_173: passwd = pw in
  find [unique] @i_246 <= qD suchthat defined(@2_m_159[@i_246], @2_kd_158[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m_159[@i_246] -> @2_r4_157[@i_246]) && ((@2_m_174 = @2_m_159[@i_246]) && (@2_kd_173 = @2_kd_158[@i_246])) then
  (
    let Y_u: G = @2_r4_157[@i_246] in
    let K_u: G = exp(Y_u, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(@2_m_174[@i_241], @2_r4_172[@i_241]) && otheruses(@2_m_174[@i_241] -> @2_r4_172[@i_241]) && (@2_m_174 = @2_m_174[@i_241]) then
  (
    let Y_u: G = @2_r4_172[@i_241] in
    let K_u: G = exp(Y_u, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke_161[@i_239], @2_x_162[@i_239]) && otheruses(@2_x_162[@i_239] -> @2_r2_160[@i_239]) && ((@2_m_174 = @2_r2_160[@i_239]) && (@2_kd_173 = @2_ke_161[@i_239])) then
  (
    let Y_u: G = @2_x_162[@i_239] in
    let K_u: G = exp(Y_u, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], @2_x_165[@i_238], yp[@i_238]) && otheruses(@2_x_165[@i_238] -> @2_r2_163[@i_238]) && (@2_m_174 = @2_r2_163[@i_238]) then
  (
    let Y_u: G = @2_x_165[@i_238] in
    let K_u: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], @2_x_171[@i_236], y[@i_236]) && otheruses(@2_x_171[@i_236] -> @2_r2_169[@i_236]) && (@2_m_174 = @2_r2_169[@i_236]) then
  (
    let Y_u: G = @2_x_171[@i_236] in
    let K_u: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  else
    new @2_r4_172: G;
    let Y_u: G = @2_r4_172 in
    let K_u: G = exp(Y_u, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    let x3_93: G = cst_G in
    let x4_92: G = cst_G in
    let x5_91: G = cst_G in
    new r1_90: hash1;
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_90, sk_u);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let @2_x_171: G = Y in
  let @2_ke_170: passwd = pw in
  new @2_r2_169: G;
  let Ystar: G = @2_r2_169 in
  out(c4[!_42], (S, Ystar));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_90[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  else
    let @2_m_168: G = Ystar in
    let @2_kd_167: passwd = pw in
    find [unique] @i_222 <= qD suchthat defined(@2_m_159[@i_222], @2_kd_158[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m_159[@i_222] -> @2_r4_157[@i_222]) && ((@2_m_168 = @2_m_159[@i_222]) && (@2_kd_167 = @2_kd_158[@i_222])) then
    (
      let Y': G = @2_r4_157[@i_222] in
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
        event Auth
      else
        let K_s: G = exp(X_s, y)
    )
    orfind @i_217 <= NU suchthat defined(@2_m_174[@i_217], @2_r4_172[@i_217]) && otheruses(@2_m_174[@i_217] -> @2_r4_172[@i_217]) && (@2_m_168 = @2_m_174[@i_217]) then
    (
      let Y': G = @2_r4_172[@i_217] in
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
        event Auth
      else
        let K_s: G = exp(X_s, y)
    )
    orfind  suchthat otheruses(@2_x_171 -> @2_r2_169) then
    (
      let @i_212 <= NS = !_42 in
      let Y': G = @2_x_171 in
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
        event Auth
      else
        let K_s: G = exp(X_s, y)
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let @2_x_165: G = Yp in
  let @2_ke_164: passwd = pw in
  new @2_r2_163: G;
  let Ystarp: G = @2_r2_163 in
  let x1_77: host = U in
  let x2_76: host = S in
  let x3_75: G = cst_G in
  let x4_74: G = cst_G in
  let x5_73: G = cst_G in
  new r1_72: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_43], (U, Xp, S, Ystarp, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  let @2_x_162: G = @2_x in
  let @2_ke_161: passwd = @2_ke in
  find [unique] @i_198 <= qD suchthat defined(@2_r4_157[@i_198], @2_kd_158[@i_198], @2_m_159[@i_198]) && otheruses(@2_m_159[@i_198] -> @2_r4_157[@i_198]) && ((@2_x_162 = @2_r4_157[@i_198]) && (@2_ke_161 = @2_kd_158[@i_198])) then
    out(@2_c2[!_44], @2_m_159[@i_198])
  orfind @i_193 <= NU suchthat defined(@2_r4_172[@i_193], @2_kd_173[@i_193], @2_m_174[@i_193]) && otheruses(@2_m_174[@i_193] -> @2_r4_172[@i_193]) && ((@2_x_162 = @2_r4_172[@i_193]) && (@2_ke_161 = @2_kd_173[@i_193])) then
    out(@2_c2[!_44], @2_m_174[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x_162[@i_191], @2_ke_161[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x_162[@i_191] -> @2_r2_160[@i_191]) && ((@2_x_162 = @2_x_162[@i_191]) && (@2_ke_161 = @2_ke_161[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(@2_x_165[@i_190], @2_ke_164[@i_190], @2_r2_163[@i_190]) && otheruses(@2_x_165[@i_190] -> @2_r2_163[@i_190]) && ((@2_x_162 = @2_x_165[@i_190]) && (@2_ke_161 = @2_ke_164[@i_190])) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(@2_x_171[@i_188], @2_ke_170[@i_188], @2_r2_169[@i_188]) && otheruses(@2_x_171[@i_188] -> @2_r2_169[@i_188]) && ((@2_x_162 = @2_x_171[@i_188]) && (@2_ke_161 = @2_ke_170[@i_188])) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  let @2_m_159: G = @2_m in
  let @2_kd_158: passwd = @2_kd in
  find [unique] @i_186 <= qD suchthat defined(@2_m_159[@i_186], @2_kd_158[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m_159[@i_186] -> @2_r4_157[@i_186]) && ((@2_m_159 = @2_m_159[@i_186]) && (@2_kd_158 = @2_kd_158[@i_186])) then
    out(@2_c4[!_45], @2_r4_157[@i_186])
  orfind @i_181 <= NU suchthat defined(@2_m_174[@i_181], @2_kd_173[@i_181], @2_r4_172[@i_181]) && otheruses(@2_m_174[@i_181] -> @2_r4_172[@i_181]) && ((@2_m_159 = @2_m_174[@i_181]) && (@2_kd_158 = @2_kd_173[@i_181])) then
    out(@2_c4[!_45], @2_r4_172[@i_181])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke_161[@i_179], @2_x_162[@i_179]) && otheruses(@2_x_162[@i_179] -> @2_r2_160[@i_179]) && ((@2_m_159 = @2_r2_160[@i_179]) && (@2_kd_158 = @2_ke_161[@i_179])) then
    out(@2_c4[!_45], @2_x_162[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], @2_ke_164[@i_178], @2_x_165[@i_178]) && otheruses(@2_x_165[@i_178] -> @2_r2_163[@i_178]) && ((@2_m_159 = @2_r2_163[@i_178]) && (@2_kd_158 = @2_ke_164[@i_178])) then
    out(@2_c4[!_45], @2_x_165[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], @2_ke_170[@i_176], @2_x_171[@i_176]) && otheruses(@2_x_171[@i_176] -> @2_r2_169[@i_176]) && ((@2_m_159 = @2_r2_169[@i_176]) && (@2_kd_158 = @2_ke_170[@i_176])) then
    out(@2_c4[!_45], @2_x_171[@i_176])
  else
    new @2_r4_157: G;
    out(@2_c4[!_45], @2_r4_157)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_46], h0(x1, x2, x3, x4, x5))
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of useless yields

Game 14 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let @2_m_174: G = cst_G in
  let @2_kd_173: passwd = cst_passwd in
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @2_kd_158[@i_246], @2_m_159[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @2_r4_157[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = @2_r4_157[@i_246] in
    let K_u: G = exp(@2_r4_157[@i_246], x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((@2_r4_157[@i_246] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, @2_r4_157[@i_246], K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, @2_r4_157[@i_246], K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @2_m_174[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @2_r4_172[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = @2_r4_172[@i_241] in
    let K_u: G = exp(@2_r4_172[@i_241], x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((@2_r4_172[@i_241] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, @2_r4_172[@i_241], K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, @2_r4_172[@i_241], K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_ke[@i_239], @2_x[@i_239], @2_x_162[@i_239], @2_ke_161[@i_239], @2_r2_160[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
  (
    let Y_u: G = @2_x[@i_239] in
    let K_u: G = exp(@2_x[@i_239], x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((@2_x[@i_239] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, @2_x[@i_239], K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, @2_x[@i_239], K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_238 <= NP suchthat defined(Yp[@i_238], @2_x_165[@i_238], @2_r2_163[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Yp[@i_238], K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Yp[@i_238], K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(Y[@i_236], @2_x_171[@i_236], @2_r2_169[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y[@i_236], K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y[@i_236], K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  else
    new @2_r4_172: G;
    let Y_u: G = @2_r4_172 in
    let K_u: G = exp(@2_r4_172, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let sk_u: hash0 = h0(U, S, X, @2_r4_172, K_u) in
    event termU(U, X, S, Ystar_u, r1_90, sk_u);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let @2_x_171: G = cst_G in
  let @2_ke_170: passwd = cst_passwd in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_90[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @2_kd_158[@i_222], @2_m_159[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @2_r4_157[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@2_r4_157[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @2_m_174[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @2_r4_172[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@2_r4_172[@i_217] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let @2_x_165: G = cst_G in
  let @2_ke_164: passwd = cst_passwd in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  let @2_x_162: G = cst_G in
  let @2_ke_161: passwd = cst_passwd in
  find [unique] @i_198 <= qD suchthat defined(@2_kd[@i_198], @2_m[@i_198], @2_m_159[@i_198], @2_kd_158[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @2_r4_157[@i_198]) && ((@2_x = @2_r4_157[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(pw, Ystar_u[@i_193], @2_m_174[@i_193], @2_kd_173[@i_193], @2_r4_172[@i_193]) && otheruses(Ystar_u[@i_193] -> @2_r4_172[@i_193]) && ((@2_x = @2_r4_172[@i_193]) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_ke_161[@i_191], @2_x_162[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], pw, @2_ke_164[@i_190], @2_x_165[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], pw, @2_ke_170[@i_188], @2_x_171[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  let @2_m_159: G = cst_G in
  let @2_kd_158: passwd = cst_passwd in
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @2_kd_158[@i_186], @2_m_159[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @2_r4_157[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @2_r4_157[@i_186])
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], pw, @2_kd_173[@i_181], @2_m_174[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @2_r4_172[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], @2_r4_172[@i_181])
  orfind @i_179 <= qE suchthat defined(@2_ke[@i_179], @2_x[@i_179], @2_x_162[@i_179], @2_ke_161[@i_179], @2_r2_160[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(pw, Yp[@i_178], @2_x_165[@i_178], @2_ke_164[@i_178], @2_r2_163[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(pw, Y[@i_176], @2_x_171[@i_176], @2_ke_170[@i_176], @2_r2_169[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @2_r4_157: G;
    out(@2_c4[!_45], @2_r4_157)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_46], h0(x1, x2, x3, x4, x5))
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying insert event Encrypt at occurrence 1472 [Excluding set(event Encrypt in game 15)] yields

Game 15 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let @2_m_174: G = cst_G in
  let @2_kd_173: passwd = cst_passwd in
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @2_kd_158[@i_246], @2_m_159[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @2_r4_157[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = @2_r4_157[@i_246] in
    let K_u: G = exp(@2_r4_157[@i_246], x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((@2_r4_157[@i_246] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, @2_r4_157[@i_246], K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, @2_r4_157[@i_246], K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @2_m_174[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @2_r4_172[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = @2_r4_172[@i_241] in
    let K_u: G = exp(@2_r4_172[@i_241], x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((@2_r4_172[@i_241] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, @2_r4_172[@i_241], K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, @2_r4_172[@i_241], K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_ke[@i_239], @2_x[@i_239], @2_x_162[@i_239], @2_ke_161[@i_239], @2_r2_160[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(Yp[@i_238], @2_x_165[@i_238], @2_r2_163[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Yp[@i_238], K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Yp[@i_238], K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(Y[@i_236], @2_x_171[@i_236], @2_r2_169[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y[@i_236], K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y[@i_236], K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  else
    new @2_r4_172: G;
    let Y_u: G = @2_r4_172 in
    let K_u: G = exp(@2_r4_172, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let sk_u: hash0 = h0(U, S, X, @2_r4_172, K_u) in
    event termU(U, X, S, Ystar_u, r1_90, sk_u);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let @2_x_171: G = cst_G in
  let @2_ke_170: passwd = cst_passwd in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_90[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @2_kd_158[@i_222], @2_m_159[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @2_r4_157[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@2_r4_157[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @2_m_174[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @2_r4_172[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@2_r4_172[@i_217] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let @2_x_165: G = cst_G in
  let @2_ke_164: passwd = cst_passwd in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  let @2_x_162: G = cst_G in
  let @2_ke_161: passwd = cst_passwd in
  find [unique] @i_198 <= qD suchthat defined(@2_kd[@i_198], @2_m[@i_198], @2_m_159[@i_198], @2_kd_158[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @2_r4_157[@i_198]) && ((@2_x = @2_r4_157[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(pw, Ystar_u[@i_193], @2_m_174[@i_193], @2_kd_173[@i_193], @2_r4_172[@i_193]) && otheruses(Ystar_u[@i_193] -> @2_r4_172[@i_193]) && ((@2_x = @2_r4_172[@i_193]) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_ke_161[@i_191], @2_x_162[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], pw, @2_ke_164[@i_190], @2_x_165[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], pw, @2_ke_170[@i_188], @2_x_171[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  let @2_m_159: G = cst_G in
  let @2_kd_158: passwd = cst_passwd in
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @2_kd_158[@i_186], @2_m_159[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @2_r4_157[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @2_r4_157[@i_186])
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], pw, @2_kd_173[@i_181], @2_m_174[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @2_r4_172[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], @2_r4_172[@i_181])
  orfind @i_179 <= qE suchthat defined(@2_ke[@i_179], @2_x[@i_179], @2_x_162[@i_179], @2_ke_161[@i_179], @2_r2_160[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(pw, Yp[@i_178], @2_x_165[@i_178], @2_ke_164[@i_178], @2_r2_163[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(pw, Y[@i_176], @2_x_171[@i_176], @2_ke_170[@i_176], @2_r2_169[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @2_r4_157: G;
    out(@2_c4[!_45], @2_r4_157)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_46], h0(x1, x2, x3, x4, x5))
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_38 <= N (x1_61: host, x2_60: host, x3_59: G, x4_58: G, x5_57: G) -> let x1: host = x1_61 in let x2: host = x2_60 in let x3: G = x3_59 in let x4: G = x4_58 in let x5: G = x5_57 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash0; r
 yields

Game 16 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let @2_m_174: G = cst_G in
  let @2_kd_173: passwd = cst_passwd in
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @2_kd_158[@i_246], @2_m_159[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @2_r4_157[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = @2_r4_157[@i_246] in
    let K_u: G = exp(@2_r4_157[@i_246], x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((@2_r4_157[@i_246] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      let x3_423: G = X in
      let x4_422: G = @2_r4_157[@i_246] in
      let x5_421: G = K_u in
      find [unique] @i_552 <= qH0 suchthat defined(x1_389[@i_552], x2_388[@i_552], x3_387[@i_552], x4_386[@i_552], x5_385[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && ((x1_425 = x1_389[@i_552]) && ((x2_424 = x2_388[@i_552]) && ((x3_423 = x3_387[@i_552]) && ((x4_422 = x4_386[@i_552]) && (x5_421 = x5_385[@i_552]))))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_551 <= NP suchthat defined(x1_395[@i_551], x2_394[@i_551], x3_393[@i_551], x4_392[@i_551], x5_391[@i_551], r_390[@i_551]) && otheruses(r_390[@i_551]) && ((x1_425 = x1_395[@i_551]) && ((x2_424 = x2_394[@i_551]) && ((x3_423 = x3_393[@i_551]) && ((x4_422 = x4_392[@i_551]) && (x5_421 = x5_391[@i_551]))))) then
      (
        let sk_u: hash0 = r_390[@i_551] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_550 <= NS suchthat defined(x1_401[@i_550], x2_400[@i_550], x3_399[@i_550], x4_398[@i_550], x5_397[@i_550], r_396[@i_550]) && otheruses(r_396[@i_550]) && ((x1_425 = x1_401[@i_550]) && ((x2_424 = x2_400[@i_550]) && ((x3_423 = x3_399[@i_550]) && ((x4_422 = x4_398[@i_550]) && (x5_421 = x5_397[@i_550]))))) then
      (
        let sk_u: hash0 = r_396[@i_550] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_549 <= NS suchthat defined(x1_407[@i_549], x2_406[@i_549], x3_405[@i_549], x4_404[@i_549], x5_403[@i_549], r_402[@i_549]) && otheruses(r_402[@i_549]) && ((x1_425 = x1_407[@i_549]) && ((x2_424 = x2_406[@i_549]) && ((x3_423 = x3_405[@i_549]) && ((x4_422 = x4_404[@i_549]) && (x5_421 = x5_403[@i_549]))))) then
      (
        let sk_u: hash0 = r_402[@i_549] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_548 <= NU suchthat defined(x1_413[@i_548], x2_412[@i_548], x3_411[@i_548], x4_410[@i_548], x5_409[@i_548], r_408[@i_548]) && otheruses(r_408[@i_548]) && ((x1_425 = x1_413[@i_548]) && ((x2_424 = x2_412[@i_548]) && ((x3_423 = x3_411[@i_548]) && ((x4_422 = x4_410[@i_548]) && (x5_421 = x5_409[@i_548]))))) then
      (
        let sk_u: hash0 = r_408[@i_548] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_547 <= NU suchthat defined(x1_419[@i_547], x2_418[@i_547], x3_417[@i_547], x4_416[@i_547], x5_415[@i_547], r_414[@i_547]) && otheruses(r_414[@i_547]) && ((x1_425 = x1_419[@i_547]) && ((x2_424 = x2_418[@i_547]) && ((x3_423 = x3_417[@i_547]) && ((x4_422 = x4_416[@i_547]) && (x5_421 = x5_415[@i_547]))))) then
      (
        let sk_u: hash0 = r_414[@i_547] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_546 <= NU suchthat defined(x1_425[@i_546], x2_424[@i_546], x3_423[@i_546], x4_422[@i_546], x5_421[@i_546], r_420[@i_546]) && otheruses(r_420[@i_546]) && ((x1_425 = x1_425[@i_546]) && ((x2_424 = x2_424[@i_546]) && ((x3_423 = x3_423[@i_546]) && ((x4_422 = x4_422[@i_546]) && (x5_421 = x5_421[@i_546]))))) then
      (
        let sk_u: hash0 = r_420[@i_546] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_545 <= NU suchthat defined(x1_431[@i_545], x2_430[@i_545], x3_429[@i_545], x4_428[@i_545], x5_427[@i_545], r_426[@i_545]) && otheruses(r_426[@i_545]) && ((x1_425 = x1_431[@i_545]) && ((x2_424 = x2_430[@i_545]) && ((x3_423 = x3_429[@i_545]) && ((x4_422 = x4_428[@i_545]) && (x5_421 = x5_427[@i_545]))))) then
      (
        let sk_u: hash0 = r_426[@i_545] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_544 <= NU suchthat defined(x1_437[@i_544], x2_436[@i_544], x3_435[@i_544], x4_434[@i_544], x5_433[@i_544], r_432[@i_544]) && otheruses(r_432[@i_544]) && ((x1_425 = x1_437[@i_544]) && ((x2_424 = x2_436[@i_544]) && ((x3_423 = x3_435[@i_544]) && ((x4_422 = x4_434[@i_544]) && (x5_421 = x5_433[@i_544]))))) then
      (
        let sk_u: hash0 = r_432[@i_544] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_543 <= NU suchthat defined(x1_443[@i_543], x2_442[@i_543], x3_441[@i_543], x4_440[@i_543], x5_439[@i_543], r_438[@i_543]) && otheruses(r_438[@i_543]) && ((x1_425 = x1_443[@i_543]) && ((x2_424 = x2_442[@i_543]) && ((x3_423 = x3_441[@i_543]) && ((x4_422 = x4_440[@i_543]) && (x5_421 = x5_439[@i_543]))))) then
      (
        let sk_u: hash0 = r_438[@i_543] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_542 <= NU suchthat defined(x1_449[@i_542], x2_448[@i_542], x3_447[@i_542], x4_446[@i_542], x5_445[@i_542], r_444[@i_542]) && otheruses(r_444[@i_542]) && ((x1_425 = x1_449[@i_542]) && ((x2_424 = x2_448[@i_542]) && ((x3_423 = x3_447[@i_542]) && ((x4_422 = x4_446[@i_542]) && (x5_421 = x5_445[@i_542]))))) then
      (
        let sk_u: hash0 = r_444[@i_542] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_541 <= NU suchthat defined(x1_455[@i_541], x2_454[@i_541], x3_453[@i_541], x4_452[@i_541], x5_451[@i_541], r_450[@i_541]) && otheruses(r_450[@i_541]) && ((x1_425 = x1_455[@i_541]) && ((x2_424 = x2_454[@i_541]) && ((x3_423 = x3_453[@i_541]) && ((x4_422 = x4_452[@i_541]) && (x5_421 = x5_451[@i_541]))))) then
      (
        let sk_u: hash0 = r_450[@i_541] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_540 <= NU suchthat defined(x1_461[@i_540], x2_460[@i_540], x3_459[@i_540], x4_458[@i_540], x5_457[@i_540], r_456[@i_540]) && otheruses(r_456[@i_540]) && ((x1_425 = x1_461[@i_540]) && ((x2_424 = x2_460[@i_540]) && ((x3_423 = x3_459[@i_540]) && ((x4_422 = x4_458[@i_540]) && (x5_421 = x5_457[@i_540]))))) then
      (
        let sk_u: hash0 = r_456[@i_540] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let x1_419: host = U in
      let x2_418: host = S in
      let x3_417: G = X in
      let x4_416: G = @2_r4_157[@i_246] in
      let x5_415: G = K_u in
      find [unique] @i_539 <= qH0 suchthat defined(x1_389[@i_539], x2_388[@i_539], x3_387[@i_539], x4_386[@i_539], x5_385[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && ((x1_419 = x1_389[@i_539]) && ((x2_418 = x2_388[@i_539]) && ((x3_417 = x3_387[@i_539]) && ((x4_416 = x4_386[@i_539]) && (x5_415 = x5_385[@i_539]))))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_538 <= NP suchthat defined(x1_395[@i_538], x2_394[@i_538], x3_393[@i_538], x4_392[@i_538], x5_391[@i_538], r_390[@i_538]) && otheruses(r_390[@i_538]) && ((x1_419 = x1_395[@i_538]) && ((x2_418 = x2_394[@i_538]) && ((x3_417 = x3_393[@i_538]) && ((x4_416 = x4_392[@i_538]) && (x5_415 = x5_391[@i_538]))))) then
      (
        let sk_u: hash0 = r_390[@i_538] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_537 <= NS suchthat defined(x1_401[@i_537], x2_400[@i_537], x3_399[@i_537], x4_398[@i_537], x5_397[@i_537], r_396[@i_537]) && otheruses(r_396[@i_537]) && ((x1_419 = x1_401[@i_537]) && ((x2_418 = x2_400[@i_537]) && ((x3_417 = x3_399[@i_537]) && ((x4_416 = x4_398[@i_537]) && (x5_415 = x5_397[@i_537]))))) then
      (
        let sk_u: hash0 = r_396[@i_537] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_536 <= NS suchthat defined(x1_407[@i_536], x2_406[@i_536], x3_405[@i_536], x4_404[@i_536], x5_403[@i_536], r_402[@i_536]) && otheruses(r_402[@i_536]) && ((x1_419 = x1_407[@i_536]) && ((x2_418 = x2_406[@i_536]) && ((x3_417 = x3_405[@i_536]) && ((x4_416 = x4_404[@i_536]) && (x5_415 = x5_403[@i_536]))))) then
      (
        let sk_u: hash0 = r_402[@i_536] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_535 <= NU suchthat defined(x1_413[@i_535], x2_412[@i_535], x3_411[@i_535], x4_410[@i_535], x5_409[@i_535], r_408[@i_535]) && otheruses(r_408[@i_535]) && ((x1_419 = x1_413[@i_535]) && ((x2_418 = x2_412[@i_535]) && ((x3_417 = x3_411[@i_535]) && ((x4_416 = x4_410[@i_535]) && (x5_415 = x5_409[@i_535]))))) then
      (
        let sk_u: hash0 = r_408[@i_535] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_534 <= NU suchthat defined(x1_419[@i_534], x2_418[@i_534], x3_417[@i_534], x4_416[@i_534], x5_415[@i_534], r_414[@i_534]) && otheruses(r_414[@i_534]) && ((x1_419 = x1_419[@i_534]) && ((x2_418 = x2_418[@i_534]) && ((x3_417 = x3_417[@i_534]) && ((x4_416 = x4_416[@i_534]) && (x5_415 = x5_415[@i_534]))))) then
      (
        let sk_u: hash0 = r_414[@i_534] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_533 <= NU suchthat defined(x1_425[@i_533], x2_424[@i_533], x3_423[@i_533], x4_422[@i_533], x5_421[@i_533], r_420[@i_533]) && otheruses(r_420[@i_533]) && ((x1_419 = x1_425[@i_533]) && ((x2_418 = x2_424[@i_533]) && ((x3_417 = x3_423[@i_533]) && ((x4_416 = x4_422[@i_533]) && (x5_415 = x5_421[@i_533]))))) then
      (
        let sk_u: hash0 = r_420[@i_533] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_532 <= NU suchthat defined(x1_431[@i_532], x2_430[@i_532], x3_429[@i_532], x4_428[@i_532], x5_427[@i_532], r_426[@i_532]) && otheruses(r_426[@i_532]) && ((x1_419 = x1_431[@i_532]) && ((x2_418 = x2_430[@i_532]) && ((x3_417 = x3_429[@i_532]) && ((x4_416 = x4_428[@i_532]) && (x5_415 = x5_427[@i_532]))))) then
      (
        let sk_u: hash0 = r_426[@i_532] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_531 <= NU suchthat defined(x1_437[@i_531], x2_436[@i_531], x3_435[@i_531], x4_434[@i_531], x5_433[@i_531], r_432[@i_531]) && otheruses(r_432[@i_531]) && ((x1_419 = x1_437[@i_531]) && ((x2_418 = x2_436[@i_531]) && ((x3_417 = x3_435[@i_531]) && ((x4_416 = x4_434[@i_531]) && (x5_415 = x5_433[@i_531]))))) then
      (
        let sk_u: hash0 = r_432[@i_531] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_530 <= NU suchthat defined(x1_443[@i_530], x2_442[@i_530], x3_441[@i_530], x4_440[@i_530], x5_439[@i_530], r_438[@i_530]) && otheruses(r_438[@i_530]) && ((x1_419 = x1_443[@i_530]) && ((x2_418 = x2_442[@i_530]) && ((x3_417 = x3_441[@i_530]) && ((x4_416 = x4_440[@i_530]) && (x5_415 = x5_439[@i_530]))))) then
      (
        let sk_u: hash0 = r_438[@i_530] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_529 <= NU suchthat defined(x1_449[@i_529], x2_448[@i_529], x3_447[@i_529], x4_446[@i_529], x5_445[@i_529], r_444[@i_529]) && otheruses(r_444[@i_529]) && ((x1_419 = x1_449[@i_529]) && ((x2_418 = x2_448[@i_529]) && ((x3_417 = x3_447[@i_529]) && ((x4_416 = x4_446[@i_529]) && (x5_415 = x5_445[@i_529]))))) then
      (
        let sk_u: hash0 = r_444[@i_529] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_528 <= NU suchthat defined(x1_455[@i_528], x2_454[@i_528], x3_453[@i_528], x4_452[@i_528], x5_451[@i_528], r_450[@i_528]) && otheruses(r_450[@i_528]) && ((x1_419 = x1_455[@i_528]) && ((x2_418 = x2_454[@i_528]) && ((x3_417 = x3_453[@i_528]) && ((x4_416 = x4_452[@i_528]) && (x5_415 = x5_451[@i_528]))))) then
      (
        let sk_u: hash0 = r_450[@i_528] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_527 <= NU suchthat defined(x1_461[@i_527], x2_460[@i_527], x3_459[@i_527], x4_458[@i_527], x5_457[@i_527], r_456[@i_527]) && otheruses(r_456[@i_527]) && ((x1_419 = x1_461[@i_527]) && ((x2_418 = x2_460[@i_527]) && ((x3_417 = x3_459[@i_527]) && ((x4_416 = x4_458[@i_527]) && (x5_415 = x5_457[@i_527]))))) then
      (
        let sk_u: hash0 = r_456[@i_527] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @2_m_174[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @2_r4_172[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = @2_r4_172[@i_241] in
    let K_u: G = exp(@2_r4_172[@i_241], x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((@2_r4_172[@i_241] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      let x3_435: G = X in
      let x4_434: G = @2_r4_172[@i_241] in
      let x5_433: G = K_u in
      find [unique] @i_578 <= qH0 suchthat defined(x1_389[@i_578], x2_388[@i_578], x3_387[@i_578], x4_386[@i_578], x5_385[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && ((x1_437 = x1_389[@i_578]) && ((x2_436 = x2_388[@i_578]) && ((x3_435 = x3_387[@i_578]) && ((x4_434 = x4_386[@i_578]) && (x5_433 = x5_385[@i_578]))))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_577 <= NP suchthat defined(x1_395[@i_577], x2_394[@i_577], x3_393[@i_577], x4_392[@i_577], x5_391[@i_577], r_390[@i_577]) && otheruses(r_390[@i_577]) && ((x1_437 = x1_395[@i_577]) && ((x2_436 = x2_394[@i_577]) && ((x3_435 = x3_393[@i_577]) && ((x4_434 = x4_392[@i_577]) && (x5_433 = x5_391[@i_577]))))) then
      (
        let sk_u: hash0 = r_390[@i_577] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_576 <= NS suchthat defined(x1_401[@i_576], x2_400[@i_576], x3_399[@i_576], x4_398[@i_576], x5_397[@i_576], r_396[@i_576]) && otheruses(r_396[@i_576]) && ((x1_437 = x1_401[@i_576]) && ((x2_436 = x2_400[@i_576]) && ((x3_435 = x3_399[@i_576]) && ((x4_434 = x4_398[@i_576]) && (x5_433 = x5_397[@i_576]))))) then
      (
        let sk_u: hash0 = r_396[@i_576] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_575 <= NS suchthat defined(x1_407[@i_575], x2_406[@i_575], x3_405[@i_575], x4_404[@i_575], x5_403[@i_575], r_402[@i_575]) && otheruses(r_402[@i_575]) && ((x1_437 = x1_407[@i_575]) && ((x2_436 = x2_406[@i_575]) && ((x3_435 = x3_405[@i_575]) && ((x4_434 = x4_404[@i_575]) && (x5_433 = x5_403[@i_575]))))) then
      (
        let sk_u: hash0 = r_402[@i_575] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_574 <= NU suchthat defined(x1_413[@i_574], x2_412[@i_574], x3_411[@i_574], x4_410[@i_574], x5_409[@i_574], r_408[@i_574]) && otheruses(r_408[@i_574]) && ((x1_437 = x1_413[@i_574]) && ((x2_436 = x2_412[@i_574]) && ((x3_435 = x3_411[@i_574]) && ((x4_434 = x4_410[@i_574]) && (x5_433 = x5_409[@i_574]))))) then
      (
        let sk_u: hash0 = r_408[@i_574] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_573 <= NU suchthat defined(x1_419[@i_573], x2_418[@i_573], x3_417[@i_573], x4_416[@i_573], x5_415[@i_573], r_414[@i_573]) && otheruses(r_414[@i_573]) && ((x1_437 = x1_419[@i_573]) && ((x2_436 = x2_418[@i_573]) && ((x3_435 = x3_417[@i_573]) && ((x4_434 = x4_416[@i_573]) && (x5_433 = x5_415[@i_573]))))) then
      (
        let sk_u: hash0 = r_414[@i_573] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_572 <= NU suchthat defined(x1_425[@i_572], x2_424[@i_572], x3_423[@i_572], x4_422[@i_572], x5_421[@i_572], r_420[@i_572]) && otheruses(r_420[@i_572]) && ((x1_437 = x1_425[@i_572]) && ((x2_436 = x2_424[@i_572]) && ((x3_435 = x3_423[@i_572]) && ((x4_434 = x4_422[@i_572]) && (x5_433 = x5_421[@i_572]))))) then
      (
        let sk_u: hash0 = r_420[@i_572] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_571 <= NU suchthat defined(x1_431[@i_571], x2_430[@i_571], x3_429[@i_571], x4_428[@i_571], x5_427[@i_571], r_426[@i_571]) && otheruses(r_426[@i_571]) && ((x1_437 = x1_431[@i_571]) && ((x2_436 = x2_430[@i_571]) && ((x3_435 = x3_429[@i_571]) && ((x4_434 = x4_428[@i_571]) && (x5_433 = x5_427[@i_571]))))) then
      (
        let sk_u: hash0 = r_426[@i_571] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_570 <= NU suchthat defined(x1_437[@i_570], x2_436[@i_570], x3_435[@i_570], x4_434[@i_570], x5_433[@i_570], r_432[@i_570]) && otheruses(r_432[@i_570]) && ((x1_437 = x1_437[@i_570]) && ((x2_436 = x2_436[@i_570]) && ((x3_435 = x3_435[@i_570]) && ((x4_434 = x4_434[@i_570]) && (x5_433 = x5_433[@i_570]))))) then
      (
        let sk_u: hash0 = r_432[@i_570] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_569 <= NU suchthat defined(x1_443[@i_569], x2_442[@i_569], x3_441[@i_569], x4_440[@i_569], x5_439[@i_569], r_438[@i_569]) && otheruses(r_438[@i_569]) && ((x1_437 = x1_443[@i_569]) && ((x2_436 = x2_442[@i_569]) && ((x3_435 = x3_441[@i_569]) && ((x4_434 = x4_440[@i_569]) && (x5_433 = x5_439[@i_569]))))) then
      (
        let sk_u: hash0 = r_438[@i_569] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_568 <= NU suchthat defined(x1_449[@i_568], x2_448[@i_568], x3_447[@i_568], x4_446[@i_568], x5_445[@i_568], r_444[@i_568]) && otheruses(r_444[@i_568]) && ((x1_437 = x1_449[@i_568]) && ((x2_436 = x2_448[@i_568]) && ((x3_435 = x3_447[@i_568]) && ((x4_434 = x4_446[@i_568]) && (x5_433 = x5_445[@i_568]))))) then
      (
        let sk_u: hash0 = r_444[@i_568] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_567 <= NU suchthat defined(x1_455[@i_567], x2_454[@i_567], x3_453[@i_567], x4_452[@i_567], x5_451[@i_567], r_450[@i_567]) && otheruses(r_450[@i_567]) && ((x1_437 = x1_455[@i_567]) && ((x2_436 = x2_454[@i_567]) && ((x3_435 = x3_453[@i_567]) && ((x4_434 = x4_452[@i_567]) && (x5_433 = x5_451[@i_567]))))) then
      (
        let sk_u: hash0 = r_450[@i_567] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_566 <= NU suchthat defined(x1_461[@i_566], x2_460[@i_566], x3_459[@i_566], x4_458[@i_566], x5_457[@i_566], r_456[@i_566]) && otheruses(r_456[@i_566]) && ((x1_437 = x1_461[@i_566]) && ((x2_436 = x2_460[@i_566]) && ((x3_435 = x3_459[@i_566]) && ((x4_434 = x4_458[@i_566]) && (x5_433 = x5_457[@i_566]))))) then
      (
        let sk_u: hash0 = r_456[@i_566] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let x1_431: host = U in
      let x2_430: host = S in
      let x3_429: G = X in
      let x4_428: G = @2_r4_172[@i_241] in
      let x5_427: G = K_u in
      find [unique] @i_565 <= qH0 suchthat defined(x1_389[@i_565], x2_388[@i_565], x3_387[@i_565], x4_386[@i_565], x5_385[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && ((x1_431 = x1_389[@i_565]) && ((x2_430 = x2_388[@i_565]) && ((x3_429 = x3_387[@i_565]) && ((x4_428 = x4_386[@i_565]) && (x5_427 = x5_385[@i_565]))))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_564 <= NP suchthat defined(x1_395[@i_564], x2_394[@i_564], x3_393[@i_564], x4_392[@i_564], x5_391[@i_564], r_390[@i_564]) && otheruses(r_390[@i_564]) && ((x1_431 = x1_395[@i_564]) && ((x2_430 = x2_394[@i_564]) && ((x3_429 = x3_393[@i_564]) && ((x4_428 = x4_392[@i_564]) && (x5_427 = x5_391[@i_564]))))) then
      (
        let sk_u: hash0 = r_390[@i_564] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_563 <= NS suchthat defined(x1_401[@i_563], x2_400[@i_563], x3_399[@i_563], x4_398[@i_563], x5_397[@i_563], r_396[@i_563]) && otheruses(r_396[@i_563]) && ((x1_431 = x1_401[@i_563]) && ((x2_430 = x2_400[@i_563]) && ((x3_429 = x3_399[@i_563]) && ((x4_428 = x4_398[@i_563]) && (x5_427 = x5_397[@i_563]))))) then
      (
        let sk_u: hash0 = r_396[@i_563] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_562 <= NS suchthat defined(x1_407[@i_562], x2_406[@i_562], x3_405[@i_562], x4_404[@i_562], x5_403[@i_562], r_402[@i_562]) && otheruses(r_402[@i_562]) && ((x1_431 = x1_407[@i_562]) && ((x2_430 = x2_406[@i_562]) && ((x3_429 = x3_405[@i_562]) && ((x4_428 = x4_404[@i_562]) && (x5_427 = x5_403[@i_562]))))) then
      (
        let sk_u: hash0 = r_402[@i_562] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_561 <= NU suchthat defined(x1_413[@i_561], x2_412[@i_561], x3_411[@i_561], x4_410[@i_561], x5_409[@i_561], r_408[@i_561]) && otheruses(r_408[@i_561]) && ((x1_431 = x1_413[@i_561]) && ((x2_430 = x2_412[@i_561]) && ((x3_429 = x3_411[@i_561]) && ((x4_428 = x4_410[@i_561]) && (x5_427 = x5_409[@i_561]))))) then
      (
        let sk_u: hash0 = r_408[@i_561] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_560 <= NU suchthat defined(x1_419[@i_560], x2_418[@i_560], x3_417[@i_560], x4_416[@i_560], x5_415[@i_560], r_414[@i_560]) && otheruses(r_414[@i_560]) && ((x1_431 = x1_419[@i_560]) && ((x2_430 = x2_418[@i_560]) && ((x3_429 = x3_417[@i_560]) && ((x4_428 = x4_416[@i_560]) && (x5_427 = x5_415[@i_560]))))) then
      (
        let sk_u: hash0 = r_414[@i_560] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_559 <= NU suchthat defined(x1_425[@i_559], x2_424[@i_559], x3_423[@i_559], x4_422[@i_559], x5_421[@i_559], r_420[@i_559]) && otheruses(r_420[@i_559]) && ((x1_431 = x1_425[@i_559]) && ((x2_430 = x2_424[@i_559]) && ((x3_429 = x3_423[@i_559]) && ((x4_428 = x4_422[@i_559]) && (x5_427 = x5_421[@i_559]))))) then
      (
        let sk_u: hash0 = r_420[@i_559] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_558 <= NU suchthat defined(x1_431[@i_558], x2_430[@i_558], x3_429[@i_558], x4_428[@i_558], x5_427[@i_558], r_426[@i_558]) && otheruses(r_426[@i_558]) && ((x1_431 = x1_431[@i_558]) && ((x2_430 = x2_430[@i_558]) && ((x3_429 = x3_429[@i_558]) && ((x4_428 = x4_428[@i_558]) && (x5_427 = x5_427[@i_558]))))) then
      (
        let sk_u: hash0 = r_426[@i_558] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_557 <= NU suchthat defined(x1_437[@i_557], x2_436[@i_557], x3_435[@i_557], x4_434[@i_557], x5_433[@i_557], r_432[@i_557]) && otheruses(r_432[@i_557]) && ((x1_431 = x1_437[@i_557]) && ((x2_430 = x2_436[@i_557]) && ((x3_429 = x3_435[@i_557]) && ((x4_428 = x4_434[@i_557]) && (x5_427 = x5_433[@i_557]))))) then
      (
        let sk_u: hash0 = r_432[@i_557] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_556 <= NU suchthat defined(x1_443[@i_556], x2_442[@i_556], x3_441[@i_556], x4_440[@i_556], x5_439[@i_556], r_438[@i_556]) && otheruses(r_438[@i_556]) && ((x1_431 = x1_443[@i_556]) && ((x2_430 = x2_442[@i_556]) && ((x3_429 = x3_441[@i_556]) && ((x4_428 = x4_440[@i_556]) && (x5_427 = x5_439[@i_556]))))) then
      (
        let sk_u: hash0 = r_438[@i_556] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_555 <= NU suchthat defined(x1_449[@i_555], x2_448[@i_555], x3_447[@i_555], x4_446[@i_555], x5_445[@i_555], r_444[@i_555]) && otheruses(r_444[@i_555]) && ((x1_431 = x1_449[@i_555]) && ((x2_430 = x2_448[@i_555]) && ((x3_429 = x3_447[@i_555]) && ((x4_428 = x4_446[@i_555]) && (x5_427 = x5_445[@i_555]))))) then
      (
        let sk_u: hash0 = r_444[@i_555] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_554 <= NU suchthat defined(x1_455[@i_554], x2_454[@i_554], x3_453[@i_554], x4_452[@i_554], x5_451[@i_554], r_450[@i_554]) && otheruses(r_450[@i_554]) && ((x1_431 = x1_455[@i_554]) && ((x2_430 = x2_454[@i_554]) && ((x3_429 = x3_453[@i_554]) && ((x4_428 = x4_452[@i_554]) && (x5_427 = x5_451[@i_554]))))) then
      (
        let sk_u: hash0 = r_450[@i_554] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_553 <= NU suchthat defined(x1_461[@i_553], x2_460[@i_553], x3_459[@i_553], x4_458[@i_553], x5_457[@i_553], r_456[@i_553]) && otheruses(r_456[@i_553]) && ((x1_431 = x1_461[@i_553]) && ((x2_430 = x2_460[@i_553]) && ((x3_429 = x3_459[@i_553]) && ((x4_428 = x4_458[@i_553]) && (x5_427 = x5_457[@i_553]))))) then
      (
        let sk_u: hash0 = r_456[@i_553] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_ke[@i_239], @2_x[@i_239], @2_x_162[@i_239], @2_ke_161[@i_239], @2_r2_160[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(Yp[@i_238], @2_x_165[@i_238], @2_r2_163[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      let x3_447: G = X in
      let x4_446: G = Yp[@i_238] in
      let x5_445: G = K_u in
      find [unique] @i_604 <= qH0 suchthat defined(x1_389[@i_604], x2_388[@i_604], x3_387[@i_604], x4_386[@i_604], x5_385[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && ((x1_449 = x1_389[@i_604]) && ((x2_448 = x2_388[@i_604]) && ((x3_447 = x3_387[@i_604]) && ((x4_446 = x4_386[@i_604]) && (x5_445 = x5_385[@i_604]))))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_603 <= NP suchthat defined(x1_395[@i_603], x2_394[@i_603], x3_393[@i_603], x4_392[@i_603], x5_391[@i_603], r_390[@i_603]) && otheruses(r_390[@i_603]) && ((x1_449 = x1_395[@i_603]) && ((x2_448 = x2_394[@i_603]) && ((x3_447 = x3_393[@i_603]) && ((x4_446 = x4_392[@i_603]) && (x5_445 = x5_391[@i_603]))))) then
      (
        let sk_u: hash0 = r_390[@i_603] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_602 <= NS suchthat defined(x1_401[@i_602], x2_400[@i_602], x3_399[@i_602], x4_398[@i_602], x5_397[@i_602], r_396[@i_602]) && otheruses(r_396[@i_602]) && ((x1_449 = x1_401[@i_602]) && ((x2_448 = x2_400[@i_602]) && ((x3_447 = x3_399[@i_602]) && ((x4_446 = x4_398[@i_602]) && (x5_445 = x5_397[@i_602]))))) then
      (
        let sk_u: hash0 = r_396[@i_602] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_601 <= NS suchthat defined(x1_407[@i_601], x2_406[@i_601], x3_405[@i_601], x4_404[@i_601], x5_403[@i_601], r_402[@i_601]) && otheruses(r_402[@i_601]) && ((x1_449 = x1_407[@i_601]) && ((x2_448 = x2_406[@i_601]) && ((x3_447 = x3_405[@i_601]) && ((x4_446 = x4_404[@i_601]) && (x5_445 = x5_403[@i_601]))))) then
      (
        let sk_u: hash0 = r_402[@i_601] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_600 <= NU suchthat defined(x1_413[@i_600], x2_412[@i_600], x3_411[@i_600], x4_410[@i_600], x5_409[@i_600], r_408[@i_600]) && otheruses(r_408[@i_600]) && ((x1_449 = x1_413[@i_600]) && ((x2_448 = x2_412[@i_600]) && ((x3_447 = x3_411[@i_600]) && ((x4_446 = x4_410[@i_600]) && (x5_445 = x5_409[@i_600]))))) then
      (
        let sk_u: hash0 = r_408[@i_600] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_599 <= NU suchthat defined(x1_419[@i_599], x2_418[@i_599], x3_417[@i_599], x4_416[@i_599], x5_415[@i_599], r_414[@i_599]) && otheruses(r_414[@i_599]) && ((x1_449 = x1_419[@i_599]) && ((x2_448 = x2_418[@i_599]) && ((x3_447 = x3_417[@i_599]) && ((x4_446 = x4_416[@i_599]) && (x5_445 = x5_415[@i_599]))))) then
      (
        let sk_u: hash0 = r_414[@i_599] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_598 <= NU suchthat defined(x1_425[@i_598], x2_424[@i_598], x3_423[@i_598], x4_422[@i_598], x5_421[@i_598], r_420[@i_598]) && otheruses(r_420[@i_598]) && ((x1_449 = x1_425[@i_598]) && ((x2_448 = x2_424[@i_598]) && ((x3_447 = x3_423[@i_598]) && ((x4_446 = x4_422[@i_598]) && (x5_445 = x5_421[@i_598]))))) then
      (
        let sk_u: hash0 = r_420[@i_598] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_597 <= NU suchthat defined(x1_431[@i_597], x2_430[@i_597], x3_429[@i_597], x4_428[@i_597], x5_427[@i_597], r_426[@i_597]) && otheruses(r_426[@i_597]) && ((x1_449 = x1_431[@i_597]) && ((x2_448 = x2_430[@i_597]) && ((x3_447 = x3_429[@i_597]) && ((x4_446 = x4_428[@i_597]) && (x5_445 = x5_427[@i_597]))))) then
      (
        let sk_u: hash0 = r_426[@i_597] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_596 <= NU suchthat defined(x1_437[@i_596], x2_436[@i_596], x3_435[@i_596], x4_434[@i_596], x5_433[@i_596], r_432[@i_596]) && otheruses(r_432[@i_596]) && ((x1_449 = x1_437[@i_596]) && ((x2_448 = x2_436[@i_596]) && ((x3_447 = x3_435[@i_596]) && ((x4_446 = x4_434[@i_596]) && (x5_445 = x5_433[@i_596]))))) then
      (
        let sk_u: hash0 = r_432[@i_596] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_595 <= NU suchthat defined(x1_443[@i_595], x2_442[@i_595], x3_441[@i_595], x4_440[@i_595], x5_439[@i_595], r_438[@i_595]) && otheruses(r_438[@i_595]) && ((x1_449 = x1_443[@i_595]) && ((x2_448 = x2_442[@i_595]) && ((x3_447 = x3_441[@i_595]) && ((x4_446 = x4_440[@i_595]) && (x5_445 = x5_439[@i_595]))))) then
      (
        let sk_u: hash0 = r_438[@i_595] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_594 <= NU suchthat defined(x1_449[@i_594], x2_448[@i_594], x3_447[@i_594], x4_446[@i_594], x5_445[@i_594], r_444[@i_594]) && otheruses(r_444[@i_594]) && ((x1_449 = x1_449[@i_594]) && ((x2_448 = x2_448[@i_594]) && ((x3_447 = x3_447[@i_594]) && ((x4_446 = x4_446[@i_594]) && (x5_445 = x5_445[@i_594]))))) then
      (
        let sk_u: hash0 = r_444[@i_594] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_593 <= NU suchthat defined(x1_455[@i_593], x2_454[@i_593], x3_453[@i_593], x4_452[@i_593], x5_451[@i_593], r_450[@i_593]) && otheruses(r_450[@i_593]) && ((x1_449 = x1_455[@i_593]) && ((x2_448 = x2_454[@i_593]) && ((x3_447 = x3_453[@i_593]) && ((x4_446 = x4_452[@i_593]) && (x5_445 = x5_451[@i_593]))))) then
      (
        let sk_u: hash0 = r_450[@i_593] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_592 <= NU suchthat defined(x1_461[@i_592], x2_460[@i_592], x3_459[@i_592], x4_458[@i_592], x5_457[@i_592], r_456[@i_592]) && otheruses(r_456[@i_592]) && ((x1_449 = x1_461[@i_592]) && ((x2_448 = x2_460[@i_592]) && ((x3_447 = x3_459[@i_592]) && ((x4_446 = x4_458[@i_592]) && (x5_445 = x5_457[@i_592]))))) then
      (
        let sk_u: hash0 = r_456[@i_592] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let x1_443: host = U in
      let x2_442: host = S in
      let x3_441: G = X in
      let x4_440: G = Yp[@i_238] in
      let x5_439: G = K_u in
      find [unique] @i_591 <= qH0 suchthat defined(x1_389[@i_591], x2_388[@i_591], x3_387[@i_591], x4_386[@i_591], x5_385[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && ((x1_443 = x1_389[@i_591]) && ((x2_442 = x2_388[@i_591]) && ((x3_441 = x3_387[@i_591]) && ((x4_440 = x4_386[@i_591]) && (x5_439 = x5_385[@i_591]))))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_590 <= NP suchthat defined(x1_395[@i_590], x2_394[@i_590], x3_393[@i_590], x4_392[@i_590], x5_391[@i_590], r_390[@i_590]) && otheruses(r_390[@i_590]) && ((x1_443 = x1_395[@i_590]) && ((x2_442 = x2_394[@i_590]) && ((x3_441 = x3_393[@i_590]) && ((x4_440 = x4_392[@i_590]) && (x5_439 = x5_391[@i_590]))))) then
      (
        let sk_u: hash0 = r_390[@i_590] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_589 <= NS suchthat defined(x1_401[@i_589], x2_400[@i_589], x3_399[@i_589], x4_398[@i_589], x5_397[@i_589], r_396[@i_589]) && otheruses(r_396[@i_589]) && ((x1_443 = x1_401[@i_589]) && ((x2_442 = x2_400[@i_589]) && ((x3_441 = x3_399[@i_589]) && ((x4_440 = x4_398[@i_589]) && (x5_439 = x5_397[@i_589]))))) then
      (
        let sk_u: hash0 = r_396[@i_589] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_588 <= NS suchthat defined(x1_407[@i_588], x2_406[@i_588], x3_405[@i_588], x4_404[@i_588], x5_403[@i_588], r_402[@i_588]) && otheruses(r_402[@i_588]) && ((x1_443 = x1_407[@i_588]) && ((x2_442 = x2_406[@i_588]) && ((x3_441 = x3_405[@i_588]) && ((x4_440 = x4_404[@i_588]) && (x5_439 = x5_403[@i_588]))))) then
      (
        let sk_u: hash0 = r_402[@i_588] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_587 <= NU suchthat defined(x1_413[@i_587], x2_412[@i_587], x3_411[@i_587], x4_410[@i_587], x5_409[@i_587], r_408[@i_587]) && otheruses(r_408[@i_587]) && ((x1_443 = x1_413[@i_587]) && ((x2_442 = x2_412[@i_587]) && ((x3_441 = x3_411[@i_587]) && ((x4_440 = x4_410[@i_587]) && (x5_439 = x5_409[@i_587]))))) then
      (
        let sk_u: hash0 = r_408[@i_587] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_586 <= NU suchthat defined(x1_419[@i_586], x2_418[@i_586], x3_417[@i_586], x4_416[@i_586], x5_415[@i_586], r_414[@i_586]) && otheruses(r_414[@i_586]) && ((x1_443 = x1_419[@i_586]) && ((x2_442 = x2_418[@i_586]) && ((x3_441 = x3_417[@i_586]) && ((x4_440 = x4_416[@i_586]) && (x5_439 = x5_415[@i_586]))))) then
      (
        let sk_u: hash0 = r_414[@i_586] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_585 <= NU suchthat defined(x1_425[@i_585], x2_424[@i_585], x3_423[@i_585], x4_422[@i_585], x5_421[@i_585], r_420[@i_585]) && otheruses(r_420[@i_585]) && ((x1_443 = x1_425[@i_585]) && ((x2_442 = x2_424[@i_585]) && ((x3_441 = x3_423[@i_585]) && ((x4_440 = x4_422[@i_585]) && (x5_439 = x5_421[@i_585]))))) then
      (
        let sk_u: hash0 = r_420[@i_585] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_584 <= NU suchthat defined(x1_431[@i_584], x2_430[@i_584], x3_429[@i_584], x4_428[@i_584], x5_427[@i_584], r_426[@i_584]) && otheruses(r_426[@i_584]) && ((x1_443 = x1_431[@i_584]) && ((x2_442 = x2_430[@i_584]) && ((x3_441 = x3_429[@i_584]) && ((x4_440 = x4_428[@i_584]) && (x5_439 = x5_427[@i_584]))))) then
      (
        let sk_u: hash0 = r_426[@i_584] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_583 <= NU suchthat defined(x1_437[@i_583], x2_436[@i_583], x3_435[@i_583], x4_434[@i_583], x5_433[@i_583], r_432[@i_583]) && otheruses(r_432[@i_583]) && ((x1_443 = x1_437[@i_583]) && ((x2_442 = x2_436[@i_583]) && ((x3_441 = x3_435[@i_583]) && ((x4_440 = x4_434[@i_583]) && (x5_439 = x5_433[@i_583]))))) then
      (
        let sk_u: hash0 = r_432[@i_583] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_582 <= NU suchthat defined(x1_443[@i_582], x2_442[@i_582], x3_441[@i_582], x4_440[@i_582], x5_439[@i_582], r_438[@i_582]) && otheruses(r_438[@i_582]) && ((x1_443 = x1_443[@i_582]) && ((x2_442 = x2_442[@i_582]) && ((x3_441 = x3_441[@i_582]) && ((x4_440 = x4_440[@i_582]) && (x5_439 = x5_439[@i_582]))))) then
      (
        let sk_u: hash0 = r_438[@i_582] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_581 <= NU suchthat defined(x1_449[@i_581], x2_448[@i_581], x3_447[@i_581], x4_446[@i_581], x5_445[@i_581], r_444[@i_581]) && otheruses(r_444[@i_581]) && ((x1_443 = x1_449[@i_581]) && ((x2_442 = x2_448[@i_581]) && ((x3_441 = x3_447[@i_581]) && ((x4_440 = x4_446[@i_581]) && (x5_439 = x5_445[@i_581]))))) then
      (
        let sk_u: hash0 = r_444[@i_581] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_580 <= NU suchthat defined(x1_455[@i_580], x2_454[@i_580], x3_453[@i_580], x4_452[@i_580], x5_451[@i_580], r_450[@i_580]) && otheruses(r_450[@i_580]) && ((x1_443 = x1_455[@i_580]) && ((x2_442 = x2_454[@i_580]) && ((x3_441 = x3_453[@i_580]) && ((x4_440 = x4_452[@i_580]) && (x5_439 = x5_451[@i_580]))))) then
      (
        let sk_u: hash0 = r_450[@i_580] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_579 <= NU suchthat defined(x1_461[@i_579], x2_460[@i_579], x3_459[@i_579], x4_458[@i_579], x5_457[@i_579], r_456[@i_579]) && otheruses(r_456[@i_579]) && ((x1_443 = x1_461[@i_579]) && ((x2_442 = x2_460[@i_579]) && ((x3_441 = x3_459[@i_579]) && ((x4_440 = x4_458[@i_579]) && (x5_439 = x5_457[@i_579]))))) then
      (
        let sk_u: hash0 = r_456[@i_579] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(Y[@i_236], @2_x_171[@i_236], @2_r2_169[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      let x3_459: G = X in
      let x4_458: G = Y[@i_236] in
      let x5_457: G = K_u in
      find [unique] @i_630 <= qH0 suchthat defined(x1_389[@i_630], x2_388[@i_630], x3_387[@i_630], x4_386[@i_630], x5_385[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && ((x1_461 = x1_389[@i_630]) && ((x2_460 = x2_388[@i_630]) && ((x3_459 = x3_387[@i_630]) && ((x4_458 = x4_386[@i_630]) && (x5_457 = x5_385[@i_630]))))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_629 <= NP suchthat defined(x1_395[@i_629], x2_394[@i_629], x3_393[@i_629], x4_392[@i_629], x5_391[@i_629], r_390[@i_629]) && otheruses(r_390[@i_629]) && ((x1_461 = x1_395[@i_629]) && ((x2_460 = x2_394[@i_629]) && ((x3_459 = x3_393[@i_629]) && ((x4_458 = x4_392[@i_629]) && (x5_457 = x5_391[@i_629]))))) then
      (
        let sk_u: hash0 = r_390[@i_629] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_628 <= NS suchthat defined(x1_401[@i_628], x2_400[@i_628], x3_399[@i_628], x4_398[@i_628], x5_397[@i_628], r_396[@i_628]) && otheruses(r_396[@i_628]) && ((x1_461 = x1_401[@i_628]) && ((x2_460 = x2_400[@i_628]) && ((x3_459 = x3_399[@i_628]) && ((x4_458 = x4_398[@i_628]) && (x5_457 = x5_397[@i_628]))))) then
      (
        let sk_u: hash0 = r_396[@i_628] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_627 <= NS suchthat defined(x1_407[@i_627], x2_406[@i_627], x3_405[@i_627], x4_404[@i_627], x5_403[@i_627], r_402[@i_627]) && otheruses(r_402[@i_627]) && ((x1_461 = x1_407[@i_627]) && ((x2_460 = x2_406[@i_627]) && ((x3_459 = x3_405[@i_627]) && ((x4_458 = x4_404[@i_627]) && (x5_457 = x5_403[@i_627]))))) then
      (
        let sk_u: hash0 = r_402[@i_627] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_626 <= NU suchthat defined(x1_413[@i_626], x2_412[@i_626], x3_411[@i_626], x4_410[@i_626], x5_409[@i_626], r_408[@i_626]) && otheruses(r_408[@i_626]) && ((x1_461 = x1_413[@i_626]) && ((x2_460 = x2_412[@i_626]) && ((x3_459 = x3_411[@i_626]) && ((x4_458 = x4_410[@i_626]) && (x5_457 = x5_409[@i_626]))))) then
      (
        let sk_u: hash0 = r_408[@i_626] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_625 <= NU suchthat defined(x1_419[@i_625], x2_418[@i_625], x3_417[@i_625], x4_416[@i_625], x5_415[@i_625], r_414[@i_625]) && otheruses(r_414[@i_625]) && ((x1_461 = x1_419[@i_625]) && ((x2_460 = x2_418[@i_625]) && ((x3_459 = x3_417[@i_625]) && ((x4_458 = x4_416[@i_625]) && (x5_457 = x5_415[@i_625]))))) then
      (
        let sk_u: hash0 = r_414[@i_625] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_624 <= NU suchthat defined(x1_425[@i_624], x2_424[@i_624], x3_423[@i_624], x4_422[@i_624], x5_421[@i_624], r_420[@i_624]) && otheruses(r_420[@i_624]) && ((x1_461 = x1_425[@i_624]) && ((x2_460 = x2_424[@i_624]) && ((x3_459 = x3_423[@i_624]) && ((x4_458 = x4_422[@i_624]) && (x5_457 = x5_421[@i_624]))))) then
      (
        let sk_u: hash0 = r_420[@i_624] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_623 <= NU suchthat defined(x1_431[@i_623], x2_430[@i_623], x3_429[@i_623], x4_428[@i_623], x5_427[@i_623], r_426[@i_623]) && otheruses(r_426[@i_623]) && ((x1_461 = x1_431[@i_623]) && ((x2_460 = x2_430[@i_623]) && ((x3_459 = x3_429[@i_623]) && ((x4_458 = x4_428[@i_623]) && (x5_457 = x5_427[@i_623]))))) then
      (
        let sk_u: hash0 = r_426[@i_623] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_622 <= NU suchthat defined(x1_437[@i_622], x2_436[@i_622], x3_435[@i_622], x4_434[@i_622], x5_433[@i_622], r_432[@i_622]) && otheruses(r_432[@i_622]) && ((x1_461 = x1_437[@i_622]) && ((x2_460 = x2_436[@i_622]) && ((x3_459 = x3_435[@i_622]) && ((x4_458 = x4_434[@i_622]) && (x5_457 = x5_433[@i_622]))))) then
      (
        let sk_u: hash0 = r_432[@i_622] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_621 <= NU suchthat defined(x1_443[@i_621], x2_442[@i_621], x3_441[@i_621], x4_440[@i_621], x5_439[@i_621], r_438[@i_621]) && otheruses(r_438[@i_621]) && ((x1_461 = x1_443[@i_621]) && ((x2_460 = x2_442[@i_621]) && ((x3_459 = x3_441[@i_621]) && ((x4_458 = x4_440[@i_621]) && (x5_457 = x5_439[@i_621]))))) then
      (
        let sk_u: hash0 = r_438[@i_621] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_620 <= NU suchthat defined(x1_449[@i_620], x2_448[@i_620], x3_447[@i_620], x4_446[@i_620], x5_445[@i_620], r_444[@i_620]) && otheruses(r_444[@i_620]) && ((x1_461 = x1_449[@i_620]) && ((x2_460 = x2_448[@i_620]) && ((x3_459 = x3_447[@i_620]) && ((x4_458 = x4_446[@i_620]) && (x5_457 = x5_445[@i_620]))))) then
      (
        let sk_u: hash0 = r_444[@i_620] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_619 <= NU suchthat defined(x1_455[@i_619], x2_454[@i_619], x3_453[@i_619], x4_452[@i_619], x5_451[@i_619], r_450[@i_619]) && otheruses(r_450[@i_619]) && ((x1_461 = x1_455[@i_619]) && ((x2_460 = x2_454[@i_619]) && ((x3_459 = x3_453[@i_619]) && ((x4_458 = x4_452[@i_619]) && (x5_457 = x5_451[@i_619]))))) then
      (
        let sk_u: hash0 = r_450[@i_619] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_618 <= NU suchthat defined(x1_461[@i_618], x2_460[@i_618], x3_459[@i_618], x4_458[@i_618], x5_457[@i_618], r_456[@i_618]) && otheruses(r_456[@i_618]) && ((x1_461 = x1_461[@i_618]) && ((x2_460 = x2_460[@i_618]) && ((x3_459 = x3_459[@i_618]) && ((x4_458 = x4_458[@i_618]) && (x5_457 = x5_457[@i_618]))))) then
      (
        let sk_u: hash0 = r_456[@i_618] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let x1_455: host = U in
      let x2_454: host = S in
      let x3_453: G = X in
      let x4_452: G = Y[@i_236] in
      let x5_451: G = K_u in
      find [unique] @i_617 <= qH0 suchthat defined(x1_389[@i_617], x2_388[@i_617], x3_387[@i_617], x4_386[@i_617], x5_385[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && ((x1_455 = x1_389[@i_617]) && ((x2_454 = x2_388[@i_617]) && ((x3_453 = x3_387[@i_617]) && ((x4_452 = x4_386[@i_617]) && (x5_451 = x5_385[@i_617]))))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_616 <= NP suchthat defined(x1_395[@i_616], x2_394[@i_616], x3_393[@i_616], x4_392[@i_616], x5_391[@i_616], r_390[@i_616]) && otheruses(r_390[@i_616]) && ((x1_455 = x1_395[@i_616]) && ((x2_454 = x2_394[@i_616]) && ((x3_453 = x3_393[@i_616]) && ((x4_452 = x4_392[@i_616]) && (x5_451 = x5_391[@i_616]))))) then
      (
        let sk_u: hash0 = r_390[@i_616] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_615 <= NS suchthat defined(x1_401[@i_615], x2_400[@i_615], x3_399[@i_615], x4_398[@i_615], x5_397[@i_615], r_396[@i_615]) && otheruses(r_396[@i_615]) && ((x1_455 = x1_401[@i_615]) && ((x2_454 = x2_400[@i_615]) && ((x3_453 = x3_399[@i_615]) && ((x4_452 = x4_398[@i_615]) && (x5_451 = x5_397[@i_615]))))) then
      (
        let sk_u: hash0 = r_396[@i_615] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_614 <= NS suchthat defined(x1_407[@i_614], x2_406[@i_614], x3_405[@i_614], x4_404[@i_614], x5_403[@i_614], r_402[@i_614]) && otheruses(r_402[@i_614]) && ((x1_455 = x1_407[@i_614]) && ((x2_454 = x2_406[@i_614]) && ((x3_453 = x3_405[@i_614]) && ((x4_452 = x4_404[@i_614]) && (x5_451 = x5_403[@i_614]))))) then
      (
        let sk_u: hash0 = r_402[@i_614] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_613 <= NU suchthat defined(x1_413[@i_613], x2_412[@i_613], x3_411[@i_613], x4_410[@i_613], x5_409[@i_613], r_408[@i_613]) && otheruses(r_408[@i_613]) && ((x1_455 = x1_413[@i_613]) && ((x2_454 = x2_412[@i_613]) && ((x3_453 = x3_411[@i_613]) && ((x4_452 = x4_410[@i_613]) && (x5_451 = x5_409[@i_613]))))) then
      (
        let sk_u: hash0 = r_408[@i_613] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_612 <= NU suchthat defined(x1_419[@i_612], x2_418[@i_612], x3_417[@i_612], x4_416[@i_612], x5_415[@i_612], r_414[@i_612]) && otheruses(r_414[@i_612]) && ((x1_455 = x1_419[@i_612]) && ((x2_454 = x2_418[@i_612]) && ((x3_453 = x3_417[@i_612]) && ((x4_452 = x4_416[@i_612]) && (x5_451 = x5_415[@i_612]))))) then
      (
        let sk_u: hash0 = r_414[@i_612] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_611 <= NU suchthat defined(x1_425[@i_611], x2_424[@i_611], x3_423[@i_611], x4_422[@i_611], x5_421[@i_611], r_420[@i_611]) && otheruses(r_420[@i_611]) && ((x1_455 = x1_425[@i_611]) && ((x2_454 = x2_424[@i_611]) && ((x3_453 = x3_423[@i_611]) && ((x4_452 = x4_422[@i_611]) && (x5_451 = x5_421[@i_611]))))) then
      (
        let sk_u: hash0 = r_420[@i_611] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_610 <= NU suchthat defined(x1_431[@i_610], x2_430[@i_610], x3_429[@i_610], x4_428[@i_610], x5_427[@i_610], r_426[@i_610]) && otheruses(r_426[@i_610]) && ((x1_455 = x1_431[@i_610]) && ((x2_454 = x2_430[@i_610]) && ((x3_453 = x3_429[@i_610]) && ((x4_452 = x4_428[@i_610]) && (x5_451 = x5_427[@i_610]))))) then
      (
        let sk_u: hash0 = r_426[@i_610] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_609 <= NU suchthat defined(x1_437[@i_609], x2_436[@i_609], x3_435[@i_609], x4_434[@i_609], x5_433[@i_609], r_432[@i_609]) && otheruses(r_432[@i_609]) && ((x1_455 = x1_437[@i_609]) && ((x2_454 = x2_436[@i_609]) && ((x3_453 = x3_435[@i_609]) && ((x4_452 = x4_434[@i_609]) && (x5_451 = x5_433[@i_609]))))) then
      (
        let sk_u: hash0 = r_432[@i_609] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_608 <= NU suchthat defined(x1_443[@i_608], x2_442[@i_608], x3_441[@i_608], x4_440[@i_608], x5_439[@i_608], r_438[@i_608]) && otheruses(r_438[@i_608]) && ((x1_455 = x1_443[@i_608]) && ((x2_454 = x2_442[@i_608]) && ((x3_453 = x3_441[@i_608]) && ((x4_452 = x4_440[@i_608]) && (x5_451 = x5_439[@i_608]))))) then
      (
        let sk_u: hash0 = r_438[@i_608] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_607 <= NU suchthat defined(x1_449[@i_607], x2_448[@i_607], x3_447[@i_607], x4_446[@i_607], x5_445[@i_607], r_444[@i_607]) && otheruses(r_444[@i_607]) && ((x1_455 = x1_449[@i_607]) && ((x2_454 = x2_448[@i_607]) && ((x3_453 = x3_447[@i_607]) && ((x4_452 = x4_446[@i_607]) && (x5_451 = x5_445[@i_607]))))) then
      (
        let sk_u: hash0 = r_444[@i_607] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_606 <= NU suchthat defined(x1_455[@i_606], x2_454[@i_606], x3_453[@i_606], x4_452[@i_606], x5_451[@i_606], r_450[@i_606]) && otheruses(r_450[@i_606]) && ((x1_455 = x1_455[@i_606]) && ((x2_454 = x2_454[@i_606]) && ((x3_453 = x3_453[@i_606]) && ((x4_452 = x4_452[@i_606]) && (x5_451 = x5_451[@i_606]))))) then
      (
        let sk_u: hash0 = r_450[@i_606] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_605 <= NU suchthat defined(x1_461[@i_605], x2_460[@i_605], x3_459[@i_605], x4_458[@i_605], x5_457[@i_605], r_456[@i_605]) && otheruses(r_456[@i_605]) && ((x1_455 = x1_461[@i_605]) && ((x2_454 = x2_460[@i_605]) && ((x3_453 = x3_459[@i_605]) && ((x4_452 = x4_458[@i_605]) && (x5_451 = x5_457[@i_605]))))) then
      (
        let sk_u: hash0 = r_456[@i_605] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
  )
  else
    new @2_r4_172: G;
    let Y_u: G = @2_r4_172 in
    let K_u: G = exp(@2_r4_172, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    let x3_411: G = X in
    let x4_410: G = @2_r4_172 in
    let x5_409: G = K_u in
    find [unique] @i_526 <= qH0 suchthat defined(x1_389[@i_526], x2_388[@i_526], x3_387[@i_526], x4_386[@i_526], x5_385[@i_526], r_384[@i_526]) && otheruses(r_384[@i_526]) && ((x1_413 = x1_389[@i_526]) && ((x2_412 = x2_388[@i_526]) && ((x3_411 = x3_387[@i_526]) && ((x4_410 = x4_386[@i_526]) && (x5_409 = x5_385[@i_526]))))) then
    (
      let sk_u: hash0 = r_384[@i_526] in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
    )
    orfind @i_525 <= NP suchthat defined(x1_395[@i_525], x2_394[@i_525], x3_393[@i_525], x4_392[@i_525], x5_391[@i_525], r_390[@i_525]) && otheruses(r_390[@i_525]) && ((x1_413 = x1_395[@i_525]) && ((x2_412 = x2_394[@i_525]) && ((x3_411 = x3_393[@i_525]) && ((x4_410 = x4_392[@i_525]) && (x5_409 = x5_391[@i_525]))))) then
    (
      let sk_u: hash0 = r_390[@i_525] in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
    )
    orfind @i_524 <= NS suchthat defined(x1_401[@i_524], x2_400[@i_524], x3_399[@i_524], x4_398[@i_524], x5_397[@i_524], r_396[@i_524]) && otheruses(r_396[@i_524]) && ((x1_413 = x1_401[@i_524]) && ((x2_412 = x2_400[@i_524]) && ((x3_411 = x3_399[@i_524]) && ((x4_410 = x4_398[@i_524]) && (x5_409 = x5_397[@i_524]))))) then
    (
      let sk_u: hash0 = r_396[@i_524] in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
    )
    orfind @i_523 <= NS suchthat defined(x1_407[@i_523], x2_406[@i_523], x3_405[@i_523], x4_404[@i_523], x5_403[@i_523], r_402[@i_523]) && otheruses(r_402[@i_523]) && ((x1_413 = x1_407[@i_523]) && ((x2_412 = x2_406[@i_523]) && ((x3_411 = x3_405[@i_523]) && ((x4_410 = x4_404[@i_523]) && (x5_409 = x5_403[@i_523]))))) then
    (
      let sk_u: hash0 = r_402[@i_523] in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
    )
    orfind @i_522 <= NU suchthat defined(x1_413[@i_522], x2_412[@i_522], x3_411[@i_522], x4_410[@i_522], x5_409[@i_522], r_408[@i_522]) && otheruses(r_408[@i_522]) && ((x1_413 = x1_413[@i_522]) && ((x2_412 = x2_412[@i_522]) && ((x3_411 = x3_411[@i_522]) && ((x4_410 = x4_410[@i_522]) && (x5_409 = x5_409[@i_522]))))) then
    (
      let sk_u: hash0 = r_408[@i_522] in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
    )
    orfind @i_521 <= NU suchthat defined(x1_419[@i_521], x2_418[@i_521], x3_417[@i_521], x4_416[@i_521], x5_415[@i_521], r_414[@i_521]) && otheruses(r_414[@i_521]) && ((x1_413 = x1_419[@i_521]) && ((x2_412 = x2_418[@i_521]) && ((x3_411 = x3_417[@i_521]) && ((x4_410 = x4_416[@i_521]) && (x5_409 = x5_415[@i_521]))))) then
    (
      let sk_u: hash0 = r_414[@i_521] in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
    )
    orfind @i_520 <= NU suchthat defined(x1_425[@i_520], x2_424[@i_520], x3_423[@i_520], x4_422[@i_520], x5_421[@i_520], r_420[@i_520]) && otheruses(r_420[@i_520]) && ((x1_413 = x1_425[@i_520]) && ((x2_412 = x2_424[@i_520]) && ((x3_411 = x3_423[@i_520]) && ((x4_410 = x4_422[@i_520]) && (x5_409 = x5_421[@i_520]))))) then
    (
      let sk_u: hash0 = r_420[@i_520] in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
    )
    orfind @i_519 <= NU suchthat defined(x1_431[@i_519], x2_430[@i_519], x3_429[@i_519], x4_428[@i_519], x5_427[@i_519], r_426[@i_519]) && otheruses(r_426[@i_519]) && ((x1_413 = x1_431[@i_519]) && ((x2_412 = x2_430[@i_519]) && ((x3_411 = x3_429[@i_519]) && ((x4_410 = x4_428[@i_519]) && (x5_409 = x5_427[@i_519]))))) then
    (
      let sk_u: hash0 = r_426[@i_519] in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
    )
    orfind @i_518 <= NU suchthat defined(x1_437[@i_518], x2_436[@i_518], x3_435[@i_518], x4_434[@i_518], x5_433[@i_518], r_432[@i_518]) && otheruses(r_432[@i_518]) && ((x1_413 = x1_437[@i_518]) && ((x2_412 = x2_436[@i_518]) && ((x3_411 = x3_435[@i_518]) && ((x4_410 = x4_434[@i_518]) && (x5_409 = x5_433[@i_518]))))) then
    (
      let sk_u: hash0 = r_432[@i_518] in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
    )
    orfind @i_517 <= NU suchthat defined(x1_443[@i_517], x2_442[@i_517], x3_441[@i_517], x4_440[@i_517], x5_439[@i_517], r_438[@i_517]) && otheruses(r_438[@i_517]) && ((x1_413 = x1_443[@i_517]) && ((x2_412 = x2_442[@i_517]) && ((x3_411 = x3_441[@i_517]) && ((x4_410 = x4_440[@i_517]) && (x5_409 = x5_439[@i_517]))))) then
    (
      let sk_u: hash0 = r_438[@i_517] in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
    )
    orfind @i_516 <= NU suchthat defined(x1_449[@i_516], x2_448[@i_516], x3_447[@i_516], x4_446[@i_516], x5_445[@i_516], r_444[@i_516]) && otheruses(r_444[@i_516]) && ((x1_413 = x1_449[@i_516]) && ((x2_412 = x2_448[@i_516]) && ((x3_411 = x3_447[@i_516]) && ((x4_410 = x4_446[@i_516]) && (x5_409 = x5_445[@i_516]))))) then
    (
      let sk_u: hash0 = r_444[@i_516] in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
    )
    orfind @i_515 <= NU suchthat defined(x1_455[@i_515], x2_454[@i_515], x3_453[@i_515], x4_452[@i_515], x5_451[@i_515], r_450[@i_515]) && otheruses(r_450[@i_515]) && ((x1_413 = x1_455[@i_515]) && ((x2_412 = x2_454[@i_515]) && ((x3_411 = x3_453[@i_515]) && ((x4_410 = x4_452[@i_515]) && (x5_409 = x5_451[@i_515]))))) then
    (
      let sk_u: hash0 = r_450[@i_515] in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
    )
    orfind @i_514 <= NU suchthat defined(x1_461[@i_514], x2_460[@i_514], x3_459[@i_514], x4_458[@i_514], x5_457[@i_514], r_456[@i_514]) && otheruses(r_456[@i_514]) && ((x1_413 = x1_461[@i_514]) && ((x2_412 = x2_460[@i_514]) && ((x3_411 = x3_459[@i_514]) && ((x4_410 = x4_458[@i_514]) && (x5_409 = x5_457[@i_514]))))) then
    (
      let sk_u: hash0 = r_456[@i_514] in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
    )
    else
      new r_408: hash0;
      let sk_u: hash0 = r_408 in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let @2_x_171: G = cst_G in
  let @2_ke_170: passwd = cst_passwd in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      let x3_399: G = X_s in
      let x4_398: G = Y in
      let x5_397: G = K_s in
      find [unique] @i_500 <= qH0 suchthat defined(x1_389[@i_500], x2_388[@i_500], x3_387[@i_500], x4_386[@i_500], x5_385[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && ((x1_401 = x1_389[@i_500]) && ((x2_400 = x2_388[@i_500]) && ((x3_399 = x3_387[@i_500]) && ((x4_398 = x4_386[@i_500]) && (x5_397 = x5_385[@i_500]))))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_499 <= NP suchthat defined(x1_395[@i_499], x2_394[@i_499], x3_393[@i_499], x4_392[@i_499], x5_391[@i_499], r_390[@i_499]) && otheruses(r_390[@i_499]) && ((x1_401 = x1_395[@i_499]) && ((x2_400 = x2_394[@i_499]) && ((x3_399 = x3_393[@i_499]) && ((x4_398 = x4_392[@i_499]) && (x5_397 = x5_391[@i_499]))))) then
      (
        let sk_s: hash0 = r_390[@i_499] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_498 <= NS suchthat defined(x1_401[@i_498], x2_400[@i_498], x3_399[@i_498], x4_398[@i_498], x5_397[@i_498], r_396[@i_498]) && otheruses(r_396[@i_498]) && ((x1_401 = x1_401[@i_498]) && ((x2_400 = x2_400[@i_498]) && ((x3_399 = x3_399[@i_498]) && ((x4_398 = x4_398[@i_498]) && (x5_397 = x5_397[@i_498]))))) then
      (
        let sk_s: hash0 = r_396[@i_498] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_497 <= NS suchthat defined(x1_407[@i_497], x2_406[@i_497], x3_405[@i_497], x4_404[@i_497], x5_403[@i_497], r_402[@i_497]) && otheruses(r_402[@i_497]) && ((x1_401 = x1_407[@i_497]) && ((x2_400 = x2_406[@i_497]) && ((x3_399 = x3_405[@i_497]) && ((x4_398 = x4_404[@i_497]) && (x5_397 = x5_403[@i_497]))))) then
      (
        let sk_s: hash0 = r_402[@i_497] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_496 <= NU suchthat defined(x1_413[@i_496], x2_412[@i_496], x3_411[@i_496], x4_410[@i_496], x5_409[@i_496], r_408[@i_496]) && otheruses(r_408[@i_496]) && ((x1_401 = x1_413[@i_496]) && ((x2_400 = x2_412[@i_496]) && ((x3_399 = x3_411[@i_496]) && ((x4_398 = x4_410[@i_496]) && (x5_397 = x5_409[@i_496]))))) then
      (
        let sk_s: hash0 = r_408[@i_496] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_495 <= NU suchthat defined(x1_419[@i_495], x2_418[@i_495], x3_417[@i_495], x4_416[@i_495], x5_415[@i_495], r_414[@i_495]) && otheruses(r_414[@i_495]) && ((x1_401 = x1_419[@i_495]) && ((x2_400 = x2_418[@i_495]) && ((x3_399 = x3_417[@i_495]) && ((x4_398 = x4_416[@i_495]) && (x5_397 = x5_415[@i_495]))))) then
      (
        let sk_s: hash0 = r_414[@i_495] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_494 <= NU suchthat defined(x1_425[@i_494], x2_424[@i_494], x3_423[@i_494], x4_422[@i_494], x5_421[@i_494], r_420[@i_494]) && otheruses(r_420[@i_494]) && ((x1_401 = x1_425[@i_494]) && ((x2_400 = x2_424[@i_494]) && ((x3_399 = x3_423[@i_494]) && ((x4_398 = x4_422[@i_494]) && (x5_397 = x5_421[@i_494]))))) then
      (
        let sk_s: hash0 = r_420[@i_494] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_493 <= NU suchthat defined(x1_431[@i_493], x2_430[@i_493], x3_429[@i_493], x4_428[@i_493], x5_427[@i_493], r_426[@i_493]) && otheruses(r_426[@i_493]) && ((x1_401 = x1_431[@i_493]) && ((x2_400 = x2_430[@i_493]) && ((x3_399 = x3_429[@i_493]) && ((x4_398 = x4_428[@i_493]) && (x5_397 = x5_427[@i_493]))))) then
      (
        let sk_s: hash0 = r_426[@i_493] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_492 <= NU suchthat defined(x1_437[@i_492], x2_436[@i_492], x3_435[@i_492], x4_434[@i_492], x5_433[@i_492], r_432[@i_492]) && otheruses(r_432[@i_492]) && ((x1_401 = x1_437[@i_492]) && ((x2_400 = x2_436[@i_492]) && ((x3_399 = x3_435[@i_492]) && ((x4_398 = x4_434[@i_492]) && (x5_397 = x5_433[@i_492]))))) then
      (
        let sk_s: hash0 = r_432[@i_492] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_491 <= NU suchthat defined(x1_443[@i_491], x2_442[@i_491], x3_441[@i_491], x4_440[@i_491], x5_439[@i_491], r_438[@i_491]) && otheruses(r_438[@i_491]) && ((x1_401 = x1_443[@i_491]) && ((x2_400 = x2_442[@i_491]) && ((x3_399 = x3_441[@i_491]) && ((x4_398 = x4_440[@i_491]) && (x5_397 = x5_439[@i_491]))))) then
      (
        let sk_s: hash0 = r_438[@i_491] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_490 <= NU suchthat defined(x1_449[@i_490], x2_448[@i_490], x3_447[@i_490], x4_446[@i_490], x5_445[@i_490], r_444[@i_490]) && otheruses(r_444[@i_490]) && ((x1_401 = x1_449[@i_490]) && ((x2_400 = x2_448[@i_490]) && ((x3_399 = x3_447[@i_490]) && ((x4_398 = x4_446[@i_490]) && (x5_397 = x5_445[@i_490]))))) then
      (
        let sk_s: hash0 = r_444[@i_490] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_489 <= NU suchthat defined(x1_455[@i_489], x2_454[@i_489], x3_453[@i_489], x4_452[@i_489], x5_451[@i_489], r_450[@i_489]) && otheruses(r_450[@i_489]) && ((x1_401 = x1_455[@i_489]) && ((x2_400 = x2_454[@i_489]) && ((x3_399 = x3_453[@i_489]) && ((x4_398 = x4_452[@i_489]) && (x5_397 = x5_451[@i_489]))))) then
      (
        let sk_s: hash0 = r_450[@i_489] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_488 <= NU suchthat defined(x1_461[@i_488], x2_460[@i_488], x3_459[@i_488], x4_458[@i_488], x5_457[@i_488], r_456[@i_488]) && otheruses(r_456[@i_488]) && ((x1_401 = x1_461[@i_488]) && ((x2_400 = x2_460[@i_488]) && ((x3_399 = x3_459[@i_488]) && ((x4_398 = x4_458[@i_488]) && (x5_397 = x5_457[@i_488]))))) then
      (
        let sk_s: hash0 = r_456[@i_488] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = X_s in
      let x4_404: G = Y in
      let x5_403: G = K_s in
      find [unique] @i_513 <= qH0 suchthat defined(x1_389[@i_513], x2_388[@i_513], x3_387[@i_513], x4_386[@i_513], x5_385[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1_389[@i_513]) && ((x2_406 = x2_388[@i_513]) && ((x3_405 = x3_387[@i_513]) && ((x4_404 = x4_386[@i_513]) && (x5_403 = x5_385[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_512 <= NP suchthat defined(x1_395[@i_512], x2_394[@i_512], x3_393[@i_512], x4_392[@i_512], x5_391[@i_512], r_390[@i_512]) && otheruses(r_390[@i_512]) && ((x1_407 = x1_395[@i_512]) && ((x2_406 = x2_394[@i_512]) && ((x3_405 = x3_393[@i_512]) && ((x4_404 = x4_392[@i_512]) && (x5_403 = x5_391[@i_512]))))) then
      (
        let sk_s: hash0 = r_390[@i_512] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_511 <= NS suchthat defined(x1_401[@i_511], x2_400[@i_511], x3_399[@i_511], x4_398[@i_511], x5_397[@i_511], r_396[@i_511]) && otheruses(r_396[@i_511]) && ((x1_407 = x1_401[@i_511]) && ((x2_406 = x2_400[@i_511]) && ((x3_405 = x3_399[@i_511]) && ((x4_404 = x4_398[@i_511]) && (x5_403 = x5_397[@i_511]))))) then
      (
        let sk_s: hash0 = r_396[@i_511] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_510 <= NS suchthat defined(x1_407[@i_510], x2_406[@i_510], x3_405[@i_510], x4_404[@i_510], x5_403[@i_510], r_402[@i_510]) && otheruses(r_402[@i_510]) && ((x1_407 = x1_407[@i_510]) && ((x2_406 = x2_406[@i_510]) && ((x3_405 = x3_405[@i_510]) && ((x4_404 = x4_404[@i_510]) && (x5_403 = x5_403[@i_510]))))) then
      (
        let sk_s: hash0 = r_402[@i_510] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_509 <= NU suchthat defined(x1_413[@i_509], x2_412[@i_509], x3_411[@i_509], x4_410[@i_509], x5_409[@i_509], r_408[@i_509]) && otheruses(r_408[@i_509]) && ((x1_407 = x1_413[@i_509]) && ((x2_406 = x2_412[@i_509]) && ((x3_405 = x3_411[@i_509]) && ((x4_404 = x4_410[@i_509]) && (x5_403 = x5_409[@i_509]))))) then
      (
        let sk_s: hash0 = r_408[@i_509] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_508 <= NU suchthat defined(x1_419[@i_508], x2_418[@i_508], x3_417[@i_508], x4_416[@i_508], x5_415[@i_508], r_414[@i_508]) && otheruses(r_414[@i_508]) && ((x1_407 = x1_419[@i_508]) && ((x2_406 = x2_418[@i_508]) && ((x3_405 = x3_417[@i_508]) && ((x4_404 = x4_416[@i_508]) && (x5_403 = x5_415[@i_508]))))) then
      (
        let sk_s: hash0 = r_414[@i_508] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_507 <= NU suchthat defined(x1_425[@i_507], x2_424[@i_507], x3_423[@i_507], x4_422[@i_507], x5_421[@i_507], r_420[@i_507]) && otheruses(r_420[@i_507]) && ((x1_407 = x1_425[@i_507]) && ((x2_406 = x2_424[@i_507]) && ((x3_405 = x3_423[@i_507]) && ((x4_404 = x4_422[@i_507]) && (x5_403 = x5_421[@i_507]))))) then
      (
        let sk_s: hash0 = r_420[@i_507] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_506 <= NU suchthat defined(x1_431[@i_506], x2_430[@i_506], x3_429[@i_506], x4_428[@i_506], x5_427[@i_506], r_426[@i_506]) && otheruses(r_426[@i_506]) && ((x1_407 = x1_431[@i_506]) && ((x2_406 = x2_430[@i_506]) && ((x3_405 = x3_429[@i_506]) && ((x4_404 = x4_428[@i_506]) && (x5_403 = x5_427[@i_506]))))) then
      (
        let sk_s: hash0 = r_426[@i_506] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_505 <= NU suchthat defined(x1_437[@i_505], x2_436[@i_505], x3_435[@i_505], x4_434[@i_505], x5_433[@i_505], r_432[@i_505]) && otheruses(r_432[@i_505]) && ((x1_407 = x1_437[@i_505]) && ((x2_406 = x2_436[@i_505]) && ((x3_405 = x3_435[@i_505]) && ((x4_404 = x4_434[@i_505]) && (x5_403 = x5_433[@i_505]))))) then
      (
        let sk_s: hash0 = r_432[@i_505] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_504 <= NU suchthat defined(x1_443[@i_504], x2_442[@i_504], x3_441[@i_504], x4_440[@i_504], x5_439[@i_504], r_438[@i_504]) && otheruses(r_438[@i_504]) && ((x1_407 = x1_443[@i_504]) && ((x2_406 = x2_442[@i_504]) && ((x3_405 = x3_441[@i_504]) && ((x4_404 = x4_440[@i_504]) && (x5_403 = x5_439[@i_504]))))) then
      (
        let sk_s: hash0 = r_438[@i_504] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_503 <= NU suchthat defined(x1_449[@i_503], x2_448[@i_503], x3_447[@i_503], x4_446[@i_503], x5_445[@i_503], r_444[@i_503]) && otheruses(r_444[@i_503]) && ((x1_407 = x1_449[@i_503]) && ((x2_406 = x2_448[@i_503]) && ((x3_405 = x3_447[@i_503]) && ((x4_404 = x4_446[@i_503]) && (x5_403 = x5_445[@i_503]))))) then
      (
        let sk_s: hash0 = r_444[@i_503] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_502 <= NU suchthat defined(x1_455[@i_502], x2_454[@i_502], x3_453[@i_502], x4_452[@i_502], x5_451[@i_502], r_450[@i_502]) && otheruses(r_450[@i_502]) && ((x1_407 = x1_455[@i_502]) && ((x2_406 = x2_454[@i_502]) && ((x3_405 = x3_453[@i_502]) && ((x4_404 = x4_452[@i_502]) && (x5_403 = x5_451[@i_502]))))) then
      (
        let sk_s: hash0 = r_450[@i_502] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_501 <= NU suchthat defined(x1_461[@i_501], x2_460[@i_501], x3_459[@i_501], x4_458[@i_501], x5_457[@i_501], r_456[@i_501]) && otheruses(r_456[@i_501]) && ((x1_407 = x1_461[@i_501]) && ((x2_406 = x2_460[@i_501]) && ((x3_405 = x3_459[@i_501]) && ((x4_404 = x4_458[@i_501]) && (x5_403 = x5_457[@i_501]))))) then
      (
        let sk_s: hash0 = r_456[@i_501] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @2_kd_158[@i_222], @2_m_159[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @2_r4_157[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@2_r4_157[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @2_m_174[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @2_r4_172[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@2_r4_172[@i_217] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let @2_x_165: G = cst_G in
  let @2_ke_164: passwd = cst_passwd in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  let x3_393: G = Xp in
  let x4_392: G = Yp in
  let x5_391: G = Kp in
  find [unique] @i_487 <= qH0 suchthat defined(x1_389[@i_487], x2_388[@i_487], x3_387[@i_487], x4_386[@i_487], x5_385[@i_487], r_384[@i_487]) && otheruses(r_384[@i_487]) && ((x1_395 = x1_389[@i_487]) && ((x2_394 = x2_388[@i_487]) && ((x3_393 = x3_387[@i_487]) && ((x4_392 = x4_386[@i_487]) && (x5_391 = x5_385[@i_487]))))) then
  (
    let sk_p: hash0 = r_384[@i_487] in
    out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
  )
  orfind @i_486 <= NP suchthat defined(x1_395[@i_486], x2_394[@i_486], x3_393[@i_486], x4_392[@i_486], x5_391[@i_486], r_390[@i_486]) && otheruses(r_390[@i_486]) && ((x1_395 = x1_395[@i_486]) && ((x2_394 = x2_394[@i_486]) && ((x3_393 = x3_393[@i_486]) && ((x4_392 = x4_392[@i_486]) && (x5_391 = x5_391[@i_486]))))) then
  (
    let sk_p: hash0 = r_390[@i_486] in
    out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
  )
  orfind @i_485 <= NS suchthat defined(x1_401[@i_485], x2_400[@i_485], x3_399[@i_485], x4_398[@i_485], x5_397[@i_485], r_396[@i_485]) && otheruses(r_396[@i_485]) && ((x1_395 = x1_401[@i_485]) && ((x2_394 = x2_400[@i_485]) && ((x3_393 = x3_399[@i_485]) && ((x4_392 = x4_398[@i_485]) && (x5_391 = x5_397[@i_485]))))) then
  (
    let sk_p: hash0 = r_396[@i_485] in
    out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
  )
  orfind @i_484 <= NS suchthat defined(x1_407[@i_484], x2_406[@i_484], x3_405[@i_484], x4_404[@i_484], x5_403[@i_484], r_402[@i_484]) && otheruses(r_402[@i_484]) && ((x1_395 = x1_407[@i_484]) && ((x2_394 = x2_406[@i_484]) && ((x3_393 = x3_405[@i_484]) && ((x4_392 = x4_404[@i_484]) && (x5_391 = x5_403[@i_484]))))) then
  (
    let sk_p: hash0 = r_402[@i_484] in
    out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
  )
  orfind @i_483 <= NU suchthat defined(x1_413[@i_483], x2_412[@i_483], x3_411[@i_483], x4_410[@i_483], x5_409[@i_483], r_408[@i_483]) && otheruses(r_408[@i_483]) && ((x1_395 = x1_413[@i_483]) && ((x2_394 = x2_412[@i_483]) && ((x3_393 = x3_411[@i_483]) && ((x4_392 = x4_410[@i_483]) && (x5_391 = x5_409[@i_483]))))) then
  (
    let sk_p: hash0 = r_408[@i_483] in
    out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
  )
  orfind @i_482 <= NU suchthat defined(x1_419[@i_482], x2_418[@i_482], x3_417[@i_482], x4_416[@i_482], x5_415[@i_482], r_414[@i_482]) && otheruses(r_414[@i_482]) && ((x1_395 = x1_419[@i_482]) && ((x2_394 = x2_418[@i_482]) && ((x3_393 = x3_417[@i_482]) && ((x4_392 = x4_416[@i_482]) && (x5_391 = x5_415[@i_482]))))) then
  (
    let sk_p: hash0 = r_414[@i_482] in
    out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
  )
  orfind @i_481 <= NU suchthat defined(x1_425[@i_481], x2_424[@i_481], x3_423[@i_481], x4_422[@i_481], x5_421[@i_481], r_420[@i_481]) && otheruses(r_420[@i_481]) && ((x1_395 = x1_425[@i_481]) && ((x2_394 = x2_424[@i_481]) && ((x3_393 = x3_423[@i_481]) && ((x4_392 = x4_422[@i_481]) && (x5_391 = x5_421[@i_481]))))) then
  (
    let sk_p: hash0 = r_420[@i_481] in
    out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
  )
  orfind @i_480 <= NU suchthat defined(x1_431[@i_480], x2_430[@i_480], x3_429[@i_480], x4_428[@i_480], x5_427[@i_480], r_426[@i_480]) && otheruses(r_426[@i_480]) && ((x1_395 = x1_431[@i_480]) && ((x2_394 = x2_430[@i_480]) && ((x3_393 = x3_429[@i_480]) && ((x4_392 = x4_428[@i_480]) && (x5_391 = x5_427[@i_480]))))) then
  (
    let sk_p: hash0 = r_426[@i_480] in
    out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
  )
  orfind @i_479 <= NU suchthat defined(x1_437[@i_479], x2_436[@i_479], x3_435[@i_479], x4_434[@i_479], x5_433[@i_479], r_432[@i_479]) && otheruses(r_432[@i_479]) && ((x1_395 = x1_437[@i_479]) && ((x2_394 = x2_436[@i_479]) && ((x3_393 = x3_435[@i_479]) && ((x4_392 = x4_434[@i_479]) && (x5_391 = x5_433[@i_479]))))) then
  (
    let sk_p: hash0 = r_432[@i_479] in
    out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
  )
  orfind @i_478 <= NU suchthat defined(x1_443[@i_478], x2_442[@i_478], x3_441[@i_478], x4_440[@i_478], x5_439[@i_478], r_438[@i_478]) && otheruses(r_438[@i_478]) && ((x1_395 = x1_443[@i_478]) && ((x2_394 = x2_442[@i_478]) && ((x3_393 = x3_441[@i_478]) && ((x4_392 = x4_440[@i_478]) && (x5_391 = x5_439[@i_478]))))) then
  (
    let sk_p: hash0 = r_438[@i_478] in
    out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
  )
  orfind @i_477 <= NU suchthat defined(x1_449[@i_477], x2_448[@i_477], x3_447[@i_477], x4_446[@i_477], x5_445[@i_477], r_444[@i_477]) && otheruses(r_444[@i_477]) && ((x1_395 = x1_449[@i_477]) && ((x2_394 = x2_448[@i_477]) && ((x3_393 = x3_447[@i_477]) && ((x4_392 = x4_446[@i_477]) && (x5_391 = x5_445[@i_477]))))) then
  (
    let sk_p: hash0 = r_444[@i_477] in
    out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
  )
  orfind @i_476 <= NU suchthat defined(x1_455[@i_476], x2_454[@i_476], x3_453[@i_476], x4_452[@i_476], x5_451[@i_476], r_450[@i_476]) && otheruses(r_450[@i_476]) && ((x1_395 = x1_455[@i_476]) && ((x2_394 = x2_454[@i_476]) && ((x3_393 = x3_453[@i_476]) && ((x4_392 = x4_452[@i_476]) && (x5_391 = x5_451[@i_476]))))) then
  (
    let sk_p: hash0 = r_450[@i_476] in
    out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
  )
  orfind @i_475 <= NU suchthat defined(x1_461[@i_475], x2_460[@i_475], x3_459[@i_475], x4_458[@i_475], x5_457[@i_475], r_456[@i_475]) && otheruses(r_456[@i_475]) && ((x1_395 = x1_461[@i_475]) && ((x2_394 = x2_460[@i_475]) && ((x3_393 = x3_459[@i_475]) && ((x4_392 = x4_458[@i_475]) && (x5_391 = x5_457[@i_475]))))) then
  (
    let sk_p: hash0 = r_456[@i_475] in
    out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
  )
  else
    new r_390: hash0;
    let sk_p: hash0 = r_390 in
    out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  let @2_x_162: G = cst_G in
  let @2_ke_161: passwd = cst_passwd in
  find [unique] @i_198 <= qD suchthat defined(@2_kd[@i_198], @2_m[@i_198], @2_m_159[@i_198], @2_kd_158[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @2_r4_157[@i_198]) && ((@2_x = @2_r4_157[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(pw, Ystar_u[@i_193], @2_m_174[@i_193], @2_kd_173[@i_193], @2_r4_172[@i_193]) && otheruses(Ystar_u[@i_193] -> @2_r4_172[@i_193]) && ((@2_x = @2_r4_172[@i_193]) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_ke_161[@i_191], @2_x_162[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], pw, @2_ke_164[@i_190], @2_x_165[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], pw, @2_ke_170[@i_188], @2_x_171[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  let @2_m_159: G = cst_G in
  let @2_kd_158: passwd = cst_passwd in
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @2_kd_158[@i_186], @2_m_159[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @2_r4_157[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @2_r4_157[@i_186])
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], pw, @2_kd_173[@i_181], @2_m_174[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @2_r4_172[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], @2_r4_172[@i_181])
  orfind @i_179 <= qE suchthat defined(@2_ke[@i_179], @2_x[@i_179], @2_x_162[@i_179], @2_ke_161[@i_179], @2_r2_160[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(pw, Yp[@i_178], @2_x_165[@i_178], @2_ke_164[@i_178], @2_r2_163[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(pw, Y[@i_176], @2_x_171[@i_176], @2_ke_170[@i_176], @2_r2_169[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @2_r4_157: G;
    out(@2_c4[!_45], @2_r4_157)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_389: host = x1 in
  let x2_388: host = x2 in
  let x3_387: G = x3 in
  let x4_386: G = x4 in
  let x5_385: G = x5 in
  find [unique] @i_474 <= qH0 suchthat defined(x1_389[@i_474], x2_388[@i_474], x3_387[@i_474], x4_386[@i_474], x5_385[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1_389 = x1_389[@i_474]) && ((x2_388 = x2_388[@i_474]) && ((x3_387 = x3_387[@i_474]) && ((x4_386 = x4_386[@i_474]) && (x5_385 = x5_385[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(x1_395[@i_473], x2_394[@i_473], x3_393[@i_473], x4_392[@i_473], x5_391[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && ((x1_389 = x1_395[@i_473]) && ((x2_388 = x2_394[@i_473]) && ((x3_387 = x3_393[@i_473]) && ((x4_386 = x4_392[@i_473]) && (x5_385 = x5_391[@i_473]))))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(x1_401[@i_472], x2_400[@i_472], x3_399[@i_472], x4_398[@i_472], x5_397[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && ((x1_389 = x1_401[@i_472]) && ((x2_388 = x2_400[@i_472]) && ((x3_387 = x3_399[@i_472]) && ((x4_386 = x4_398[@i_472]) && (x5_385 = x5_397[@i_472]))))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(x1_407[@i_471], x2_406[@i_471], x3_405[@i_471], x4_404[@i_471], x5_403[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && ((x1_389 = x1_407[@i_471]) && ((x2_388 = x2_406[@i_471]) && ((x3_387 = x3_405[@i_471]) && ((x4_386 = x4_404[@i_471]) && (x5_385 = x5_403[@i_471]))))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(x1_413[@i_470], x2_412[@i_470], x3_411[@i_470], x4_410[@i_470], x5_409[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && ((x1_389 = x1_413[@i_470]) && ((x2_388 = x2_412[@i_470]) && ((x3_387 = x3_411[@i_470]) && ((x4_386 = x4_410[@i_470]) && (x5_385 = x5_409[@i_470]))))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(x1_419[@i_469], x2_418[@i_469], x3_417[@i_469], x4_416[@i_469], x5_415[@i_469], r_414[@i_469]) && otheruses(r_414[@i_469]) && ((x1_389 = x1_419[@i_469]) && ((x2_388 = x2_418[@i_469]) && ((x3_387 = x3_417[@i_469]) && ((x4_386 = x4_416[@i_469]) && (x5_385 = x5_415[@i_469]))))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(x1_425[@i_468], x2_424[@i_468], x3_423[@i_468], x4_422[@i_468], x5_421[@i_468], r_420[@i_468]) && otheruses(r_420[@i_468]) && ((x1_389 = x1_425[@i_468]) && ((x2_388 = x2_424[@i_468]) && ((x3_387 = x3_423[@i_468]) && ((x4_386 = x4_422[@i_468]) && (x5_385 = x5_421[@i_468]))))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(x1_431[@i_467], x2_430[@i_467], x3_429[@i_467], x4_428[@i_467], x5_427[@i_467], r_426[@i_467]) && otheruses(r_426[@i_467]) && ((x1_389 = x1_431[@i_467]) && ((x2_388 = x2_430[@i_467]) && ((x3_387 = x3_429[@i_467]) && ((x4_386 = x4_428[@i_467]) && (x5_385 = x5_427[@i_467]))))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(x1_437[@i_466], x2_436[@i_466], x3_435[@i_466], x4_434[@i_466], x5_433[@i_466], r_432[@i_466]) && otheruses(r_432[@i_466]) && ((x1_389 = x1_437[@i_466]) && ((x2_388 = x2_436[@i_466]) && ((x3_387 = x3_435[@i_466]) && ((x4_386 = x4_434[@i_466]) && (x5_385 = x5_433[@i_466]))))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(x1_443[@i_465], x2_442[@i_465], x3_441[@i_465], x4_440[@i_465], x5_439[@i_465], r_438[@i_465]) && otheruses(r_438[@i_465]) && ((x1_389 = x1_443[@i_465]) && ((x2_388 = x2_442[@i_465]) && ((x3_387 = x3_441[@i_465]) && ((x4_386 = x4_440[@i_465]) && (x5_385 = x5_439[@i_465]))))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(x1_449[@i_464], x2_448[@i_464], x3_447[@i_464], x4_446[@i_464], x5_445[@i_464], r_444[@i_464]) && otheruses(r_444[@i_464]) && ((x1_389 = x1_449[@i_464]) && ((x2_388 = x2_448[@i_464]) && ((x3_387 = x3_447[@i_464]) && ((x4_386 = x4_446[@i_464]) && (x5_385 = x5_445[@i_464]))))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(x1_455[@i_463], x2_454[@i_463], x3_453[@i_463], x4_452[@i_463], x5_451[@i_463], r_450[@i_463]) && otheruses(r_450[@i_463]) && ((x1_389 = x1_455[@i_463]) && ((x2_388 = x2_454[@i_463]) && ((x3_387 = x3_453[@i_463]) && ((x4_386 = x4_452[@i_463]) && (x5_385 = x5_451[@i_463]))))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(x1_461[@i_462], x2_460[@i_462], x3_459[@i_462], x4_458[@i_462], x5_457[@i_462], r_456[@i_462]) && otheruses(r_456[@i_462]) && ((x1_389 = x1_461[@i_462]) && ((x2_388 = x2_460[@i_462]) && ((x3_387 = x3_459[@i_462]) && ((x4_386 = x4_458[@i_462]) && (x5_385 = x5_457[@i_462]))))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying simplify [Excluding set(dist 16->17, proba <= 1. / |exponent| * NP + 15. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + 10. * NU * NP / |exponent| + 2. * NS * NP / |exponent| + qH0 * NP / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + 8.5 * NU * NU / |G| + 3. * NS * NU / |G| + 2. * NP * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NP * qD / |G| + qD * NP / |exponent| + NU * qH1 / |hash1| + qD * NU / |G| + 0.5 * qD * qD / |G|)] yields

Game 17 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let @2_m_174: G = cst_G in
  let @2_kd_173: passwd = cst_passwd in
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @2_r4_157[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = @2_r4_157[@i_246] in
    let K_u: G = exp(@2_r4_157[@i_246], x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((@2_r4_157[@i_246] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      let x3_423: G = X in
      let x4_422: G = @2_r4_157[@i_246] in
      let x5_421: G = K_u in
      find [unique] @i_552 <= qH0 suchthat defined(x1_389[@i_552], x2_388[@i_552], x3_387[@i_552], x4_386[@i_552], x5_385[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && ((x1_425 = x1_389[@i_552]) && ((x2_424 = x2_388[@i_552]) && ((x3_423 = x3_387[@i_552]) && ((x4_422 = x4_386[@i_552]) && (x5_421 = x5_385[@i_552]))))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let x1_419: host = U in
      let x2_418: host = S in
      let x3_417: G = X in
      let x4_416: G = @2_r4_157[@i_246] in
      let x5_415: G = K_u in
      find [unique] @i_539 <= qH0 suchthat defined(x1_389[@i_539], x2_388[@i_539], x3_387[@i_539], x4_386[@i_539], x5_385[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && ((x1_419 = x1_389[@i_539]) && ((x2_418 = x2_388[@i_539]) && ((x3_417 = x3_387[@i_539]) && ((x4_416 = x4_386[@i_539]) && (x5_415 = x5_385[@i_539]))))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @2_r4_172[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = @2_r4_172[@i_241] in
    let K_u: G = exp(@2_r4_172[@i_241], x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((@2_r4_172[@i_241] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      let x3_435: G = X in
      let x4_434: G = @2_r4_172[@i_241] in
      let x5_433: G = K_u in
      find [unique] @i_578 <= qH0 suchthat defined(x1_389[@i_578], x2_388[@i_578], x3_387[@i_578], x4_386[@i_578], x5_385[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && ((x1_437 = x1_389[@i_578]) && ((x2_436 = x2_388[@i_578]) && ((x3_435 = x3_387[@i_578]) && ((x4_434 = x4_386[@i_578]) && (x5_433 = x5_385[@i_578]))))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let x1_431: host = U in
      let x2_430: host = S in
      let x3_429: G = X in
      let x4_428: G = @2_r4_172[@i_241] in
      let x5_427: G = K_u in
      find [unique] @i_565 <= qH0 suchthat defined(x1_389[@i_565], x2_388[@i_565], x3_387[@i_565], x4_386[@i_565], x5_385[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && ((x1_431 = x1_389[@i_565]) && ((x2_430 = x2_388[@i_565]) && ((x3_429 = x3_387[@i_565]) && ((x4_428 = x4_386[@i_565]) && (x5_427 = x5_385[@i_565]))))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      let x3_447: G = X in
      let x4_446: G = Yp[@i_238] in
      let x5_445: G = K_u in
      find [unique] @i_604 <= qH0 suchthat defined(x1_389[@i_604], x2_388[@i_604], x3_387[@i_604], x4_386[@i_604], x5_385[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && ((x1_449 = x1_389[@i_604]) && ((x2_448 = x2_388[@i_604]) && ((x3_447 = x3_387[@i_604]) && ((x4_446 = x4_386[@i_604]) && (x5_445 = x5_385[@i_604]))))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let x1_443: host = U in
      let x2_442: host = S in
      let x3_441: G = X in
      let x4_440: G = Yp[@i_238] in
      let x5_439: G = K_u in
      find [unique] @i_591 <= qH0 suchthat defined(x1_389[@i_591], x2_388[@i_591], x3_387[@i_591], x4_386[@i_591], x5_385[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && ((x1_443 = x1_389[@i_591]) && ((x2_442 = x2_388[@i_591]) && ((x3_441 = x3_387[@i_591]) && ((x4_440 = x4_386[@i_591]) && (x5_439 = x5_385[@i_591]))))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      let x3_459: G = X in
      let x4_458: G = Y[@i_236] in
      let x5_457: G = K_u in
      find [unique] @i_630 <= qH0 suchthat defined(x1_389[@i_630], x2_388[@i_630], x3_387[@i_630], x4_386[@i_630], x5_385[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && ((x1_461 = x1_389[@i_630]) && ((x2_460 = x2_388[@i_630]) && ((x3_459 = x3_387[@i_630]) && ((x4_458 = x4_386[@i_630]) && (x5_457 = x5_385[@i_630]))))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind  suchthat defined(j[@i_236], r_396[@i_236]) && otheruses(r_396[@i_236]) && (!_41 = j[@i_236]) then
      (
        let @i_628 <= NS = @i_236 in
        let sk_u: hash0 = r_396[@i_236] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let x1_455: host = U in
      let x2_454: host = S in
      let x3_453: G = X in
      let x4_452: G = Y[@i_236] in
      let x5_451: G = K_u in
      find [unique] @i_617 <= qH0 suchthat defined(x1_389[@i_617], x2_388[@i_617], x3_387[@i_617], x4_386[@i_617], x5_385[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && ((x1_455 = x1_389[@i_617]) && ((x2_454 = x2_388[@i_617]) && ((x3_453 = x3_387[@i_617]) && ((x4_452 = x4_386[@i_617]) && (x5_451 = x5_385[@i_617]))))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
  )
  else
    new @2_r4_172: G;
    let Y_u: G = @2_r4_172 in
    let K_u: G = exp(@2_r4_172, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    let x3_411: G = X in
    let x4_410: G = @2_r4_172 in
    let x5_409: G = K_u in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, sk_u);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let @2_x_171: G = cst_G in
  let @2_ke_170: passwd = cst_passwd in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      let x3_399: G = X_s in
      let x4_398: G = Y in
      let x5_397: G = K_s in
      find [unique] @i_500 <= qH0 suchthat defined(x1_389[@i_500], x2_388[@i_500], x3_387[@i_500], x4_386[@i_500], x5_385[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && ((x1_401 = x1_389[@i_500]) && ((x2_400 = x2_388[@i_500]) && ((x3_399 = x3_387[@i_500]) && ((x4_398 = x4_386[@i_500]) && (x5_397 = x5_385[@i_500]))))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind  suchthat defined(@i_236[j], r_450[j]) && otheruses(r_450[j]) && (!_42 = @i_236[j]) then
      (
        let @i_489 <= NU = j in
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind  suchthat defined(@i_236[j], r_456[j]) && otheruses(r_456[j]) && (!_42 = @i_236[j]) then
      (
        let @i_488 <= NU = j in
        let sk_s: hash0 = r_456[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = X_s in
      let x4_404: G = Y in
      let x5_403: G = K_s in
      find [unique] @i_513 <= qH0 suchthat defined(x1_389[@i_513], x2_388[@i_513], x3_387[@i_513], x4_386[@i_513], x5_385[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1_389[@i_513]) && ((x2_406 = x2_388[@i_513]) && ((x3_405 = x3_387[@i_513]) && ((x4_404 = x4_386[@i_513]) && (x5_403 = x5_385[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let @i_502 <= NU = j in
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @2_r4_157[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@2_r4_157[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @2_r4_172[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@2_r4_172[@i_217] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let @2_x_165: G = cst_G in
  let @2_ke_164: passwd = cst_passwd in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  let x3_393: G = Xp in
  let x4_392: G = Yp in
  let x5_391: G = Kp in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  let @2_x_162: G = cst_G in
  let @2_ke_161: passwd = cst_passwd in
  find [unique] @i_198 <= qD suchthat defined(@2_r4_157[@i_198], @2_kd[@i_198], @2_m[@i_198]) && otheruses(@2_m[@i_198] -> @2_r4_157[@i_198]) && ((@2_x = @2_r4_157[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@2_r4_172[@i_193], Ystar_u[@i_193]) && otheruses(Ystar_u[@i_193] -> @2_r4_172[@i_193]) && ((@2_x = @2_r4_172[@i_193]) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  let @2_m_159: G = cst_G in
  let @2_kd_158: passwd = cst_passwd in
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @2_r4_157[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @2_r4_157[@i_186])
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @2_r4_172[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], @2_r4_172[@i_181])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @2_r4_157: G;
    out(@2_c4[!_45], @2_r4_157)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_389: host = x1 in
  let x2_388: host = x2 in
  let x3_387: G = x3 in
  let x4_386: G = x4 in
  let x5_385: G = x5 in
  find [unique] @i_474 <= qH0 suchthat defined(x1_389[@i_474], x2_388[@i_474], x3_387[@i_474], x4_386[@i_474], x5_385[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1_389 = x1_389[@i_474]) && ((x2_388 = x2_388[@i_474]) && ((x3_387 = x3_387[@i_474]) && ((x4_386 = x4_386[@i_474]) && (x5_385 = x5_385[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(x1_395[@i_473], x2_394[@i_473], x3_393[@i_473], x4_392[@i_473], x5_391[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && ((x1_389 = x1_395[@i_473]) && ((x2_388 = x2_394[@i_473]) && ((x3_387 = x3_393[@i_473]) && ((x4_386 = x4_392[@i_473]) && (x5_385 = x5_391[@i_473]))))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(x1_401[@i_472], x2_400[@i_472], x3_399[@i_472], x4_398[@i_472], x5_397[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && ((x1_389 = x1_401[@i_472]) && ((x2_388 = x2_400[@i_472]) && ((x3_387 = x3_399[@i_472]) && ((x4_386 = x4_398[@i_472]) && (x5_385 = x5_397[@i_472]))))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(x1_407[@i_471], x2_406[@i_471], x3_405[@i_471], x4_404[@i_471], x5_403[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && ((x1_389 = x1_407[@i_471]) && ((x2_388 = x2_406[@i_471]) && ((x3_387 = x3_405[@i_471]) && ((x4_386 = x4_404[@i_471]) && (x5_385 = x5_403[@i_471]))))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(x1_413[@i_470], x2_412[@i_470], x3_411[@i_470], x4_410[@i_470], x5_409[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && ((x1_389 = x1_413[@i_470]) && ((x2_388 = x2_412[@i_470]) && ((x3_387 = x3_411[@i_470]) && ((x4_386 = x4_410[@i_470]) && (x5_385 = x5_409[@i_470]))))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(x1_419[@i_469], x2_418[@i_469], x3_417[@i_469], x4_416[@i_469], x5_415[@i_469], r_414[@i_469]) && otheruses(r_414[@i_469]) && ((x1_389 = x1_419[@i_469]) && ((x2_388 = x2_418[@i_469]) && ((x3_387 = x3_417[@i_469]) && ((x4_386 = x4_416[@i_469]) && (x5_385 = x5_415[@i_469]))))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(x1_425[@i_468], x2_424[@i_468], x3_423[@i_468], x4_422[@i_468], x5_421[@i_468], r_420[@i_468]) && otheruses(r_420[@i_468]) && ((x1_389 = x1_425[@i_468]) && ((x2_388 = x2_424[@i_468]) && ((x3_387 = x3_423[@i_468]) && ((x4_386 = x4_422[@i_468]) && (x5_385 = x5_421[@i_468]))))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(x1_431[@i_467], x2_430[@i_467], x3_429[@i_467], x4_428[@i_467], x5_427[@i_467], r_426[@i_467]) && otheruses(r_426[@i_467]) && ((x1_389 = x1_431[@i_467]) && ((x2_388 = x2_430[@i_467]) && ((x3_387 = x3_429[@i_467]) && ((x4_386 = x4_428[@i_467]) && (x5_385 = x5_427[@i_467]))))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(x1_437[@i_466], x2_436[@i_466], x3_435[@i_466], x4_434[@i_466], x5_433[@i_466], r_432[@i_466]) && otheruses(r_432[@i_466]) && ((x1_389 = x1_437[@i_466]) && ((x2_388 = x2_436[@i_466]) && ((x3_387 = x3_435[@i_466]) && ((x4_386 = x4_434[@i_466]) && (x5_385 = x5_433[@i_466]))))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(x1_443[@i_465], x2_442[@i_465], x3_441[@i_465], x4_440[@i_465], x5_439[@i_465], r_438[@i_465]) && otheruses(r_438[@i_465]) && ((x1_389 = x1_443[@i_465]) && ((x2_388 = x2_442[@i_465]) && ((x3_387 = x3_441[@i_465]) && ((x4_386 = x4_440[@i_465]) && (x5_385 = x5_439[@i_465]))))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(x1_449[@i_464], x2_448[@i_464], x3_447[@i_464], x4_446[@i_464], x5_445[@i_464], r_444[@i_464]) && otheruses(r_444[@i_464]) && ((x1_389 = x1_449[@i_464]) && ((x2_388 = x2_448[@i_464]) && ((x3_387 = x3_447[@i_464]) && ((x4_386 = x4_446[@i_464]) && (x5_385 = x5_445[@i_464]))))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(x1_455[@i_463], x2_454[@i_463], x3_453[@i_463], x4_452[@i_463], x5_451[@i_463], r_450[@i_463]) && otheruses(r_450[@i_463]) && ((x1_389 = x1_455[@i_463]) && ((x2_388 = x2_454[@i_463]) && ((x3_387 = x3_453[@i_463]) && ((x4_386 = x4_452[@i_463]) && (x5_385 = x5_451[@i_463]))))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(x1_461[@i_462], x2_460[@i_462], x3_459[@i_462], x4_458[@i_462], x5_457[@i_462], r_456[@i_462]) && otheruses(r_456[@i_462]) && ((x1_389 = x1_461[@i_462]) && ((x2_388 = x2_460[@i_462]) && ((x3_387 = x3_459[@i_462]) && ((x4_386 = x4_458[@i_462]) && (x5_385 = x5_457[@i_462]))))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying move all binders yields

Game 18 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @2_r4_157[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = @2_r4_157[@i_246] in
    let K_u: G = exp(@2_r4_157[@i_246], x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((@2_r4_157[@i_246] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      let x3_423: G = X in
      let x4_422: G = @2_r4_157[@i_246] in
      let x5_421: G = K_u in
      find [unique] @i_552 <= qH0 suchthat defined(x1_389[@i_552], x2_388[@i_552], x3_387[@i_552], x4_386[@i_552], x5_385[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && ((x1_425 = x1_389[@i_552]) && ((x2_424 = x2_388[@i_552]) && ((x3_423 = x3_387[@i_552]) && ((x4_422 = x4_386[@i_552]) && (x5_421 = x5_385[@i_552]))))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_419: host = U in
      let x2_418: host = S in
      let x3_417: G = X in
      let x4_416: G = @2_r4_157[@i_246] in
      let x5_415: G = K_u in
      find [unique] @i_539 <= qH0 suchthat defined(x1_389[@i_539], x2_388[@i_539], x3_387[@i_539], x4_386[@i_539], x5_385[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && ((x1_419 = x1_389[@i_539]) && ((x2_418 = x2_388[@i_539]) && ((x3_417 = x3_387[@i_539]) && ((x4_416 = x4_386[@i_539]) && (x5_415 = x5_385[@i_539]))))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @2_r4_172[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = @2_r4_172[@i_241] in
    let K_u: G = exp(@2_r4_172[@i_241], x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((@2_r4_172[@i_241] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      let x3_435: G = X in
      let x4_434: G = @2_r4_172[@i_241] in
      let x5_433: G = K_u in
      find [unique] @i_578 <= qH0 suchthat defined(x1_389[@i_578], x2_388[@i_578], x3_387[@i_578], x4_386[@i_578], x5_385[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && ((x1_437 = x1_389[@i_578]) && ((x2_436 = x2_388[@i_578]) && ((x3_435 = x3_387[@i_578]) && ((x4_434 = x4_386[@i_578]) && (x5_433 = x5_385[@i_578]))))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_431: host = U in
      let x2_430: host = S in
      let x3_429: G = X in
      let x4_428: G = @2_r4_172[@i_241] in
      let x5_427: G = K_u in
      find [unique] @i_565 <= qH0 suchthat defined(x1_389[@i_565], x2_388[@i_565], x3_387[@i_565], x4_386[@i_565], x5_385[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && ((x1_431 = x1_389[@i_565]) && ((x2_430 = x2_388[@i_565]) && ((x3_429 = x3_387[@i_565]) && ((x4_428 = x4_386[@i_565]) && (x5_427 = x5_385[@i_565]))))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      let x3_447: G = X in
      let x4_446: G = Yp[@i_238] in
      let x5_445: G = K_u in
      find [unique] @i_604 <= qH0 suchthat defined(x1_389[@i_604], x2_388[@i_604], x3_387[@i_604], x4_386[@i_604], x5_385[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && ((x1_449 = x1_389[@i_604]) && ((x2_448 = x2_388[@i_604]) && ((x3_447 = x3_387[@i_604]) && ((x4_446 = x4_386[@i_604]) && (x5_445 = x5_385[@i_604]))))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_443: host = U in
      let x2_442: host = S in
      let x3_441: G = X in
      let x4_440: G = Yp[@i_238] in
      let x5_439: G = K_u in
      find [unique] @i_591 <= qH0 suchthat defined(x1_389[@i_591], x2_388[@i_591], x3_387[@i_591], x4_386[@i_591], x5_385[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && ((x1_443 = x1_389[@i_591]) && ((x2_442 = x2_388[@i_591]) && ((x3_441 = x3_387[@i_591]) && ((x4_440 = x4_386[@i_591]) && (x5_439 = x5_385[@i_591]))))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      let x3_459: G = X in
      let x4_458: G = Y[@i_236] in
      let x5_457: G = K_u in
      find [unique] @i_630 <= qH0 suchthat defined(x1_389[@i_630], x2_388[@i_630], x3_387[@i_630], x4_386[@i_630], x5_385[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && ((x1_461 = x1_389[@i_630]) && ((x2_460 = x2_388[@i_630]) && ((x3_459 = x3_387[@i_630]) && ((x4_458 = x4_386[@i_630]) && (x5_457 = x5_385[@i_630]))))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind  suchthat defined(j[@i_236], r_396[@i_236]) && otheruses(r_396[@i_236]) && (!_41 = j[@i_236]) then
      (
        let @i_628 <= NS = @i_236 in
        let sk_u: hash0 = r_396[@i_236] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_455: host = U in
      let x2_454: host = S in
      let x3_453: G = X in
      let x4_452: G = Y[@i_236] in
      let x5_451: G = K_u in
      find [unique] @i_617 <= qH0 suchthat defined(x1_389[@i_617], x2_388[@i_617], x3_387[@i_617], x4_386[@i_617], x5_385[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && ((x1_455 = x1_389[@i_617]) && ((x2_454 = x2_388[@i_617]) && ((x3_453 = x3_387[@i_617]) && ((x4_452 = x4_386[@i_617]) && (x5_451 = x5_385[@i_617]))))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
  )
  else
    new @2_r4_172: G;
    let Y_u: G = @2_r4_172 in
    let K_u: G = exp(@2_r4_172, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    let x3_411: G = X in
    let x4_410: G = @2_r4_172 in
    let x5_409: G = K_u in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, sk_u);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      let x3_399: G = X_s in
      let x4_398: G = Y in
      let x5_397: G = K_s in
      find [unique] @i_500 <= qH0 suchthat defined(x1_389[@i_500], x2_388[@i_500], x3_387[@i_500], x4_386[@i_500], x5_385[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && ((x1_401 = x1_389[@i_500]) && ((x2_400 = x2_388[@i_500]) && ((x3_399 = x3_387[@i_500]) && ((x4_398 = x4_386[@i_500]) && (x5_397 = x5_385[@i_500]))))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind  suchthat defined(@i_236[j], r_450[j]) && otheruses(r_450[j]) && (!_42 = @i_236[j]) then
      (
        let @i_489 <= NU = j in
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind  suchthat defined(@i_236[j], r_456[j]) && otheruses(r_456[j]) && (!_42 = @i_236[j]) then
      (
        let @i_488 <= NU = j in
        let sk_s: hash0 = r_456[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = X_s in
      let x4_404: G = Y in
      let x5_403: G = K_s in
      find [unique] @i_513 <= qH0 suchthat defined(x1_389[@i_513], x2_388[@i_513], x3_387[@i_513], x4_386[@i_513], x5_385[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1_389[@i_513]) && ((x2_406 = x2_388[@i_513]) && ((x3_405 = x3_387[@i_513]) && ((x4_404 = x4_386[@i_513]) && (x5_403 = x5_385[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let @i_502 <= NU = j in
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @2_r4_157[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@2_r4_157[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @2_r4_172[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@2_r4_172[@i_217] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let @2_x_165: G = cst_G in
  let @2_ke_164: passwd = cst_passwd in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  let x3_393: G = Xp in
  let x4_392: G = Yp in
  let x5_391: G = Kp in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@2_r4_157[@i_198], @2_kd[@i_198], @2_m[@i_198]) && otheruses(@2_m[@i_198] -> @2_r4_157[@i_198]) && ((@2_x = @2_r4_157[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@2_r4_172[@i_193], Ystar_u[@i_193]) && otheruses(Ystar_u[@i_193] -> @2_r4_172[@i_193]) && ((@2_x = @2_r4_172[@i_193]) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @2_r4_157[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @2_r4_157[@i_186])
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @2_r4_172[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], @2_r4_172[@i_181])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @2_r4_157: G;
    out(@2_c4[!_45], @2_r4_157)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_389: host = x1 in
  let x2_388: host = x2 in
  let x3_387: G = x3 in
  let x4_386: G = x4 in
  let x5_385: G = x5 in
  find [unique] @i_474 <= qH0 suchthat defined(x1_389[@i_474], x2_388[@i_474], x3_387[@i_474], x4_386[@i_474], x5_385[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1_389 = x1_389[@i_474]) && ((x2_388 = x2_388[@i_474]) && ((x3_387 = x3_387[@i_474]) && ((x4_386 = x4_386[@i_474]) && (x5_385 = x5_385[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(x1_395[@i_473], x2_394[@i_473], x3_393[@i_473], x4_392[@i_473], x5_391[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && ((x1_389 = x1_395[@i_473]) && ((x2_388 = x2_394[@i_473]) && ((x3_387 = x3_393[@i_473]) && ((x4_386 = x4_392[@i_473]) && (x5_385 = x5_391[@i_473]))))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(x1_401[@i_472], x2_400[@i_472], x3_399[@i_472], x4_398[@i_472], x5_397[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && ((x1_389 = x1_401[@i_472]) && ((x2_388 = x2_400[@i_472]) && ((x3_387 = x3_399[@i_472]) && ((x4_386 = x4_398[@i_472]) && (x5_385 = x5_397[@i_472]))))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(x1_407[@i_471], x2_406[@i_471], x3_405[@i_471], x4_404[@i_471], x5_403[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && ((x1_389 = x1_407[@i_471]) && ((x2_388 = x2_406[@i_471]) && ((x3_387 = x3_405[@i_471]) && ((x4_386 = x4_404[@i_471]) && (x5_385 = x5_403[@i_471]))))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(x1_413[@i_470], x2_412[@i_470], x3_411[@i_470], x4_410[@i_470], x5_409[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && ((x1_389 = x1_413[@i_470]) && ((x2_388 = x2_412[@i_470]) && ((x3_387 = x3_411[@i_470]) && ((x4_386 = x4_410[@i_470]) && (x5_385 = x5_409[@i_470]))))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(x1_419[@i_469], x2_418[@i_469], x3_417[@i_469], x4_416[@i_469], x5_415[@i_469], r_414[@i_469]) && otheruses(r_414[@i_469]) && ((x1_389 = x1_419[@i_469]) && ((x2_388 = x2_418[@i_469]) && ((x3_387 = x3_417[@i_469]) && ((x4_386 = x4_416[@i_469]) && (x5_385 = x5_415[@i_469]))))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(x1_425[@i_468], x2_424[@i_468], x3_423[@i_468], x4_422[@i_468], x5_421[@i_468], r_420[@i_468]) && otheruses(r_420[@i_468]) && ((x1_389 = x1_425[@i_468]) && ((x2_388 = x2_424[@i_468]) && ((x3_387 = x3_423[@i_468]) && ((x4_386 = x4_422[@i_468]) && (x5_385 = x5_421[@i_468]))))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(x1_431[@i_467], x2_430[@i_467], x3_429[@i_467], x4_428[@i_467], x5_427[@i_467], r_426[@i_467]) && otheruses(r_426[@i_467]) && ((x1_389 = x1_431[@i_467]) && ((x2_388 = x2_430[@i_467]) && ((x3_387 = x3_429[@i_467]) && ((x4_386 = x4_428[@i_467]) && (x5_385 = x5_427[@i_467]))))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(x1_437[@i_466], x2_436[@i_466], x3_435[@i_466], x4_434[@i_466], x5_433[@i_466], r_432[@i_466]) && otheruses(r_432[@i_466]) && ((x1_389 = x1_437[@i_466]) && ((x2_388 = x2_436[@i_466]) && ((x3_387 = x3_435[@i_466]) && ((x4_386 = x4_434[@i_466]) && (x5_385 = x5_433[@i_466]))))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(x1_443[@i_465], x2_442[@i_465], x3_441[@i_465], x4_440[@i_465], x5_439[@i_465], r_438[@i_465]) && otheruses(r_438[@i_465]) && ((x1_389 = x1_443[@i_465]) && ((x2_388 = x2_442[@i_465]) && ((x3_387 = x3_441[@i_465]) && ((x4_386 = x4_440[@i_465]) && (x5_385 = x5_439[@i_465]))))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(x1_449[@i_464], x2_448[@i_464], x3_447[@i_464], x4_446[@i_464], x5_445[@i_464], r_444[@i_464]) && otheruses(r_444[@i_464]) && ((x1_389 = x1_449[@i_464]) && ((x2_388 = x2_448[@i_464]) && ((x3_387 = x3_447[@i_464]) && ((x4_386 = x4_446[@i_464]) && (x5_385 = x5_445[@i_464]))))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(x1_455[@i_463], x2_454[@i_463], x3_453[@i_463], x4_452[@i_463], x5_451[@i_463], r_450[@i_463]) && otheruses(r_450[@i_463]) && ((x1_389 = x1_455[@i_463]) && ((x2_388 = x2_454[@i_463]) && ((x3_387 = x3_453[@i_463]) && ((x4_386 = x4_452[@i_463]) && (x5_385 = x5_451[@i_463]))))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(x1_461[@i_462], x2_460[@i_462], x3_459[@i_462], x4_458[@i_462], x5_457[@i_462], r_456[@i_462]) && otheruses(r_456[@i_462]) && ((x1_389 = x1_461[@i_462]) && ((x2_388 = x2_460[@i_462]) && ((x3_387 = x3_459[@i_462]) && ((x4_386 = x4_458[@i_462]) && (x5_385 = x5_457[@i_462]))))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of useless yields

Game 19 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @2_r4_157[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = @2_r4_157[@i_246] in
    let K_u: G = exp(@2_r4_157[@i_246], x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((@2_r4_157[@i_246] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      let x3_423: G = cst_G in
      let x4_422: G = cst_G in
      let x5_421: G = cst_G in
      find [unique] @i_552 <= qH0 suchthat defined(x1[@i_552], x2[@i_552], x3[@i_552], x4[@i_552], x5[@i_552], x5_385[@i_552], x4_386[@i_552], x3_387[@i_552], x2_388[@i_552], x1_389[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && ((x1_425 = x1[@i_552]) && ((x2_424 = x2[@i_552]) && ((X = x3[@i_552]) && ((@2_r4_157[@i_246] = x4[@i_552]) && (K_u = x5[@i_552]))))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_552]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_420);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_419: host = U in
      let x2_418: host = S in
      let x3_417: G = cst_G in
      let x4_416: G = cst_G in
      let x5_415: G = cst_G in
      find [unique] @i_539 <= qH0 suchthat defined(x1[@i_539], x2[@i_539], x3[@i_539], x4[@i_539], x5[@i_539], x5_385[@i_539], x4_386[@i_539], x3_387[@i_539], x2_388[@i_539], x1_389[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && ((x1_419 = x1[@i_539]) && ((x2_418 = x2[@i_539]) && ((X = x3[@i_539]) && ((@2_r4_157[@i_246] = x4[@i_539]) && (K_u = x5[@i_539]))))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_539]);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_414);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @2_r4_172[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = @2_r4_172[@i_241] in
    let K_u: G = exp(@2_r4_172[@i_241], x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((@2_r4_172[@i_241] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      let x3_435: G = cst_G in
      let x4_434: G = cst_G in
      let x5_433: G = cst_G in
      find [unique] @i_578 <= qH0 suchthat defined(x1[@i_578], x2[@i_578], x3[@i_578], x4[@i_578], x5[@i_578], x5_385[@i_578], x4_386[@i_578], x3_387[@i_578], x2_388[@i_578], x1_389[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && ((x1_437 = x1[@i_578]) && ((x2_436 = x2[@i_578]) && ((X = x3[@i_578]) && ((@2_r4_172[@i_241] = x4[@i_578]) && (K_u = x5[@i_578]))))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_578]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_432);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_431: host = U in
      let x2_430: host = S in
      let x3_429: G = cst_G in
      let x4_428: G = cst_G in
      let x5_427: G = cst_G in
      find [unique] @i_565 <= qH0 suchthat defined(x1[@i_565], x2[@i_565], x3[@i_565], x4[@i_565], x5[@i_565], x5_385[@i_565], x4_386[@i_565], x3_387[@i_565], x2_388[@i_565], x1_389[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && ((x1_431 = x1[@i_565]) && ((x2_430 = x2[@i_565]) && ((X = x3[@i_565]) && ((@2_r4_172[@i_241] = x4[@i_565]) && (K_u = x5[@i_565]))))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_565]);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_426);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      let x3_447: G = cst_G in
      let x4_446: G = cst_G in
      let x5_445: G = cst_G in
      find [unique] @i_604 <= qH0 suchthat defined(x1[@i_604], x2[@i_604], x3[@i_604], x4[@i_604], x5[@i_604], x5_385[@i_604], x4_386[@i_604], x3_387[@i_604], x2_388[@i_604], x1_389[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && ((x1_449 = x1[@i_604]) && ((x2_448 = x2[@i_604]) && ((X = x3[@i_604]) && ((Yp[@i_238] = x4[@i_604]) && (K_u = x5[@i_604]))))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_604]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_444);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_443: host = U in
      let x2_442: host = S in
      let x3_441: G = cst_G in
      let x4_440: G = cst_G in
      let x5_439: G = cst_G in
      find [unique] @i_591 <= qH0 suchthat defined(x1[@i_591], x2[@i_591], x3[@i_591], x4[@i_591], x5[@i_591], x5_385[@i_591], x4_386[@i_591], x3_387[@i_591], x2_388[@i_591], x1_389[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && ((x1_443 = x1[@i_591]) && ((x2_442 = x2[@i_591]) && ((X = x3[@i_591]) && ((Yp[@i_238] = x4[@i_591]) && (K_u = x5[@i_591]))))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_591]);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_438);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      let x3_459: G = cst_G in
      let x4_458: G = cst_G in
      let x5_457: G = cst_G in
      find [unique] @i_630 <= qH0 suchthat defined(x1[@i_630], x2[@i_630], x3[@i_630], x4[@i_630], x5[@i_630], x5_385[@i_630], x4_386[@i_630], x3_387[@i_630], x2_388[@i_630], x1_389[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && ((x1_461 = x1[@i_630]) && ((x2_460 = x2[@i_630]) && ((X = x3[@i_630]) && ((Y[@i_236] = x4[@i_630]) && (K_u = x5[@i_630]))))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_630]);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind  suchthat defined(j[@i_236], r_396[@i_236]) && otheruses(r_396[@i_236]) && (!_41 = j[@i_236]) then
      (
        let sk_u: hash0 = r_396[@i_236] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_396[@i_236]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_456);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_455: host = U in
      let x2_454: host = S in
      let x3_453: G = cst_G in
      let x4_452: G = cst_G in
      let x5_451: G = cst_G in
      find [unique] @i_617 <= qH0 suchthat defined(x1[@i_617], x2[@i_617], x3[@i_617], x4[@i_617], x5[@i_617], x5_385[@i_617], x4_386[@i_617], x3_387[@i_617], x2_388[@i_617], x1_389[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && ((x1_455 = x1[@i_617]) && ((x2_454 = x2[@i_617]) && ((X = x3[@i_617]) && ((Y[@i_236] = x4[@i_617]) && (K_u = x5[@i_617]))))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_617]);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_450);
        out(c6[!_41], r1_90)
  )
  else
    new @2_r4_172: G;
    let Y_u: G = @2_r4_172 in
    let K_u: G = exp(@2_r4_172, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    let x3_411: G = cst_G in
    let x4_410: G = cst_G in
    let x5_409: G = cst_G in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      let x3_399: G = cst_G in
      let x4_398: G = cst_G in
      let x5_397: G = cst_G in
      find [unique] @i_500 <= qH0 suchthat defined(x1[@i_500], x2[@i_500], x3[@i_500], x4[@i_500], x5[@i_500], x5_385[@i_500], x4_386[@i_500], x3_387[@i_500], x2_388[@i_500], x1_389[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && ((x1_401 = x1[@i_500]) && ((x2_400 = x2[@i_500]) && ((X_s = x3[@i_500]) && ((Y = x4[@i_500]) && (K_s = x5[@i_500]))))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_500])
      )
      orfind  suchthat defined(@i_236[j], r_450[j]) && otheruses(r_450[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      orfind  suchthat defined(@i_236[j], r_456[j]) && otheruses(r_456[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_456[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_456[j])
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_396)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = cst_G in
      let x4_404: G = cst_G in
      let x5_403: G = cst_G in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], x5_385[@i_513], x4_386[@i_513], x3_387[@i_513], x2_388[@i_513], x1_389[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (K_s = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @2_r4_157[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@2_r4_157[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @2_r4_172[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@2_r4_172[@i_217] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  let x3_393: G = cst_G in
  let x4_392: G = cst_G in
  let x5_391: G = cst_G in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@2_r4_157[@i_198], @2_kd[@i_198], @2_m[@i_198]) && otheruses(@2_m[@i_198] -> @2_r4_157[@i_198]) && ((@2_x = @2_r4_157[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@2_r4_172[@i_193], Ystar_u[@i_193]) && otheruses(Ystar_u[@i_193] -> @2_r4_172[@i_193]) && ((@2_x = @2_r4_172[@i_193]) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @2_r4_157[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @2_r4_157[@i_186])
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @2_r4_172[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], @2_r4_172[@i_181])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @2_r4_157: G;
    out(@2_c4[!_45], @2_r4_157)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_389: host = cst_host in
  let x2_388: host = cst_host in
  let x3_387: G = cst_G in
  let x4_386: G = cst_G in
  let x5_385: G = cst_G in
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], x5_385[@i_474], x4_386[@i_474], x3_387[@i_474], x2_388[@i_474], x1_389[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(Xp[@i_473], Yp[@i_473], Kp[@i_473], x5_391[@i_473], x4_392[@i_473], x3_393[@i_473], x1_395[@i_473], x2_394[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && ((x1 = x1_395[@i_473]) && ((x2 = x2_394[@i_473]) && ((x3 = Xp[@i_473]) && ((x4 = Yp[@i_473]) && (x5 = Kp[@i_473]))))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(X_s[@i_472], Y[@i_472], K_s[@i_472], x5_397[@i_472], x4_398[@i_472], x3_399[@i_472], x1_401[@i_472], x2_400[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && ((x1 = x1_401[@i_472]) && ((x2 = x2_400[@i_472]) && ((x3 = X_s[@i_472]) && ((x4 = Y[@i_472]) && (x5 = K_s[@i_472]))))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(X_s[@i_471], Y[@i_471], K_s[@i_471], x5_403[@i_471], x4_404[@i_471], x3_405[@i_471], x1_407[@i_471], x2_406[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && ((x1 = x1_407[@i_471]) && ((x2 = x2_406[@i_471]) && ((x3 = X_s[@i_471]) && ((x4 = Y[@i_471]) && (x5 = K_s[@i_471]))))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(X[@i_470], @2_r4_172[@i_470], K_u[@i_470], x5_409[@i_470], x4_410[@i_470], x3_411[@i_470], x1_413[@i_470], x2_412[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && ((x1 = x1_413[@i_470]) && ((x2 = x2_412[@i_470]) && ((x3 = X[@i_470]) && ((x4 = @2_r4_172[@i_470]) && (x5 = K_u[@i_470]))))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(X[@i_469], @2_r4_157[@i_246[@i_469]], K_u[@i_469], x5_415[@i_469], x4_416[@i_469], x3_417[@i_469], x1_419[@i_469], x2_418[@i_469], r_414[@i_469]) && otheruses(r_414[@i_469]) && ((x1 = x1_419[@i_469]) && ((x2 = x2_418[@i_469]) && ((x3 = X[@i_469]) && ((x4 = @2_r4_157[@i_246[@i_469]]) && (x5 = K_u[@i_469]))))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(X[@i_468], @2_r4_157[@i_246[@i_468]], K_u[@i_468], x5_421[@i_468], x4_422[@i_468], x3_423[@i_468], x1_425[@i_468], x2_424[@i_468], r_420[@i_468]) && otheruses(r_420[@i_468]) && ((x1 = x1_425[@i_468]) && ((x2 = x2_424[@i_468]) && ((x3 = X[@i_468]) && ((x4 = @2_r4_157[@i_246[@i_468]]) && (x5 = K_u[@i_468]))))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(X[@i_467], @2_r4_172[@i_241[@i_467]], K_u[@i_467], x5_427[@i_467], x4_428[@i_467], x3_429[@i_467], x1_431[@i_467], x2_430[@i_467], r_426[@i_467]) && otheruses(r_426[@i_467]) && ((x1 = x1_431[@i_467]) && ((x2 = x2_430[@i_467]) && ((x3 = X[@i_467]) && ((x4 = @2_r4_172[@i_241[@i_467]]) && (x5 = K_u[@i_467]))))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(X[@i_466], @2_r4_172[@i_241[@i_466]], K_u[@i_466], x5_433[@i_466], x4_434[@i_466], x3_435[@i_466], x1_437[@i_466], x2_436[@i_466], r_432[@i_466]) && otheruses(r_432[@i_466]) && ((x1 = x1_437[@i_466]) && ((x2 = x2_436[@i_466]) && ((x3 = X[@i_466]) && ((x4 = @2_r4_172[@i_241[@i_466]]) && (x5 = K_u[@i_466]))))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(X[@i_465], Yp[@i_238[@i_465]], K_u[@i_465], x5_439[@i_465], x4_440[@i_465], x3_441[@i_465], x1_443[@i_465], x2_442[@i_465], r_438[@i_465]) && otheruses(r_438[@i_465]) && ((x1 = x1_443[@i_465]) && ((x2 = x2_442[@i_465]) && ((x3 = X[@i_465]) && ((x4 = Yp[@i_238[@i_465]]) && (x5 = K_u[@i_465]))))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(X[@i_464], Yp[@i_238[@i_464]], K_u[@i_464], x5_445[@i_464], x4_446[@i_464], x3_447[@i_464], x1_449[@i_464], x2_448[@i_464], r_444[@i_464]) && otheruses(r_444[@i_464]) && ((x1 = x1_449[@i_464]) && ((x2 = x2_448[@i_464]) && ((x3 = X[@i_464]) && ((x4 = Yp[@i_238[@i_464]]) && (x5 = K_u[@i_464]))))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(X[@i_463], Y[@i_236[@i_463]], K_u[@i_463], x5_451[@i_463], x4_452[@i_463], x3_453[@i_463], x1_455[@i_463], x2_454[@i_463], r_450[@i_463]) && otheruses(r_450[@i_463]) && ((x1 = x1_455[@i_463]) && ((x2 = x2_454[@i_463]) && ((x3 = X[@i_463]) && ((x4 = Y[@i_236[@i_463]]) && (x5 = K_u[@i_463]))))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(X[@i_462], Y[@i_236[@i_462]], K_u[@i_462], x5_457[@i_462], x4_458[@i_462], x3_459[@i_462], x1_461[@i_462], x2_460[@i_462], r_456[@i_462]) && otheruses(r_456[@i_462]) && ((x1 = x1_461[@i_462]) && ((x2 = x2_460[@i_462]) && ((x3 = X[@i_462]) && ((x4 = Y[@i_236[@i_462]]) && (x5 = K_u[@i_462]))))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying equivalence
equiv ! !_1 <= @1_N new @1_X: G; (
  @1_OX() := @1_X,
  ! !_2 <= @1_N' @1_OXm(@1_m: exponent) := exp(@1_X, @1_m))
<=(0)=>
      ! !_3 <= @1_N new @1_x: exponent; (
  @1_OX() := exp(g, @1_x),
  ! !_4 <= @1_N' @1_OXm(@1_m: exponent) := exp(g, mult(@1_x, @1_m)))
 yields

Game 20 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@1_x_783[@i_246], @2_m[@i_246], @2_kd[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_x_783[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = exp(g, @1_x_783[@i_246]) in
    let K_u: G = exp(g, mult(@1_x_783[@i_246], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_783[@i_246]) = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      let x3_423: G = cst_G in
      let x4_422: G = cst_G in
      let x5_421: G = cst_G in
      find [unique] @i_552 <= qH0 suchthat defined(x1[@i_552], x2[@i_552], x3[@i_552], x4[@i_552], x5[@i_552], x5_385[@i_552], x4_386[@i_552], x3_387[@i_552], x2_388[@i_552], x1_389[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && ((x1_425 = x1[@i_552]) && ((x2_424 = x2[@i_552]) && ((X = x3[@i_552]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_552]) && (K_u = x5[@i_552]))))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_552]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_420);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_419: host = U in
      let x2_418: host = S in
      let x3_417: G = cst_G in
      let x4_416: G = cst_G in
      let x5_415: G = cst_G in
      find [unique] @i_539 <= qH0 suchthat defined(x1[@i_539], x2[@i_539], x3[@i_539], x4[@i_539], x5[@i_539], x5_385[@i_539], x4_386[@i_539], x3_387[@i_539], x2_388[@i_539], x1_389[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && ((x1_419 = x1[@i_539]) && ((x2_418 = x2[@i_539]) && ((X = x3[@i_539]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_539]) && (K_u = x5[@i_539]))))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_539]);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_414);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @2_r4_172[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = @2_r4_172[@i_241] in
    let K_u: G = exp(@2_r4_172[@i_241], x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((@2_r4_172[@i_241] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      let x3_435: G = cst_G in
      let x4_434: G = cst_G in
      let x5_433: G = cst_G in
      find [unique] @i_578 <= qH0 suchthat defined(x1[@i_578], x2[@i_578], x3[@i_578], x4[@i_578], x5[@i_578], x5_385[@i_578], x4_386[@i_578], x3_387[@i_578], x2_388[@i_578], x1_389[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && ((x1_437 = x1[@i_578]) && ((x2_436 = x2[@i_578]) && ((X = x3[@i_578]) && ((@2_r4_172[@i_241] = x4[@i_578]) && (K_u = x5[@i_578]))))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_578]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_432);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_431: host = U in
      let x2_430: host = S in
      let x3_429: G = cst_G in
      let x4_428: G = cst_G in
      let x5_427: G = cst_G in
      find [unique] @i_565 <= qH0 suchthat defined(x1[@i_565], x2[@i_565], x3[@i_565], x4[@i_565], x5[@i_565], x5_385[@i_565], x4_386[@i_565], x3_387[@i_565], x2_388[@i_565], x1_389[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && ((x1_431 = x1[@i_565]) && ((x2_430 = x2[@i_565]) && ((X = x3[@i_565]) && ((@2_r4_172[@i_241] = x4[@i_565]) && (K_u = x5[@i_565]))))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_565]);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_426);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      let x3_447: G = cst_G in
      let x4_446: G = cst_G in
      let x5_445: G = cst_G in
      find [unique] @i_604 <= qH0 suchthat defined(x1[@i_604], x2[@i_604], x3[@i_604], x4[@i_604], x5[@i_604], x5_385[@i_604], x4_386[@i_604], x3_387[@i_604], x2_388[@i_604], x1_389[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && ((x1_449 = x1[@i_604]) && ((x2_448 = x2[@i_604]) && ((X = x3[@i_604]) && ((Yp[@i_238] = x4[@i_604]) && (K_u = x5[@i_604]))))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_604]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_444);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_443: host = U in
      let x2_442: host = S in
      let x3_441: G = cst_G in
      let x4_440: G = cst_G in
      let x5_439: G = cst_G in
      find [unique] @i_591 <= qH0 suchthat defined(x1[@i_591], x2[@i_591], x3[@i_591], x4[@i_591], x5[@i_591], x5_385[@i_591], x4_386[@i_591], x3_387[@i_591], x2_388[@i_591], x1_389[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && ((x1_443 = x1[@i_591]) && ((x2_442 = x2[@i_591]) && ((X = x3[@i_591]) && ((Yp[@i_238] = x4[@i_591]) && (K_u = x5[@i_591]))))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_591]);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_438);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      let x3_459: G = cst_G in
      let x4_458: G = cst_G in
      let x5_457: G = cst_G in
      find [unique] @i_630 <= qH0 suchthat defined(x1[@i_630], x2[@i_630], x3[@i_630], x4[@i_630], x5[@i_630], x5_385[@i_630], x4_386[@i_630], x3_387[@i_630], x2_388[@i_630], x1_389[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && ((x1_461 = x1[@i_630]) && ((x2_460 = x2[@i_630]) && ((X = x3[@i_630]) && ((Y[@i_236] = x4[@i_630]) && (K_u = x5[@i_630]))))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_630]);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind  suchthat defined(j[@i_236], r_396[@i_236]) && otheruses(r_396[@i_236]) && (!_41 = j[@i_236]) then
      (
        let sk_u: hash0 = r_396[@i_236] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_396[@i_236]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_456);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_455: host = U in
      let x2_454: host = S in
      let x3_453: G = cst_G in
      let x4_452: G = cst_G in
      let x5_451: G = cst_G in
      find [unique] @i_617 <= qH0 suchthat defined(x1[@i_617], x2[@i_617], x3[@i_617], x4[@i_617], x5[@i_617], x5_385[@i_617], x4_386[@i_617], x3_387[@i_617], x2_388[@i_617], x1_389[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && ((x1_455 = x1[@i_617]) && ((x2_454 = x2[@i_617]) && ((X = x3[@i_617]) && ((Y[@i_236] = x4[@i_617]) && (K_u = x5[@i_617]))))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_617]);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_450);
        out(c6[!_41], r1_90)
  )
  else
    new @2_r4_172: G;
    let Y_u: G = @2_r4_172 in
    let K_u: G = exp(@2_r4_172, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    let x3_411: G = cst_G in
    let x4_410: G = cst_G in
    let x5_409: G = cst_G in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      let x3_399: G = cst_G in
      let x4_398: G = cst_G in
      let x5_397: G = cst_G in
      find [unique] @i_500 <= qH0 suchthat defined(x1[@i_500], x2[@i_500], x3[@i_500], x4[@i_500], x5[@i_500], x5_385[@i_500], x4_386[@i_500], x3_387[@i_500], x2_388[@i_500], x1_389[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && ((x1_401 = x1[@i_500]) && ((x2_400 = x2[@i_500]) && ((X_s = x3[@i_500]) && ((Y = x4[@i_500]) && (K_s = x5[@i_500]))))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_500])
      )
      orfind  suchthat defined(@i_236[j], r_450[j]) && otheruses(r_450[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      orfind  suchthat defined(@i_236[j], r_456[j]) && otheruses(r_456[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_456[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_456[j])
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_396)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = cst_G in
      let x4_404: G = cst_G in
      let x5_403: G = cst_G in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], x5_385[@i_513], x4_386[@i_513], x3_387[@i_513], x2_388[@i_513], x1_389[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (K_s = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@1_x_783[@i_222], @2_m[@i_222], @2_kd[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_x_783[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_783[@i_222]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @2_r4_172[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@2_r4_172[@i_217] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  let x3_393: G = cst_G in
  let x4_392: G = cst_G in
  let x5_391: G = cst_G in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_x_783[@i_198], @2_r4_157[@i_198], @2_kd[@i_198], @2_m[@i_198]) && otheruses(@2_m[@i_198] -> @1_x_783[@i_198]) && ((@2_x = exp(g, @1_x_783[@i_198])) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@2_r4_172[@i_193], Ystar_u[@i_193]) && otheruses(Ystar_u[@i_193] -> @2_r4_172[@i_193]) && ((@2_x = @2_r4_172[@i_193]) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@1_x_783[@i_186], @2_m[@i_186], @2_kd[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_x_783[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], exp(g, @1_x_783[@i_186]))
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @2_r4_172[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], @2_r4_172[@i_181])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_x_783: exponent;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], exp(g, @1_x_783))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_389: host = cst_host in
  let x2_388: host = cst_host in
  let x3_387: G = cst_G in
  let x4_386: G = cst_G in
  let x5_385: G = cst_G in
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], x5_385[@i_474], x4_386[@i_474], x3_387[@i_474], x2_388[@i_474], x1_389[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(Xp[@i_473], Yp[@i_473], Kp[@i_473], x5_391[@i_473], x4_392[@i_473], x3_393[@i_473], x1_395[@i_473], x2_394[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && ((x1 = x1_395[@i_473]) && ((x2 = x2_394[@i_473]) && ((x3 = Xp[@i_473]) && ((x4 = Yp[@i_473]) && (x5 = Kp[@i_473]))))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(X_s[@i_472], Y[@i_472], K_s[@i_472], x5_397[@i_472], x4_398[@i_472], x3_399[@i_472], x1_401[@i_472], x2_400[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && ((x1 = x1_401[@i_472]) && ((x2 = x2_400[@i_472]) && ((x3 = X_s[@i_472]) && ((x4 = Y[@i_472]) && (x5 = K_s[@i_472]))))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(X_s[@i_471], Y[@i_471], K_s[@i_471], x5_403[@i_471], x4_404[@i_471], x3_405[@i_471], x1_407[@i_471], x2_406[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && ((x1 = x1_407[@i_471]) && ((x2 = x2_406[@i_471]) && ((x3 = X_s[@i_471]) && ((x4 = Y[@i_471]) && (x5 = K_s[@i_471]))))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(X[@i_470], @2_r4_172[@i_470], K_u[@i_470], x5_409[@i_470], x4_410[@i_470], x3_411[@i_470], x1_413[@i_470], x2_412[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && ((x1 = x1_413[@i_470]) && ((x2 = x2_412[@i_470]) && ((x3 = X[@i_470]) && ((x4 = @2_r4_172[@i_470]) && (x5 = K_u[@i_470]))))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(@1_x_783[@i_246[@i_469]], X[@i_469], @2_r4_157[@i_246[@i_469]], K_u[@i_469], x5_415[@i_469], x4_416[@i_469], x3_417[@i_469], x1_419[@i_469], x2_418[@i_469], r_414[@i_469]) && otheruses(r_414[@i_469]) && ((x1 = x1_419[@i_469]) && ((x2 = x2_418[@i_469]) && ((x3 = X[@i_469]) && ((x4 = exp(g, @1_x_783[@i_246[@i_469]])) && (x5 = K_u[@i_469]))))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(@1_x_783[@i_246[@i_468]], X[@i_468], @2_r4_157[@i_246[@i_468]], K_u[@i_468], x5_421[@i_468], x4_422[@i_468], x3_423[@i_468], x1_425[@i_468], x2_424[@i_468], r_420[@i_468]) && otheruses(r_420[@i_468]) && ((x1 = x1_425[@i_468]) && ((x2 = x2_424[@i_468]) && ((x3 = X[@i_468]) && ((x4 = exp(g, @1_x_783[@i_246[@i_468]])) && (x5 = K_u[@i_468]))))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(X[@i_467], @2_r4_172[@i_241[@i_467]], K_u[@i_467], x5_427[@i_467], x4_428[@i_467], x3_429[@i_467], x1_431[@i_467], x2_430[@i_467], r_426[@i_467]) && otheruses(r_426[@i_467]) && ((x1 = x1_431[@i_467]) && ((x2 = x2_430[@i_467]) && ((x3 = X[@i_467]) && ((x4 = @2_r4_172[@i_241[@i_467]]) && (x5 = K_u[@i_467]))))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(X[@i_466], @2_r4_172[@i_241[@i_466]], K_u[@i_466], x5_433[@i_466], x4_434[@i_466], x3_435[@i_466], x1_437[@i_466], x2_436[@i_466], r_432[@i_466]) && otheruses(r_432[@i_466]) && ((x1 = x1_437[@i_466]) && ((x2 = x2_436[@i_466]) && ((x3 = X[@i_466]) && ((x4 = @2_r4_172[@i_241[@i_466]]) && (x5 = K_u[@i_466]))))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(X[@i_465], Yp[@i_238[@i_465]], K_u[@i_465], x5_439[@i_465], x4_440[@i_465], x3_441[@i_465], x1_443[@i_465], x2_442[@i_465], r_438[@i_465]) && otheruses(r_438[@i_465]) && ((x1 = x1_443[@i_465]) && ((x2 = x2_442[@i_465]) && ((x3 = X[@i_465]) && ((x4 = Yp[@i_238[@i_465]]) && (x5 = K_u[@i_465]))))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(X[@i_464], Yp[@i_238[@i_464]], K_u[@i_464], x5_445[@i_464], x4_446[@i_464], x3_447[@i_464], x1_449[@i_464], x2_448[@i_464], r_444[@i_464]) && otheruses(r_444[@i_464]) && ((x1 = x1_449[@i_464]) && ((x2 = x2_448[@i_464]) && ((x3 = X[@i_464]) && ((x4 = Yp[@i_238[@i_464]]) && (x5 = K_u[@i_464]))))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(X[@i_463], Y[@i_236[@i_463]], K_u[@i_463], x5_451[@i_463], x4_452[@i_463], x3_453[@i_463], x1_455[@i_463], x2_454[@i_463], r_450[@i_463]) && otheruses(r_450[@i_463]) && ((x1 = x1_455[@i_463]) && ((x2 = x2_454[@i_463]) && ((x3 = X[@i_463]) && ((x4 = Y[@i_236[@i_463]]) && (x5 = K_u[@i_463]))))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(X[@i_462], Y[@i_236[@i_462]], K_u[@i_462], x5_457[@i_462], x4_458[@i_462], x3_459[@i_462], x1_461[@i_462], x2_460[@i_462], r_456[@i_462]) && otheruses(r_456[@i_462]) && ((x1 = x1_461[@i_462]) && ((x2 = x2_460[@i_462]) && ((x3 = X[@i_462]) && ((x4 = Y[@i_236[@i_462]]) && (x5 = K_u[@i_462]))))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying equivalence
equiv ! !_1 <= @1_N new @1_X: G; (
  @1_OX() := @1_X,
  ! !_2 <= @1_N' @1_OXm(@1_m: exponent) := exp(@1_X, @1_m))
<=(0)=>
      ! !_3 <= @1_N new @1_x: exponent; (
  @1_OX() := exp(g, @1_x),
  ! !_4 <= @1_N' @1_OXm(@1_m: exponent) := exp(g, mult(@1_x, @1_m)))
 yields

Game 21 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@1_x_783[@i_246], @2_m[@i_246], @2_kd[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_x_783[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = exp(g, @1_x_783[@i_246]) in
    let K_u: G = exp(g, mult(@1_x_783[@i_246], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_783[@i_246]) = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      let x3_423: G = cst_G in
      let x4_422: G = cst_G in
      let x5_421: G = cst_G in
      find [unique] @i_552 <= qH0 suchthat defined(x1[@i_552], x2[@i_552], x3[@i_552], x4[@i_552], x5[@i_552], x5_385[@i_552], x4_386[@i_552], x3_387[@i_552], x2_388[@i_552], x1_389[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && ((x1_425 = x1[@i_552]) && ((x2_424 = x2[@i_552]) && ((X = x3[@i_552]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_552]) && (K_u = x5[@i_552]))))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_552]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_420);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_419: host = U in
      let x2_418: host = S in
      let x3_417: G = cst_G in
      let x4_416: G = cst_G in
      let x5_415: G = cst_G in
      find [unique] @i_539 <= qH0 suchthat defined(x1[@i_539], x2[@i_539], x3[@i_539], x4[@i_539], x5[@i_539], x5_385[@i_539], x4_386[@i_539], x3_387[@i_539], x2_388[@i_539], x1_389[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && ((x1_419 = x1[@i_539]) && ((x2_418 = x2[@i_539]) && ((X = x3[@i_539]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_539]) && (K_u = x5[@i_539]))))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_539]);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_414);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(@1_x_925[@i_241], Ystar_u[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @1_x_925[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = exp(g, @1_x_925[@i_241]) in
    let K_u: G = exp(g, mult(@1_x_925[@i_241], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_925[@i_241]) = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      let x3_435: G = cst_G in
      let x4_434: G = cst_G in
      let x5_433: G = cst_G in
      find [unique] @i_578 <= qH0 suchthat defined(x1[@i_578], x2[@i_578], x3[@i_578], x4[@i_578], x5[@i_578], x5_385[@i_578], x4_386[@i_578], x3_387[@i_578], x2_388[@i_578], x1_389[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && ((x1_437 = x1[@i_578]) && ((x2_436 = x2[@i_578]) && ((X = x3[@i_578]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_578]) && (K_u = x5[@i_578]))))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_578]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_432);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_431: host = U in
      let x2_430: host = S in
      let x3_429: G = cst_G in
      let x4_428: G = cst_G in
      let x5_427: G = cst_G in
      find [unique] @i_565 <= qH0 suchthat defined(x1[@i_565], x2[@i_565], x3[@i_565], x4[@i_565], x5[@i_565], x5_385[@i_565], x4_386[@i_565], x3_387[@i_565], x2_388[@i_565], x1_389[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && ((x1_431 = x1[@i_565]) && ((x2_430 = x2[@i_565]) && ((X = x3[@i_565]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_565]) && (K_u = x5[@i_565]))))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_565]);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_426);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      let x3_447: G = cst_G in
      let x4_446: G = cst_G in
      let x5_445: G = cst_G in
      find [unique] @i_604 <= qH0 suchthat defined(x1[@i_604], x2[@i_604], x3[@i_604], x4[@i_604], x5[@i_604], x5_385[@i_604], x4_386[@i_604], x3_387[@i_604], x2_388[@i_604], x1_389[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && ((x1_449 = x1[@i_604]) && ((x2_448 = x2[@i_604]) && ((X = x3[@i_604]) && ((Yp[@i_238] = x4[@i_604]) && (K_u = x5[@i_604]))))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_604]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_444);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_443: host = U in
      let x2_442: host = S in
      let x3_441: G = cst_G in
      let x4_440: G = cst_G in
      let x5_439: G = cst_G in
      find [unique] @i_591 <= qH0 suchthat defined(x1[@i_591], x2[@i_591], x3[@i_591], x4[@i_591], x5[@i_591], x5_385[@i_591], x4_386[@i_591], x3_387[@i_591], x2_388[@i_591], x1_389[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && ((x1_443 = x1[@i_591]) && ((x2_442 = x2[@i_591]) && ((X = x3[@i_591]) && ((Yp[@i_238] = x4[@i_591]) && (K_u = x5[@i_591]))))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_591]);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_438);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      let x3_459: G = cst_G in
      let x4_458: G = cst_G in
      let x5_457: G = cst_G in
      find [unique] @i_630 <= qH0 suchthat defined(x1[@i_630], x2[@i_630], x3[@i_630], x4[@i_630], x5[@i_630], x5_385[@i_630], x4_386[@i_630], x3_387[@i_630], x2_388[@i_630], x1_389[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && ((x1_461 = x1[@i_630]) && ((x2_460 = x2[@i_630]) && ((X = x3[@i_630]) && ((Y[@i_236] = x4[@i_630]) && (K_u = x5[@i_630]))))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_630]);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind  suchthat defined(j[@i_236], r_396[@i_236]) && otheruses(r_396[@i_236]) && (!_41 = j[@i_236]) then
      (
        let sk_u: hash0 = r_396[@i_236] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_396[@i_236]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_456);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_455: host = U in
      let x2_454: host = S in
      let x3_453: G = cst_G in
      let x4_452: G = cst_G in
      let x5_451: G = cst_G in
      find [unique] @i_617 <= qH0 suchthat defined(x1[@i_617], x2[@i_617], x3[@i_617], x4[@i_617], x5[@i_617], x5_385[@i_617], x4_386[@i_617], x3_387[@i_617], x2_388[@i_617], x1_389[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && ((x1_455 = x1[@i_617]) && ((x2_454 = x2[@i_617]) && ((X = x3[@i_617]) && ((Y[@i_236] = x4[@i_617]) && (K_u = x5[@i_617]))))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_617]);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_450);
        out(c6[!_41], r1_90)
  )
  else
    new @1_x_925: exponent;
    let @2_r4_172: G = cst_G in
    let Y_u: G = exp(g, @1_x_925) in
    let K_u: G = exp(g, mult(@1_x_925, x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    let x3_411: G = cst_G in
    let x4_410: G = cst_G in
    let x5_409: G = cst_G in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      let x3_399: G = cst_G in
      let x4_398: G = cst_G in
      let x5_397: G = cst_G in
      find [unique] @i_500 <= qH0 suchthat defined(x1[@i_500], x2[@i_500], x3[@i_500], x4[@i_500], x5[@i_500], x5_385[@i_500], x4_386[@i_500], x3_387[@i_500], x2_388[@i_500], x1_389[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && ((x1_401 = x1[@i_500]) && ((x2_400 = x2[@i_500]) && ((X_s = x3[@i_500]) && ((Y = x4[@i_500]) && (K_s = x5[@i_500]))))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_500])
      )
      orfind  suchthat defined(@i_236[j], r_450[j]) && otheruses(r_450[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      orfind  suchthat defined(@i_236[j], r_456[j]) && otheruses(r_456[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_456[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_456[j])
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_396)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = cst_G in
      let x4_404: G = cst_G in
      let x5_403: G = cst_G in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], x5_385[@i_513], x4_386[@i_513], x3_387[@i_513], x2_388[@i_513], x1_389[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (K_s = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@1_x_783[@i_222], @2_m[@i_222], @2_kd[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_x_783[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_783[@i_222]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(@1_x_925[@i_217], Ystar_u[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @1_x_925[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_925[@i_217]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  let x3_393: G = cst_G in
  let x4_392: G = cst_G in
  let x5_391: G = cst_G in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_x_783[@i_198], @2_r4_157[@i_198], @2_kd[@i_198], @2_m[@i_198]) && otheruses(@2_m[@i_198] -> @1_x_783[@i_198]) && ((@2_x = exp(g, @1_x_783[@i_198])) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@1_x_925[@i_193], @2_r4_172[@i_193], Ystar_u[@i_193]) && otheruses(Ystar_u[@i_193] -> @1_x_925[@i_193]) && ((@2_x = exp(g, @1_x_925[@i_193])) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@1_x_783[@i_186], @2_m[@i_186], @2_kd[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_x_783[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], exp(g, @1_x_783[@i_186]))
  orfind @i_181 <= NU suchthat defined(@1_x_925[@i_181], Ystar_u[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @1_x_925[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], exp(g, @1_x_925[@i_181]))
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_x_783: exponent;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], exp(g, @1_x_783))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_389: host = cst_host in
  let x2_388: host = cst_host in
  let x3_387: G = cst_G in
  let x4_386: G = cst_G in
  let x5_385: G = cst_G in
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], x5_385[@i_474], x4_386[@i_474], x3_387[@i_474], x2_388[@i_474], x1_389[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(Xp[@i_473], Yp[@i_473], Kp[@i_473], x5_391[@i_473], x4_392[@i_473], x3_393[@i_473], x1_395[@i_473], x2_394[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && ((x1 = x1_395[@i_473]) && ((x2 = x2_394[@i_473]) && ((x3 = Xp[@i_473]) && ((x4 = Yp[@i_473]) && (x5 = Kp[@i_473]))))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(X_s[@i_472], Y[@i_472], K_s[@i_472], x5_397[@i_472], x4_398[@i_472], x3_399[@i_472], x1_401[@i_472], x2_400[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && ((x1 = x1_401[@i_472]) && ((x2 = x2_400[@i_472]) && ((x3 = X_s[@i_472]) && ((x4 = Y[@i_472]) && (x5 = K_s[@i_472]))))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(X_s[@i_471], Y[@i_471], K_s[@i_471], x5_403[@i_471], x4_404[@i_471], x3_405[@i_471], x1_407[@i_471], x2_406[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && ((x1 = x1_407[@i_471]) && ((x2 = x2_406[@i_471]) && ((x3 = X_s[@i_471]) && ((x4 = Y[@i_471]) && (x5 = K_s[@i_471]))))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(@1_x_925[@i_470], X[@i_470], @2_r4_172[@i_470], K_u[@i_470], x5_409[@i_470], x4_410[@i_470], x3_411[@i_470], x1_413[@i_470], x2_412[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && ((x1 = x1_413[@i_470]) && ((x2 = x2_412[@i_470]) && ((x3 = X[@i_470]) && ((x4 = exp(g, @1_x_925[@i_470])) && (x5 = K_u[@i_470]))))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(@1_x_783[@i_246[@i_469]], X[@i_469], @2_r4_157[@i_246[@i_469]], K_u[@i_469], x5_415[@i_469], x4_416[@i_469], x3_417[@i_469], x1_419[@i_469], x2_418[@i_469], r_414[@i_469]) && otheruses(r_414[@i_469]) && ((x1 = x1_419[@i_469]) && ((x2 = x2_418[@i_469]) && ((x3 = X[@i_469]) && ((x4 = exp(g, @1_x_783[@i_246[@i_469]])) && (x5 = K_u[@i_469]))))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(@1_x_783[@i_246[@i_468]], X[@i_468], @2_r4_157[@i_246[@i_468]], K_u[@i_468], x5_421[@i_468], x4_422[@i_468], x3_423[@i_468], x1_425[@i_468], x2_424[@i_468], r_420[@i_468]) && otheruses(r_420[@i_468]) && ((x1 = x1_425[@i_468]) && ((x2 = x2_424[@i_468]) && ((x3 = X[@i_468]) && ((x4 = exp(g, @1_x_783[@i_246[@i_468]])) && (x5 = K_u[@i_468]))))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(@1_x_925[@i_241[@i_467]], X[@i_467], @2_r4_172[@i_241[@i_467]], K_u[@i_467], x5_427[@i_467], x4_428[@i_467], x3_429[@i_467], x1_431[@i_467], x2_430[@i_467], r_426[@i_467]) && otheruses(r_426[@i_467]) && ((x1 = x1_431[@i_467]) && ((x2 = x2_430[@i_467]) && ((x3 = X[@i_467]) && ((x4 = exp(g, @1_x_925[@i_241[@i_467]])) && (x5 = K_u[@i_467]))))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(@1_x_925[@i_241[@i_466]], X[@i_466], @2_r4_172[@i_241[@i_466]], K_u[@i_466], x5_433[@i_466], x4_434[@i_466], x3_435[@i_466], x1_437[@i_466], x2_436[@i_466], r_432[@i_466]) && otheruses(r_432[@i_466]) && ((x1 = x1_437[@i_466]) && ((x2 = x2_436[@i_466]) && ((x3 = X[@i_466]) && ((x4 = exp(g, @1_x_925[@i_241[@i_466]])) && (x5 = K_u[@i_466]))))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(X[@i_465], Yp[@i_238[@i_465]], K_u[@i_465], x5_439[@i_465], x4_440[@i_465], x3_441[@i_465], x1_443[@i_465], x2_442[@i_465], r_438[@i_465]) && otheruses(r_438[@i_465]) && ((x1 = x1_443[@i_465]) && ((x2 = x2_442[@i_465]) && ((x3 = X[@i_465]) && ((x4 = Yp[@i_238[@i_465]]) && (x5 = K_u[@i_465]))))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(X[@i_464], Yp[@i_238[@i_464]], K_u[@i_464], x5_445[@i_464], x4_446[@i_464], x3_447[@i_464], x1_449[@i_464], x2_448[@i_464], r_444[@i_464]) && otheruses(r_444[@i_464]) && ((x1 = x1_449[@i_464]) && ((x2 = x2_448[@i_464]) && ((x3 = X[@i_464]) && ((x4 = Yp[@i_238[@i_464]]) && (x5 = K_u[@i_464]))))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(X[@i_463], Y[@i_236[@i_463]], K_u[@i_463], x5_451[@i_463], x4_452[@i_463], x3_453[@i_463], x1_455[@i_463], x2_454[@i_463], r_450[@i_463]) && otheruses(r_450[@i_463]) && ((x1 = x1_455[@i_463]) && ((x2 = x2_454[@i_463]) && ((x3 = X[@i_463]) && ((x4 = Y[@i_236[@i_463]]) && (x5 = K_u[@i_463]))))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(X[@i_462], Y[@i_236[@i_462]], K_u[@i_462], x5_457[@i_462], x4_458[@i_462], x3_459[@i_462], x1_461[@i_462], x2_460[@i_462], r_456[@i_462]) && otheruses(r_456[@i_462]) && ((x1 = x1_461[@i_462]) && ((x2 = x2_460[@i_462]) && ((x3 = X[@i_462]) && ((x4 = Y[@i_236[@i_462]]) && (x5 = K_u[@i_462]))))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying SA rename K_u yields

Game 22 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@1_x_783[@i_246], @2_m[@i_246], @2_kd[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_x_783[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = exp(g, @1_x_783[@i_246]) in
    let K_u_1095: G = exp(g, mult(@1_x_783[@i_246], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_783[@i_246]) = x14[@i_120]) && (K_u_1095 = x15[@i_120]))))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      let x3_423: G = cst_G in
      let x4_422: G = cst_G in
      let x5_421: G = cst_G in
      find [unique] @i_552 <= qH0 suchthat defined(x1[@i_552], x2[@i_552], x3[@i_552], x4[@i_552], x5[@i_552], x5_385[@i_552], x4_386[@i_552], x3_387[@i_552], x2_388[@i_552], x1_389[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && ((x1_425 = x1[@i_552]) && ((x2_424 = x2[@i_552]) && ((X = x3[@i_552]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_552]) && (K_u_1095 = x5[@i_552]))))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_552]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_420);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_419: host = U in
      let x2_418: host = S in
      let x3_417: G = cst_G in
      let x4_416: G = cst_G in
      let x5_415: G = cst_G in
      find [unique] @i_539 <= qH0 suchthat defined(x1[@i_539], x2[@i_539], x3[@i_539], x4[@i_539], x5[@i_539], x5_385[@i_539], x4_386[@i_539], x3_387[@i_539], x2_388[@i_539], x1_389[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && ((x1_419 = x1[@i_539]) && ((x2_418 = x2[@i_539]) && ((X = x3[@i_539]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_539]) && (K_u_1095 = x5[@i_539]))))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_539]);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_414);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(@1_x_925[@i_241], Ystar_u[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @1_x_925[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = exp(g, @1_x_925[@i_241]) in
    let K_u_1096: G = exp(g, mult(@1_x_925[@i_241], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_925[@i_241]) = x14[@i_120]) && (K_u_1096 = x15[@i_120]))))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      let x3_435: G = cst_G in
      let x4_434: G = cst_G in
      let x5_433: G = cst_G in
      find [unique] @i_578 <= qH0 suchthat defined(x1[@i_578], x2[@i_578], x3[@i_578], x4[@i_578], x5[@i_578], x5_385[@i_578], x4_386[@i_578], x3_387[@i_578], x2_388[@i_578], x1_389[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && ((x1_437 = x1[@i_578]) && ((x2_436 = x2[@i_578]) && ((X = x3[@i_578]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_578]) && (K_u_1096 = x5[@i_578]))))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_578]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_432);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_431: host = U in
      let x2_430: host = S in
      let x3_429: G = cst_G in
      let x4_428: G = cst_G in
      let x5_427: G = cst_G in
      find [unique] @i_565 <= qH0 suchthat defined(x1[@i_565], x2[@i_565], x3[@i_565], x4[@i_565], x5[@i_565], x5_385[@i_565], x4_386[@i_565], x3_387[@i_565], x2_388[@i_565], x1_389[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && ((x1_431 = x1[@i_565]) && ((x2_430 = x2[@i_565]) && ((X = x3[@i_565]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_565]) && (K_u_1096 = x5[@i_565]))))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_565]);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_426);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u_1097: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (K_u_1097 = x15[@i_120]))))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      let x3_447: G = cst_G in
      let x4_446: G = cst_G in
      let x5_445: G = cst_G in
      find [unique] @i_604 <= qH0 suchthat defined(x1[@i_604], x2[@i_604], x3[@i_604], x4[@i_604], x5[@i_604], x5_385[@i_604], x4_386[@i_604], x3_387[@i_604], x2_388[@i_604], x1_389[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && ((x1_449 = x1[@i_604]) && ((x2_448 = x2[@i_604]) && ((X = x3[@i_604]) && ((Yp[@i_238] = x4[@i_604]) && (K_u_1097 = x5[@i_604]))))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_604]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_444);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_443: host = U in
      let x2_442: host = S in
      let x3_441: G = cst_G in
      let x4_440: G = cst_G in
      let x5_439: G = cst_G in
      find [unique] @i_591 <= qH0 suchthat defined(x1[@i_591], x2[@i_591], x3[@i_591], x4[@i_591], x5[@i_591], x5_385[@i_591], x4_386[@i_591], x3_387[@i_591], x2_388[@i_591], x1_389[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && ((x1_443 = x1[@i_591]) && ((x2_442 = x2[@i_591]) && ((X = x3[@i_591]) && ((Yp[@i_238] = x4[@i_591]) && (K_u_1097 = x5[@i_591]))))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_591]);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_438);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u_1098: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (K_u_1098 = x15[@i_120]))))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      let x3_459: G = cst_G in
      let x4_458: G = cst_G in
      let x5_457: G = cst_G in
      find [unique] @i_630 <= qH0 suchthat defined(x1[@i_630], x2[@i_630], x3[@i_630], x4[@i_630], x5[@i_630], x5_385[@i_630], x4_386[@i_630], x3_387[@i_630], x2_388[@i_630], x1_389[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && ((x1_461 = x1[@i_630]) && ((x2_460 = x2[@i_630]) && ((X = x3[@i_630]) && ((Y[@i_236] = x4[@i_630]) && (K_u_1098 = x5[@i_630]))))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_630]);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind  suchthat defined(j[@i_236], r_396[@i_236]) && otheruses(r_396[@i_236]) && (!_41 = j[@i_236]) then
      (
        let sk_u: hash0 = r_396[@i_236] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_396[@i_236]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_456);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_455: host = U in
      let x2_454: host = S in
      let x3_453: G = cst_G in
      let x4_452: G = cst_G in
      let x5_451: G = cst_G in
      find [unique] @i_617 <= qH0 suchthat defined(x1[@i_617], x2[@i_617], x3[@i_617], x4[@i_617], x5[@i_617], x5_385[@i_617], x4_386[@i_617], x3_387[@i_617], x2_388[@i_617], x1_389[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && ((x1_455 = x1[@i_617]) && ((x2_454 = x2[@i_617]) && ((X = x3[@i_617]) && ((Y[@i_236] = x4[@i_617]) && (K_u_1098 = x5[@i_617]))))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_617]);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_450);
        out(c6[!_41], r1_90)
  )
  else
    new @1_x_925: exponent;
    let @2_r4_172: G = cst_G in
    let Y_u: G = exp(g, @1_x_925) in
    let K_u_1099: G = exp(g, mult(@1_x_925, x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    let x3_411: G = cst_G in
    let x4_410: G = cst_G in
    let x5_409: G = cst_G in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      let x3_399: G = cst_G in
      let x4_398: G = cst_G in
      let x5_397: G = cst_G in
      find [unique] @i_500 <= qH0 suchthat defined(x1[@i_500], x2[@i_500], x3[@i_500], x4[@i_500], x5[@i_500], x5_385[@i_500], x4_386[@i_500], x3_387[@i_500], x2_388[@i_500], x1_389[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && ((x1_401 = x1[@i_500]) && ((x2_400 = x2[@i_500]) && ((X_s = x3[@i_500]) && ((Y = x4[@i_500]) && (K_s = x5[@i_500]))))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_500])
      )
      orfind  suchthat defined(@i_236[j], r_450[j]) && otheruses(r_450[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      orfind  suchthat defined(@i_236[j], r_456[j]) && otheruses(r_456[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_456[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_456[j])
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_396)
    )
    orfind  suchthat defined(Y_u[j], K_u_1095[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u_1095[j])) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = cst_G in
      let x4_404: G = cst_G in
      let x5_403: G = cst_G in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], x5_385[@i_513], x4_386[@i_513], x3_387[@i_513], x2_388[@i_513], x1_389[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (K_s = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
    orfind  suchthat defined(Y_u[j], K_u_1096[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u_1096[j])) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = cst_G in
      let x4_404: G = cst_G in
      let x5_403: G = cst_G in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], x5_385[@i_513], x4_386[@i_513], x3_387[@i_513], x2_388[@i_513], x1_389[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (K_s = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
    orfind  suchthat defined(Y_u[j], K_u_1097[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u_1097[j])) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = cst_G in
      let x4_404: G = cst_G in
      let x5_403: G = cst_G in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], x5_385[@i_513], x4_386[@i_513], x3_387[@i_513], x2_388[@i_513], x1_389[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (K_s = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
    orfind  suchthat defined(Y_u[j], K_u_1098[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u_1098[j])) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = cst_G in
      let x4_404: G = cst_G in
      let x5_403: G = cst_G in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], x5_385[@i_513], x4_386[@i_513], x3_387[@i_513], x2_388[@i_513], x1_389[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (K_s = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
    orfind  suchthat defined(Y_u[j], K_u_1099[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u_1099[j])) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = cst_G in
      let x4_404: G = cst_G in
      let x5_403: G = cst_G in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], x5_385[@i_513], x4_386[@i_513], x3_387[@i_513], x2_388[@i_513], x1_389[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (K_s = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@1_x_783[@i_222], @2_m[@i_222], @2_kd[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_x_783[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_783[@i_222]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(@1_x_925[@i_217], Ystar_u[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @1_x_925[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_925[@i_217]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  let x3_393: G = cst_G in
  let x4_392: G = cst_G in
  let x5_391: G = cst_G in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_x_783[@i_198], @2_r4_157[@i_198], @2_kd[@i_198], @2_m[@i_198]) && otheruses(@2_m[@i_198] -> @1_x_783[@i_198]) && ((@2_x = exp(g, @1_x_783[@i_198])) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@1_x_925[@i_193], @2_r4_172[@i_193], Ystar_u[@i_193]) && otheruses(Ystar_u[@i_193] -> @1_x_925[@i_193]) && ((@2_x = exp(g, @1_x_925[@i_193])) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@1_x_783[@i_186], @2_m[@i_186], @2_kd[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_x_783[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], exp(g, @1_x_783[@i_186]))
  orfind @i_181 <= NU suchthat defined(@1_x_925[@i_181], Ystar_u[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @1_x_925[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], exp(g, @1_x_925[@i_181]))
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_x_783: exponent;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], exp(g, @1_x_783))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_389: host = cst_host in
  let x2_388: host = cst_host in
  let x3_387: G = cst_G in
  let x4_386: G = cst_G in
  let x5_385: G = cst_G in
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], x5_385[@i_474], x4_386[@i_474], x3_387[@i_474], x2_388[@i_474], x1_389[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(Xp[@i_473], Yp[@i_473], Kp[@i_473], x5_391[@i_473], x4_392[@i_473], x3_393[@i_473], x1_395[@i_473], x2_394[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && ((x1 = x1_395[@i_473]) && ((x2 = x2_394[@i_473]) && ((x3 = Xp[@i_473]) && ((x4 = Yp[@i_473]) && (x5 = Kp[@i_473]))))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(X_s[@i_472], Y[@i_472], K_s[@i_472], x5_397[@i_472], x4_398[@i_472], x3_399[@i_472], x1_401[@i_472], x2_400[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && ((x1 = x1_401[@i_472]) && ((x2 = x2_400[@i_472]) && ((x3 = X_s[@i_472]) && ((x4 = Y[@i_472]) && (x5 = K_s[@i_472]))))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(X_s[@i_471], Y[@i_471], K_s[@i_471], x5_403[@i_471], x4_404[@i_471], x3_405[@i_471], x1_407[@i_471], x2_406[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && ((x1 = x1_407[@i_471]) && ((x2 = x2_406[@i_471]) && ((x3 = X_s[@i_471]) && ((x4 = Y[@i_471]) && (x5 = K_s[@i_471]))))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(@1_x_925[@i_470], X[@i_470], @2_r4_172[@i_470], K_u_1099[@i_470], x5_409[@i_470], x4_410[@i_470], x3_411[@i_470], x1_413[@i_470], x2_412[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && ((x1 = x1_413[@i_470]) && ((x2 = x2_412[@i_470]) && ((x3 = X[@i_470]) && ((x4 = exp(g, @1_x_925[@i_470])) && (x5 = K_u_1099[@i_470]))))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(@1_x_783[@i_246[@i_469]], X[@i_469], @2_r4_157[@i_246[@i_469]], K_u_1095[@i_469], x5_415[@i_469], x4_416[@i_469], x3_417[@i_469], x1_419[@i_469], x2_418[@i_469], r_414[@i_469]) && otheruses(r_414[@i_469]) && ((x1 = x1_419[@i_469]) && ((x2 = x2_418[@i_469]) && ((x3 = X[@i_469]) && ((x4 = exp(g, @1_x_783[@i_246[@i_469]])) && (x5 = K_u_1095[@i_469]))))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(@1_x_783[@i_246[@i_468]], X[@i_468], @2_r4_157[@i_246[@i_468]], K_u_1095[@i_468], x5_421[@i_468], x4_422[@i_468], x3_423[@i_468], x1_425[@i_468], x2_424[@i_468], r_420[@i_468]) && otheruses(r_420[@i_468]) && ((x1 = x1_425[@i_468]) && ((x2 = x2_424[@i_468]) && ((x3 = X[@i_468]) && ((x4 = exp(g, @1_x_783[@i_246[@i_468]])) && (x5 = K_u_1095[@i_468]))))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(@1_x_925[@i_241[@i_467]], X[@i_467], @2_r4_172[@i_241[@i_467]], K_u_1096[@i_467], x5_427[@i_467], x4_428[@i_467], x3_429[@i_467], x1_431[@i_467], x2_430[@i_467], r_426[@i_467]) && otheruses(r_426[@i_467]) && ((x1 = x1_431[@i_467]) && ((x2 = x2_430[@i_467]) && ((x3 = X[@i_467]) && ((x4 = exp(g, @1_x_925[@i_241[@i_467]])) && (x5 = K_u_1096[@i_467]))))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(@1_x_925[@i_241[@i_466]], X[@i_466], @2_r4_172[@i_241[@i_466]], K_u_1096[@i_466], x5_433[@i_466], x4_434[@i_466], x3_435[@i_466], x1_437[@i_466], x2_436[@i_466], r_432[@i_466]) && otheruses(r_432[@i_466]) && ((x1 = x1_437[@i_466]) && ((x2 = x2_436[@i_466]) && ((x3 = X[@i_466]) && ((x4 = exp(g, @1_x_925[@i_241[@i_466]])) && (x5 = K_u_1096[@i_466]))))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(X[@i_465], Yp[@i_238[@i_465]], K_u_1097[@i_465], x5_439[@i_465], x4_440[@i_465], x3_441[@i_465], x1_443[@i_465], x2_442[@i_465], r_438[@i_465]) && otheruses(r_438[@i_465]) && ((x1 = x1_443[@i_465]) && ((x2 = x2_442[@i_465]) && ((x3 = X[@i_465]) && ((x4 = Yp[@i_238[@i_465]]) && (x5 = K_u_1097[@i_465]))))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(X[@i_464], Yp[@i_238[@i_464]], K_u_1097[@i_464], x5_445[@i_464], x4_446[@i_464], x3_447[@i_464], x1_449[@i_464], x2_448[@i_464], r_444[@i_464]) && otheruses(r_444[@i_464]) && ((x1 = x1_449[@i_464]) && ((x2 = x2_448[@i_464]) && ((x3 = X[@i_464]) && ((x4 = Yp[@i_238[@i_464]]) && (x5 = K_u_1097[@i_464]))))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(X[@i_463], Y[@i_236[@i_463]], K_u_1098[@i_463], x5_451[@i_463], x4_452[@i_463], x3_453[@i_463], x1_455[@i_463], x2_454[@i_463], r_450[@i_463]) && otheruses(r_450[@i_463]) && ((x1 = x1_455[@i_463]) && ((x2 = x2_454[@i_463]) && ((x3 = X[@i_463]) && ((x4 = Y[@i_236[@i_463]]) && (x5 = K_u_1098[@i_463]))))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(X[@i_462], Y[@i_236[@i_462]], K_u_1098[@i_462], x5_457[@i_462], x4_458[@i_462], x3_459[@i_462], x1_461[@i_462], x2_460[@i_462], r_456[@i_462]) && otheruses(r_456[@i_462]) && ((x1 = x1_461[@i_462]) && ((x2 = x2_460[@i_462]) && ((x3 = X[@i_462]) && ((x4 = Y[@i_236[@i_462]]) && (x5 = K_u_1098[@i_462]))))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1095[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1095[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1096[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1096[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1097[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1097[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1098[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1098[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1099[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1099[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of useless yields

Game 23 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@1_x_783[@i_246], @2_m[@i_246], @2_kd[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_x_783[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = exp(g, @1_x_783[@i_246]) in
    let K_u_1095: G = exp(g, mult(@1_x_783[@i_246], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_783[@i_246]) = x14[@i_120]) && (K_u_1095 = x15[@i_120]))))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      let x3_423: G = cst_G in
      let x4_422: G = cst_G in
      let x5_421: G = cst_G in
      find [unique] @i_552 <= qH0 suchthat defined(x1[@i_552], x2[@i_552], x3[@i_552], x4[@i_552], x5[@i_552], x5_385[@i_552], x4_386[@i_552], x3_387[@i_552], x2_388[@i_552], x1_389[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && ((x1_425 = x1[@i_552]) && ((x2_424 = x2[@i_552]) && ((X = x3[@i_552]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_552]) && (K_u_1095 = x5[@i_552]))))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_552]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_420);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_419: host = U in
      let x2_418: host = S in
      let x3_417: G = cst_G in
      let x4_416: G = cst_G in
      let x5_415: G = cst_G in
      find [unique] @i_539 <= qH0 suchthat defined(x1[@i_539], x2[@i_539], x3[@i_539], x4[@i_539], x5[@i_539], x5_385[@i_539], x4_386[@i_539], x3_387[@i_539], x2_388[@i_539], x1_389[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && ((x1_419 = x1[@i_539]) && ((x2_418 = x2[@i_539]) && ((X = x3[@i_539]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_539]) && (K_u_1095 = x5[@i_539]))))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_539]);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_414);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(@1_x_925[@i_241], Ystar_u[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @1_x_925[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = exp(g, @1_x_925[@i_241]) in
    let K_u_1096: G = exp(g, mult(@1_x_925[@i_241], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_925[@i_241]) = x14[@i_120]) && (K_u_1096 = x15[@i_120]))))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      let x3_435: G = cst_G in
      let x4_434: G = cst_G in
      let x5_433: G = cst_G in
      find [unique] @i_578 <= qH0 suchthat defined(x1[@i_578], x2[@i_578], x3[@i_578], x4[@i_578], x5[@i_578], x5_385[@i_578], x4_386[@i_578], x3_387[@i_578], x2_388[@i_578], x1_389[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && ((x1_437 = x1[@i_578]) && ((x2_436 = x2[@i_578]) && ((X = x3[@i_578]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_578]) && (K_u_1096 = x5[@i_578]))))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_578]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_432);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_431: host = U in
      let x2_430: host = S in
      let x3_429: G = cst_G in
      let x4_428: G = cst_G in
      let x5_427: G = cst_G in
      find [unique] @i_565 <= qH0 suchthat defined(x1[@i_565], x2[@i_565], x3[@i_565], x4[@i_565], x5[@i_565], x5_385[@i_565], x4_386[@i_565], x3_387[@i_565], x2_388[@i_565], x1_389[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && ((x1_431 = x1[@i_565]) && ((x2_430 = x2[@i_565]) && ((X = x3[@i_565]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_565]) && (K_u_1096 = x5[@i_565]))))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_565]);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_426);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u_1097: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (K_u_1097 = x15[@i_120]))))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      let x3_447: G = cst_G in
      let x4_446: G = cst_G in
      let x5_445: G = cst_G in
      find [unique] @i_604 <= qH0 suchthat defined(x1[@i_604], x2[@i_604], x3[@i_604], x4[@i_604], x5[@i_604], x5_385[@i_604], x4_386[@i_604], x3_387[@i_604], x2_388[@i_604], x1_389[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && ((x1_449 = x1[@i_604]) && ((x2_448 = x2[@i_604]) && ((X = x3[@i_604]) && ((Yp[@i_238] = x4[@i_604]) && (K_u_1097 = x5[@i_604]))))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_604]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_444);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_443: host = U in
      let x2_442: host = S in
      let x3_441: G = cst_G in
      let x4_440: G = cst_G in
      let x5_439: G = cst_G in
      find [unique] @i_591 <= qH0 suchthat defined(x1[@i_591], x2[@i_591], x3[@i_591], x4[@i_591], x5[@i_591], x5_385[@i_591], x4_386[@i_591], x3_387[@i_591], x2_388[@i_591], x1_389[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && ((x1_443 = x1[@i_591]) && ((x2_442 = x2[@i_591]) && ((X = x3[@i_591]) && ((Yp[@i_238] = x4[@i_591]) && (K_u_1097 = x5[@i_591]))))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_591]);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_438);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u_1098: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (K_u_1098 = x15[@i_120]))))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      let x3_459: G = cst_G in
      let x4_458: G = cst_G in
      let x5_457: G = cst_G in
      find [unique] @i_630 <= qH0 suchthat defined(x1[@i_630], x2[@i_630], x3[@i_630], x4[@i_630], x5[@i_630], x5_385[@i_630], x4_386[@i_630], x3_387[@i_630], x2_388[@i_630], x1_389[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && ((x1_461 = x1[@i_630]) && ((x2_460 = x2[@i_630]) && ((X = x3[@i_630]) && ((Y[@i_236] = x4[@i_630]) && (K_u_1098 = x5[@i_630]))))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_630]);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind  suchthat defined(j[@i_236], r_396[@i_236]) && otheruses(r_396[@i_236]) && (!_41 = j[@i_236]) then
      (
        let sk_u: hash0 = r_396[@i_236] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_396[@i_236]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_456);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_455: host = U in
      let x2_454: host = S in
      let x3_453: G = cst_G in
      let x4_452: G = cst_G in
      let x5_451: G = cst_G in
      find [unique] @i_617 <= qH0 suchthat defined(x1[@i_617], x2[@i_617], x3[@i_617], x4[@i_617], x5[@i_617], x5_385[@i_617], x4_386[@i_617], x3_387[@i_617], x2_388[@i_617], x1_389[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && ((x1_455 = x1[@i_617]) && ((x2_454 = x2[@i_617]) && ((X = x3[@i_617]) && ((Y[@i_236] = x4[@i_617]) && (K_u_1098 = x5[@i_617]))))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_617]);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_450);
        out(c6[!_41], r1_90)
  )
  else
    new @1_x_925: exponent;
    let @2_r4_172: G = cst_G in
    let Y_u: G = exp(g, @1_x_925) in
    let K_u_1099: G = exp(g, mult(@1_x_925, x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    let x3_411: G = cst_G in
    let x4_410: G = cst_G in
    let x5_409: G = cst_G in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      let x3_399: G = cst_G in
      let x4_398: G = cst_G in
      let x5_397: G = cst_G in
      find [unique] @i_500 <= qH0 suchthat defined(x1[@i_500], x2[@i_500], x3[@i_500], x4[@i_500], x5[@i_500], x5_385[@i_500], x4_386[@i_500], x3_387[@i_500], x2_388[@i_500], x1_389[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && ((x1_401 = x1[@i_500]) && ((x2_400 = x2[@i_500]) && ((X_s = x3[@i_500]) && ((Y = x4[@i_500]) && (K_s = x5[@i_500]))))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_500])
      )
      orfind  suchthat defined(@i_236[j], r_450[j]) && otheruses(r_450[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      orfind  suchthat defined(@i_236[j], r_456[j]) && otheruses(r_456[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_456[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_456[j])
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_396)
    )
    orfind  suchthat defined(Y_u[j], K_u_1095[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u_1095[j])) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = cst_G in
      let x4_404: G = cst_G in
      let x5_403: G = cst_G in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], x5_385[@i_513], x4_386[@i_513], x3_387[@i_513], x2_388[@i_513], x1_389[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (K_s = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
    orfind  suchthat defined(Y_u[j], K_u_1096[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u_1096[j])) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = cst_G in
      let x4_404: G = cst_G in
      let x5_403: G = cst_G in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], x5_385[@i_513], x4_386[@i_513], x3_387[@i_513], x2_388[@i_513], x1_389[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (K_s = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
    orfind  suchthat defined(Y_u[j], K_u_1097[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u_1097[j])) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = cst_G in
      let x4_404: G = cst_G in
      let x5_403: G = cst_G in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], x5_385[@i_513], x4_386[@i_513], x3_387[@i_513], x2_388[@i_513], x1_389[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (K_s = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
    orfind  suchthat defined(Y_u[j], K_u_1098[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u_1098[j])) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = cst_G in
      let x4_404: G = cst_G in
      let x5_403: G = cst_G in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], x5_385[@i_513], x4_386[@i_513], x3_387[@i_513], x2_388[@i_513], x1_389[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (K_s = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
    orfind  suchthat defined(Y_u[j], K_u_1099[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u_1099[j])) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = cst_G in
      let x4_404: G = cst_G in
      let x5_403: G = cst_G in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], x5_385[@i_513], x4_386[@i_513], x3_387[@i_513], x2_388[@i_513], x1_389[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (K_s = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@1_x_783[@i_222], @2_m[@i_222], @2_kd[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_x_783[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_783[@i_222]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(@1_x_925[@i_217], Ystar_u[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @1_x_925[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_925[@i_217]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  let x3_393: G = cst_G in
  let x4_392: G = cst_G in
  let x5_391: G = cst_G in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_x_783[@i_198], @2_r4_157[@i_198], @2_kd[@i_198], @2_m[@i_198]) && otheruses(@2_m[@i_198] -> @1_x_783[@i_198]) && ((@2_x = exp(g, @1_x_783[@i_198])) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@1_x_925[@i_193], @2_r4_172[@i_193], Ystar_u[@i_193]) && otheruses(Ystar_u[@i_193] -> @1_x_925[@i_193]) && ((@2_x = exp(g, @1_x_925[@i_193])) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@1_x_783[@i_186], @2_m[@i_186], @2_kd[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_x_783[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], exp(g, @1_x_783[@i_186]))
  orfind @i_181 <= NU suchthat defined(@1_x_925[@i_181], Ystar_u[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @1_x_925[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], exp(g, @1_x_925[@i_181]))
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_x_783: exponent;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], exp(g, @1_x_783))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_389: host = cst_host in
  let x2_388: host = cst_host in
  let x3_387: G = cst_G in
  let x4_386: G = cst_G in
  let x5_385: G = cst_G in
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], x5_385[@i_474], x4_386[@i_474], x3_387[@i_474], x2_388[@i_474], x1_389[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(Xp[@i_473], Yp[@i_473], Kp[@i_473], x5_391[@i_473], x4_392[@i_473], x3_393[@i_473], x1_395[@i_473], x2_394[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && ((x1 = x1_395[@i_473]) && ((x2 = x2_394[@i_473]) && ((x3 = Xp[@i_473]) && ((x4 = Yp[@i_473]) && (x5 = Kp[@i_473]))))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(X_s[@i_472], Y[@i_472], K_s[@i_472], x5_397[@i_472], x4_398[@i_472], x3_399[@i_472], x1_401[@i_472], x2_400[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && ((x1 = x1_401[@i_472]) && ((x2 = x2_400[@i_472]) && ((x3 = X_s[@i_472]) && ((x4 = Y[@i_472]) && (x5 = K_s[@i_472]))))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(X_s[@i_471], Y[@i_471], K_s[@i_471], x5_403[@i_471], x4_404[@i_471], x3_405[@i_471], x1_407[@i_471], x2_406[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && ((x1 = x1_407[@i_471]) && ((x2 = x2_406[@i_471]) && ((x3 = X_s[@i_471]) && ((x4 = Y[@i_471]) && (x5 = K_s[@i_471]))))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(@1_x_925[@i_470], X[@i_470], @2_r4_172[@i_470], K_u_1099[@i_470], x5_409[@i_470], x4_410[@i_470], x3_411[@i_470], x1_413[@i_470], x2_412[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && ((x1 = x1_413[@i_470]) && ((x2 = x2_412[@i_470]) && ((x3 = X[@i_470]) && ((x4 = exp(g, @1_x_925[@i_470])) && (x5 = K_u_1099[@i_470]))))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(@1_x_783[@i_246[@i_469]], X[@i_469], @2_r4_157[@i_246[@i_469]], K_u_1095[@i_469], x5_415[@i_469], x4_416[@i_469], x3_417[@i_469], x1_419[@i_469], x2_418[@i_469], r_414[@i_469]) && otheruses(r_414[@i_469]) && ((x1 = x1_419[@i_469]) && ((x2 = x2_418[@i_469]) && ((x3 = X[@i_469]) && ((x4 = exp(g, @1_x_783[@i_246[@i_469]])) && (x5 = K_u_1095[@i_469]))))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(@1_x_783[@i_246[@i_468]], X[@i_468], @2_r4_157[@i_246[@i_468]], K_u_1095[@i_468], x5_421[@i_468], x4_422[@i_468], x3_423[@i_468], x1_425[@i_468], x2_424[@i_468], r_420[@i_468]) && otheruses(r_420[@i_468]) && ((x1 = x1_425[@i_468]) && ((x2 = x2_424[@i_468]) && ((x3 = X[@i_468]) && ((x4 = exp(g, @1_x_783[@i_246[@i_468]])) && (x5 = K_u_1095[@i_468]))))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(@1_x_925[@i_241[@i_467]], X[@i_467], @2_r4_172[@i_241[@i_467]], K_u_1096[@i_467], x5_427[@i_467], x4_428[@i_467], x3_429[@i_467], x1_431[@i_467], x2_430[@i_467], r_426[@i_467]) && otheruses(r_426[@i_467]) && ((x1 = x1_431[@i_467]) && ((x2 = x2_430[@i_467]) && ((x3 = X[@i_467]) && ((x4 = exp(g, @1_x_925[@i_241[@i_467]])) && (x5 = K_u_1096[@i_467]))))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(@1_x_925[@i_241[@i_466]], X[@i_466], @2_r4_172[@i_241[@i_466]], K_u_1096[@i_466], x5_433[@i_466], x4_434[@i_466], x3_435[@i_466], x1_437[@i_466], x2_436[@i_466], r_432[@i_466]) && otheruses(r_432[@i_466]) && ((x1 = x1_437[@i_466]) && ((x2 = x2_436[@i_466]) && ((x3 = X[@i_466]) && ((x4 = exp(g, @1_x_925[@i_241[@i_466]])) && (x5 = K_u_1096[@i_466]))))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(X[@i_465], Yp[@i_238[@i_465]], K_u_1097[@i_465], x5_439[@i_465], x4_440[@i_465], x3_441[@i_465], x1_443[@i_465], x2_442[@i_465], r_438[@i_465]) && otheruses(r_438[@i_465]) && ((x1 = x1_443[@i_465]) && ((x2 = x2_442[@i_465]) && ((x3 = X[@i_465]) && ((x4 = Yp[@i_238[@i_465]]) && (x5 = K_u_1097[@i_465]))))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(X[@i_464], Yp[@i_238[@i_464]], K_u_1097[@i_464], x5_445[@i_464], x4_446[@i_464], x3_447[@i_464], x1_449[@i_464], x2_448[@i_464], r_444[@i_464]) && otheruses(r_444[@i_464]) && ((x1 = x1_449[@i_464]) && ((x2 = x2_448[@i_464]) && ((x3 = X[@i_464]) && ((x4 = Yp[@i_238[@i_464]]) && (x5 = K_u_1097[@i_464]))))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(X[@i_463], Y[@i_236[@i_463]], K_u_1098[@i_463], x5_451[@i_463], x4_452[@i_463], x3_453[@i_463], x1_455[@i_463], x2_454[@i_463], r_450[@i_463]) && otheruses(r_450[@i_463]) && ((x1 = x1_455[@i_463]) && ((x2 = x2_454[@i_463]) && ((x3 = X[@i_463]) && ((x4 = Y[@i_236[@i_463]]) && (x5 = K_u_1098[@i_463]))))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(X[@i_462], Y[@i_236[@i_462]], K_u_1098[@i_462], x5_457[@i_462], x4_458[@i_462], x3_459[@i_462], x1_461[@i_462], x2_460[@i_462], r_456[@i_462]) && otheruses(r_456[@i_462]) && ((x1 = x1_461[@i_462]) && ((x2 = x2_460[@i_462]) && ((x3 = X[@i_462]) && ((x4 = Y[@i_236[@i_462]]) && (x5 = K_u_1098[@i_462]))))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1095[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1095[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1096[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1096[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1097[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1097[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1098[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1098[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1099[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1099[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying simplify [Excluding set(dist 23->24, proba <= 4. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|)] yields

Game 24 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_x_783[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_x_783[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = exp(g, @1_x_783[@i_246]) in
    let K_u_1095: G = exp(g, mult(@1_x_783[@i_246], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_783[@i_246]) = x14[@i_120]) && (K_u_1095 = x15[@i_120]))))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      let x3_423: G = cst_G in
      let x4_422: G = cst_G in
      let x5_421: G = cst_G in
      find [unique] @i_552 <= qH0 suchthat defined(x1[@i_552], x2[@i_552], x3[@i_552], x4[@i_552], x5[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && ((x1_425 = x1[@i_552]) && ((x2_424 = x2[@i_552]) && ((X = x3[@i_552]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_552]) && (K_u_1095 = x5[@i_552]))))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_552]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_420);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_419: host = U in
      let x2_418: host = S in
      let x3_417: G = cst_G in
      let x4_416: G = cst_G in
      let x5_415: G = cst_G in
      find [unique] @i_539 <= qH0 suchthat defined(x1[@i_539], x2[@i_539], x3[@i_539], x4[@i_539], x5[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && ((x1_419 = x1[@i_539]) && ((x2_418 = x2[@i_539]) && ((X = x3[@i_539]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_539]) && (K_u_1095 = x5[@i_539]))))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_539]);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_414);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @1_x_925[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @1_x_925[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = exp(g, @1_x_925[@i_241]) in
    let K_u_1096: G = exp(g, mult(@1_x_925[@i_241], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_925[@i_241]) = x14[@i_120]) && (K_u_1096 = x15[@i_120]))))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      let x3_435: G = cst_G in
      let x4_434: G = cst_G in
      let x5_433: G = cst_G in
      find [unique] @i_578 <= qH0 suchthat defined(x1[@i_578], x2[@i_578], x3[@i_578], x4[@i_578], x5[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && ((x1_437 = x1[@i_578]) && ((x2_436 = x2[@i_578]) && ((X = x3[@i_578]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_578]) && (K_u_1096 = x5[@i_578]))))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_578]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_432);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_431: host = U in
      let x2_430: host = S in
      let x3_429: G = cst_G in
      let x4_428: G = cst_G in
      let x5_427: G = cst_G in
      find [unique] @i_565 <= qH0 suchthat defined(x1[@i_565], x2[@i_565], x3[@i_565], x4[@i_565], x5[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && ((x1_431 = x1[@i_565]) && ((x2_430 = x2[@i_565]) && ((X = x3[@i_565]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_565]) && (K_u_1096 = x5[@i_565]))))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_565]);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_426);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u_1097: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (K_u_1097 = x15[@i_120]))))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      let x3_447: G = cst_G in
      let x4_446: G = cst_G in
      let x5_445: G = cst_G in
      find [unique] @i_604 <= qH0 suchthat defined(x1[@i_604], x2[@i_604], x3[@i_604], x4[@i_604], x5[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && ((x1_449 = x1[@i_604]) && ((x2_448 = x2[@i_604]) && ((X = x3[@i_604]) && ((Yp[@i_238] = x4[@i_604]) && (K_u_1097 = x5[@i_604]))))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_604]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_444);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_443: host = U in
      let x2_442: host = S in
      let x3_441: G = cst_G in
      let x4_440: G = cst_G in
      let x5_439: G = cst_G in
      find [unique] @i_591 <= qH0 suchthat defined(x1[@i_591], x2[@i_591], x3[@i_591], x4[@i_591], x5[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && ((x1_443 = x1[@i_591]) && ((x2_442 = x2[@i_591]) && ((X = x3[@i_591]) && ((Yp[@i_238] = x4[@i_591]) && (K_u_1097 = x5[@i_591]))))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_591]);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_438);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u_1098: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (K_u_1098 = x15[@i_120]))))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      let x3_459: G = cst_G in
      let x4_458: G = cst_G in
      let x5_457: G = cst_G in
      find [unique] @i_630 <= qH0 suchthat defined(x1[@i_630], x2[@i_630], x3[@i_630], x4[@i_630], x5[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && ((x1_461 = x1[@i_630]) && ((x2_460 = x2[@i_630]) && ((X = x3[@i_630]) && ((Y[@i_236] = x4[@i_630]) && (K_u_1098 = x5[@i_630]))))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_630]);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind  suchthat defined(j[@i_236], r_396[@i_236]) && otheruses(r_396[@i_236]) && (!_41 = j[@i_236]) then
      (
        let sk_u: hash0 = r_396[@i_236] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_396[@i_236]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_456);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_455: host = U in
      let x2_454: host = S in
      let x3_453: G = cst_G in
      let x4_452: G = cst_G in
      let x5_451: G = cst_G in
      find [unique] @i_617 <= qH0 suchthat defined(x1[@i_617], x2[@i_617], x3[@i_617], x4[@i_617], x5[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && ((x1_455 = x1[@i_617]) && ((x2_454 = x2[@i_617]) && ((X = x3[@i_617]) && ((Y[@i_236] = x4[@i_617]) && (K_u_1098 = x5[@i_617]))))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_617]);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_450);
        out(c6[!_41], r1_90)
  )
  else
    new @1_x_925: exponent;
    let @2_r4_172: G = cst_G in
    let Y_u: G = exp(g, @1_x_925) in
    let K_u_1099: G = exp(g, mult(@1_x_925, x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    let x3_411: G = cst_G in
    let x4_410: G = cst_G in
    let x5_409: G = cst_G in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      let x3_399: G = cst_G in
      let x4_398: G = cst_G in
      let x5_397: G = cst_G in
      find [unique] @i_500 <= qH0 suchthat defined(x1[@i_500], x2[@i_500], x3[@i_500], x4[@i_500], x5[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && ((x1_401 = x1[@i_500]) && ((x2_400 = x2[@i_500]) && ((X_s = x3[@i_500]) && ((Y = x4[@i_500]) && (K_s = x5[@i_500]))))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_500])
      )
      orfind  suchthat defined(@i_236[j], r_450[j]) && otheruses(r_450[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      orfind  suchthat defined(@i_236[j], r_456[j]) && otheruses(r_456[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_456[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_456[j])
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_396)
    )
    orfind  suchthat defined(@i_236[j], r1_90[j], K_u_1098[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = cst_G in
      let x4_404: G = cst_G in
      let x5_403: G = cst_G in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (K_s = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_x_783[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_x_783[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_783[@i_222]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @1_x_925[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @1_x_925[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_925[@i_217]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  let x3_393: G = cst_G in
  let x4_392: G = cst_G in
  let x5_391: G = cst_G in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_x_783[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_x_783[@i_198]) && ((@2_x = exp(g, @1_x_783[@i_198])) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@1_x_925[@i_193], Ystar_u[@i_193], @2_r4_172[@i_193]) && otheruses(Ystar_u[@i_193] -> @1_x_925[@i_193]) && ((@2_x = exp(g, @1_x_925[@i_193])) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_x_783[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_x_783[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], exp(g, @1_x_783[@i_186]))
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @1_x_925[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @1_x_925[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], exp(g, @1_x_925[@i_181]))
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_x_783: exponent;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], exp(g, @1_x_783))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_389: host = cst_host in
  let x2_388: host = cst_host in
  let x3_387: G = cst_G in
  let x4_386: G = cst_G in
  let x5_385: G = cst_G in
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(x1_395[@i_473], x2_394[@i_473], Xp[@i_473], Yp[@i_473], Kp[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && ((x1 = x1_395[@i_473]) && ((x2 = x2_394[@i_473]) && ((x3 = Xp[@i_473]) && ((x4 = Yp[@i_473]) && (x5 = Kp[@i_473]))))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(x1_401[@i_472], x2_400[@i_472], X_s[@i_472], Y[@i_472], K_s[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && ((x1 = x1_401[@i_472]) && ((x2 = x2_400[@i_472]) && ((x3 = X_s[@i_472]) && ((x4 = Y[@i_472]) && (x5 = K_s[@i_472]))))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(x1_407[@i_471], x2_406[@i_471], X_s[@i_471], Y[@i_471], K_s[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && ((x1 = x1_407[@i_471]) && ((x2 = x2_406[@i_471]) && ((x3 = X_s[@i_471]) && ((x4 = Y[@i_471]) && (x5 = K_s[@i_471]))))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(x1_413[@i_470], x2_412[@i_470], X[@i_470], @1_x_925[@i_470], K_u_1099[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && ((x1 = x1_413[@i_470]) && ((x2 = x2_412[@i_470]) && ((x3 = X[@i_470]) && ((x4 = exp(g, @1_x_925[@i_470])) && (x5 = K_u_1099[@i_470]))))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(x1_419[@i_469], x2_418[@i_469], X[@i_469], @1_x_783[@i_246[@i_469]], K_u_1095[@i_469], r_414[@i_469]) && otheruses(r_414[@i_469]) && ((x1 = x1_419[@i_469]) && ((x2 = x2_418[@i_469]) && ((x3 = X[@i_469]) && ((x4 = exp(g, @1_x_783[@i_246[@i_469]])) && (x5 = K_u_1095[@i_469]))))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(x1_425[@i_468], x2_424[@i_468], X[@i_468], @1_x_783[@i_246[@i_468]], K_u_1095[@i_468], r_420[@i_468]) && otheruses(r_420[@i_468]) && ((x1 = x1_425[@i_468]) && ((x2 = x2_424[@i_468]) && ((x3 = X[@i_468]) && ((x4 = exp(g, @1_x_783[@i_246[@i_468]])) && (x5 = K_u_1095[@i_468]))))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(x1_431[@i_467], x2_430[@i_467], X[@i_467], @1_x_925[@i_241[@i_467]], K_u_1096[@i_467], r_426[@i_467]) && otheruses(r_426[@i_467]) && ((x1 = x1_431[@i_467]) && ((x2 = x2_430[@i_467]) && ((x3 = X[@i_467]) && ((x4 = exp(g, @1_x_925[@i_241[@i_467]])) && (x5 = K_u_1096[@i_467]))))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(x1_437[@i_466], x2_436[@i_466], X[@i_466], @1_x_925[@i_241[@i_466]], K_u_1096[@i_466], r_432[@i_466]) && otheruses(r_432[@i_466]) && ((x1 = x1_437[@i_466]) && ((x2 = x2_436[@i_466]) && ((x3 = X[@i_466]) && ((x4 = exp(g, @1_x_925[@i_241[@i_466]])) && (x5 = K_u_1096[@i_466]))))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(x1_443[@i_465], x2_442[@i_465], X[@i_465], Yp[@i_238[@i_465]], K_u_1097[@i_465], r_438[@i_465]) && otheruses(r_438[@i_465]) && ((x1 = x1_443[@i_465]) && ((x2 = x2_442[@i_465]) && ((x3 = X[@i_465]) && ((x4 = Yp[@i_238[@i_465]]) && (x5 = K_u_1097[@i_465]))))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(x1_449[@i_464], x2_448[@i_464], X[@i_464], Yp[@i_238[@i_464]], K_u_1097[@i_464], r_444[@i_464]) && otheruses(r_444[@i_464]) && ((x1 = x1_449[@i_464]) && ((x2 = x2_448[@i_464]) && ((x3 = X[@i_464]) && ((x4 = Yp[@i_238[@i_464]]) && (x5 = K_u_1097[@i_464]))))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(x1_455[@i_463], x2_454[@i_463], X[@i_463], Y[@i_236[@i_463]], K_u_1098[@i_463], r_450[@i_463]) && otheruses(r_450[@i_463]) && ((x1 = x1_455[@i_463]) && ((x2 = x2_454[@i_463]) && ((x3 = X[@i_463]) && ((x4 = Y[@i_236[@i_463]]) && (x5 = K_u_1098[@i_463]))))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(x1_461[@i_462], x2_460[@i_462], X[@i_462], Y[@i_236[@i_462]], K_u_1098[@i_462], r_456[@i_462]) && otheruses(r_456[@i_462]) && ((x1 = x1_461[@i_462]) && ((x2 = x2_460[@i_462]) && ((x3 = X[@i_462]) && ((x4 = Y[@i_236[@i_462]]) && (x5 = K_u_1098[@i_462]))))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1095[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1095[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1096[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1096[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1097[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1097[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1098[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1098[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1099[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1099[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of binder K_s yields

Game 25 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_x_783[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_x_783[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = exp(g, @1_x_783[@i_246]) in
    let K_u_1095: G = exp(g, mult(@1_x_783[@i_246], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_783[@i_246]) = x14[@i_120]) && (K_u_1095 = x15[@i_120]))))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      find [unique] @i_552 <= qH0 suchthat defined(x1[@i_552], x2[@i_552], x3[@i_552], x4[@i_552], x5[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && ((x1_425 = x1[@i_552]) && ((x2_424 = x2[@i_552]) && ((X = x3[@i_552]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_552]) && (K_u_1095 = x5[@i_552]))))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_552]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_420);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_419: host = U in
      let x2_418: host = S in
      find [unique] @i_539 <= qH0 suchthat defined(x1[@i_539], x2[@i_539], x3[@i_539], x4[@i_539], x5[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && ((x1_419 = x1[@i_539]) && ((x2_418 = x2[@i_539]) && ((X = x3[@i_539]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_539]) && (K_u_1095 = x5[@i_539]))))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_539]);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_414);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @1_x_925[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @1_x_925[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = exp(g, @1_x_925[@i_241]) in
    let K_u_1096: G = exp(g, mult(@1_x_925[@i_241], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_925[@i_241]) = x14[@i_120]) && (K_u_1096 = x15[@i_120]))))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      find [unique] @i_578 <= qH0 suchthat defined(x1[@i_578], x2[@i_578], x3[@i_578], x4[@i_578], x5[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && ((x1_437 = x1[@i_578]) && ((x2_436 = x2[@i_578]) && ((X = x3[@i_578]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_578]) && (K_u_1096 = x5[@i_578]))))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_578]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_432);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_431: host = U in
      let x2_430: host = S in
      find [unique] @i_565 <= qH0 suchthat defined(x1[@i_565], x2[@i_565], x3[@i_565], x4[@i_565], x5[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && ((x1_431 = x1[@i_565]) && ((x2_430 = x2[@i_565]) && ((X = x3[@i_565]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_565]) && (K_u_1096 = x5[@i_565]))))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_565]);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_426);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u_1097: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (K_u_1097 = x15[@i_120]))))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      find [unique] @i_604 <= qH0 suchthat defined(x1[@i_604], x2[@i_604], x3[@i_604], x4[@i_604], x5[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && ((x1_449 = x1[@i_604]) && ((x2_448 = x2[@i_604]) && ((X = x3[@i_604]) && ((Yp[@i_238] = x4[@i_604]) && (K_u_1097 = x5[@i_604]))))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_604]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_444);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_443: host = U in
      let x2_442: host = S in
      find [unique] @i_591 <= qH0 suchthat defined(x1[@i_591], x2[@i_591], x3[@i_591], x4[@i_591], x5[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && ((x1_443 = x1[@i_591]) && ((x2_442 = x2[@i_591]) && ((X = x3[@i_591]) && ((Yp[@i_238] = x4[@i_591]) && (K_u_1097 = x5[@i_591]))))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_591]);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_438);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u_1098: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (K_u_1098 = x15[@i_120]))))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      find [unique] @i_630 <= qH0 suchthat defined(x1[@i_630], x2[@i_630], x3[@i_630], x4[@i_630], x5[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && ((x1_461 = x1[@i_630]) && ((x2_460 = x2[@i_630]) && ((X = x3[@i_630]) && ((Y[@i_236] = x4[@i_630]) && (K_u_1098 = x5[@i_630]))))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_630]);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind  suchthat defined(j[@i_236], r_396[@i_236]) && otheruses(r_396[@i_236]) && (!_41 = j[@i_236]) then
      (
        let sk_u: hash0 = r_396[@i_236] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_396[@i_236]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_456);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_455: host = U in
      let x2_454: host = S in
      find [unique] @i_617 <= qH0 suchthat defined(x1[@i_617], x2[@i_617], x3[@i_617], x4[@i_617], x5[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && ((x1_455 = x1[@i_617]) && ((x2_454 = x2[@i_617]) && ((X = x3[@i_617]) && ((Y[@i_236] = x4[@i_617]) && (K_u_1098 = x5[@i_617]))))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_617]);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_450);
        out(c6[!_41], r1_90)
  )
  else
    new @1_x_925: exponent;
    let @2_r4_172: G = cst_G in
    let Y_u: G = exp(g, @1_x_925) in
    let K_u_1099: G = exp(g, mult(@1_x_925, x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (exp(g, mult(x[j], y)) = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      find [unique] @i_500 <= qH0 suchthat defined(x1[@i_500], x2[@i_500], x3[@i_500], x4[@i_500], x5[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && ((x1_401 = x1[@i_500]) && ((x2_400 = x2[@i_500]) && ((X_s = x3[@i_500]) && ((Y = x4[@i_500]) && (exp(g, mult(x[j], y)) = x5[@i_500]))))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_500])
      )
      orfind  suchthat defined(@i_236[j], r_450[j]) && otheruses(r_450[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      orfind  suchthat defined(@i_236[j], r_456[j]) && otheruses(r_456[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_456[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_456[j])
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_396)
    )
    orfind  suchthat defined(@i_236[j], r1_90[j], K_u_1098[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (exp(g, mult(x[j], y)) = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_x_783[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_x_783[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_783[@i_222]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @1_x_925[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @1_x_925[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_925[@i_217]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_x_783[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_x_783[@i_198]) && ((@2_x = exp(g, @1_x_783[@i_198])) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@1_x_925[@i_193], Ystar_u[@i_193], @2_r4_172[@i_193]) && otheruses(Ystar_u[@i_193] -> @1_x_925[@i_193]) && ((@2_x = exp(g, @1_x_925[@i_193])) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_x_783[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_x_783[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], exp(g, @1_x_783[@i_186]))
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @1_x_925[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @1_x_925[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], exp(g, @1_x_925[@i_181]))
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_x_783: exponent;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], exp(g, @1_x_783))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(x1_395[@i_473], x2_394[@i_473], Xp[@i_473], Yp[@i_473], Kp[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && ((x1 = x1_395[@i_473]) && ((x2 = x2_394[@i_473]) && ((x3 = Xp[@i_473]) && ((x4 = Yp[@i_473]) && (x5 = Kp[@i_473]))))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(y[@i_472], x[j[@i_472]], K_s[@i_472], x1_401[@i_472], x2_400[@i_472], X_s[@i_472], Y[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && ((x1 = x1_401[@i_472]) && ((x2 = x2_400[@i_472]) && ((x3 = X_s[@i_472]) && ((x4 = Y[@i_472]) && (x5 = exp(g, mult(x[j[@i_472]], y[@i_472]))))))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(y[@i_471], x[j[@i_471]], K_s[@i_471], x1_407[@i_471], x2_406[@i_471], X_s[@i_471], Y[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && ((x1 = x1_407[@i_471]) && ((x2 = x2_406[@i_471]) && ((x3 = X_s[@i_471]) && ((x4 = Y[@i_471]) && (x5 = exp(g, mult(x[j[@i_471]], y[@i_471]))))))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(x1_413[@i_470], x2_412[@i_470], X[@i_470], @1_x_925[@i_470], K_u_1099[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && ((x1 = x1_413[@i_470]) && ((x2 = x2_412[@i_470]) && ((x3 = X[@i_470]) && ((x4 = exp(g, @1_x_925[@i_470])) && (x5 = K_u_1099[@i_470]))))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(x1_419[@i_469], x2_418[@i_469], X[@i_469], @1_x_783[@i_246[@i_469]], K_u_1095[@i_469], r_414[@i_469]) && otheruses(r_414[@i_469]) && ((x1 = x1_419[@i_469]) && ((x2 = x2_418[@i_469]) && ((x3 = X[@i_469]) && ((x4 = exp(g, @1_x_783[@i_246[@i_469]])) && (x5 = K_u_1095[@i_469]))))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(x1_425[@i_468], x2_424[@i_468], X[@i_468], @1_x_783[@i_246[@i_468]], K_u_1095[@i_468], r_420[@i_468]) && otheruses(r_420[@i_468]) && ((x1 = x1_425[@i_468]) && ((x2 = x2_424[@i_468]) && ((x3 = X[@i_468]) && ((x4 = exp(g, @1_x_783[@i_246[@i_468]])) && (x5 = K_u_1095[@i_468]))))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(x1_431[@i_467], x2_430[@i_467], X[@i_467], @1_x_925[@i_241[@i_467]], K_u_1096[@i_467], r_426[@i_467]) && otheruses(r_426[@i_467]) && ((x1 = x1_431[@i_467]) && ((x2 = x2_430[@i_467]) && ((x3 = X[@i_467]) && ((x4 = exp(g, @1_x_925[@i_241[@i_467]])) && (x5 = K_u_1096[@i_467]))))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(x1_437[@i_466], x2_436[@i_466], X[@i_466], @1_x_925[@i_241[@i_466]], K_u_1096[@i_466], r_432[@i_466]) && otheruses(r_432[@i_466]) && ((x1 = x1_437[@i_466]) && ((x2 = x2_436[@i_466]) && ((x3 = X[@i_466]) && ((x4 = exp(g, @1_x_925[@i_241[@i_466]])) && (x5 = K_u_1096[@i_466]))))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(x1_443[@i_465], x2_442[@i_465], X[@i_465], Yp[@i_238[@i_465]], K_u_1097[@i_465], r_438[@i_465]) && otheruses(r_438[@i_465]) && ((x1 = x1_443[@i_465]) && ((x2 = x2_442[@i_465]) && ((x3 = X[@i_465]) && ((x4 = Yp[@i_238[@i_465]]) && (x5 = K_u_1097[@i_465]))))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(x1_449[@i_464], x2_448[@i_464], X[@i_464], Yp[@i_238[@i_464]], K_u_1097[@i_464], r_444[@i_464]) && otheruses(r_444[@i_464]) && ((x1 = x1_449[@i_464]) && ((x2 = x2_448[@i_464]) && ((x3 = X[@i_464]) && ((x4 = Yp[@i_238[@i_464]]) && (x5 = K_u_1097[@i_464]))))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(x1_455[@i_463], x2_454[@i_463], X[@i_463], Y[@i_236[@i_463]], K_u_1098[@i_463], r_450[@i_463]) && otheruses(r_450[@i_463]) && ((x1 = x1_455[@i_463]) && ((x2 = x2_454[@i_463]) && ((x3 = X[@i_463]) && ((x4 = Y[@i_236[@i_463]]) && (x5 = K_u_1098[@i_463]))))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(x1_461[@i_462], x2_460[@i_462], X[@i_462], Y[@i_236[@i_462]], K_u_1098[@i_462], r_456[@i_462]) && otheruses(r_456[@i_462]) && ((x1 = x1_461[@i_462]) && ((x2 = x2_460[@i_462]) && ((x3 = X[@i_462]) && ((x4 = Y[@i_236[@i_462]]) && (x5 = K_u_1098[@i_462]))))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1095[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1095[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1096[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1096[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1097[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1097[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1098[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1098[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1099[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1099[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of binder K_u_1099 yields

Game 26 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_x_783[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_x_783[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = exp(g, @1_x_783[@i_246]) in
    let K_u_1095: G = exp(g, mult(@1_x_783[@i_246], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_783[@i_246]) = x14[@i_120]) && (K_u_1095 = x15[@i_120]))))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      find [unique] @i_552 <= qH0 suchthat defined(x1[@i_552], x2[@i_552], x3[@i_552], x4[@i_552], x5[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && ((x1_425 = x1[@i_552]) && ((x2_424 = x2[@i_552]) && ((X = x3[@i_552]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_552]) && (K_u_1095 = x5[@i_552]))))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_552]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_420);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_419: host = U in
      let x2_418: host = S in
      find [unique] @i_539 <= qH0 suchthat defined(x1[@i_539], x2[@i_539], x3[@i_539], x4[@i_539], x5[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && ((x1_419 = x1[@i_539]) && ((x2_418 = x2[@i_539]) && ((X = x3[@i_539]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_539]) && (K_u_1095 = x5[@i_539]))))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_539]);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_414);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @1_x_925[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @1_x_925[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = exp(g, @1_x_925[@i_241]) in
    let K_u_1096: G = exp(g, mult(@1_x_925[@i_241], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_925[@i_241]) = x14[@i_120]) && (K_u_1096 = x15[@i_120]))))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      find [unique] @i_578 <= qH0 suchthat defined(x1[@i_578], x2[@i_578], x3[@i_578], x4[@i_578], x5[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && ((x1_437 = x1[@i_578]) && ((x2_436 = x2[@i_578]) && ((X = x3[@i_578]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_578]) && (K_u_1096 = x5[@i_578]))))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_578]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_432);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_431: host = U in
      let x2_430: host = S in
      find [unique] @i_565 <= qH0 suchthat defined(x1[@i_565], x2[@i_565], x3[@i_565], x4[@i_565], x5[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && ((x1_431 = x1[@i_565]) && ((x2_430 = x2[@i_565]) && ((X = x3[@i_565]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_565]) && (K_u_1096 = x5[@i_565]))))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_565]);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_426);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u_1097: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (K_u_1097 = x15[@i_120]))))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      find [unique] @i_604 <= qH0 suchthat defined(x1[@i_604], x2[@i_604], x3[@i_604], x4[@i_604], x5[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && ((x1_449 = x1[@i_604]) && ((x2_448 = x2[@i_604]) && ((X = x3[@i_604]) && ((Yp[@i_238] = x4[@i_604]) && (K_u_1097 = x5[@i_604]))))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_604]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_444);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_443: host = U in
      let x2_442: host = S in
      find [unique] @i_591 <= qH0 suchthat defined(x1[@i_591], x2[@i_591], x3[@i_591], x4[@i_591], x5[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && ((x1_443 = x1[@i_591]) && ((x2_442 = x2[@i_591]) && ((X = x3[@i_591]) && ((Yp[@i_238] = x4[@i_591]) && (K_u_1097 = x5[@i_591]))))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_591]);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_438);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u_1098: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (K_u_1098 = x15[@i_120]))))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      find [unique] @i_630 <= qH0 suchthat defined(x1[@i_630], x2[@i_630], x3[@i_630], x4[@i_630], x5[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && ((x1_461 = x1[@i_630]) && ((x2_460 = x2[@i_630]) && ((X = x3[@i_630]) && ((Y[@i_236] = x4[@i_630]) && (K_u_1098 = x5[@i_630]))))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_630]);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind  suchthat defined(j[@i_236], r_396[@i_236]) && otheruses(r_396[@i_236]) && (!_41 = j[@i_236]) then
      (
        let sk_u: hash0 = r_396[@i_236] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_396[@i_236]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_456);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_455: host = U in
      let x2_454: host = S in
      find [unique] @i_617 <= qH0 suchthat defined(x1[@i_617], x2[@i_617], x3[@i_617], x4[@i_617], x5[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && ((x1_455 = x1[@i_617]) && ((x2_454 = x2[@i_617]) && ((X = x3[@i_617]) && ((Y[@i_236] = x4[@i_617]) && (K_u_1098 = x5[@i_617]))))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_617]);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_450);
        out(c6[!_41], r1_90)
  )
  else
    new @1_x_925: exponent;
    let @2_r4_172: G = cst_G in
    let Y_u: G = exp(g, @1_x_925) in
    let K_u_1099: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (exp(g, mult(x[j], y)) = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      find [unique] @i_500 <= qH0 suchthat defined(x1[@i_500], x2[@i_500], x3[@i_500], x4[@i_500], x5[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && ((x1_401 = x1[@i_500]) && ((x2_400 = x2[@i_500]) && ((X_s = x3[@i_500]) && ((Y = x4[@i_500]) && (exp(g, mult(x[j], y)) = x5[@i_500]))))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_500])
      )
      orfind  suchthat defined(@i_236[j], r_450[j]) && otheruses(r_450[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      orfind  suchthat defined(@i_236[j], r_456[j]) && otheruses(r_456[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_456[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_456[j])
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_396)
    )
    orfind  suchthat defined(@i_236[j], r1_90[j], K_u_1098[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (exp(g, mult(x[j], y)) = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_x_783[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_x_783[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_783[@i_222]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @1_x_925[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @1_x_925[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_925[@i_217]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_x_783[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_x_783[@i_198]) && ((@2_x = exp(g, @1_x_783[@i_198])) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@1_x_925[@i_193], Ystar_u[@i_193], @2_r4_172[@i_193]) && otheruses(Ystar_u[@i_193] -> @1_x_925[@i_193]) && ((@2_x = exp(g, @1_x_925[@i_193])) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_x_783[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_x_783[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], exp(g, @1_x_783[@i_186]))
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @1_x_925[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @1_x_925[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], exp(g, @1_x_925[@i_181]))
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_x_783: exponent;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], exp(g, @1_x_783))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(x1_395[@i_473], x2_394[@i_473], Xp[@i_473], Yp[@i_473], Kp[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && ((x1 = x1_395[@i_473]) && ((x2 = x2_394[@i_473]) && ((x3 = Xp[@i_473]) && ((x4 = Yp[@i_473]) && (x5 = Kp[@i_473]))))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(y[@i_472], x[j[@i_472]], K_s[@i_472], x1_401[@i_472], x2_400[@i_472], X_s[@i_472], Y[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && ((x1 = x1_401[@i_472]) && ((x2 = x2_400[@i_472]) && ((x3 = X_s[@i_472]) && ((x4 = Y[@i_472]) && (x5 = exp(g, mult(x[j[@i_472]], y[@i_472]))))))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(y[@i_471], x[j[@i_471]], K_s[@i_471], x1_407[@i_471], x2_406[@i_471], X_s[@i_471], Y[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && ((x1 = x1_407[@i_471]) && ((x2 = x2_406[@i_471]) && ((x3 = X_s[@i_471]) && ((x4 = Y[@i_471]) && (x5 = exp(g, mult(x[j[@i_471]], y[@i_471]))))))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(x[@i_470], K_u_1099[@i_470], x1_413[@i_470], x2_412[@i_470], X[@i_470], @1_x_925[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && ((x1 = x1_413[@i_470]) && ((x2 = x2_412[@i_470]) && ((x3 = X[@i_470]) && ((x4 = exp(g, @1_x_925[@i_470])) && (x5 = exp(g, mult(@1_x_925[@i_470], x[@i_470]))))))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(x1_419[@i_469], x2_418[@i_469], X[@i_469], @1_x_783[@i_246[@i_469]], K_u_1095[@i_469], r_414[@i_469]) && otheruses(r_414[@i_469]) && ((x1 = x1_419[@i_469]) && ((x2 = x2_418[@i_469]) && ((x3 = X[@i_469]) && ((x4 = exp(g, @1_x_783[@i_246[@i_469]])) && (x5 = K_u_1095[@i_469]))))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(x1_425[@i_468], x2_424[@i_468], X[@i_468], @1_x_783[@i_246[@i_468]], K_u_1095[@i_468], r_420[@i_468]) && otheruses(r_420[@i_468]) && ((x1 = x1_425[@i_468]) && ((x2 = x2_424[@i_468]) && ((x3 = X[@i_468]) && ((x4 = exp(g, @1_x_783[@i_246[@i_468]])) && (x5 = K_u_1095[@i_468]))))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(x1_431[@i_467], x2_430[@i_467], X[@i_467], @1_x_925[@i_241[@i_467]], K_u_1096[@i_467], r_426[@i_467]) && otheruses(r_426[@i_467]) && ((x1 = x1_431[@i_467]) && ((x2 = x2_430[@i_467]) && ((x3 = X[@i_467]) && ((x4 = exp(g, @1_x_925[@i_241[@i_467]])) && (x5 = K_u_1096[@i_467]))))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(x1_437[@i_466], x2_436[@i_466], X[@i_466], @1_x_925[@i_241[@i_466]], K_u_1096[@i_466], r_432[@i_466]) && otheruses(r_432[@i_466]) && ((x1 = x1_437[@i_466]) && ((x2 = x2_436[@i_466]) && ((x3 = X[@i_466]) && ((x4 = exp(g, @1_x_925[@i_241[@i_466]])) && (x5 = K_u_1096[@i_466]))))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(x1_443[@i_465], x2_442[@i_465], X[@i_465], Yp[@i_238[@i_465]], K_u_1097[@i_465], r_438[@i_465]) && otheruses(r_438[@i_465]) && ((x1 = x1_443[@i_465]) && ((x2 = x2_442[@i_465]) && ((x3 = X[@i_465]) && ((x4 = Yp[@i_238[@i_465]]) && (x5 = K_u_1097[@i_465]))))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(x1_449[@i_464], x2_448[@i_464], X[@i_464], Yp[@i_238[@i_464]], K_u_1097[@i_464], r_444[@i_464]) && otheruses(r_444[@i_464]) && ((x1 = x1_449[@i_464]) && ((x2 = x2_448[@i_464]) && ((x3 = X[@i_464]) && ((x4 = Yp[@i_238[@i_464]]) && (x5 = K_u_1097[@i_464]))))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(x1_455[@i_463], x2_454[@i_463], X[@i_463], Y[@i_236[@i_463]], K_u_1098[@i_463], r_450[@i_463]) && otheruses(r_450[@i_463]) && ((x1 = x1_455[@i_463]) && ((x2 = x2_454[@i_463]) && ((x3 = X[@i_463]) && ((x4 = Y[@i_236[@i_463]]) && (x5 = K_u_1098[@i_463]))))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(x1_461[@i_462], x2_460[@i_462], X[@i_462], Y[@i_236[@i_462]], K_u_1098[@i_462], r_456[@i_462]) && otheruses(r_456[@i_462]) && ((x1 = x1_461[@i_462]) && ((x2 = x2_460[@i_462]) && ((x3 = X[@i_462]) && ((x4 = Y[@i_236[@i_462]]) && (x5 = K_u_1098[@i_462]))))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1095[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1095[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1096[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1096[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1097[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1097[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1098[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1098[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_925[@i_96], K_u_1099[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(@1_x_925[@i_96], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of binder K_u_1095 yields

Game 27 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_x_783[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_x_783[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = exp(g, @1_x_783[@i_246]) in
    let K_u_1095: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_783[@i_246]) = x14[@i_120]) && (exp(g, mult(@1_x_783[@i_246], x)) = x15[@i_120]))))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      find [unique] @i_552 <= qH0 suchthat defined(x1[@i_552], x2[@i_552], x3[@i_552], x4[@i_552], x5[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && ((x1_425 = x1[@i_552]) && ((x2_424 = x2[@i_552]) && ((X = x3[@i_552]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_552]) && (exp(g, mult(@1_x_783[@i_246], x)) = x5[@i_552]))))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_552]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_420);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_419: host = U in
      let x2_418: host = S in
      find [unique] @i_539 <= qH0 suchthat defined(x1[@i_539], x2[@i_539], x3[@i_539], x4[@i_539], x5[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && ((x1_419 = x1[@i_539]) && ((x2_418 = x2[@i_539]) && ((X = x3[@i_539]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_539]) && (exp(g, mult(@1_x_783[@i_246], x)) = x5[@i_539]))))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_539]);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_414);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @1_x_925[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @1_x_925[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = exp(g, @1_x_925[@i_241]) in
    let K_u_1096: G = exp(g, mult(@1_x_925[@i_241], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_925[@i_241]) = x14[@i_120]) && (K_u_1096 = x15[@i_120]))))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      find [unique] @i_578 <= qH0 suchthat defined(x1[@i_578], x2[@i_578], x3[@i_578], x4[@i_578], x5[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && ((x1_437 = x1[@i_578]) && ((x2_436 = x2[@i_578]) && ((X = x3[@i_578]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_578]) && (K_u_1096 = x5[@i_578]))))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_578]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_432);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_431: host = U in
      let x2_430: host = S in
      find [unique] @i_565 <= qH0 suchthat defined(x1[@i_565], x2[@i_565], x3[@i_565], x4[@i_565], x5[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && ((x1_431 = x1[@i_565]) && ((x2_430 = x2[@i_565]) && ((X = x3[@i_565]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_565]) && (K_u_1096 = x5[@i_565]))))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_565]);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_426);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u_1097: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (K_u_1097 = x15[@i_120]))))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      find [unique] @i_604 <= qH0 suchthat defined(x1[@i_604], x2[@i_604], x3[@i_604], x4[@i_604], x5[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && ((x1_449 = x1[@i_604]) && ((x2_448 = x2[@i_604]) && ((X = x3[@i_604]) && ((Yp[@i_238] = x4[@i_604]) && (K_u_1097 = x5[@i_604]))))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_604]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_444);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_443: host = U in
      let x2_442: host = S in
      find [unique] @i_591 <= qH0 suchthat defined(x1[@i_591], x2[@i_591], x3[@i_591], x4[@i_591], x5[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && ((x1_443 = x1[@i_591]) && ((x2_442 = x2[@i_591]) && ((X = x3[@i_591]) && ((Yp[@i_238] = x4[@i_591]) && (K_u_1097 = x5[@i_591]))))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_591]);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_438);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u_1098: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (K_u_1098 = x15[@i_120]))))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      find [unique] @i_630 <= qH0 suchthat defined(x1[@i_630], x2[@i_630], x3[@i_630], x4[@i_630], x5[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && ((x1_461 = x1[@i_630]) && ((x2_460 = x2[@i_630]) && ((X = x3[@i_630]) && ((Y[@i_236] = x4[@i_630]) && (K_u_1098 = x5[@i_630]))))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_630]);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind  suchthat defined(j[@i_236], r_396[@i_236]) && otheruses(r_396[@i_236]) && (!_41 = j[@i_236]) then
      (
        let sk_u: hash0 = r_396[@i_236] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_396[@i_236]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_456);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_455: host = U in
      let x2_454: host = S in
      find [unique] @i_617 <= qH0 suchthat defined(x1[@i_617], x2[@i_617], x3[@i_617], x4[@i_617], x5[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && ((x1_455 = x1[@i_617]) && ((x2_454 = x2[@i_617]) && ((X = x3[@i_617]) && ((Y[@i_236] = x4[@i_617]) && (K_u_1098 = x5[@i_617]))))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_617]);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_450);
        out(c6[!_41], r1_90)
  )
  else
    new @1_x_925: exponent;
    let @2_r4_172: G = cst_G in
    let Y_u: G = exp(g, @1_x_925) in
    let K_u_1099: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (exp(g, mult(x[j], y)) = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      find [unique] @i_500 <= qH0 suchthat defined(x1[@i_500], x2[@i_500], x3[@i_500], x4[@i_500], x5[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && ((x1_401 = x1[@i_500]) && ((x2_400 = x2[@i_500]) && ((X_s = x3[@i_500]) && ((Y = x4[@i_500]) && (exp(g, mult(x[j], y)) = x5[@i_500]))))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_500])
      )
      orfind  suchthat defined(@i_236[j], r_450[j]) && otheruses(r_450[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      orfind  suchthat defined(@i_236[j], r_456[j]) && otheruses(r_456[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_456[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_456[j])
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_396)
    )
    orfind  suchthat defined(@i_236[j], r1_90[j], K_u_1098[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (exp(g, mult(x[j], y)) = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_x_783[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_x_783[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_783[@i_222]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @1_x_925[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @1_x_925[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_925[@i_217]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_x_783[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_x_783[@i_198]) && ((@2_x = exp(g, @1_x_783[@i_198])) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@1_x_925[@i_193], Ystar_u[@i_193], @2_r4_172[@i_193]) && otheruses(Ystar_u[@i_193] -> @1_x_925[@i_193]) && ((@2_x = exp(g, @1_x_925[@i_193])) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_x_783[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_x_783[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], exp(g, @1_x_783[@i_186]))
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @1_x_925[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @1_x_925[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], exp(g, @1_x_925[@i_181]))
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_x_783: exponent;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], exp(g, @1_x_783))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(x1_395[@i_473], x2_394[@i_473], Xp[@i_473], Yp[@i_473], Kp[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && ((x1 = x1_395[@i_473]) && ((x2 = x2_394[@i_473]) && ((x3 = Xp[@i_473]) && ((x4 = Yp[@i_473]) && (x5 = Kp[@i_473]))))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(y[@i_472], x[j[@i_472]], K_s[@i_472], x1_401[@i_472], x2_400[@i_472], X_s[@i_472], Y[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && ((x1 = x1_401[@i_472]) && ((x2 = x2_400[@i_472]) && ((x3 = X_s[@i_472]) && ((x4 = Y[@i_472]) && (x5 = exp(g, mult(x[j[@i_472]], y[@i_472]))))))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(y[@i_471], x[j[@i_471]], K_s[@i_471], x1_407[@i_471], x2_406[@i_471], X_s[@i_471], Y[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && ((x1 = x1_407[@i_471]) && ((x2 = x2_406[@i_471]) && ((x3 = X_s[@i_471]) && ((x4 = Y[@i_471]) && (x5 = exp(g, mult(x[j[@i_471]], y[@i_471]))))))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(x[@i_470], K_u_1099[@i_470], x1_413[@i_470], x2_412[@i_470], X[@i_470], @1_x_925[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && ((x1 = x1_413[@i_470]) && ((x2 = x2_412[@i_470]) && ((x3 = X[@i_470]) && ((x4 = exp(g, @1_x_925[@i_470])) && (x5 = exp(g, mult(@1_x_925[@i_470], x[@i_470]))))))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(x[@i_469], K_u_1095[@i_469], x1_419[@i_469], x2_418[@i_469], X[@i_469], @1_x_783[@i_246[@i_469]], r_414[@i_469]) && otheruses(r_414[@i_469]) && ((x1 = x1_419[@i_469]) && ((x2 = x2_418[@i_469]) && ((x3 = X[@i_469]) && ((x4 = exp(g, @1_x_783[@i_246[@i_469]])) && (x5 = exp(g, mult(@1_x_783[@i_246[@i_469]], x[@i_469]))))))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(x[@i_468], K_u_1095[@i_468], x1_425[@i_468], x2_424[@i_468], X[@i_468], @1_x_783[@i_246[@i_468]], r_420[@i_468]) && otheruses(r_420[@i_468]) && ((x1 = x1_425[@i_468]) && ((x2 = x2_424[@i_468]) && ((x3 = X[@i_468]) && ((x4 = exp(g, @1_x_783[@i_246[@i_468]])) && (x5 = exp(g, mult(@1_x_783[@i_246[@i_468]], x[@i_468]))))))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(x1_431[@i_467], x2_430[@i_467], X[@i_467], @1_x_925[@i_241[@i_467]], K_u_1096[@i_467], r_426[@i_467]) && otheruses(r_426[@i_467]) && ((x1 = x1_431[@i_467]) && ((x2 = x2_430[@i_467]) && ((x3 = X[@i_467]) && ((x4 = exp(g, @1_x_925[@i_241[@i_467]])) && (x5 = K_u_1096[@i_467]))))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(x1_437[@i_466], x2_436[@i_466], X[@i_466], @1_x_925[@i_241[@i_466]], K_u_1096[@i_466], r_432[@i_466]) && otheruses(r_432[@i_466]) && ((x1 = x1_437[@i_466]) && ((x2 = x2_436[@i_466]) && ((x3 = X[@i_466]) && ((x4 = exp(g, @1_x_925[@i_241[@i_466]])) && (x5 = K_u_1096[@i_466]))))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(x1_443[@i_465], x2_442[@i_465], X[@i_465], Yp[@i_238[@i_465]], K_u_1097[@i_465], r_438[@i_465]) && otheruses(r_438[@i_465]) && ((x1 = x1_443[@i_465]) && ((x2 = x2_442[@i_465]) && ((x3 = X[@i_465]) && ((x4 = Yp[@i_238[@i_465]]) && (x5 = K_u_1097[@i_465]))))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(x1_449[@i_464], x2_448[@i_464], X[@i_464], Yp[@i_238[@i_464]], K_u_1097[@i_464], r_444[@i_464]) && otheruses(r_444[@i_464]) && ((x1 = x1_449[@i_464]) && ((x2 = x2_448[@i_464]) && ((x3 = X[@i_464]) && ((x4 = Yp[@i_238[@i_464]]) && (x5 = K_u_1097[@i_464]))))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(x1_455[@i_463], x2_454[@i_463], X[@i_463], Y[@i_236[@i_463]], K_u_1098[@i_463], r_450[@i_463]) && otheruses(r_450[@i_463]) && ((x1 = x1_455[@i_463]) && ((x2 = x2_454[@i_463]) && ((x3 = X[@i_463]) && ((x4 = Y[@i_236[@i_463]]) && (x5 = K_u_1098[@i_463]))))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(x1_461[@i_462], x2_460[@i_462], X[@i_462], Y[@i_236[@i_462]], K_u_1098[@i_462], r_456[@i_462]) && otheruses(r_456[@i_462]) && ((x1 = x1_461[@i_462]) && ((x2 = x2_460[@i_462]) && ((x3 = X[@i_462]) && ((x4 = Y[@i_236[@i_462]]) && (x5 = K_u_1098[@i_462]))))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_783[@i_246[@i_96]], K_u_1095[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(@1_x_783[@i_246[@i_96]], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1096[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1096[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1097[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1097[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1098[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1098[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_925[@i_96], K_u_1099[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(@1_x_925[@i_96], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of binder K_u_1096 yields

Game 28 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_x_783[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_x_783[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = exp(g, @1_x_783[@i_246]) in
    let K_u_1095: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_783[@i_246]) = x14[@i_120]) && (exp(g, mult(@1_x_783[@i_246], x)) = x15[@i_120]))))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      find [unique] @i_552 <= qH0 suchthat defined(x1[@i_552], x2[@i_552], x3[@i_552], x4[@i_552], x5[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && ((x1_425 = x1[@i_552]) && ((x2_424 = x2[@i_552]) && ((X = x3[@i_552]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_552]) && (exp(g, mult(@1_x_783[@i_246], x)) = x5[@i_552]))))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_552]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_420);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_419: host = U in
      let x2_418: host = S in
      find [unique] @i_539 <= qH0 suchthat defined(x1[@i_539], x2[@i_539], x3[@i_539], x4[@i_539], x5[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && ((x1_419 = x1[@i_539]) && ((x2_418 = x2[@i_539]) && ((X = x3[@i_539]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_539]) && (exp(g, mult(@1_x_783[@i_246], x)) = x5[@i_539]))))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_539]);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_414);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @1_x_925[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @1_x_925[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = exp(g, @1_x_925[@i_241]) in
    let K_u_1096: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_925[@i_241]) = x14[@i_120]) && (exp(g, mult(@1_x_925[@i_241], x)) = x15[@i_120]))))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      find [unique] @i_578 <= qH0 suchthat defined(x1[@i_578], x2[@i_578], x3[@i_578], x4[@i_578], x5[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && ((x1_437 = x1[@i_578]) && ((x2_436 = x2[@i_578]) && ((X = x3[@i_578]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_578]) && (exp(g, mult(@1_x_925[@i_241], x)) = x5[@i_578]))))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_578]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_432);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_431: host = U in
      let x2_430: host = S in
      find [unique] @i_565 <= qH0 suchthat defined(x1[@i_565], x2[@i_565], x3[@i_565], x4[@i_565], x5[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && ((x1_431 = x1[@i_565]) && ((x2_430 = x2[@i_565]) && ((X = x3[@i_565]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_565]) && (exp(g, mult(@1_x_925[@i_241], x)) = x5[@i_565]))))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_565]);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_426);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u_1097: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (K_u_1097 = x15[@i_120]))))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      find [unique] @i_604 <= qH0 suchthat defined(x1[@i_604], x2[@i_604], x3[@i_604], x4[@i_604], x5[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && ((x1_449 = x1[@i_604]) && ((x2_448 = x2[@i_604]) && ((X = x3[@i_604]) && ((Yp[@i_238] = x4[@i_604]) && (K_u_1097 = x5[@i_604]))))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_604]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_444);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_443: host = U in
      let x2_442: host = S in
      find [unique] @i_591 <= qH0 suchthat defined(x1[@i_591], x2[@i_591], x3[@i_591], x4[@i_591], x5[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && ((x1_443 = x1[@i_591]) && ((x2_442 = x2[@i_591]) && ((X = x3[@i_591]) && ((Yp[@i_238] = x4[@i_591]) && (K_u_1097 = x5[@i_591]))))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_591]);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_438);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u_1098: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (K_u_1098 = x15[@i_120]))))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      find [unique] @i_630 <= qH0 suchthat defined(x1[@i_630], x2[@i_630], x3[@i_630], x4[@i_630], x5[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && ((x1_461 = x1[@i_630]) && ((x2_460 = x2[@i_630]) && ((X = x3[@i_630]) && ((Y[@i_236] = x4[@i_630]) && (K_u_1098 = x5[@i_630]))))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_630]);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind  suchthat defined(j[@i_236], r_396[@i_236]) && otheruses(r_396[@i_236]) && (!_41 = j[@i_236]) then
      (
        let sk_u: hash0 = r_396[@i_236] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_396[@i_236]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_456);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_455: host = U in
      let x2_454: host = S in
      find [unique] @i_617 <= qH0 suchthat defined(x1[@i_617], x2[@i_617], x3[@i_617], x4[@i_617], x5[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && ((x1_455 = x1[@i_617]) && ((x2_454 = x2[@i_617]) && ((X = x3[@i_617]) && ((Y[@i_236] = x4[@i_617]) && (K_u_1098 = x5[@i_617]))))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_617]);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_450);
        out(c6[!_41], r1_90)
  )
  else
    new @1_x_925: exponent;
    let @2_r4_172: G = cst_G in
    let Y_u: G = exp(g, @1_x_925) in
    let K_u_1099: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (exp(g, mult(x[j], y)) = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      find [unique] @i_500 <= qH0 suchthat defined(x1[@i_500], x2[@i_500], x3[@i_500], x4[@i_500], x5[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && ((x1_401 = x1[@i_500]) && ((x2_400 = x2[@i_500]) && ((X_s = x3[@i_500]) && ((Y = x4[@i_500]) && (exp(g, mult(x[j], y)) = x5[@i_500]))))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_500])
      )
      orfind  suchthat defined(@i_236[j], r_450[j]) && otheruses(r_450[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      orfind  suchthat defined(@i_236[j], r_456[j]) && otheruses(r_456[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_456[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_456[j])
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_396)
    )
    orfind  suchthat defined(@i_236[j], r1_90[j], K_u_1098[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (exp(g, mult(x[j], y)) = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_x_783[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_x_783[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_783[@i_222]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @1_x_925[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @1_x_925[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_925[@i_217]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_x_783[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_x_783[@i_198]) && ((@2_x = exp(g, @1_x_783[@i_198])) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@1_x_925[@i_193], Ystar_u[@i_193], @2_r4_172[@i_193]) && otheruses(Ystar_u[@i_193] -> @1_x_925[@i_193]) && ((@2_x = exp(g, @1_x_925[@i_193])) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_x_783[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_x_783[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], exp(g, @1_x_783[@i_186]))
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @1_x_925[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @1_x_925[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], exp(g, @1_x_925[@i_181]))
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_x_783: exponent;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], exp(g, @1_x_783))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(x1_395[@i_473], x2_394[@i_473], Xp[@i_473], Yp[@i_473], Kp[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && ((x1 = x1_395[@i_473]) && ((x2 = x2_394[@i_473]) && ((x3 = Xp[@i_473]) && ((x4 = Yp[@i_473]) && (x5 = Kp[@i_473]))))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(y[@i_472], x[j[@i_472]], K_s[@i_472], x1_401[@i_472], x2_400[@i_472], X_s[@i_472], Y[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && ((x1 = x1_401[@i_472]) && ((x2 = x2_400[@i_472]) && ((x3 = X_s[@i_472]) && ((x4 = Y[@i_472]) && (x5 = exp(g, mult(x[j[@i_472]], y[@i_472]))))))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(y[@i_471], x[j[@i_471]], K_s[@i_471], x1_407[@i_471], x2_406[@i_471], X_s[@i_471], Y[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && ((x1 = x1_407[@i_471]) && ((x2 = x2_406[@i_471]) && ((x3 = X_s[@i_471]) && ((x4 = Y[@i_471]) && (x5 = exp(g, mult(x[j[@i_471]], y[@i_471]))))))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(x[@i_470], K_u_1099[@i_470], x1_413[@i_470], x2_412[@i_470], X[@i_470], @1_x_925[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && ((x1 = x1_413[@i_470]) && ((x2 = x2_412[@i_470]) && ((x3 = X[@i_470]) && ((x4 = exp(g, @1_x_925[@i_470])) && (x5 = exp(g, mult(@1_x_925[@i_470], x[@i_470]))))))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(x[@i_469], K_u_1095[@i_469], x1_419[@i_469], x2_418[@i_469], X[@i_469], @1_x_783[@i_246[@i_469]], r_414[@i_469]) && otheruses(r_414[@i_469]) && ((x1 = x1_419[@i_469]) && ((x2 = x2_418[@i_469]) && ((x3 = X[@i_469]) && ((x4 = exp(g, @1_x_783[@i_246[@i_469]])) && (x5 = exp(g, mult(@1_x_783[@i_246[@i_469]], x[@i_469]))))))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(x[@i_468], K_u_1095[@i_468], x1_425[@i_468], x2_424[@i_468], X[@i_468], @1_x_783[@i_246[@i_468]], r_420[@i_468]) && otheruses(r_420[@i_468]) && ((x1 = x1_425[@i_468]) && ((x2 = x2_424[@i_468]) && ((x3 = X[@i_468]) && ((x4 = exp(g, @1_x_783[@i_246[@i_468]])) && (x5 = exp(g, mult(@1_x_783[@i_246[@i_468]], x[@i_468]))))))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(x[@i_467], K_u_1096[@i_467], x1_431[@i_467], x2_430[@i_467], X[@i_467], @1_x_925[@i_241[@i_467]], r_426[@i_467]) && otheruses(r_426[@i_467]) && ((x1 = x1_431[@i_467]) && ((x2 = x2_430[@i_467]) && ((x3 = X[@i_467]) && ((x4 = exp(g, @1_x_925[@i_241[@i_467]])) && (x5 = exp(g, mult(@1_x_925[@i_241[@i_467]], x[@i_467]))))))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(x[@i_466], K_u_1096[@i_466], x1_437[@i_466], x2_436[@i_466], X[@i_466], @1_x_925[@i_241[@i_466]], r_432[@i_466]) && otheruses(r_432[@i_466]) && ((x1 = x1_437[@i_466]) && ((x2 = x2_436[@i_466]) && ((x3 = X[@i_466]) && ((x4 = exp(g, @1_x_925[@i_241[@i_466]])) && (x5 = exp(g, mult(@1_x_925[@i_241[@i_466]], x[@i_466]))))))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(x1_443[@i_465], x2_442[@i_465], X[@i_465], Yp[@i_238[@i_465]], K_u_1097[@i_465], r_438[@i_465]) && otheruses(r_438[@i_465]) && ((x1 = x1_443[@i_465]) && ((x2 = x2_442[@i_465]) && ((x3 = X[@i_465]) && ((x4 = Yp[@i_238[@i_465]]) && (x5 = K_u_1097[@i_465]))))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(x1_449[@i_464], x2_448[@i_464], X[@i_464], Yp[@i_238[@i_464]], K_u_1097[@i_464], r_444[@i_464]) && otheruses(r_444[@i_464]) && ((x1 = x1_449[@i_464]) && ((x2 = x2_448[@i_464]) && ((x3 = X[@i_464]) && ((x4 = Yp[@i_238[@i_464]]) && (x5 = K_u_1097[@i_464]))))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(x1_455[@i_463], x2_454[@i_463], X[@i_463], Y[@i_236[@i_463]], K_u_1098[@i_463], r_450[@i_463]) && otheruses(r_450[@i_463]) && ((x1 = x1_455[@i_463]) && ((x2 = x2_454[@i_463]) && ((x3 = X[@i_463]) && ((x4 = Y[@i_236[@i_463]]) && (x5 = K_u_1098[@i_463]))))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(x1_461[@i_462], x2_460[@i_462], X[@i_462], Y[@i_236[@i_462]], K_u_1098[@i_462], r_456[@i_462]) && otheruses(r_456[@i_462]) && ((x1 = x1_461[@i_462]) && ((x2 = x2_460[@i_462]) && ((x3 = X[@i_462]) && ((x4 = Y[@i_236[@i_462]]) && (x5 = K_u_1098[@i_462]))))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_783[@i_246[@i_96]], K_u_1095[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(@1_x_783[@i_246[@i_96]], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_925[@i_241[@i_96]], K_u_1096[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(@1_x_925[@i_241[@i_96]], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1097[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1097[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1098[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1098[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_925[@i_96], K_u_1099[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(@1_x_925[@i_96], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of binder K_u_1097 yields

Game 29 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_x_783[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_x_783[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = exp(g, @1_x_783[@i_246]) in
    let K_u_1095: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_783[@i_246]) = x14[@i_120]) && (exp(g, mult(@1_x_783[@i_246], x)) = x15[@i_120]))))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      find [unique] @i_552 <= qH0 suchthat defined(x1[@i_552], x2[@i_552], x3[@i_552], x4[@i_552], x5[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && ((x1_425 = x1[@i_552]) && ((x2_424 = x2[@i_552]) && ((X = x3[@i_552]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_552]) && (exp(g, mult(@1_x_783[@i_246], x)) = x5[@i_552]))))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_552]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_420);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_419: host = U in
      let x2_418: host = S in
      find [unique] @i_539 <= qH0 suchthat defined(x1[@i_539], x2[@i_539], x3[@i_539], x4[@i_539], x5[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && ((x1_419 = x1[@i_539]) && ((x2_418 = x2[@i_539]) && ((X = x3[@i_539]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_539]) && (exp(g, mult(@1_x_783[@i_246], x)) = x5[@i_539]))))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_539]);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_414);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @1_x_925[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @1_x_925[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = exp(g, @1_x_925[@i_241]) in
    let K_u_1096: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_925[@i_241]) = x14[@i_120]) && (exp(g, mult(@1_x_925[@i_241], x)) = x15[@i_120]))))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      find [unique] @i_578 <= qH0 suchthat defined(x1[@i_578], x2[@i_578], x3[@i_578], x4[@i_578], x5[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && ((x1_437 = x1[@i_578]) && ((x2_436 = x2[@i_578]) && ((X = x3[@i_578]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_578]) && (exp(g, mult(@1_x_925[@i_241], x)) = x5[@i_578]))))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_578]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_432);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_431: host = U in
      let x2_430: host = S in
      find [unique] @i_565 <= qH0 suchthat defined(x1[@i_565], x2[@i_565], x3[@i_565], x4[@i_565], x5[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && ((x1_431 = x1[@i_565]) && ((x2_430 = x2[@i_565]) && ((X = x3[@i_565]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_565]) && (exp(g, mult(@1_x_925[@i_241], x)) = x5[@i_565]))))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_565]);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_426);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u_1097: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (exp(g, mult(yp[@i_238], x)) = x15[@i_120]))))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      find [unique] @i_604 <= qH0 suchthat defined(x1[@i_604], x2[@i_604], x3[@i_604], x4[@i_604], x5[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && ((x1_449 = x1[@i_604]) && ((x2_448 = x2[@i_604]) && ((X = x3[@i_604]) && ((Yp[@i_238] = x4[@i_604]) && (exp(g, mult(yp[@i_238], x)) = x5[@i_604]))))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_604]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_444);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_443: host = U in
      let x2_442: host = S in
      find [unique] @i_591 <= qH0 suchthat defined(x1[@i_591], x2[@i_591], x3[@i_591], x4[@i_591], x5[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && ((x1_443 = x1[@i_591]) && ((x2_442 = x2[@i_591]) && ((X = x3[@i_591]) && ((Yp[@i_238] = x4[@i_591]) && (exp(g, mult(yp[@i_238], x)) = x5[@i_591]))))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_591]);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_438);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u_1098: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (K_u_1098 = x15[@i_120]))))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      find [unique] @i_630 <= qH0 suchthat defined(x1[@i_630], x2[@i_630], x3[@i_630], x4[@i_630], x5[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && ((x1_461 = x1[@i_630]) && ((x2_460 = x2[@i_630]) && ((X = x3[@i_630]) && ((Y[@i_236] = x4[@i_630]) && (K_u_1098 = x5[@i_630]))))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_630]);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind  suchthat defined(j[@i_236], r_396[@i_236]) && otheruses(r_396[@i_236]) && (!_41 = j[@i_236]) then
      (
        let sk_u: hash0 = r_396[@i_236] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_396[@i_236]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_456);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_455: host = U in
      let x2_454: host = S in
      find [unique] @i_617 <= qH0 suchthat defined(x1[@i_617], x2[@i_617], x3[@i_617], x4[@i_617], x5[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && ((x1_455 = x1[@i_617]) && ((x2_454 = x2[@i_617]) && ((X = x3[@i_617]) && ((Y[@i_236] = x4[@i_617]) && (K_u_1098 = x5[@i_617]))))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_617]);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_450);
        out(c6[!_41], r1_90)
  )
  else
    new @1_x_925: exponent;
    let @2_r4_172: G = cst_G in
    let Y_u: G = exp(g, @1_x_925) in
    let K_u_1099: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (exp(g, mult(x[j], y)) = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      find [unique] @i_500 <= qH0 suchthat defined(x1[@i_500], x2[@i_500], x3[@i_500], x4[@i_500], x5[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && ((x1_401 = x1[@i_500]) && ((x2_400 = x2[@i_500]) && ((X_s = x3[@i_500]) && ((Y = x4[@i_500]) && (exp(g, mult(x[j], y)) = x5[@i_500]))))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_500])
      )
      orfind  suchthat defined(@i_236[j], r_450[j]) && otheruses(r_450[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      orfind  suchthat defined(@i_236[j], r_456[j]) && otheruses(r_456[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_456[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_456[j])
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_396)
    )
    orfind  suchthat defined(@i_236[j], r1_90[j], K_u_1098[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (exp(g, mult(x[j], y)) = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_x_783[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_x_783[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_783[@i_222]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @1_x_925[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @1_x_925[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_925[@i_217]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_x_783[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_x_783[@i_198]) && ((@2_x = exp(g, @1_x_783[@i_198])) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@1_x_925[@i_193], Ystar_u[@i_193], @2_r4_172[@i_193]) && otheruses(Ystar_u[@i_193] -> @1_x_925[@i_193]) && ((@2_x = exp(g, @1_x_925[@i_193])) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_x_783[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_x_783[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], exp(g, @1_x_783[@i_186]))
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @1_x_925[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @1_x_925[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], exp(g, @1_x_925[@i_181]))
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_x_783: exponent;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], exp(g, @1_x_783))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(x1_395[@i_473], x2_394[@i_473], Xp[@i_473], Yp[@i_473], Kp[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && ((x1 = x1_395[@i_473]) && ((x2 = x2_394[@i_473]) && ((x3 = Xp[@i_473]) && ((x4 = Yp[@i_473]) && (x5 = Kp[@i_473]))))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(y[@i_472], x[j[@i_472]], K_s[@i_472], x1_401[@i_472], x2_400[@i_472], X_s[@i_472], Y[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && ((x1 = x1_401[@i_472]) && ((x2 = x2_400[@i_472]) && ((x3 = X_s[@i_472]) && ((x4 = Y[@i_472]) && (x5 = exp(g, mult(x[j[@i_472]], y[@i_472]))))))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(y[@i_471], x[j[@i_471]], K_s[@i_471], x1_407[@i_471], x2_406[@i_471], X_s[@i_471], Y[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && ((x1 = x1_407[@i_471]) && ((x2 = x2_406[@i_471]) && ((x3 = X_s[@i_471]) && ((x4 = Y[@i_471]) && (x5 = exp(g, mult(x[j[@i_471]], y[@i_471]))))))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(x[@i_470], K_u_1099[@i_470], x1_413[@i_470], x2_412[@i_470], X[@i_470], @1_x_925[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && ((x1 = x1_413[@i_470]) && ((x2 = x2_412[@i_470]) && ((x3 = X[@i_470]) && ((x4 = exp(g, @1_x_925[@i_470])) && (x5 = exp(g, mult(@1_x_925[@i_470], x[@i_470]))))))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(x[@i_469], K_u_1095[@i_469], x1_419[@i_469], x2_418[@i_469], X[@i_469], @1_x_783[@i_246[@i_469]], r_414[@i_469]) && otheruses(r_414[@i_469]) && ((x1 = x1_419[@i_469]) && ((x2 = x2_418[@i_469]) && ((x3 = X[@i_469]) && ((x4 = exp(g, @1_x_783[@i_246[@i_469]])) && (x5 = exp(g, mult(@1_x_783[@i_246[@i_469]], x[@i_469]))))))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(x[@i_468], K_u_1095[@i_468], x1_425[@i_468], x2_424[@i_468], X[@i_468], @1_x_783[@i_246[@i_468]], r_420[@i_468]) && otheruses(r_420[@i_468]) && ((x1 = x1_425[@i_468]) && ((x2 = x2_424[@i_468]) && ((x3 = X[@i_468]) && ((x4 = exp(g, @1_x_783[@i_246[@i_468]])) && (x5 = exp(g, mult(@1_x_783[@i_246[@i_468]], x[@i_468]))))))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(x[@i_467], K_u_1096[@i_467], x1_431[@i_467], x2_430[@i_467], X[@i_467], @1_x_925[@i_241[@i_467]], r_426[@i_467]) && otheruses(r_426[@i_467]) && ((x1 = x1_431[@i_467]) && ((x2 = x2_430[@i_467]) && ((x3 = X[@i_467]) && ((x4 = exp(g, @1_x_925[@i_241[@i_467]])) && (x5 = exp(g, mult(@1_x_925[@i_241[@i_467]], x[@i_467]))))))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(x[@i_466], K_u_1096[@i_466], x1_437[@i_466], x2_436[@i_466], X[@i_466], @1_x_925[@i_241[@i_466]], r_432[@i_466]) && otheruses(r_432[@i_466]) && ((x1 = x1_437[@i_466]) && ((x2 = x2_436[@i_466]) && ((x3 = X[@i_466]) && ((x4 = exp(g, @1_x_925[@i_241[@i_466]])) && (x5 = exp(g, mult(@1_x_925[@i_241[@i_466]], x[@i_466]))))))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(x[@i_465], yp[@i_238[@i_465]], K_u_1097[@i_465], x1_443[@i_465], x2_442[@i_465], X[@i_465], Yp[@i_238[@i_465]], r_438[@i_465]) && otheruses(r_438[@i_465]) && ((x1 = x1_443[@i_465]) && ((x2 = x2_442[@i_465]) && ((x3 = X[@i_465]) && ((x4 = Yp[@i_238[@i_465]]) && (x5 = exp(g, mult(yp[@i_238[@i_465]], x[@i_465]))))))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(x[@i_464], yp[@i_238[@i_464]], K_u_1097[@i_464], x1_449[@i_464], x2_448[@i_464], X[@i_464], Yp[@i_238[@i_464]], r_444[@i_464]) && otheruses(r_444[@i_464]) && ((x1 = x1_449[@i_464]) && ((x2 = x2_448[@i_464]) && ((x3 = X[@i_464]) && ((x4 = Yp[@i_238[@i_464]]) && (x5 = exp(g, mult(yp[@i_238[@i_464]], x[@i_464]))))))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(x1_455[@i_463], x2_454[@i_463], X[@i_463], Y[@i_236[@i_463]], K_u_1098[@i_463], r_450[@i_463]) && otheruses(r_450[@i_463]) && ((x1 = x1_455[@i_463]) && ((x2 = x2_454[@i_463]) && ((x3 = X[@i_463]) && ((x4 = Y[@i_236[@i_463]]) && (x5 = K_u_1098[@i_463]))))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(x1_461[@i_462], x2_460[@i_462], X[@i_462], Y[@i_236[@i_462]], K_u_1098[@i_462], r_456[@i_462]) && otheruses(r_456[@i_462]) && ((x1 = x1_461[@i_462]) && ((x2 = x2_460[@i_462]) && ((x3 = X[@i_462]) && ((x4 = Y[@i_236[@i_462]]) && (x5 = K_u_1098[@i_462]))))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_783[@i_246[@i_96]], K_u_1095[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(@1_x_783[@i_246[@i_96]], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_925[@i_241[@i_96]], K_u_1096[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(@1_x_925[@i_241[@i_96]], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], yp[@i_238[@i_96]], K_u_1097[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(yp[@i_238[@i_96]], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1098[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1098[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_925[@i_96], K_u_1099[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(@1_x_925[@i_96], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of binder K_u_1098 yields

Game 30 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_x_783[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_x_783[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = exp(g, @1_x_783[@i_246]) in
    let K_u_1095: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_783[@i_246]) = x14[@i_120]) && (exp(g, mult(@1_x_783[@i_246], x)) = x15[@i_120]))))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      find [unique] @i_552 <= qH0 suchthat defined(x1[@i_552], x2[@i_552], x3[@i_552], x4[@i_552], x5[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && ((x1_425 = x1[@i_552]) && ((x2_424 = x2[@i_552]) && ((X = x3[@i_552]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_552]) && (exp(g, mult(@1_x_783[@i_246], x)) = x5[@i_552]))))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_552]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_420);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_419: host = U in
      let x2_418: host = S in
      find [unique] @i_539 <= qH0 suchthat defined(x1[@i_539], x2[@i_539], x3[@i_539], x4[@i_539], x5[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && ((x1_419 = x1[@i_539]) && ((x2_418 = x2[@i_539]) && ((X = x3[@i_539]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_539]) && (exp(g, mult(@1_x_783[@i_246], x)) = x5[@i_539]))))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_539]);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_414);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @1_x_925[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @1_x_925[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = exp(g, @1_x_925[@i_241]) in
    let K_u_1096: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_925[@i_241]) = x14[@i_120]) && (exp(g, mult(@1_x_925[@i_241], x)) = x15[@i_120]))))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      find [unique] @i_578 <= qH0 suchthat defined(x1[@i_578], x2[@i_578], x3[@i_578], x4[@i_578], x5[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && ((x1_437 = x1[@i_578]) && ((x2_436 = x2[@i_578]) && ((X = x3[@i_578]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_578]) && (exp(g, mult(@1_x_925[@i_241], x)) = x5[@i_578]))))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_578]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_432);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_431: host = U in
      let x2_430: host = S in
      find [unique] @i_565 <= qH0 suchthat defined(x1[@i_565], x2[@i_565], x3[@i_565], x4[@i_565], x5[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && ((x1_431 = x1[@i_565]) && ((x2_430 = x2[@i_565]) && ((X = x3[@i_565]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_565]) && (exp(g, mult(@1_x_925[@i_241], x)) = x5[@i_565]))))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_565]);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_426);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u_1097: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (exp(g, mult(yp[@i_238], x)) = x15[@i_120]))))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      find [unique] @i_604 <= qH0 suchthat defined(x1[@i_604], x2[@i_604], x3[@i_604], x4[@i_604], x5[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && ((x1_449 = x1[@i_604]) && ((x2_448 = x2[@i_604]) && ((X = x3[@i_604]) && ((Yp[@i_238] = x4[@i_604]) && (exp(g, mult(yp[@i_238], x)) = x5[@i_604]))))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_604]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_444);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_443: host = U in
      let x2_442: host = S in
      find [unique] @i_591 <= qH0 suchthat defined(x1[@i_591], x2[@i_591], x3[@i_591], x4[@i_591], x5[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && ((x1_443 = x1[@i_591]) && ((x2_442 = x2[@i_591]) && ((X = x3[@i_591]) && ((Yp[@i_238] = x4[@i_591]) && (exp(g, mult(yp[@i_238], x)) = x5[@i_591]))))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_591]);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_438);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u_1098: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (exp(g, mult(y[@i_236], x)) = x15[@i_120]))))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      find [unique] @i_630 <= qH0 suchthat defined(x1[@i_630], x2[@i_630], x3[@i_630], x4[@i_630], x5[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && ((x1_461 = x1[@i_630]) && ((x2_460 = x2[@i_630]) && ((X = x3[@i_630]) && ((Y[@i_236] = x4[@i_630]) && (exp(g, mult(y[@i_236], x)) = x5[@i_630]))))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_630]);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind  suchthat defined(j[@i_236], r_396[@i_236]) && otheruses(r_396[@i_236]) && (!_41 = j[@i_236]) then
      (
        let sk_u: hash0 = r_396[@i_236] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_396[@i_236]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_456);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_455: host = U in
      let x2_454: host = S in
      find [unique] @i_617 <= qH0 suchthat defined(x1[@i_617], x2[@i_617], x3[@i_617], x4[@i_617], x5[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && ((x1_455 = x1[@i_617]) && ((x2_454 = x2[@i_617]) && ((X = x3[@i_617]) && ((Y[@i_236] = x4[@i_617]) && (exp(g, mult(y[@i_236], x)) = x5[@i_617]))))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_617]);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_450);
        out(c6[!_41], r1_90)
  )
  else
    new @1_x_925: exponent;
    let @2_r4_172: G = cst_G in
    let Y_u: G = exp(g, @1_x_925) in
    let K_u_1099: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (exp(g, mult(x[j], y)) = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      find [unique] @i_500 <= qH0 suchthat defined(x1[@i_500], x2[@i_500], x3[@i_500], x4[@i_500], x5[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && ((x1_401 = x1[@i_500]) && ((x2_400 = x2[@i_500]) && ((X_s = x3[@i_500]) && ((Y = x4[@i_500]) && (exp(g, mult(x[j], y)) = x5[@i_500]))))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_500])
      )
      orfind  suchthat defined(@i_236[j], r_450[j]) && otheruses(r_450[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      orfind  suchthat defined(@i_236[j], r_456[j]) && otheruses(r_456[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_456[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_456[j])
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_396)
    )
    orfind  suchthat defined(x[j], y[@i_236[j]], K_u_1098[j], @i_236[j], r1_90[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (exp(g, mult(x[j], y)) = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_x_783[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_x_783[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_783[@i_222]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @1_x_925[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @1_x_925[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_925[@i_217]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_x_783[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_x_783[@i_198]) && ((@2_x = exp(g, @1_x_783[@i_198])) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@1_x_925[@i_193], Ystar_u[@i_193], @2_r4_172[@i_193]) && otheruses(Ystar_u[@i_193] -> @1_x_925[@i_193]) && ((@2_x = exp(g, @1_x_925[@i_193])) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_x_783[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_x_783[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], exp(g, @1_x_783[@i_186]))
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @1_x_925[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @1_x_925[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], exp(g, @1_x_925[@i_181]))
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_x_783: exponent;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], exp(g, @1_x_783))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(x1_395[@i_473], x2_394[@i_473], Xp[@i_473], Yp[@i_473], Kp[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && ((x1 = x1_395[@i_473]) && ((x2 = x2_394[@i_473]) && ((x3 = Xp[@i_473]) && ((x4 = Yp[@i_473]) && (x5 = Kp[@i_473]))))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(y[@i_472], x[j[@i_472]], K_s[@i_472], x1_401[@i_472], x2_400[@i_472], X_s[@i_472], Y[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && ((x1 = x1_401[@i_472]) && ((x2 = x2_400[@i_472]) && ((x3 = X_s[@i_472]) && ((x4 = Y[@i_472]) && (x5 = exp(g, mult(x[j[@i_472]], y[@i_472]))))))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(y[@i_471], x[j[@i_471]], K_s[@i_471], x1_407[@i_471], x2_406[@i_471], X_s[@i_471], Y[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && ((x1 = x1_407[@i_471]) && ((x2 = x2_406[@i_471]) && ((x3 = X_s[@i_471]) && ((x4 = Y[@i_471]) && (x5 = exp(g, mult(x[j[@i_471]], y[@i_471]))))))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(x[@i_470], K_u_1099[@i_470], x1_413[@i_470], x2_412[@i_470], X[@i_470], @1_x_925[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && ((x1 = x1_413[@i_470]) && ((x2 = x2_412[@i_470]) && ((x3 = X[@i_470]) && ((x4 = exp(g, @1_x_925[@i_470])) && (x5 = exp(g, mult(@1_x_925[@i_470], x[@i_470]))))))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(x[@i_469], K_u_1095[@i_469], x1_419[@i_469], x2_418[@i_469], X[@i_469], @1_x_783[@i_246[@i_469]], r_414[@i_469]) && otheruses(r_414[@i_469]) && ((x1 = x1_419[@i_469]) && ((x2 = x2_418[@i_469]) && ((x3 = X[@i_469]) && ((x4 = exp(g, @1_x_783[@i_246[@i_469]])) && (x5 = exp(g, mult(@1_x_783[@i_246[@i_469]], x[@i_469]))))))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(x[@i_468], K_u_1095[@i_468], x1_425[@i_468], x2_424[@i_468], X[@i_468], @1_x_783[@i_246[@i_468]], r_420[@i_468]) && otheruses(r_420[@i_468]) && ((x1 = x1_425[@i_468]) && ((x2 = x2_424[@i_468]) && ((x3 = X[@i_468]) && ((x4 = exp(g, @1_x_783[@i_246[@i_468]])) && (x5 = exp(g, mult(@1_x_783[@i_246[@i_468]], x[@i_468]))))))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(x[@i_467], K_u_1096[@i_467], x1_431[@i_467], x2_430[@i_467], X[@i_467], @1_x_925[@i_241[@i_467]], r_426[@i_467]) && otheruses(r_426[@i_467]) && ((x1 = x1_431[@i_467]) && ((x2 = x2_430[@i_467]) && ((x3 = X[@i_467]) && ((x4 = exp(g, @1_x_925[@i_241[@i_467]])) && (x5 = exp(g, mult(@1_x_925[@i_241[@i_467]], x[@i_467]))))))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(x[@i_466], K_u_1096[@i_466], x1_437[@i_466], x2_436[@i_466], X[@i_466], @1_x_925[@i_241[@i_466]], r_432[@i_466]) && otheruses(r_432[@i_466]) && ((x1 = x1_437[@i_466]) && ((x2 = x2_436[@i_466]) && ((x3 = X[@i_466]) && ((x4 = exp(g, @1_x_925[@i_241[@i_466]])) && (x5 = exp(g, mult(@1_x_925[@i_241[@i_466]], x[@i_466]))))))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(x[@i_465], yp[@i_238[@i_465]], K_u_1097[@i_465], x1_443[@i_465], x2_442[@i_465], X[@i_465], Yp[@i_238[@i_465]], r_438[@i_465]) && otheruses(r_438[@i_465]) && ((x1 = x1_443[@i_465]) && ((x2 = x2_442[@i_465]) && ((x3 = X[@i_465]) && ((x4 = Yp[@i_238[@i_465]]) && (x5 = exp(g, mult(yp[@i_238[@i_465]], x[@i_465]))))))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(x[@i_464], yp[@i_238[@i_464]], K_u_1097[@i_464], x1_449[@i_464], x2_448[@i_464], X[@i_464], Yp[@i_238[@i_464]], r_444[@i_464]) && otheruses(r_444[@i_464]) && ((x1 = x1_449[@i_464]) && ((x2 = x2_448[@i_464]) && ((x3 = X[@i_464]) && ((x4 = Yp[@i_238[@i_464]]) && (x5 = exp(g, mult(yp[@i_238[@i_464]], x[@i_464]))))))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(x[@i_463], y[@i_236[@i_463]], K_u_1098[@i_463], x1_455[@i_463], x2_454[@i_463], X[@i_463], Y[@i_236[@i_463]], r_450[@i_463]) && otheruses(r_450[@i_463]) && ((x1 = x1_455[@i_463]) && ((x2 = x2_454[@i_463]) && ((x3 = X[@i_463]) && ((x4 = Y[@i_236[@i_463]]) && (x5 = exp(g, mult(y[@i_236[@i_463]], x[@i_463]))))))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(x[@i_462], y[@i_236[@i_462]], K_u_1098[@i_462], x1_461[@i_462], x2_460[@i_462], X[@i_462], Y[@i_236[@i_462]], r_456[@i_462]) && otheruses(r_456[@i_462]) && ((x1 = x1_461[@i_462]) && ((x2 = x2_460[@i_462]) && ((x3 = X[@i_462]) && ((x4 = Y[@i_236[@i_462]]) && (x5 = exp(g, mult(y[@i_236[@i_462]], x[@i_462]))))))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_783[@i_246[@i_96]], K_u_1095[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(@1_x_783[@i_246[@i_96]], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_925[@i_241[@i_96]], K_u_1096[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(@1_x_925[@i_241[@i_96]], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], yp[@i_238[@i_96]], K_u_1097[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(yp[@i_238[@i_96]], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], y[@i_236[@i_96]], K_u_1098[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(y[@i_236[@i_96]], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_925[@i_96], K_u_1099[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(@1_x_925[@i_96], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of binder Kp yields

Game 31 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_x_783[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_x_783[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = exp(g, @1_x_783[@i_246]) in
    let K_u_1095: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_783[@i_246]) = x14[@i_120]) && (exp(g, mult(@1_x_783[@i_246], x)) = x15[@i_120]))))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      find [unique] @i_552 <= qH0 suchthat defined(x1[@i_552], x2[@i_552], x3[@i_552], x4[@i_552], x5[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && ((x1_425 = x1[@i_552]) && ((x2_424 = x2[@i_552]) && ((X = x3[@i_552]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_552]) && (exp(g, mult(@1_x_783[@i_246], x)) = x5[@i_552]))))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_552]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_420);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_419: host = U in
      let x2_418: host = S in
      find [unique] @i_539 <= qH0 suchthat defined(x1[@i_539], x2[@i_539], x3[@i_539], x4[@i_539], x5[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && ((x1_419 = x1[@i_539]) && ((x2_418 = x2[@i_539]) && ((X = x3[@i_539]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_539]) && (exp(g, mult(@1_x_783[@i_246], x)) = x5[@i_539]))))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_539]);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_414);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @1_x_925[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @1_x_925[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = exp(g, @1_x_925[@i_241]) in
    let K_u_1096: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_925[@i_241]) = x14[@i_120]) && (exp(g, mult(@1_x_925[@i_241], x)) = x15[@i_120]))))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      find [unique] @i_578 <= qH0 suchthat defined(x1[@i_578], x2[@i_578], x3[@i_578], x4[@i_578], x5[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && ((x1_437 = x1[@i_578]) && ((x2_436 = x2[@i_578]) && ((X = x3[@i_578]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_578]) && (exp(g, mult(@1_x_925[@i_241], x)) = x5[@i_578]))))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_578]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_432);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_431: host = U in
      let x2_430: host = S in
      find [unique] @i_565 <= qH0 suchthat defined(x1[@i_565], x2[@i_565], x3[@i_565], x4[@i_565], x5[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && ((x1_431 = x1[@i_565]) && ((x2_430 = x2[@i_565]) && ((X = x3[@i_565]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_565]) && (exp(g, mult(@1_x_925[@i_241], x)) = x5[@i_565]))))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_565]);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_426);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u_1097: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (exp(g, mult(yp[@i_238], x)) = x15[@i_120]))))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      find [unique] @i_604 <= qH0 suchthat defined(x1[@i_604], x2[@i_604], x3[@i_604], x4[@i_604], x5[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && ((x1_449 = x1[@i_604]) && ((x2_448 = x2[@i_604]) && ((X = x3[@i_604]) && ((Yp[@i_238] = x4[@i_604]) && (exp(g, mult(yp[@i_238], x)) = x5[@i_604]))))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_604]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_444);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_443: host = U in
      let x2_442: host = S in
      find [unique] @i_591 <= qH0 suchthat defined(x1[@i_591], x2[@i_591], x3[@i_591], x4[@i_591], x5[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && ((x1_443 = x1[@i_591]) && ((x2_442 = x2[@i_591]) && ((X = x3[@i_591]) && ((Yp[@i_238] = x4[@i_591]) && (exp(g, mult(yp[@i_238], x)) = x5[@i_591]))))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_591]);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_438);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u_1098: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (exp(g, mult(y[@i_236], x)) = x15[@i_120]))))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      find [unique] @i_630 <= qH0 suchthat defined(x1[@i_630], x2[@i_630], x3[@i_630], x4[@i_630], x5[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && ((x1_461 = x1[@i_630]) && ((x2_460 = x2[@i_630]) && ((X = x3[@i_630]) && ((Y[@i_236] = x4[@i_630]) && (exp(g, mult(y[@i_236], x)) = x5[@i_630]))))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_630]);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind  suchthat defined(j[@i_236], r_396[@i_236]) && otheruses(r_396[@i_236]) && (!_41 = j[@i_236]) then
      (
        let sk_u: hash0 = r_396[@i_236] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_396[@i_236]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_456);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_455: host = U in
      let x2_454: host = S in
      find [unique] @i_617 <= qH0 suchthat defined(x1[@i_617], x2[@i_617], x3[@i_617], x4[@i_617], x5[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && ((x1_455 = x1[@i_617]) && ((x2_454 = x2[@i_617]) && ((X = x3[@i_617]) && ((Y[@i_236] = x4[@i_617]) && (exp(g, mult(y[@i_236], x)) = x5[@i_617]))))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_617]);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_450);
        out(c6[!_41], r1_90)
  )
  else
    new @1_x_925: exponent;
    let @2_r4_172: G = cst_G in
    let Y_u: G = exp(g, @1_x_925) in
    let K_u_1099: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (exp(g, mult(x[j], y)) = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      find [unique] @i_500 <= qH0 suchthat defined(x1[@i_500], x2[@i_500], x3[@i_500], x4[@i_500], x5[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && ((x1_401 = x1[@i_500]) && ((x2_400 = x2[@i_500]) && ((X_s = x3[@i_500]) && ((Y = x4[@i_500]) && (exp(g, mult(x[j], y)) = x5[@i_500]))))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_500])
      )
      orfind  suchthat defined(@i_236[j], r_450[j]) && otheruses(r_450[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      orfind  suchthat defined(@i_236[j], r_456[j]) && otheruses(r_456[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_456[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_456[j])
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_396)
    )
    orfind  suchthat defined(x[j], y[@i_236[j]], K_u_1098[j], @i_236[j], r1_90[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (exp(g, mult(x[j], y)) = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_x_783[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_x_783[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_783[@i_222]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @1_x_925[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @1_x_925[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_925[@i_217]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = cst_G in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_x_783[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_x_783[@i_198]) && ((@2_x = exp(g, @1_x_783[@i_198])) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@1_x_925[@i_193], Ystar_u[@i_193], @2_r4_172[@i_193]) && otheruses(Ystar_u[@i_193] -> @1_x_925[@i_193]) && ((@2_x = exp(g, @1_x_925[@i_193])) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_x_783[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_x_783[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], exp(g, @1_x_783[@i_186]))
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @1_x_925[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @1_x_925[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], exp(g, @1_x_925[@i_181]))
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_x_783: exponent;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], exp(g, @1_x_783))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(yp[@i_473], xp[@i_473], Kp[@i_473], x1_395[@i_473], x2_394[@i_473], Xp[@i_473], Yp[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && ((x1 = x1_395[@i_473]) && ((x2 = x2_394[@i_473]) && ((x3 = Xp[@i_473]) && ((x4 = Yp[@i_473]) && (x5 = exp(g, mult(xp[@i_473], yp[@i_473]))))))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(y[@i_472], x[j[@i_472]], K_s[@i_472], x1_401[@i_472], x2_400[@i_472], X_s[@i_472], Y[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && ((x1 = x1_401[@i_472]) && ((x2 = x2_400[@i_472]) && ((x3 = X_s[@i_472]) && ((x4 = Y[@i_472]) && (x5 = exp(g, mult(x[j[@i_472]], y[@i_472]))))))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(y[@i_471], x[j[@i_471]], K_s[@i_471], x1_407[@i_471], x2_406[@i_471], X_s[@i_471], Y[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && ((x1 = x1_407[@i_471]) && ((x2 = x2_406[@i_471]) && ((x3 = X_s[@i_471]) && ((x4 = Y[@i_471]) && (x5 = exp(g, mult(x[j[@i_471]], y[@i_471]))))))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(x[@i_470], K_u_1099[@i_470], x1_413[@i_470], x2_412[@i_470], X[@i_470], @1_x_925[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && ((x1 = x1_413[@i_470]) && ((x2 = x2_412[@i_470]) && ((x3 = X[@i_470]) && ((x4 = exp(g, @1_x_925[@i_470])) && (x5 = exp(g, mult(@1_x_925[@i_470], x[@i_470]))))))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(x[@i_469], K_u_1095[@i_469], x1_419[@i_469], x2_418[@i_469], X[@i_469], @1_x_783[@i_246[@i_469]], r_414[@i_469]) && otheruses(r_414[@i_469]) && ((x1 = x1_419[@i_469]) && ((x2 = x2_418[@i_469]) && ((x3 = X[@i_469]) && ((x4 = exp(g, @1_x_783[@i_246[@i_469]])) && (x5 = exp(g, mult(@1_x_783[@i_246[@i_469]], x[@i_469]))))))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(x[@i_468], K_u_1095[@i_468], x1_425[@i_468], x2_424[@i_468], X[@i_468], @1_x_783[@i_246[@i_468]], r_420[@i_468]) && otheruses(r_420[@i_468]) && ((x1 = x1_425[@i_468]) && ((x2 = x2_424[@i_468]) && ((x3 = X[@i_468]) && ((x4 = exp(g, @1_x_783[@i_246[@i_468]])) && (x5 = exp(g, mult(@1_x_783[@i_246[@i_468]], x[@i_468]))))))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(x[@i_467], K_u_1096[@i_467], x1_431[@i_467], x2_430[@i_467], X[@i_467], @1_x_925[@i_241[@i_467]], r_426[@i_467]) && otheruses(r_426[@i_467]) && ((x1 = x1_431[@i_467]) && ((x2 = x2_430[@i_467]) && ((x3 = X[@i_467]) && ((x4 = exp(g, @1_x_925[@i_241[@i_467]])) && (x5 = exp(g, mult(@1_x_925[@i_241[@i_467]], x[@i_467]))))))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(x[@i_466], K_u_1096[@i_466], x1_437[@i_466], x2_436[@i_466], X[@i_466], @1_x_925[@i_241[@i_466]], r_432[@i_466]) && otheruses(r_432[@i_466]) && ((x1 = x1_437[@i_466]) && ((x2 = x2_436[@i_466]) && ((x3 = X[@i_466]) && ((x4 = exp(g, @1_x_925[@i_241[@i_466]])) && (x5 = exp(g, mult(@1_x_925[@i_241[@i_466]], x[@i_466]))))))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(x[@i_465], yp[@i_238[@i_465]], K_u_1097[@i_465], x1_443[@i_465], x2_442[@i_465], X[@i_465], Yp[@i_238[@i_465]], r_438[@i_465]) && otheruses(r_438[@i_465]) && ((x1 = x1_443[@i_465]) && ((x2 = x2_442[@i_465]) && ((x3 = X[@i_465]) && ((x4 = Yp[@i_238[@i_465]]) && (x5 = exp(g, mult(yp[@i_238[@i_465]], x[@i_465]))))))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(x[@i_464], yp[@i_238[@i_464]], K_u_1097[@i_464], x1_449[@i_464], x2_448[@i_464], X[@i_464], Yp[@i_238[@i_464]], r_444[@i_464]) && otheruses(r_444[@i_464]) && ((x1 = x1_449[@i_464]) && ((x2 = x2_448[@i_464]) && ((x3 = X[@i_464]) && ((x4 = Yp[@i_238[@i_464]]) && (x5 = exp(g, mult(yp[@i_238[@i_464]], x[@i_464]))))))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(x[@i_463], y[@i_236[@i_463]], K_u_1098[@i_463], x1_455[@i_463], x2_454[@i_463], X[@i_463], Y[@i_236[@i_463]], r_450[@i_463]) && otheruses(r_450[@i_463]) && ((x1 = x1_455[@i_463]) && ((x2 = x2_454[@i_463]) && ((x3 = X[@i_463]) && ((x4 = Y[@i_236[@i_463]]) && (x5 = exp(g, mult(y[@i_236[@i_463]], x[@i_463]))))))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(x[@i_462], y[@i_236[@i_462]], K_u_1098[@i_462], x1_461[@i_462], x2_460[@i_462], X[@i_462], Y[@i_236[@i_462]], r_456[@i_462]) && otheruses(r_456[@i_462]) && ((x1 = x1_461[@i_462]) && ((x2 = x2_460[@i_462]) && ((x3 = X[@i_462]) && ((x4 = Y[@i_236[@i_462]]) && (x5 = exp(g, mult(y[@i_236[@i_462]], x[@i_462]))))))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(yp[@i_99], xp[@i_99], Kp[@i_99], x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = exp(g, mult(xp[@i_99], yp[@i_99]))))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_783[@i_246[@i_96]], K_u_1095[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(@1_x_783[@i_246[@i_96]], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_925[@i_241[@i_96]], K_u_1096[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(@1_x_925[@i_241[@i_96]], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], yp[@i_238[@i_96]], K_u_1097[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(yp[@i_238[@i_96]], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], y[@i_236[@i_96]], K_u_1098[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(y[@i_236[@i_96]], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_925[@i_96], K_u_1099[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(@1_x_925[@i_96], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 74. / 10. * #@1_Oa) * max(1., 74. / 10. * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
with x, @1_x_925, yp, y, xp, @1_x_783 [Excluding set(dist 31->32.1, proba <= 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31))) U set(dist 31->32.2, proba <= NP * qD / |exponent|) U set(dist 31->32.3, proba <= NU * qD / |exponent|) U set(dist 31->32.4, proba <= NU * NP / |exponent|) U set(dist 31->32.5, proba <= 0.5 * qD * qD / |exponent|) U set(dist 31->32.6, proba <= 0.5 * NU * NU / |exponent|)] yields

Game 32 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_x_783[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_x_783[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = @1_exp'(g, @1_x_783[@i_246]) in
    let K_u_1095: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && find  else find  else ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((@1_exp'(g, @1_x_783[@i_246]) = x14[@i_120]) && false)))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      find [unique] @i_552 <= qH0 suchthat defined(x1[@i_552], x2[@i_552], x3[@i_552], x4[@i_552], x5[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && find  else find  else ((x1_425 = x1[@i_552]) && ((x2_424 = x2[@i_552]) && ((X = x3[@i_552]) && ((@1_exp'(g, @1_x_783[@i_246]) = x4[@i_552]) && false)))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_552]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_420);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_419: host = U in
      let x2_418: host = S in
      find [unique] @i_539 <= qH0 suchthat defined(x1[@i_539], x2[@i_539], x3[@i_539], x4[@i_539], x5[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && find  else find  else ((x1_419 = x1[@i_539]) && ((x2_418 = x2[@i_539]) && ((X = x3[@i_539]) && ((@1_exp'(g, @1_x_783[@i_246]) = x4[@i_539]) && false)))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_539]);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_414);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @1_x_925[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @1_x_925[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = @1_exp'(g, @1_x_925[@i_241]) in
    let K_u_1096: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && find  else find  else ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((@1_exp'(g, @1_x_925[@i_241]) = x14[@i_120]) && false)))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      find [unique] @i_578 <= qH0 suchthat defined(x1[@i_578], x2[@i_578], x3[@i_578], x4[@i_578], x5[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && find  else find  else ((x1_437 = x1[@i_578]) && ((x2_436 = x2[@i_578]) && ((X = x3[@i_578]) && ((@1_exp'(g, @1_x_925[@i_241]) = x4[@i_578]) && false)))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_578]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_432);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_431: host = U in
      let x2_430: host = S in
      find [unique] @i_565 <= qH0 suchthat defined(x1[@i_565], x2[@i_565], x3[@i_565], x4[@i_565], x5[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && find  else find  else ((x1_431 = x1[@i_565]) && ((x2_430 = x2[@i_565]) && ((X = x3[@i_565]) && ((@1_exp'(g, @1_x_925[@i_241]) = x4[@i_565]) && false)))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_565]);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_426);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u_1097: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && find  else find  else ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && false)))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      find [unique] @i_604 <= qH0 suchthat defined(x1[@i_604], x2[@i_604], x3[@i_604], x4[@i_604], x5[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && find  else find  else ((x1_449 = x1[@i_604]) && ((x2_448 = x2[@i_604]) && ((X = x3[@i_604]) && ((Yp[@i_238] = x4[@i_604]) && false)))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_604]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_444);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_443: host = U in
      let x2_442: host = S in
      find [unique] @i_591 <= qH0 suchthat defined(x1[@i_591], x2[@i_591], x3[@i_591], x4[@i_591], x5[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && find  else find  else ((x1_443 = x1[@i_591]) && ((x2_442 = x2[@i_591]) && ((X = x3[@i_591]) && ((Yp[@i_238] = x4[@i_591]) && false)))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_591]);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_438);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u_1098: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && find  else find  else ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && false)))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      find [unique] @i_630 <= qH0 suchthat defined(x1[@i_630], x2[@i_630], x3[@i_630], x4[@i_630], x5[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && find  else find  else ((x1_461 = x1[@i_630]) && ((x2_460 = x2[@i_630]) && ((X = x3[@i_630]) && ((Y[@i_236] = x4[@i_630]) && false)))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_630]);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind  suchthat defined(j[@i_236], r_396[@i_236]) && otheruses(r_396[@i_236]) && (!_41 = j[@i_236]) then
      (
        let sk_u: hash0 = r_396[@i_236] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_396[@i_236]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_456);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_455: host = U in
      let x2_454: host = S in
      find [unique] @i_617 <= qH0 suchthat defined(x1[@i_617], x2[@i_617], x3[@i_617], x4[@i_617], x5[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && find  else find  else ((x1_455 = x1[@i_617]) && ((x2_454 = x2[@i_617]) && ((X = x3[@i_617]) && ((Y[@i_236] = x4[@i_617]) && false)))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_617]);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_450);
        out(c6[!_41], r1_90)
  )
  else
    new @1_x_925: exponent;
    let @2_r4_172: G = cst_G in
    let Y_u: G = @1_exp'(g, @1_x_925) in
    let K_u_1099: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && find  else find  else ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && false)))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      find [unique] @i_500 <= qH0 suchthat defined(x1[@i_500], x2[@i_500], x3[@i_500], x4[@i_500], x5[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && find  else find  else ((x1_401 = x1[@i_500]) && ((x2_400 = x2[@i_500]) && ((X_s = x3[@i_500]) && ((Y = x4[@i_500]) && false)))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_500])
      )
      orfind  suchthat defined(@i_236[j], r_450[j]) && otheruses(r_450[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      orfind  suchthat defined(@i_236[j], r_456[j]) && otheruses(r_456[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_456[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_456[j])
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_396)
    )
    orfind  suchthat defined(x[j], y[@i_236[j]], K_u_1098[j], @i_236[j], r1_90[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && find  else find  else ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && false)))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_x_783[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_x_783[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_exp'(g, @1_x_783[@i_222]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @1_x_925[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @1_x_925[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_exp'(g, @1_x_925[@i_217]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  let Kp: G = cst_G in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_x_783[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_x_783[@i_198]) && ((@2_x = @1_exp'(g, @1_x_783[@i_198])) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@1_x_925[@i_193], Ystar_u[@i_193], @2_r4_172[@i_193]) && otheruses(Ystar_u[@i_193] -> @1_x_925[@i_193]) && ((@2_x = @1_exp'(g, @1_x_925[@i_193])) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_x_783[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_x_783[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_exp'(g, @1_x_783[@i_186]))
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @1_x_925[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @1_x_925[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], @1_exp'(g, @1_x_925[@i_181]))
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_x_783: exponent;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_exp'(g, @1_x_783))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(yp[@i_473], xp[@i_473], Kp[@i_473], x1_395[@i_473], x2_394[@i_473], Xp[@i_473], Yp[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && find  else find  else ((x1 = x1_395[@i_473]) && ((x2 = x2_394[@i_473]) && ((x3 = Xp[@i_473]) && ((x4 = Yp[@i_473]) && false)))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(y[@i_472], x[j[@i_472]], K_s[@i_472], x1_401[@i_472], x2_400[@i_472], X_s[@i_472], Y[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && find  else find  else ((x1 = x1_401[@i_472]) && ((x2 = x2_400[@i_472]) && ((x3 = X_s[@i_472]) && ((x4 = Y[@i_472]) && false)))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(y[@i_471], x[j[@i_471]], K_s[@i_471], x1_407[@i_471], x2_406[@i_471], X_s[@i_471], Y[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && find  else find  else ((x1 = x1_407[@i_471]) && ((x2 = x2_406[@i_471]) && ((x3 = X_s[@i_471]) && ((x4 = Y[@i_471]) && false)))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(x[@i_470], K_u_1099[@i_470], x1_413[@i_470], x2_412[@i_470], X[@i_470], @1_x_925[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && find  else find  else ((x1 = x1_413[@i_470]) && ((x2 = x2_412[@i_470]) && ((x3 = X[@i_470]) && ((x4 = @1_exp'(g, @1_x_925[@i_470])) && false)))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(x[@i_469], K_u_1095[@i_469], x1_419[@i_469], x2_418[@i_469], X[@i_469], @1_x_783[@i_246[@i_469]], r_414[@i_469]) && otheruses(r_414[@i_469]) && find  else find  else ((x1 = x1_419[@i_469]) && ((x2 = x2_418[@i_469]) && ((x3 = X[@i_469]) && ((x4 = @1_exp'(g, @1_x_783[@i_246[@i_469]])) && false)))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(x[@i_468], K_u_1095[@i_468], x1_425[@i_468], x2_424[@i_468], X[@i_468], @1_x_783[@i_246[@i_468]], r_420[@i_468]) && otheruses(r_420[@i_468]) && find  else find  else ((x1 = x1_425[@i_468]) && ((x2 = x2_424[@i_468]) && ((x3 = X[@i_468]) && ((x4 = @1_exp'(g, @1_x_783[@i_246[@i_468]])) && false)))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(x[@i_467], K_u_1096[@i_467], x1_431[@i_467], x2_430[@i_467], X[@i_467], @1_x_925[@i_241[@i_467]], r_426[@i_467]) && otheruses(r_426[@i_467]) && find  else find  else ((x1 = x1_431[@i_467]) && ((x2 = x2_430[@i_467]) && ((x3 = X[@i_467]) && ((x4 = @1_exp'(g, @1_x_925[@i_241[@i_467]])) && false)))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(x[@i_466], K_u_1096[@i_466], x1_437[@i_466], x2_436[@i_466], X[@i_466], @1_x_925[@i_241[@i_466]], r_432[@i_466]) && otheruses(r_432[@i_466]) && find  else find  else ((x1 = x1_437[@i_466]) && ((x2 = x2_436[@i_466]) && ((x3 = X[@i_466]) && ((x4 = @1_exp'(g, @1_x_925[@i_241[@i_466]])) && false)))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(x[@i_465], yp[@i_238[@i_465]], K_u_1097[@i_465], x1_443[@i_465], x2_442[@i_465], X[@i_465], Yp[@i_238[@i_465]], r_438[@i_465]) && otheruses(r_438[@i_465]) && find  else find  else ((x1 = x1_443[@i_465]) && ((x2 = x2_442[@i_465]) && ((x3 = X[@i_465]) && ((x4 = Yp[@i_238[@i_465]]) && false)))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(x[@i_464], yp[@i_238[@i_464]], K_u_1097[@i_464], x1_449[@i_464], x2_448[@i_464], X[@i_464], Yp[@i_238[@i_464]], r_444[@i_464]) && otheruses(r_444[@i_464]) && find  else find  else ((x1 = x1_449[@i_464]) && ((x2 = x2_448[@i_464]) && ((x3 = X[@i_464]) && ((x4 = Yp[@i_238[@i_464]]) && false)))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(x[@i_463], y[@i_236[@i_463]], K_u_1098[@i_463], x1_455[@i_463], x2_454[@i_463], X[@i_463], Y[@i_236[@i_463]], r_450[@i_463]) && otheruses(r_450[@i_463]) && find  else find  else ((x1 = x1_455[@i_463]) && ((x2 = x2_454[@i_463]) && ((x3 = X[@i_463]) && ((x4 = Y[@i_236[@i_463]]) && false)))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(x[@i_462], y[@i_236[@i_462]], K_u_1098[@i_462], x1_461[@i_462], x2_460[@i_462], X[@i_462], Y[@i_236[@i_462]], r_456[@i_462]) && otheruses(r_456[@i_462]) && find  else find  else ((x1 = x1_461[@i_462]) && ((x2 = x2_460[@i_462]) && ((x3 = X[@i_462]) && ((x4 = Y[@i_236[@i_462]]) && false)))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(yp[@i_99], xp[@i_99], Kp[@i_99], x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && find  else find  else ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && false)))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_783[@i_246[@i_96]], K_u_1095[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && find  else find  else ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && false)))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_925[@i_241[@i_96]], K_u_1096[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && find  else find  else ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && false)))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], yp[@i_238[@i_96]], K_u_1097[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && find  else find  else ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && false)))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], y[@i_236[@i_96]], K_u_1098[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && find  else find  else ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && false)))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_925[@i_96], K_u_1099[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && find  else find  else ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && false)))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying simplify yields

Game 33 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_x_783[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_x_783[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = @1_exp'(g, @1_x_783[@i_246]) in
    let K_u_1095: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    let x1_419: host = U in
    let x2_418: host = S in
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_90: hash1;
    event termU(U, X, S, Ystar_u, r1_90, r_414);
    out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @1_x_925[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @1_x_925[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = @1_exp'(g, @1_x_925[@i_241]) in
    let K_u_1096: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    let x1_431: host = U in
    let x2_430: host = S in
    new r_426: hash0;
    let sk_u: hash0 = r_426 in
    new r1_90: hash1;
    event termU(U, X, S, Ystar_u, r1_90, r_426);
    out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u_1097: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    let x1_443: host = U in
    let x2_442: host = S in
    new r_438: hash0;
    let sk_u: hash0 = r_438 in
    new r1_90: hash1;
    event termU(U, X, S, Ystar_u, r1_90, r_438);
    out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u_1098: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    let x1_455: host = U in
    let x2_454: host = S in
    new r_450: hash0;
    let sk_u: hash0 = r_450 in
    new r1_90: hash1;
    event termU(U, X, S, Ystar_u, r1_90, r_450);
    out(c6[!_41], r1_90)
  )
  else
    new @1_x_925: exponent;
    let @2_r4_172: G = cst_G in
    let Y_u: G = @1_exp'(g, @1_x_925) in
    let K_u_1099: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    let x1_89: host = U in
    let x2_88: host = S in
    if defined(@i_236[j], r1_90[j], r_450[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    if (auth_s = r1_90[j]) then
    let x1_407: host = U in
    let x2_406: host = S in
    if defined(r_450[j]) && otheruses(r_450[j]) then
    let sk_s: hash0 = r_450[j] in
    event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_x_783[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_x_783[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_exp'(g, @1_x_783[@i_222]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @1_x_925[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @1_x_925[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_exp'(g, @1_x_925[@i_217]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  let Kp: G = cst_G in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_x_783[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_x_783[@i_198]) && ((@2_x = @1_exp'(g, @1_x_783[@i_198])) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@1_x_925[@i_193], Ystar_u[@i_193], @2_r4_172[@i_193]) && otheruses(Ystar_u[@i_193] -> @1_x_925[@i_193]) && ((@2_x = @1_exp'(g, @1_x_925[@i_193])) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_x_783[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_x_783[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_exp'(g, @1_x_783[@i_186]))
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @1_x_925[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @1_x_925[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], @1_exp'(g, @1_x_925[@i_181]))
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_x_783: exponent;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_exp'(g, @1_x_783))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying move all binders yields

Game 34 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_x_783[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_x_783[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = @1_exp'(g, @1_x_783[@i_246]) in
    let K_u_1095: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    let x1_419: host = U in
    let x2_418: host = S in
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_90: hash1;
    event termU(U, X, S, Ystar_u, r1_90, r_414);
    out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @1_x_925[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @1_x_925[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = @1_exp'(g, @1_x_925[@i_241]) in
    let K_u_1096: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    let x1_431: host = U in
    let x2_430: host = S in
    new r_426: hash0;
    let sk_u: hash0 = r_426 in
    new r1_90: hash1;
    event termU(U, X, S, Ystar_u, r1_90, r_426);
    out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u_1097: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    let x1_443: host = U in
    let x2_442: host = S in
    new r_438: hash0;
    let sk_u: hash0 = r_438 in
    new r1_90: hash1;
    event termU(U, X, S, Ystar_u, r1_90, r_438);
    out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u_1098: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    let x1_455: host = U in
    let x2_454: host = S in
    new r_450: hash0;
    let sk_u: hash0 = r_450 in
    new r1_90: hash1;
    event termU(U, X, S, Ystar_u, r1_90, r_450);
    out(c6[!_41], r1_90)
  )
  else
    new @1_x_925: exponent;
    let @2_r4_172: G = cst_G in
    let Y_u: G = @1_exp'(g, @1_x_925) in
    let K_u_1099: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_236[j], r1_90[j], r_450[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    if (auth_s = r1_90[j]) then
    if defined(r_450[j]) && otheruses(r_450[j]) then
    let sk_s: hash0 = r_450[j] in
    event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_x_783[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_x_783[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_exp'(g, @1_x_783[@i_222]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @1_x_925[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @1_x_925[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_exp'(g, @1_x_925[@i_217]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  let Kp: G = cst_G in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_x_783[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_x_783[@i_198]) && ((@2_x = @1_exp'(g, @1_x_783[@i_198])) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@1_x_925[@i_193], Ystar_u[@i_193], @2_r4_172[@i_193]) && otheruses(Ystar_u[@i_193] -> @1_x_925[@i_193]) && ((@2_x = @1_exp'(g, @1_x_925[@i_193])) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_x_783[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_x_783[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_exp'(g, @1_x_783[@i_186]))
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @1_x_925[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @1_x_925[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], @1_exp'(g, @1_x_925[@i_181]))
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_x_783: exponent;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_exp'(g, @1_x_783))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of useless yields

Game 35 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_x_783[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_x_783[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_90: hash1;
    event termU(U, X, S, Ystar_u, r1_90, r_414);
    out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @1_x_925[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @1_x_925[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    new r_426: hash0;
    let sk_u: hash0 = r_426 in
    new r1_90: hash1;
    event termU(U, X, S, Ystar_u, r1_90, r_426);
    out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    new r_438: hash0;
    let sk_u: hash0 = r_438 in
    new r1_90: hash1;
    event termU(U, X, S, Ystar_u, r1_90, r_438);
    out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    new r_450: hash0;
    let sk_u: hash0 = r_450 in
    new r1_90: hash1;
    event termU(U, X, S, Ystar_u, r1_90, r_450);
    out(c6[!_41], r1_90)
  )
  else
    new @1_x_925: exponent;
    let @2_r4_172: G = cst_G in
    new r1_90: hash1;
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_236[j], r1_90[j], r_450[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    if (auth_s = r1_90[j]) then
    if defined(r_450[j]) && otheruses(r_450[j]) then
    let sk_s: hash0 = r_450[j] in
    event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_x_783[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_x_783[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_exp'(g, @1_x_783[@i_222]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @1_x_925[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @1_x_925[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_exp'(g, @1_x_925[@i_217]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_x_783[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_x_783[@i_198]) && ((@2_x = @1_exp'(g, @1_x_783[@i_198])) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@1_x_925[@i_193], Ystar_u[@i_193], @2_r4_172[@i_193]) && otheruses(Ystar_u[@i_193] -> @1_x_925[@i_193]) && ((@2_x = @1_exp'(g, @1_x_925[@i_193])) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_x_783[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_x_783[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_exp'(g, @1_x_783[@i_186]))
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @1_x_925[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @1_x_925[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], @1_exp'(g, @1_x_925[@i_181]))
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_x_783: exponent;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_exp'(g, @1_x_783))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


RESULT Proved event termS(x, X, y, Y, a, k) && termU(x, X, y, Y, a, k') ==> (k = k') excluding set(dist 3->4, proba <= 1. / |exponent| * NP + 4. * 1. / |exponent| * NS + 2. * NU * NP / |exponent| + 3. * NS * NP / |exponent| + qH1 * NP / |exponent| + 2. * NS / |hash1| + NP * NP / |exponent| + 0.5 * NS * NS / |exponent| + 0.5 * NU * NU / |exponent|) U set(event Auth in game 10) U set(dist 10->11, proba <= (NP * NP + 2. * qE * NP + 2. * NU * NP + 4. * NS * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 4. * NS * qE + 2. * qD * qE + NU * NU + 4. * NS * NU + 2. * qD * NU + 4. * NS * NS + 4. * qD * NS + qD * qD + -1. * NP + -1. * qE + -1. * NU + -2. * NS + -1. * qD) / |G|) U set(dist 11->12, proba <= 2. * NS * NP / |exponent| + qE * NP / |exponent| + NU * NP / |exponent| + qD * NP / |exponent| + NP * NS / |exponent| + qE * NS / |exponent| + NU * NS / |exponent| + NS * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G| + 0.5 * NS * NS / |G| + NS * NP / |G| + NS * qE / |G|) U set(event Encrypt in game 15) U set(dist 16->17, proba <= 1. / |exponent| * NP + 15. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + 10. * NU * NP / |exponent| + 2. * NS * NP / |exponent| + qH0 * NP / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + 8.5 * NU * NU / |G| + 3. * NS * NU / |G| + 2. * NP * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NP * qD / |G| + qD * NP / |exponent| + NU * qH1 / |hash1| + qD * NU / |G| + 0.5 * qD * qD / |G|) U set(dist 23->24, proba <= 4. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|) U set(dist 31->32.1, proba <= 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31))) U set(dist 31->32.2, proba <= NP * qD / |exponent|) U set(dist 31->32.3, proba <= NU * qD / |exponent|) U set(dist 31->32.4, proba <= NU * NP / |exponent|) U set(dist 31->32.5, proba <= 0.5 * qD * qD / |exponent|) U set(dist 31->32.6, proba <= 0.5 * NU * NU / |exponent|)
RESULT However, I could not bound the probability of set(event Auth in game 10)
RESULT Proved event inj:termS(x, X, y, Y, a, k) ==> inj:termU(x, X, y, Y, a, k) excluding set(dist 3->4, proba <= 1. / |exponent| * NP + 4. * 1. / |exponent| * NS + 2. * NU * NP / |exponent| + 3. * NS * NP / |exponent| + qH1 * NP / |exponent| + 2. * NS / |hash1| + NP * NP / |exponent| + 0.5 * NS * NS / |exponent| + 0.5 * NU * NU / |exponent|) U set(event Auth in game 10) U set(dist 10->11, proba <= (NP * NP + 2. * qE * NP + 2. * NU * NP + 4. * NS * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 4. * NS * qE + 2. * qD * qE + NU * NU + 4. * NS * NU + 2. * qD * NU + 4. * NS * NS + 4. * qD * NS + qD * qD + -1. * NP + -1. * qE + -1. * NU + -2. * NS + -1. * qD) / |G|) U set(dist 11->12, proba <= 2. * NS * NP / |exponent| + qE * NP / |exponent| + NU * NP / |exponent| + qD * NP / |exponent| + NP * NS / |exponent| + qE * NS / |exponent| + NU * NS / |exponent| + NS * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G| + 0.5 * NS * NS / |G| + NS * NP / |G| + NS * qE / |G|) U set(event Encrypt in game 15) U set(dist 16->17, proba <= 1. / |exponent| * NP + 15. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + 10. * NU * NP / |exponent| + 2. * NS * NP / |exponent| + qH0 * NP / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + 8.5 * NU * NU / |G| + 3. * NS * NU / |G| + 2. * NP * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NP * qD / |G| + qD * NP / |exponent| + NU * qH1 / |hash1| + qD * NU / |G| + 0.5 * qD * qD / |G|) U set(dist 23->24, proba <= 4. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|) U set(dist 31->32.1, proba <= 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31))) U set(dist 31->32.2, proba <= NP * qD / |exponent|) U set(dist 31->32.3, proba <= NU * qD / |exponent|) U set(dist 31->32.4, proba <= NU * NP / |exponent|) U set(dist 31->32.5, proba <= 0.5 * qD * qD / |exponent|) U set(dist 31->32.6, proba <= 0.5 * NU * NU / |exponent|)
RESULT However, I could not bound the probability of set(event Auth in game 10)
RESULT Proved secrecy of sk_p excluding set(dist 3->4, proba <= 1. / |exponent| * NP + 4. * 1. / |exponent| * NS + 2. * NU * NP / |exponent| + 3. * NS * NP / |exponent| + qH1 * NP / |exponent| + 2. * NS / |hash1| + NP * NP / |exponent| + 0.5 * NS * NS / |exponent| + 0.5 * NU * NU / |exponent|) U set(event Auth in game 10) U set(dist 10->11, proba <= (NP * NP + 2. * qE * NP + 2. * NU * NP + 4. * NS * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 4. * NS * qE + 2. * qD * qE + NU * NU + 4. * NS * NU + 2. * qD * NU + 4. * NS * NS + 4. * qD * NS + qD * qD + -1. * NP + -1. * qE + -1. * NU + -2. * NS + -1. * qD) / |G|) U set(dist 11->12, proba <= 2. * NS * NP / |exponent| + qE * NP / |exponent| + NU * NP / |exponent| + qD * NP / |exponent| + NP * NS / |exponent| + qE * NS / |exponent| + NU * NS / |exponent| + NS * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G| + 0.5 * NS * NS / |G| + NS * NP / |G| + NS * qE / |G|) U set(event Encrypt in game 15) U set(dist 16->17, proba <= 1. / |exponent| * NP + 15. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + 10. * NU * NP / |exponent| + 2. * NS * NP / |exponent| + qH0 * NP / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + 8.5 * NU * NU / |G| + 3. * NS * NU / |G| + 2. * NP * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NP * qD / |G| + qD * NP / |exponent| + NU * qH1 / |hash1| + qD * NU / |G| + 0.5 * qD * qD / |G|) U set(dist 23->24, proba <= 4. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|) U set(dist 31->32.1, proba <= 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31))) U set(dist 31->32.2, proba <= NP * qD / |exponent|) U set(dist 31->32.3, proba <= NU * qD / |exponent|) U set(dist 31->32.4, proba <= NU * NP / |exponent|) U set(dist 31->32.5, proba <= 0.5 * qD * qD / |exponent|) U set(dist 31->32.6, proba <= 0.5 * NU * NU / |exponent|)
RESULT However, I could not bound the probability of set(event Auth in game 10)
RESULT Proved secrecy of sk_s excluding set(dist 3->4, proba <= 1. / |exponent| * NP + 4. * 1. / |exponent| * NS + 2. * NU * NP / |exponent| + 3. * NS * NP / |exponent| + qH1 * NP / |exponent| + 2. * NS / |hash1| + NP * NP / |exponent| + 0.5 * NS * NS / |exponent| + 0.5 * NU * NU / |exponent|) U set(event Auth in game 10) U set(dist 10->11, proba <= (NP * NP + 2. * qE * NP + 2. * NU * NP + 4. * NS * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 4. * NS * qE + 2. * qD * qE + NU * NU + 4. * NS * NU + 2. * qD * NU + 4. * NS * NS + 4. * qD * NS + qD * qD + -1. * NP + -1. * qE + -1. * NU + -2. * NS + -1. * qD) / |G|) U set(dist 11->12, proba <= 2. * NS * NP / |exponent| + qE * NP / |exponent| + NU * NP / |exponent| + qD * NP / |exponent| + NP * NS / |exponent| + qE * NS / |exponent| + NU * NS / |exponent| + NS * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G| + 0.5 * NS * NS / |G| + NS * NP / |G| + NS * qE / |G|) U set(event Encrypt in game 15) U set(dist 16->17, proba <= 1. / |exponent| * NP + 15. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + 10. * NU * NP / |exponent| + 2. * NS * NP / |exponent| + qH0 * NP / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + 8.5 * NU * NU / |G| + 3. * NS * NU / |G| + 2. * NP * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NP * qD / |G| + qD * NP / |exponent| + NU * qH1 / |hash1| + qD * NU / |G| + 0.5 * qD * qD / |G|) U set(dist 23->24, proba <= 4. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|) U set(dist 31->32.1, proba <= 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31))) U set(dist 31->32.2, proba <= NP * qD / |exponent|) U set(dist 31->32.3, proba <= NU * qD / |exponent|) U set(dist 31->32.4, proba <= NU * NP / |exponent|) U set(dist 31->32.5, proba <= 0.5 * qD * qD / |exponent|) U set(dist 31->32.6, proba <= 0.5 * NU * NU / |exponent|)
RESULT However, I could not bound the probability of set(event Auth in game 10)
RESULT Proved secrecy of sk_u excluding set(dist 3->4, proba <= 1. / |exponent| * NP + 4. * 1. / |exponent| * NS + 2. * NU * NP / |exponent| + 3. * NS * NP / |exponent| + qH1 * NP / |exponent| + 2. * NS / |hash1| + NP * NP / |exponent| + 0.5 * NS * NS / |exponent| + 0.5 * NU * NU / |exponent|) U set(event Auth in game 10) U set(dist 10->11, proba <= (NP * NP + 2. * qE * NP + 2. * NU * NP + 4. * NS * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 4. * NS * qE + 2. * qD * qE + NU * NU + 4. * NS * NU + 2. * qD * NU + 4. * NS * NS + 4. * qD * NS + qD * qD + -1. * NP + -1. * qE + -1. * NU + -2. * NS + -1. * qD) / |G|) U set(dist 11->12, proba <= 2. * NS * NP / |exponent| + qE * NP / |exponent| + NU * NP / |exponent| + qD * NP / |exponent| + NP * NS / |exponent| + qE * NS / |exponent| + NU * NS / |exponent| + NS * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G| + 0.5 * NS * NS / |G| + NS * NP / |G| + NS * qE / |G|) U set(event Encrypt in game 15) U set(dist 16->17, proba <= 1. / |exponent| * NP + 15. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + 10. * NU * NP / |exponent| + 2. * NS * NP / |exponent| + qH0 * NP / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + 8.5 * NU * NU / |G| + 3. * NS * NU / |G| + 2. * NP * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NP * qD / |G| + qD * NP / |exponent| + NU * qH1 / |hash1| + qD * NU / |G| + 0.5 * qD * qD / |G|) U set(dist 23->24, proba <= 4. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|) U set(dist 31->32.1, proba <= 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31))) U set(dist 31->32.2, proba <= NP * qD / |exponent|) U set(dist 31->32.3, proba <= NU * qD / |exponent|) U set(dist 31->32.4, proba <= NU * NP / |exponent|) U set(dist 31->32.5, proba <= 0.5 * qD * qD / |exponent|) U set(dist 31->32.6, proba <= 0.5 * NU * NU / |exponent|)
RESULT However, I could not bound the probability of set(event Auth in game 10)

Applying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
 yields

Game 36 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@1_X_3743[@i_246], @2_m[@i_246], @2_kd[@i_246], @1_x_783[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_X_3743[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_90: hash1;
    event termU(U, X, S, Ystar_u, r1_90, r_414);
    out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @1_x_925[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @1_x_925[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    new r_426: hash0;
    let sk_u: hash0 = r_426 in
    new r1_90: hash1;
    event termU(U, X, S, Ystar_u, r1_90, r_426);
    out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    new r_438: hash0;
    let sk_u: hash0 = r_438 in
    new r1_90: hash1;
    event termU(U, X, S, Ystar_u, r1_90, r_438);
    out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    new r_450: hash0;
    let sk_u: hash0 = r_450 in
    new r1_90: hash1;
    event termU(U, X, S, Ystar_u, r1_90, r_450);
    out(c6[!_41], r1_90)
  )
  else
    new @1_x_925: exponent;
    let @2_r4_172: G = cst_G in
    new r1_90: hash1;
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_236[j], r1_90[j], r_450[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    if (auth_s = r1_90[j]) then
    if defined(r_450[j]) && otheruses(r_450[j]) then
    let sk_s: hash0 = r_450[j] in
    event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@1_X_3743[@i_222], @2_m[@i_222], @2_kd[@i_222], @1_x_783[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_X_3743[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3743[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @1_x_925[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @1_x_925[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_exp'(g, @1_x_925[@i_217]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[@i_198], @1_x_783[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_X_3743[@i_198]) && ((@2_x = @1_X_3743[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@1_x_925[@i_193], Ystar_u[@i_193], @2_r4_172[@i_193]) && otheruses(Ystar_u[@i_193] -> @1_x_925[@i_193]) && ((@2_x = @1_exp'(g, @1_x_925[@i_193])) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@1_X_3743[@i_186], @2_m[@i_186], @2_kd[@i_186], @1_x_783[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_X_3743[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_X_3743[@i_186])
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @1_x_925[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @1_x_925[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], @1_exp'(g, @1_x_925[@i_181]))
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_X_3743: G;
    let @1_x_783: exponent = cst_exponent in
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_X_3743)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying simplify yields

Game 37 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_X_3743[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_X_3743[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    new r_438: hash0;
    let sk_u: hash0 = r_438 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    new r_450: hash0;
    let sk_u: hash0 = r_450 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  else
    let @2_r4_172: G = cst_G in
    new r1_90: hash1;
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_236[j], r1_90[j], r_450[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    if (auth_s = r1_90[j]) then
    let sk_s: hash0 = r_450[j]
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_X_3743[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_X_3743[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3743[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_X_3743[@i_198]) && ((@2_x = @1_X_3743[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_X_3743[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_X_3743[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_X_3743[@i_186])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_X_3743: G;
    let @1_x_783: exponent = cst_exponent in
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_X_3743)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of useless yields

Game 38 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_X_3743[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_X_3743[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    new r_438: hash0;
    let sk_u: hash0 = r_438 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    new r_450: hash0;
    let sk_u: hash0 = r_450 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  else
    new r1_90: hash1;
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_236[j], r1_90[j], r_450[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    if (auth_s = r1_90[j]) then
    let sk_s: hash0 = r_450[j]
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_X_3743[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_X_3743[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3743[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_X_3743[@i_198]) && ((@2_x = @1_X_3743[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_X_3743[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_X_3743[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_X_3743[@i_186])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_X_3743: G;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_X_3743)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
 yields

Game 39 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_X_3743[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_X_3743[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    new r_438: hash0;
    let sk_u: hash0 = r_438 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    new r_450: hash0;
    let sk_u: hash0 = r_450 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  else
    new r1_90: hash1;
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_236[j], r1_90[j], r_450[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    if (auth_s = r1_90[j]) then
    let sk_s: hash0 = r_450[j]
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_X_3743[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_X_3743[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3743[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new @1_X_3894: G;
  let Yp: G = @1_X_3894 in
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_X_3743[@i_198]) && ((@2_x = @1_X_3743[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_X_3743[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_X_3743[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_X_3743[@i_186])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_X_3743: G;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_X_3743)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of useless yields

Game 40 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_X_3743[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_X_3743[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@1_X_3894[@i_238], Yp[@i_238], @2_r2_163[@i_238]) && otheruses(@1_X_3894[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    new r_438: hash0;
    let sk_u: hash0 = r_438 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    new r_450: hash0;
    let sk_u: hash0 = r_450 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  else
    new r1_90: hash1;
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_236[j], r1_90[j], r_450[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    if (auth_s = r1_90[j]) then
    let sk_s: hash0 = r_450[j]
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_X_3743[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_X_3743[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3743[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new @1_X_3894: G;
  let Yp: G = cst_G in
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_X_3743[@i_198]) && ((@2_x = @1_X_3743[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(@1_X_3894[@i_190], Yp[@i_190], @2_r2_163[@i_190]) && otheruses(@1_X_3894[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = @1_X_3894[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_X_3743[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_X_3743[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_X_3743[@i_186])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@1_X_3894[@i_178], Yp[@i_178], @2_r2_163[@i_178]) && otheruses(@1_X_3894[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], @1_X_3894[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_X_3743: G;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_X_3743)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
 yields

Game 41 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_X_3743[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_X_3743[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@1_X_3894[@i_238], Yp[@i_238], @2_r2_163[@i_238]) && otheruses(@1_X_3894[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    new r_438: hash0;
    let sk_u: hash0 = r_438 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    new r_450: hash0;
    let sk_u: hash0 = r_450 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  else
    new r1_90: hash1;
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_236[j], r1_90[j], r_450[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    if (auth_s = r1_90[j]) then
    let sk_s: hash0 = r_450[j]
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_X_3743[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_X_3743[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3743[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new @1_X_3956: G;
  let Xp: G = @1_X_3956 in
  new @1_X_3894: G;
  let Yp: G = cst_G in
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_X_3743[@i_198]) && ((@2_x = @1_X_3743[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(@1_X_3894[@i_190], Yp[@i_190], @2_r2_163[@i_190]) && otheruses(@1_X_3894[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = @1_X_3894[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_X_3743[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_X_3743[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_X_3743[@i_186])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@1_X_3894[@i_178], Yp[@i_178], @2_r2_163[@i_178]) && otheruses(@1_X_3894[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], @1_X_3894[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_X_3743: G;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_X_3743)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying simplify yields

Game 42 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_X_3743[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_X_3743[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    new r_450: hash0;
    let sk_u: hash0 = r_450 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  else
    new r1_90: hash1;
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_236[j], r1_90[j], r_450[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    if (auth_s = r1_90[j]) then
    let sk_s: hash0 = r_450[j]
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_X_3743[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_X_3743[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3743[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new @1_X_3956: G;
  let Xp: G = @1_X_3956 in
  let Yp: G = cst_G in
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_X_3743[@i_198]) && ((@2_x = @1_X_3743[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_X_3743[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_X_3743[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_X_3743[@i_186])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_X_3743: G;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_X_3743)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of useless yields

Game 43 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_X_3743[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_X_3743[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    new r_450: hash0;
    let sk_u: hash0 = r_450 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  else
    new r1_90: hash1;
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_236[j], r1_90[j], r_450[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    if (auth_s = r1_90[j]) then
    let sk_s: hash0 = r_450[j]
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_X_3743[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_X_3743[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3743[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new @1_X_3956: G;
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, @1_X_3956, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_X_3743[@i_198]) && ((@2_x = @1_X_3743[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_X_3743[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_X_3743[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_X_3743[@i_186])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_X_3743: G;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_X_3743)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
 yields

Game 44 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_X_3743[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_X_3743[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    new r_450: hash0;
    let sk_u: hash0 = r_450 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  else
    new r1_90: hash1;
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new @1_X_4096: G;
  let Y: G = @1_X_4096 in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_236[j], r1_90[j], r_450[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    if (auth_s = r1_90[j]) then
    let sk_s: hash0 = r_450[j]
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_X_3743[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_X_3743[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3743[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new @1_X_3956: G;
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, @1_X_3956, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_X_3743[@i_198]) && ((@2_x = @1_X_3743[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_X_3743[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_X_3743[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_X_3743[@i_186])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_X_3743: G;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_X_3743)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of useless yields

Game 45 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_X_3743[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_X_3743[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_236 <= NS suchthat defined(@1_X_4096[@i_236], Y[@i_236], @2_r2_169[@i_236]) && otheruses(@1_X_4096[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    new r_450: hash0;
    let sk_u: hash0 = r_450 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  else
    new r1_90: hash1;
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new @1_X_4096: G;
  let Y: G = cst_G in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_236[j], r1_90[j], r_450[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    if (auth_s = r1_90[j]) then
    let sk_s: hash0 = r_450[j]
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_X_3743[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_X_3743[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3743[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(@1_X_4096 -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_4096 = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new @1_X_3956: G;
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, @1_X_3956, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_X_3743[@i_198]) && ((@2_x = @1_X_3743[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_188 <= NS suchthat defined(@1_X_4096[@i_188], Y[@i_188], @2_r2_169[@i_188]) && otheruses(@1_X_4096[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = @1_X_4096[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_X_3743[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_X_3743[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_X_3743[@i_186])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_176 <= NS suchthat defined(@1_X_4096[@i_176], Y[@i_176], @2_r2_169[@i_176]) && otheruses(@1_X_4096[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], @1_X_4096[@i_176])
  else
    new @1_X_3743: G;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_X_3743)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
 yields

Game 46 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new @1_X_4140: G;
  let X: G = @1_X_4140 in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_X_3743[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_X_3743[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_236 <= NS suchthat defined(@1_X_4096[@i_236], Y[@i_236], @2_r2_169[@i_236]) && otheruses(@1_X_4096[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    new r_450: hash0;
    let sk_u: hash0 = r_450 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  else
    new r1_90: hash1;
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new @1_X_4096: G;
  let Y: G = cst_G in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_236[j], r1_90[j], r_450[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    if (auth_s = r1_90[j]) then
    let sk_s: hash0 = r_450[j]
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_X_3743[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_X_3743[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3743[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(@1_X_4096 -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_4096 = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new @1_X_3956: G;
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, @1_X_3956, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_X_3743[@i_198]) && ((@2_x = @1_X_3743[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_188 <= NS suchthat defined(@1_X_4096[@i_188], Y[@i_188], @2_r2_169[@i_188]) && otheruses(@1_X_4096[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = @1_X_4096[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_X_3743[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_X_3743[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_X_3743[@i_186])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_176 <= NS suchthat defined(@1_X_4096[@i_176], Y[@i_176], @2_r2_169[@i_176]) && otheruses(@1_X_4096[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], @1_X_4096[@i_176])
  else
    new @1_X_3743: G;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_X_3743)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying simplify yields

Game 47 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new @1_X_4140: G;
  let X: G = @1_X_4140 in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_X_3743[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_X_3743[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  else
    new r1_90: hash1;
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  let Y: G = cst_G in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
    yield
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_X_3743[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_X_3743[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3743[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
    event Auth
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new @1_X_3956: G;
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, @1_X_3956, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_X_3743[@i_198]) && ((@2_x = @1_X_3743[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_X_3743[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_X_3743[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_X_3743[@i_186])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  else
    new @1_X_3743: G;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_X_3743)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying move all binders yields

Game 48 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new @1_X_4140: G;
  let X: G = @1_X_4140 in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_X_3743[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_X_3743[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  else
    new r1_90: hash1;
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
    yield
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_X_3743[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_X_3743[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3743[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
    event Auth
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new @1_X_3956: G;
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, @1_X_3956, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_X_3743[@i_198]) && ((@2_x = @1_X_3743[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_X_3743[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_X_3743[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_X_3743[@i_186])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  else
    new @1_X_3743: G;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_X_3743)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of useless yields

Game 49 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new @1_X_4140: G;
  let X: G = cst_G in
  out(c2[!_41], (U, @1_X_4140));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_X_3743[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_X_3743[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_4247: hash1;
    out(c6[!_41], r1_4247)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  else
    new r1_4246: hash1;
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    out(c6[!_41], r1_4246)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(@1_X_4140[j], X[j]) && (@1_X_4140[j] = X_s) then
    yield
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_X_3743[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_X_3743[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3743[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
    event Auth
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new @1_X_3956: G;
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, @1_X_3956, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_X_3743[@i_198]) && ((@2_x = @1_X_3743[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_X_3743[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_X_3743[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_X_3743[@i_186])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  else
    new @1_X_3743: G;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_X_3743)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)

RESULT time(context for game 31) = 0
RESULT Could not prove event Encrypt ==> false in game 15, event Auth ==> false in game 10.
{493}in(start, ());
{492}new pw: passwd;
{491}out(c8, {490}());
{489}(
{484}  ! !_41 <= NU
{483}  in(c1[{482}!_41], ());
{481}  new @1_X_4140: G;
{480}  let X: G = {479}cst_G in
{478}  out(c2[{477}!_41], {476}({473}U, {475}@1_X_4140));
{472}  in(c5[{471}!_41], (={470}S, Ystar_u: G));
{469}  find [unique] @i_246 <= qD suchthat defined(@2_m[{436}@i_246], @2_kd[{438}@i_246], @1_X_3743[{440}@i_246], @2_r4_157[{442}@i_246]) && otheruses(@2_m[{434}@i_246] -> @1_X_3743[{432}@i_246]) && {430}({424}({420}Ystar_u = {423}@2_m[{422}@i_246]) && {429}({425}pw = {428}@2_kd[{427}@i_246])) then
  (
{418}    new r_414: hash0;
{417}    let sk_u: hash0 = {416}r_414 in
{414}    new r1_4247: hash1;
{413}    out(c6[{412}!_41], {411}r1_4247)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[{464}@i_239], @2_ke[{466}@i_239], @2_x[{468}@i_239]) && otheruses(@2_x[{462}@i_239] -> @2_r2_160[{460}@i_239]) && {458}({452}({448}Ystar_u = {451}@2_r2_160[{450}@i_239]) && {457}({453}pw = {456}@2_ke[{455}@i_239])) then
{446}    event {445}Encrypt
  else
{407}    new r1_4246: hash1;
{406}    new r_408: hash0;
{405}    let sk_u: hash0 = {404}r_408 in
{402}    out(c6[{401}!_41], {400}r1_4246)
) | (
{395}  ! !_42 <= NS
{394}  in(c3[{393}!_42], (={392}U, X_s: G));
{391}  new @2_r2_169: G;
{390}  out(c4[{389}!_42], {388}({385}S, {387}@2_r2_169));
{384}  in(c7[{383}!_42], auth_s: hash1);
{382}  find j <= NU suchthat defined(@1_X_4140[{379}j], X[{381}j]) && {377}({374}@1_X_4140[{373}j] = {376}X_s) then
{371}    yield
  else
{370}    find [unique] @i_222 <= qD suchthat defined(@2_m[{363}@i_222], @2_kd[{365}@i_222], @1_X_3743[{367}@i_222], @2_r4_157[{369}@i_222]) && otheruses(@2_m[{361}@i_222] -> @1_X_3743[{359}@i_222]) && {357}({351}({347}@2_r2_169 = {350}@2_m[{349}@i_222]) && {356}({352}pw = {355}@2_kd[{354}@i_222])) then
{345}    find nj <= qH1 suchthat defined(x11[{336}nj], x12[{338}nj], x13[{340}nj], x14[{342}nj], r1_66[{344}nj]) && {334}({306}({302}U = {305}x11[{304}nj]) && {333}({311}({307}S = {310}x12[{309}nj]) && {332}({317}({313}X_s = {316}x13[{315}nj]) && {331}({324}({320}@1_X_3743[{319}@i_222] = {323}x14[{322}nj]) && {330}({326}auth_s = {329}r1_66[{328}nj]))))) then
{301}    event {300}Auth
) | (
{295}  ! !_43 <= NP
{294}  in(cp[{293}!_43], ());
{292}  new @1_X_3956: G;
{291}  new @2_r2_163: G;
{290}  new r1_72: hash1;
{289}  new r_390: hash0;
{288}  let sk_p: hash0 = {287}r_390 in
{285}  out(cp[{284}!_43], {283}({275}U, {277}@1_X_3956, {278}S, {280}@2_r2_163, {282}r1_72))
) | (
{271}  ! !_44 <= qE
{270}  in(@2_c1[{269}!_44], (@2_x: G, @2_ke: passwd));
{268}  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[{232}@i_198], @2_kd[{234}@i_198], @2_m[{236}@i_198], @2_r4_157[{238}@i_198]) && otheruses(@2_m[{230}@i_198] -> @1_X_3743[{228}@i_198]) && {226}({219}({215}@2_x = {218}@1_X_3743[{217}@i_198]) && {225}({221}@2_ke = {224}@2_kd[{223}@i_198])) then
{213}    out(@2_c2[{212}!_44], {211}@2_m[{210}@i_198])
  orfind @i_191 <= qE suchthat defined(@2_x[{263}@i_191], @2_ke[{265}@i_191], @2_r2_160[{267}@i_191]) && otheruses(@2_x[{261}@i_191] -> @2_r2_160[{259}@i_191]) && {257}({250}({246}@2_x = {249}@2_x[{248}@i_191]) && {256}({252}@2_ke = {255}@2_ke[{254}@i_191])) then
{244}    out(@2_c2[{243}!_44], {242}@2_r2_160[{241}@i_191])
  else
{207}    new @2_r2_160: G;
{206}    out(@2_c2[{205}!_44], {204}@2_r2_160)
) | (
{201}  ! !_45 <= qD
{200}  in(@2_c3[{199}!_45], (@2_m: G, @2_kd: passwd));
{198}  find [unique] @i_186 <= qD suchthat defined(@2_m[{162}@i_186], @2_kd[{164}@i_186], @1_X_3743[{166}@i_186], @2_r4_157[{168}@i_186]) && otheruses(@2_m[{160}@i_186] -> @1_X_3743[{158}@i_186]) && {156}({149}({145}@2_m = {148}@2_m[{147}@i_186]) && {155}({151}@2_kd = {154}@2_kd[{153}@i_186])) then
{143}    out(@2_c4[{142}!_45], {141}@1_X_3743[{140}@i_186])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[{193}@i_179], @2_ke[{195}@i_179], @2_x[{197}@i_179]) && otheruses(@2_x[{191}@i_179] -> @2_r2_160[{189}@i_179]) && {187}({180}({176}@2_m = {179}@2_r2_160[{178}@i_179]) && {186}({182}@2_kd = {185}@2_ke[{184}@i_179])) then
{174}    out(@2_c4[{173}!_45], {172}@2_x[{171}@i_179])
  else
{137}    new @1_X_3743: G;
{136}    let @2_r4_157: G = {135}cst_G in
{134}    out(@2_c4[{133}!_45], {132}@1_X_3743)
) | (
{128}  ! !_46 <= qH0
{127}  in(c10[{126}!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
{125}  find [unique] @i_474 <= qH0 suchthat defined(x1[{114}@i_474], x2[{116}@i_474], x3[{118}@i_474], x4[{120}@i_474], x5[{122}@i_474], r_384[{124}@i_474]) && otheruses(r_384[{112}@i_474]) && {110}({82}({78}x1 = {81}x1[{80}@i_474]) && {109}({88}({84}x2 = {87}x2[{86}@i_474]) && {108}({94}({90}x3 = {93}x3[{92}@i_474]) && {107}({100}({96}x4 = {99}x4[{98}@i_474]) && {106}({102}x5 = {105}x5[{104}@i_474]))))) then
{76}    out(c20[{75}!_46], {74}r_384[{73}@i_474])
  else
{70}    new r_384: hash0;
{69}    out(c20[{68}!_46], {67}r_384)
) | (
{64}  ! !_47 <= qH1
{63}  in(c11[{62}!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
{61}  find [unique] @i_100 <= qH1 suchthat defined(x11[{50}@i_100], x12[{52}@i_100], x13[{54}@i_100], x14[{56}@i_100], x15[{58}@i_100], r1_66[{60}@i_100]) && otheruses(r1_66[{48}@i_100]) && {46}({18}({14}x11 = {17}x11[{16}@i_100]) && {45}({24}({20}x12 = {23}x12[{22}@i_100]) && {44}({30}({26}x13 = {29}x13[{28}@i_100]) && {43}({36}({32}x14 = {35}x14[{34}@i_100]) && {42}({38}x15 = {41}x15[{40}@i_100]))))) then
{12}    out(c21[{11}!_47], {10}r1_66[{9}@i_100])
  else
{6}    new r1_66: hash1;
{5}    out(c21[{4}!_47], {3}r1_66)
)

Doing insert instruction find i1 <= qD, i2 <= qH1 suchthat defined(@2_m[i1], @2_kd[i1], @1_X_3743[i1], x11[i2], x12[i2], x13[i2], x14[i2], r1_66[i2]) && (@2_r2_169 = @2_m[i1]) && (U = x11[i2]) && (S = x12[i2]) && (X_s = x13[i2]) && (@1_X_3743[i1] = x14[i2]) && (auth_s = r1_66[i2]) && (pw = @2_kd[i1]) then at occurrence 370... Done.
{631}in(start, ());
{630}new pw: passwd;
{629}out(c8, {628}());
{627}(
{622}  ! !_41 <= NU
{621}  in(c1[{620}!_41], ());
{619}  new @1_X_4140: G;
{618}  let X: G = {617}cst_G in
{616}  out(c2[{615}!_41], {614}({611}U, {613}@1_X_4140));
{610}  in(c5[{609}!_41], (={608}S, Ystar_u: G));
{607}  find [unique] @i_246 <= qD suchthat defined(@2_m[{574}@i_246], @2_kd[{576}@i_246], @1_X_3743[{578}@i_246], @2_r4_157[{580}@i_246]) && otheruses(@2_m[{572}@i_246] -> @1_X_3743[{570}@i_246]) && {568}({562}({558}Ystar_u = {561}@2_m[{560}@i_246]) && {567}({563}pw = {566}@2_kd[{565}@i_246])) then
  (
{556}    new r_414: hash0;
{555}    let sk_u: hash0 = {554}r_414 in
{552}    new r1_4247: hash1;
{551}    out(c6[{550}!_41], {549}r1_4247)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[{602}@i_239], @2_ke[{604}@i_239], @2_x[{606}@i_239]) && otheruses(@2_x[{600}@i_239] -> @2_r2_160[{598}@i_239]) && {596}({590}({586}Ystar_u = {589}@2_r2_160[{588}@i_239]) && {595}({591}pw = {594}@2_ke[{593}@i_239])) then
{584}    event {583}Encrypt
  else
{545}    new r1_4246: hash1;
{544}    new r_408: hash0;
{543}    let sk_u: hash0 = {542}r_408 in
{540}    out(c6[{539}!_41], {538}r1_4246)
) | (
{533}  ! !_42 <= NS
{532}  in(c3[{531}!_42], (={530}U, X_s: G));
{529}  new @2_r2_169: G;
{528}  out(c4[{527}!_42], {526}({523}S, {525}@2_r2_169));
{522}  in(c7[{521}!_42], auth_s: hash1);
{520}  find j <= NU suchthat defined(@1_X_4140[{517}j], X[{519}j]) && {515}({512}@1_X_4140[{511}j] = {514}X_s) then
{509}    yield
  else
{508}    find i1 <= qD, i2 <= qH1 suchthat defined(@2_m[{493}i1], @2_kd[{495}i1], @1_X_3743[{497}i1], x11[{499}i2], x12[{501}i2], x13[{503}i2], x14[{505}i2], r1_66[{507}i2]) && {491}({451}({447}@2_r2_169 = {450}@2_m[{449}i1]) && {490}({456}({452}U = {455}x11[{454}i2]) && {489}({461}({457}S = {460}x12[{459}i2]) && {488}({467}({463}X_s = {466}x13[{465}i2]) && {487}({474}({470}@1_X_3743[{469}i1] = {473}x14[{472}i2]) && {486}({480}({476}auth_s = {479}r1_66[{478}i2]) && {485}({481}pw = {484}@2_kd[{483}i1]))))))) then
    (
{445}      find [unique] @i_222 <= qD suchthat defined(@2_m[{438}@i_222], @2_kd[{440}@i_222], @1_X_3743[{442}@i_222], @2_r4_157[{444}@i_222]) && otheruses(@2_m[{436}@i_222] -> @1_X_3743[{434}@i_222]) && {432}({426}({422}@2_r2_169 = {425}@2_m[{424}@i_222]) && {431}({427}pw = {430}@2_kd[{429}@i_222])) then
{420}      find nj <= qH1 suchthat defined(x11[{411}nj], x12[{413}nj], x13[{415}nj], x14[{417}nj], r1_66[{419}nj]) && {409}({381}({377}U = {380}x11[{379}nj]) && {408}({386}({382}S = {385}x12[{384}nj]) && {407}({392}({388}X_s = {391}x13[{390}nj]) && {406}({399}({395}@1_X_3743[{394}@i_222] = {398}x14[{397}nj]) && {405}({401}auth_s = {404}r1_66[{403}nj]))))) then
{376}      event {375}Auth
    )
    else
{370}      find [unique] @i_222 <= qD suchthat defined(@2_m[{363}@i_222], @2_kd[{365}@i_222], @1_X_3743[{367}@i_222], @2_r4_157[{369}@i_222]) && otheruses(@2_m[{361}@i_222] -> @1_X_3743[{359}@i_222]) && {357}({351}({347}@2_r2_169 = {350}@2_m[{349}@i_222]) && {356}({352}pw = {355}@2_kd[{354}@i_222])) then
{345}      find nj <= qH1 suchthat defined(x11[{336}nj], x12[{338}nj], x13[{340}nj], x14[{342}nj], r1_66[{344}nj]) && {334}({306}({302}U = {305}x11[{304}nj]) && {333}({311}({307}S = {310}x12[{309}nj]) && {332}({317}({313}X_s = {316}x13[{315}nj]) && {331}({324}({320}@1_X_3743[{319}@i_222] = {323}x14[{322}nj]) && {330}({326}auth_s = {329}r1_66[{328}nj]))))) then
{301}      event {300}Auth
) | (
{295}  ! !_43 <= NP
{294}  in(cp[{293}!_43], ());
{292}  new @1_X_3956: G;
{291}  new @2_r2_163: G;
{290}  new r1_72: hash1;
{289}  new r_390: hash0;
{288}  let sk_p: hash0 = {287}r_390 in
{285}  out(cp[{284}!_43], {283}({275}U, {277}@1_X_3956, {278}S, {280}@2_r2_163, {282}r1_72))
) | (
{271}  ! !_44 <= qE
{270}  in(@2_c1[{269}!_44], (@2_x: G, @2_ke: passwd));
{268}  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[{232}@i_198], @2_kd[{234}@i_198], @2_m[{236}@i_198], @2_r4_157[{238}@i_198]) && otheruses(@2_m[{230}@i_198] -> @1_X_3743[{228}@i_198]) && {226}({219}({215}@2_x = {218}@1_X_3743[{217}@i_198]) && {225}({221}@2_ke = {224}@2_kd[{223}@i_198])) then
{213}    out(@2_c2[{212}!_44], {211}@2_m[{210}@i_198])
  orfind @i_191 <= qE suchthat defined(@2_x[{263}@i_191], @2_ke[{265}@i_191], @2_r2_160[{267}@i_191]) && otheruses(@2_x[{261}@i_191] -> @2_r2_160[{259}@i_191]) && {257}({250}({246}@2_x = {249}@2_x[{248}@i_191]) && {256}({252}@2_ke = {255}@2_ke[{254}@i_191])) then
{244}    out(@2_c2[{243}!_44], {242}@2_r2_160[{241}@i_191])
  else
{207}    new @2_r2_160: G;
{206}    out(@2_c2[{205}!_44], {204}@2_r2_160)
) | (
{201}  ! !_45 <= qD
{200}  in(@2_c3[{199}!_45], (@2_m: G, @2_kd: passwd));
{198}  find [unique] @i_186 <= qD suchthat defined(@2_m[{162}@i_186], @2_kd[{164}@i_186], @1_X_3743[{166}@i_186], @2_r4_157[{168}@i_186]) && otheruses(@2_m[{160}@i_186] -> @1_X_3743[{158}@i_186]) && {156}({149}({145}@2_m = {148}@2_m[{147}@i_186]) && {155}({151}@2_kd = {154}@2_kd[{153}@i_186])) then
{143}    out(@2_c4[{142}!_45], {141}@1_X_3743[{140}@i_186])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[{193}@i_179], @2_ke[{195}@i_179], @2_x[{197}@i_179]) && otheruses(@2_x[{191}@i_179] -> @2_r2_160[{189}@i_179]) && {187}({180}({176}@2_m = {179}@2_r2_160[{178}@i_179]) && {186}({182}@2_kd = {185}@2_ke[{184}@i_179])) then
{174}    out(@2_c4[{173}!_45], {172}@2_x[{171}@i_179])
  else
{137}    new @1_X_3743: G;
{136}    let @2_r4_157: G = {135}cst_G in
{134}    out(@2_c4[{133}!_45], {132}@1_X_3743)
) | (
{128}  ! !_46 <= qH0
{127}  in(c10[{126}!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
{125}  find [unique] @i_474 <= qH0 suchthat defined(x1[{114}@i_474], x2[{116}@i_474], x3[{118}@i_474], x4[{120}@i_474], x5[{122}@i_474], r_384[{124}@i_474]) && otheruses(r_384[{112}@i_474]) && {110}({82}({78}x1 = {81}x1[{80}@i_474]) && {109}({88}({84}x2 = {87}x2[{86}@i_474]) && {108}({94}({90}x3 = {93}x3[{92}@i_474]) && {107}({100}({96}x4 = {99}x4[{98}@i_474]) && {106}({102}x5 = {105}x5[{104}@i_474]))))) then
{76}    out(c20[{75}!_46], {74}r_384[{73}@i_474])
  else
{70}    new r_384: hash0;
{69}    out(c20[{68}!_46], {67}r_384)
) | (
{64}  ! !_47 <= qH1
{63}  in(c11[{62}!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
{61}  find [unique] @i_100 <= qH1 suchthat defined(x11[{50}@i_100], x12[{52}@i_100], x13[{54}@i_100], x14[{56}@i_100], x15[{58}@i_100], r1_66[{60}@i_100]) && otheruses(r1_66[{48}@i_100]) && {46}({18}({14}x11 = {17}x11[{16}@i_100]) && {45}({24}({20}x12 = {23}x12[{22}@i_100]) && {44}({30}({26}x13 = {29}x13[{28}@i_100]) && {43}({36}({32}x14 = {35}x14[{34}@i_100]) && {42}({38}x15 = {41}x15[{40}@i_100]))))) then
{12}    out(c21[{11}!_47], {10}r1_66[{9}@i_100])
  else
{6}    new r1_66: hash1;
{5}    out(c21[{4}!_47], {3}r1_66)
)

Doing insert event Auth2 at occurrence 445... Done.
Doing move binder r1_4246... Done.
Doing simplify... Run simplify 2 time(s). Fixpoint reached.
Done.
Doing simplify with collision elimination at pw... Run simplify 3 time(s). Fixpoint reached.
Eliminated collisions between @2_r2_160 and @2_r2_160 Probability: 0.5 * qE * qE / |G|
Eliminated collisions between r1_66 and r1_66 Probability: 0.5 * qH1 * qH1 / |hash1|
Eliminated collisions between @1_X_3743 and @1_X_3743 Probability: 0.5 * qD * qD / |G|
Eliminated collisions between pw and @2_ke[!2_21202] Probability: NU / |passwd|
(pw characterizes a part of pw[...] of type(s) passwd;
 @2_ke[!2_21202] does not depend on pw[...])
Eliminated collisions between pw and @2_kd[!2_21194] Probability: NS / |passwd|
(pw characterizes a part of pw[...] of type(s) passwd;
 @2_kd[!2_21194] does not depend on pw[...])
Done.
Proved query event Auth ==> false in game 10
Proved query event Encrypt ==> false in game 15
Proved query event Auth2 ==> false in game -1
===================== Proof starts =======================
Initial state
Game 1 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let auth_u: hash1 = h1(U, S, X, Y_u, K_u) in
  let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
  event termU(U, X, S, Ystar_u, auth_u, sk_u);
  out(c6[!_41], auth_u)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_42], (S, Ystar));
  in(c7[!_42], auth_s: hash1);
  let K_s: G = exp(X_s, y) in
  if (auth_s = h1(U, S, X_s, Y, K_s)) then
  let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
  event termS(U, X_s, S, Ystar, auth_s, sk_s)
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let authp: hash1 = h1(U, S, Xp, Yp, Kp) in
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_43], (U, Xp, S, Ystarp, authp))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_44], enc(@2_x, @2_ke))
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_45], dec(@2_m, @2_kd))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_46], h0(x1, x2, x3, x4, x5))
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  out(c21[!_47], h1(x11, x12, x13, x14, x15))
)


Applying insert instruction find j <= NU suchthat defined(X[j]) && X[j] = X_s then at occurrence 172 yields

Game 2 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let auth_u: hash1 = h1(U, S, X, Y_u, K_u) in
  let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
  event termU(U, X, S, Ystar_u, auth_u, sk_u);
  out(c6[!_41], auth_u)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_42], (S, Ystar));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(X_s, y) in
    if (auth_s = h1(U, S, X_s, Y, K_s)) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  else
    let K_s: G = exp(X_s, y) in
    if (auth_s = h1(U, S, X_s, Y, K_s)) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let authp: hash1 = h1(U, S, Xp, Yp, Kp) in
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_43], (U, Xp, S, Ystarp, authp))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_44], enc(@2_x, @2_ke))
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_45], dec(@2_m, @2_kd))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_46], h0(x1, x2, x3, x4, x5))
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  out(c21[!_47], h1(x11, x12, x13, x14, x15))
)


Applying equivalence
equiv ! !_39 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h1(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_40 <= N (x1_56: host, x2_55: host, x3_54: G, x4_53: G, x5_52: G) -> let x1: host = x1_56 in let x2: host = x2_55 in let x3: G = x3_54 in let x4: G = x4_53 in let x5: G = x5_52 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r1[j]) && otheruses(r1[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r1[j] else new r1: hash1; r1
 yields

Game 3 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_95: host = U in
  let x2_94: host = S in
  let x3_93: G = X in
  let x4_92: G = Y_u in
  let x5_91: G = K_u in
  find [unique] @i_120 <= qH1 suchthat defined(x1_71[@i_120], x2_70[@i_120], x3_69[@i_120], x4_68[@i_120], x5_67[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x1_71[@i_120]) && ((x2_94 = x2_70[@i_120]) && ((x3_93 = x3_69[@i_120]) && ((x4_92 = x4_68[@i_120]) && (x5_91 = x5_67[@i_120]))))) then
  (
    let auth_u: hash1 = r1_66[@i_120] in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_41], auth_u)
  )
  orfind @i_119 <= NP suchthat defined(x1_77[@i_119], x2_76[@i_119], x3_75[@i_119], x4_74[@i_119], x5_73[@i_119], r1_72[@i_119]) && otheruses(r1_72[@i_119]) && ((x1_95 = x1_77[@i_119]) && ((x2_94 = x2_76[@i_119]) && ((x3_93 = x3_75[@i_119]) && ((x4_92 = x4_74[@i_119]) && (x5_91 = x5_73[@i_119]))))) then
  (
    let auth_u: hash1 = r1_72[@i_119] in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_41], auth_u)
  )
  orfind @i_118 <= NS suchthat defined(x1_83[@i_118], x2_82[@i_118], x3_81[@i_118], x4_80[@i_118], x5_79[@i_118], r1_78[@i_118]) && otheruses(r1_78[@i_118]) && ((x1_95 = x1_83[@i_118]) && ((x2_94 = x2_82[@i_118]) && ((x3_93 = x3_81[@i_118]) && ((x4_92 = x4_80[@i_118]) && (x5_91 = x5_79[@i_118]))))) then
  (
    let auth_u: hash1 = r1_78[@i_118] in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_41], auth_u)
  )
  orfind @i_117 <= NS suchthat defined(x1_89[@i_117], x2_88[@i_117], x3_87[@i_117], x4_86[@i_117], x5_85[@i_117], r1_84[@i_117]) && otheruses(r1_84[@i_117]) && ((x1_95 = x1_89[@i_117]) && ((x2_94 = x2_88[@i_117]) && ((x3_93 = x3_87[@i_117]) && ((x4_92 = x4_86[@i_117]) && (x5_91 = x5_85[@i_117]))))) then
  (
    let auth_u: hash1 = r1_84[@i_117] in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_41], auth_u)
  )
  orfind @i_116 <= NU suchthat defined(x1_95[@i_116], x2_94[@i_116], x3_93[@i_116], x4_92[@i_116], x5_91[@i_116], r1_90[@i_116]) && otheruses(r1_90[@i_116]) && ((x1_95 = x1_95[@i_116]) && ((x2_94 = x2_94[@i_116]) && ((x3_93 = x3_93[@i_116]) && ((x4_92 = x4_92[@i_116]) && (x5_91 = x5_91[@i_116]))))) then
  (
    let auth_u: hash1 = r1_90[@i_116] in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_41], auth_u)
  )
  else
    new r1_90: hash1;
    let auth_u: hash1 = r1_90 in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_41], auth_u)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_42], (S, Ystar));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(X_s, y) in
    let x1_89: host = U in
    let x2_88: host = S in
    let x3_87: G = X_s in
    let x4_86: G = Y in
    let x5_85: G = K_s in
    find [unique] @i_115 <= qH1 suchthat defined(x1_71[@i_115], x2_70[@i_115], x3_69[@i_115], x4_68[@i_115], x5_67[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x1_71[@i_115]) && ((x2_88 = x2_70[@i_115]) && ((x3_87 = x3_69[@i_115]) && ((x4_86 = x4_68[@i_115]) && (x5_85 = x5_67[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind @i_114 <= NP suchthat defined(x1_77[@i_114], x2_76[@i_114], x3_75[@i_114], x4_74[@i_114], x5_73[@i_114], r1_72[@i_114]) && otheruses(r1_72[@i_114]) && ((x1_89 = x1_77[@i_114]) && ((x2_88 = x2_76[@i_114]) && ((x3_87 = x3_75[@i_114]) && ((x4_86 = x4_74[@i_114]) && (x5_85 = x5_73[@i_114]))))) then
    (
      if (auth_s = r1_72[@i_114]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind @i_113 <= NS suchthat defined(x1_83[@i_113], x2_82[@i_113], x3_81[@i_113], x4_80[@i_113], x5_79[@i_113], r1_78[@i_113]) && otheruses(r1_78[@i_113]) && ((x1_89 = x1_83[@i_113]) && ((x2_88 = x2_82[@i_113]) && ((x3_87 = x3_81[@i_113]) && ((x4_86 = x4_80[@i_113]) && (x5_85 = x5_79[@i_113]))))) then
    (
      if (auth_s = r1_78[@i_113]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind @i_112 <= NS suchthat defined(x1_89[@i_112], x2_88[@i_112], x3_87[@i_112], x4_86[@i_112], x5_85[@i_112], r1_84[@i_112]) && otheruses(r1_84[@i_112]) && ((x1_89 = x1_89[@i_112]) && ((x2_88 = x2_88[@i_112]) && ((x3_87 = x3_87[@i_112]) && ((x4_86 = x4_86[@i_112]) && (x5_85 = x5_85[@i_112]))))) then
    (
      if (auth_s = r1_84[@i_112]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind @i_111 <= NU suchthat defined(x1_95[@i_111], x2_94[@i_111], x3_93[@i_111], x4_92[@i_111], x5_91[@i_111], r1_90[@i_111]) && otheruses(r1_90[@i_111]) && ((x1_89 = x1_95[@i_111]) && ((x2_88 = x2_94[@i_111]) && ((x3_87 = x3_93[@i_111]) && ((x4_86 = x4_92[@i_111]) && (x5_85 = x5_91[@i_111]))))) then
    (
      if (auth_s = r1_90[@i_111]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    else
      new r1_84: hash1;
      if (auth_s = r1_84) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  else
    let K_s: G = exp(X_s, y) in
    let x1_83: host = U in
    let x2_82: host = S in
    let x3_81: G = X_s in
    let x4_80: G = Y in
    let x5_79: G = K_s in
    find [unique] @i_110 <= qH1 suchthat defined(x1_71[@i_110], x2_70[@i_110], x3_69[@i_110], x4_68[@i_110], x5_67[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x1_71[@i_110]) && ((x2_82 = x2_70[@i_110]) && ((x3_81 = x3_69[@i_110]) && ((x4_80 = x4_68[@i_110]) && (x5_79 = x5_67[@i_110]))))) then
    (
      if (auth_s = r1_66[@i_110]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind @i_109 <= NP suchthat defined(x1_77[@i_109], x2_76[@i_109], x3_75[@i_109], x4_74[@i_109], x5_73[@i_109], r1_72[@i_109]) && otheruses(r1_72[@i_109]) && ((x1_83 = x1_77[@i_109]) && ((x2_82 = x2_76[@i_109]) && ((x3_81 = x3_75[@i_109]) && ((x4_80 = x4_74[@i_109]) && (x5_79 = x5_73[@i_109]))))) then
    (
      if (auth_s = r1_72[@i_109]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind @i_108 <= NS suchthat defined(x1_83[@i_108], x2_82[@i_108], x3_81[@i_108], x4_80[@i_108], x5_79[@i_108], r1_78[@i_108]) && otheruses(r1_78[@i_108]) && ((x1_83 = x1_83[@i_108]) && ((x2_82 = x2_82[@i_108]) && ((x3_81 = x3_81[@i_108]) && ((x4_80 = x4_80[@i_108]) && (x5_79 = x5_79[@i_108]))))) then
    (
      if (auth_s = r1_78[@i_108]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind @i_107 <= NS suchthat defined(x1_89[@i_107], x2_88[@i_107], x3_87[@i_107], x4_86[@i_107], x5_85[@i_107], r1_84[@i_107]) && otheruses(r1_84[@i_107]) && ((x1_83 = x1_89[@i_107]) && ((x2_82 = x2_88[@i_107]) && ((x3_81 = x3_87[@i_107]) && ((x4_80 = x4_86[@i_107]) && (x5_79 = x5_85[@i_107]))))) then
    (
      if (auth_s = r1_84[@i_107]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind @i_106 <= NU suchthat defined(x1_95[@i_106], x2_94[@i_106], x3_93[@i_106], x4_92[@i_106], x5_91[@i_106], r1_90[@i_106]) && otheruses(r1_90[@i_106]) && ((x1_83 = x1_95[@i_106]) && ((x2_82 = x2_94[@i_106]) && ((x3_81 = x3_93[@i_106]) && ((x4_80 = x4_92[@i_106]) && (x5_79 = x5_91[@i_106]))))) then
    (
      if (auth_s = r1_90[@i_106]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    else
      new r1_78: hash1;
      if (auth_s = r1_78) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let x1_77: host = U in
  let x2_76: host = S in
  let x3_75: G = Xp in
  let x4_74: G = Yp in
  let x5_73: G = Kp in
  find [unique] @i_105 <= qH1 suchthat defined(x1_71[@i_105], x2_70[@i_105], x3_69[@i_105], x4_68[@i_105], x5_67[@i_105], r1_66[@i_105]) && otheruses(r1_66[@i_105]) && ((x1_77 = x1_71[@i_105]) && ((x2_76 = x2_70[@i_105]) && ((x3_75 = x3_69[@i_105]) && ((x4_74 = x4_68[@i_105]) && (x5_73 = x5_67[@i_105]))))) then
  (
    let authp: hash1 = r1_66[@i_105] in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_43], (U, Xp, S, Ystarp, authp))
  )
  orfind @i_104 <= NP suchthat defined(x1_77[@i_104], x2_76[@i_104], x3_75[@i_104], x4_74[@i_104], x5_73[@i_104], r1_72[@i_104]) && otheruses(r1_72[@i_104]) && ((x1_77 = x1_77[@i_104]) && ((x2_76 = x2_76[@i_104]) && ((x3_75 = x3_75[@i_104]) && ((x4_74 = x4_74[@i_104]) && (x5_73 = x5_73[@i_104]))))) then
  (
    let authp: hash1 = r1_72[@i_104] in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_43], (U, Xp, S, Ystarp, authp))
  )
  orfind @i_103 <= NS suchthat defined(x1_83[@i_103], x2_82[@i_103], x3_81[@i_103], x4_80[@i_103], x5_79[@i_103], r1_78[@i_103]) && otheruses(r1_78[@i_103]) && ((x1_77 = x1_83[@i_103]) && ((x2_76 = x2_82[@i_103]) && ((x3_75 = x3_81[@i_103]) && ((x4_74 = x4_80[@i_103]) && (x5_73 = x5_79[@i_103]))))) then
  (
    let authp: hash1 = r1_78[@i_103] in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_43], (U, Xp, S, Ystarp, authp))
  )
  orfind @i_102 <= NS suchthat defined(x1_89[@i_102], x2_88[@i_102], x3_87[@i_102], x4_86[@i_102], x5_85[@i_102], r1_84[@i_102]) && otheruses(r1_84[@i_102]) && ((x1_77 = x1_89[@i_102]) && ((x2_76 = x2_88[@i_102]) && ((x3_75 = x3_87[@i_102]) && ((x4_74 = x4_86[@i_102]) && (x5_73 = x5_85[@i_102]))))) then
  (
    let authp: hash1 = r1_84[@i_102] in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_43], (U, Xp, S, Ystarp, authp))
  )
  orfind @i_101 <= NU suchthat defined(x1_95[@i_101], x2_94[@i_101], x3_93[@i_101], x4_92[@i_101], x5_91[@i_101], r1_90[@i_101]) && otheruses(r1_90[@i_101]) && ((x1_77 = x1_95[@i_101]) && ((x2_76 = x2_94[@i_101]) && ((x3_75 = x3_93[@i_101]) && ((x4_74 = x4_92[@i_101]) && (x5_73 = x5_91[@i_101]))))) then
  (
    let authp: hash1 = r1_90[@i_101] in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_43], (U, Xp, S, Ystarp, authp))
  )
  else
    new r1_72: hash1;
    let authp: hash1 = r1_72 in
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_43], (U, Xp, S, Ystarp, authp))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_44], enc(@2_x, @2_ke))
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_45], dec(@2_m, @2_kd))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_46], h0(x1, x2, x3, x4, x5))
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_71: host = x11 in
  let x2_70: host = x12 in
  let x3_69: G = x13 in
  let x4_68: G = x14 in
  let x5_67: G = x15 in
  find [unique] @i_100 <= qH1 suchthat defined(x1_71[@i_100], x2_70[@i_100], x3_69[@i_100], x4_68[@i_100], x5_67[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x1_71 = x1_71[@i_100]) && ((x2_70 = x2_70[@i_100]) && ((x3_69 = x3_69[@i_100]) && ((x4_68 = x4_68[@i_100]) && (x5_67 = x5_67[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], x3_75[@i_99], x4_74[@i_99], x5_73[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x1_71 = x1_77[@i_99]) && ((x2_70 = x2_76[@i_99]) && ((x3_69 = x3_75[@i_99]) && ((x4_68 = x4_74[@i_99]) && (x5_67 = x5_73[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_98 <= NS suchthat defined(x1_83[@i_98], x2_82[@i_98], x3_81[@i_98], x4_80[@i_98], x5_79[@i_98], r1_78[@i_98]) && otheruses(r1_78[@i_98]) && ((x1_71 = x1_83[@i_98]) && ((x2_70 = x2_82[@i_98]) && ((x3_69 = x3_81[@i_98]) && ((x4_68 = x4_80[@i_98]) && (x5_67 = x5_79[@i_98]))))) then
    out(c21[!_47], r1_78[@i_98])
  orfind @i_97 <= NS suchthat defined(x1_89[@i_97], x2_88[@i_97], x3_87[@i_97], x4_86[@i_97], x5_85[@i_97], r1_84[@i_97]) && otheruses(r1_84[@i_97]) && ((x1_71 = x1_89[@i_97]) && ((x2_70 = x2_88[@i_97]) && ((x3_69 = x3_87[@i_97]) && ((x4_68 = x4_86[@i_97]) && (x5_67 = x5_85[@i_97]))))) then
    out(c21[!_47], r1_84[@i_97])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], x3_93[@i_96], x4_92[@i_96], x5_91[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x1_71 = x1_95[@i_96]) && ((x2_70 = x2_94[@i_96]) && ((x3_69 = x3_93[@i_96]) && ((x4_68 = x4_92[@i_96]) && (x5_67 = x5_91[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying simplify [Excluding set(dist 3->4, proba <= 1. / |exponent| * NP + 4. * 1. / |exponent| * NS + 2. * NU * NP / |exponent| + 3. * NS * NP / |exponent| + qH1 * NP / |exponent| + 2. * NS / |hash1| + NP * NP / |exponent| + 0.5 * NS * NS / |exponent| + 0.5 * NU * NU / |exponent|)] yields

Game 4 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_95: host = U in
  let x2_94: host = S in
  let x3_93: G = X in
  let x4_92: G = Y_u in
  let x5_91: G = K_u in
  find [unique] @i_120 <= qH1 suchthat defined(x1_71[@i_120], x2_70[@i_120], x3_69[@i_120], x4_68[@i_120], x5_67[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x1_71[@i_120]) && ((x2_94 = x2_70[@i_120]) && ((x3_93 = x3_69[@i_120]) && ((x4_92 = x4_68[@i_120]) && (x5_91 = x5_67[@i_120]))))) then
  (
    let auth_u: hash1 = r1_66[@i_120] in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_41], auth_u)
  )
  else
    new r1_90: hash1;
    let auth_u: hash1 = r1_90 in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_41], auth_u)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_42], (S, Ystar));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    let x3_87: G = X_s in
    let x4_86: G = Y in
    let x5_85: G = K_s in
    find [unique] @i_115 <= qH1 suchthat defined(x1_71[@i_115], x2_70[@i_115], x3_69[@i_115], x4_68[@i_115], x5_67[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x1_71[@i_115]) && ((x2_88 = x2_70[@i_115]) && ((x3_87 = x3_69[@i_115]) && ((x4_86 = x4_68[@i_115]) && (x5_85 = x5_67[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind  suchthat defined(x4_92[j], x5_91[j], r1_90[j]) && otheruses(r1_90[j]) && ((x4_86 = x4_92[j]) && (x5_85 = x5_91[j])) then
    (
      let @i_111 <= NU = j in
      if (auth_s = r1_90[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  else
    let K_s: G = exp(X_s, y) in
    let x1_83: host = U in
    let x2_82: host = S in
    let x3_81: G = X_s in
    let x4_80: G = Y in
    let x5_79: G = K_s in
    find [unique] @i_110 <= qH1 suchthat defined(x1_71[@i_110], x2_70[@i_110], x3_69[@i_110], x4_68[@i_110], x5_67[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x1_71[@i_110]) && ((x2_82 = x2_70[@i_110]) && ((x3_81 = x3_69[@i_110]) && ((x4_80 = x4_68[@i_110]) && (x5_79 = x5_67[@i_110]))))) then
    if (auth_s = r1_66[@i_110]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let x1_77: host = U in
  let x2_76: host = S in
  let x3_75: G = Xp in
  let x4_74: G = Yp in
  let x5_73: G = Kp in
  new r1_72: hash1;
  let authp: hash1 = r1_72 in
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_43], (U, Xp, S, Ystarp, authp))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_44], enc(@2_x, @2_ke))
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_45], dec(@2_m, @2_kd))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_46], h0(x1, x2, x3, x4, x5))
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_71: host = x11 in
  let x2_70: host = x12 in
  let x3_69: G = x13 in
  let x4_68: G = x14 in
  let x5_67: G = x15 in
  find [unique] @i_100 <= qH1 suchthat defined(x1_71[@i_100], x2_70[@i_100], x3_69[@i_100], x4_68[@i_100], x5_67[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x1_71 = x1_71[@i_100]) && ((x2_70 = x2_70[@i_100]) && ((x3_69 = x3_69[@i_100]) && ((x4_68 = x4_68[@i_100]) && (x5_67 = x5_67[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], x3_75[@i_99], x4_74[@i_99], x5_73[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x1_71 = x1_77[@i_99]) && ((x2_70 = x2_76[@i_99]) && ((x3_69 = x3_75[@i_99]) && ((x4_68 = x4_74[@i_99]) && (x5_67 = x5_73[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], x3_93[@i_96], x4_92[@i_96], x5_91[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x1_71 = x1_95[@i_96]) && ((x2_70 = x2_94[@i_96]) && ((x3_69 = x3_93[@i_96]) && ((x4_68 = x4_92[@i_96]) && (x5_67 = x5_91[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying move all binders yields

Game 5 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_95: host = U in
  let x2_94: host = S in
  let x3_93: G = X in
  let x4_92: G = Y_u in
  let x5_91: G = K_u in
  find [unique] @i_120 <= qH1 suchthat defined(x1_71[@i_120], x2_70[@i_120], x3_69[@i_120], x4_68[@i_120], x5_67[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x1_71[@i_120]) && ((x2_94 = x2_70[@i_120]) && ((x3_93 = x3_69[@i_120]) && ((x4_92 = x4_68[@i_120]) && (x5_91 = x5_67[@i_120]))))) then
  (
    let auth_u: hash1 = r1_66[@i_120] in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_41], auth_u)
  )
  else
    new r1_90: hash1;
    let auth_u: hash1 = r1_90 in
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, auth_u, sk_u);
    out(c6[!_41], auth_u)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_42], (S, Ystar));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    let x3_87: G = X_s in
    let x4_86: G = Y in
    let x5_85: G = K_s in
    find [unique] @i_115 <= qH1 suchthat defined(x1_71[@i_115], x2_70[@i_115], x3_69[@i_115], x4_68[@i_115], x5_67[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x1_71[@i_115]) && ((x2_88 = x2_70[@i_115]) && ((x3_87 = x3_69[@i_115]) && ((x4_86 = x4_68[@i_115]) && (x5_85 = x5_67[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind  suchthat defined(x4_92[j], x5_91[j], r1_90[j]) && otheruses(r1_90[j]) && ((x4_86 = x4_92[j]) && (x5_85 = x5_91[j])) then
    (
      if (auth_s = r1_90[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  else
    let K_s: G = exp(X_s, y) in
    let x1_83: host = U in
    let x2_82: host = S in
    let x3_81: G = X_s in
    let x4_80: G = Y in
    let x5_79: G = K_s in
    find [unique] @i_110 <= qH1 suchthat defined(x1_71[@i_110], x2_70[@i_110], x3_69[@i_110], x4_68[@i_110], x5_67[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x1_71[@i_110]) && ((x2_82 = x2_70[@i_110]) && ((x3_81 = x3_69[@i_110]) && ((x4_80 = x4_68[@i_110]) && (x5_79 = x5_67[@i_110]))))) then
    if (auth_s = r1_66[@i_110]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let x1_77: host = U in
  let x2_76: host = S in
  let x3_75: G = Xp in
  let x4_74: G = Yp in
  let x5_73: G = Kp in
  new r1_72: hash1;
  let authp: hash1 = r1_72 in
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_43], (U, Xp, S, Ystarp, authp))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_44], enc(@2_x, @2_ke))
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_45], dec(@2_m, @2_kd))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_46], h0(x1, x2, x3, x4, x5))
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_71: host = x11 in
  let x2_70: host = x12 in
  let x3_69: G = x13 in
  let x4_68: G = x14 in
  let x5_67: G = x15 in
  find [unique] @i_100 <= qH1 suchthat defined(x1_71[@i_100], x2_70[@i_100], x3_69[@i_100], x4_68[@i_100], x5_67[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x1_71 = x1_71[@i_100]) && ((x2_70 = x2_70[@i_100]) && ((x3_69 = x3_69[@i_100]) && ((x4_68 = x4_68[@i_100]) && (x5_67 = x5_67[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], x3_75[@i_99], x4_74[@i_99], x5_73[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x1_71 = x1_77[@i_99]) && ((x2_70 = x2_76[@i_99]) && ((x3_69 = x3_75[@i_99]) && ((x4_68 = x4_74[@i_99]) && (x5_67 = x5_73[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], x3_93[@i_96], x4_92[@i_96], x5_91[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x1_71 = x1_95[@i_96]) && ((x2_70 = x2_94[@i_96]) && ((x3_69 = x3_93[@i_96]) && ((x4_68 = x4_92[@i_96]) && (x5_67 = x5_91[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of useless yields

Game 6 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_95: host = U in
  let x2_94: host = S in
  let x3_93: G = cst_G in
  let x4_92: G = cst_G in
  let x5_91: G = cst_G in
  find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], x5_67[@i_120], x4_68[@i_120], x3_69[@i_120], x2_70[@i_120], x1_71[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
  (
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
    out(c6[!_41], r1_66[@i_120])
  )
  else
    new r1_90: hash1;
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_90, sk_u);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_42], (S, Ystar));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], x5_67[@i_115], x4_68[@i_115], x3_69[@i_115], x2_70[@i_115], x1_71[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], x5_91[j], x4_92[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_90[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  else
    let K_s: G = exp(X_s, y) in
    let x1_83: host = U in
    let x2_82: host = S in
    find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y = x14[@i_110]) && (K_s = x15[@i_110]))))) then
    if (auth_s = r1_66[@i_110]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let x1_77: host = U in
  let x2_76: host = S in
  let x3_75: G = cst_G in
  let x4_74: G = cst_G in
  let x5_73: G = cst_G in
  new r1_72: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_43], (U, Xp, S, Ystarp, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_44], enc(@2_x, @2_ke))
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_45], dec(@2_m, @2_kd))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_46], h0(x1, x2, x3, x4, x5))
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_71: host = cst_host in
  let x2_70: host = cst_host in
  let x3_69: G = cst_G in
  let x4_68: G = cst_G in
  let x5_67: G = cst_G in
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], x5_67[@i_100], x4_68[@i_100], x3_69[@i_100], x2_70[@i_100], x1_71[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(Xp[@i_99], Yp[@i_99], Kp[@i_99], x5_73[@i_99], x4_74[@i_99], x3_75[@i_99], x1_77[@i_99], x2_76[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(X[@i_96], Y_u[@i_96], K_u[@i_96], x5_91[@i_96], x4_92[@i_96], x3_93[@i_96], x1_95[@i_96], x2_94[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying insert instruction let Y' = dec(Ystar, pw) in at occurrence 429 yields

Game 7 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_95: host = U in
  let x2_94: host = S in
  let x3_93: G = cst_G in
  let x4_92: G = cst_G in
  let x5_91: G = cst_G in
  find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], x5_67[@i_120], x4_68[@i_120], x3_69[@i_120], x2_70[@i_120], x1_71[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
  (
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
    out(c6[!_41], r1_66[@i_120])
  )
  else
    new r1_90: hash1;
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_90, sk_u);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_42], (S, Ystar));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], x5_67[@i_115], x4_68[@i_115], x3_69[@i_115], x2_70[@i_115], x1_71[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], x5_91[j], x4_92[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_90[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  else
    let Y': G = dec(Ystar, pw) in
    let K_s: G = exp(X_s, y) in
    let x1_83: host = U in
    let x2_82: host = S in
    find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y = x14[@i_110]) && (K_s = x15[@i_110]))))) then
    if (auth_s = r1_66[@i_110]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let x1_77: host = U in
  let x2_76: host = S in
  let x3_75: G = cst_G in
  let x4_74: G = cst_G in
  let x5_73: G = cst_G in
  new r1_72: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_43], (U, Xp, S, Ystarp, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_44], enc(@2_x, @2_ke))
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_45], dec(@2_m, @2_kd))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_46], h0(x1, x2, x3, x4, x5))
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_71: host = cst_host in
  let x2_70: host = cst_host in
  let x3_69: G = cst_G in
  let x4_68: G = cst_G in
  let x5_67: G = cst_G in
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], x5_67[@i_100], x4_68[@i_100], x3_69[@i_100], x2_70[@i_100], x1_71[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(Xp[@i_99], Yp[@i_99], Kp[@i_99], x5_73[@i_99], x4_74[@i_99], x3_75[@i_99], x1_77[@i_99], x2_76[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(X[@i_96], Y_u[@i_96], K_u[@i_96], x5_91[@i_96], x4_92[@i_96], x3_93[@i_96], x1_95[@i_96], x2_94[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying replace term at occurrence 381 with Y' yields

Game 8 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_95: host = U in
  let x2_94: host = S in
  let x3_93: G = cst_G in
  let x4_92: G = cst_G in
  let x5_91: G = cst_G in
  find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], x5_67[@i_120], x4_68[@i_120], x3_69[@i_120], x2_70[@i_120], x1_71[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
  (
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
    out(c6[!_41], r1_66[@i_120])
  )
  else
    new r1_90: hash1;
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_90, sk_u);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_42], (S, Ystar));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], x5_67[@i_115], x4_68[@i_115], x3_69[@i_115], x2_70[@i_115], x1_71[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], x5_91[j], x4_92[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_90[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  else
    let Y': G = dec(Ystar, pw) in
    let K_s: G = exp(X_s, y) in
    let x1_83: host = U in
    let x2_82: host = S in
    find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
    if (auth_s = r1_66[@i_110]) then
    let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
    event termS(U, X_s, S, Ystar, auth_s, sk_s)
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let x1_77: host = U in
  let x2_76: host = S in
  let x3_75: G = cst_G in
  let x4_74: G = cst_G in
  let x5_73: G = cst_G in
  new r1_72: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_43], (U, Xp, S, Ystarp, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_44], enc(@2_x, @2_ke))
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_45], dec(@2_m, @2_kd))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_46], h0(x1, x2, x3, x4, x5))
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_71: host = cst_host in
  let x2_70: host = cst_host in
  let x3_69: G = cst_G in
  let x4_68: G = cst_G in
  let x5_67: G = cst_G in
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], x5_67[@i_100], x4_68[@i_100], x3_69[@i_100], x2_70[@i_100], x1_71[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(Xp[@i_99], Yp[@i_99], Kp[@i_99], x5_73[@i_99], x4_74[@i_99], x3_75[@i_99], x1_77[@i_99], x2_76[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(X[@i_96], Y_u[@i_96], K_u[@i_96], x5_91[@i_96], x4_92[@i_96], x3_93[@i_96], x1_95[@i_96], x2_94[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying insert instruction find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && (U = x11[nj]) && (S = x12[nj]) && (X_s = x13[nj]) && (Y' = x14[nj]) && (auth_s = r1_66[nj]) then at occurrence 430 yields

Game 9 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_95: host = U in
  let x2_94: host = S in
  let x3_93: G = cst_G in
  let x4_92: G = cst_G in
  let x5_91: G = cst_G in
  find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], x5_67[@i_120], x4_68[@i_120], x3_69[@i_120], x2_70[@i_120], x1_71[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
  (
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
    out(c6[!_41], r1_66[@i_120])
  )
  else
    new r1_90: hash1;
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_90, sk_u);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_42], (S, Ystar));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], x5_67[@i_115], x4_68[@i_115], x3_69[@i_115], x2_70[@i_115], x1_71[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], x5_91[j], x4_92[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_90[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  else
    let Y': G = dec(Ystar, pw) in
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
    (
      let K_s: G = exp(X_s, y) in
      let x1_83: host = U in
      let x2_82: host = S in
      find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
      if (auth_s = r1_66[@i_110]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    else
      let K_s: G = exp(X_s, y) in
      let x1_83: host = U in
      let x2_82: host = S in
      find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
      if (auth_s = r1_66[@i_110]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let x1_77: host = U in
  let x2_76: host = S in
  let x3_75: G = cst_G in
  let x4_74: G = cst_G in
  let x5_73: G = cst_G in
  new r1_72: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_43], (U, Xp, S, Ystarp, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_44], enc(@2_x, @2_ke))
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_45], dec(@2_m, @2_kd))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_46], h0(x1, x2, x3, x4, x5))
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_71: host = cst_host in
  let x2_70: host = cst_host in
  let x3_69: G = cst_G in
  let x4_68: G = cst_G in
  let x5_67: G = cst_G in
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], x5_67[@i_100], x4_68[@i_100], x3_69[@i_100], x2_70[@i_100], x1_71[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(Xp[@i_99], Yp[@i_99], Kp[@i_99], x5_73[@i_99], x4_74[@i_99], x3_75[@i_99], x1_77[@i_99], x2_76[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(X[@i_96], Y_u[@i_96], K_u[@i_96], x5_91[@i_96], x4_92[@i_96], x3_93[@i_96], x1_95[@i_96], x2_94[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying insert event Auth at occurrence 537 [Excluding set(event Auth in game 10)] yields

Game 10 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let Y_u: G = dec(Ystar_u, pw) in
  let K_u: G = exp(Y_u, x) in
  let x1_95: host = U in
  let x2_94: host = S in
  let x3_93: G = cst_G in
  let x4_92: G = cst_G in
  let x5_91: G = cst_G in
  find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], x5_67[@i_120], x4_68[@i_120], x3_69[@i_120], x2_70[@i_120], x1_71[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
  (
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
    out(c6[!_41], r1_66[@i_120])
  )
  else
    new r1_90: hash1;
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_90, sk_u);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let Ystar: G = enc(Y, pw) in
  out(c4[!_42], (S, Ystar));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], x5_67[@i_115], x4_68[@i_115], x3_69[@i_115], x2_70[@i_115], x1_71[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], x5_91[j], x4_92[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_90[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  else
    let Y': G = dec(Ystar, pw) in
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    else
      let K_s: G = exp(X_s, y) in
      let x1_83: host = U in
      let x2_82: host = S in
      find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
      if (auth_s = r1_66[@i_110]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let Ystarp: G = enc(Yp, pw) in
  let x1_77: host = U in
  let x2_76: host = S in
  let x3_75: G = cst_G in
  let x4_74: G = cst_G in
  let x5_73: G = cst_G in
  new r1_72: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_43], (U, Xp, S, Ystarp, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  out(@2_c2[!_44], enc(@2_x, @2_ke))
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  out(@2_c4[!_45], dec(@2_m, @2_kd))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_46], h0(x1, x2, x3, x4, x5))
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_71: host = cst_host in
  let x2_70: host = cst_host in
  let x3_69: G = cst_G in
  let x4_68: G = cst_G in
  let x5_67: G = cst_G in
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], x5_67[@i_100], x4_68[@i_100], x3_69[@i_100], x2_70[@i_100], x1_71[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(Xp[@i_99], Yp[@i_99], Kp[@i_99], x5_73[@i_99], x4_74[@i_99], x3_75[@i_99], x1_77[@i_99], x2_76[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(X[@i_96], Y_u[@i_96], K_u[@i_96], x5_91[@i_96], x4_92[@i_96], x3_93[@i_96], x1_95[@i_96], x2_94[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying equivalence
equiv ! !_29 <= @2_N @2_Oenc(@2_x: G, @2_ke: passwd) := enc(@2_x, @2_ke) [all], ! !_30 <= @2_N2 @2_Odec(@2_m: G, @2_kd: passwd) := dec(@2_m, @2_kd) [all]
<=(set(proba <= (@2_N + @2_N2) * (@2_N + @2_N2 - 1.) / |G|))=>
      ! !_31 <= @2_N @2_Oenc(@2_x_63: G, @2_ke_62: passwd) := let @2_x: G = @2_x_63 in let @2_ke: passwd = @2_ke_62 in find [unique] @2_j_33 <= @2_N suchthat defined(@2_x[@2_j_33], @2_ke[@2_j_33], @2_r2[@2_j_33]) && otheruses(@2_x[@2_j_33] -> @2_r2[@2_j_33]) && ((@2_x = @2_x[@2_j_33]) && (@2_ke = @2_ke[@2_j_33])) then @2_r2[@2_j_33] orfind @2_k_34 <= @2_N2 suchthat defined(@2_r4[@2_k_34], @2_m[@2_k_34], @2_kd[@2_k_34]) && otheruses(@2_m[@2_k_34] -> @2_r4[@2_k_34]) && ((@2_x = @2_r4[@2_k_34]) && (@2_ke = @2_kd[@2_k_34])) then @2_m[@2_k_34] else new @2_r2: G; @2_r2, ! !_32 <= @2_N2 @2_Odec(@2_m_65: G, @2_kd_64: passwd) := let @2_m: G = @2_m_65 in let @2_kd: passwd = @2_kd_64 in find [unique] @2_j_35 <= @2_N suchthat defined(@2_x[@2_j_35], @2_ke[@2_j_35], @2_r2[@2_j_35]) && otheruses(@2_x[@2_j_35] -> @2_r2[@2_j_35]) && ((@2_m = @2_r2[@2_j_35]) && (@2_kd = @2_ke[@2_j_35])) then @2_x[@2_j_35] orfind @2_k_36 <= @2_N2 suchthat defined(@2_r4[@2_k_36], @2_m[@2_k_36], @2_kd[@2_k_36]) && otheruses(@2_m[@2_k_36] -> @2_r4[@2_k_36]) && ((@2_m = @2_m[@2_k_36]) && (@2_kd = @2_kd[@2_k_36])) then @2_r4[@2_k_36] else new @2_r4: G; @2_r4
 [Excluding set(dist 10->11, proba <= (NP * NP + 2. * qE * NP + 2. * NU * NP + 4. * NS * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 4. * NS * qE + 2. * qD * qE + NU * NU + 4. * NS * NU + 2. * qD * NU + 4. * NS * NS + 4. * qD * NS + qD * qD + -1. * NP + -1. * qE + -1. * NU + -2. * NS + -1. * qD) / |G|)] yields

Game 11 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let @2_m_174: G = Ystar_u in
  let @2_kd_173: passwd = pw in
  find [unique] @i_246 <= qD suchthat defined(@2_r4_157[@i_246], @2_m_159[@i_246], @2_kd_158[@i_246]) && otheruses(@2_m_159[@i_246] -> @2_r4_157[@i_246]) && ((@2_m_174 = @2_m_159[@i_246]) && (@2_kd_173 = @2_kd_158[@i_246])) then
  (
    let Y_u: G = @2_r4_157[@i_246] in
    let K_u: G = exp(Y_u, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    let x3_93: G = cst_G in
    let x4_92: G = cst_G in
    let x5_91: G = cst_G in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], x5_67[@i_120], x4_68[@i_120], x3_69[@i_120], x2_70[@i_120], x1_71[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_243 <= NS suchthat defined(@2_r4_166[@i_243], @2_m_168[@i_243], @2_kd_167[@i_243]) && otheruses(@2_m_168[@i_243] -> @2_r4_166[@i_243]) && ((@2_m_174 = @2_m_168[@i_243]) && (@2_kd_173 = @2_kd_167[@i_243])) then
  (
    let Y_u: G = @2_r4_166[@i_243] in
    let K_u: G = exp(Y_u, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    let x3_93: G = cst_G in
    let x4_92: G = cst_G in
    let x5_91: G = cst_G in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], x5_67[@i_120], x4_68[@i_120], x3_69[@i_120], x2_70[@i_120], x1_71[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(@2_r4_172[@i_241], @2_m_174[@i_241], @2_kd_173[@i_241]) && otheruses(@2_m_174[@i_241] -> @2_r4_172[@i_241]) && ((@2_m_174 = @2_m_174[@i_241]) && (@2_kd_173 = @2_kd_173[@i_241])) then
  (
    let Y_u: G = @2_r4_172[@i_241] in
    let K_u: G = exp(Y_u, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    let x3_93: G = cst_G in
    let x4_92: G = cst_G in
    let x5_91: G = cst_G in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], x5_67[@i_120], x4_68[@i_120], x3_69[@i_120], x2_70[@i_120], x1_71[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_x_162[@i_239], @2_ke_161[@i_239], @2_r2_160[@i_239]) && otheruses(@2_x_162[@i_239] -> @2_r2_160[@i_239]) && ((@2_m_174 = @2_r2_160[@i_239]) && (@2_kd_173 = @2_ke_161[@i_239])) then
  (
    let Y_u: G = @2_x_162[@i_239] in
    let K_u: G = exp(Y_u, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    let x3_93: G = cst_G in
    let x4_92: G = cst_G in
    let x5_91: G = cst_G in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], x5_67[@i_120], x4_68[@i_120], x3_69[@i_120], x2_70[@i_120], x1_71[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_238 <= NP suchthat defined(@2_x_165[@i_238], @2_ke_164[@i_238], @2_r2_163[@i_238]) && otheruses(@2_x_165[@i_238] -> @2_r2_163[@i_238]) && ((@2_m_174 = @2_r2_163[@i_238]) && (@2_kd_173 = @2_ke_164[@i_238])) then
  (
    let Y_u: G = @2_x_165[@i_238] in
    let K_u: G = exp(Y_u, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    let x3_93: G = cst_G in
    let x4_92: G = cst_G in
    let x5_91: G = cst_G in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], x5_67[@i_120], x4_68[@i_120], x3_69[@i_120], x2_70[@i_120], x1_71[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_x_171[@i_236], @2_ke_170[@i_236], @2_r2_169[@i_236]) && otheruses(@2_x_171[@i_236] -> @2_r2_169[@i_236]) && ((@2_m_174 = @2_r2_169[@i_236]) && (@2_kd_173 = @2_ke_170[@i_236])) then
  (
    let Y_u: G = @2_x_171[@i_236] in
    let K_u: G = exp(Y_u, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    let x3_93: G = cst_G in
    let x4_92: G = cst_G in
    let x5_91: G = cst_G in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], x5_67[@i_120], x4_68[@i_120], x3_69[@i_120], x2_70[@i_120], x1_71[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  else
    new @2_r4_172: G;
    let Y_u: G = @2_r4_172 in
    let K_u: G = exp(Y_u, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    let x3_93: G = cst_G in
    let x4_92: G = cst_G in
    let x5_91: G = cst_G in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], x5_67[@i_120], x4_68[@i_120], x3_69[@i_120], x2_70[@i_120], x1_71[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let @2_x_171: G = Y in
  let @2_ke_170: passwd = pw in
  find [unique] @i_234 <= qD suchthat defined(@2_r4_157[@i_234], @2_m_159[@i_234], @2_kd_158[@i_234]) && otheruses(@2_m_159[@i_234] -> @2_r4_157[@i_234]) && ((@2_x_171 = @2_r4_157[@i_234]) && (@2_ke_170 = @2_kd_158[@i_234])) then
  (
    let Ystar: G = @2_m_159[@i_234] in
    out(c4[!_42], (S, Ystar));
    in(c7[!_42], auth_s: hash1);
    find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
    (
      let K_s: G = exp(g, mult(x[j], y)) in
      let x1_89: host = U in
      let x2_88: host = S in
      find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], x5_67[@i_115], x4_68[@i_115], x3_69[@i_115], x2_70[@i_115], x1_71[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
      (
        if (auth_s = r1_66[@i_115]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind  suchthat defined(Y_u[j], K_u[j], x5_91[j], x4_92[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
      (
        if (auth_s = r1_90[j]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
    )
    else
      let @2_m_168: G = Ystar in
      let @2_kd_167: passwd = pw in
      find [unique] @i_222 <= qD suchthat defined(@2_r4_157[@i_222], @2_m_159[@i_222], @2_kd_158[@i_222]) && otheruses(@2_m_159[@i_222] -> @2_r4_157[@i_222]) && ((@2_m_168 = @2_m_159[@i_222]) && (@2_kd_167 = @2_kd_158[@i_222])) then
      (
        let Y': G = @2_r4_157[@i_222] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_219 <= NS suchthat defined(@2_r4_166[@i_219], @2_m_168[@i_219], @2_kd_167[@i_219]) && otheruses(@2_m_168[@i_219] -> @2_r4_166[@i_219]) && ((@2_m_168 = @2_m_168[@i_219]) && (@2_kd_167 = @2_kd_167[@i_219])) then
      (
        let Y': G = @2_r4_166[@i_219] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_217 <= NU suchthat defined(@2_r4_172[@i_217], @2_m_174[@i_217], @2_kd_173[@i_217]) && otheruses(@2_m_174[@i_217] -> @2_r4_172[@i_217]) && ((@2_m_168 = @2_m_174[@i_217]) && (@2_kd_167 = @2_kd_173[@i_217])) then
      (
        let Y': G = @2_r4_172[@i_217] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_215 <= qE suchthat defined(@2_x_162[@i_215], @2_ke_161[@i_215], @2_r2_160[@i_215]) && otheruses(@2_x_162[@i_215] -> @2_r2_160[@i_215]) && ((@2_m_168 = @2_r2_160[@i_215]) && (@2_kd_167 = @2_ke_161[@i_215])) then
      (
        let Y': G = @2_x_162[@i_215] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_214 <= NP suchthat defined(@2_x_165[@i_214], @2_ke_164[@i_214], @2_r2_163[@i_214]) && otheruses(@2_x_165[@i_214] -> @2_r2_163[@i_214]) && ((@2_m_168 = @2_r2_163[@i_214]) && (@2_kd_167 = @2_ke_164[@i_214])) then
      (
        let Y': G = @2_x_165[@i_214] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_212 <= NS suchthat defined(@2_x_171[@i_212], @2_ke_170[@i_212], @2_r2_169[@i_212]) && otheruses(@2_x_171[@i_212] -> @2_r2_169[@i_212]) && ((@2_m_168 = @2_r2_169[@i_212]) && (@2_kd_167 = @2_ke_170[@i_212])) then
      (
        let Y': G = @2_x_171[@i_212] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      else
        new @2_r4_166: G;
        let Y': G = @2_r4_166 in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  orfind @i_231 <= NS suchthat defined(@2_r4_166[@i_231], @2_m_168[@i_231], @2_kd_167[@i_231]) && otheruses(@2_m_168[@i_231] -> @2_r4_166[@i_231]) && ((@2_x_171 = @2_r4_166[@i_231]) && (@2_ke_170 = @2_kd_167[@i_231])) then
  (
    let Ystar: G = @2_m_168[@i_231] in
    out(c4[!_42], (S, Ystar));
    in(c7[!_42], auth_s: hash1);
    find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
    (
      let K_s: G = exp(g, mult(x[j], y)) in
      let x1_89: host = U in
      let x2_88: host = S in
      find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], x5_67[@i_115], x4_68[@i_115], x3_69[@i_115], x2_70[@i_115], x1_71[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
      (
        if (auth_s = r1_66[@i_115]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind  suchthat defined(Y_u[j], K_u[j], x5_91[j], x4_92[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
      (
        if (auth_s = r1_90[j]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
    )
    else
      let @2_m_168: G = Ystar in
      let @2_kd_167: passwd = pw in
      find [unique] @i_222 <= qD suchthat defined(@2_r4_157[@i_222], @2_m_159[@i_222], @2_kd_158[@i_222]) && otheruses(@2_m_159[@i_222] -> @2_r4_157[@i_222]) && ((@2_m_168 = @2_m_159[@i_222]) && (@2_kd_167 = @2_kd_158[@i_222])) then
      (
        let Y': G = @2_r4_157[@i_222] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_219 <= NS suchthat defined(@2_r4_166[@i_219], @2_m_168[@i_219], @2_kd_167[@i_219]) && otheruses(@2_m_168[@i_219] -> @2_r4_166[@i_219]) && ((@2_m_168 = @2_m_168[@i_219]) && (@2_kd_167 = @2_kd_167[@i_219])) then
      (
        let Y': G = @2_r4_166[@i_219] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_217 <= NU suchthat defined(@2_r4_172[@i_217], @2_m_174[@i_217], @2_kd_173[@i_217]) && otheruses(@2_m_174[@i_217] -> @2_r4_172[@i_217]) && ((@2_m_168 = @2_m_174[@i_217]) && (@2_kd_167 = @2_kd_173[@i_217])) then
      (
        let Y': G = @2_r4_172[@i_217] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_215 <= qE suchthat defined(@2_x_162[@i_215], @2_ke_161[@i_215], @2_r2_160[@i_215]) && otheruses(@2_x_162[@i_215] -> @2_r2_160[@i_215]) && ((@2_m_168 = @2_r2_160[@i_215]) && (@2_kd_167 = @2_ke_161[@i_215])) then
      (
        let Y': G = @2_x_162[@i_215] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_214 <= NP suchthat defined(@2_x_165[@i_214], @2_ke_164[@i_214], @2_r2_163[@i_214]) && otheruses(@2_x_165[@i_214] -> @2_r2_163[@i_214]) && ((@2_m_168 = @2_r2_163[@i_214]) && (@2_kd_167 = @2_ke_164[@i_214])) then
      (
        let Y': G = @2_x_165[@i_214] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_212 <= NS suchthat defined(@2_x_171[@i_212], @2_ke_170[@i_212], @2_r2_169[@i_212]) && otheruses(@2_x_171[@i_212] -> @2_r2_169[@i_212]) && ((@2_m_168 = @2_r2_169[@i_212]) && (@2_kd_167 = @2_ke_170[@i_212])) then
      (
        let Y': G = @2_x_171[@i_212] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      else
        new @2_r4_166: G;
        let Y': G = @2_r4_166 in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  orfind @i_229 <= NU suchthat defined(@2_r4_172[@i_229], @2_m_174[@i_229], @2_kd_173[@i_229]) && otheruses(@2_m_174[@i_229] -> @2_r4_172[@i_229]) && ((@2_x_171 = @2_r4_172[@i_229]) && (@2_ke_170 = @2_kd_173[@i_229])) then
  (
    let Ystar: G = @2_m_174[@i_229] in
    out(c4[!_42], (S, Ystar));
    in(c7[!_42], auth_s: hash1);
    find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
    (
      let K_s: G = exp(g, mult(x[j], y)) in
      let x1_89: host = U in
      let x2_88: host = S in
      find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], x5_67[@i_115], x4_68[@i_115], x3_69[@i_115], x2_70[@i_115], x1_71[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
      (
        if (auth_s = r1_66[@i_115]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind  suchthat defined(Y_u[j], K_u[j], x5_91[j], x4_92[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
      (
        if (auth_s = r1_90[j]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
    )
    else
      let @2_m_168: G = Ystar in
      let @2_kd_167: passwd = pw in
      find [unique] @i_222 <= qD suchthat defined(@2_r4_157[@i_222], @2_m_159[@i_222], @2_kd_158[@i_222]) && otheruses(@2_m_159[@i_222] -> @2_r4_157[@i_222]) && ((@2_m_168 = @2_m_159[@i_222]) && (@2_kd_167 = @2_kd_158[@i_222])) then
      (
        let Y': G = @2_r4_157[@i_222] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_219 <= NS suchthat defined(@2_r4_166[@i_219], @2_m_168[@i_219], @2_kd_167[@i_219]) && otheruses(@2_m_168[@i_219] -> @2_r4_166[@i_219]) && ((@2_m_168 = @2_m_168[@i_219]) && (@2_kd_167 = @2_kd_167[@i_219])) then
      (
        let Y': G = @2_r4_166[@i_219] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_217 <= NU suchthat defined(@2_r4_172[@i_217], @2_m_174[@i_217], @2_kd_173[@i_217]) && otheruses(@2_m_174[@i_217] -> @2_r4_172[@i_217]) && ((@2_m_168 = @2_m_174[@i_217]) && (@2_kd_167 = @2_kd_173[@i_217])) then
      (
        let Y': G = @2_r4_172[@i_217] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_215 <= qE suchthat defined(@2_x_162[@i_215], @2_ke_161[@i_215], @2_r2_160[@i_215]) && otheruses(@2_x_162[@i_215] -> @2_r2_160[@i_215]) && ((@2_m_168 = @2_r2_160[@i_215]) && (@2_kd_167 = @2_ke_161[@i_215])) then
      (
        let Y': G = @2_x_162[@i_215] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_214 <= NP suchthat defined(@2_x_165[@i_214], @2_ke_164[@i_214], @2_r2_163[@i_214]) && otheruses(@2_x_165[@i_214] -> @2_r2_163[@i_214]) && ((@2_m_168 = @2_r2_163[@i_214]) && (@2_kd_167 = @2_ke_164[@i_214])) then
      (
        let Y': G = @2_x_165[@i_214] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_212 <= NS suchthat defined(@2_x_171[@i_212], @2_ke_170[@i_212], @2_r2_169[@i_212]) && otheruses(@2_x_171[@i_212] -> @2_r2_169[@i_212]) && ((@2_m_168 = @2_r2_169[@i_212]) && (@2_kd_167 = @2_ke_170[@i_212])) then
      (
        let Y': G = @2_x_171[@i_212] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      else
        new @2_r4_166: G;
        let Y': G = @2_r4_166 in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  orfind @i_227 <= qE suchthat defined(@2_x_162[@i_227], @2_ke_161[@i_227], @2_r2_160[@i_227]) && otheruses(@2_x_162[@i_227] -> @2_r2_160[@i_227]) && ((@2_x_171 = @2_x_162[@i_227]) && (@2_ke_170 = @2_ke_161[@i_227])) then
  (
    let Ystar: G = @2_r2_160[@i_227] in
    out(c4[!_42], (S, Ystar));
    in(c7[!_42], auth_s: hash1);
    find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
    (
      let K_s: G = exp(g, mult(x[j], y)) in
      let x1_89: host = U in
      let x2_88: host = S in
      find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], x5_67[@i_115], x4_68[@i_115], x3_69[@i_115], x2_70[@i_115], x1_71[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
      (
        if (auth_s = r1_66[@i_115]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind  suchthat defined(Y_u[j], K_u[j], x5_91[j], x4_92[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
      (
        if (auth_s = r1_90[j]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
    )
    else
      let @2_m_168: G = Ystar in
      let @2_kd_167: passwd = pw in
      find [unique] @i_222 <= qD suchthat defined(@2_r4_157[@i_222], @2_m_159[@i_222], @2_kd_158[@i_222]) && otheruses(@2_m_159[@i_222] -> @2_r4_157[@i_222]) && ((@2_m_168 = @2_m_159[@i_222]) && (@2_kd_167 = @2_kd_158[@i_222])) then
      (
        let Y': G = @2_r4_157[@i_222] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_219 <= NS suchthat defined(@2_r4_166[@i_219], @2_m_168[@i_219], @2_kd_167[@i_219]) && otheruses(@2_m_168[@i_219] -> @2_r4_166[@i_219]) && ((@2_m_168 = @2_m_168[@i_219]) && (@2_kd_167 = @2_kd_167[@i_219])) then
      (
        let Y': G = @2_r4_166[@i_219] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_217 <= NU suchthat defined(@2_r4_172[@i_217], @2_m_174[@i_217], @2_kd_173[@i_217]) && otheruses(@2_m_174[@i_217] -> @2_r4_172[@i_217]) && ((@2_m_168 = @2_m_174[@i_217]) && (@2_kd_167 = @2_kd_173[@i_217])) then
      (
        let Y': G = @2_r4_172[@i_217] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_215 <= qE suchthat defined(@2_x_162[@i_215], @2_ke_161[@i_215], @2_r2_160[@i_215]) && otheruses(@2_x_162[@i_215] -> @2_r2_160[@i_215]) && ((@2_m_168 = @2_r2_160[@i_215]) && (@2_kd_167 = @2_ke_161[@i_215])) then
      (
        let Y': G = @2_x_162[@i_215] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_214 <= NP suchthat defined(@2_x_165[@i_214], @2_ke_164[@i_214], @2_r2_163[@i_214]) && otheruses(@2_x_165[@i_214] -> @2_r2_163[@i_214]) && ((@2_m_168 = @2_r2_163[@i_214]) && (@2_kd_167 = @2_ke_164[@i_214])) then
      (
        let Y': G = @2_x_165[@i_214] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_212 <= NS suchthat defined(@2_x_171[@i_212], @2_ke_170[@i_212], @2_r2_169[@i_212]) && otheruses(@2_x_171[@i_212] -> @2_r2_169[@i_212]) && ((@2_m_168 = @2_r2_169[@i_212]) && (@2_kd_167 = @2_ke_170[@i_212])) then
      (
        let Y': G = @2_x_171[@i_212] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      else
        new @2_r4_166: G;
        let Y': G = @2_r4_166 in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  orfind @i_226 <= NP suchthat defined(@2_x_165[@i_226], @2_ke_164[@i_226], @2_r2_163[@i_226]) && otheruses(@2_x_165[@i_226] -> @2_r2_163[@i_226]) && ((@2_x_171 = @2_x_165[@i_226]) && (@2_ke_170 = @2_ke_164[@i_226])) then
  (
    let Ystar: G = @2_r2_163[@i_226] in
    out(c4[!_42], (S, Ystar));
    in(c7[!_42], auth_s: hash1);
    find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
    (
      let K_s: G = exp(g, mult(x[j], y)) in
      let x1_89: host = U in
      let x2_88: host = S in
      find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], x5_67[@i_115], x4_68[@i_115], x3_69[@i_115], x2_70[@i_115], x1_71[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
      (
        if (auth_s = r1_66[@i_115]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind  suchthat defined(Y_u[j], K_u[j], x5_91[j], x4_92[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
      (
        if (auth_s = r1_90[j]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
    )
    else
      let @2_m_168: G = Ystar in
      let @2_kd_167: passwd = pw in
      find [unique] @i_222 <= qD suchthat defined(@2_r4_157[@i_222], @2_m_159[@i_222], @2_kd_158[@i_222]) && otheruses(@2_m_159[@i_222] -> @2_r4_157[@i_222]) && ((@2_m_168 = @2_m_159[@i_222]) && (@2_kd_167 = @2_kd_158[@i_222])) then
      (
        let Y': G = @2_r4_157[@i_222] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_219 <= NS suchthat defined(@2_r4_166[@i_219], @2_m_168[@i_219], @2_kd_167[@i_219]) && otheruses(@2_m_168[@i_219] -> @2_r4_166[@i_219]) && ((@2_m_168 = @2_m_168[@i_219]) && (@2_kd_167 = @2_kd_167[@i_219])) then
      (
        let Y': G = @2_r4_166[@i_219] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_217 <= NU suchthat defined(@2_r4_172[@i_217], @2_m_174[@i_217], @2_kd_173[@i_217]) && otheruses(@2_m_174[@i_217] -> @2_r4_172[@i_217]) && ((@2_m_168 = @2_m_174[@i_217]) && (@2_kd_167 = @2_kd_173[@i_217])) then
      (
        let Y': G = @2_r4_172[@i_217] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_215 <= qE suchthat defined(@2_x_162[@i_215], @2_ke_161[@i_215], @2_r2_160[@i_215]) && otheruses(@2_x_162[@i_215] -> @2_r2_160[@i_215]) && ((@2_m_168 = @2_r2_160[@i_215]) && (@2_kd_167 = @2_ke_161[@i_215])) then
      (
        let Y': G = @2_x_162[@i_215] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_214 <= NP suchthat defined(@2_x_165[@i_214], @2_ke_164[@i_214], @2_r2_163[@i_214]) && otheruses(@2_x_165[@i_214] -> @2_r2_163[@i_214]) && ((@2_m_168 = @2_r2_163[@i_214]) && (@2_kd_167 = @2_ke_164[@i_214])) then
      (
        let Y': G = @2_x_165[@i_214] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_212 <= NS suchthat defined(@2_x_171[@i_212], @2_ke_170[@i_212], @2_r2_169[@i_212]) && otheruses(@2_x_171[@i_212] -> @2_r2_169[@i_212]) && ((@2_m_168 = @2_r2_169[@i_212]) && (@2_kd_167 = @2_ke_170[@i_212])) then
      (
        let Y': G = @2_x_171[@i_212] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      else
        new @2_r4_166: G;
        let Y': G = @2_r4_166 in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  orfind @i_224 <= NS suchthat defined(@2_x_171[@i_224], @2_ke_170[@i_224], @2_r2_169[@i_224]) && otheruses(@2_x_171[@i_224] -> @2_r2_169[@i_224]) && ((@2_x_171 = @2_x_171[@i_224]) && (@2_ke_170 = @2_ke_170[@i_224])) then
  (
    let Ystar: G = @2_r2_169[@i_224] in
    out(c4[!_42], (S, Ystar));
    in(c7[!_42], auth_s: hash1);
    find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
    (
      let K_s: G = exp(g, mult(x[j], y)) in
      let x1_89: host = U in
      let x2_88: host = S in
      find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], x5_67[@i_115], x4_68[@i_115], x3_69[@i_115], x2_70[@i_115], x1_71[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
      (
        if (auth_s = r1_66[@i_115]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind  suchthat defined(Y_u[j], K_u[j], x5_91[j], x4_92[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
      (
        if (auth_s = r1_90[j]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
    )
    else
      let @2_m_168: G = Ystar in
      let @2_kd_167: passwd = pw in
      find [unique] @i_222 <= qD suchthat defined(@2_r4_157[@i_222], @2_m_159[@i_222], @2_kd_158[@i_222]) && otheruses(@2_m_159[@i_222] -> @2_r4_157[@i_222]) && ((@2_m_168 = @2_m_159[@i_222]) && (@2_kd_167 = @2_kd_158[@i_222])) then
      (
        let Y': G = @2_r4_157[@i_222] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_219 <= NS suchthat defined(@2_r4_166[@i_219], @2_m_168[@i_219], @2_kd_167[@i_219]) && otheruses(@2_m_168[@i_219] -> @2_r4_166[@i_219]) && ((@2_m_168 = @2_m_168[@i_219]) && (@2_kd_167 = @2_kd_167[@i_219])) then
      (
        let Y': G = @2_r4_166[@i_219] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_217 <= NU suchthat defined(@2_r4_172[@i_217], @2_m_174[@i_217], @2_kd_173[@i_217]) && otheruses(@2_m_174[@i_217] -> @2_r4_172[@i_217]) && ((@2_m_168 = @2_m_174[@i_217]) && (@2_kd_167 = @2_kd_173[@i_217])) then
      (
        let Y': G = @2_r4_172[@i_217] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_215 <= qE suchthat defined(@2_x_162[@i_215], @2_ke_161[@i_215], @2_r2_160[@i_215]) && otheruses(@2_x_162[@i_215] -> @2_r2_160[@i_215]) && ((@2_m_168 = @2_r2_160[@i_215]) && (@2_kd_167 = @2_ke_161[@i_215])) then
      (
        let Y': G = @2_x_162[@i_215] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_214 <= NP suchthat defined(@2_x_165[@i_214], @2_ke_164[@i_214], @2_r2_163[@i_214]) && otheruses(@2_x_165[@i_214] -> @2_r2_163[@i_214]) && ((@2_m_168 = @2_r2_163[@i_214]) && (@2_kd_167 = @2_ke_164[@i_214])) then
      (
        let Y': G = @2_x_165[@i_214] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_212 <= NS suchthat defined(@2_x_171[@i_212], @2_ke_170[@i_212], @2_r2_169[@i_212]) && otheruses(@2_x_171[@i_212] -> @2_r2_169[@i_212]) && ((@2_m_168 = @2_r2_169[@i_212]) && (@2_kd_167 = @2_ke_170[@i_212])) then
      (
        let Y': G = @2_x_171[@i_212] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      else
        new @2_r4_166: G;
        let Y': G = @2_r4_166 in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
  )
  else
    new @2_r2_169: G;
    let Ystar: G = @2_r2_169 in
    out(c4[!_42], (S, Ystar));
    in(c7[!_42], auth_s: hash1);
    find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
    (
      let K_s: G = exp(g, mult(x[j], y)) in
      let x1_89: host = U in
      let x2_88: host = S in
      find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], x5_67[@i_115], x4_68[@i_115], x3_69[@i_115], x2_70[@i_115], x1_71[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
      (
        if (auth_s = r1_66[@i_115]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind  suchthat defined(Y_u[j], K_u[j], x5_91[j], x4_92[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
      (
        if (auth_s = r1_90[j]) then
        let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
        event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
    )
    else
      let @2_m_168: G = Ystar in
      let @2_kd_167: passwd = pw in
      find [unique] @i_222 <= qD suchthat defined(@2_r4_157[@i_222], @2_m_159[@i_222], @2_kd_158[@i_222]) && otheruses(@2_m_159[@i_222] -> @2_r4_157[@i_222]) && ((@2_m_168 = @2_m_159[@i_222]) && (@2_kd_167 = @2_kd_158[@i_222])) then
      (
        let Y': G = @2_r4_157[@i_222] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_219 <= NS suchthat defined(@2_r4_166[@i_219], @2_m_168[@i_219], @2_kd_167[@i_219]) && otheruses(@2_m_168[@i_219] -> @2_r4_166[@i_219]) && ((@2_m_168 = @2_m_168[@i_219]) && (@2_kd_167 = @2_kd_167[@i_219])) then
      (
        let Y': G = @2_r4_166[@i_219] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_217 <= NU suchthat defined(@2_r4_172[@i_217], @2_m_174[@i_217], @2_kd_173[@i_217]) && otheruses(@2_m_174[@i_217] -> @2_r4_172[@i_217]) && ((@2_m_168 = @2_m_174[@i_217]) && (@2_kd_167 = @2_kd_173[@i_217])) then
      (
        let Y': G = @2_r4_172[@i_217] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_215 <= qE suchthat defined(@2_x_162[@i_215], @2_ke_161[@i_215], @2_r2_160[@i_215]) && otheruses(@2_x_162[@i_215] -> @2_r2_160[@i_215]) && ((@2_m_168 = @2_r2_160[@i_215]) && (@2_kd_167 = @2_ke_161[@i_215])) then
      (
        let Y': G = @2_x_162[@i_215] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_214 <= NP suchthat defined(@2_x_165[@i_214], @2_ke_164[@i_214], @2_r2_163[@i_214]) && otheruses(@2_x_165[@i_214] -> @2_r2_163[@i_214]) && ((@2_m_168 = @2_r2_163[@i_214]) && (@2_kd_167 = @2_ke_164[@i_214])) then
      (
        let Y': G = @2_x_165[@i_214] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      orfind @i_212 <= NS suchthat defined(@2_x_171[@i_212], @2_ke_170[@i_212], @2_r2_169[@i_212]) && otheruses(@2_x_171[@i_212] -> @2_r2_169[@i_212]) && ((@2_m_168 = @2_r2_169[@i_212]) && (@2_kd_167 = @2_ke_170[@i_212])) then
      (
        let Y': G = @2_x_171[@i_212] in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
      )
      else
        new @2_r4_166: G;
        let Y': G = @2_r4_166 in
        find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
          event Auth
        else
          let K_s: G = exp(X_s, y) in
          let x1_83: host = U in
          let x2_82: host = S in
          find [unique] @i_110 <= qH1 suchthat defined(x11[@i_110], x12[@i_110], x13[@i_110], x14[@i_110], x15[@i_110], x5_67[@i_110], x4_68[@i_110], x3_69[@i_110], x2_70[@i_110], x1_71[@i_110], r1_66[@i_110]) && otheruses(r1_66[@i_110]) && ((x1_83 = x11[@i_110]) && ((x2_82 = x12[@i_110]) && ((X_s = x13[@i_110]) && ((Y' = x14[@i_110]) && (K_s = x15[@i_110]))))) then
          if (auth_s = r1_66[@i_110]) then
          let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
          event termS(U, X_s, S, Ystar, auth_s, sk_s)
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let @2_x_165: G = Yp in
  let @2_ke_164: passwd = pw in
  find [unique] @i_210 <= qD suchthat defined(@2_r4_157[@i_210], @2_m_159[@i_210], @2_kd_158[@i_210]) && otheruses(@2_m_159[@i_210] -> @2_r4_157[@i_210]) && ((@2_x_165 = @2_r4_157[@i_210]) && (@2_ke_164 = @2_kd_158[@i_210])) then
  (
    let Ystarp: G = @2_m_159[@i_210] in
    let x1_77: host = U in
    let x2_76: host = S in
    let x3_75: G = cst_G in
    let x4_74: G = cst_G in
    let x5_73: G = cst_G in
    new r1_72: hash1;
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_43], (U, Xp, S, Ystarp, r1_72))
  )
  orfind @i_207 <= NS suchthat defined(@2_r4_166[@i_207], @2_m_168[@i_207], @2_kd_167[@i_207]) && otheruses(@2_m_168[@i_207] -> @2_r4_166[@i_207]) && ((@2_x_165 = @2_r4_166[@i_207]) && (@2_ke_164 = @2_kd_167[@i_207])) then
  (
    let Ystarp: G = @2_m_168[@i_207] in
    let x1_77: host = U in
    let x2_76: host = S in
    let x3_75: G = cst_G in
    let x4_74: G = cst_G in
    let x5_73: G = cst_G in
    new r1_72: hash1;
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_43], (U, Xp, S, Ystarp, r1_72))
  )
  orfind @i_205 <= NU suchthat defined(@2_r4_172[@i_205], @2_m_174[@i_205], @2_kd_173[@i_205]) && otheruses(@2_m_174[@i_205] -> @2_r4_172[@i_205]) && ((@2_x_165 = @2_r4_172[@i_205]) && (@2_ke_164 = @2_kd_173[@i_205])) then
  (
    let Ystarp: G = @2_m_174[@i_205] in
    let x1_77: host = U in
    let x2_76: host = S in
    let x3_75: G = cst_G in
    let x4_74: G = cst_G in
    let x5_73: G = cst_G in
    new r1_72: hash1;
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_43], (U, Xp, S, Ystarp, r1_72))
  )
  orfind @i_203 <= qE suchthat defined(@2_x_162[@i_203], @2_ke_161[@i_203], @2_r2_160[@i_203]) && otheruses(@2_x_162[@i_203] -> @2_r2_160[@i_203]) && ((@2_x_165 = @2_x_162[@i_203]) && (@2_ke_164 = @2_ke_161[@i_203])) then
  (
    let Ystarp: G = @2_r2_160[@i_203] in
    let x1_77: host = U in
    let x2_76: host = S in
    let x3_75: G = cst_G in
    let x4_74: G = cst_G in
    let x5_73: G = cst_G in
    new r1_72: hash1;
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_43], (U, Xp, S, Ystarp, r1_72))
  )
  orfind @i_202 <= NP suchthat defined(@2_x_165[@i_202], @2_ke_164[@i_202], @2_r2_163[@i_202]) && otheruses(@2_x_165[@i_202] -> @2_r2_163[@i_202]) && ((@2_x_165 = @2_x_165[@i_202]) && (@2_ke_164 = @2_ke_164[@i_202])) then
  (
    let Ystarp: G = @2_r2_163[@i_202] in
    let x1_77: host = U in
    let x2_76: host = S in
    let x3_75: G = cst_G in
    let x4_74: G = cst_G in
    let x5_73: G = cst_G in
    new r1_72: hash1;
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_43], (U, Xp, S, Ystarp, r1_72))
  )
  orfind @i_200 <= NS suchthat defined(@2_x_171[@i_200], @2_ke_170[@i_200], @2_r2_169[@i_200]) && otheruses(@2_x_171[@i_200] -> @2_r2_169[@i_200]) && ((@2_x_165 = @2_x_171[@i_200]) && (@2_ke_164 = @2_ke_170[@i_200])) then
  (
    let Ystarp: G = @2_r2_169[@i_200] in
    let x1_77: host = U in
    let x2_76: host = S in
    let x3_75: G = cst_G in
    let x4_74: G = cst_G in
    let x5_73: G = cst_G in
    new r1_72: hash1;
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_43], (U, Xp, S, Ystarp, r1_72))
  )
  else
    new @2_r2_163: G;
    let Ystarp: G = @2_r2_163 in
    let x1_77: host = U in
    let x2_76: host = S in
    let x3_75: G = cst_G in
    let x4_74: G = cst_G in
    let x5_73: G = cst_G in
    new r1_72: hash1;
    let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
    out(cp[!_43], (U, Xp, S, Ystarp, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  let @2_x_162: G = @2_x in
  let @2_ke_161: passwd = @2_ke in
  find [unique] @i_198 <= qD suchthat defined(@2_r4_157[@i_198], @2_m_159[@i_198], @2_kd_158[@i_198]) && otheruses(@2_m_159[@i_198] -> @2_r4_157[@i_198]) && ((@2_x_162 = @2_r4_157[@i_198]) && (@2_ke_161 = @2_kd_158[@i_198])) then
    out(@2_c2[!_44], @2_m_159[@i_198])
  orfind @i_195 <= NS suchthat defined(@2_r4_166[@i_195], @2_m_168[@i_195], @2_kd_167[@i_195]) && otheruses(@2_m_168[@i_195] -> @2_r4_166[@i_195]) && ((@2_x_162 = @2_r4_166[@i_195]) && (@2_ke_161 = @2_kd_167[@i_195])) then
    out(@2_c2[!_44], @2_m_168[@i_195])
  orfind @i_193 <= NU suchthat defined(@2_r4_172[@i_193], @2_m_174[@i_193], @2_kd_173[@i_193]) && otheruses(@2_m_174[@i_193] -> @2_r4_172[@i_193]) && ((@2_x_162 = @2_r4_172[@i_193]) && (@2_ke_161 = @2_kd_173[@i_193])) then
    out(@2_c2[!_44], @2_m_174[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x_162[@i_191], @2_ke_161[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x_162[@i_191] -> @2_r2_160[@i_191]) && ((@2_x_162 = @2_x_162[@i_191]) && (@2_ke_161 = @2_ke_161[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(@2_x_165[@i_190], @2_ke_164[@i_190], @2_r2_163[@i_190]) && otheruses(@2_x_165[@i_190] -> @2_r2_163[@i_190]) && ((@2_x_162 = @2_x_165[@i_190]) && (@2_ke_161 = @2_ke_164[@i_190])) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(@2_x_171[@i_188], @2_ke_170[@i_188], @2_r2_169[@i_188]) && otheruses(@2_x_171[@i_188] -> @2_r2_169[@i_188]) && ((@2_x_162 = @2_x_171[@i_188]) && (@2_ke_161 = @2_ke_170[@i_188])) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  let @2_m_159: G = @2_m in
  let @2_kd_158: passwd = @2_kd in
  find [unique] @i_186 <= qD suchthat defined(@2_r4_157[@i_186], @2_m_159[@i_186], @2_kd_158[@i_186]) && otheruses(@2_m_159[@i_186] -> @2_r4_157[@i_186]) && ((@2_m_159 = @2_m_159[@i_186]) && (@2_kd_158 = @2_kd_158[@i_186])) then
    out(@2_c4[!_45], @2_r4_157[@i_186])
  orfind @i_183 <= NS suchthat defined(@2_r4_166[@i_183], @2_m_168[@i_183], @2_kd_167[@i_183]) && otheruses(@2_m_168[@i_183] -> @2_r4_166[@i_183]) && ((@2_m_159 = @2_m_168[@i_183]) && (@2_kd_158 = @2_kd_167[@i_183])) then
    out(@2_c4[!_45], @2_r4_166[@i_183])
  orfind @i_181 <= NU suchthat defined(@2_r4_172[@i_181], @2_m_174[@i_181], @2_kd_173[@i_181]) && otheruses(@2_m_174[@i_181] -> @2_r4_172[@i_181]) && ((@2_m_159 = @2_m_174[@i_181]) && (@2_kd_158 = @2_kd_173[@i_181])) then
    out(@2_c4[!_45], @2_r4_172[@i_181])
  orfind @i_179 <= qE suchthat defined(@2_x_162[@i_179], @2_ke_161[@i_179], @2_r2_160[@i_179]) && otheruses(@2_x_162[@i_179] -> @2_r2_160[@i_179]) && ((@2_m_159 = @2_r2_160[@i_179]) && (@2_kd_158 = @2_ke_161[@i_179])) then
    out(@2_c4[!_45], @2_x_162[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_x_165[@i_178], @2_ke_164[@i_178], @2_r2_163[@i_178]) && otheruses(@2_x_165[@i_178] -> @2_r2_163[@i_178]) && ((@2_m_159 = @2_r2_163[@i_178]) && (@2_kd_158 = @2_ke_164[@i_178])) then
    out(@2_c4[!_45], @2_x_165[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_x_171[@i_176], @2_ke_170[@i_176], @2_r2_169[@i_176]) && otheruses(@2_x_171[@i_176] -> @2_r2_169[@i_176]) && ((@2_m_159 = @2_r2_169[@i_176]) && (@2_kd_158 = @2_ke_170[@i_176])) then
    out(@2_c4[!_45], @2_x_171[@i_176])
  else
    new @2_r4_157: G;
    out(@2_c4[!_45], @2_r4_157)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_46], h0(x1, x2, x3, x4, x5))
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_71: host = cst_host in
  let x2_70: host = cst_host in
  let x3_69: G = cst_G in
  let x4_68: G = cst_G in
  let x5_67: G = cst_G in
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], x5_67[@i_100], x4_68[@i_100], x3_69[@i_100], x2_70[@i_100], x1_71[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(Xp[@i_99], Yp[@i_99], Kp[@i_99], x5_73[@i_99], x4_74[@i_99], x3_75[@i_99], x1_77[@i_99], x2_76[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(X[@i_96], Y_u[@i_96], K_u[@i_96], x5_91[@i_96], x4_92[@i_96], x3_93[@i_96], x1_95[@i_96], x2_94[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying simplify [Excluding set(dist 11->12, proba <= 2. * NS * NP / |exponent| + qE * NP / |exponent| + NU * NP / |exponent| + qD * NP / |exponent| + NP * NS / |exponent| + qE * NS / |exponent| + NU * NS / |exponent| + NS * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G| + 0.5 * NS * NS / |G| + NS * NP / |G| + NS * qE / |G|)] yields

Game 12 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let @2_m_174: G = Ystar_u in
  let @2_kd_173: passwd = pw in
  find [unique] @i_246 <= qD suchthat defined(@2_m_159[@i_246], @2_kd_158[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m_159[@i_246] -> @2_r4_157[@i_246]) && ((@2_m_174 = @2_m_159[@i_246]) && (@2_kd_173 = @2_kd_158[@i_246])) then
  (
    let Y_u: G = @2_r4_157[@i_246] in
    let K_u: G = exp(Y_u, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    let x3_93: G = cst_G in
    let x4_92: G = cst_G in
    let x5_91: G = cst_G in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(@2_m_174[@i_241], @2_r4_172[@i_241]) && otheruses(@2_m_174[@i_241] -> @2_r4_172[@i_241]) && (@2_m_174 = @2_m_174[@i_241]) then
  (
    let Y_u: G = @2_r4_172[@i_241] in
    let K_u: G = exp(Y_u, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    let x3_93: G = cst_G in
    let x4_92: G = cst_G in
    let x5_91: G = cst_G in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke_161[@i_239], @2_x_162[@i_239]) && otheruses(@2_x_162[@i_239] -> @2_r2_160[@i_239]) && ((@2_m_174 = @2_r2_160[@i_239]) && (@2_kd_173 = @2_ke_161[@i_239])) then
  (
    let Y_u: G = @2_x_162[@i_239] in
    let K_u: G = exp(Y_u, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    let x3_93: G = cst_G in
    let x4_92: G = cst_G in
    let x5_91: G = cst_G in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], @2_x_165[@i_238], yp[@i_238]) && otheruses(@2_x_165[@i_238] -> @2_r2_163[@i_238]) && (@2_m_174 = @2_r2_163[@i_238]) then
  (
    let Y_u: G = @2_x_165[@i_238] in
    let K_u: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    let x3_93: G = cst_G in
    let x4_92: G = cst_G in
    let x5_91: G = cst_G in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], @2_x_171[@i_236], y[@i_236]) && otheruses(@2_x_171[@i_236] -> @2_r2_169[@i_236]) && (@2_m_174 = @2_r2_169[@i_236]) then
  (
    let Y_u: G = @2_x_171[@i_236] in
    let K_u: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    let x3_93: G = cst_G in
    let x4_92: G = cst_G in
    let x5_91: G = cst_G in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  else
    new @2_r4_172: G;
    let Y_u: G = @2_r4_172 in
    let K_u: G = exp(Y_u, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    let x3_93: G = cst_G in
    let x4_92: G = cst_G in
    let x5_91: G = cst_G in
    new r1_90: hash1;
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_90, sk_u);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let @2_x_171: G = Y in
  let @2_ke_170: passwd = pw in
  new @2_r2_169: G;
  let Ystar: G = @2_r2_169 in
  out(c4[!_42], (S, Ystar));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_90[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  else
    let @2_m_168: G = Ystar in
    let @2_kd_167: passwd = pw in
    find [unique] @i_222 <= qD suchthat defined(@2_m_159[@i_222], @2_kd_158[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m_159[@i_222] -> @2_r4_157[@i_222]) && ((@2_m_168 = @2_m_159[@i_222]) && (@2_kd_167 = @2_kd_158[@i_222])) then
    (
      let Y': G = @2_r4_157[@i_222] in
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
        event Auth
      else
        let K_s: G = exp(X_s, y)
    )
    orfind @i_217 <= NU suchthat defined(@2_m_174[@i_217], @2_r4_172[@i_217]) && otheruses(@2_m_174[@i_217] -> @2_r4_172[@i_217]) && (@2_m_168 = @2_m_174[@i_217]) then
    (
      let Y': G = @2_r4_172[@i_217] in
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
        event Auth
      else
        let K_s: G = exp(X_s, y)
    )
    orfind  suchthat otheruses(@2_x_171 -> @2_r2_169) then
    (
      let @i_212 <= NS = !_42 in
      let Y': G = @2_x_171 in
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
        event Auth
      else
        let K_s: G = exp(X_s, y)
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let @2_x_165: G = Yp in
  let @2_ke_164: passwd = pw in
  new @2_r2_163: G;
  let Ystarp: G = @2_r2_163 in
  let x1_77: host = U in
  let x2_76: host = S in
  let x3_75: G = cst_G in
  let x4_74: G = cst_G in
  let x5_73: G = cst_G in
  new r1_72: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_43], (U, Xp, S, Ystarp, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  let @2_x_162: G = @2_x in
  let @2_ke_161: passwd = @2_ke in
  find [unique] @i_198 <= qD suchthat defined(@2_r4_157[@i_198], @2_kd_158[@i_198], @2_m_159[@i_198]) && otheruses(@2_m_159[@i_198] -> @2_r4_157[@i_198]) && ((@2_x_162 = @2_r4_157[@i_198]) && (@2_ke_161 = @2_kd_158[@i_198])) then
    out(@2_c2[!_44], @2_m_159[@i_198])
  orfind @i_193 <= NU suchthat defined(@2_r4_172[@i_193], @2_kd_173[@i_193], @2_m_174[@i_193]) && otheruses(@2_m_174[@i_193] -> @2_r4_172[@i_193]) && ((@2_x_162 = @2_r4_172[@i_193]) && (@2_ke_161 = @2_kd_173[@i_193])) then
    out(@2_c2[!_44], @2_m_174[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x_162[@i_191], @2_ke_161[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x_162[@i_191] -> @2_r2_160[@i_191]) && ((@2_x_162 = @2_x_162[@i_191]) && (@2_ke_161 = @2_ke_161[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(@2_x_165[@i_190], @2_ke_164[@i_190], @2_r2_163[@i_190]) && otheruses(@2_x_165[@i_190] -> @2_r2_163[@i_190]) && ((@2_x_162 = @2_x_165[@i_190]) && (@2_ke_161 = @2_ke_164[@i_190])) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(@2_x_171[@i_188], @2_ke_170[@i_188], @2_r2_169[@i_188]) && otheruses(@2_x_171[@i_188] -> @2_r2_169[@i_188]) && ((@2_x_162 = @2_x_171[@i_188]) && (@2_ke_161 = @2_ke_170[@i_188])) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  let @2_m_159: G = @2_m in
  let @2_kd_158: passwd = @2_kd in
  find [unique] @i_186 <= qD suchthat defined(@2_m_159[@i_186], @2_kd_158[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m_159[@i_186] -> @2_r4_157[@i_186]) && ((@2_m_159 = @2_m_159[@i_186]) && (@2_kd_158 = @2_kd_158[@i_186])) then
    out(@2_c4[!_45], @2_r4_157[@i_186])
  orfind @i_181 <= NU suchthat defined(@2_m_174[@i_181], @2_kd_173[@i_181], @2_r4_172[@i_181]) && otheruses(@2_m_174[@i_181] -> @2_r4_172[@i_181]) && ((@2_m_159 = @2_m_174[@i_181]) && (@2_kd_158 = @2_kd_173[@i_181])) then
    out(@2_c4[!_45], @2_r4_172[@i_181])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke_161[@i_179], @2_x_162[@i_179]) && otheruses(@2_x_162[@i_179] -> @2_r2_160[@i_179]) && ((@2_m_159 = @2_r2_160[@i_179]) && (@2_kd_158 = @2_ke_161[@i_179])) then
    out(@2_c4[!_45], @2_x_162[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], @2_ke_164[@i_178], @2_x_165[@i_178]) && otheruses(@2_x_165[@i_178] -> @2_r2_163[@i_178]) && ((@2_m_159 = @2_r2_163[@i_178]) && (@2_kd_158 = @2_ke_164[@i_178])) then
    out(@2_c4[!_45], @2_x_165[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], @2_ke_170[@i_176], @2_x_171[@i_176]) && otheruses(@2_x_171[@i_176] -> @2_r2_169[@i_176]) && ((@2_m_159 = @2_r2_169[@i_176]) && (@2_kd_158 = @2_ke_170[@i_176])) then
    out(@2_c4[!_45], @2_x_171[@i_176])
  else
    new @2_r4_157: G;
    out(@2_c4[!_45], @2_r4_157)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_46], h0(x1, x2, x3, x4, x5))
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  let x1_71: host = cst_host in
  let x2_70: host = cst_host in
  let x3_69: G = cst_G in
  let x4_68: G = cst_G in
  let x5_67: G = cst_G in
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying move all binders yields

Game 13 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let @2_m_174: G = Ystar_u in
  let @2_kd_173: passwd = pw in
  find [unique] @i_246 <= qD suchthat defined(@2_m_159[@i_246], @2_kd_158[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m_159[@i_246] -> @2_r4_157[@i_246]) && ((@2_m_174 = @2_m_159[@i_246]) && (@2_kd_173 = @2_kd_158[@i_246])) then
  (
    let Y_u: G = @2_r4_157[@i_246] in
    let K_u: G = exp(Y_u, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(@2_m_174[@i_241], @2_r4_172[@i_241]) && otheruses(@2_m_174[@i_241] -> @2_r4_172[@i_241]) && (@2_m_174 = @2_m_174[@i_241]) then
  (
    let Y_u: G = @2_r4_172[@i_241] in
    let K_u: G = exp(Y_u, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke_161[@i_239], @2_x_162[@i_239]) && otheruses(@2_x_162[@i_239] -> @2_r2_160[@i_239]) && ((@2_m_174 = @2_r2_160[@i_239]) && (@2_kd_173 = @2_ke_161[@i_239])) then
  (
    let Y_u: G = @2_x_162[@i_239] in
    let K_u: G = exp(Y_u, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], @2_x_165[@i_238], yp[@i_238]) && otheruses(@2_x_165[@i_238] -> @2_r2_163[@i_238]) && (@2_m_174 = @2_r2_163[@i_238]) then
  (
    let Y_u: G = @2_x_165[@i_238] in
    let K_u: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], @2_x_171[@i_236], y[@i_236]) && otheruses(@2_x_171[@i_236] -> @2_r2_169[@i_236]) && (@2_m_174 = @2_r2_169[@i_236]) then
  (
    let Y_u: G = @2_x_171[@i_236] in
    let K_u: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y_u = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  else
    new @2_r4_172: G;
    let Y_u: G = @2_r4_172 in
    let K_u: G = exp(Y_u, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    let x3_93: G = cst_G in
    let x4_92: G = cst_G in
    let x5_91: G = cst_G in
    new r1_90: hash1;
    let sk_u: hash0 = h0(U, S, X, Y_u, K_u) in
    event termU(U, X, S, Ystar_u, r1_90, sk_u);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let @2_x_171: G = Y in
  let @2_ke_170: passwd = pw in
  new @2_r2_169: G;
  let Ystar: G = @2_r2_169 in
  out(c4[!_42], (S, Ystar));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_90[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, Ystar, auth_s, sk_s)
    )
  )
  else
    let @2_m_168: G = Ystar in
    let @2_kd_167: passwd = pw in
    find [unique] @i_222 <= qD suchthat defined(@2_m_159[@i_222], @2_kd_158[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m_159[@i_222] -> @2_r4_157[@i_222]) && ((@2_m_168 = @2_m_159[@i_222]) && (@2_kd_167 = @2_kd_158[@i_222])) then
    (
      let Y': G = @2_r4_157[@i_222] in
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
        event Auth
      else
        let K_s: G = exp(X_s, y)
    )
    orfind @i_217 <= NU suchthat defined(@2_m_174[@i_217], @2_r4_172[@i_217]) && otheruses(@2_m_174[@i_217] -> @2_r4_172[@i_217]) && (@2_m_168 = @2_m_174[@i_217]) then
    (
      let Y': G = @2_r4_172[@i_217] in
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
        event Auth
      else
        let K_s: G = exp(X_s, y)
    )
    orfind  suchthat otheruses(@2_x_171 -> @2_r2_169) then
    (
      let @i_212 <= NS = !_42 in
      let Y': G = @2_x_171 in
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y' = x14[nj]) && (auth_s = r1_66[nj]))))) then
        event Auth
      else
        let K_s: G = exp(X_s, y)
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let @2_x_165: G = Yp in
  let @2_ke_164: passwd = pw in
  new @2_r2_163: G;
  let Ystarp: G = @2_r2_163 in
  let x1_77: host = U in
  let x2_76: host = S in
  let x3_75: G = cst_G in
  let x4_74: G = cst_G in
  let x5_73: G = cst_G in
  new r1_72: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_43], (U, Xp, S, Ystarp, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  let @2_x_162: G = @2_x in
  let @2_ke_161: passwd = @2_ke in
  find [unique] @i_198 <= qD suchthat defined(@2_r4_157[@i_198], @2_kd_158[@i_198], @2_m_159[@i_198]) && otheruses(@2_m_159[@i_198] -> @2_r4_157[@i_198]) && ((@2_x_162 = @2_r4_157[@i_198]) && (@2_ke_161 = @2_kd_158[@i_198])) then
    out(@2_c2[!_44], @2_m_159[@i_198])
  orfind @i_193 <= NU suchthat defined(@2_r4_172[@i_193], @2_kd_173[@i_193], @2_m_174[@i_193]) && otheruses(@2_m_174[@i_193] -> @2_r4_172[@i_193]) && ((@2_x_162 = @2_r4_172[@i_193]) && (@2_ke_161 = @2_kd_173[@i_193])) then
    out(@2_c2[!_44], @2_m_174[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x_162[@i_191], @2_ke_161[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x_162[@i_191] -> @2_r2_160[@i_191]) && ((@2_x_162 = @2_x_162[@i_191]) && (@2_ke_161 = @2_ke_161[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(@2_x_165[@i_190], @2_ke_164[@i_190], @2_r2_163[@i_190]) && otheruses(@2_x_165[@i_190] -> @2_r2_163[@i_190]) && ((@2_x_162 = @2_x_165[@i_190]) && (@2_ke_161 = @2_ke_164[@i_190])) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(@2_x_171[@i_188], @2_ke_170[@i_188], @2_r2_169[@i_188]) && otheruses(@2_x_171[@i_188] -> @2_r2_169[@i_188]) && ((@2_x_162 = @2_x_171[@i_188]) && (@2_ke_161 = @2_ke_170[@i_188])) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  let @2_m_159: G = @2_m in
  let @2_kd_158: passwd = @2_kd in
  find [unique] @i_186 <= qD suchthat defined(@2_m_159[@i_186], @2_kd_158[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m_159[@i_186] -> @2_r4_157[@i_186]) && ((@2_m_159 = @2_m_159[@i_186]) && (@2_kd_158 = @2_kd_158[@i_186])) then
    out(@2_c4[!_45], @2_r4_157[@i_186])
  orfind @i_181 <= NU suchthat defined(@2_m_174[@i_181], @2_kd_173[@i_181], @2_r4_172[@i_181]) && otheruses(@2_m_174[@i_181] -> @2_r4_172[@i_181]) && ((@2_m_159 = @2_m_174[@i_181]) && (@2_kd_158 = @2_kd_173[@i_181])) then
    out(@2_c4[!_45], @2_r4_172[@i_181])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke_161[@i_179], @2_x_162[@i_179]) && otheruses(@2_x_162[@i_179] -> @2_r2_160[@i_179]) && ((@2_m_159 = @2_r2_160[@i_179]) && (@2_kd_158 = @2_ke_161[@i_179])) then
    out(@2_c4[!_45], @2_x_162[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], @2_ke_164[@i_178], @2_x_165[@i_178]) && otheruses(@2_x_165[@i_178] -> @2_r2_163[@i_178]) && ((@2_m_159 = @2_r2_163[@i_178]) && (@2_kd_158 = @2_ke_164[@i_178])) then
    out(@2_c4[!_45], @2_x_165[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], @2_ke_170[@i_176], @2_x_171[@i_176]) && otheruses(@2_x_171[@i_176] -> @2_r2_169[@i_176]) && ((@2_m_159 = @2_r2_169[@i_176]) && (@2_kd_158 = @2_ke_170[@i_176])) then
    out(@2_c4[!_45], @2_x_171[@i_176])
  else
    new @2_r4_157: G;
    out(@2_c4[!_45], @2_r4_157)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_46], h0(x1, x2, x3, x4, x5))
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of useless yields

Game 14 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let @2_m_174: G = cst_G in
  let @2_kd_173: passwd = cst_passwd in
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @2_kd_158[@i_246], @2_m_159[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @2_r4_157[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = @2_r4_157[@i_246] in
    let K_u: G = exp(@2_r4_157[@i_246], x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((@2_r4_157[@i_246] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, @2_r4_157[@i_246], K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, @2_r4_157[@i_246], K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @2_m_174[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @2_r4_172[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = @2_r4_172[@i_241] in
    let K_u: G = exp(@2_r4_172[@i_241], x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((@2_r4_172[@i_241] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, @2_r4_172[@i_241], K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, @2_r4_172[@i_241], K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_ke[@i_239], @2_x[@i_239], @2_x_162[@i_239], @2_ke_161[@i_239], @2_r2_160[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
  (
    let Y_u: G = @2_x[@i_239] in
    let K_u: G = exp(@2_x[@i_239], x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((@2_x[@i_239] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, @2_x[@i_239], K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, @2_x[@i_239], K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_238 <= NP suchthat defined(Yp[@i_238], @2_x_165[@i_238], @2_r2_163[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Yp[@i_238], K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Yp[@i_238], K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(Y[@i_236], @2_x_171[@i_236], @2_r2_169[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y[@i_236], K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y[@i_236], K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  else
    new @2_r4_172: G;
    let Y_u: G = @2_r4_172 in
    let K_u: G = exp(@2_r4_172, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let sk_u: hash0 = h0(U, S, X, @2_r4_172, K_u) in
    event termU(U, X, S, Ystar_u, r1_90, sk_u);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let @2_x_171: G = cst_G in
  let @2_ke_170: passwd = cst_passwd in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_90[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @2_kd_158[@i_222], @2_m_159[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @2_r4_157[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@2_r4_157[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @2_m_174[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @2_r4_172[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@2_r4_172[@i_217] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let @2_x_165: G = cst_G in
  let @2_ke_164: passwd = cst_passwd in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  let @2_x_162: G = cst_G in
  let @2_ke_161: passwd = cst_passwd in
  find [unique] @i_198 <= qD suchthat defined(@2_kd[@i_198], @2_m[@i_198], @2_m_159[@i_198], @2_kd_158[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @2_r4_157[@i_198]) && ((@2_x = @2_r4_157[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(pw, Ystar_u[@i_193], @2_m_174[@i_193], @2_kd_173[@i_193], @2_r4_172[@i_193]) && otheruses(Ystar_u[@i_193] -> @2_r4_172[@i_193]) && ((@2_x = @2_r4_172[@i_193]) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_ke_161[@i_191], @2_x_162[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], pw, @2_ke_164[@i_190], @2_x_165[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], pw, @2_ke_170[@i_188], @2_x_171[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  let @2_m_159: G = cst_G in
  let @2_kd_158: passwd = cst_passwd in
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @2_kd_158[@i_186], @2_m_159[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @2_r4_157[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @2_r4_157[@i_186])
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], pw, @2_kd_173[@i_181], @2_m_174[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @2_r4_172[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], @2_r4_172[@i_181])
  orfind @i_179 <= qE suchthat defined(@2_ke[@i_179], @2_x[@i_179], @2_x_162[@i_179], @2_ke_161[@i_179], @2_r2_160[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(pw, Yp[@i_178], @2_x_165[@i_178], @2_ke_164[@i_178], @2_r2_163[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(pw, Y[@i_176], @2_x_171[@i_176], @2_ke_170[@i_176], @2_r2_169[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @2_r4_157: G;
    out(@2_c4[!_45], @2_r4_157)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_46], h0(x1, x2, x3, x4, x5))
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying insert event Encrypt at occurrence 1472 [Excluding set(event Encrypt in game 15)] yields

Game 15 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let @2_m_174: G = cst_G in
  let @2_kd_173: passwd = cst_passwd in
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @2_kd_158[@i_246], @2_m_159[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @2_r4_157[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = @2_r4_157[@i_246] in
    let K_u: G = exp(@2_r4_157[@i_246], x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((@2_r4_157[@i_246] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, @2_r4_157[@i_246], K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, @2_r4_157[@i_246], K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @2_m_174[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @2_r4_172[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = @2_r4_172[@i_241] in
    let K_u: G = exp(@2_r4_172[@i_241], x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((@2_r4_172[@i_241] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, @2_r4_172[@i_241], K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, @2_r4_172[@i_241], K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_ke[@i_239], @2_x[@i_239], @2_x_162[@i_239], @2_ke_161[@i_239], @2_r2_160[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(Yp[@i_238], @2_x_165[@i_238], @2_r2_163[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Yp[@i_238], K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Yp[@i_238], K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(Y[@i_236], @2_x_171[@i_236], @2_r2_169[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let sk_u: hash0 = h0(U, S, X, Y[@i_236], K_u) in
      event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
      out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let sk_u: hash0 = h0(U, S, X, Y[@i_236], K_u) in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
  )
  else
    new @2_r4_172: G;
    let Y_u: G = @2_r4_172 in
    let K_u: G = exp(@2_r4_172, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let sk_u: hash0 = h0(U, S, X, @2_r4_172, K_u) in
    event termU(U, X, S, Ystar_u, r1_90, sk_u);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let @2_x_171: G = cst_G in
  let @2_ke_170: passwd = cst_passwd in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_90[j]) then
      let sk_s: hash0 = h0(U, S, X_s, Y, K_s) in
      event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @2_kd_158[@i_222], @2_m_159[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @2_r4_157[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@2_r4_157[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @2_m_174[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @2_r4_172[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@2_r4_172[@i_217] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let @2_x_165: G = cst_G in
  let @2_ke_164: passwd = cst_passwd in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let sk_p: hash0 = h0(U, S, Xp, Yp, Kp) in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  let @2_x_162: G = cst_G in
  let @2_ke_161: passwd = cst_passwd in
  find [unique] @i_198 <= qD suchthat defined(@2_kd[@i_198], @2_m[@i_198], @2_m_159[@i_198], @2_kd_158[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @2_r4_157[@i_198]) && ((@2_x = @2_r4_157[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(pw, Ystar_u[@i_193], @2_m_174[@i_193], @2_kd_173[@i_193], @2_r4_172[@i_193]) && otheruses(Ystar_u[@i_193] -> @2_r4_172[@i_193]) && ((@2_x = @2_r4_172[@i_193]) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_ke_161[@i_191], @2_x_162[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], pw, @2_ke_164[@i_190], @2_x_165[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], pw, @2_ke_170[@i_188], @2_x_171[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  let @2_m_159: G = cst_G in
  let @2_kd_158: passwd = cst_passwd in
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @2_kd_158[@i_186], @2_m_159[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @2_r4_157[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @2_r4_157[@i_186])
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], pw, @2_kd_173[@i_181], @2_m_174[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @2_r4_172[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], @2_r4_172[@i_181])
  orfind @i_179 <= qE suchthat defined(@2_ke[@i_179], @2_x[@i_179], @2_x_162[@i_179], @2_ke_161[@i_179], @2_r2_160[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(pw, Yp[@i_178], @2_x_165[@i_178], @2_ke_164[@i_178], @2_r2_163[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(pw, Y[@i_176], @2_x_171[@i_176], @2_ke_170[@i_176], @2_r2_169[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @2_r4_157: G;
    out(@2_c4[!_45], @2_r4_157)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  out(c20[!_46], h0(x1, x2, x3, x4, x5))
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying equivalence
equiv ! !_37 <= N (x1: host, x2: host, x3: G, x4: G, x5: G) -> h0(x1, x2, x3, x4, x5) [all]
<=(0)=>
      ! !_38 <= N (x1_61: host, x2_60: host, x3_59: G, x4_58: G, x5_57: G) -> let x1: host = x1_61 in let x2: host = x2_60 in let x3: G = x3_59 in let x4: G = x4_58 in let x5: G = x5_57 in find [unique] j <= N suchthat defined(x1[j], x2[j], x3[j], x4[j], x5[j], r[j]) && otheruses(r[j]) && ((x1 = x1[j]) && ((x2 = x2[j]) && ((x3 = x3[j]) && ((x4 = x4[j]) && (x5 = x5[j]))))) then r[j] else new r: hash0; r
 yields

Game 16 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let @2_m_174: G = cst_G in
  let @2_kd_173: passwd = cst_passwd in
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @2_kd_158[@i_246], @2_m_159[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @2_r4_157[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = @2_r4_157[@i_246] in
    let K_u: G = exp(@2_r4_157[@i_246], x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((@2_r4_157[@i_246] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      let x3_423: G = X in
      let x4_422: G = @2_r4_157[@i_246] in
      let x5_421: G = K_u in
      find [unique] @i_552 <= qH0 suchthat defined(x1_389[@i_552], x2_388[@i_552], x3_387[@i_552], x4_386[@i_552], x5_385[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && ((x1_425 = x1_389[@i_552]) && ((x2_424 = x2_388[@i_552]) && ((x3_423 = x3_387[@i_552]) && ((x4_422 = x4_386[@i_552]) && (x5_421 = x5_385[@i_552]))))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_551 <= NP suchthat defined(x1_395[@i_551], x2_394[@i_551], x3_393[@i_551], x4_392[@i_551], x5_391[@i_551], r_390[@i_551]) && otheruses(r_390[@i_551]) && ((x1_425 = x1_395[@i_551]) && ((x2_424 = x2_394[@i_551]) && ((x3_423 = x3_393[@i_551]) && ((x4_422 = x4_392[@i_551]) && (x5_421 = x5_391[@i_551]))))) then
      (
        let sk_u: hash0 = r_390[@i_551] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_550 <= NS suchthat defined(x1_401[@i_550], x2_400[@i_550], x3_399[@i_550], x4_398[@i_550], x5_397[@i_550], r_396[@i_550]) && otheruses(r_396[@i_550]) && ((x1_425 = x1_401[@i_550]) && ((x2_424 = x2_400[@i_550]) && ((x3_423 = x3_399[@i_550]) && ((x4_422 = x4_398[@i_550]) && (x5_421 = x5_397[@i_550]))))) then
      (
        let sk_u: hash0 = r_396[@i_550] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_549 <= NS suchthat defined(x1_407[@i_549], x2_406[@i_549], x3_405[@i_549], x4_404[@i_549], x5_403[@i_549], r_402[@i_549]) && otheruses(r_402[@i_549]) && ((x1_425 = x1_407[@i_549]) && ((x2_424 = x2_406[@i_549]) && ((x3_423 = x3_405[@i_549]) && ((x4_422 = x4_404[@i_549]) && (x5_421 = x5_403[@i_549]))))) then
      (
        let sk_u: hash0 = r_402[@i_549] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_548 <= NU suchthat defined(x1_413[@i_548], x2_412[@i_548], x3_411[@i_548], x4_410[@i_548], x5_409[@i_548], r_408[@i_548]) && otheruses(r_408[@i_548]) && ((x1_425 = x1_413[@i_548]) && ((x2_424 = x2_412[@i_548]) && ((x3_423 = x3_411[@i_548]) && ((x4_422 = x4_410[@i_548]) && (x5_421 = x5_409[@i_548]))))) then
      (
        let sk_u: hash0 = r_408[@i_548] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_547 <= NU suchthat defined(x1_419[@i_547], x2_418[@i_547], x3_417[@i_547], x4_416[@i_547], x5_415[@i_547], r_414[@i_547]) && otheruses(r_414[@i_547]) && ((x1_425 = x1_419[@i_547]) && ((x2_424 = x2_418[@i_547]) && ((x3_423 = x3_417[@i_547]) && ((x4_422 = x4_416[@i_547]) && (x5_421 = x5_415[@i_547]))))) then
      (
        let sk_u: hash0 = r_414[@i_547] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_546 <= NU suchthat defined(x1_425[@i_546], x2_424[@i_546], x3_423[@i_546], x4_422[@i_546], x5_421[@i_546], r_420[@i_546]) && otheruses(r_420[@i_546]) && ((x1_425 = x1_425[@i_546]) && ((x2_424 = x2_424[@i_546]) && ((x3_423 = x3_423[@i_546]) && ((x4_422 = x4_422[@i_546]) && (x5_421 = x5_421[@i_546]))))) then
      (
        let sk_u: hash0 = r_420[@i_546] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_545 <= NU suchthat defined(x1_431[@i_545], x2_430[@i_545], x3_429[@i_545], x4_428[@i_545], x5_427[@i_545], r_426[@i_545]) && otheruses(r_426[@i_545]) && ((x1_425 = x1_431[@i_545]) && ((x2_424 = x2_430[@i_545]) && ((x3_423 = x3_429[@i_545]) && ((x4_422 = x4_428[@i_545]) && (x5_421 = x5_427[@i_545]))))) then
      (
        let sk_u: hash0 = r_426[@i_545] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_544 <= NU suchthat defined(x1_437[@i_544], x2_436[@i_544], x3_435[@i_544], x4_434[@i_544], x5_433[@i_544], r_432[@i_544]) && otheruses(r_432[@i_544]) && ((x1_425 = x1_437[@i_544]) && ((x2_424 = x2_436[@i_544]) && ((x3_423 = x3_435[@i_544]) && ((x4_422 = x4_434[@i_544]) && (x5_421 = x5_433[@i_544]))))) then
      (
        let sk_u: hash0 = r_432[@i_544] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_543 <= NU suchthat defined(x1_443[@i_543], x2_442[@i_543], x3_441[@i_543], x4_440[@i_543], x5_439[@i_543], r_438[@i_543]) && otheruses(r_438[@i_543]) && ((x1_425 = x1_443[@i_543]) && ((x2_424 = x2_442[@i_543]) && ((x3_423 = x3_441[@i_543]) && ((x4_422 = x4_440[@i_543]) && (x5_421 = x5_439[@i_543]))))) then
      (
        let sk_u: hash0 = r_438[@i_543] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_542 <= NU suchthat defined(x1_449[@i_542], x2_448[@i_542], x3_447[@i_542], x4_446[@i_542], x5_445[@i_542], r_444[@i_542]) && otheruses(r_444[@i_542]) && ((x1_425 = x1_449[@i_542]) && ((x2_424 = x2_448[@i_542]) && ((x3_423 = x3_447[@i_542]) && ((x4_422 = x4_446[@i_542]) && (x5_421 = x5_445[@i_542]))))) then
      (
        let sk_u: hash0 = r_444[@i_542] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_541 <= NU suchthat defined(x1_455[@i_541], x2_454[@i_541], x3_453[@i_541], x4_452[@i_541], x5_451[@i_541], r_450[@i_541]) && otheruses(r_450[@i_541]) && ((x1_425 = x1_455[@i_541]) && ((x2_424 = x2_454[@i_541]) && ((x3_423 = x3_453[@i_541]) && ((x4_422 = x4_452[@i_541]) && (x5_421 = x5_451[@i_541]))))) then
      (
        let sk_u: hash0 = r_450[@i_541] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_540 <= NU suchthat defined(x1_461[@i_540], x2_460[@i_540], x3_459[@i_540], x4_458[@i_540], x5_457[@i_540], r_456[@i_540]) && otheruses(r_456[@i_540]) && ((x1_425 = x1_461[@i_540]) && ((x2_424 = x2_460[@i_540]) && ((x3_423 = x3_459[@i_540]) && ((x4_422 = x4_458[@i_540]) && (x5_421 = x5_457[@i_540]))))) then
      (
        let sk_u: hash0 = r_456[@i_540] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let x1_419: host = U in
      let x2_418: host = S in
      let x3_417: G = X in
      let x4_416: G = @2_r4_157[@i_246] in
      let x5_415: G = K_u in
      find [unique] @i_539 <= qH0 suchthat defined(x1_389[@i_539], x2_388[@i_539], x3_387[@i_539], x4_386[@i_539], x5_385[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && ((x1_419 = x1_389[@i_539]) && ((x2_418 = x2_388[@i_539]) && ((x3_417 = x3_387[@i_539]) && ((x4_416 = x4_386[@i_539]) && (x5_415 = x5_385[@i_539]))))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_538 <= NP suchthat defined(x1_395[@i_538], x2_394[@i_538], x3_393[@i_538], x4_392[@i_538], x5_391[@i_538], r_390[@i_538]) && otheruses(r_390[@i_538]) && ((x1_419 = x1_395[@i_538]) && ((x2_418 = x2_394[@i_538]) && ((x3_417 = x3_393[@i_538]) && ((x4_416 = x4_392[@i_538]) && (x5_415 = x5_391[@i_538]))))) then
      (
        let sk_u: hash0 = r_390[@i_538] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_537 <= NS suchthat defined(x1_401[@i_537], x2_400[@i_537], x3_399[@i_537], x4_398[@i_537], x5_397[@i_537], r_396[@i_537]) && otheruses(r_396[@i_537]) && ((x1_419 = x1_401[@i_537]) && ((x2_418 = x2_400[@i_537]) && ((x3_417 = x3_399[@i_537]) && ((x4_416 = x4_398[@i_537]) && (x5_415 = x5_397[@i_537]))))) then
      (
        let sk_u: hash0 = r_396[@i_537] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_536 <= NS suchthat defined(x1_407[@i_536], x2_406[@i_536], x3_405[@i_536], x4_404[@i_536], x5_403[@i_536], r_402[@i_536]) && otheruses(r_402[@i_536]) && ((x1_419 = x1_407[@i_536]) && ((x2_418 = x2_406[@i_536]) && ((x3_417 = x3_405[@i_536]) && ((x4_416 = x4_404[@i_536]) && (x5_415 = x5_403[@i_536]))))) then
      (
        let sk_u: hash0 = r_402[@i_536] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_535 <= NU suchthat defined(x1_413[@i_535], x2_412[@i_535], x3_411[@i_535], x4_410[@i_535], x5_409[@i_535], r_408[@i_535]) && otheruses(r_408[@i_535]) && ((x1_419 = x1_413[@i_535]) && ((x2_418 = x2_412[@i_535]) && ((x3_417 = x3_411[@i_535]) && ((x4_416 = x4_410[@i_535]) && (x5_415 = x5_409[@i_535]))))) then
      (
        let sk_u: hash0 = r_408[@i_535] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_534 <= NU suchthat defined(x1_419[@i_534], x2_418[@i_534], x3_417[@i_534], x4_416[@i_534], x5_415[@i_534], r_414[@i_534]) && otheruses(r_414[@i_534]) && ((x1_419 = x1_419[@i_534]) && ((x2_418 = x2_418[@i_534]) && ((x3_417 = x3_417[@i_534]) && ((x4_416 = x4_416[@i_534]) && (x5_415 = x5_415[@i_534]))))) then
      (
        let sk_u: hash0 = r_414[@i_534] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_533 <= NU suchthat defined(x1_425[@i_533], x2_424[@i_533], x3_423[@i_533], x4_422[@i_533], x5_421[@i_533], r_420[@i_533]) && otheruses(r_420[@i_533]) && ((x1_419 = x1_425[@i_533]) && ((x2_418 = x2_424[@i_533]) && ((x3_417 = x3_423[@i_533]) && ((x4_416 = x4_422[@i_533]) && (x5_415 = x5_421[@i_533]))))) then
      (
        let sk_u: hash0 = r_420[@i_533] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_532 <= NU suchthat defined(x1_431[@i_532], x2_430[@i_532], x3_429[@i_532], x4_428[@i_532], x5_427[@i_532], r_426[@i_532]) && otheruses(r_426[@i_532]) && ((x1_419 = x1_431[@i_532]) && ((x2_418 = x2_430[@i_532]) && ((x3_417 = x3_429[@i_532]) && ((x4_416 = x4_428[@i_532]) && (x5_415 = x5_427[@i_532]))))) then
      (
        let sk_u: hash0 = r_426[@i_532] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_531 <= NU suchthat defined(x1_437[@i_531], x2_436[@i_531], x3_435[@i_531], x4_434[@i_531], x5_433[@i_531], r_432[@i_531]) && otheruses(r_432[@i_531]) && ((x1_419 = x1_437[@i_531]) && ((x2_418 = x2_436[@i_531]) && ((x3_417 = x3_435[@i_531]) && ((x4_416 = x4_434[@i_531]) && (x5_415 = x5_433[@i_531]))))) then
      (
        let sk_u: hash0 = r_432[@i_531] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_530 <= NU suchthat defined(x1_443[@i_530], x2_442[@i_530], x3_441[@i_530], x4_440[@i_530], x5_439[@i_530], r_438[@i_530]) && otheruses(r_438[@i_530]) && ((x1_419 = x1_443[@i_530]) && ((x2_418 = x2_442[@i_530]) && ((x3_417 = x3_441[@i_530]) && ((x4_416 = x4_440[@i_530]) && (x5_415 = x5_439[@i_530]))))) then
      (
        let sk_u: hash0 = r_438[@i_530] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_529 <= NU suchthat defined(x1_449[@i_529], x2_448[@i_529], x3_447[@i_529], x4_446[@i_529], x5_445[@i_529], r_444[@i_529]) && otheruses(r_444[@i_529]) && ((x1_419 = x1_449[@i_529]) && ((x2_418 = x2_448[@i_529]) && ((x3_417 = x3_447[@i_529]) && ((x4_416 = x4_446[@i_529]) && (x5_415 = x5_445[@i_529]))))) then
      (
        let sk_u: hash0 = r_444[@i_529] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_528 <= NU suchthat defined(x1_455[@i_528], x2_454[@i_528], x3_453[@i_528], x4_452[@i_528], x5_451[@i_528], r_450[@i_528]) && otheruses(r_450[@i_528]) && ((x1_419 = x1_455[@i_528]) && ((x2_418 = x2_454[@i_528]) && ((x3_417 = x3_453[@i_528]) && ((x4_416 = x4_452[@i_528]) && (x5_415 = x5_451[@i_528]))))) then
      (
        let sk_u: hash0 = r_450[@i_528] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_527 <= NU suchthat defined(x1_461[@i_527], x2_460[@i_527], x3_459[@i_527], x4_458[@i_527], x5_457[@i_527], r_456[@i_527]) && otheruses(r_456[@i_527]) && ((x1_419 = x1_461[@i_527]) && ((x2_418 = x2_460[@i_527]) && ((x3_417 = x3_459[@i_527]) && ((x4_416 = x4_458[@i_527]) && (x5_415 = x5_457[@i_527]))))) then
      (
        let sk_u: hash0 = r_456[@i_527] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @2_m_174[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @2_r4_172[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = @2_r4_172[@i_241] in
    let K_u: G = exp(@2_r4_172[@i_241], x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((@2_r4_172[@i_241] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      let x3_435: G = X in
      let x4_434: G = @2_r4_172[@i_241] in
      let x5_433: G = K_u in
      find [unique] @i_578 <= qH0 suchthat defined(x1_389[@i_578], x2_388[@i_578], x3_387[@i_578], x4_386[@i_578], x5_385[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && ((x1_437 = x1_389[@i_578]) && ((x2_436 = x2_388[@i_578]) && ((x3_435 = x3_387[@i_578]) && ((x4_434 = x4_386[@i_578]) && (x5_433 = x5_385[@i_578]))))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_577 <= NP suchthat defined(x1_395[@i_577], x2_394[@i_577], x3_393[@i_577], x4_392[@i_577], x5_391[@i_577], r_390[@i_577]) && otheruses(r_390[@i_577]) && ((x1_437 = x1_395[@i_577]) && ((x2_436 = x2_394[@i_577]) && ((x3_435 = x3_393[@i_577]) && ((x4_434 = x4_392[@i_577]) && (x5_433 = x5_391[@i_577]))))) then
      (
        let sk_u: hash0 = r_390[@i_577] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_576 <= NS suchthat defined(x1_401[@i_576], x2_400[@i_576], x3_399[@i_576], x4_398[@i_576], x5_397[@i_576], r_396[@i_576]) && otheruses(r_396[@i_576]) && ((x1_437 = x1_401[@i_576]) && ((x2_436 = x2_400[@i_576]) && ((x3_435 = x3_399[@i_576]) && ((x4_434 = x4_398[@i_576]) && (x5_433 = x5_397[@i_576]))))) then
      (
        let sk_u: hash0 = r_396[@i_576] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_575 <= NS suchthat defined(x1_407[@i_575], x2_406[@i_575], x3_405[@i_575], x4_404[@i_575], x5_403[@i_575], r_402[@i_575]) && otheruses(r_402[@i_575]) && ((x1_437 = x1_407[@i_575]) && ((x2_436 = x2_406[@i_575]) && ((x3_435 = x3_405[@i_575]) && ((x4_434 = x4_404[@i_575]) && (x5_433 = x5_403[@i_575]))))) then
      (
        let sk_u: hash0 = r_402[@i_575] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_574 <= NU suchthat defined(x1_413[@i_574], x2_412[@i_574], x3_411[@i_574], x4_410[@i_574], x5_409[@i_574], r_408[@i_574]) && otheruses(r_408[@i_574]) && ((x1_437 = x1_413[@i_574]) && ((x2_436 = x2_412[@i_574]) && ((x3_435 = x3_411[@i_574]) && ((x4_434 = x4_410[@i_574]) && (x5_433 = x5_409[@i_574]))))) then
      (
        let sk_u: hash0 = r_408[@i_574] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_573 <= NU suchthat defined(x1_419[@i_573], x2_418[@i_573], x3_417[@i_573], x4_416[@i_573], x5_415[@i_573], r_414[@i_573]) && otheruses(r_414[@i_573]) && ((x1_437 = x1_419[@i_573]) && ((x2_436 = x2_418[@i_573]) && ((x3_435 = x3_417[@i_573]) && ((x4_434 = x4_416[@i_573]) && (x5_433 = x5_415[@i_573]))))) then
      (
        let sk_u: hash0 = r_414[@i_573] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_572 <= NU suchthat defined(x1_425[@i_572], x2_424[@i_572], x3_423[@i_572], x4_422[@i_572], x5_421[@i_572], r_420[@i_572]) && otheruses(r_420[@i_572]) && ((x1_437 = x1_425[@i_572]) && ((x2_436 = x2_424[@i_572]) && ((x3_435 = x3_423[@i_572]) && ((x4_434 = x4_422[@i_572]) && (x5_433 = x5_421[@i_572]))))) then
      (
        let sk_u: hash0 = r_420[@i_572] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_571 <= NU suchthat defined(x1_431[@i_571], x2_430[@i_571], x3_429[@i_571], x4_428[@i_571], x5_427[@i_571], r_426[@i_571]) && otheruses(r_426[@i_571]) && ((x1_437 = x1_431[@i_571]) && ((x2_436 = x2_430[@i_571]) && ((x3_435 = x3_429[@i_571]) && ((x4_434 = x4_428[@i_571]) && (x5_433 = x5_427[@i_571]))))) then
      (
        let sk_u: hash0 = r_426[@i_571] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_570 <= NU suchthat defined(x1_437[@i_570], x2_436[@i_570], x3_435[@i_570], x4_434[@i_570], x5_433[@i_570], r_432[@i_570]) && otheruses(r_432[@i_570]) && ((x1_437 = x1_437[@i_570]) && ((x2_436 = x2_436[@i_570]) && ((x3_435 = x3_435[@i_570]) && ((x4_434 = x4_434[@i_570]) && (x5_433 = x5_433[@i_570]))))) then
      (
        let sk_u: hash0 = r_432[@i_570] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_569 <= NU suchthat defined(x1_443[@i_569], x2_442[@i_569], x3_441[@i_569], x4_440[@i_569], x5_439[@i_569], r_438[@i_569]) && otheruses(r_438[@i_569]) && ((x1_437 = x1_443[@i_569]) && ((x2_436 = x2_442[@i_569]) && ((x3_435 = x3_441[@i_569]) && ((x4_434 = x4_440[@i_569]) && (x5_433 = x5_439[@i_569]))))) then
      (
        let sk_u: hash0 = r_438[@i_569] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_568 <= NU suchthat defined(x1_449[@i_568], x2_448[@i_568], x3_447[@i_568], x4_446[@i_568], x5_445[@i_568], r_444[@i_568]) && otheruses(r_444[@i_568]) && ((x1_437 = x1_449[@i_568]) && ((x2_436 = x2_448[@i_568]) && ((x3_435 = x3_447[@i_568]) && ((x4_434 = x4_446[@i_568]) && (x5_433 = x5_445[@i_568]))))) then
      (
        let sk_u: hash0 = r_444[@i_568] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_567 <= NU suchthat defined(x1_455[@i_567], x2_454[@i_567], x3_453[@i_567], x4_452[@i_567], x5_451[@i_567], r_450[@i_567]) && otheruses(r_450[@i_567]) && ((x1_437 = x1_455[@i_567]) && ((x2_436 = x2_454[@i_567]) && ((x3_435 = x3_453[@i_567]) && ((x4_434 = x4_452[@i_567]) && (x5_433 = x5_451[@i_567]))))) then
      (
        let sk_u: hash0 = r_450[@i_567] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_566 <= NU suchthat defined(x1_461[@i_566], x2_460[@i_566], x3_459[@i_566], x4_458[@i_566], x5_457[@i_566], r_456[@i_566]) && otheruses(r_456[@i_566]) && ((x1_437 = x1_461[@i_566]) && ((x2_436 = x2_460[@i_566]) && ((x3_435 = x3_459[@i_566]) && ((x4_434 = x4_458[@i_566]) && (x5_433 = x5_457[@i_566]))))) then
      (
        let sk_u: hash0 = r_456[@i_566] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let x1_431: host = U in
      let x2_430: host = S in
      let x3_429: G = X in
      let x4_428: G = @2_r4_172[@i_241] in
      let x5_427: G = K_u in
      find [unique] @i_565 <= qH0 suchthat defined(x1_389[@i_565], x2_388[@i_565], x3_387[@i_565], x4_386[@i_565], x5_385[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && ((x1_431 = x1_389[@i_565]) && ((x2_430 = x2_388[@i_565]) && ((x3_429 = x3_387[@i_565]) && ((x4_428 = x4_386[@i_565]) && (x5_427 = x5_385[@i_565]))))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_564 <= NP suchthat defined(x1_395[@i_564], x2_394[@i_564], x3_393[@i_564], x4_392[@i_564], x5_391[@i_564], r_390[@i_564]) && otheruses(r_390[@i_564]) && ((x1_431 = x1_395[@i_564]) && ((x2_430 = x2_394[@i_564]) && ((x3_429 = x3_393[@i_564]) && ((x4_428 = x4_392[@i_564]) && (x5_427 = x5_391[@i_564]))))) then
      (
        let sk_u: hash0 = r_390[@i_564] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_563 <= NS suchthat defined(x1_401[@i_563], x2_400[@i_563], x3_399[@i_563], x4_398[@i_563], x5_397[@i_563], r_396[@i_563]) && otheruses(r_396[@i_563]) && ((x1_431 = x1_401[@i_563]) && ((x2_430 = x2_400[@i_563]) && ((x3_429 = x3_399[@i_563]) && ((x4_428 = x4_398[@i_563]) && (x5_427 = x5_397[@i_563]))))) then
      (
        let sk_u: hash0 = r_396[@i_563] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_562 <= NS suchthat defined(x1_407[@i_562], x2_406[@i_562], x3_405[@i_562], x4_404[@i_562], x5_403[@i_562], r_402[@i_562]) && otheruses(r_402[@i_562]) && ((x1_431 = x1_407[@i_562]) && ((x2_430 = x2_406[@i_562]) && ((x3_429 = x3_405[@i_562]) && ((x4_428 = x4_404[@i_562]) && (x5_427 = x5_403[@i_562]))))) then
      (
        let sk_u: hash0 = r_402[@i_562] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_561 <= NU suchthat defined(x1_413[@i_561], x2_412[@i_561], x3_411[@i_561], x4_410[@i_561], x5_409[@i_561], r_408[@i_561]) && otheruses(r_408[@i_561]) && ((x1_431 = x1_413[@i_561]) && ((x2_430 = x2_412[@i_561]) && ((x3_429 = x3_411[@i_561]) && ((x4_428 = x4_410[@i_561]) && (x5_427 = x5_409[@i_561]))))) then
      (
        let sk_u: hash0 = r_408[@i_561] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_560 <= NU suchthat defined(x1_419[@i_560], x2_418[@i_560], x3_417[@i_560], x4_416[@i_560], x5_415[@i_560], r_414[@i_560]) && otheruses(r_414[@i_560]) && ((x1_431 = x1_419[@i_560]) && ((x2_430 = x2_418[@i_560]) && ((x3_429 = x3_417[@i_560]) && ((x4_428 = x4_416[@i_560]) && (x5_427 = x5_415[@i_560]))))) then
      (
        let sk_u: hash0 = r_414[@i_560] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_559 <= NU suchthat defined(x1_425[@i_559], x2_424[@i_559], x3_423[@i_559], x4_422[@i_559], x5_421[@i_559], r_420[@i_559]) && otheruses(r_420[@i_559]) && ((x1_431 = x1_425[@i_559]) && ((x2_430 = x2_424[@i_559]) && ((x3_429 = x3_423[@i_559]) && ((x4_428 = x4_422[@i_559]) && (x5_427 = x5_421[@i_559]))))) then
      (
        let sk_u: hash0 = r_420[@i_559] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_558 <= NU suchthat defined(x1_431[@i_558], x2_430[@i_558], x3_429[@i_558], x4_428[@i_558], x5_427[@i_558], r_426[@i_558]) && otheruses(r_426[@i_558]) && ((x1_431 = x1_431[@i_558]) && ((x2_430 = x2_430[@i_558]) && ((x3_429 = x3_429[@i_558]) && ((x4_428 = x4_428[@i_558]) && (x5_427 = x5_427[@i_558]))))) then
      (
        let sk_u: hash0 = r_426[@i_558] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_557 <= NU suchthat defined(x1_437[@i_557], x2_436[@i_557], x3_435[@i_557], x4_434[@i_557], x5_433[@i_557], r_432[@i_557]) && otheruses(r_432[@i_557]) && ((x1_431 = x1_437[@i_557]) && ((x2_430 = x2_436[@i_557]) && ((x3_429 = x3_435[@i_557]) && ((x4_428 = x4_434[@i_557]) && (x5_427 = x5_433[@i_557]))))) then
      (
        let sk_u: hash0 = r_432[@i_557] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_556 <= NU suchthat defined(x1_443[@i_556], x2_442[@i_556], x3_441[@i_556], x4_440[@i_556], x5_439[@i_556], r_438[@i_556]) && otheruses(r_438[@i_556]) && ((x1_431 = x1_443[@i_556]) && ((x2_430 = x2_442[@i_556]) && ((x3_429 = x3_441[@i_556]) && ((x4_428 = x4_440[@i_556]) && (x5_427 = x5_439[@i_556]))))) then
      (
        let sk_u: hash0 = r_438[@i_556] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_555 <= NU suchthat defined(x1_449[@i_555], x2_448[@i_555], x3_447[@i_555], x4_446[@i_555], x5_445[@i_555], r_444[@i_555]) && otheruses(r_444[@i_555]) && ((x1_431 = x1_449[@i_555]) && ((x2_430 = x2_448[@i_555]) && ((x3_429 = x3_447[@i_555]) && ((x4_428 = x4_446[@i_555]) && (x5_427 = x5_445[@i_555]))))) then
      (
        let sk_u: hash0 = r_444[@i_555] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_554 <= NU suchthat defined(x1_455[@i_554], x2_454[@i_554], x3_453[@i_554], x4_452[@i_554], x5_451[@i_554], r_450[@i_554]) && otheruses(r_450[@i_554]) && ((x1_431 = x1_455[@i_554]) && ((x2_430 = x2_454[@i_554]) && ((x3_429 = x3_453[@i_554]) && ((x4_428 = x4_452[@i_554]) && (x5_427 = x5_451[@i_554]))))) then
      (
        let sk_u: hash0 = r_450[@i_554] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_553 <= NU suchthat defined(x1_461[@i_553], x2_460[@i_553], x3_459[@i_553], x4_458[@i_553], x5_457[@i_553], r_456[@i_553]) && otheruses(r_456[@i_553]) && ((x1_431 = x1_461[@i_553]) && ((x2_430 = x2_460[@i_553]) && ((x3_429 = x3_459[@i_553]) && ((x4_428 = x4_458[@i_553]) && (x5_427 = x5_457[@i_553]))))) then
      (
        let sk_u: hash0 = r_456[@i_553] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_ke[@i_239], @2_x[@i_239], @2_x_162[@i_239], @2_ke_161[@i_239], @2_r2_160[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(Yp[@i_238], @2_x_165[@i_238], @2_r2_163[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      let x3_447: G = X in
      let x4_446: G = Yp[@i_238] in
      let x5_445: G = K_u in
      find [unique] @i_604 <= qH0 suchthat defined(x1_389[@i_604], x2_388[@i_604], x3_387[@i_604], x4_386[@i_604], x5_385[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && ((x1_449 = x1_389[@i_604]) && ((x2_448 = x2_388[@i_604]) && ((x3_447 = x3_387[@i_604]) && ((x4_446 = x4_386[@i_604]) && (x5_445 = x5_385[@i_604]))))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_603 <= NP suchthat defined(x1_395[@i_603], x2_394[@i_603], x3_393[@i_603], x4_392[@i_603], x5_391[@i_603], r_390[@i_603]) && otheruses(r_390[@i_603]) && ((x1_449 = x1_395[@i_603]) && ((x2_448 = x2_394[@i_603]) && ((x3_447 = x3_393[@i_603]) && ((x4_446 = x4_392[@i_603]) && (x5_445 = x5_391[@i_603]))))) then
      (
        let sk_u: hash0 = r_390[@i_603] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_602 <= NS suchthat defined(x1_401[@i_602], x2_400[@i_602], x3_399[@i_602], x4_398[@i_602], x5_397[@i_602], r_396[@i_602]) && otheruses(r_396[@i_602]) && ((x1_449 = x1_401[@i_602]) && ((x2_448 = x2_400[@i_602]) && ((x3_447 = x3_399[@i_602]) && ((x4_446 = x4_398[@i_602]) && (x5_445 = x5_397[@i_602]))))) then
      (
        let sk_u: hash0 = r_396[@i_602] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_601 <= NS suchthat defined(x1_407[@i_601], x2_406[@i_601], x3_405[@i_601], x4_404[@i_601], x5_403[@i_601], r_402[@i_601]) && otheruses(r_402[@i_601]) && ((x1_449 = x1_407[@i_601]) && ((x2_448 = x2_406[@i_601]) && ((x3_447 = x3_405[@i_601]) && ((x4_446 = x4_404[@i_601]) && (x5_445 = x5_403[@i_601]))))) then
      (
        let sk_u: hash0 = r_402[@i_601] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_600 <= NU suchthat defined(x1_413[@i_600], x2_412[@i_600], x3_411[@i_600], x4_410[@i_600], x5_409[@i_600], r_408[@i_600]) && otheruses(r_408[@i_600]) && ((x1_449 = x1_413[@i_600]) && ((x2_448 = x2_412[@i_600]) && ((x3_447 = x3_411[@i_600]) && ((x4_446 = x4_410[@i_600]) && (x5_445 = x5_409[@i_600]))))) then
      (
        let sk_u: hash0 = r_408[@i_600] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_599 <= NU suchthat defined(x1_419[@i_599], x2_418[@i_599], x3_417[@i_599], x4_416[@i_599], x5_415[@i_599], r_414[@i_599]) && otheruses(r_414[@i_599]) && ((x1_449 = x1_419[@i_599]) && ((x2_448 = x2_418[@i_599]) && ((x3_447 = x3_417[@i_599]) && ((x4_446 = x4_416[@i_599]) && (x5_445 = x5_415[@i_599]))))) then
      (
        let sk_u: hash0 = r_414[@i_599] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_598 <= NU suchthat defined(x1_425[@i_598], x2_424[@i_598], x3_423[@i_598], x4_422[@i_598], x5_421[@i_598], r_420[@i_598]) && otheruses(r_420[@i_598]) && ((x1_449 = x1_425[@i_598]) && ((x2_448 = x2_424[@i_598]) && ((x3_447 = x3_423[@i_598]) && ((x4_446 = x4_422[@i_598]) && (x5_445 = x5_421[@i_598]))))) then
      (
        let sk_u: hash0 = r_420[@i_598] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_597 <= NU suchthat defined(x1_431[@i_597], x2_430[@i_597], x3_429[@i_597], x4_428[@i_597], x5_427[@i_597], r_426[@i_597]) && otheruses(r_426[@i_597]) && ((x1_449 = x1_431[@i_597]) && ((x2_448 = x2_430[@i_597]) && ((x3_447 = x3_429[@i_597]) && ((x4_446 = x4_428[@i_597]) && (x5_445 = x5_427[@i_597]))))) then
      (
        let sk_u: hash0 = r_426[@i_597] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_596 <= NU suchthat defined(x1_437[@i_596], x2_436[@i_596], x3_435[@i_596], x4_434[@i_596], x5_433[@i_596], r_432[@i_596]) && otheruses(r_432[@i_596]) && ((x1_449 = x1_437[@i_596]) && ((x2_448 = x2_436[@i_596]) && ((x3_447 = x3_435[@i_596]) && ((x4_446 = x4_434[@i_596]) && (x5_445 = x5_433[@i_596]))))) then
      (
        let sk_u: hash0 = r_432[@i_596] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_595 <= NU suchthat defined(x1_443[@i_595], x2_442[@i_595], x3_441[@i_595], x4_440[@i_595], x5_439[@i_595], r_438[@i_595]) && otheruses(r_438[@i_595]) && ((x1_449 = x1_443[@i_595]) && ((x2_448 = x2_442[@i_595]) && ((x3_447 = x3_441[@i_595]) && ((x4_446 = x4_440[@i_595]) && (x5_445 = x5_439[@i_595]))))) then
      (
        let sk_u: hash0 = r_438[@i_595] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_594 <= NU suchthat defined(x1_449[@i_594], x2_448[@i_594], x3_447[@i_594], x4_446[@i_594], x5_445[@i_594], r_444[@i_594]) && otheruses(r_444[@i_594]) && ((x1_449 = x1_449[@i_594]) && ((x2_448 = x2_448[@i_594]) && ((x3_447 = x3_447[@i_594]) && ((x4_446 = x4_446[@i_594]) && (x5_445 = x5_445[@i_594]))))) then
      (
        let sk_u: hash0 = r_444[@i_594] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_593 <= NU suchthat defined(x1_455[@i_593], x2_454[@i_593], x3_453[@i_593], x4_452[@i_593], x5_451[@i_593], r_450[@i_593]) && otheruses(r_450[@i_593]) && ((x1_449 = x1_455[@i_593]) && ((x2_448 = x2_454[@i_593]) && ((x3_447 = x3_453[@i_593]) && ((x4_446 = x4_452[@i_593]) && (x5_445 = x5_451[@i_593]))))) then
      (
        let sk_u: hash0 = r_450[@i_593] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_592 <= NU suchthat defined(x1_461[@i_592], x2_460[@i_592], x3_459[@i_592], x4_458[@i_592], x5_457[@i_592], r_456[@i_592]) && otheruses(r_456[@i_592]) && ((x1_449 = x1_461[@i_592]) && ((x2_448 = x2_460[@i_592]) && ((x3_447 = x3_459[@i_592]) && ((x4_446 = x4_458[@i_592]) && (x5_445 = x5_457[@i_592]))))) then
      (
        let sk_u: hash0 = r_456[@i_592] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let x1_443: host = U in
      let x2_442: host = S in
      let x3_441: G = X in
      let x4_440: G = Yp[@i_238] in
      let x5_439: G = K_u in
      find [unique] @i_591 <= qH0 suchthat defined(x1_389[@i_591], x2_388[@i_591], x3_387[@i_591], x4_386[@i_591], x5_385[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && ((x1_443 = x1_389[@i_591]) && ((x2_442 = x2_388[@i_591]) && ((x3_441 = x3_387[@i_591]) && ((x4_440 = x4_386[@i_591]) && (x5_439 = x5_385[@i_591]))))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_590 <= NP suchthat defined(x1_395[@i_590], x2_394[@i_590], x3_393[@i_590], x4_392[@i_590], x5_391[@i_590], r_390[@i_590]) && otheruses(r_390[@i_590]) && ((x1_443 = x1_395[@i_590]) && ((x2_442 = x2_394[@i_590]) && ((x3_441 = x3_393[@i_590]) && ((x4_440 = x4_392[@i_590]) && (x5_439 = x5_391[@i_590]))))) then
      (
        let sk_u: hash0 = r_390[@i_590] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_589 <= NS suchthat defined(x1_401[@i_589], x2_400[@i_589], x3_399[@i_589], x4_398[@i_589], x5_397[@i_589], r_396[@i_589]) && otheruses(r_396[@i_589]) && ((x1_443 = x1_401[@i_589]) && ((x2_442 = x2_400[@i_589]) && ((x3_441 = x3_399[@i_589]) && ((x4_440 = x4_398[@i_589]) && (x5_439 = x5_397[@i_589]))))) then
      (
        let sk_u: hash0 = r_396[@i_589] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_588 <= NS suchthat defined(x1_407[@i_588], x2_406[@i_588], x3_405[@i_588], x4_404[@i_588], x5_403[@i_588], r_402[@i_588]) && otheruses(r_402[@i_588]) && ((x1_443 = x1_407[@i_588]) && ((x2_442 = x2_406[@i_588]) && ((x3_441 = x3_405[@i_588]) && ((x4_440 = x4_404[@i_588]) && (x5_439 = x5_403[@i_588]))))) then
      (
        let sk_u: hash0 = r_402[@i_588] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_587 <= NU suchthat defined(x1_413[@i_587], x2_412[@i_587], x3_411[@i_587], x4_410[@i_587], x5_409[@i_587], r_408[@i_587]) && otheruses(r_408[@i_587]) && ((x1_443 = x1_413[@i_587]) && ((x2_442 = x2_412[@i_587]) && ((x3_441 = x3_411[@i_587]) && ((x4_440 = x4_410[@i_587]) && (x5_439 = x5_409[@i_587]))))) then
      (
        let sk_u: hash0 = r_408[@i_587] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_586 <= NU suchthat defined(x1_419[@i_586], x2_418[@i_586], x3_417[@i_586], x4_416[@i_586], x5_415[@i_586], r_414[@i_586]) && otheruses(r_414[@i_586]) && ((x1_443 = x1_419[@i_586]) && ((x2_442 = x2_418[@i_586]) && ((x3_441 = x3_417[@i_586]) && ((x4_440 = x4_416[@i_586]) && (x5_439 = x5_415[@i_586]))))) then
      (
        let sk_u: hash0 = r_414[@i_586] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_585 <= NU suchthat defined(x1_425[@i_585], x2_424[@i_585], x3_423[@i_585], x4_422[@i_585], x5_421[@i_585], r_420[@i_585]) && otheruses(r_420[@i_585]) && ((x1_443 = x1_425[@i_585]) && ((x2_442 = x2_424[@i_585]) && ((x3_441 = x3_423[@i_585]) && ((x4_440 = x4_422[@i_585]) && (x5_439 = x5_421[@i_585]))))) then
      (
        let sk_u: hash0 = r_420[@i_585] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_584 <= NU suchthat defined(x1_431[@i_584], x2_430[@i_584], x3_429[@i_584], x4_428[@i_584], x5_427[@i_584], r_426[@i_584]) && otheruses(r_426[@i_584]) && ((x1_443 = x1_431[@i_584]) && ((x2_442 = x2_430[@i_584]) && ((x3_441 = x3_429[@i_584]) && ((x4_440 = x4_428[@i_584]) && (x5_439 = x5_427[@i_584]))))) then
      (
        let sk_u: hash0 = r_426[@i_584] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_583 <= NU suchthat defined(x1_437[@i_583], x2_436[@i_583], x3_435[@i_583], x4_434[@i_583], x5_433[@i_583], r_432[@i_583]) && otheruses(r_432[@i_583]) && ((x1_443 = x1_437[@i_583]) && ((x2_442 = x2_436[@i_583]) && ((x3_441 = x3_435[@i_583]) && ((x4_440 = x4_434[@i_583]) && (x5_439 = x5_433[@i_583]))))) then
      (
        let sk_u: hash0 = r_432[@i_583] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_582 <= NU suchthat defined(x1_443[@i_582], x2_442[@i_582], x3_441[@i_582], x4_440[@i_582], x5_439[@i_582], r_438[@i_582]) && otheruses(r_438[@i_582]) && ((x1_443 = x1_443[@i_582]) && ((x2_442 = x2_442[@i_582]) && ((x3_441 = x3_441[@i_582]) && ((x4_440 = x4_440[@i_582]) && (x5_439 = x5_439[@i_582]))))) then
      (
        let sk_u: hash0 = r_438[@i_582] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_581 <= NU suchthat defined(x1_449[@i_581], x2_448[@i_581], x3_447[@i_581], x4_446[@i_581], x5_445[@i_581], r_444[@i_581]) && otheruses(r_444[@i_581]) && ((x1_443 = x1_449[@i_581]) && ((x2_442 = x2_448[@i_581]) && ((x3_441 = x3_447[@i_581]) && ((x4_440 = x4_446[@i_581]) && (x5_439 = x5_445[@i_581]))))) then
      (
        let sk_u: hash0 = r_444[@i_581] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_580 <= NU suchthat defined(x1_455[@i_580], x2_454[@i_580], x3_453[@i_580], x4_452[@i_580], x5_451[@i_580], r_450[@i_580]) && otheruses(r_450[@i_580]) && ((x1_443 = x1_455[@i_580]) && ((x2_442 = x2_454[@i_580]) && ((x3_441 = x3_453[@i_580]) && ((x4_440 = x4_452[@i_580]) && (x5_439 = x5_451[@i_580]))))) then
      (
        let sk_u: hash0 = r_450[@i_580] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_579 <= NU suchthat defined(x1_461[@i_579], x2_460[@i_579], x3_459[@i_579], x4_458[@i_579], x5_457[@i_579], r_456[@i_579]) && otheruses(r_456[@i_579]) && ((x1_443 = x1_461[@i_579]) && ((x2_442 = x2_460[@i_579]) && ((x3_441 = x3_459[@i_579]) && ((x4_440 = x4_458[@i_579]) && (x5_439 = x5_457[@i_579]))))) then
      (
        let sk_u: hash0 = r_456[@i_579] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(Y[@i_236], @2_x_171[@i_236], @2_r2_169[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      let x3_459: G = X in
      let x4_458: G = Y[@i_236] in
      let x5_457: G = K_u in
      find [unique] @i_630 <= qH0 suchthat defined(x1_389[@i_630], x2_388[@i_630], x3_387[@i_630], x4_386[@i_630], x5_385[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && ((x1_461 = x1_389[@i_630]) && ((x2_460 = x2_388[@i_630]) && ((x3_459 = x3_387[@i_630]) && ((x4_458 = x4_386[@i_630]) && (x5_457 = x5_385[@i_630]))))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_629 <= NP suchthat defined(x1_395[@i_629], x2_394[@i_629], x3_393[@i_629], x4_392[@i_629], x5_391[@i_629], r_390[@i_629]) && otheruses(r_390[@i_629]) && ((x1_461 = x1_395[@i_629]) && ((x2_460 = x2_394[@i_629]) && ((x3_459 = x3_393[@i_629]) && ((x4_458 = x4_392[@i_629]) && (x5_457 = x5_391[@i_629]))))) then
      (
        let sk_u: hash0 = r_390[@i_629] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_628 <= NS suchthat defined(x1_401[@i_628], x2_400[@i_628], x3_399[@i_628], x4_398[@i_628], x5_397[@i_628], r_396[@i_628]) && otheruses(r_396[@i_628]) && ((x1_461 = x1_401[@i_628]) && ((x2_460 = x2_400[@i_628]) && ((x3_459 = x3_399[@i_628]) && ((x4_458 = x4_398[@i_628]) && (x5_457 = x5_397[@i_628]))))) then
      (
        let sk_u: hash0 = r_396[@i_628] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_627 <= NS suchthat defined(x1_407[@i_627], x2_406[@i_627], x3_405[@i_627], x4_404[@i_627], x5_403[@i_627], r_402[@i_627]) && otheruses(r_402[@i_627]) && ((x1_461 = x1_407[@i_627]) && ((x2_460 = x2_406[@i_627]) && ((x3_459 = x3_405[@i_627]) && ((x4_458 = x4_404[@i_627]) && (x5_457 = x5_403[@i_627]))))) then
      (
        let sk_u: hash0 = r_402[@i_627] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_626 <= NU suchthat defined(x1_413[@i_626], x2_412[@i_626], x3_411[@i_626], x4_410[@i_626], x5_409[@i_626], r_408[@i_626]) && otheruses(r_408[@i_626]) && ((x1_461 = x1_413[@i_626]) && ((x2_460 = x2_412[@i_626]) && ((x3_459 = x3_411[@i_626]) && ((x4_458 = x4_410[@i_626]) && (x5_457 = x5_409[@i_626]))))) then
      (
        let sk_u: hash0 = r_408[@i_626] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_625 <= NU suchthat defined(x1_419[@i_625], x2_418[@i_625], x3_417[@i_625], x4_416[@i_625], x5_415[@i_625], r_414[@i_625]) && otheruses(r_414[@i_625]) && ((x1_461 = x1_419[@i_625]) && ((x2_460 = x2_418[@i_625]) && ((x3_459 = x3_417[@i_625]) && ((x4_458 = x4_416[@i_625]) && (x5_457 = x5_415[@i_625]))))) then
      (
        let sk_u: hash0 = r_414[@i_625] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_624 <= NU suchthat defined(x1_425[@i_624], x2_424[@i_624], x3_423[@i_624], x4_422[@i_624], x5_421[@i_624], r_420[@i_624]) && otheruses(r_420[@i_624]) && ((x1_461 = x1_425[@i_624]) && ((x2_460 = x2_424[@i_624]) && ((x3_459 = x3_423[@i_624]) && ((x4_458 = x4_422[@i_624]) && (x5_457 = x5_421[@i_624]))))) then
      (
        let sk_u: hash0 = r_420[@i_624] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_623 <= NU suchthat defined(x1_431[@i_623], x2_430[@i_623], x3_429[@i_623], x4_428[@i_623], x5_427[@i_623], r_426[@i_623]) && otheruses(r_426[@i_623]) && ((x1_461 = x1_431[@i_623]) && ((x2_460 = x2_430[@i_623]) && ((x3_459 = x3_429[@i_623]) && ((x4_458 = x4_428[@i_623]) && (x5_457 = x5_427[@i_623]))))) then
      (
        let sk_u: hash0 = r_426[@i_623] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_622 <= NU suchthat defined(x1_437[@i_622], x2_436[@i_622], x3_435[@i_622], x4_434[@i_622], x5_433[@i_622], r_432[@i_622]) && otheruses(r_432[@i_622]) && ((x1_461 = x1_437[@i_622]) && ((x2_460 = x2_436[@i_622]) && ((x3_459 = x3_435[@i_622]) && ((x4_458 = x4_434[@i_622]) && (x5_457 = x5_433[@i_622]))))) then
      (
        let sk_u: hash0 = r_432[@i_622] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_621 <= NU suchthat defined(x1_443[@i_621], x2_442[@i_621], x3_441[@i_621], x4_440[@i_621], x5_439[@i_621], r_438[@i_621]) && otheruses(r_438[@i_621]) && ((x1_461 = x1_443[@i_621]) && ((x2_460 = x2_442[@i_621]) && ((x3_459 = x3_441[@i_621]) && ((x4_458 = x4_440[@i_621]) && (x5_457 = x5_439[@i_621]))))) then
      (
        let sk_u: hash0 = r_438[@i_621] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_620 <= NU suchthat defined(x1_449[@i_620], x2_448[@i_620], x3_447[@i_620], x4_446[@i_620], x5_445[@i_620], r_444[@i_620]) && otheruses(r_444[@i_620]) && ((x1_461 = x1_449[@i_620]) && ((x2_460 = x2_448[@i_620]) && ((x3_459 = x3_447[@i_620]) && ((x4_458 = x4_446[@i_620]) && (x5_457 = x5_445[@i_620]))))) then
      (
        let sk_u: hash0 = r_444[@i_620] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_619 <= NU suchthat defined(x1_455[@i_619], x2_454[@i_619], x3_453[@i_619], x4_452[@i_619], x5_451[@i_619], r_450[@i_619]) && otheruses(r_450[@i_619]) && ((x1_461 = x1_455[@i_619]) && ((x2_460 = x2_454[@i_619]) && ((x3_459 = x3_453[@i_619]) && ((x4_458 = x4_452[@i_619]) && (x5_457 = x5_451[@i_619]))))) then
      (
        let sk_u: hash0 = r_450[@i_619] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind @i_618 <= NU suchthat defined(x1_461[@i_618], x2_460[@i_618], x3_459[@i_618], x4_458[@i_618], x5_457[@i_618], r_456[@i_618]) && otheruses(r_456[@i_618]) && ((x1_461 = x1_461[@i_618]) && ((x2_460 = x2_460[@i_618]) && ((x3_459 = x3_459[@i_618]) && ((x4_458 = x4_458[@i_618]) && (x5_457 = x5_457[@i_618]))))) then
      (
        let sk_u: hash0 = r_456[@i_618] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let x1_455: host = U in
      let x2_454: host = S in
      let x3_453: G = X in
      let x4_452: G = Y[@i_236] in
      let x5_451: G = K_u in
      find [unique] @i_617 <= qH0 suchthat defined(x1_389[@i_617], x2_388[@i_617], x3_387[@i_617], x4_386[@i_617], x5_385[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && ((x1_455 = x1_389[@i_617]) && ((x2_454 = x2_388[@i_617]) && ((x3_453 = x3_387[@i_617]) && ((x4_452 = x4_386[@i_617]) && (x5_451 = x5_385[@i_617]))))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_616 <= NP suchthat defined(x1_395[@i_616], x2_394[@i_616], x3_393[@i_616], x4_392[@i_616], x5_391[@i_616], r_390[@i_616]) && otheruses(r_390[@i_616]) && ((x1_455 = x1_395[@i_616]) && ((x2_454 = x2_394[@i_616]) && ((x3_453 = x3_393[@i_616]) && ((x4_452 = x4_392[@i_616]) && (x5_451 = x5_391[@i_616]))))) then
      (
        let sk_u: hash0 = r_390[@i_616] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_615 <= NS suchthat defined(x1_401[@i_615], x2_400[@i_615], x3_399[@i_615], x4_398[@i_615], x5_397[@i_615], r_396[@i_615]) && otheruses(r_396[@i_615]) && ((x1_455 = x1_401[@i_615]) && ((x2_454 = x2_400[@i_615]) && ((x3_453 = x3_399[@i_615]) && ((x4_452 = x4_398[@i_615]) && (x5_451 = x5_397[@i_615]))))) then
      (
        let sk_u: hash0 = r_396[@i_615] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_614 <= NS suchthat defined(x1_407[@i_614], x2_406[@i_614], x3_405[@i_614], x4_404[@i_614], x5_403[@i_614], r_402[@i_614]) && otheruses(r_402[@i_614]) && ((x1_455 = x1_407[@i_614]) && ((x2_454 = x2_406[@i_614]) && ((x3_453 = x3_405[@i_614]) && ((x4_452 = x4_404[@i_614]) && (x5_451 = x5_403[@i_614]))))) then
      (
        let sk_u: hash0 = r_402[@i_614] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_613 <= NU suchthat defined(x1_413[@i_613], x2_412[@i_613], x3_411[@i_613], x4_410[@i_613], x5_409[@i_613], r_408[@i_613]) && otheruses(r_408[@i_613]) && ((x1_455 = x1_413[@i_613]) && ((x2_454 = x2_412[@i_613]) && ((x3_453 = x3_411[@i_613]) && ((x4_452 = x4_410[@i_613]) && (x5_451 = x5_409[@i_613]))))) then
      (
        let sk_u: hash0 = r_408[@i_613] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_612 <= NU suchthat defined(x1_419[@i_612], x2_418[@i_612], x3_417[@i_612], x4_416[@i_612], x5_415[@i_612], r_414[@i_612]) && otheruses(r_414[@i_612]) && ((x1_455 = x1_419[@i_612]) && ((x2_454 = x2_418[@i_612]) && ((x3_453 = x3_417[@i_612]) && ((x4_452 = x4_416[@i_612]) && (x5_451 = x5_415[@i_612]))))) then
      (
        let sk_u: hash0 = r_414[@i_612] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_611 <= NU suchthat defined(x1_425[@i_611], x2_424[@i_611], x3_423[@i_611], x4_422[@i_611], x5_421[@i_611], r_420[@i_611]) && otheruses(r_420[@i_611]) && ((x1_455 = x1_425[@i_611]) && ((x2_454 = x2_424[@i_611]) && ((x3_453 = x3_423[@i_611]) && ((x4_452 = x4_422[@i_611]) && (x5_451 = x5_421[@i_611]))))) then
      (
        let sk_u: hash0 = r_420[@i_611] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_610 <= NU suchthat defined(x1_431[@i_610], x2_430[@i_610], x3_429[@i_610], x4_428[@i_610], x5_427[@i_610], r_426[@i_610]) && otheruses(r_426[@i_610]) && ((x1_455 = x1_431[@i_610]) && ((x2_454 = x2_430[@i_610]) && ((x3_453 = x3_429[@i_610]) && ((x4_452 = x4_428[@i_610]) && (x5_451 = x5_427[@i_610]))))) then
      (
        let sk_u: hash0 = r_426[@i_610] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_609 <= NU suchthat defined(x1_437[@i_609], x2_436[@i_609], x3_435[@i_609], x4_434[@i_609], x5_433[@i_609], r_432[@i_609]) && otheruses(r_432[@i_609]) && ((x1_455 = x1_437[@i_609]) && ((x2_454 = x2_436[@i_609]) && ((x3_453 = x3_435[@i_609]) && ((x4_452 = x4_434[@i_609]) && (x5_451 = x5_433[@i_609]))))) then
      (
        let sk_u: hash0 = r_432[@i_609] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_608 <= NU suchthat defined(x1_443[@i_608], x2_442[@i_608], x3_441[@i_608], x4_440[@i_608], x5_439[@i_608], r_438[@i_608]) && otheruses(r_438[@i_608]) && ((x1_455 = x1_443[@i_608]) && ((x2_454 = x2_442[@i_608]) && ((x3_453 = x3_441[@i_608]) && ((x4_452 = x4_440[@i_608]) && (x5_451 = x5_439[@i_608]))))) then
      (
        let sk_u: hash0 = r_438[@i_608] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_607 <= NU suchthat defined(x1_449[@i_607], x2_448[@i_607], x3_447[@i_607], x4_446[@i_607], x5_445[@i_607], r_444[@i_607]) && otheruses(r_444[@i_607]) && ((x1_455 = x1_449[@i_607]) && ((x2_454 = x2_448[@i_607]) && ((x3_453 = x3_447[@i_607]) && ((x4_452 = x4_446[@i_607]) && (x5_451 = x5_445[@i_607]))))) then
      (
        let sk_u: hash0 = r_444[@i_607] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_606 <= NU suchthat defined(x1_455[@i_606], x2_454[@i_606], x3_453[@i_606], x4_452[@i_606], x5_451[@i_606], r_450[@i_606]) && otheruses(r_450[@i_606]) && ((x1_455 = x1_455[@i_606]) && ((x2_454 = x2_454[@i_606]) && ((x3_453 = x3_453[@i_606]) && ((x4_452 = x4_452[@i_606]) && (x5_451 = x5_451[@i_606]))))) then
      (
        let sk_u: hash0 = r_450[@i_606] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      orfind @i_605 <= NU suchthat defined(x1_461[@i_605], x2_460[@i_605], x3_459[@i_605], x4_458[@i_605], x5_457[@i_605], r_456[@i_605]) && otheruses(r_456[@i_605]) && ((x1_455 = x1_461[@i_605]) && ((x2_454 = x2_460[@i_605]) && ((x3_453 = x3_459[@i_605]) && ((x4_452 = x4_458[@i_605]) && (x5_451 = x5_457[@i_605]))))) then
      (
        let sk_u: hash0 = r_456[@i_605] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
  )
  else
    new @2_r4_172: G;
    let Y_u: G = @2_r4_172 in
    let K_u: G = exp(@2_r4_172, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    let x3_411: G = X in
    let x4_410: G = @2_r4_172 in
    let x5_409: G = K_u in
    find [unique] @i_526 <= qH0 suchthat defined(x1_389[@i_526], x2_388[@i_526], x3_387[@i_526], x4_386[@i_526], x5_385[@i_526], r_384[@i_526]) && otheruses(r_384[@i_526]) && ((x1_413 = x1_389[@i_526]) && ((x2_412 = x2_388[@i_526]) && ((x3_411 = x3_387[@i_526]) && ((x4_410 = x4_386[@i_526]) && (x5_409 = x5_385[@i_526]))))) then
    (
      let sk_u: hash0 = r_384[@i_526] in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
    )
    orfind @i_525 <= NP suchthat defined(x1_395[@i_525], x2_394[@i_525], x3_393[@i_525], x4_392[@i_525], x5_391[@i_525], r_390[@i_525]) && otheruses(r_390[@i_525]) && ((x1_413 = x1_395[@i_525]) && ((x2_412 = x2_394[@i_525]) && ((x3_411 = x3_393[@i_525]) && ((x4_410 = x4_392[@i_525]) && (x5_409 = x5_391[@i_525]))))) then
    (
      let sk_u: hash0 = r_390[@i_525] in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
    )
    orfind @i_524 <= NS suchthat defined(x1_401[@i_524], x2_400[@i_524], x3_399[@i_524], x4_398[@i_524], x5_397[@i_524], r_396[@i_524]) && otheruses(r_396[@i_524]) && ((x1_413 = x1_401[@i_524]) && ((x2_412 = x2_400[@i_524]) && ((x3_411 = x3_399[@i_524]) && ((x4_410 = x4_398[@i_524]) && (x5_409 = x5_397[@i_524]))))) then
    (
      let sk_u: hash0 = r_396[@i_524] in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
    )
    orfind @i_523 <= NS suchthat defined(x1_407[@i_523], x2_406[@i_523], x3_405[@i_523], x4_404[@i_523], x5_403[@i_523], r_402[@i_523]) && otheruses(r_402[@i_523]) && ((x1_413 = x1_407[@i_523]) && ((x2_412 = x2_406[@i_523]) && ((x3_411 = x3_405[@i_523]) && ((x4_410 = x4_404[@i_523]) && (x5_409 = x5_403[@i_523]))))) then
    (
      let sk_u: hash0 = r_402[@i_523] in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
    )
    orfind @i_522 <= NU suchthat defined(x1_413[@i_522], x2_412[@i_522], x3_411[@i_522], x4_410[@i_522], x5_409[@i_522], r_408[@i_522]) && otheruses(r_408[@i_522]) && ((x1_413 = x1_413[@i_522]) && ((x2_412 = x2_412[@i_522]) && ((x3_411 = x3_411[@i_522]) && ((x4_410 = x4_410[@i_522]) && (x5_409 = x5_409[@i_522]))))) then
    (
      let sk_u: hash0 = r_408[@i_522] in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
    )
    orfind @i_521 <= NU suchthat defined(x1_419[@i_521], x2_418[@i_521], x3_417[@i_521], x4_416[@i_521], x5_415[@i_521], r_414[@i_521]) && otheruses(r_414[@i_521]) && ((x1_413 = x1_419[@i_521]) && ((x2_412 = x2_418[@i_521]) && ((x3_411 = x3_417[@i_521]) && ((x4_410 = x4_416[@i_521]) && (x5_409 = x5_415[@i_521]))))) then
    (
      let sk_u: hash0 = r_414[@i_521] in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
    )
    orfind @i_520 <= NU suchthat defined(x1_425[@i_520], x2_424[@i_520], x3_423[@i_520], x4_422[@i_520], x5_421[@i_520], r_420[@i_520]) && otheruses(r_420[@i_520]) && ((x1_413 = x1_425[@i_520]) && ((x2_412 = x2_424[@i_520]) && ((x3_411 = x3_423[@i_520]) && ((x4_410 = x4_422[@i_520]) && (x5_409 = x5_421[@i_520]))))) then
    (
      let sk_u: hash0 = r_420[@i_520] in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
    )
    orfind @i_519 <= NU suchthat defined(x1_431[@i_519], x2_430[@i_519], x3_429[@i_519], x4_428[@i_519], x5_427[@i_519], r_426[@i_519]) && otheruses(r_426[@i_519]) && ((x1_413 = x1_431[@i_519]) && ((x2_412 = x2_430[@i_519]) && ((x3_411 = x3_429[@i_519]) && ((x4_410 = x4_428[@i_519]) && (x5_409 = x5_427[@i_519]))))) then
    (
      let sk_u: hash0 = r_426[@i_519] in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
    )
    orfind @i_518 <= NU suchthat defined(x1_437[@i_518], x2_436[@i_518], x3_435[@i_518], x4_434[@i_518], x5_433[@i_518], r_432[@i_518]) && otheruses(r_432[@i_518]) && ((x1_413 = x1_437[@i_518]) && ((x2_412 = x2_436[@i_518]) && ((x3_411 = x3_435[@i_518]) && ((x4_410 = x4_434[@i_518]) && (x5_409 = x5_433[@i_518]))))) then
    (
      let sk_u: hash0 = r_432[@i_518] in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
    )
    orfind @i_517 <= NU suchthat defined(x1_443[@i_517], x2_442[@i_517], x3_441[@i_517], x4_440[@i_517], x5_439[@i_517], r_438[@i_517]) && otheruses(r_438[@i_517]) && ((x1_413 = x1_443[@i_517]) && ((x2_412 = x2_442[@i_517]) && ((x3_411 = x3_441[@i_517]) && ((x4_410 = x4_440[@i_517]) && (x5_409 = x5_439[@i_517]))))) then
    (
      let sk_u: hash0 = r_438[@i_517] in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
    )
    orfind @i_516 <= NU suchthat defined(x1_449[@i_516], x2_448[@i_516], x3_447[@i_516], x4_446[@i_516], x5_445[@i_516], r_444[@i_516]) && otheruses(r_444[@i_516]) && ((x1_413 = x1_449[@i_516]) && ((x2_412 = x2_448[@i_516]) && ((x3_411 = x3_447[@i_516]) && ((x4_410 = x4_446[@i_516]) && (x5_409 = x5_445[@i_516]))))) then
    (
      let sk_u: hash0 = r_444[@i_516] in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
    )
    orfind @i_515 <= NU suchthat defined(x1_455[@i_515], x2_454[@i_515], x3_453[@i_515], x4_452[@i_515], x5_451[@i_515], r_450[@i_515]) && otheruses(r_450[@i_515]) && ((x1_413 = x1_455[@i_515]) && ((x2_412 = x2_454[@i_515]) && ((x3_411 = x3_453[@i_515]) && ((x4_410 = x4_452[@i_515]) && (x5_409 = x5_451[@i_515]))))) then
    (
      let sk_u: hash0 = r_450[@i_515] in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
    )
    orfind @i_514 <= NU suchthat defined(x1_461[@i_514], x2_460[@i_514], x3_459[@i_514], x4_458[@i_514], x5_457[@i_514], r_456[@i_514]) && otheruses(r_456[@i_514]) && ((x1_413 = x1_461[@i_514]) && ((x2_412 = x2_460[@i_514]) && ((x3_411 = x3_459[@i_514]) && ((x4_410 = x4_458[@i_514]) && (x5_409 = x5_457[@i_514]))))) then
    (
      let sk_u: hash0 = r_456[@i_514] in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
    )
    else
      new r_408: hash0;
      let sk_u: hash0 = r_408 in
      event termU(U, X, S, Ystar_u, r1_90, sk_u);
      out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let @2_x_171: G = cst_G in
  let @2_ke_170: passwd = cst_passwd in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      let x3_399: G = X_s in
      let x4_398: G = Y in
      let x5_397: G = K_s in
      find [unique] @i_500 <= qH0 suchthat defined(x1_389[@i_500], x2_388[@i_500], x3_387[@i_500], x4_386[@i_500], x5_385[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && ((x1_401 = x1_389[@i_500]) && ((x2_400 = x2_388[@i_500]) && ((x3_399 = x3_387[@i_500]) && ((x4_398 = x4_386[@i_500]) && (x5_397 = x5_385[@i_500]))))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_499 <= NP suchthat defined(x1_395[@i_499], x2_394[@i_499], x3_393[@i_499], x4_392[@i_499], x5_391[@i_499], r_390[@i_499]) && otheruses(r_390[@i_499]) && ((x1_401 = x1_395[@i_499]) && ((x2_400 = x2_394[@i_499]) && ((x3_399 = x3_393[@i_499]) && ((x4_398 = x4_392[@i_499]) && (x5_397 = x5_391[@i_499]))))) then
      (
        let sk_s: hash0 = r_390[@i_499] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_498 <= NS suchthat defined(x1_401[@i_498], x2_400[@i_498], x3_399[@i_498], x4_398[@i_498], x5_397[@i_498], r_396[@i_498]) && otheruses(r_396[@i_498]) && ((x1_401 = x1_401[@i_498]) && ((x2_400 = x2_400[@i_498]) && ((x3_399 = x3_399[@i_498]) && ((x4_398 = x4_398[@i_498]) && (x5_397 = x5_397[@i_498]))))) then
      (
        let sk_s: hash0 = r_396[@i_498] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_497 <= NS suchthat defined(x1_407[@i_497], x2_406[@i_497], x3_405[@i_497], x4_404[@i_497], x5_403[@i_497], r_402[@i_497]) && otheruses(r_402[@i_497]) && ((x1_401 = x1_407[@i_497]) && ((x2_400 = x2_406[@i_497]) && ((x3_399 = x3_405[@i_497]) && ((x4_398 = x4_404[@i_497]) && (x5_397 = x5_403[@i_497]))))) then
      (
        let sk_s: hash0 = r_402[@i_497] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_496 <= NU suchthat defined(x1_413[@i_496], x2_412[@i_496], x3_411[@i_496], x4_410[@i_496], x5_409[@i_496], r_408[@i_496]) && otheruses(r_408[@i_496]) && ((x1_401 = x1_413[@i_496]) && ((x2_400 = x2_412[@i_496]) && ((x3_399 = x3_411[@i_496]) && ((x4_398 = x4_410[@i_496]) && (x5_397 = x5_409[@i_496]))))) then
      (
        let sk_s: hash0 = r_408[@i_496] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_495 <= NU suchthat defined(x1_419[@i_495], x2_418[@i_495], x3_417[@i_495], x4_416[@i_495], x5_415[@i_495], r_414[@i_495]) && otheruses(r_414[@i_495]) && ((x1_401 = x1_419[@i_495]) && ((x2_400 = x2_418[@i_495]) && ((x3_399 = x3_417[@i_495]) && ((x4_398 = x4_416[@i_495]) && (x5_397 = x5_415[@i_495]))))) then
      (
        let sk_s: hash0 = r_414[@i_495] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_494 <= NU suchthat defined(x1_425[@i_494], x2_424[@i_494], x3_423[@i_494], x4_422[@i_494], x5_421[@i_494], r_420[@i_494]) && otheruses(r_420[@i_494]) && ((x1_401 = x1_425[@i_494]) && ((x2_400 = x2_424[@i_494]) && ((x3_399 = x3_423[@i_494]) && ((x4_398 = x4_422[@i_494]) && (x5_397 = x5_421[@i_494]))))) then
      (
        let sk_s: hash0 = r_420[@i_494] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_493 <= NU suchthat defined(x1_431[@i_493], x2_430[@i_493], x3_429[@i_493], x4_428[@i_493], x5_427[@i_493], r_426[@i_493]) && otheruses(r_426[@i_493]) && ((x1_401 = x1_431[@i_493]) && ((x2_400 = x2_430[@i_493]) && ((x3_399 = x3_429[@i_493]) && ((x4_398 = x4_428[@i_493]) && (x5_397 = x5_427[@i_493]))))) then
      (
        let sk_s: hash0 = r_426[@i_493] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_492 <= NU suchthat defined(x1_437[@i_492], x2_436[@i_492], x3_435[@i_492], x4_434[@i_492], x5_433[@i_492], r_432[@i_492]) && otheruses(r_432[@i_492]) && ((x1_401 = x1_437[@i_492]) && ((x2_400 = x2_436[@i_492]) && ((x3_399 = x3_435[@i_492]) && ((x4_398 = x4_434[@i_492]) && (x5_397 = x5_433[@i_492]))))) then
      (
        let sk_s: hash0 = r_432[@i_492] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_491 <= NU suchthat defined(x1_443[@i_491], x2_442[@i_491], x3_441[@i_491], x4_440[@i_491], x5_439[@i_491], r_438[@i_491]) && otheruses(r_438[@i_491]) && ((x1_401 = x1_443[@i_491]) && ((x2_400 = x2_442[@i_491]) && ((x3_399 = x3_441[@i_491]) && ((x4_398 = x4_440[@i_491]) && (x5_397 = x5_439[@i_491]))))) then
      (
        let sk_s: hash0 = r_438[@i_491] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_490 <= NU suchthat defined(x1_449[@i_490], x2_448[@i_490], x3_447[@i_490], x4_446[@i_490], x5_445[@i_490], r_444[@i_490]) && otheruses(r_444[@i_490]) && ((x1_401 = x1_449[@i_490]) && ((x2_400 = x2_448[@i_490]) && ((x3_399 = x3_447[@i_490]) && ((x4_398 = x4_446[@i_490]) && (x5_397 = x5_445[@i_490]))))) then
      (
        let sk_s: hash0 = r_444[@i_490] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_489 <= NU suchthat defined(x1_455[@i_489], x2_454[@i_489], x3_453[@i_489], x4_452[@i_489], x5_451[@i_489], r_450[@i_489]) && otheruses(r_450[@i_489]) && ((x1_401 = x1_455[@i_489]) && ((x2_400 = x2_454[@i_489]) && ((x3_399 = x3_453[@i_489]) && ((x4_398 = x4_452[@i_489]) && (x5_397 = x5_451[@i_489]))))) then
      (
        let sk_s: hash0 = r_450[@i_489] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_488 <= NU suchthat defined(x1_461[@i_488], x2_460[@i_488], x3_459[@i_488], x4_458[@i_488], x5_457[@i_488], r_456[@i_488]) && otheruses(r_456[@i_488]) && ((x1_401 = x1_461[@i_488]) && ((x2_400 = x2_460[@i_488]) && ((x3_399 = x3_459[@i_488]) && ((x4_398 = x4_458[@i_488]) && (x5_397 = x5_457[@i_488]))))) then
      (
        let sk_s: hash0 = r_456[@i_488] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = X_s in
      let x4_404: G = Y in
      let x5_403: G = K_s in
      find [unique] @i_513 <= qH0 suchthat defined(x1_389[@i_513], x2_388[@i_513], x3_387[@i_513], x4_386[@i_513], x5_385[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1_389[@i_513]) && ((x2_406 = x2_388[@i_513]) && ((x3_405 = x3_387[@i_513]) && ((x4_404 = x4_386[@i_513]) && (x5_403 = x5_385[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_512 <= NP suchthat defined(x1_395[@i_512], x2_394[@i_512], x3_393[@i_512], x4_392[@i_512], x5_391[@i_512], r_390[@i_512]) && otheruses(r_390[@i_512]) && ((x1_407 = x1_395[@i_512]) && ((x2_406 = x2_394[@i_512]) && ((x3_405 = x3_393[@i_512]) && ((x4_404 = x4_392[@i_512]) && (x5_403 = x5_391[@i_512]))))) then
      (
        let sk_s: hash0 = r_390[@i_512] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_511 <= NS suchthat defined(x1_401[@i_511], x2_400[@i_511], x3_399[@i_511], x4_398[@i_511], x5_397[@i_511], r_396[@i_511]) && otheruses(r_396[@i_511]) && ((x1_407 = x1_401[@i_511]) && ((x2_406 = x2_400[@i_511]) && ((x3_405 = x3_399[@i_511]) && ((x4_404 = x4_398[@i_511]) && (x5_403 = x5_397[@i_511]))))) then
      (
        let sk_s: hash0 = r_396[@i_511] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_510 <= NS suchthat defined(x1_407[@i_510], x2_406[@i_510], x3_405[@i_510], x4_404[@i_510], x5_403[@i_510], r_402[@i_510]) && otheruses(r_402[@i_510]) && ((x1_407 = x1_407[@i_510]) && ((x2_406 = x2_406[@i_510]) && ((x3_405 = x3_405[@i_510]) && ((x4_404 = x4_404[@i_510]) && (x5_403 = x5_403[@i_510]))))) then
      (
        let sk_s: hash0 = r_402[@i_510] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_509 <= NU suchthat defined(x1_413[@i_509], x2_412[@i_509], x3_411[@i_509], x4_410[@i_509], x5_409[@i_509], r_408[@i_509]) && otheruses(r_408[@i_509]) && ((x1_407 = x1_413[@i_509]) && ((x2_406 = x2_412[@i_509]) && ((x3_405 = x3_411[@i_509]) && ((x4_404 = x4_410[@i_509]) && (x5_403 = x5_409[@i_509]))))) then
      (
        let sk_s: hash0 = r_408[@i_509] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_508 <= NU suchthat defined(x1_419[@i_508], x2_418[@i_508], x3_417[@i_508], x4_416[@i_508], x5_415[@i_508], r_414[@i_508]) && otheruses(r_414[@i_508]) && ((x1_407 = x1_419[@i_508]) && ((x2_406 = x2_418[@i_508]) && ((x3_405 = x3_417[@i_508]) && ((x4_404 = x4_416[@i_508]) && (x5_403 = x5_415[@i_508]))))) then
      (
        let sk_s: hash0 = r_414[@i_508] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_507 <= NU suchthat defined(x1_425[@i_507], x2_424[@i_507], x3_423[@i_507], x4_422[@i_507], x5_421[@i_507], r_420[@i_507]) && otheruses(r_420[@i_507]) && ((x1_407 = x1_425[@i_507]) && ((x2_406 = x2_424[@i_507]) && ((x3_405 = x3_423[@i_507]) && ((x4_404 = x4_422[@i_507]) && (x5_403 = x5_421[@i_507]))))) then
      (
        let sk_s: hash0 = r_420[@i_507] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_506 <= NU suchthat defined(x1_431[@i_506], x2_430[@i_506], x3_429[@i_506], x4_428[@i_506], x5_427[@i_506], r_426[@i_506]) && otheruses(r_426[@i_506]) && ((x1_407 = x1_431[@i_506]) && ((x2_406 = x2_430[@i_506]) && ((x3_405 = x3_429[@i_506]) && ((x4_404 = x4_428[@i_506]) && (x5_403 = x5_427[@i_506]))))) then
      (
        let sk_s: hash0 = r_426[@i_506] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_505 <= NU suchthat defined(x1_437[@i_505], x2_436[@i_505], x3_435[@i_505], x4_434[@i_505], x5_433[@i_505], r_432[@i_505]) && otheruses(r_432[@i_505]) && ((x1_407 = x1_437[@i_505]) && ((x2_406 = x2_436[@i_505]) && ((x3_405 = x3_435[@i_505]) && ((x4_404 = x4_434[@i_505]) && (x5_403 = x5_433[@i_505]))))) then
      (
        let sk_s: hash0 = r_432[@i_505] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_504 <= NU suchthat defined(x1_443[@i_504], x2_442[@i_504], x3_441[@i_504], x4_440[@i_504], x5_439[@i_504], r_438[@i_504]) && otheruses(r_438[@i_504]) && ((x1_407 = x1_443[@i_504]) && ((x2_406 = x2_442[@i_504]) && ((x3_405 = x3_441[@i_504]) && ((x4_404 = x4_440[@i_504]) && (x5_403 = x5_439[@i_504]))))) then
      (
        let sk_s: hash0 = r_438[@i_504] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_503 <= NU suchthat defined(x1_449[@i_503], x2_448[@i_503], x3_447[@i_503], x4_446[@i_503], x5_445[@i_503], r_444[@i_503]) && otheruses(r_444[@i_503]) && ((x1_407 = x1_449[@i_503]) && ((x2_406 = x2_448[@i_503]) && ((x3_405 = x3_447[@i_503]) && ((x4_404 = x4_446[@i_503]) && (x5_403 = x5_445[@i_503]))))) then
      (
        let sk_s: hash0 = r_444[@i_503] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_502 <= NU suchthat defined(x1_455[@i_502], x2_454[@i_502], x3_453[@i_502], x4_452[@i_502], x5_451[@i_502], r_450[@i_502]) && otheruses(r_450[@i_502]) && ((x1_407 = x1_455[@i_502]) && ((x2_406 = x2_454[@i_502]) && ((x3_405 = x3_453[@i_502]) && ((x4_404 = x4_452[@i_502]) && (x5_403 = x5_451[@i_502]))))) then
      (
        let sk_s: hash0 = r_450[@i_502] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind @i_501 <= NU suchthat defined(x1_461[@i_501], x2_460[@i_501], x3_459[@i_501], x4_458[@i_501], x5_457[@i_501], r_456[@i_501]) && otheruses(r_456[@i_501]) && ((x1_407 = x1_461[@i_501]) && ((x2_406 = x2_460[@i_501]) && ((x3_405 = x3_459[@i_501]) && ((x4_404 = x4_458[@i_501]) && (x5_403 = x5_457[@i_501]))))) then
      (
        let sk_s: hash0 = r_456[@i_501] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @2_kd_158[@i_222], @2_m_159[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @2_r4_157[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@2_r4_157[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @2_m_174[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @2_r4_172[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@2_r4_172[@i_217] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let @2_x_165: G = cst_G in
  let @2_ke_164: passwd = cst_passwd in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  let x3_393: G = Xp in
  let x4_392: G = Yp in
  let x5_391: G = Kp in
  find [unique] @i_487 <= qH0 suchthat defined(x1_389[@i_487], x2_388[@i_487], x3_387[@i_487], x4_386[@i_487], x5_385[@i_487], r_384[@i_487]) && otheruses(r_384[@i_487]) && ((x1_395 = x1_389[@i_487]) && ((x2_394 = x2_388[@i_487]) && ((x3_393 = x3_387[@i_487]) && ((x4_392 = x4_386[@i_487]) && (x5_391 = x5_385[@i_487]))))) then
  (
    let sk_p: hash0 = r_384[@i_487] in
    out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
  )
  orfind @i_486 <= NP suchthat defined(x1_395[@i_486], x2_394[@i_486], x3_393[@i_486], x4_392[@i_486], x5_391[@i_486], r_390[@i_486]) && otheruses(r_390[@i_486]) && ((x1_395 = x1_395[@i_486]) && ((x2_394 = x2_394[@i_486]) && ((x3_393 = x3_393[@i_486]) && ((x4_392 = x4_392[@i_486]) && (x5_391 = x5_391[@i_486]))))) then
  (
    let sk_p: hash0 = r_390[@i_486] in
    out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
  )
  orfind @i_485 <= NS suchthat defined(x1_401[@i_485], x2_400[@i_485], x3_399[@i_485], x4_398[@i_485], x5_397[@i_485], r_396[@i_485]) && otheruses(r_396[@i_485]) && ((x1_395 = x1_401[@i_485]) && ((x2_394 = x2_400[@i_485]) && ((x3_393 = x3_399[@i_485]) && ((x4_392 = x4_398[@i_485]) && (x5_391 = x5_397[@i_485]))))) then
  (
    let sk_p: hash0 = r_396[@i_485] in
    out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
  )
  orfind @i_484 <= NS suchthat defined(x1_407[@i_484], x2_406[@i_484], x3_405[@i_484], x4_404[@i_484], x5_403[@i_484], r_402[@i_484]) && otheruses(r_402[@i_484]) && ((x1_395 = x1_407[@i_484]) && ((x2_394 = x2_406[@i_484]) && ((x3_393 = x3_405[@i_484]) && ((x4_392 = x4_404[@i_484]) && (x5_391 = x5_403[@i_484]))))) then
  (
    let sk_p: hash0 = r_402[@i_484] in
    out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
  )
  orfind @i_483 <= NU suchthat defined(x1_413[@i_483], x2_412[@i_483], x3_411[@i_483], x4_410[@i_483], x5_409[@i_483], r_408[@i_483]) && otheruses(r_408[@i_483]) && ((x1_395 = x1_413[@i_483]) && ((x2_394 = x2_412[@i_483]) && ((x3_393 = x3_411[@i_483]) && ((x4_392 = x4_410[@i_483]) && (x5_391 = x5_409[@i_483]))))) then
  (
    let sk_p: hash0 = r_408[@i_483] in
    out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
  )
  orfind @i_482 <= NU suchthat defined(x1_419[@i_482], x2_418[@i_482], x3_417[@i_482], x4_416[@i_482], x5_415[@i_482], r_414[@i_482]) && otheruses(r_414[@i_482]) && ((x1_395 = x1_419[@i_482]) && ((x2_394 = x2_418[@i_482]) && ((x3_393 = x3_417[@i_482]) && ((x4_392 = x4_416[@i_482]) && (x5_391 = x5_415[@i_482]))))) then
  (
    let sk_p: hash0 = r_414[@i_482] in
    out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
  )
  orfind @i_481 <= NU suchthat defined(x1_425[@i_481], x2_424[@i_481], x3_423[@i_481], x4_422[@i_481], x5_421[@i_481], r_420[@i_481]) && otheruses(r_420[@i_481]) && ((x1_395 = x1_425[@i_481]) && ((x2_394 = x2_424[@i_481]) && ((x3_393 = x3_423[@i_481]) && ((x4_392 = x4_422[@i_481]) && (x5_391 = x5_421[@i_481]))))) then
  (
    let sk_p: hash0 = r_420[@i_481] in
    out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
  )
  orfind @i_480 <= NU suchthat defined(x1_431[@i_480], x2_430[@i_480], x3_429[@i_480], x4_428[@i_480], x5_427[@i_480], r_426[@i_480]) && otheruses(r_426[@i_480]) && ((x1_395 = x1_431[@i_480]) && ((x2_394 = x2_430[@i_480]) && ((x3_393 = x3_429[@i_480]) && ((x4_392 = x4_428[@i_480]) && (x5_391 = x5_427[@i_480]))))) then
  (
    let sk_p: hash0 = r_426[@i_480] in
    out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
  )
  orfind @i_479 <= NU suchthat defined(x1_437[@i_479], x2_436[@i_479], x3_435[@i_479], x4_434[@i_479], x5_433[@i_479], r_432[@i_479]) && otheruses(r_432[@i_479]) && ((x1_395 = x1_437[@i_479]) && ((x2_394 = x2_436[@i_479]) && ((x3_393 = x3_435[@i_479]) && ((x4_392 = x4_434[@i_479]) && (x5_391 = x5_433[@i_479]))))) then
  (
    let sk_p: hash0 = r_432[@i_479] in
    out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
  )
  orfind @i_478 <= NU suchthat defined(x1_443[@i_478], x2_442[@i_478], x3_441[@i_478], x4_440[@i_478], x5_439[@i_478], r_438[@i_478]) && otheruses(r_438[@i_478]) && ((x1_395 = x1_443[@i_478]) && ((x2_394 = x2_442[@i_478]) && ((x3_393 = x3_441[@i_478]) && ((x4_392 = x4_440[@i_478]) && (x5_391 = x5_439[@i_478]))))) then
  (
    let sk_p: hash0 = r_438[@i_478] in
    out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
  )
  orfind @i_477 <= NU suchthat defined(x1_449[@i_477], x2_448[@i_477], x3_447[@i_477], x4_446[@i_477], x5_445[@i_477], r_444[@i_477]) && otheruses(r_444[@i_477]) && ((x1_395 = x1_449[@i_477]) && ((x2_394 = x2_448[@i_477]) && ((x3_393 = x3_447[@i_477]) && ((x4_392 = x4_446[@i_477]) && (x5_391 = x5_445[@i_477]))))) then
  (
    let sk_p: hash0 = r_444[@i_477] in
    out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
  )
  orfind @i_476 <= NU suchthat defined(x1_455[@i_476], x2_454[@i_476], x3_453[@i_476], x4_452[@i_476], x5_451[@i_476], r_450[@i_476]) && otheruses(r_450[@i_476]) && ((x1_395 = x1_455[@i_476]) && ((x2_394 = x2_454[@i_476]) && ((x3_393 = x3_453[@i_476]) && ((x4_392 = x4_452[@i_476]) && (x5_391 = x5_451[@i_476]))))) then
  (
    let sk_p: hash0 = r_450[@i_476] in
    out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
  )
  orfind @i_475 <= NU suchthat defined(x1_461[@i_475], x2_460[@i_475], x3_459[@i_475], x4_458[@i_475], x5_457[@i_475], r_456[@i_475]) && otheruses(r_456[@i_475]) && ((x1_395 = x1_461[@i_475]) && ((x2_394 = x2_460[@i_475]) && ((x3_393 = x3_459[@i_475]) && ((x4_392 = x4_458[@i_475]) && (x5_391 = x5_457[@i_475]))))) then
  (
    let sk_p: hash0 = r_456[@i_475] in
    out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
  )
  else
    new r_390: hash0;
    let sk_p: hash0 = r_390 in
    out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  let @2_x_162: G = cst_G in
  let @2_ke_161: passwd = cst_passwd in
  find [unique] @i_198 <= qD suchthat defined(@2_kd[@i_198], @2_m[@i_198], @2_m_159[@i_198], @2_kd_158[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @2_r4_157[@i_198]) && ((@2_x = @2_r4_157[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(pw, Ystar_u[@i_193], @2_m_174[@i_193], @2_kd_173[@i_193], @2_r4_172[@i_193]) && otheruses(Ystar_u[@i_193] -> @2_r4_172[@i_193]) && ((@2_x = @2_r4_172[@i_193]) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_ke_161[@i_191], @2_x_162[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], pw, @2_ke_164[@i_190], @2_x_165[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], pw, @2_ke_170[@i_188], @2_x_171[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  let @2_m_159: G = cst_G in
  let @2_kd_158: passwd = cst_passwd in
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @2_kd_158[@i_186], @2_m_159[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @2_r4_157[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @2_r4_157[@i_186])
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], pw, @2_kd_173[@i_181], @2_m_174[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @2_r4_172[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], @2_r4_172[@i_181])
  orfind @i_179 <= qE suchthat defined(@2_ke[@i_179], @2_x[@i_179], @2_x_162[@i_179], @2_ke_161[@i_179], @2_r2_160[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(pw, Yp[@i_178], @2_x_165[@i_178], @2_ke_164[@i_178], @2_r2_163[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(pw, Y[@i_176], @2_x_171[@i_176], @2_ke_170[@i_176], @2_r2_169[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @2_r4_157: G;
    out(@2_c4[!_45], @2_r4_157)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_389: host = x1 in
  let x2_388: host = x2 in
  let x3_387: G = x3 in
  let x4_386: G = x4 in
  let x5_385: G = x5 in
  find [unique] @i_474 <= qH0 suchthat defined(x1_389[@i_474], x2_388[@i_474], x3_387[@i_474], x4_386[@i_474], x5_385[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1_389 = x1_389[@i_474]) && ((x2_388 = x2_388[@i_474]) && ((x3_387 = x3_387[@i_474]) && ((x4_386 = x4_386[@i_474]) && (x5_385 = x5_385[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(x1_395[@i_473], x2_394[@i_473], x3_393[@i_473], x4_392[@i_473], x5_391[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && ((x1_389 = x1_395[@i_473]) && ((x2_388 = x2_394[@i_473]) && ((x3_387 = x3_393[@i_473]) && ((x4_386 = x4_392[@i_473]) && (x5_385 = x5_391[@i_473]))))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(x1_401[@i_472], x2_400[@i_472], x3_399[@i_472], x4_398[@i_472], x5_397[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && ((x1_389 = x1_401[@i_472]) && ((x2_388 = x2_400[@i_472]) && ((x3_387 = x3_399[@i_472]) && ((x4_386 = x4_398[@i_472]) && (x5_385 = x5_397[@i_472]))))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(x1_407[@i_471], x2_406[@i_471], x3_405[@i_471], x4_404[@i_471], x5_403[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && ((x1_389 = x1_407[@i_471]) && ((x2_388 = x2_406[@i_471]) && ((x3_387 = x3_405[@i_471]) && ((x4_386 = x4_404[@i_471]) && (x5_385 = x5_403[@i_471]))))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(x1_413[@i_470], x2_412[@i_470], x3_411[@i_470], x4_410[@i_470], x5_409[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && ((x1_389 = x1_413[@i_470]) && ((x2_388 = x2_412[@i_470]) && ((x3_387 = x3_411[@i_470]) && ((x4_386 = x4_410[@i_470]) && (x5_385 = x5_409[@i_470]))))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(x1_419[@i_469], x2_418[@i_469], x3_417[@i_469], x4_416[@i_469], x5_415[@i_469], r_414[@i_469]) && otheruses(r_414[@i_469]) && ((x1_389 = x1_419[@i_469]) && ((x2_388 = x2_418[@i_469]) && ((x3_387 = x3_417[@i_469]) && ((x4_386 = x4_416[@i_469]) && (x5_385 = x5_415[@i_469]))))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(x1_425[@i_468], x2_424[@i_468], x3_423[@i_468], x4_422[@i_468], x5_421[@i_468], r_420[@i_468]) && otheruses(r_420[@i_468]) && ((x1_389 = x1_425[@i_468]) && ((x2_388 = x2_424[@i_468]) && ((x3_387 = x3_423[@i_468]) && ((x4_386 = x4_422[@i_468]) && (x5_385 = x5_421[@i_468]))))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(x1_431[@i_467], x2_430[@i_467], x3_429[@i_467], x4_428[@i_467], x5_427[@i_467], r_426[@i_467]) && otheruses(r_426[@i_467]) && ((x1_389 = x1_431[@i_467]) && ((x2_388 = x2_430[@i_467]) && ((x3_387 = x3_429[@i_467]) && ((x4_386 = x4_428[@i_467]) && (x5_385 = x5_427[@i_467]))))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(x1_437[@i_466], x2_436[@i_466], x3_435[@i_466], x4_434[@i_466], x5_433[@i_466], r_432[@i_466]) && otheruses(r_432[@i_466]) && ((x1_389 = x1_437[@i_466]) && ((x2_388 = x2_436[@i_466]) && ((x3_387 = x3_435[@i_466]) && ((x4_386 = x4_434[@i_466]) && (x5_385 = x5_433[@i_466]))))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(x1_443[@i_465], x2_442[@i_465], x3_441[@i_465], x4_440[@i_465], x5_439[@i_465], r_438[@i_465]) && otheruses(r_438[@i_465]) && ((x1_389 = x1_443[@i_465]) && ((x2_388 = x2_442[@i_465]) && ((x3_387 = x3_441[@i_465]) && ((x4_386 = x4_440[@i_465]) && (x5_385 = x5_439[@i_465]))))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(x1_449[@i_464], x2_448[@i_464], x3_447[@i_464], x4_446[@i_464], x5_445[@i_464], r_444[@i_464]) && otheruses(r_444[@i_464]) && ((x1_389 = x1_449[@i_464]) && ((x2_388 = x2_448[@i_464]) && ((x3_387 = x3_447[@i_464]) && ((x4_386 = x4_446[@i_464]) && (x5_385 = x5_445[@i_464]))))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(x1_455[@i_463], x2_454[@i_463], x3_453[@i_463], x4_452[@i_463], x5_451[@i_463], r_450[@i_463]) && otheruses(r_450[@i_463]) && ((x1_389 = x1_455[@i_463]) && ((x2_388 = x2_454[@i_463]) && ((x3_387 = x3_453[@i_463]) && ((x4_386 = x4_452[@i_463]) && (x5_385 = x5_451[@i_463]))))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(x1_461[@i_462], x2_460[@i_462], x3_459[@i_462], x4_458[@i_462], x5_457[@i_462], r_456[@i_462]) && otheruses(r_456[@i_462]) && ((x1_389 = x1_461[@i_462]) && ((x2_388 = x2_460[@i_462]) && ((x3_387 = x3_459[@i_462]) && ((x4_386 = x4_458[@i_462]) && (x5_385 = x5_457[@i_462]))))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying simplify [Excluding set(dist 16->17, proba <= 1. / |exponent| * NP + 15. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + 10. * NU * NP / |exponent| + 2. * NS * NP / |exponent| + qH0 * NP / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + 8.5 * NU * NU / |G| + 3. * NS * NU / |G| + 2. * NP * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NP * qD / |G| + qD * NP / |exponent| + NU * qH1 / |hash1| + qD * NU / |G| + 0.5 * qD * qD / |G|)] yields

Game 17 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  let @2_m_174: G = cst_G in
  let @2_kd_173: passwd = cst_passwd in
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @2_r4_157[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = @2_r4_157[@i_246] in
    let K_u: G = exp(@2_r4_157[@i_246], x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((@2_r4_157[@i_246] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      let x3_423: G = X in
      let x4_422: G = @2_r4_157[@i_246] in
      let x5_421: G = K_u in
      find [unique] @i_552 <= qH0 suchthat defined(x1_389[@i_552], x2_388[@i_552], x3_387[@i_552], x4_386[@i_552], x5_385[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && ((x1_425 = x1_389[@i_552]) && ((x2_424 = x2_388[@i_552]) && ((x3_423 = x3_387[@i_552]) && ((x4_422 = x4_386[@i_552]) && (x5_421 = x5_385[@i_552]))))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let x1_419: host = U in
      let x2_418: host = S in
      let x3_417: G = X in
      let x4_416: G = @2_r4_157[@i_246] in
      let x5_415: G = K_u in
      find [unique] @i_539 <= qH0 suchthat defined(x1_389[@i_539], x2_388[@i_539], x3_387[@i_539], x4_386[@i_539], x5_385[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && ((x1_419 = x1_389[@i_539]) && ((x2_418 = x2_388[@i_539]) && ((x3_417 = x3_387[@i_539]) && ((x4_416 = x4_386[@i_539]) && (x5_415 = x5_385[@i_539]))))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @2_r4_172[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = @2_r4_172[@i_241] in
    let K_u: G = exp(@2_r4_172[@i_241], x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((@2_r4_172[@i_241] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      let x3_435: G = X in
      let x4_434: G = @2_r4_172[@i_241] in
      let x5_433: G = K_u in
      find [unique] @i_578 <= qH0 suchthat defined(x1_389[@i_578], x2_388[@i_578], x3_387[@i_578], x4_386[@i_578], x5_385[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && ((x1_437 = x1_389[@i_578]) && ((x2_436 = x2_388[@i_578]) && ((x3_435 = x3_387[@i_578]) && ((x4_434 = x4_386[@i_578]) && (x5_433 = x5_385[@i_578]))))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let x1_431: host = U in
      let x2_430: host = S in
      let x3_429: G = X in
      let x4_428: G = @2_r4_172[@i_241] in
      let x5_427: G = K_u in
      find [unique] @i_565 <= qH0 suchthat defined(x1_389[@i_565], x2_388[@i_565], x3_387[@i_565], x4_386[@i_565], x5_385[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && ((x1_431 = x1_389[@i_565]) && ((x2_430 = x2_388[@i_565]) && ((x3_429 = x3_387[@i_565]) && ((x4_428 = x4_386[@i_565]) && (x5_427 = x5_385[@i_565]))))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      let x3_447: G = X in
      let x4_446: G = Yp[@i_238] in
      let x5_445: G = K_u in
      find [unique] @i_604 <= qH0 suchthat defined(x1_389[@i_604], x2_388[@i_604], x3_387[@i_604], x4_386[@i_604], x5_385[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && ((x1_449 = x1_389[@i_604]) && ((x2_448 = x2_388[@i_604]) && ((x3_447 = x3_387[@i_604]) && ((x4_446 = x4_386[@i_604]) && (x5_445 = x5_385[@i_604]))))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let x1_443: host = U in
      let x2_442: host = S in
      let x3_441: G = X in
      let x4_440: G = Yp[@i_238] in
      let x5_439: G = K_u in
      find [unique] @i_591 <= qH0 suchthat defined(x1_389[@i_591], x2_388[@i_591], x3_387[@i_591], x4_386[@i_591], x5_385[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && ((x1_443 = x1_389[@i_591]) && ((x2_442 = x2_388[@i_591]) && ((x3_441 = x3_387[@i_591]) && ((x4_440 = x4_386[@i_591]) && (x5_439 = x5_385[@i_591]))))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      let x3_459: G = X in
      let x4_458: G = Y[@i_236] in
      let x5_457: G = K_u in
      find [unique] @i_630 <= qH0 suchthat defined(x1_389[@i_630], x2_388[@i_630], x3_387[@i_630], x4_386[@i_630], x5_385[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && ((x1_461 = x1_389[@i_630]) && ((x2_460 = x2_388[@i_630]) && ((x3_459 = x3_387[@i_630]) && ((x4_458 = x4_386[@i_630]) && (x5_457 = x5_385[@i_630]))))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind  suchthat defined(j[@i_236], r_396[@i_236]) && otheruses(r_396[@i_236]) && (!_41 = j[@i_236]) then
      (
        let @i_628 <= NS = @i_236 in
        let sk_u: hash0 = r_396[@i_236] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      new r1_90: hash1;
      let x1_455: host = U in
      let x2_454: host = S in
      let x3_453: G = X in
      let x4_452: G = Y[@i_236] in
      let x5_451: G = K_u in
      find [unique] @i_617 <= qH0 suchthat defined(x1_389[@i_617], x2_388[@i_617], x3_387[@i_617], x4_386[@i_617], x5_385[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && ((x1_455 = x1_389[@i_617]) && ((x2_454 = x2_388[@i_617]) && ((x3_453 = x3_387[@i_617]) && ((x4_452 = x4_386[@i_617]) && (x5_451 = x5_385[@i_617]))))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
  )
  else
    new @2_r4_172: G;
    let Y_u: G = @2_r4_172 in
    let K_u: G = exp(@2_r4_172, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    let x3_411: G = X in
    let x4_410: G = @2_r4_172 in
    let x5_409: G = K_u in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, sk_u);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  let @2_x_171: G = cst_G in
  let @2_ke_170: passwd = cst_passwd in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      let x3_399: G = X_s in
      let x4_398: G = Y in
      let x5_397: G = K_s in
      find [unique] @i_500 <= qH0 suchthat defined(x1_389[@i_500], x2_388[@i_500], x3_387[@i_500], x4_386[@i_500], x5_385[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && ((x1_401 = x1_389[@i_500]) && ((x2_400 = x2_388[@i_500]) && ((x3_399 = x3_387[@i_500]) && ((x4_398 = x4_386[@i_500]) && (x5_397 = x5_385[@i_500]))))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind  suchthat defined(@i_236[j], r_450[j]) && otheruses(r_450[j]) && (!_42 = @i_236[j]) then
      (
        let @i_489 <= NU = j in
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind  suchthat defined(@i_236[j], r_456[j]) && otheruses(r_456[j]) && (!_42 = @i_236[j]) then
      (
        let @i_488 <= NU = j in
        let sk_s: hash0 = r_456[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = X_s in
      let x4_404: G = Y in
      let x5_403: G = K_s in
      find [unique] @i_513 <= qH0 suchthat defined(x1_389[@i_513], x2_388[@i_513], x3_387[@i_513], x4_386[@i_513], x5_385[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1_389[@i_513]) && ((x2_406 = x2_388[@i_513]) && ((x3_405 = x3_387[@i_513]) && ((x4_404 = x4_386[@i_513]) && (x5_403 = x5_385[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let @i_502 <= NU = j in
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @2_r4_157[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@2_r4_157[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @2_r4_172[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@2_r4_172[@i_217] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let @2_x_165: G = cst_G in
  let @2_ke_164: passwd = cst_passwd in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  let x3_393: G = Xp in
  let x4_392: G = Yp in
  let x5_391: G = Kp in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  let @2_x_162: G = cst_G in
  let @2_ke_161: passwd = cst_passwd in
  find [unique] @i_198 <= qD suchthat defined(@2_r4_157[@i_198], @2_kd[@i_198], @2_m[@i_198]) && otheruses(@2_m[@i_198] -> @2_r4_157[@i_198]) && ((@2_x = @2_r4_157[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@2_r4_172[@i_193], Ystar_u[@i_193]) && otheruses(Ystar_u[@i_193] -> @2_r4_172[@i_193]) && ((@2_x = @2_r4_172[@i_193]) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  let @2_m_159: G = cst_G in
  let @2_kd_158: passwd = cst_passwd in
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @2_r4_157[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @2_r4_157[@i_186])
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @2_r4_172[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], @2_r4_172[@i_181])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @2_r4_157: G;
    out(@2_c4[!_45], @2_r4_157)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_389: host = x1 in
  let x2_388: host = x2 in
  let x3_387: G = x3 in
  let x4_386: G = x4 in
  let x5_385: G = x5 in
  find [unique] @i_474 <= qH0 suchthat defined(x1_389[@i_474], x2_388[@i_474], x3_387[@i_474], x4_386[@i_474], x5_385[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1_389 = x1_389[@i_474]) && ((x2_388 = x2_388[@i_474]) && ((x3_387 = x3_387[@i_474]) && ((x4_386 = x4_386[@i_474]) && (x5_385 = x5_385[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(x1_395[@i_473], x2_394[@i_473], x3_393[@i_473], x4_392[@i_473], x5_391[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && ((x1_389 = x1_395[@i_473]) && ((x2_388 = x2_394[@i_473]) && ((x3_387 = x3_393[@i_473]) && ((x4_386 = x4_392[@i_473]) && (x5_385 = x5_391[@i_473]))))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(x1_401[@i_472], x2_400[@i_472], x3_399[@i_472], x4_398[@i_472], x5_397[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && ((x1_389 = x1_401[@i_472]) && ((x2_388 = x2_400[@i_472]) && ((x3_387 = x3_399[@i_472]) && ((x4_386 = x4_398[@i_472]) && (x5_385 = x5_397[@i_472]))))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(x1_407[@i_471], x2_406[@i_471], x3_405[@i_471], x4_404[@i_471], x5_403[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && ((x1_389 = x1_407[@i_471]) && ((x2_388 = x2_406[@i_471]) && ((x3_387 = x3_405[@i_471]) && ((x4_386 = x4_404[@i_471]) && (x5_385 = x5_403[@i_471]))))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(x1_413[@i_470], x2_412[@i_470], x3_411[@i_470], x4_410[@i_470], x5_409[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && ((x1_389 = x1_413[@i_470]) && ((x2_388 = x2_412[@i_470]) && ((x3_387 = x3_411[@i_470]) && ((x4_386 = x4_410[@i_470]) && (x5_385 = x5_409[@i_470]))))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(x1_419[@i_469], x2_418[@i_469], x3_417[@i_469], x4_416[@i_469], x5_415[@i_469], r_414[@i_469]) && otheruses(r_414[@i_469]) && ((x1_389 = x1_419[@i_469]) && ((x2_388 = x2_418[@i_469]) && ((x3_387 = x3_417[@i_469]) && ((x4_386 = x4_416[@i_469]) && (x5_385 = x5_415[@i_469]))))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(x1_425[@i_468], x2_424[@i_468], x3_423[@i_468], x4_422[@i_468], x5_421[@i_468], r_420[@i_468]) && otheruses(r_420[@i_468]) && ((x1_389 = x1_425[@i_468]) && ((x2_388 = x2_424[@i_468]) && ((x3_387 = x3_423[@i_468]) && ((x4_386 = x4_422[@i_468]) && (x5_385 = x5_421[@i_468]))))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(x1_431[@i_467], x2_430[@i_467], x3_429[@i_467], x4_428[@i_467], x5_427[@i_467], r_426[@i_467]) && otheruses(r_426[@i_467]) && ((x1_389 = x1_431[@i_467]) && ((x2_388 = x2_430[@i_467]) && ((x3_387 = x3_429[@i_467]) && ((x4_386 = x4_428[@i_467]) && (x5_385 = x5_427[@i_467]))))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(x1_437[@i_466], x2_436[@i_466], x3_435[@i_466], x4_434[@i_466], x5_433[@i_466], r_432[@i_466]) && otheruses(r_432[@i_466]) && ((x1_389 = x1_437[@i_466]) && ((x2_388 = x2_436[@i_466]) && ((x3_387 = x3_435[@i_466]) && ((x4_386 = x4_434[@i_466]) && (x5_385 = x5_433[@i_466]))))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(x1_443[@i_465], x2_442[@i_465], x3_441[@i_465], x4_440[@i_465], x5_439[@i_465], r_438[@i_465]) && otheruses(r_438[@i_465]) && ((x1_389 = x1_443[@i_465]) && ((x2_388 = x2_442[@i_465]) && ((x3_387 = x3_441[@i_465]) && ((x4_386 = x4_440[@i_465]) && (x5_385 = x5_439[@i_465]))))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(x1_449[@i_464], x2_448[@i_464], x3_447[@i_464], x4_446[@i_464], x5_445[@i_464], r_444[@i_464]) && otheruses(r_444[@i_464]) && ((x1_389 = x1_449[@i_464]) && ((x2_388 = x2_448[@i_464]) && ((x3_387 = x3_447[@i_464]) && ((x4_386 = x4_446[@i_464]) && (x5_385 = x5_445[@i_464]))))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(x1_455[@i_463], x2_454[@i_463], x3_453[@i_463], x4_452[@i_463], x5_451[@i_463], r_450[@i_463]) && otheruses(r_450[@i_463]) && ((x1_389 = x1_455[@i_463]) && ((x2_388 = x2_454[@i_463]) && ((x3_387 = x3_453[@i_463]) && ((x4_386 = x4_452[@i_463]) && (x5_385 = x5_451[@i_463]))))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(x1_461[@i_462], x2_460[@i_462], x3_459[@i_462], x4_458[@i_462], x5_457[@i_462], r_456[@i_462]) && otheruses(r_456[@i_462]) && ((x1_389 = x1_461[@i_462]) && ((x2_388 = x2_460[@i_462]) && ((x3_387 = x3_459[@i_462]) && ((x4_386 = x4_458[@i_462]) && (x5_385 = x5_457[@i_462]))))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying move all binders yields

Game 18 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @2_r4_157[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = @2_r4_157[@i_246] in
    let K_u: G = exp(@2_r4_157[@i_246], x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((@2_r4_157[@i_246] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      let x3_423: G = X in
      let x4_422: G = @2_r4_157[@i_246] in
      let x5_421: G = K_u in
      find [unique] @i_552 <= qH0 suchthat defined(x1_389[@i_552], x2_388[@i_552], x3_387[@i_552], x4_386[@i_552], x5_385[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && ((x1_425 = x1_389[@i_552]) && ((x2_424 = x2_388[@i_552]) && ((x3_423 = x3_387[@i_552]) && ((x4_422 = x4_386[@i_552]) && (x5_421 = x5_385[@i_552]))))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_419: host = U in
      let x2_418: host = S in
      let x3_417: G = X in
      let x4_416: G = @2_r4_157[@i_246] in
      let x5_415: G = K_u in
      find [unique] @i_539 <= qH0 suchthat defined(x1_389[@i_539], x2_388[@i_539], x3_387[@i_539], x4_386[@i_539], x5_385[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && ((x1_419 = x1_389[@i_539]) && ((x2_418 = x2_388[@i_539]) && ((x3_417 = x3_387[@i_539]) && ((x4_416 = x4_386[@i_539]) && (x5_415 = x5_385[@i_539]))))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @2_r4_172[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = @2_r4_172[@i_241] in
    let K_u: G = exp(@2_r4_172[@i_241], x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((@2_r4_172[@i_241] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      let x3_435: G = X in
      let x4_434: G = @2_r4_172[@i_241] in
      let x5_433: G = K_u in
      find [unique] @i_578 <= qH0 suchthat defined(x1_389[@i_578], x2_388[@i_578], x3_387[@i_578], x4_386[@i_578], x5_385[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && ((x1_437 = x1_389[@i_578]) && ((x2_436 = x2_388[@i_578]) && ((x3_435 = x3_387[@i_578]) && ((x4_434 = x4_386[@i_578]) && (x5_433 = x5_385[@i_578]))))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_431: host = U in
      let x2_430: host = S in
      let x3_429: G = X in
      let x4_428: G = @2_r4_172[@i_241] in
      let x5_427: G = K_u in
      find [unique] @i_565 <= qH0 suchthat defined(x1_389[@i_565], x2_388[@i_565], x3_387[@i_565], x4_386[@i_565], x5_385[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && ((x1_431 = x1_389[@i_565]) && ((x2_430 = x2_388[@i_565]) && ((x3_429 = x3_387[@i_565]) && ((x4_428 = x4_386[@i_565]) && (x5_427 = x5_385[@i_565]))))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      let x3_447: G = X in
      let x4_446: G = Yp[@i_238] in
      let x5_445: G = K_u in
      find [unique] @i_604 <= qH0 suchthat defined(x1_389[@i_604], x2_388[@i_604], x3_387[@i_604], x4_386[@i_604], x5_385[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && ((x1_449 = x1_389[@i_604]) && ((x2_448 = x2_388[@i_604]) && ((x3_447 = x3_387[@i_604]) && ((x4_446 = x4_386[@i_604]) && (x5_445 = x5_385[@i_604]))))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_443: host = U in
      let x2_442: host = S in
      let x3_441: G = X in
      let x4_440: G = Yp[@i_238] in
      let x5_439: G = K_u in
      find [unique] @i_591 <= qH0 suchthat defined(x1_389[@i_591], x2_388[@i_591], x3_387[@i_591], x4_386[@i_591], x5_385[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && ((x1_443 = x1_389[@i_591]) && ((x2_442 = x2_388[@i_591]) && ((x3_441 = x3_387[@i_591]) && ((x4_440 = x4_386[@i_591]) && (x5_439 = x5_385[@i_591]))))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      let x3_459: G = X in
      let x4_458: G = Y[@i_236] in
      let x5_457: G = K_u in
      find [unique] @i_630 <= qH0 suchthat defined(x1_389[@i_630], x2_388[@i_630], x3_387[@i_630], x4_386[@i_630], x5_385[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && ((x1_461 = x1_389[@i_630]) && ((x2_460 = x2_388[@i_630]) && ((x3_459 = x3_387[@i_630]) && ((x4_458 = x4_386[@i_630]) && (x5_457 = x5_385[@i_630]))))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind  suchthat defined(j[@i_236], r_396[@i_236]) && otheruses(r_396[@i_236]) && (!_41 = j[@i_236]) then
      (
        let @i_628 <= NS = @i_236 in
        let sk_u: hash0 = r_396[@i_236] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], sk_u);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_455: host = U in
      let x2_454: host = S in
      let x3_453: G = X in
      let x4_452: G = Y[@i_236] in
      let x5_451: G = K_u in
      find [unique] @i_617 <= qH0 suchthat defined(x1_389[@i_617], x2_388[@i_617], x3_387[@i_617], x4_386[@i_617], x5_385[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && ((x1_455 = x1_389[@i_617]) && ((x2_454 = x2_388[@i_617]) && ((x3_453 = x3_387[@i_617]) && ((x4_452 = x4_386[@i_617]) && (x5_451 = x5_385[@i_617]))))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, sk_u);
        out(c6[!_41], r1_90)
  )
  else
    new @2_r4_172: G;
    let Y_u: G = @2_r4_172 in
    let K_u: G = exp(@2_r4_172, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    let x3_411: G = X in
    let x4_410: G = @2_r4_172 in
    let x5_409: G = K_u in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, sk_u);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      let x3_399: G = X_s in
      let x4_398: G = Y in
      let x5_397: G = K_s in
      find [unique] @i_500 <= qH0 suchthat defined(x1_389[@i_500], x2_388[@i_500], x3_387[@i_500], x4_386[@i_500], x5_385[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && ((x1_401 = x1_389[@i_500]) && ((x2_400 = x2_388[@i_500]) && ((x3_399 = x3_387[@i_500]) && ((x4_398 = x4_386[@i_500]) && (x5_397 = x5_385[@i_500]))))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind  suchthat defined(@i_236[j], r_450[j]) && otheruses(r_450[j]) && (!_42 = @i_236[j]) then
      (
        let @i_489 <= NU = j in
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind  suchthat defined(@i_236[j], r_456[j]) && otheruses(r_456[j]) && (!_42 = @i_236[j]) then
      (
        let @i_488 <= NU = j in
        let sk_s: hash0 = r_456[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = X_s in
      let x4_404: G = Y in
      let x5_403: G = K_s in
      find [unique] @i_513 <= qH0 suchthat defined(x1_389[@i_513], x2_388[@i_513], x3_387[@i_513], x4_386[@i_513], x5_385[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1_389[@i_513]) && ((x2_406 = x2_388[@i_513]) && ((x3_405 = x3_387[@i_513]) && ((x4_404 = x4_386[@i_513]) && (x5_403 = x5_385[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let @i_502 <= NU = j in
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, sk_s)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @2_r4_157[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@2_r4_157[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @2_r4_172[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@2_r4_172[@i_217] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  let @2_x_165: G = cst_G in
  let @2_ke_164: passwd = cst_passwd in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  let x3_393: G = Xp in
  let x4_392: G = Yp in
  let x5_391: G = Kp in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@2_r4_157[@i_198], @2_kd[@i_198], @2_m[@i_198]) && otheruses(@2_m[@i_198] -> @2_r4_157[@i_198]) && ((@2_x = @2_r4_157[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@2_r4_172[@i_193], Ystar_u[@i_193]) && otheruses(Ystar_u[@i_193] -> @2_r4_172[@i_193]) && ((@2_x = @2_r4_172[@i_193]) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @2_r4_157[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @2_r4_157[@i_186])
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @2_r4_172[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], @2_r4_172[@i_181])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @2_r4_157: G;
    out(@2_c4[!_45], @2_r4_157)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_389: host = x1 in
  let x2_388: host = x2 in
  let x3_387: G = x3 in
  let x4_386: G = x4 in
  let x5_385: G = x5 in
  find [unique] @i_474 <= qH0 suchthat defined(x1_389[@i_474], x2_388[@i_474], x3_387[@i_474], x4_386[@i_474], x5_385[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1_389 = x1_389[@i_474]) && ((x2_388 = x2_388[@i_474]) && ((x3_387 = x3_387[@i_474]) && ((x4_386 = x4_386[@i_474]) && (x5_385 = x5_385[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(x1_395[@i_473], x2_394[@i_473], x3_393[@i_473], x4_392[@i_473], x5_391[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && ((x1_389 = x1_395[@i_473]) && ((x2_388 = x2_394[@i_473]) && ((x3_387 = x3_393[@i_473]) && ((x4_386 = x4_392[@i_473]) && (x5_385 = x5_391[@i_473]))))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(x1_401[@i_472], x2_400[@i_472], x3_399[@i_472], x4_398[@i_472], x5_397[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && ((x1_389 = x1_401[@i_472]) && ((x2_388 = x2_400[@i_472]) && ((x3_387 = x3_399[@i_472]) && ((x4_386 = x4_398[@i_472]) && (x5_385 = x5_397[@i_472]))))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(x1_407[@i_471], x2_406[@i_471], x3_405[@i_471], x4_404[@i_471], x5_403[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && ((x1_389 = x1_407[@i_471]) && ((x2_388 = x2_406[@i_471]) && ((x3_387 = x3_405[@i_471]) && ((x4_386 = x4_404[@i_471]) && (x5_385 = x5_403[@i_471]))))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(x1_413[@i_470], x2_412[@i_470], x3_411[@i_470], x4_410[@i_470], x5_409[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && ((x1_389 = x1_413[@i_470]) && ((x2_388 = x2_412[@i_470]) && ((x3_387 = x3_411[@i_470]) && ((x4_386 = x4_410[@i_470]) && (x5_385 = x5_409[@i_470]))))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(x1_419[@i_469], x2_418[@i_469], x3_417[@i_469], x4_416[@i_469], x5_415[@i_469], r_414[@i_469]) && otheruses(r_414[@i_469]) && ((x1_389 = x1_419[@i_469]) && ((x2_388 = x2_418[@i_469]) && ((x3_387 = x3_417[@i_469]) && ((x4_386 = x4_416[@i_469]) && (x5_385 = x5_415[@i_469]))))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(x1_425[@i_468], x2_424[@i_468], x3_423[@i_468], x4_422[@i_468], x5_421[@i_468], r_420[@i_468]) && otheruses(r_420[@i_468]) && ((x1_389 = x1_425[@i_468]) && ((x2_388 = x2_424[@i_468]) && ((x3_387 = x3_423[@i_468]) && ((x4_386 = x4_422[@i_468]) && (x5_385 = x5_421[@i_468]))))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(x1_431[@i_467], x2_430[@i_467], x3_429[@i_467], x4_428[@i_467], x5_427[@i_467], r_426[@i_467]) && otheruses(r_426[@i_467]) && ((x1_389 = x1_431[@i_467]) && ((x2_388 = x2_430[@i_467]) && ((x3_387 = x3_429[@i_467]) && ((x4_386 = x4_428[@i_467]) && (x5_385 = x5_427[@i_467]))))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(x1_437[@i_466], x2_436[@i_466], x3_435[@i_466], x4_434[@i_466], x5_433[@i_466], r_432[@i_466]) && otheruses(r_432[@i_466]) && ((x1_389 = x1_437[@i_466]) && ((x2_388 = x2_436[@i_466]) && ((x3_387 = x3_435[@i_466]) && ((x4_386 = x4_434[@i_466]) && (x5_385 = x5_433[@i_466]))))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(x1_443[@i_465], x2_442[@i_465], x3_441[@i_465], x4_440[@i_465], x5_439[@i_465], r_438[@i_465]) && otheruses(r_438[@i_465]) && ((x1_389 = x1_443[@i_465]) && ((x2_388 = x2_442[@i_465]) && ((x3_387 = x3_441[@i_465]) && ((x4_386 = x4_440[@i_465]) && (x5_385 = x5_439[@i_465]))))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(x1_449[@i_464], x2_448[@i_464], x3_447[@i_464], x4_446[@i_464], x5_445[@i_464], r_444[@i_464]) && otheruses(r_444[@i_464]) && ((x1_389 = x1_449[@i_464]) && ((x2_388 = x2_448[@i_464]) && ((x3_387 = x3_447[@i_464]) && ((x4_386 = x4_446[@i_464]) && (x5_385 = x5_445[@i_464]))))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(x1_455[@i_463], x2_454[@i_463], x3_453[@i_463], x4_452[@i_463], x5_451[@i_463], r_450[@i_463]) && otheruses(r_450[@i_463]) && ((x1_389 = x1_455[@i_463]) && ((x2_388 = x2_454[@i_463]) && ((x3_387 = x3_453[@i_463]) && ((x4_386 = x4_452[@i_463]) && (x5_385 = x5_451[@i_463]))))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(x1_461[@i_462], x2_460[@i_462], x3_459[@i_462], x4_458[@i_462], x5_457[@i_462], r_456[@i_462]) && otheruses(r_456[@i_462]) && ((x1_389 = x1_461[@i_462]) && ((x2_388 = x2_460[@i_462]) && ((x3_387 = x3_459[@i_462]) && ((x4_386 = x4_458[@i_462]) && (x5_385 = x5_457[@i_462]))))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of useless yields

Game 19 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @2_r4_157[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = @2_r4_157[@i_246] in
    let K_u: G = exp(@2_r4_157[@i_246], x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((@2_r4_157[@i_246] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      let x3_423: G = cst_G in
      let x4_422: G = cst_G in
      let x5_421: G = cst_G in
      find [unique] @i_552 <= qH0 suchthat defined(x1[@i_552], x2[@i_552], x3[@i_552], x4[@i_552], x5[@i_552], x5_385[@i_552], x4_386[@i_552], x3_387[@i_552], x2_388[@i_552], x1_389[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && ((x1_425 = x1[@i_552]) && ((x2_424 = x2[@i_552]) && ((X = x3[@i_552]) && ((@2_r4_157[@i_246] = x4[@i_552]) && (K_u = x5[@i_552]))))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_552]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_420);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_419: host = U in
      let x2_418: host = S in
      let x3_417: G = cst_G in
      let x4_416: G = cst_G in
      let x5_415: G = cst_G in
      find [unique] @i_539 <= qH0 suchthat defined(x1[@i_539], x2[@i_539], x3[@i_539], x4[@i_539], x5[@i_539], x5_385[@i_539], x4_386[@i_539], x3_387[@i_539], x2_388[@i_539], x1_389[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && ((x1_419 = x1[@i_539]) && ((x2_418 = x2[@i_539]) && ((X = x3[@i_539]) && ((@2_r4_157[@i_246] = x4[@i_539]) && (K_u = x5[@i_539]))))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_539]);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_414);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @2_r4_172[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = @2_r4_172[@i_241] in
    let K_u: G = exp(@2_r4_172[@i_241], x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((@2_r4_172[@i_241] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      let x3_435: G = cst_G in
      let x4_434: G = cst_G in
      let x5_433: G = cst_G in
      find [unique] @i_578 <= qH0 suchthat defined(x1[@i_578], x2[@i_578], x3[@i_578], x4[@i_578], x5[@i_578], x5_385[@i_578], x4_386[@i_578], x3_387[@i_578], x2_388[@i_578], x1_389[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && ((x1_437 = x1[@i_578]) && ((x2_436 = x2[@i_578]) && ((X = x3[@i_578]) && ((@2_r4_172[@i_241] = x4[@i_578]) && (K_u = x5[@i_578]))))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_578]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_432);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_431: host = U in
      let x2_430: host = S in
      let x3_429: G = cst_G in
      let x4_428: G = cst_G in
      let x5_427: G = cst_G in
      find [unique] @i_565 <= qH0 suchthat defined(x1[@i_565], x2[@i_565], x3[@i_565], x4[@i_565], x5[@i_565], x5_385[@i_565], x4_386[@i_565], x3_387[@i_565], x2_388[@i_565], x1_389[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && ((x1_431 = x1[@i_565]) && ((x2_430 = x2[@i_565]) && ((X = x3[@i_565]) && ((@2_r4_172[@i_241] = x4[@i_565]) && (K_u = x5[@i_565]))))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_565]);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_426);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      let x3_447: G = cst_G in
      let x4_446: G = cst_G in
      let x5_445: G = cst_G in
      find [unique] @i_604 <= qH0 suchthat defined(x1[@i_604], x2[@i_604], x3[@i_604], x4[@i_604], x5[@i_604], x5_385[@i_604], x4_386[@i_604], x3_387[@i_604], x2_388[@i_604], x1_389[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && ((x1_449 = x1[@i_604]) && ((x2_448 = x2[@i_604]) && ((X = x3[@i_604]) && ((Yp[@i_238] = x4[@i_604]) && (K_u = x5[@i_604]))))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_604]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_444);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_443: host = U in
      let x2_442: host = S in
      let x3_441: G = cst_G in
      let x4_440: G = cst_G in
      let x5_439: G = cst_G in
      find [unique] @i_591 <= qH0 suchthat defined(x1[@i_591], x2[@i_591], x3[@i_591], x4[@i_591], x5[@i_591], x5_385[@i_591], x4_386[@i_591], x3_387[@i_591], x2_388[@i_591], x1_389[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && ((x1_443 = x1[@i_591]) && ((x2_442 = x2[@i_591]) && ((X = x3[@i_591]) && ((Yp[@i_238] = x4[@i_591]) && (K_u = x5[@i_591]))))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_591]);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_438);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      let x3_459: G = cst_G in
      let x4_458: G = cst_G in
      let x5_457: G = cst_G in
      find [unique] @i_630 <= qH0 suchthat defined(x1[@i_630], x2[@i_630], x3[@i_630], x4[@i_630], x5[@i_630], x5_385[@i_630], x4_386[@i_630], x3_387[@i_630], x2_388[@i_630], x1_389[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && ((x1_461 = x1[@i_630]) && ((x2_460 = x2[@i_630]) && ((X = x3[@i_630]) && ((Y[@i_236] = x4[@i_630]) && (K_u = x5[@i_630]))))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_630]);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind  suchthat defined(j[@i_236], r_396[@i_236]) && otheruses(r_396[@i_236]) && (!_41 = j[@i_236]) then
      (
        let sk_u: hash0 = r_396[@i_236] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_396[@i_236]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_456);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_455: host = U in
      let x2_454: host = S in
      let x3_453: G = cst_G in
      let x4_452: G = cst_G in
      let x5_451: G = cst_G in
      find [unique] @i_617 <= qH0 suchthat defined(x1[@i_617], x2[@i_617], x3[@i_617], x4[@i_617], x5[@i_617], x5_385[@i_617], x4_386[@i_617], x3_387[@i_617], x2_388[@i_617], x1_389[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && ((x1_455 = x1[@i_617]) && ((x2_454 = x2[@i_617]) && ((X = x3[@i_617]) && ((Y[@i_236] = x4[@i_617]) && (K_u = x5[@i_617]))))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_617]);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_450);
        out(c6[!_41], r1_90)
  )
  else
    new @2_r4_172: G;
    let Y_u: G = @2_r4_172 in
    let K_u: G = exp(@2_r4_172, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    let x3_411: G = cst_G in
    let x4_410: G = cst_G in
    let x5_409: G = cst_G in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      let x3_399: G = cst_G in
      let x4_398: G = cst_G in
      let x5_397: G = cst_G in
      find [unique] @i_500 <= qH0 suchthat defined(x1[@i_500], x2[@i_500], x3[@i_500], x4[@i_500], x5[@i_500], x5_385[@i_500], x4_386[@i_500], x3_387[@i_500], x2_388[@i_500], x1_389[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && ((x1_401 = x1[@i_500]) && ((x2_400 = x2[@i_500]) && ((X_s = x3[@i_500]) && ((Y = x4[@i_500]) && (K_s = x5[@i_500]))))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_500])
      )
      orfind  suchthat defined(@i_236[j], r_450[j]) && otheruses(r_450[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      orfind  suchthat defined(@i_236[j], r_456[j]) && otheruses(r_456[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_456[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_456[j])
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_396)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = cst_G in
      let x4_404: G = cst_G in
      let x5_403: G = cst_G in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], x5_385[@i_513], x4_386[@i_513], x3_387[@i_513], x2_388[@i_513], x1_389[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (K_s = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @2_r4_157[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@2_r4_157[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @2_r4_172[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@2_r4_172[@i_217] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  let x3_393: G = cst_G in
  let x4_392: G = cst_G in
  let x5_391: G = cst_G in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@2_r4_157[@i_198], @2_kd[@i_198], @2_m[@i_198]) && otheruses(@2_m[@i_198] -> @2_r4_157[@i_198]) && ((@2_x = @2_r4_157[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@2_r4_172[@i_193], Ystar_u[@i_193]) && otheruses(Ystar_u[@i_193] -> @2_r4_172[@i_193]) && ((@2_x = @2_r4_172[@i_193]) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @2_r4_157[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @2_r4_157[@i_186])
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @2_r4_172[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], @2_r4_172[@i_181])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @2_r4_157: G;
    out(@2_c4[!_45], @2_r4_157)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_389: host = cst_host in
  let x2_388: host = cst_host in
  let x3_387: G = cst_G in
  let x4_386: G = cst_G in
  let x5_385: G = cst_G in
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], x5_385[@i_474], x4_386[@i_474], x3_387[@i_474], x2_388[@i_474], x1_389[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(Xp[@i_473], Yp[@i_473], Kp[@i_473], x5_391[@i_473], x4_392[@i_473], x3_393[@i_473], x1_395[@i_473], x2_394[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && ((x1 = x1_395[@i_473]) && ((x2 = x2_394[@i_473]) && ((x3 = Xp[@i_473]) && ((x4 = Yp[@i_473]) && (x5 = Kp[@i_473]))))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(X_s[@i_472], Y[@i_472], K_s[@i_472], x5_397[@i_472], x4_398[@i_472], x3_399[@i_472], x1_401[@i_472], x2_400[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && ((x1 = x1_401[@i_472]) && ((x2 = x2_400[@i_472]) && ((x3 = X_s[@i_472]) && ((x4 = Y[@i_472]) && (x5 = K_s[@i_472]))))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(X_s[@i_471], Y[@i_471], K_s[@i_471], x5_403[@i_471], x4_404[@i_471], x3_405[@i_471], x1_407[@i_471], x2_406[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && ((x1 = x1_407[@i_471]) && ((x2 = x2_406[@i_471]) && ((x3 = X_s[@i_471]) && ((x4 = Y[@i_471]) && (x5 = K_s[@i_471]))))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(X[@i_470], @2_r4_172[@i_470], K_u[@i_470], x5_409[@i_470], x4_410[@i_470], x3_411[@i_470], x1_413[@i_470], x2_412[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && ((x1 = x1_413[@i_470]) && ((x2 = x2_412[@i_470]) && ((x3 = X[@i_470]) && ((x4 = @2_r4_172[@i_470]) && (x5 = K_u[@i_470]))))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(X[@i_469], @2_r4_157[@i_246[@i_469]], K_u[@i_469], x5_415[@i_469], x4_416[@i_469], x3_417[@i_469], x1_419[@i_469], x2_418[@i_469], r_414[@i_469]) && otheruses(r_414[@i_469]) && ((x1 = x1_419[@i_469]) && ((x2 = x2_418[@i_469]) && ((x3 = X[@i_469]) && ((x4 = @2_r4_157[@i_246[@i_469]]) && (x5 = K_u[@i_469]))))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(X[@i_468], @2_r4_157[@i_246[@i_468]], K_u[@i_468], x5_421[@i_468], x4_422[@i_468], x3_423[@i_468], x1_425[@i_468], x2_424[@i_468], r_420[@i_468]) && otheruses(r_420[@i_468]) && ((x1 = x1_425[@i_468]) && ((x2 = x2_424[@i_468]) && ((x3 = X[@i_468]) && ((x4 = @2_r4_157[@i_246[@i_468]]) && (x5 = K_u[@i_468]))))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(X[@i_467], @2_r4_172[@i_241[@i_467]], K_u[@i_467], x5_427[@i_467], x4_428[@i_467], x3_429[@i_467], x1_431[@i_467], x2_430[@i_467], r_426[@i_467]) && otheruses(r_426[@i_467]) && ((x1 = x1_431[@i_467]) && ((x2 = x2_430[@i_467]) && ((x3 = X[@i_467]) && ((x4 = @2_r4_172[@i_241[@i_467]]) && (x5 = K_u[@i_467]))))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(X[@i_466], @2_r4_172[@i_241[@i_466]], K_u[@i_466], x5_433[@i_466], x4_434[@i_466], x3_435[@i_466], x1_437[@i_466], x2_436[@i_466], r_432[@i_466]) && otheruses(r_432[@i_466]) && ((x1 = x1_437[@i_466]) && ((x2 = x2_436[@i_466]) && ((x3 = X[@i_466]) && ((x4 = @2_r4_172[@i_241[@i_466]]) && (x5 = K_u[@i_466]))))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(X[@i_465], Yp[@i_238[@i_465]], K_u[@i_465], x5_439[@i_465], x4_440[@i_465], x3_441[@i_465], x1_443[@i_465], x2_442[@i_465], r_438[@i_465]) && otheruses(r_438[@i_465]) && ((x1 = x1_443[@i_465]) && ((x2 = x2_442[@i_465]) && ((x3 = X[@i_465]) && ((x4 = Yp[@i_238[@i_465]]) && (x5 = K_u[@i_465]))))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(X[@i_464], Yp[@i_238[@i_464]], K_u[@i_464], x5_445[@i_464], x4_446[@i_464], x3_447[@i_464], x1_449[@i_464], x2_448[@i_464], r_444[@i_464]) && otheruses(r_444[@i_464]) && ((x1 = x1_449[@i_464]) && ((x2 = x2_448[@i_464]) && ((x3 = X[@i_464]) && ((x4 = Yp[@i_238[@i_464]]) && (x5 = K_u[@i_464]))))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(X[@i_463], Y[@i_236[@i_463]], K_u[@i_463], x5_451[@i_463], x4_452[@i_463], x3_453[@i_463], x1_455[@i_463], x2_454[@i_463], r_450[@i_463]) && otheruses(r_450[@i_463]) && ((x1 = x1_455[@i_463]) && ((x2 = x2_454[@i_463]) && ((x3 = X[@i_463]) && ((x4 = Y[@i_236[@i_463]]) && (x5 = K_u[@i_463]))))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(X[@i_462], Y[@i_236[@i_462]], K_u[@i_462], x5_457[@i_462], x4_458[@i_462], x3_459[@i_462], x1_461[@i_462], x2_460[@i_462], r_456[@i_462]) && otheruses(r_456[@i_462]) && ((x1 = x1_461[@i_462]) && ((x2 = x2_460[@i_462]) && ((x3 = X[@i_462]) && ((x4 = Y[@i_236[@i_462]]) && (x5 = K_u[@i_462]))))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying equivalence
equiv ! !_1 <= @1_N new @1_X: G; (
  @1_OX() := @1_X,
  ! !_2 <= @1_N' @1_OXm(@1_m: exponent) := exp(@1_X, @1_m))
<=(0)=>
      ! !_3 <= @1_N new @1_x: exponent; (
  @1_OX() := exp(g, @1_x),
  ! !_4 <= @1_N' @1_OXm(@1_m: exponent) := exp(g, mult(@1_x, @1_m)))
 yields

Game 20 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@1_x_783[@i_246], @2_m[@i_246], @2_kd[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_x_783[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = exp(g, @1_x_783[@i_246]) in
    let K_u: G = exp(g, mult(@1_x_783[@i_246], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_783[@i_246]) = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      let x3_423: G = cst_G in
      let x4_422: G = cst_G in
      let x5_421: G = cst_G in
      find [unique] @i_552 <= qH0 suchthat defined(x1[@i_552], x2[@i_552], x3[@i_552], x4[@i_552], x5[@i_552], x5_385[@i_552], x4_386[@i_552], x3_387[@i_552], x2_388[@i_552], x1_389[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && ((x1_425 = x1[@i_552]) && ((x2_424 = x2[@i_552]) && ((X = x3[@i_552]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_552]) && (K_u = x5[@i_552]))))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_552]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_420);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_419: host = U in
      let x2_418: host = S in
      let x3_417: G = cst_G in
      let x4_416: G = cst_G in
      let x5_415: G = cst_G in
      find [unique] @i_539 <= qH0 suchthat defined(x1[@i_539], x2[@i_539], x3[@i_539], x4[@i_539], x5[@i_539], x5_385[@i_539], x4_386[@i_539], x3_387[@i_539], x2_388[@i_539], x1_389[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && ((x1_419 = x1[@i_539]) && ((x2_418 = x2[@i_539]) && ((X = x3[@i_539]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_539]) && (K_u = x5[@i_539]))))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_539]);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_414);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @2_r4_172[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = @2_r4_172[@i_241] in
    let K_u: G = exp(@2_r4_172[@i_241], x) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((@2_r4_172[@i_241] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      let x3_435: G = cst_G in
      let x4_434: G = cst_G in
      let x5_433: G = cst_G in
      find [unique] @i_578 <= qH0 suchthat defined(x1[@i_578], x2[@i_578], x3[@i_578], x4[@i_578], x5[@i_578], x5_385[@i_578], x4_386[@i_578], x3_387[@i_578], x2_388[@i_578], x1_389[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && ((x1_437 = x1[@i_578]) && ((x2_436 = x2[@i_578]) && ((X = x3[@i_578]) && ((@2_r4_172[@i_241] = x4[@i_578]) && (K_u = x5[@i_578]))))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_578]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_432);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_431: host = U in
      let x2_430: host = S in
      let x3_429: G = cst_G in
      let x4_428: G = cst_G in
      let x5_427: G = cst_G in
      find [unique] @i_565 <= qH0 suchthat defined(x1[@i_565], x2[@i_565], x3[@i_565], x4[@i_565], x5[@i_565], x5_385[@i_565], x4_386[@i_565], x3_387[@i_565], x2_388[@i_565], x1_389[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && ((x1_431 = x1[@i_565]) && ((x2_430 = x2[@i_565]) && ((X = x3[@i_565]) && ((@2_r4_172[@i_241] = x4[@i_565]) && (K_u = x5[@i_565]))))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_565]);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_426);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      let x3_447: G = cst_G in
      let x4_446: G = cst_G in
      let x5_445: G = cst_G in
      find [unique] @i_604 <= qH0 suchthat defined(x1[@i_604], x2[@i_604], x3[@i_604], x4[@i_604], x5[@i_604], x5_385[@i_604], x4_386[@i_604], x3_387[@i_604], x2_388[@i_604], x1_389[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && ((x1_449 = x1[@i_604]) && ((x2_448 = x2[@i_604]) && ((X = x3[@i_604]) && ((Yp[@i_238] = x4[@i_604]) && (K_u = x5[@i_604]))))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_604]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_444);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_443: host = U in
      let x2_442: host = S in
      let x3_441: G = cst_G in
      let x4_440: G = cst_G in
      let x5_439: G = cst_G in
      find [unique] @i_591 <= qH0 suchthat defined(x1[@i_591], x2[@i_591], x3[@i_591], x4[@i_591], x5[@i_591], x5_385[@i_591], x4_386[@i_591], x3_387[@i_591], x2_388[@i_591], x1_389[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && ((x1_443 = x1[@i_591]) && ((x2_442 = x2[@i_591]) && ((X = x3[@i_591]) && ((Yp[@i_238] = x4[@i_591]) && (K_u = x5[@i_591]))))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_591]);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_438);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      let x3_459: G = cst_G in
      let x4_458: G = cst_G in
      let x5_457: G = cst_G in
      find [unique] @i_630 <= qH0 suchthat defined(x1[@i_630], x2[@i_630], x3[@i_630], x4[@i_630], x5[@i_630], x5_385[@i_630], x4_386[@i_630], x3_387[@i_630], x2_388[@i_630], x1_389[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && ((x1_461 = x1[@i_630]) && ((x2_460 = x2[@i_630]) && ((X = x3[@i_630]) && ((Y[@i_236] = x4[@i_630]) && (K_u = x5[@i_630]))))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_630]);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind  suchthat defined(j[@i_236], r_396[@i_236]) && otheruses(r_396[@i_236]) && (!_41 = j[@i_236]) then
      (
        let sk_u: hash0 = r_396[@i_236] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_396[@i_236]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_456);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_455: host = U in
      let x2_454: host = S in
      let x3_453: G = cst_G in
      let x4_452: G = cst_G in
      let x5_451: G = cst_G in
      find [unique] @i_617 <= qH0 suchthat defined(x1[@i_617], x2[@i_617], x3[@i_617], x4[@i_617], x5[@i_617], x5_385[@i_617], x4_386[@i_617], x3_387[@i_617], x2_388[@i_617], x1_389[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && ((x1_455 = x1[@i_617]) && ((x2_454 = x2[@i_617]) && ((X = x3[@i_617]) && ((Y[@i_236] = x4[@i_617]) && (K_u = x5[@i_617]))))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_617]);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_450);
        out(c6[!_41], r1_90)
  )
  else
    new @2_r4_172: G;
    let Y_u: G = @2_r4_172 in
    let K_u: G = exp(@2_r4_172, x) in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    let x3_411: G = cst_G in
    let x4_410: G = cst_G in
    let x5_409: G = cst_G in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      let x3_399: G = cst_G in
      let x4_398: G = cst_G in
      let x5_397: G = cst_G in
      find [unique] @i_500 <= qH0 suchthat defined(x1[@i_500], x2[@i_500], x3[@i_500], x4[@i_500], x5[@i_500], x5_385[@i_500], x4_386[@i_500], x3_387[@i_500], x2_388[@i_500], x1_389[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && ((x1_401 = x1[@i_500]) && ((x2_400 = x2[@i_500]) && ((X_s = x3[@i_500]) && ((Y = x4[@i_500]) && (K_s = x5[@i_500]))))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_500])
      )
      orfind  suchthat defined(@i_236[j], r_450[j]) && otheruses(r_450[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      orfind  suchthat defined(@i_236[j], r_456[j]) && otheruses(r_456[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_456[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_456[j])
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_396)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = cst_G in
      let x4_404: G = cst_G in
      let x5_403: G = cst_G in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], x5_385[@i_513], x4_386[@i_513], x3_387[@i_513], x2_388[@i_513], x1_389[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (K_s = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@1_x_783[@i_222], @2_m[@i_222], @2_kd[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_x_783[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_783[@i_222]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @2_r4_172[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@2_r4_172[@i_217] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  let x3_393: G = cst_G in
  let x4_392: G = cst_G in
  let x5_391: G = cst_G in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_x_783[@i_198], @2_r4_157[@i_198], @2_kd[@i_198], @2_m[@i_198]) && otheruses(@2_m[@i_198] -> @1_x_783[@i_198]) && ((@2_x = exp(g, @1_x_783[@i_198])) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@2_r4_172[@i_193], Ystar_u[@i_193]) && otheruses(Ystar_u[@i_193] -> @2_r4_172[@i_193]) && ((@2_x = @2_r4_172[@i_193]) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@1_x_783[@i_186], @2_m[@i_186], @2_kd[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_x_783[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], exp(g, @1_x_783[@i_186]))
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @2_r4_172[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], @2_r4_172[@i_181])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_x_783: exponent;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], exp(g, @1_x_783))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_389: host = cst_host in
  let x2_388: host = cst_host in
  let x3_387: G = cst_G in
  let x4_386: G = cst_G in
  let x5_385: G = cst_G in
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], x5_385[@i_474], x4_386[@i_474], x3_387[@i_474], x2_388[@i_474], x1_389[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(Xp[@i_473], Yp[@i_473], Kp[@i_473], x5_391[@i_473], x4_392[@i_473], x3_393[@i_473], x1_395[@i_473], x2_394[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && ((x1 = x1_395[@i_473]) && ((x2 = x2_394[@i_473]) && ((x3 = Xp[@i_473]) && ((x4 = Yp[@i_473]) && (x5 = Kp[@i_473]))))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(X_s[@i_472], Y[@i_472], K_s[@i_472], x5_397[@i_472], x4_398[@i_472], x3_399[@i_472], x1_401[@i_472], x2_400[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && ((x1 = x1_401[@i_472]) && ((x2 = x2_400[@i_472]) && ((x3 = X_s[@i_472]) && ((x4 = Y[@i_472]) && (x5 = K_s[@i_472]))))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(X_s[@i_471], Y[@i_471], K_s[@i_471], x5_403[@i_471], x4_404[@i_471], x3_405[@i_471], x1_407[@i_471], x2_406[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && ((x1 = x1_407[@i_471]) && ((x2 = x2_406[@i_471]) && ((x3 = X_s[@i_471]) && ((x4 = Y[@i_471]) && (x5 = K_s[@i_471]))))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(X[@i_470], @2_r4_172[@i_470], K_u[@i_470], x5_409[@i_470], x4_410[@i_470], x3_411[@i_470], x1_413[@i_470], x2_412[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && ((x1 = x1_413[@i_470]) && ((x2 = x2_412[@i_470]) && ((x3 = X[@i_470]) && ((x4 = @2_r4_172[@i_470]) && (x5 = K_u[@i_470]))))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(@1_x_783[@i_246[@i_469]], X[@i_469], @2_r4_157[@i_246[@i_469]], K_u[@i_469], x5_415[@i_469], x4_416[@i_469], x3_417[@i_469], x1_419[@i_469], x2_418[@i_469], r_414[@i_469]) && otheruses(r_414[@i_469]) && ((x1 = x1_419[@i_469]) && ((x2 = x2_418[@i_469]) && ((x3 = X[@i_469]) && ((x4 = exp(g, @1_x_783[@i_246[@i_469]])) && (x5 = K_u[@i_469]))))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(@1_x_783[@i_246[@i_468]], X[@i_468], @2_r4_157[@i_246[@i_468]], K_u[@i_468], x5_421[@i_468], x4_422[@i_468], x3_423[@i_468], x1_425[@i_468], x2_424[@i_468], r_420[@i_468]) && otheruses(r_420[@i_468]) && ((x1 = x1_425[@i_468]) && ((x2 = x2_424[@i_468]) && ((x3 = X[@i_468]) && ((x4 = exp(g, @1_x_783[@i_246[@i_468]])) && (x5 = K_u[@i_468]))))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(X[@i_467], @2_r4_172[@i_241[@i_467]], K_u[@i_467], x5_427[@i_467], x4_428[@i_467], x3_429[@i_467], x1_431[@i_467], x2_430[@i_467], r_426[@i_467]) && otheruses(r_426[@i_467]) && ((x1 = x1_431[@i_467]) && ((x2 = x2_430[@i_467]) && ((x3 = X[@i_467]) && ((x4 = @2_r4_172[@i_241[@i_467]]) && (x5 = K_u[@i_467]))))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(X[@i_466], @2_r4_172[@i_241[@i_466]], K_u[@i_466], x5_433[@i_466], x4_434[@i_466], x3_435[@i_466], x1_437[@i_466], x2_436[@i_466], r_432[@i_466]) && otheruses(r_432[@i_466]) && ((x1 = x1_437[@i_466]) && ((x2 = x2_436[@i_466]) && ((x3 = X[@i_466]) && ((x4 = @2_r4_172[@i_241[@i_466]]) && (x5 = K_u[@i_466]))))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(X[@i_465], Yp[@i_238[@i_465]], K_u[@i_465], x5_439[@i_465], x4_440[@i_465], x3_441[@i_465], x1_443[@i_465], x2_442[@i_465], r_438[@i_465]) && otheruses(r_438[@i_465]) && ((x1 = x1_443[@i_465]) && ((x2 = x2_442[@i_465]) && ((x3 = X[@i_465]) && ((x4 = Yp[@i_238[@i_465]]) && (x5 = K_u[@i_465]))))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(X[@i_464], Yp[@i_238[@i_464]], K_u[@i_464], x5_445[@i_464], x4_446[@i_464], x3_447[@i_464], x1_449[@i_464], x2_448[@i_464], r_444[@i_464]) && otheruses(r_444[@i_464]) && ((x1 = x1_449[@i_464]) && ((x2 = x2_448[@i_464]) && ((x3 = X[@i_464]) && ((x4 = Yp[@i_238[@i_464]]) && (x5 = K_u[@i_464]))))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(X[@i_463], Y[@i_236[@i_463]], K_u[@i_463], x5_451[@i_463], x4_452[@i_463], x3_453[@i_463], x1_455[@i_463], x2_454[@i_463], r_450[@i_463]) && otheruses(r_450[@i_463]) && ((x1 = x1_455[@i_463]) && ((x2 = x2_454[@i_463]) && ((x3 = X[@i_463]) && ((x4 = Y[@i_236[@i_463]]) && (x5 = K_u[@i_463]))))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(X[@i_462], Y[@i_236[@i_462]], K_u[@i_462], x5_457[@i_462], x4_458[@i_462], x3_459[@i_462], x1_461[@i_462], x2_460[@i_462], r_456[@i_462]) && otheruses(r_456[@i_462]) && ((x1 = x1_461[@i_462]) && ((x2 = x2_460[@i_462]) && ((x3 = X[@i_462]) && ((x4 = Y[@i_236[@i_462]]) && (x5 = K_u[@i_462]))))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying equivalence
equiv ! !_1 <= @1_N new @1_X: G; (
  @1_OX() := @1_X,
  ! !_2 <= @1_N' @1_OXm(@1_m: exponent) := exp(@1_X, @1_m))
<=(0)=>
      ! !_3 <= @1_N new @1_x: exponent; (
  @1_OX() := exp(g, @1_x),
  ! !_4 <= @1_N' @1_OXm(@1_m: exponent) := exp(g, mult(@1_x, @1_m)))
 yields

Game 21 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@1_x_783[@i_246], @2_m[@i_246], @2_kd[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_x_783[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = exp(g, @1_x_783[@i_246]) in
    let K_u: G = exp(g, mult(@1_x_783[@i_246], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_783[@i_246]) = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      let x3_423: G = cst_G in
      let x4_422: G = cst_G in
      let x5_421: G = cst_G in
      find [unique] @i_552 <= qH0 suchthat defined(x1[@i_552], x2[@i_552], x3[@i_552], x4[@i_552], x5[@i_552], x5_385[@i_552], x4_386[@i_552], x3_387[@i_552], x2_388[@i_552], x1_389[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && ((x1_425 = x1[@i_552]) && ((x2_424 = x2[@i_552]) && ((X = x3[@i_552]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_552]) && (K_u = x5[@i_552]))))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_552]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_420);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_419: host = U in
      let x2_418: host = S in
      let x3_417: G = cst_G in
      let x4_416: G = cst_G in
      let x5_415: G = cst_G in
      find [unique] @i_539 <= qH0 suchthat defined(x1[@i_539], x2[@i_539], x3[@i_539], x4[@i_539], x5[@i_539], x5_385[@i_539], x4_386[@i_539], x3_387[@i_539], x2_388[@i_539], x1_389[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && ((x1_419 = x1[@i_539]) && ((x2_418 = x2[@i_539]) && ((X = x3[@i_539]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_539]) && (K_u = x5[@i_539]))))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_539]);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_414);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(@1_x_925[@i_241], Ystar_u[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @1_x_925[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = exp(g, @1_x_925[@i_241]) in
    let K_u: G = exp(g, mult(@1_x_925[@i_241], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_925[@i_241]) = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      let x3_435: G = cst_G in
      let x4_434: G = cst_G in
      let x5_433: G = cst_G in
      find [unique] @i_578 <= qH0 suchthat defined(x1[@i_578], x2[@i_578], x3[@i_578], x4[@i_578], x5[@i_578], x5_385[@i_578], x4_386[@i_578], x3_387[@i_578], x2_388[@i_578], x1_389[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && ((x1_437 = x1[@i_578]) && ((x2_436 = x2[@i_578]) && ((X = x3[@i_578]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_578]) && (K_u = x5[@i_578]))))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_578]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_432);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_431: host = U in
      let x2_430: host = S in
      let x3_429: G = cst_G in
      let x4_428: G = cst_G in
      let x5_427: G = cst_G in
      find [unique] @i_565 <= qH0 suchthat defined(x1[@i_565], x2[@i_565], x3[@i_565], x4[@i_565], x5[@i_565], x5_385[@i_565], x4_386[@i_565], x3_387[@i_565], x2_388[@i_565], x1_389[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && ((x1_431 = x1[@i_565]) && ((x2_430 = x2[@i_565]) && ((X = x3[@i_565]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_565]) && (K_u = x5[@i_565]))))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_565]);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_426);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      let x3_447: G = cst_G in
      let x4_446: G = cst_G in
      let x5_445: G = cst_G in
      find [unique] @i_604 <= qH0 suchthat defined(x1[@i_604], x2[@i_604], x3[@i_604], x4[@i_604], x5[@i_604], x5_385[@i_604], x4_386[@i_604], x3_387[@i_604], x2_388[@i_604], x1_389[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && ((x1_449 = x1[@i_604]) && ((x2_448 = x2[@i_604]) && ((X = x3[@i_604]) && ((Yp[@i_238] = x4[@i_604]) && (K_u = x5[@i_604]))))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_604]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_444);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_443: host = U in
      let x2_442: host = S in
      let x3_441: G = cst_G in
      let x4_440: G = cst_G in
      let x5_439: G = cst_G in
      find [unique] @i_591 <= qH0 suchthat defined(x1[@i_591], x2[@i_591], x3[@i_591], x4[@i_591], x5[@i_591], x5_385[@i_591], x4_386[@i_591], x3_387[@i_591], x2_388[@i_591], x1_389[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && ((x1_443 = x1[@i_591]) && ((x2_442 = x2[@i_591]) && ((X = x3[@i_591]) && ((Yp[@i_238] = x4[@i_591]) && (K_u = x5[@i_591]))))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_591]);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_438);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (K_u = x15[@i_120]))))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      let x3_459: G = cst_G in
      let x4_458: G = cst_G in
      let x5_457: G = cst_G in
      find [unique] @i_630 <= qH0 suchthat defined(x1[@i_630], x2[@i_630], x3[@i_630], x4[@i_630], x5[@i_630], x5_385[@i_630], x4_386[@i_630], x3_387[@i_630], x2_388[@i_630], x1_389[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && ((x1_461 = x1[@i_630]) && ((x2_460 = x2[@i_630]) && ((X = x3[@i_630]) && ((Y[@i_236] = x4[@i_630]) && (K_u = x5[@i_630]))))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_630]);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind  suchthat defined(j[@i_236], r_396[@i_236]) && otheruses(r_396[@i_236]) && (!_41 = j[@i_236]) then
      (
        let sk_u: hash0 = r_396[@i_236] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_396[@i_236]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_456);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_455: host = U in
      let x2_454: host = S in
      let x3_453: G = cst_G in
      let x4_452: G = cst_G in
      let x5_451: G = cst_G in
      find [unique] @i_617 <= qH0 suchthat defined(x1[@i_617], x2[@i_617], x3[@i_617], x4[@i_617], x5[@i_617], x5_385[@i_617], x4_386[@i_617], x3_387[@i_617], x2_388[@i_617], x1_389[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && ((x1_455 = x1[@i_617]) && ((x2_454 = x2[@i_617]) && ((X = x3[@i_617]) && ((Y[@i_236] = x4[@i_617]) && (K_u = x5[@i_617]))))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_617]);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_450);
        out(c6[!_41], r1_90)
  )
  else
    new @1_x_925: exponent;
    let @2_r4_172: G = cst_G in
    let Y_u: G = exp(g, @1_x_925) in
    let K_u: G = exp(g, mult(@1_x_925, x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    let x3_411: G = cst_G in
    let x4_410: G = cst_G in
    let x5_409: G = cst_G in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      let x3_399: G = cst_G in
      let x4_398: G = cst_G in
      let x5_397: G = cst_G in
      find [unique] @i_500 <= qH0 suchthat defined(x1[@i_500], x2[@i_500], x3[@i_500], x4[@i_500], x5[@i_500], x5_385[@i_500], x4_386[@i_500], x3_387[@i_500], x2_388[@i_500], x1_389[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && ((x1_401 = x1[@i_500]) && ((x2_400 = x2[@i_500]) && ((X_s = x3[@i_500]) && ((Y = x4[@i_500]) && (K_s = x5[@i_500]))))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_500])
      )
      orfind  suchthat defined(@i_236[j], r_450[j]) && otheruses(r_450[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      orfind  suchthat defined(@i_236[j], r_456[j]) && otheruses(r_456[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_456[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_456[j])
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_396)
    )
    orfind  suchthat defined(Y_u[j], K_u[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u[j])) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = cst_G in
      let x4_404: G = cst_G in
      let x5_403: G = cst_G in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], x5_385[@i_513], x4_386[@i_513], x3_387[@i_513], x2_388[@i_513], x1_389[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (K_s = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@1_x_783[@i_222], @2_m[@i_222], @2_kd[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_x_783[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_783[@i_222]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(@1_x_925[@i_217], Ystar_u[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @1_x_925[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_925[@i_217]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  let x3_393: G = cst_G in
  let x4_392: G = cst_G in
  let x5_391: G = cst_G in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_x_783[@i_198], @2_r4_157[@i_198], @2_kd[@i_198], @2_m[@i_198]) && otheruses(@2_m[@i_198] -> @1_x_783[@i_198]) && ((@2_x = exp(g, @1_x_783[@i_198])) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@1_x_925[@i_193], @2_r4_172[@i_193], Ystar_u[@i_193]) && otheruses(Ystar_u[@i_193] -> @1_x_925[@i_193]) && ((@2_x = exp(g, @1_x_925[@i_193])) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@1_x_783[@i_186], @2_m[@i_186], @2_kd[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_x_783[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], exp(g, @1_x_783[@i_186]))
  orfind @i_181 <= NU suchthat defined(@1_x_925[@i_181], Ystar_u[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @1_x_925[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], exp(g, @1_x_925[@i_181]))
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_x_783: exponent;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], exp(g, @1_x_783))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_389: host = cst_host in
  let x2_388: host = cst_host in
  let x3_387: G = cst_G in
  let x4_386: G = cst_G in
  let x5_385: G = cst_G in
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], x5_385[@i_474], x4_386[@i_474], x3_387[@i_474], x2_388[@i_474], x1_389[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(Xp[@i_473], Yp[@i_473], Kp[@i_473], x5_391[@i_473], x4_392[@i_473], x3_393[@i_473], x1_395[@i_473], x2_394[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && ((x1 = x1_395[@i_473]) && ((x2 = x2_394[@i_473]) && ((x3 = Xp[@i_473]) && ((x4 = Yp[@i_473]) && (x5 = Kp[@i_473]))))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(X_s[@i_472], Y[@i_472], K_s[@i_472], x5_397[@i_472], x4_398[@i_472], x3_399[@i_472], x1_401[@i_472], x2_400[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && ((x1 = x1_401[@i_472]) && ((x2 = x2_400[@i_472]) && ((x3 = X_s[@i_472]) && ((x4 = Y[@i_472]) && (x5 = K_s[@i_472]))))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(X_s[@i_471], Y[@i_471], K_s[@i_471], x5_403[@i_471], x4_404[@i_471], x3_405[@i_471], x1_407[@i_471], x2_406[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && ((x1 = x1_407[@i_471]) && ((x2 = x2_406[@i_471]) && ((x3 = X_s[@i_471]) && ((x4 = Y[@i_471]) && (x5 = K_s[@i_471]))))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(@1_x_925[@i_470], X[@i_470], @2_r4_172[@i_470], K_u[@i_470], x5_409[@i_470], x4_410[@i_470], x3_411[@i_470], x1_413[@i_470], x2_412[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && ((x1 = x1_413[@i_470]) && ((x2 = x2_412[@i_470]) && ((x3 = X[@i_470]) && ((x4 = exp(g, @1_x_925[@i_470])) && (x5 = K_u[@i_470]))))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(@1_x_783[@i_246[@i_469]], X[@i_469], @2_r4_157[@i_246[@i_469]], K_u[@i_469], x5_415[@i_469], x4_416[@i_469], x3_417[@i_469], x1_419[@i_469], x2_418[@i_469], r_414[@i_469]) && otheruses(r_414[@i_469]) && ((x1 = x1_419[@i_469]) && ((x2 = x2_418[@i_469]) && ((x3 = X[@i_469]) && ((x4 = exp(g, @1_x_783[@i_246[@i_469]])) && (x5 = K_u[@i_469]))))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(@1_x_783[@i_246[@i_468]], X[@i_468], @2_r4_157[@i_246[@i_468]], K_u[@i_468], x5_421[@i_468], x4_422[@i_468], x3_423[@i_468], x1_425[@i_468], x2_424[@i_468], r_420[@i_468]) && otheruses(r_420[@i_468]) && ((x1 = x1_425[@i_468]) && ((x2 = x2_424[@i_468]) && ((x3 = X[@i_468]) && ((x4 = exp(g, @1_x_783[@i_246[@i_468]])) && (x5 = K_u[@i_468]))))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(@1_x_925[@i_241[@i_467]], X[@i_467], @2_r4_172[@i_241[@i_467]], K_u[@i_467], x5_427[@i_467], x4_428[@i_467], x3_429[@i_467], x1_431[@i_467], x2_430[@i_467], r_426[@i_467]) && otheruses(r_426[@i_467]) && ((x1 = x1_431[@i_467]) && ((x2 = x2_430[@i_467]) && ((x3 = X[@i_467]) && ((x4 = exp(g, @1_x_925[@i_241[@i_467]])) && (x5 = K_u[@i_467]))))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(@1_x_925[@i_241[@i_466]], X[@i_466], @2_r4_172[@i_241[@i_466]], K_u[@i_466], x5_433[@i_466], x4_434[@i_466], x3_435[@i_466], x1_437[@i_466], x2_436[@i_466], r_432[@i_466]) && otheruses(r_432[@i_466]) && ((x1 = x1_437[@i_466]) && ((x2 = x2_436[@i_466]) && ((x3 = X[@i_466]) && ((x4 = exp(g, @1_x_925[@i_241[@i_466]])) && (x5 = K_u[@i_466]))))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(X[@i_465], Yp[@i_238[@i_465]], K_u[@i_465], x5_439[@i_465], x4_440[@i_465], x3_441[@i_465], x1_443[@i_465], x2_442[@i_465], r_438[@i_465]) && otheruses(r_438[@i_465]) && ((x1 = x1_443[@i_465]) && ((x2 = x2_442[@i_465]) && ((x3 = X[@i_465]) && ((x4 = Yp[@i_238[@i_465]]) && (x5 = K_u[@i_465]))))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(X[@i_464], Yp[@i_238[@i_464]], K_u[@i_464], x5_445[@i_464], x4_446[@i_464], x3_447[@i_464], x1_449[@i_464], x2_448[@i_464], r_444[@i_464]) && otheruses(r_444[@i_464]) && ((x1 = x1_449[@i_464]) && ((x2 = x2_448[@i_464]) && ((x3 = X[@i_464]) && ((x4 = Yp[@i_238[@i_464]]) && (x5 = K_u[@i_464]))))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(X[@i_463], Y[@i_236[@i_463]], K_u[@i_463], x5_451[@i_463], x4_452[@i_463], x3_453[@i_463], x1_455[@i_463], x2_454[@i_463], r_450[@i_463]) && otheruses(r_450[@i_463]) && ((x1 = x1_455[@i_463]) && ((x2 = x2_454[@i_463]) && ((x3 = X[@i_463]) && ((x4 = Y[@i_236[@i_463]]) && (x5 = K_u[@i_463]))))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(X[@i_462], Y[@i_236[@i_462]], K_u[@i_462], x5_457[@i_462], x4_458[@i_462], x3_459[@i_462], x1_461[@i_462], x2_460[@i_462], r_456[@i_462]) && otheruses(r_456[@i_462]) && ((x1 = x1_461[@i_462]) && ((x2 = x2_460[@i_462]) && ((x3 = X[@i_462]) && ((x4 = Y[@i_236[@i_462]]) && (x5 = K_u[@i_462]))))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying SA rename K_u yields

Game 22 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@1_x_783[@i_246], @2_m[@i_246], @2_kd[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_x_783[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = exp(g, @1_x_783[@i_246]) in
    let K_u_1095: G = exp(g, mult(@1_x_783[@i_246], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_783[@i_246]) = x14[@i_120]) && (K_u_1095 = x15[@i_120]))))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      let x3_423: G = cst_G in
      let x4_422: G = cst_G in
      let x5_421: G = cst_G in
      find [unique] @i_552 <= qH0 suchthat defined(x1[@i_552], x2[@i_552], x3[@i_552], x4[@i_552], x5[@i_552], x5_385[@i_552], x4_386[@i_552], x3_387[@i_552], x2_388[@i_552], x1_389[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && ((x1_425 = x1[@i_552]) && ((x2_424 = x2[@i_552]) && ((X = x3[@i_552]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_552]) && (K_u_1095 = x5[@i_552]))))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_552]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_420);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_419: host = U in
      let x2_418: host = S in
      let x3_417: G = cst_G in
      let x4_416: G = cst_G in
      let x5_415: G = cst_G in
      find [unique] @i_539 <= qH0 suchthat defined(x1[@i_539], x2[@i_539], x3[@i_539], x4[@i_539], x5[@i_539], x5_385[@i_539], x4_386[@i_539], x3_387[@i_539], x2_388[@i_539], x1_389[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && ((x1_419 = x1[@i_539]) && ((x2_418 = x2[@i_539]) && ((X = x3[@i_539]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_539]) && (K_u_1095 = x5[@i_539]))))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_539]);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_414);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(@1_x_925[@i_241], Ystar_u[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @1_x_925[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = exp(g, @1_x_925[@i_241]) in
    let K_u_1096: G = exp(g, mult(@1_x_925[@i_241], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_925[@i_241]) = x14[@i_120]) && (K_u_1096 = x15[@i_120]))))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      let x3_435: G = cst_G in
      let x4_434: G = cst_G in
      let x5_433: G = cst_G in
      find [unique] @i_578 <= qH0 suchthat defined(x1[@i_578], x2[@i_578], x3[@i_578], x4[@i_578], x5[@i_578], x5_385[@i_578], x4_386[@i_578], x3_387[@i_578], x2_388[@i_578], x1_389[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && ((x1_437 = x1[@i_578]) && ((x2_436 = x2[@i_578]) && ((X = x3[@i_578]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_578]) && (K_u_1096 = x5[@i_578]))))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_578]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_432);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_431: host = U in
      let x2_430: host = S in
      let x3_429: G = cst_G in
      let x4_428: G = cst_G in
      let x5_427: G = cst_G in
      find [unique] @i_565 <= qH0 suchthat defined(x1[@i_565], x2[@i_565], x3[@i_565], x4[@i_565], x5[@i_565], x5_385[@i_565], x4_386[@i_565], x3_387[@i_565], x2_388[@i_565], x1_389[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && ((x1_431 = x1[@i_565]) && ((x2_430 = x2[@i_565]) && ((X = x3[@i_565]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_565]) && (K_u_1096 = x5[@i_565]))))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_565]);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_426);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u_1097: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (K_u_1097 = x15[@i_120]))))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      let x3_447: G = cst_G in
      let x4_446: G = cst_G in
      let x5_445: G = cst_G in
      find [unique] @i_604 <= qH0 suchthat defined(x1[@i_604], x2[@i_604], x3[@i_604], x4[@i_604], x5[@i_604], x5_385[@i_604], x4_386[@i_604], x3_387[@i_604], x2_388[@i_604], x1_389[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && ((x1_449 = x1[@i_604]) && ((x2_448 = x2[@i_604]) && ((X = x3[@i_604]) && ((Yp[@i_238] = x4[@i_604]) && (K_u_1097 = x5[@i_604]))))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_604]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_444);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_443: host = U in
      let x2_442: host = S in
      let x3_441: G = cst_G in
      let x4_440: G = cst_G in
      let x5_439: G = cst_G in
      find [unique] @i_591 <= qH0 suchthat defined(x1[@i_591], x2[@i_591], x3[@i_591], x4[@i_591], x5[@i_591], x5_385[@i_591], x4_386[@i_591], x3_387[@i_591], x2_388[@i_591], x1_389[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && ((x1_443 = x1[@i_591]) && ((x2_442 = x2[@i_591]) && ((X = x3[@i_591]) && ((Yp[@i_238] = x4[@i_591]) && (K_u_1097 = x5[@i_591]))))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_591]);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_438);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u_1098: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (K_u_1098 = x15[@i_120]))))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      let x3_459: G = cst_G in
      let x4_458: G = cst_G in
      let x5_457: G = cst_G in
      find [unique] @i_630 <= qH0 suchthat defined(x1[@i_630], x2[@i_630], x3[@i_630], x4[@i_630], x5[@i_630], x5_385[@i_630], x4_386[@i_630], x3_387[@i_630], x2_388[@i_630], x1_389[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && ((x1_461 = x1[@i_630]) && ((x2_460 = x2[@i_630]) && ((X = x3[@i_630]) && ((Y[@i_236] = x4[@i_630]) && (K_u_1098 = x5[@i_630]))))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_630]);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind  suchthat defined(j[@i_236], r_396[@i_236]) && otheruses(r_396[@i_236]) && (!_41 = j[@i_236]) then
      (
        let sk_u: hash0 = r_396[@i_236] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_396[@i_236]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_456);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_455: host = U in
      let x2_454: host = S in
      let x3_453: G = cst_G in
      let x4_452: G = cst_G in
      let x5_451: G = cst_G in
      find [unique] @i_617 <= qH0 suchthat defined(x1[@i_617], x2[@i_617], x3[@i_617], x4[@i_617], x5[@i_617], x5_385[@i_617], x4_386[@i_617], x3_387[@i_617], x2_388[@i_617], x1_389[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && ((x1_455 = x1[@i_617]) && ((x2_454 = x2[@i_617]) && ((X = x3[@i_617]) && ((Y[@i_236] = x4[@i_617]) && (K_u_1098 = x5[@i_617]))))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_617]);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_450);
        out(c6[!_41], r1_90)
  )
  else
    new @1_x_925: exponent;
    let @2_r4_172: G = cst_G in
    let Y_u: G = exp(g, @1_x_925) in
    let K_u_1099: G = exp(g, mult(@1_x_925, x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    let x3_411: G = cst_G in
    let x4_410: G = cst_G in
    let x5_409: G = cst_G in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      let x3_399: G = cst_G in
      let x4_398: G = cst_G in
      let x5_397: G = cst_G in
      find [unique] @i_500 <= qH0 suchthat defined(x1[@i_500], x2[@i_500], x3[@i_500], x4[@i_500], x5[@i_500], x5_385[@i_500], x4_386[@i_500], x3_387[@i_500], x2_388[@i_500], x1_389[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && ((x1_401 = x1[@i_500]) && ((x2_400 = x2[@i_500]) && ((X_s = x3[@i_500]) && ((Y = x4[@i_500]) && (K_s = x5[@i_500]))))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_500])
      )
      orfind  suchthat defined(@i_236[j], r_450[j]) && otheruses(r_450[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      orfind  suchthat defined(@i_236[j], r_456[j]) && otheruses(r_456[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_456[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_456[j])
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_396)
    )
    orfind  suchthat defined(Y_u[j], K_u_1095[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u_1095[j])) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = cst_G in
      let x4_404: G = cst_G in
      let x5_403: G = cst_G in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], x5_385[@i_513], x4_386[@i_513], x3_387[@i_513], x2_388[@i_513], x1_389[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (K_s = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
    orfind  suchthat defined(Y_u[j], K_u_1096[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u_1096[j])) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = cst_G in
      let x4_404: G = cst_G in
      let x5_403: G = cst_G in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], x5_385[@i_513], x4_386[@i_513], x3_387[@i_513], x2_388[@i_513], x1_389[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (K_s = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
    orfind  suchthat defined(Y_u[j], K_u_1097[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u_1097[j])) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = cst_G in
      let x4_404: G = cst_G in
      let x5_403: G = cst_G in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], x5_385[@i_513], x4_386[@i_513], x3_387[@i_513], x2_388[@i_513], x1_389[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (K_s = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
    orfind  suchthat defined(Y_u[j], K_u_1098[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u_1098[j])) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = cst_G in
      let x4_404: G = cst_G in
      let x5_403: G = cst_G in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], x5_385[@i_513], x4_386[@i_513], x3_387[@i_513], x2_388[@i_513], x1_389[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (K_s = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
    orfind  suchthat defined(Y_u[j], K_u_1099[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u_1099[j])) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = cst_G in
      let x4_404: G = cst_G in
      let x5_403: G = cst_G in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], x5_385[@i_513], x4_386[@i_513], x3_387[@i_513], x2_388[@i_513], x1_389[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (K_s = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@1_x_783[@i_222], @2_m[@i_222], @2_kd[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_x_783[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_783[@i_222]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(@1_x_925[@i_217], Ystar_u[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @1_x_925[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_925[@i_217]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  let x3_393: G = cst_G in
  let x4_392: G = cst_G in
  let x5_391: G = cst_G in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_x_783[@i_198], @2_r4_157[@i_198], @2_kd[@i_198], @2_m[@i_198]) && otheruses(@2_m[@i_198] -> @1_x_783[@i_198]) && ((@2_x = exp(g, @1_x_783[@i_198])) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@1_x_925[@i_193], @2_r4_172[@i_193], Ystar_u[@i_193]) && otheruses(Ystar_u[@i_193] -> @1_x_925[@i_193]) && ((@2_x = exp(g, @1_x_925[@i_193])) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@1_x_783[@i_186], @2_m[@i_186], @2_kd[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_x_783[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], exp(g, @1_x_783[@i_186]))
  orfind @i_181 <= NU suchthat defined(@1_x_925[@i_181], Ystar_u[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @1_x_925[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], exp(g, @1_x_925[@i_181]))
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_x_783: exponent;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], exp(g, @1_x_783))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_389: host = cst_host in
  let x2_388: host = cst_host in
  let x3_387: G = cst_G in
  let x4_386: G = cst_G in
  let x5_385: G = cst_G in
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], x5_385[@i_474], x4_386[@i_474], x3_387[@i_474], x2_388[@i_474], x1_389[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(Xp[@i_473], Yp[@i_473], Kp[@i_473], x5_391[@i_473], x4_392[@i_473], x3_393[@i_473], x1_395[@i_473], x2_394[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && ((x1 = x1_395[@i_473]) && ((x2 = x2_394[@i_473]) && ((x3 = Xp[@i_473]) && ((x4 = Yp[@i_473]) && (x5 = Kp[@i_473]))))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(X_s[@i_472], Y[@i_472], K_s[@i_472], x5_397[@i_472], x4_398[@i_472], x3_399[@i_472], x1_401[@i_472], x2_400[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && ((x1 = x1_401[@i_472]) && ((x2 = x2_400[@i_472]) && ((x3 = X_s[@i_472]) && ((x4 = Y[@i_472]) && (x5 = K_s[@i_472]))))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(X_s[@i_471], Y[@i_471], K_s[@i_471], x5_403[@i_471], x4_404[@i_471], x3_405[@i_471], x1_407[@i_471], x2_406[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && ((x1 = x1_407[@i_471]) && ((x2 = x2_406[@i_471]) && ((x3 = X_s[@i_471]) && ((x4 = Y[@i_471]) && (x5 = K_s[@i_471]))))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(@1_x_925[@i_470], X[@i_470], @2_r4_172[@i_470], K_u_1099[@i_470], x5_409[@i_470], x4_410[@i_470], x3_411[@i_470], x1_413[@i_470], x2_412[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && ((x1 = x1_413[@i_470]) && ((x2 = x2_412[@i_470]) && ((x3 = X[@i_470]) && ((x4 = exp(g, @1_x_925[@i_470])) && (x5 = K_u_1099[@i_470]))))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(@1_x_783[@i_246[@i_469]], X[@i_469], @2_r4_157[@i_246[@i_469]], K_u_1095[@i_469], x5_415[@i_469], x4_416[@i_469], x3_417[@i_469], x1_419[@i_469], x2_418[@i_469], r_414[@i_469]) && otheruses(r_414[@i_469]) && ((x1 = x1_419[@i_469]) && ((x2 = x2_418[@i_469]) && ((x3 = X[@i_469]) && ((x4 = exp(g, @1_x_783[@i_246[@i_469]])) && (x5 = K_u_1095[@i_469]))))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(@1_x_783[@i_246[@i_468]], X[@i_468], @2_r4_157[@i_246[@i_468]], K_u_1095[@i_468], x5_421[@i_468], x4_422[@i_468], x3_423[@i_468], x1_425[@i_468], x2_424[@i_468], r_420[@i_468]) && otheruses(r_420[@i_468]) && ((x1 = x1_425[@i_468]) && ((x2 = x2_424[@i_468]) && ((x3 = X[@i_468]) && ((x4 = exp(g, @1_x_783[@i_246[@i_468]])) && (x5 = K_u_1095[@i_468]))))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(@1_x_925[@i_241[@i_467]], X[@i_467], @2_r4_172[@i_241[@i_467]], K_u_1096[@i_467], x5_427[@i_467], x4_428[@i_467], x3_429[@i_467], x1_431[@i_467], x2_430[@i_467], r_426[@i_467]) && otheruses(r_426[@i_467]) && ((x1 = x1_431[@i_467]) && ((x2 = x2_430[@i_467]) && ((x3 = X[@i_467]) && ((x4 = exp(g, @1_x_925[@i_241[@i_467]])) && (x5 = K_u_1096[@i_467]))))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(@1_x_925[@i_241[@i_466]], X[@i_466], @2_r4_172[@i_241[@i_466]], K_u_1096[@i_466], x5_433[@i_466], x4_434[@i_466], x3_435[@i_466], x1_437[@i_466], x2_436[@i_466], r_432[@i_466]) && otheruses(r_432[@i_466]) && ((x1 = x1_437[@i_466]) && ((x2 = x2_436[@i_466]) && ((x3 = X[@i_466]) && ((x4 = exp(g, @1_x_925[@i_241[@i_466]])) && (x5 = K_u_1096[@i_466]))))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(X[@i_465], Yp[@i_238[@i_465]], K_u_1097[@i_465], x5_439[@i_465], x4_440[@i_465], x3_441[@i_465], x1_443[@i_465], x2_442[@i_465], r_438[@i_465]) && otheruses(r_438[@i_465]) && ((x1 = x1_443[@i_465]) && ((x2 = x2_442[@i_465]) && ((x3 = X[@i_465]) && ((x4 = Yp[@i_238[@i_465]]) && (x5 = K_u_1097[@i_465]))))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(X[@i_464], Yp[@i_238[@i_464]], K_u_1097[@i_464], x5_445[@i_464], x4_446[@i_464], x3_447[@i_464], x1_449[@i_464], x2_448[@i_464], r_444[@i_464]) && otheruses(r_444[@i_464]) && ((x1 = x1_449[@i_464]) && ((x2 = x2_448[@i_464]) && ((x3 = X[@i_464]) && ((x4 = Yp[@i_238[@i_464]]) && (x5 = K_u_1097[@i_464]))))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(X[@i_463], Y[@i_236[@i_463]], K_u_1098[@i_463], x5_451[@i_463], x4_452[@i_463], x3_453[@i_463], x1_455[@i_463], x2_454[@i_463], r_450[@i_463]) && otheruses(r_450[@i_463]) && ((x1 = x1_455[@i_463]) && ((x2 = x2_454[@i_463]) && ((x3 = X[@i_463]) && ((x4 = Y[@i_236[@i_463]]) && (x5 = K_u_1098[@i_463]))))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(X[@i_462], Y[@i_236[@i_462]], K_u_1098[@i_462], x5_457[@i_462], x4_458[@i_462], x3_459[@i_462], x1_461[@i_462], x2_460[@i_462], r_456[@i_462]) && otheruses(r_456[@i_462]) && ((x1 = x1_461[@i_462]) && ((x2 = x2_460[@i_462]) && ((x3 = X[@i_462]) && ((x4 = Y[@i_236[@i_462]]) && (x5 = K_u_1098[@i_462]))))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1095[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1095[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1096[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1096[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1097[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1097[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1098[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1098[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1099[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1099[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of useless yields

Game 23 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@1_x_783[@i_246], @2_m[@i_246], @2_kd[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_x_783[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = exp(g, @1_x_783[@i_246]) in
    let K_u_1095: G = exp(g, mult(@1_x_783[@i_246], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_783[@i_246]) = x14[@i_120]) && (K_u_1095 = x15[@i_120]))))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      let x3_423: G = cst_G in
      let x4_422: G = cst_G in
      let x5_421: G = cst_G in
      find [unique] @i_552 <= qH0 suchthat defined(x1[@i_552], x2[@i_552], x3[@i_552], x4[@i_552], x5[@i_552], x5_385[@i_552], x4_386[@i_552], x3_387[@i_552], x2_388[@i_552], x1_389[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && ((x1_425 = x1[@i_552]) && ((x2_424 = x2[@i_552]) && ((X = x3[@i_552]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_552]) && (K_u_1095 = x5[@i_552]))))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_552]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_420);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_419: host = U in
      let x2_418: host = S in
      let x3_417: G = cst_G in
      let x4_416: G = cst_G in
      let x5_415: G = cst_G in
      find [unique] @i_539 <= qH0 suchthat defined(x1[@i_539], x2[@i_539], x3[@i_539], x4[@i_539], x5[@i_539], x5_385[@i_539], x4_386[@i_539], x3_387[@i_539], x2_388[@i_539], x1_389[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && ((x1_419 = x1[@i_539]) && ((x2_418 = x2[@i_539]) && ((X = x3[@i_539]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_539]) && (K_u_1095 = x5[@i_539]))))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_539]);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_414);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(@1_x_925[@i_241], Ystar_u[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @1_x_925[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = exp(g, @1_x_925[@i_241]) in
    let K_u_1096: G = exp(g, mult(@1_x_925[@i_241], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_925[@i_241]) = x14[@i_120]) && (K_u_1096 = x15[@i_120]))))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      let x3_435: G = cst_G in
      let x4_434: G = cst_G in
      let x5_433: G = cst_G in
      find [unique] @i_578 <= qH0 suchthat defined(x1[@i_578], x2[@i_578], x3[@i_578], x4[@i_578], x5[@i_578], x5_385[@i_578], x4_386[@i_578], x3_387[@i_578], x2_388[@i_578], x1_389[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && ((x1_437 = x1[@i_578]) && ((x2_436 = x2[@i_578]) && ((X = x3[@i_578]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_578]) && (K_u_1096 = x5[@i_578]))))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_578]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_432);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_431: host = U in
      let x2_430: host = S in
      let x3_429: G = cst_G in
      let x4_428: G = cst_G in
      let x5_427: G = cst_G in
      find [unique] @i_565 <= qH0 suchthat defined(x1[@i_565], x2[@i_565], x3[@i_565], x4[@i_565], x5[@i_565], x5_385[@i_565], x4_386[@i_565], x3_387[@i_565], x2_388[@i_565], x1_389[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && ((x1_431 = x1[@i_565]) && ((x2_430 = x2[@i_565]) && ((X = x3[@i_565]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_565]) && (K_u_1096 = x5[@i_565]))))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_565]);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_426);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u_1097: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (K_u_1097 = x15[@i_120]))))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      let x3_447: G = cst_G in
      let x4_446: G = cst_G in
      let x5_445: G = cst_G in
      find [unique] @i_604 <= qH0 suchthat defined(x1[@i_604], x2[@i_604], x3[@i_604], x4[@i_604], x5[@i_604], x5_385[@i_604], x4_386[@i_604], x3_387[@i_604], x2_388[@i_604], x1_389[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && ((x1_449 = x1[@i_604]) && ((x2_448 = x2[@i_604]) && ((X = x3[@i_604]) && ((Yp[@i_238] = x4[@i_604]) && (K_u_1097 = x5[@i_604]))))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_604]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_444);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_443: host = U in
      let x2_442: host = S in
      let x3_441: G = cst_G in
      let x4_440: G = cst_G in
      let x5_439: G = cst_G in
      find [unique] @i_591 <= qH0 suchthat defined(x1[@i_591], x2[@i_591], x3[@i_591], x4[@i_591], x5[@i_591], x5_385[@i_591], x4_386[@i_591], x3_387[@i_591], x2_388[@i_591], x1_389[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && ((x1_443 = x1[@i_591]) && ((x2_442 = x2[@i_591]) && ((X = x3[@i_591]) && ((Yp[@i_238] = x4[@i_591]) && (K_u_1097 = x5[@i_591]))))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_591]);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_438);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u_1098: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (K_u_1098 = x15[@i_120]))))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      let x3_459: G = cst_G in
      let x4_458: G = cst_G in
      let x5_457: G = cst_G in
      find [unique] @i_630 <= qH0 suchthat defined(x1[@i_630], x2[@i_630], x3[@i_630], x4[@i_630], x5[@i_630], x5_385[@i_630], x4_386[@i_630], x3_387[@i_630], x2_388[@i_630], x1_389[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && ((x1_461 = x1[@i_630]) && ((x2_460 = x2[@i_630]) && ((X = x3[@i_630]) && ((Y[@i_236] = x4[@i_630]) && (K_u_1098 = x5[@i_630]))))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_630]);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind  suchthat defined(j[@i_236], r_396[@i_236]) && otheruses(r_396[@i_236]) && (!_41 = j[@i_236]) then
      (
        let sk_u: hash0 = r_396[@i_236] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_396[@i_236]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_456);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_455: host = U in
      let x2_454: host = S in
      let x3_453: G = cst_G in
      let x4_452: G = cst_G in
      let x5_451: G = cst_G in
      find [unique] @i_617 <= qH0 suchthat defined(x1[@i_617], x2[@i_617], x3[@i_617], x4[@i_617], x5[@i_617], x5_385[@i_617], x4_386[@i_617], x3_387[@i_617], x2_388[@i_617], x1_389[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && ((x1_455 = x1[@i_617]) && ((x2_454 = x2[@i_617]) && ((X = x3[@i_617]) && ((Y[@i_236] = x4[@i_617]) && (K_u_1098 = x5[@i_617]))))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_617]);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_450);
        out(c6[!_41], r1_90)
  )
  else
    new @1_x_925: exponent;
    let @2_r4_172: G = cst_G in
    let Y_u: G = exp(g, @1_x_925) in
    let K_u_1099: G = exp(g, mult(@1_x_925, x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    let x3_411: G = cst_G in
    let x4_410: G = cst_G in
    let x5_409: G = cst_G in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      let x3_399: G = cst_G in
      let x4_398: G = cst_G in
      let x5_397: G = cst_G in
      find [unique] @i_500 <= qH0 suchthat defined(x1[@i_500], x2[@i_500], x3[@i_500], x4[@i_500], x5[@i_500], x5_385[@i_500], x4_386[@i_500], x3_387[@i_500], x2_388[@i_500], x1_389[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && ((x1_401 = x1[@i_500]) && ((x2_400 = x2[@i_500]) && ((X_s = x3[@i_500]) && ((Y = x4[@i_500]) && (K_s = x5[@i_500]))))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_500])
      )
      orfind  suchthat defined(@i_236[j], r_450[j]) && otheruses(r_450[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      orfind  suchthat defined(@i_236[j], r_456[j]) && otheruses(r_456[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_456[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_456[j])
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_396)
    )
    orfind  suchthat defined(Y_u[j], K_u_1095[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u_1095[j])) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = cst_G in
      let x4_404: G = cst_G in
      let x5_403: G = cst_G in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], x5_385[@i_513], x4_386[@i_513], x3_387[@i_513], x2_388[@i_513], x1_389[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (K_s = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
    orfind  suchthat defined(Y_u[j], K_u_1096[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u_1096[j])) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = cst_G in
      let x4_404: G = cst_G in
      let x5_403: G = cst_G in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], x5_385[@i_513], x4_386[@i_513], x3_387[@i_513], x2_388[@i_513], x1_389[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (K_s = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
    orfind  suchthat defined(Y_u[j], K_u_1097[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u_1097[j])) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = cst_G in
      let x4_404: G = cst_G in
      let x5_403: G = cst_G in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], x5_385[@i_513], x4_386[@i_513], x3_387[@i_513], x2_388[@i_513], x1_389[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (K_s = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
    orfind  suchthat defined(Y_u[j], K_u_1098[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u_1098[j])) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = cst_G in
      let x4_404: G = cst_G in
      let x5_403: G = cst_G in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], x5_385[@i_513], x4_386[@i_513], x3_387[@i_513], x2_388[@i_513], x1_389[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (K_s = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
    orfind  suchthat defined(Y_u[j], K_u_1099[j], r1_90[j]) && otheruses(r1_90[j]) && ((Y = Y_u[j]) && (K_s = K_u_1099[j])) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = cst_G in
      let x4_404: G = cst_G in
      let x5_403: G = cst_G in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], x5_385[@i_513], x4_386[@i_513], x3_387[@i_513], x2_388[@i_513], x1_389[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (K_s = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@1_x_783[@i_222], @2_m[@i_222], @2_kd[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_x_783[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_783[@i_222]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(@1_x_925[@i_217], Ystar_u[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @1_x_925[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_925[@i_217]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  let x3_393: G = cst_G in
  let x4_392: G = cst_G in
  let x5_391: G = cst_G in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_x_783[@i_198], @2_r4_157[@i_198], @2_kd[@i_198], @2_m[@i_198]) && otheruses(@2_m[@i_198] -> @1_x_783[@i_198]) && ((@2_x = exp(g, @1_x_783[@i_198])) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@1_x_925[@i_193], @2_r4_172[@i_193], Ystar_u[@i_193]) && otheruses(Ystar_u[@i_193] -> @1_x_925[@i_193]) && ((@2_x = exp(g, @1_x_925[@i_193])) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@1_x_783[@i_186], @2_m[@i_186], @2_kd[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_x_783[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], exp(g, @1_x_783[@i_186]))
  orfind @i_181 <= NU suchthat defined(@1_x_925[@i_181], Ystar_u[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @1_x_925[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], exp(g, @1_x_925[@i_181]))
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_x_783: exponent;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], exp(g, @1_x_783))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_389: host = cst_host in
  let x2_388: host = cst_host in
  let x3_387: G = cst_G in
  let x4_386: G = cst_G in
  let x5_385: G = cst_G in
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], x5_385[@i_474], x4_386[@i_474], x3_387[@i_474], x2_388[@i_474], x1_389[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(Xp[@i_473], Yp[@i_473], Kp[@i_473], x5_391[@i_473], x4_392[@i_473], x3_393[@i_473], x1_395[@i_473], x2_394[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && ((x1 = x1_395[@i_473]) && ((x2 = x2_394[@i_473]) && ((x3 = Xp[@i_473]) && ((x4 = Yp[@i_473]) && (x5 = Kp[@i_473]))))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(X_s[@i_472], Y[@i_472], K_s[@i_472], x5_397[@i_472], x4_398[@i_472], x3_399[@i_472], x1_401[@i_472], x2_400[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && ((x1 = x1_401[@i_472]) && ((x2 = x2_400[@i_472]) && ((x3 = X_s[@i_472]) && ((x4 = Y[@i_472]) && (x5 = K_s[@i_472]))))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(X_s[@i_471], Y[@i_471], K_s[@i_471], x5_403[@i_471], x4_404[@i_471], x3_405[@i_471], x1_407[@i_471], x2_406[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && ((x1 = x1_407[@i_471]) && ((x2 = x2_406[@i_471]) && ((x3 = X_s[@i_471]) && ((x4 = Y[@i_471]) && (x5 = K_s[@i_471]))))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(@1_x_925[@i_470], X[@i_470], @2_r4_172[@i_470], K_u_1099[@i_470], x5_409[@i_470], x4_410[@i_470], x3_411[@i_470], x1_413[@i_470], x2_412[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && ((x1 = x1_413[@i_470]) && ((x2 = x2_412[@i_470]) && ((x3 = X[@i_470]) && ((x4 = exp(g, @1_x_925[@i_470])) && (x5 = K_u_1099[@i_470]))))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(@1_x_783[@i_246[@i_469]], X[@i_469], @2_r4_157[@i_246[@i_469]], K_u_1095[@i_469], x5_415[@i_469], x4_416[@i_469], x3_417[@i_469], x1_419[@i_469], x2_418[@i_469], r_414[@i_469]) && otheruses(r_414[@i_469]) && ((x1 = x1_419[@i_469]) && ((x2 = x2_418[@i_469]) && ((x3 = X[@i_469]) && ((x4 = exp(g, @1_x_783[@i_246[@i_469]])) && (x5 = K_u_1095[@i_469]))))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(@1_x_783[@i_246[@i_468]], X[@i_468], @2_r4_157[@i_246[@i_468]], K_u_1095[@i_468], x5_421[@i_468], x4_422[@i_468], x3_423[@i_468], x1_425[@i_468], x2_424[@i_468], r_420[@i_468]) && otheruses(r_420[@i_468]) && ((x1 = x1_425[@i_468]) && ((x2 = x2_424[@i_468]) && ((x3 = X[@i_468]) && ((x4 = exp(g, @1_x_783[@i_246[@i_468]])) && (x5 = K_u_1095[@i_468]))))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(@1_x_925[@i_241[@i_467]], X[@i_467], @2_r4_172[@i_241[@i_467]], K_u_1096[@i_467], x5_427[@i_467], x4_428[@i_467], x3_429[@i_467], x1_431[@i_467], x2_430[@i_467], r_426[@i_467]) && otheruses(r_426[@i_467]) && ((x1 = x1_431[@i_467]) && ((x2 = x2_430[@i_467]) && ((x3 = X[@i_467]) && ((x4 = exp(g, @1_x_925[@i_241[@i_467]])) && (x5 = K_u_1096[@i_467]))))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(@1_x_925[@i_241[@i_466]], X[@i_466], @2_r4_172[@i_241[@i_466]], K_u_1096[@i_466], x5_433[@i_466], x4_434[@i_466], x3_435[@i_466], x1_437[@i_466], x2_436[@i_466], r_432[@i_466]) && otheruses(r_432[@i_466]) && ((x1 = x1_437[@i_466]) && ((x2 = x2_436[@i_466]) && ((x3 = X[@i_466]) && ((x4 = exp(g, @1_x_925[@i_241[@i_466]])) && (x5 = K_u_1096[@i_466]))))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(X[@i_465], Yp[@i_238[@i_465]], K_u_1097[@i_465], x5_439[@i_465], x4_440[@i_465], x3_441[@i_465], x1_443[@i_465], x2_442[@i_465], r_438[@i_465]) && otheruses(r_438[@i_465]) && ((x1 = x1_443[@i_465]) && ((x2 = x2_442[@i_465]) && ((x3 = X[@i_465]) && ((x4 = Yp[@i_238[@i_465]]) && (x5 = K_u_1097[@i_465]))))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(X[@i_464], Yp[@i_238[@i_464]], K_u_1097[@i_464], x5_445[@i_464], x4_446[@i_464], x3_447[@i_464], x1_449[@i_464], x2_448[@i_464], r_444[@i_464]) && otheruses(r_444[@i_464]) && ((x1 = x1_449[@i_464]) && ((x2 = x2_448[@i_464]) && ((x3 = X[@i_464]) && ((x4 = Yp[@i_238[@i_464]]) && (x5 = K_u_1097[@i_464]))))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(X[@i_463], Y[@i_236[@i_463]], K_u_1098[@i_463], x5_451[@i_463], x4_452[@i_463], x3_453[@i_463], x1_455[@i_463], x2_454[@i_463], r_450[@i_463]) && otheruses(r_450[@i_463]) && ((x1 = x1_455[@i_463]) && ((x2 = x2_454[@i_463]) && ((x3 = X[@i_463]) && ((x4 = Y[@i_236[@i_463]]) && (x5 = K_u_1098[@i_463]))))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(X[@i_462], Y[@i_236[@i_462]], K_u_1098[@i_462], x5_457[@i_462], x4_458[@i_462], x3_459[@i_462], x1_461[@i_462], x2_460[@i_462], r_456[@i_462]) && otheruses(r_456[@i_462]) && ((x1 = x1_461[@i_462]) && ((x2 = x2_460[@i_462]) && ((x3 = X[@i_462]) && ((x4 = Y[@i_236[@i_462]]) && (x5 = K_u_1098[@i_462]))))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1095[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1095[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1096[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1096[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1097[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1097[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1098[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1098[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1099[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1099[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying simplify [Excluding set(dist 23->24, proba <= 4. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|)] yields

Game 24 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_x_783[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_x_783[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = exp(g, @1_x_783[@i_246]) in
    let K_u_1095: G = exp(g, mult(@1_x_783[@i_246], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_783[@i_246]) = x14[@i_120]) && (K_u_1095 = x15[@i_120]))))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      let x3_423: G = cst_G in
      let x4_422: G = cst_G in
      let x5_421: G = cst_G in
      find [unique] @i_552 <= qH0 suchthat defined(x1[@i_552], x2[@i_552], x3[@i_552], x4[@i_552], x5[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && ((x1_425 = x1[@i_552]) && ((x2_424 = x2[@i_552]) && ((X = x3[@i_552]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_552]) && (K_u_1095 = x5[@i_552]))))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_552]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_420);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_419: host = U in
      let x2_418: host = S in
      let x3_417: G = cst_G in
      let x4_416: G = cst_G in
      let x5_415: G = cst_G in
      find [unique] @i_539 <= qH0 suchthat defined(x1[@i_539], x2[@i_539], x3[@i_539], x4[@i_539], x5[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && ((x1_419 = x1[@i_539]) && ((x2_418 = x2[@i_539]) && ((X = x3[@i_539]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_539]) && (K_u_1095 = x5[@i_539]))))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_539]);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_414);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @1_x_925[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @1_x_925[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = exp(g, @1_x_925[@i_241]) in
    let K_u_1096: G = exp(g, mult(@1_x_925[@i_241], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_925[@i_241]) = x14[@i_120]) && (K_u_1096 = x15[@i_120]))))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      let x3_435: G = cst_G in
      let x4_434: G = cst_G in
      let x5_433: G = cst_G in
      find [unique] @i_578 <= qH0 suchthat defined(x1[@i_578], x2[@i_578], x3[@i_578], x4[@i_578], x5[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && ((x1_437 = x1[@i_578]) && ((x2_436 = x2[@i_578]) && ((X = x3[@i_578]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_578]) && (K_u_1096 = x5[@i_578]))))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_578]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_432);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_431: host = U in
      let x2_430: host = S in
      let x3_429: G = cst_G in
      let x4_428: G = cst_G in
      let x5_427: G = cst_G in
      find [unique] @i_565 <= qH0 suchthat defined(x1[@i_565], x2[@i_565], x3[@i_565], x4[@i_565], x5[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && ((x1_431 = x1[@i_565]) && ((x2_430 = x2[@i_565]) && ((X = x3[@i_565]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_565]) && (K_u_1096 = x5[@i_565]))))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_565]);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_426);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u_1097: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (K_u_1097 = x15[@i_120]))))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      let x3_447: G = cst_G in
      let x4_446: G = cst_G in
      let x5_445: G = cst_G in
      find [unique] @i_604 <= qH0 suchthat defined(x1[@i_604], x2[@i_604], x3[@i_604], x4[@i_604], x5[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && ((x1_449 = x1[@i_604]) && ((x2_448 = x2[@i_604]) && ((X = x3[@i_604]) && ((Yp[@i_238] = x4[@i_604]) && (K_u_1097 = x5[@i_604]))))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_604]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_444);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_443: host = U in
      let x2_442: host = S in
      let x3_441: G = cst_G in
      let x4_440: G = cst_G in
      let x5_439: G = cst_G in
      find [unique] @i_591 <= qH0 suchthat defined(x1[@i_591], x2[@i_591], x3[@i_591], x4[@i_591], x5[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && ((x1_443 = x1[@i_591]) && ((x2_442 = x2[@i_591]) && ((X = x3[@i_591]) && ((Yp[@i_238] = x4[@i_591]) && (K_u_1097 = x5[@i_591]))))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_591]);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_438);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u_1098: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (K_u_1098 = x15[@i_120]))))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      let x3_459: G = cst_G in
      let x4_458: G = cst_G in
      let x5_457: G = cst_G in
      find [unique] @i_630 <= qH0 suchthat defined(x1[@i_630], x2[@i_630], x3[@i_630], x4[@i_630], x5[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && ((x1_461 = x1[@i_630]) && ((x2_460 = x2[@i_630]) && ((X = x3[@i_630]) && ((Y[@i_236] = x4[@i_630]) && (K_u_1098 = x5[@i_630]))))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_630]);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind  suchthat defined(j[@i_236], r_396[@i_236]) && otheruses(r_396[@i_236]) && (!_41 = j[@i_236]) then
      (
        let sk_u: hash0 = r_396[@i_236] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_396[@i_236]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_456);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_455: host = U in
      let x2_454: host = S in
      let x3_453: G = cst_G in
      let x4_452: G = cst_G in
      let x5_451: G = cst_G in
      find [unique] @i_617 <= qH0 suchthat defined(x1[@i_617], x2[@i_617], x3[@i_617], x4[@i_617], x5[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && ((x1_455 = x1[@i_617]) && ((x2_454 = x2[@i_617]) && ((X = x3[@i_617]) && ((Y[@i_236] = x4[@i_617]) && (K_u_1098 = x5[@i_617]))))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_617]);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_450);
        out(c6[!_41], r1_90)
  )
  else
    new @1_x_925: exponent;
    let @2_r4_172: G = cst_G in
    let Y_u: G = exp(g, @1_x_925) in
    let K_u_1099: G = exp(g, mult(@1_x_925, x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    let x3_411: G = cst_G in
    let x4_410: G = cst_G in
    let x5_409: G = cst_G in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = exp(g, mult(x[j], y)) in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (K_s = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      let x3_399: G = cst_G in
      let x4_398: G = cst_G in
      let x5_397: G = cst_G in
      find [unique] @i_500 <= qH0 suchthat defined(x1[@i_500], x2[@i_500], x3[@i_500], x4[@i_500], x5[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && ((x1_401 = x1[@i_500]) && ((x2_400 = x2[@i_500]) && ((X_s = x3[@i_500]) && ((Y = x4[@i_500]) && (K_s = x5[@i_500]))))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_500])
      )
      orfind  suchthat defined(@i_236[j], r_450[j]) && otheruses(r_450[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      orfind  suchthat defined(@i_236[j], r_456[j]) && otheruses(r_456[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_456[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_456[j])
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_396)
    )
    orfind  suchthat defined(@i_236[j], r1_90[j], K_u_1098[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      let x3_405: G = cst_G in
      let x4_404: G = cst_G in
      let x5_403: G = cst_G in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (K_s = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_x_783[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_x_783[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_783[@i_222]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @1_x_925[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @1_x_925[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_925[@i_217]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  let x3_393: G = cst_G in
  let x4_392: G = cst_G in
  let x5_391: G = cst_G in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_x_783[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_x_783[@i_198]) && ((@2_x = exp(g, @1_x_783[@i_198])) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@1_x_925[@i_193], Ystar_u[@i_193], @2_r4_172[@i_193]) && otheruses(Ystar_u[@i_193] -> @1_x_925[@i_193]) && ((@2_x = exp(g, @1_x_925[@i_193])) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_x_783[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_x_783[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], exp(g, @1_x_783[@i_186]))
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @1_x_925[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @1_x_925[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], exp(g, @1_x_925[@i_181]))
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_x_783: exponent;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], exp(g, @1_x_783))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  let x1_389: host = cst_host in
  let x2_388: host = cst_host in
  let x3_387: G = cst_G in
  let x4_386: G = cst_G in
  let x5_385: G = cst_G in
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(x1_395[@i_473], x2_394[@i_473], Xp[@i_473], Yp[@i_473], Kp[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && ((x1 = x1_395[@i_473]) && ((x2 = x2_394[@i_473]) && ((x3 = Xp[@i_473]) && ((x4 = Yp[@i_473]) && (x5 = Kp[@i_473]))))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(x1_401[@i_472], x2_400[@i_472], X_s[@i_472], Y[@i_472], K_s[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && ((x1 = x1_401[@i_472]) && ((x2 = x2_400[@i_472]) && ((x3 = X_s[@i_472]) && ((x4 = Y[@i_472]) && (x5 = K_s[@i_472]))))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(x1_407[@i_471], x2_406[@i_471], X_s[@i_471], Y[@i_471], K_s[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && ((x1 = x1_407[@i_471]) && ((x2 = x2_406[@i_471]) && ((x3 = X_s[@i_471]) && ((x4 = Y[@i_471]) && (x5 = K_s[@i_471]))))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(x1_413[@i_470], x2_412[@i_470], X[@i_470], @1_x_925[@i_470], K_u_1099[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && ((x1 = x1_413[@i_470]) && ((x2 = x2_412[@i_470]) && ((x3 = X[@i_470]) && ((x4 = exp(g, @1_x_925[@i_470])) && (x5 = K_u_1099[@i_470]))))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(x1_419[@i_469], x2_418[@i_469], X[@i_469], @1_x_783[@i_246[@i_469]], K_u_1095[@i_469], r_414[@i_469]) && otheruses(r_414[@i_469]) && ((x1 = x1_419[@i_469]) && ((x2 = x2_418[@i_469]) && ((x3 = X[@i_469]) && ((x4 = exp(g, @1_x_783[@i_246[@i_469]])) && (x5 = K_u_1095[@i_469]))))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(x1_425[@i_468], x2_424[@i_468], X[@i_468], @1_x_783[@i_246[@i_468]], K_u_1095[@i_468], r_420[@i_468]) && otheruses(r_420[@i_468]) && ((x1 = x1_425[@i_468]) && ((x2 = x2_424[@i_468]) && ((x3 = X[@i_468]) && ((x4 = exp(g, @1_x_783[@i_246[@i_468]])) && (x5 = K_u_1095[@i_468]))))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(x1_431[@i_467], x2_430[@i_467], X[@i_467], @1_x_925[@i_241[@i_467]], K_u_1096[@i_467], r_426[@i_467]) && otheruses(r_426[@i_467]) && ((x1 = x1_431[@i_467]) && ((x2 = x2_430[@i_467]) && ((x3 = X[@i_467]) && ((x4 = exp(g, @1_x_925[@i_241[@i_467]])) && (x5 = K_u_1096[@i_467]))))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(x1_437[@i_466], x2_436[@i_466], X[@i_466], @1_x_925[@i_241[@i_466]], K_u_1096[@i_466], r_432[@i_466]) && otheruses(r_432[@i_466]) && ((x1 = x1_437[@i_466]) && ((x2 = x2_436[@i_466]) && ((x3 = X[@i_466]) && ((x4 = exp(g, @1_x_925[@i_241[@i_466]])) && (x5 = K_u_1096[@i_466]))))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(x1_443[@i_465], x2_442[@i_465], X[@i_465], Yp[@i_238[@i_465]], K_u_1097[@i_465], r_438[@i_465]) && otheruses(r_438[@i_465]) && ((x1 = x1_443[@i_465]) && ((x2 = x2_442[@i_465]) && ((x3 = X[@i_465]) && ((x4 = Yp[@i_238[@i_465]]) && (x5 = K_u_1097[@i_465]))))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(x1_449[@i_464], x2_448[@i_464], X[@i_464], Yp[@i_238[@i_464]], K_u_1097[@i_464], r_444[@i_464]) && otheruses(r_444[@i_464]) && ((x1 = x1_449[@i_464]) && ((x2 = x2_448[@i_464]) && ((x3 = X[@i_464]) && ((x4 = Yp[@i_238[@i_464]]) && (x5 = K_u_1097[@i_464]))))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(x1_455[@i_463], x2_454[@i_463], X[@i_463], Y[@i_236[@i_463]], K_u_1098[@i_463], r_450[@i_463]) && otheruses(r_450[@i_463]) && ((x1 = x1_455[@i_463]) && ((x2 = x2_454[@i_463]) && ((x3 = X[@i_463]) && ((x4 = Y[@i_236[@i_463]]) && (x5 = K_u_1098[@i_463]))))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(x1_461[@i_462], x2_460[@i_462], X[@i_462], Y[@i_236[@i_462]], K_u_1098[@i_462], r_456[@i_462]) && otheruses(r_456[@i_462]) && ((x1 = x1_461[@i_462]) && ((x2 = x2_460[@i_462]) && ((x3 = X[@i_462]) && ((x4 = Y[@i_236[@i_462]]) && (x5 = K_u_1098[@i_462]))))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1095[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1095[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1096[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1096[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1097[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1097[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1098[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1098[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1099[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1099[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of binder K_s yields

Game 25 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_x_783[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_x_783[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = exp(g, @1_x_783[@i_246]) in
    let K_u_1095: G = exp(g, mult(@1_x_783[@i_246], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_783[@i_246]) = x14[@i_120]) && (K_u_1095 = x15[@i_120]))))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      find [unique] @i_552 <= qH0 suchthat defined(x1[@i_552], x2[@i_552], x3[@i_552], x4[@i_552], x5[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && ((x1_425 = x1[@i_552]) && ((x2_424 = x2[@i_552]) && ((X = x3[@i_552]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_552]) && (K_u_1095 = x5[@i_552]))))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_552]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_420);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_419: host = U in
      let x2_418: host = S in
      find [unique] @i_539 <= qH0 suchthat defined(x1[@i_539], x2[@i_539], x3[@i_539], x4[@i_539], x5[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && ((x1_419 = x1[@i_539]) && ((x2_418 = x2[@i_539]) && ((X = x3[@i_539]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_539]) && (K_u_1095 = x5[@i_539]))))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_539]);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_414);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @1_x_925[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @1_x_925[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = exp(g, @1_x_925[@i_241]) in
    let K_u_1096: G = exp(g, mult(@1_x_925[@i_241], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_925[@i_241]) = x14[@i_120]) && (K_u_1096 = x15[@i_120]))))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      find [unique] @i_578 <= qH0 suchthat defined(x1[@i_578], x2[@i_578], x3[@i_578], x4[@i_578], x5[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && ((x1_437 = x1[@i_578]) && ((x2_436 = x2[@i_578]) && ((X = x3[@i_578]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_578]) && (K_u_1096 = x5[@i_578]))))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_578]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_432);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_431: host = U in
      let x2_430: host = S in
      find [unique] @i_565 <= qH0 suchthat defined(x1[@i_565], x2[@i_565], x3[@i_565], x4[@i_565], x5[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && ((x1_431 = x1[@i_565]) && ((x2_430 = x2[@i_565]) && ((X = x3[@i_565]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_565]) && (K_u_1096 = x5[@i_565]))))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_565]);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_426);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u_1097: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (K_u_1097 = x15[@i_120]))))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      find [unique] @i_604 <= qH0 suchthat defined(x1[@i_604], x2[@i_604], x3[@i_604], x4[@i_604], x5[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && ((x1_449 = x1[@i_604]) && ((x2_448 = x2[@i_604]) && ((X = x3[@i_604]) && ((Yp[@i_238] = x4[@i_604]) && (K_u_1097 = x5[@i_604]))))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_604]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_444);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_443: host = U in
      let x2_442: host = S in
      find [unique] @i_591 <= qH0 suchthat defined(x1[@i_591], x2[@i_591], x3[@i_591], x4[@i_591], x5[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && ((x1_443 = x1[@i_591]) && ((x2_442 = x2[@i_591]) && ((X = x3[@i_591]) && ((Yp[@i_238] = x4[@i_591]) && (K_u_1097 = x5[@i_591]))))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_591]);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_438);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u_1098: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (K_u_1098 = x15[@i_120]))))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      find [unique] @i_630 <= qH0 suchthat defined(x1[@i_630], x2[@i_630], x3[@i_630], x4[@i_630], x5[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && ((x1_461 = x1[@i_630]) && ((x2_460 = x2[@i_630]) && ((X = x3[@i_630]) && ((Y[@i_236] = x4[@i_630]) && (K_u_1098 = x5[@i_630]))))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_630]);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind  suchthat defined(j[@i_236], r_396[@i_236]) && otheruses(r_396[@i_236]) && (!_41 = j[@i_236]) then
      (
        let sk_u: hash0 = r_396[@i_236] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_396[@i_236]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_456);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_455: host = U in
      let x2_454: host = S in
      find [unique] @i_617 <= qH0 suchthat defined(x1[@i_617], x2[@i_617], x3[@i_617], x4[@i_617], x5[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && ((x1_455 = x1[@i_617]) && ((x2_454 = x2[@i_617]) && ((X = x3[@i_617]) && ((Y[@i_236] = x4[@i_617]) && (K_u_1098 = x5[@i_617]))))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_617]);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_450);
        out(c6[!_41], r1_90)
  )
  else
    new @1_x_925: exponent;
    let @2_r4_172: G = cst_G in
    let Y_u: G = exp(g, @1_x_925) in
    let K_u_1099: G = exp(g, mult(@1_x_925, x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (exp(g, mult(x[j], y)) = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      find [unique] @i_500 <= qH0 suchthat defined(x1[@i_500], x2[@i_500], x3[@i_500], x4[@i_500], x5[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && ((x1_401 = x1[@i_500]) && ((x2_400 = x2[@i_500]) && ((X_s = x3[@i_500]) && ((Y = x4[@i_500]) && (exp(g, mult(x[j], y)) = x5[@i_500]))))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_500])
      )
      orfind  suchthat defined(@i_236[j], r_450[j]) && otheruses(r_450[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      orfind  suchthat defined(@i_236[j], r_456[j]) && otheruses(r_456[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_456[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_456[j])
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_396)
    )
    orfind  suchthat defined(@i_236[j], r1_90[j], K_u_1098[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (exp(g, mult(x[j], y)) = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_x_783[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_x_783[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_783[@i_222]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @1_x_925[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @1_x_925[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_925[@i_217]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_x_783[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_x_783[@i_198]) && ((@2_x = exp(g, @1_x_783[@i_198])) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@1_x_925[@i_193], Ystar_u[@i_193], @2_r4_172[@i_193]) && otheruses(Ystar_u[@i_193] -> @1_x_925[@i_193]) && ((@2_x = exp(g, @1_x_925[@i_193])) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_x_783[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_x_783[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], exp(g, @1_x_783[@i_186]))
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @1_x_925[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @1_x_925[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], exp(g, @1_x_925[@i_181]))
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_x_783: exponent;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], exp(g, @1_x_783))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(x1_395[@i_473], x2_394[@i_473], Xp[@i_473], Yp[@i_473], Kp[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && ((x1 = x1_395[@i_473]) && ((x2 = x2_394[@i_473]) && ((x3 = Xp[@i_473]) && ((x4 = Yp[@i_473]) && (x5 = Kp[@i_473]))))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(y[@i_472], x[j[@i_472]], K_s[@i_472], x1_401[@i_472], x2_400[@i_472], X_s[@i_472], Y[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && ((x1 = x1_401[@i_472]) && ((x2 = x2_400[@i_472]) && ((x3 = X_s[@i_472]) && ((x4 = Y[@i_472]) && (x5 = exp(g, mult(x[j[@i_472]], y[@i_472]))))))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(y[@i_471], x[j[@i_471]], K_s[@i_471], x1_407[@i_471], x2_406[@i_471], X_s[@i_471], Y[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && ((x1 = x1_407[@i_471]) && ((x2 = x2_406[@i_471]) && ((x3 = X_s[@i_471]) && ((x4 = Y[@i_471]) && (x5 = exp(g, mult(x[j[@i_471]], y[@i_471]))))))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(x1_413[@i_470], x2_412[@i_470], X[@i_470], @1_x_925[@i_470], K_u_1099[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && ((x1 = x1_413[@i_470]) && ((x2 = x2_412[@i_470]) && ((x3 = X[@i_470]) && ((x4 = exp(g, @1_x_925[@i_470])) && (x5 = K_u_1099[@i_470]))))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(x1_419[@i_469], x2_418[@i_469], X[@i_469], @1_x_783[@i_246[@i_469]], K_u_1095[@i_469], r_414[@i_469]) && otheruses(r_414[@i_469]) && ((x1 = x1_419[@i_469]) && ((x2 = x2_418[@i_469]) && ((x3 = X[@i_469]) && ((x4 = exp(g, @1_x_783[@i_246[@i_469]])) && (x5 = K_u_1095[@i_469]))))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(x1_425[@i_468], x2_424[@i_468], X[@i_468], @1_x_783[@i_246[@i_468]], K_u_1095[@i_468], r_420[@i_468]) && otheruses(r_420[@i_468]) && ((x1 = x1_425[@i_468]) && ((x2 = x2_424[@i_468]) && ((x3 = X[@i_468]) && ((x4 = exp(g, @1_x_783[@i_246[@i_468]])) && (x5 = K_u_1095[@i_468]))))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(x1_431[@i_467], x2_430[@i_467], X[@i_467], @1_x_925[@i_241[@i_467]], K_u_1096[@i_467], r_426[@i_467]) && otheruses(r_426[@i_467]) && ((x1 = x1_431[@i_467]) && ((x2 = x2_430[@i_467]) && ((x3 = X[@i_467]) && ((x4 = exp(g, @1_x_925[@i_241[@i_467]])) && (x5 = K_u_1096[@i_467]))))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(x1_437[@i_466], x2_436[@i_466], X[@i_466], @1_x_925[@i_241[@i_466]], K_u_1096[@i_466], r_432[@i_466]) && otheruses(r_432[@i_466]) && ((x1 = x1_437[@i_466]) && ((x2 = x2_436[@i_466]) && ((x3 = X[@i_466]) && ((x4 = exp(g, @1_x_925[@i_241[@i_466]])) && (x5 = K_u_1096[@i_466]))))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(x1_443[@i_465], x2_442[@i_465], X[@i_465], Yp[@i_238[@i_465]], K_u_1097[@i_465], r_438[@i_465]) && otheruses(r_438[@i_465]) && ((x1 = x1_443[@i_465]) && ((x2 = x2_442[@i_465]) && ((x3 = X[@i_465]) && ((x4 = Yp[@i_238[@i_465]]) && (x5 = K_u_1097[@i_465]))))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(x1_449[@i_464], x2_448[@i_464], X[@i_464], Yp[@i_238[@i_464]], K_u_1097[@i_464], r_444[@i_464]) && otheruses(r_444[@i_464]) && ((x1 = x1_449[@i_464]) && ((x2 = x2_448[@i_464]) && ((x3 = X[@i_464]) && ((x4 = Yp[@i_238[@i_464]]) && (x5 = K_u_1097[@i_464]))))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(x1_455[@i_463], x2_454[@i_463], X[@i_463], Y[@i_236[@i_463]], K_u_1098[@i_463], r_450[@i_463]) && otheruses(r_450[@i_463]) && ((x1 = x1_455[@i_463]) && ((x2 = x2_454[@i_463]) && ((x3 = X[@i_463]) && ((x4 = Y[@i_236[@i_463]]) && (x5 = K_u_1098[@i_463]))))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(x1_461[@i_462], x2_460[@i_462], X[@i_462], Y[@i_236[@i_462]], K_u_1098[@i_462], r_456[@i_462]) && otheruses(r_456[@i_462]) && ((x1 = x1_461[@i_462]) && ((x2 = x2_460[@i_462]) && ((x3 = X[@i_462]) && ((x4 = Y[@i_236[@i_462]]) && (x5 = K_u_1098[@i_462]))))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1095[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1095[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1096[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1096[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1097[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1097[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1098[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1098[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1099[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1099[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of binder K_u_1099 yields

Game 26 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_x_783[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_x_783[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = exp(g, @1_x_783[@i_246]) in
    let K_u_1095: G = exp(g, mult(@1_x_783[@i_246], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_783[@i_246]) = x14[@i_120]) && (K_u_1095 = x15[@i_120]))))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      find [unique] @i_552 <= qH0 suchthat defined(x1[@i_552], x2[@i_552], x3[@i_552], x4[@i_552], x5[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && ((x1_425 = x1[@i_552]) && ((x2_424 = x2[@i_552]) && ((X = x3[@i_552]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_552]) && (K_u_1095 = x5[@i_552]))))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_552]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_420);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_419: host = U in
      let x2_418: host = S in
      find [unique] @i_539 <= qH0 suchthat defined(x1[@i_539], x2[@i_539], x3[@i_539], x4[@i_539], x5[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && ((x1_419 = x1[@i_539]) && ((x2_418 = x2[@i_539]) && ((X = x3[@i_539]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_539]) && (K_u_1095 = x5[@i_539]))))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_539]);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_414);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @1_x_925[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @1_x_925[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = exp(g, @1_x_925[@i_241]) in
    let K_u_1096: G = exp(g, mult(@1_x_925[@i_241], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_925[@i_241]) = x14[@i_120]) && (K_u_1096 = x15[@i_120]))))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      find [unique] @i_578 <= qH0 suchthat defined(x1[@i_578], x2[@i_578], x3[@i_578], x4[@i_578], x5[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && ((x1_437 = x1[@i_578]) && ((x2_436 = x2[@i_578]) && ((X = x3[@i_578]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_578]) && (K_u_1096 = x5[@i_578]))))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_578]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_432);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_431: host = U in
      let x2_430: host = S in
      find [unique] @i_565 <= qH0 suchthat defined(x1[@i_565], x2[@i_565], x3[@i_565], x4[@i_565], x5[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && ((x1_431 = x1[@i_565]) && ((x2_430 = x2[@i_565]) && ((X = x3[@i_565]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_565]) && (K_u_1096 = x5[@i_565]))))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_565]);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_426);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u_1097: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (K_u_1097 = x15[@i_120]))))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      find [unique] @i_604 <= qH0 suchthat defined(x1[@i_604], x2[@i_604], x3[@i_604], x4[@i_604], x5[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && ((x1_449 = x1[@i_604]) && ((x2_448 = x2[@i_604]) && ((X = x3[@i_604]) && ((Yp[@i_238] = x4[@i_604]) && (K_u_1097 = x5[@i_604]))))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_604]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_444);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_443: host = U in
      let x2_442: host = S in
      find [unique] @i_591 <= qH0 suchthat defined(x1[@i_591], x2[@i_591], x3[@i_591], x4[@i_591], x5[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && ((x1_443 = x1[@i_591]) && ((x2_442 = x2[@i_591]) && ((X = x3[@i_591]) && ((Yp[@i_238] = x4[@i_591]) && (K_u_1097 = x5[@i_591]))))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_591]);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_438);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u_1098: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (K_u_1098 = x15[@i_120]))))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      find [unique] @i_630 <= qH0 suchthat defined(x1[@i_630], x2[@i_630], x3[@i_630], x4[@i_630], x5[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && ((x1_461 = x1[@i_630]) && ((x2_460 = x2[@i_630]) && ((X = x3[@i_630]) && ((Y[@i_236] = x4[@i_630]) && (K_u_1098 = x5[@i_630]))))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_630]);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind  suchthat defined(j[@i_236], r_396[@i_236]) && otheruses(r_396[@i_236]) && (!_41 = j[@i_236]) then
      (
        let sk_u: hash0 = r_396[@i_236] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_396[@i_236]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_456);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_455: host = U in
      let x2_454: host = S in
      find [unique] @i_617 <= qH0 suchthat defined(x1[@i_617], x2[@i_617], x3[@i_617], x4[@i_617], x5[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && ((x1_455 = x1[@i_617]) && ((x2_454 = x2[@i_617]) && ((X = x3[@i_617]) && ((Y[@i_236] = x4[@i_617]) && (K_u_1098 = x5[@i_617]))))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_617]);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_450);
        out(c6[!_41], r1_90)
  )
  else
    new @1_x_925: exponent;
    let @2_r4_172: G = cst_G in
    let Y_u: G = exp(g, @1_x_925) in
    let K_u_1099: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (exp(g, mult(x[j], y)) = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      find [unique] @i_500 <= qH0 suchthat defined(x1[@i_500], x2[@i_500], x3[@i_500], x4[@i_500], x5[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && ((x1_401 = x1[@i_500]) && ((x2_400 = x2[@i_500]) && ((X_s = x3[@i_500]) && ((Y = x4[@i_500]) && (exp(g, mult(x[j], y)) = x5[@i_500]))))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_500])
      )
      orfind  suchthat defined(@i_236[j], r_450[j]) && otheruses(r_450[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      orfind  suchthat defined(@i_236[j], r_456[j]) && otheruses(r_456[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_456[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_456[j])
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_396)
    )
    orfind  suchthat defined(@i_236[j], r1_90[j], K_u_1098[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (exp(g, mult(x[j], y)) = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_x_783[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_x_783[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_783[@i_222]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @1_x_925[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @1_x_925[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_925[@i_217]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_x_783[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_x_783[@i_198]) && ((@2_x = exp(g, @1_x_783[@i_198])) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@1_x_925[@i_193], Ystar_u[@i_193], @2_r4_172[@i_193]) && otheruses(Ystar_u[@i_193] -> @1_x_925[@i_193]) && ((@2_x = exp(g, @1_x_925[@i_193])) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_x_783[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_x_783[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], exp(g, @1_x_783[@i_186]))
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @1_x_925[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @1_x_925[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], exp(g, @1_x_925[@i_181]))
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_x_783: exponent;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], exp(g, @1_x_783))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(x1_395[@i_473], x2_394[@i_473], Xp[@i_473], Yp[@i_473], Kp[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && ((x1 = x1_395[@i_473]) && ((x2 = x2_394[@i_473]) && ((x3 = Xp[@i_473]) && ((x4 = Yp[@i_473]) && (x5 = Kp[@i_473]))))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(y[@i_472], x[j[@i_472]], K_s[@i_472], x1_401[@i_472], x2_400[@i_472], X_s[@i_472], Y[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && ((x1 = x1_401[@i_472]) && ((x2 = x2_400[@i_472]) && ((x3 = X_s[@i_472]) && ((x4 = Y[@i_472]) && (x5 = exp(g, mult(x[j[@i_472]], y[@i_472]))))))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(y[@i_471], x[j[@i_471]], K_s[@i_471], x1_407[@i_471], x2_406[@i_471], X_s[@i_471], Y[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && ((x1 = x1_407[@i_471]) && ((x2 = x2_406[@i_471]) && ((x3 = X_s[@i_471]) && ((x4 = Y[@i_471]) && (x5 = exp(g, mult(x[j[@i_471]], y[@i_471]))))))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(x[@i_470], K_u_1099[@i_470], x1_413[@i_470], x2_412[@i_470], X[@i_470], @1_x_925[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && ((x1 = x1_413[@i_470]) && ((x2 = x2_412[@i_470]) && ((x3 = X[@i_470]) && ((x4 = exp(g, @1_x_925[@i_470])) && (x5 = exp(g, mult(@1_x_925[@i_470], x[@i_470]))))))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(x1_419[@i_469], x2_418[@i_469], X[@i_469], @1_x_783[@i_246[@i_469]], K_u_1095[@i_469], r_414[@i_469]) && otheruses(r_414[@i_469]) && ((x1 = x1_419[@i_469]) && ((x2 = x2_418[@i_469]) && ((x3 = X[@i_469]) && ((x4 = exp(g, @1_x_783[@i_246[@i_469]])) && (x5 = K_u_1095[@i_469]))))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(x1_425[@i_468], x2_424[@i_468], X[@i_468], @1_x_783[@i_246[@i_468]], K_u_1095[@i_468], r_420[@i_468]) && otheruses(r_420[@i_468]) && ((x1 = x1_425[@i_468]) && ((x2 = x2_424[@i_468]) && ((x3 = X[@i_468]) && ((x4 = exp(g, @1_x_783[@i_246[@i_468]])) && (x5 = K_u_1095[@i_468]))))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(x1_431[@i_467], x2_430[@i_467], X[@i_467], @1_x_925[@i_241[@i_467]], K_u_1096[@i_467], r_426[@i_467]) && otheruses(r_426[@i_467]) && ((x1 = x1_431[@i_467]) && ((x2 = x2_430[@i_467]) && ((x3 = X[@i_467]) && ((x4 = exp(g, @1_x_925[@i_241[@i_467]])) && (x5 = K_u_1096[@i_467]))))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(x1_437[@i_466], x2_436[@i_466], X[@i_466], @1_x_925[@i_241[@i_466]], K_u_1096[@i_466], r_432[@i_466]) && otheruses(r_432[@i_466]) && ((x1 = x1_437[@i_466]) && ((x2 = x2_436[@i_466]) && ((x3 = X[@i_466]) && ((x4 = exp(g, @1_x_925[@i_241[@i_466]])) && (x5 = K_u_1096[@i_466]))))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(x1_443[@i_465], x2_442[@i_465], X[@i_465], Yp[@i_238[@i_465]], K_u_1097[@i_465], r_438[@i_465]) && otheruses(r_438[@i_465]) && ((x1 = x1_443[@i_465]) && ((x2 = x2_442[@i_465]) && ((x3 = X[@i_465]) && ((x4 = Yp[@i_238[@i_465]]) && (x5 = K_u_1097[@i_465]))))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(x1_449[@i_464], x2_448[@i_464], X[@i_464], Yp[@i_238[@i_464]], K_u_1097[@i_464], r_444[@i_464]) && otheruses(r_444[@i_464]) && ((x1 = x1_449[@i_464]) && ((x2 = x2_448[@i_464]) && ((x3 = X[@i_464]) && ((x4 = Yp[@i_238[@i_464]]) && (x5 = K_u_1097[@i_464]))))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(x1_455[@i_463], x2_454[@i_463], X[@i_463], Y[@i_236[@i_463]], K_u_1098[@i_463], r_450[@i_463]) && otheruses(r_450[@i_463]) && ((x1 = x1_455[@i_463]) && ((x2 = x2_454[@i_463]) && ((x3 = X[@i_463]) && ((x4 = Y[@i_236[@i_463]]) && (x5 = K_u_1098[@i_463]))))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(x1_461[@i_462], x2_460[@i_462], X[@i_462], Y[@i_236[@i_462]], K_u_1098[@i_462], r_456[@i_462]) && otheruses(r_456[@i_462]) && ((x1 = x1_461[@i_462]) && ((x2 = x2_460[@i_462]) && ((x3 = X[@i_462]) && ((x4 = Y[@i_236[@i_462]]) && (x5 = K_u_1098[@i_462]))))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1095[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1095[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1096[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1096[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1097[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1097[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1098[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1098[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_925[@i_96], K_u_1099[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(@1_x_925[@i_96], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of binder K_u_1095 yields

Game 27 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_x_783[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_x_783[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = exp(g, @1_x_783[@i_246]) in
    let K_u_1095: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_783[@i_246]) = x14[@i_120]) && (exp(g, mult(@1_x_783[@i_246], x)) = x15[@i_120]))))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      find [unique] @i_552 <= qH0 suchthat defined(x1[@i_552], x2[@i_552], x3[@i_552], x4[@i_552], x5[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && ((x1_425 = x1[@i_552]) && ((x2_424 = x2[@i_552]) && ((X = x3[@i_552]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_552]) && (exp(g, mult(@1_x_783[@i_246], x)) = x5[@i_552]))))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_552]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_420);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_419: host = U in
      let x2_418: host = S in
      find [unique] @i_539 <= qH0 suchthat defined(x1[@i_539], x2[@i_539], x3[@i_539], x4[@i_539], x5[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && ((x1_419 = x1[@i_539]) && ((x2_418 = x2[@i_539]) && ((X = x3[@i_539]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_539]) && (exp(g, mult(@1_x_783[@i_246], x)) = x5[@i_539]))))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_539]);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_414);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @1_x_925[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @1_x_925[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = exp(g, @1_x_925[@i_241]) in
    let K_u_1096: G = exp(g, mult(@1_x_925[@i_241], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_925[@i_241]) = x14[@i_120]) && (K_u_1096 = x15[@i_120]))))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      find [unique] @i_578 <= qH0 suchthat defined(x1[@i_578], x2[@i_578], x3[@i_578], x4[@i_578], x5[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && ((x1_437 = x1[@i_578]) && ((x2_436 = x2[@i_578]) && ((X = x3[@i_578]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_578]) && (K_u_1096 = x5[@i_578]))))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_578]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_432);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_431: host = U in
      let x2_430: host = S in
      find [unique] @i_565 <= qH0 suchthat defined(x1[@i_565], x2[@i_565], x3[@i_565], x4[@i_565], x5[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && ((x1_431 = x1[@i_565]) && ((x2_430 = x2[@i_565]) && ((X = x3[@i_565]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_565]) && (K_u_1096 = x5[@i_565]))))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_565]);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_426);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u_1097: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (K_u_1097 = x15[@i_120]))))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      find [unique] @i_604 <= qH0 suchthat defined(x1[@i_604], x2[@i_604], x3[@i_604], x4[@i_604], x5[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && ((x1_449 = x1[@i_604]) && ((x2_448 = x2[@i_604]) && ((X = x3[@i_604]) && ((Yp[@i_238] = x4[@i_604]) && (K_u_1097 = x5[@i_604]))))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_604]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_444);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_443: host = U in
      let x2_442: host = S in
      find [unique] @i_591 <= qH0 suchthat defined(x1[@i_591], x2[@i_591], x3[@i_591], x4[@i_591], x5[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && ((x1_443 = x1[@i_591]) && ((x2_442 = x2[@i_591]) && ((X = x3[@i_591]) && ((Yp[@i_238] = x4[@i_591]) && (K_u_1097 = x5[@i_591]))))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_591]);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_438);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u_1098: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (K_u_1098 = x15[@i_120]))))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      find [unique] @i_630 <= qH0 suchthat defined(x1[@i_630], x2[@i_630], x3[@i_630], x4[@i_630], x5[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && ((x1_461 = x1[@i_630]) && ((x2_460 = x2[@i_630]) && ((X = x3[@i_630]) && ((Y[@i_236] = x4[@i_630]) && (K_u_1098 = x5[@i_630]))))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_630]);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind  suchthat defined(j[@i_236], r_396[@i_236]) && otheruses(r_396[@i_236]) && (!_41 = j[@i_236]) then
      (
        let sk_u: hash0 = r_396[@i_236] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_396[@i_236]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_456);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_455: host = U in
      let x2_454: host = S in
      find [unique] @i_617 <= qH0 suchthat defined(x1[@i_617], x2[@i_617], x3[@i_617], x4[@i_617], x5[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && ((x1_455 = x1[@i_617]) && ((x2_454 = x2[@i_617]) && ((X = x3[@i_617]) && ((Y[@i_236] = x4[@i_617]) && (K_u_1098 = x5[@i_617]))))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_617]);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_450);
        out(c6[!_41], r1_90)
  )
  else
    new @1_x_925: exponent;
    let @2_r4_172: G = cst_G in
    let Y_u: G = exp(g, @1_x_925) in
    let K_u_1099: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (exp(g, mult(x[j], y)) = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      find [unique] @i_500 <= qH0 suchthat defined(x1[@i_500], x2[@i_500], x3[@i_500], x4[@i_500], x5[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && ((x1_401 = x1[@i_500]) && ((x2_400 = x2[@i_500]) && ((X_s = x3[@i_500]) && ((Y = x4[@i_500]) && (exp(g, mult(x[j], y)) = x5[@i_500]))))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_500])
      )
      orfind  suchthat defined(@i_236[j], r_450[j]) && otheruses(r_450[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      orfind  suchthat defined(@i_236[j], r_456[j]) && otheruses(r_456[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_456[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_456[j])
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_396)
    )
    orfind  suchthat defined(@i_236[j], r1_90[j], K_u_1098[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (exp(g, mult(x[j], y)) = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_x_783[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_x_783[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_783[@i_222]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @1_x_925[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @1_x_925[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_925[@i_217]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_x_783[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_x_783[@i_198]) && ((@2_x = exp(g, @1_x_783[@i_198])) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@1_x_925[@i_193], Ystar_u[@i_193], @2_r4_172[@i_193]) && otheruses(Ystar_u[@i_193] -> @1_x_925[@i_193]) && ((@2_x = exp(g, @1_x_925[@i_193])) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_x_783[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_x_783[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], exp(g, @1_x_783[@i_186]))
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @1_x_925[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @1_x_925[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], exp(g, @1_x_925[@i_181]))
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_x_783: exponent;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], exp(g, @1_x_783))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(x1_395[@i_473], x2_394[@i_473], Xp[@i_473], Yp[@i_473], Kp[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && ((x1 = x1_395[@i_473]) && ((x2 = x2_394[@i_473]) && ((x3 = Xp[@i_473]) && ((x4 = Yp[@i_473]) && (x5 = Kp[@i_473]))))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(y[@i_472], x[j[@i_472]], K_s[@i_472], x1_401[@i_472], x2_400[@i_472], X_s[@i_472], Y[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && ((x1 = x1_401[@i_472]) && ((x2 = x2_400[@i_472]) && ((x3 = X_s[@i_472]) && ((x4 = Y[@i_472]) && (x5 = exp(g, mult(x[j[@i_472]], y[@i_472]))))))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(y[@i_471], x[j[@i_471]], K_s[@i_471], x1_407[@i_471], x2_406[@i_471], X_s[@i_471], Y[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && ((x1 = x1_407[@i_471]) && ((x2 = x2_406[@i_471]) && ((x3 = X_s[@i_471]) && ((x4 = Y[@i_471]) && (x5 = exp(g, mult(x[j[@i_471]], y[@i_471]))))))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(x[@i_470], K_u_1099[@i_470], x1_413[@i_470], x2_412[@i_470], X[@i_470], @1_x_925[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && ((x1 = x1_413[@i_470]) && ((x2 = x2_412[@i_470]) && ((x3 = X[@i_470]) && ((x4 = exp(g, @1_x_925[@i_470])) && (x5 = exp(g, mult(@1_x_925[@i_470], x[@i_470]))))))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(x[@i_469], K_u_1095[@i_469], x1_419[@i_469], x2_418[@i_469], X[@i_469], @1_x_783[@i_246[@i_469]], r_414[@i_469]) && otheruses(r_414[@i_469]) && ((x1 = x1_419[@i_469]) && ((x2 = x2_418[@i_469]) && ((x3 = X[@i_469]) && ((x4 = exp(g, @1_x_783[@i_246[@i_469]])) && (x5 = exp(g, mult(@1_x_783[@i_246[@i_469]], x[@i_469]))))))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(x[@i_468], K_u_1095[@i_468], x1_425[@i_468], x2_424[@i_468], X[@i_468], @1_x_783[@i_246[@i_468]], r_420[@i_468]) && otheruses(r_420[@i_468]) && ((x1 = x1_425[@i_468]) && ((x2 = x2_424[@i_468]) && ((x3 = X[@i_468]) && ((x4 = exp(g, @1_x_783[@i_246[@i_468]])) && (x5 = exp(g, mult(@1_x_783[@i_246[@i_468]], x[@i_468]))))))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(x1_431[@i_467], x2_430[@i_467], X[@i_467], @1_x_925[@i_241[@i_467]], K_u_1096[@i_467], r_426[@i_467]) && otheruses(r_426[@i_467]) && ((x1 = x1_431[@i_467]) && ((x2 = x2_430[@i_467]) && ((x3 = X[@i_467]) && ((x4 = exp(g, @1_x_925[@i_241[@i_467]])) && (x5 = K_u_1096[@i_467]))))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(x1_437[@i_466], x2_436[@i_466], X[@i_466], @1_x_925[@i_241[@i_466]], K_u_1096[@i_466], r_432[@i_466]) && otheruses(r_432[@i_466]) && ((x1 = x1_437[@i_466]) && ((x2 = x2_436[@i_466]) && ((x3 = X[@i_466]) && ((x4 = exp(g, @1_x_925[@i_241[@i_466]])) && (x5 = K_u_1096[@i_466]))))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(x1_443[@i_465], x2_442[@i_465], X[@i_465], Yp[@i_238[@i_465]], K_u_1097[@i_465], r_438[@i_465]) && otheruses(r_438[@i_465]) && ((x1 = x1_443[@i_465]) && ((x2 = x2_442[@i_465]) && ((x3 = X[@i_465]) && ((x4 = Yp[@i_238[@i_465]]) && (x5 = K_u_1097[@i_465]))))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(x1_449[@i_464], x2_448[@i_464], X[@i_464], Yp[@i_238[@i_464]], K_u_1097[@i_464], r_444[@i_464]) && otheruses(r_444[@i_464]) && ((x1 = x1_449[@i_464]) && ((x2 = x2_448[@i_464]) && ((x3 = X[@i_464]) && ((x4 = Yp[@i_238[@i_464]]) && (x5 = K_u_1097[@i_464]))))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(x1_455[@i_463], x2_454[@i_463], X[@i_463], Y[@i_236[@i_463]], K_u_1098[@i_463], r_450[@i_463]) && otheruses(r_450[@i_463]) && ((x1 = x1_455[@i_463]) && ((x2 = x2_454[@i_463]) && ((x3 = X[@i_463]) && ((x4 = Y[@i_236[@i_463]]) && (x5 = K_u_1098[@i_463]))))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(x1_461[@i_462], x2_460[@i_462], X[@i_462], Y[@i_236[@i_462]], K_u_1098[@i_462], r_456[@i_462]) && otheruses(r_456[@i_462]) && ((x1 = x1_461[@i_462]) && ((x2 = x2_460[@i_462]) && ((x3 = X[@i_462]) && ((x4 = Y[@i_236[@i_462]]) && (x5 = K_u_1098[@i_462]))))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_783[@i_246[@i_96]], K_u_1095[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(@1_x_783[@i_246[@i_96]], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1096[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1096[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1097[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1097[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1098[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1098[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_925[@i_96], K_u_1099[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(@1_x_925[@i_96], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of binder K_u_1096 yields

Game 28 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_x_783[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_x_783[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = exp(g, @1_x_783[@i_246]) in
    let K_u_1095: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_783[@i_246]) = x14[@i_120]) && (exp(g, mult(@1_x_783[@i_246], x)) = x15[@i_120]))))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      find [unique] @i_552 <= qH0 suchthat defined(x1[@i_552], x2[@i_552], x3[@i_552], x4[@i_552], x5[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && ((x1_425 = x1[@i_552]) && ((x2_424 = x2[@i_552]) && ((X = x3[@i_552]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_552]) && (exp(g, mult(@1_x_783[@i_246], x)) = x5[@i_552]))))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_552]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_420);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_419: host = U in
      let x2_418: host = S in
      find [unique] @i_539 <= qH0 suchthat defined(x1[@i_539], x2[@i_539], x3[@i_539], x4[@i_539], x5[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && ((x1_419 = x1[@i_539]) && ((x2_418 = x2[@i_539]) && ((X = x3[@i_539]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_539]) && (exp(g, mult(@1_x_783[@i_246], x)) = x5[@i_539]))))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_539]);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_414);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @1_x_925[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @1_x_925[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = exp(g, @1_x_925[@i_241]) in
    let K_u_1096: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_925[@i_241]) = x14[@i_120]) && (exp(g, mult(@1_x_925[@i_241], x)) = x15[@i_120]))))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      find [unique] @i_578 <= qH0 suchthat defined(x1[@i_578], x2[@i_578], x3[@i_578], x4[@i_578], x5[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && ((x1_437 = x1[@i_578]) && ((x2_436 = x2[@i_578]) && ((X = x3[@i_578]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_578]) && (exp(g, mult(@1_x_925[@i_241], x)) = x5[@i_578]))))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_578]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_432);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_431: host = U in
      let x2_430: host = S in
      find [unique] @i_565 <= qH0 suchthat defined(x1[@i_565], x2[@i_565], x3[@i_565], x4[@i_565], x5[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && ((x1_431 = x1[@i_565]) && ((x2_430 = x2[@i_565]) && ((X = x3[@i_565]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_565]) && (exp(g, mult(@1_x_925[@i_241], x)) = x5[@i_565]))))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_565]);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_426);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u_1097: G = exp(g, mult(yp[@i_238], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (K_u_1097 = x15[@i_120]))))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      find [unique] @i_604 <= qH0 suchthat defined(x1[@i_604], x2[@i_604], x3[@i_604], x4[@i_604], x5[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && ((x1_449 = x1[@i_604]) && ((x2_448 = x2[@i_604]) && ((X = x3[@i_604]) && ((Yp[@i_238] = x4[@i_604]) && (K_u_1097 = x5[@i_604]))))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_604]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_444);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_443: host = U in
      let x2_442: host = S in
      find [unique] @i_591 <= qH0 suchthat defined(x1[@i_591], x2[@i_591], x3[@i_591], x4[@i_591], x5[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && ((x1_443 = x1[@i_591]) && ((x2_442 = x2[@i_591]) && ((X = x3[@i_591]) && ((Yp[@i_238] = x4[@i_591]) && (K_u_1097 = x5[@i_591]))))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_591]);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_438);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u_1098: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (K_u_1098 = x15[@i_120]))))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      find [unique] @i_630 <= qH0 suchthat defined(x1[@i_630], x2[@i_630], x3[@i_630], x4[@i_630], x5[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && ((x1_461 = x1[@i_630]) && ((x2_460 = x2[@i_630]) && ((X = x3[@i_630]) && ((Y[@i_236] = x4[@i_630]) && (K_u_1098 = x5[@i_630]))))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_630]);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind  suchthat defined(j[@i_236], r_396[@i_236]) && otheruses(r_396[@i_236]) && (!_41 = j[@i_236]) then
      (
        let sk_u: hash0 = r_396[@i_236] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_396[@i_236]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_456);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_455: host = U in
      let x2_454: host = S in
      find [unique] @i_617 <= qH0 suchthat defined(x1[@i_617], x2[@i_617], x3[@i_617], x4[@i_617], x5[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && ((x1_455 = x1[@i_617]) && ((x2_454 = x2[@i_617]) && ((X = x3[@i_617]) && ((Y[@i_236] = x4[@i_617]) && (K_u_1098 = x5[@i_617]))))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_617]);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_450);
        out(c6[!_41], r1_90)
  )
  else
    new @1_x_925: exponent;
    let @2_r4_172: G = cst_G in
    let Y_u: G = exp(g, @1_x_925) in
    let K_u_1099: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (exp(g, mult(x[j], y)) = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      find [unique] @i_500 <= qH0 suchthat defined(x1[@i_500], x2[@i_500], x3[@i_500], x4[@i_500], x5[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && ((x1_401 = x1[@i_500]) && ((x2_400 = x2[@i_500]) && ((X_s = x3[@i_500]) && ((Y = x4[@i_500]) && (exp(g, mult(x[j], y)) = x5[@i_500]))))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_500])
      )
      orfind  suchthat defined(@i_236[j], r_450[j]) && otheruses(r_450[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      orfind  suchthat defined(@i_236[j], r_456[j]) && otheruses(r_456[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_456[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_456[j])
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_396)
    )
    orfind  suchthat defined(@i_236[j], r1_90[j], K_u_1098[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (exp(g, mult(x[j], y)) = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_x_783[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_x_783[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_783[@i_222]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @1_x_925[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @1_x_925[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_925[@i_217]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_x_783[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_x_783[@i_198]) && ((@2_x = exp(g, @1_x_783[@i_198])) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@1_x_925[@i_193], Ystar_u[@i_193], @2_r4_172[@i_193]) && otheruses(Ystar_u[@i_193] -> @1_x_925[@i_193]) && ((@2_x = exp(g, @1_x_925[@i_193])) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_x_783[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_x_783[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], exp(g, @1_x_783[@i_186]))
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @1_x_925[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @1_x_925[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], exp(g, @1_x_925[@i_181]))
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_x_783: exponent;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], exp(g, @1_x_783))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(x1_395[@i_473], x2_394[@i_473], Xp[@i_473], Yp[@i_473], Kp[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && ((x1 = x1_395[@i_473]) && ((x2 = x2_394[@i_473]) && ((x3 = Xp[@i_473]) && ((x4 = Yp[@i_473]) && (x5 = Kp[@i_473]))))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(y[@i_472], x[j[@i_472]], K_s[@i_472], x1_401[@i_472], x2_400[@i_472], X_s[@i_472], Y[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && ((x1 = x1_401[@i_472]) && ((x2 = x2_400[@i_472]) && ((x3 = X_s[@i_472]) && ((x4 = Y[@i_472]) && (x5 = exp(g, mult(x[j[@i_472]], y[@i_472]))))))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(y[@i_471], x[j[@i_471]], K_s[@i_471], x1_407[@i_471], x2_406[@i_471], X_s[@i_471], Y[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && ((x1 = x1_407[@i_471]) && ((x2 = x2_406[@i_471]) && ((x3 = X_s[@i_471]) && ((x4 = Y[@i_471]) && (x5 = exp(g, mult(x[j[@i_471]], y[@i_471]))))))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(x[@i_470], K_u_1099[@i_470], x1_413[@i_470], x2_412[@i_470], X[@i_470], @1_x_925[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && ((x1 = x1_413[@i_470]) && ((x2 = x2_412[@i_470]) && ((x3 = X[@i_470]) && ((x4 = exp(g, @1_x_925[@i_470])) && (x5 = exp(g, mult(@1_x_925[@i_470], x[@i_470]))))))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(x[@i_469], K_u_1095[@i_469], x1_419[@i_469], x2_418[@i_469], X[@i_469], @1_x_783[@i_246[@i_469]], r_414[@i_469]) && otheruses(r_414[@i_469]) && ((x1 = x1_419[@i_469]) && ((x2 = x2_418[@i_469]) && ((x3 = X[@i_469]) && ((x4 = exp(g, @1_x_783[@i_246[@i_469]])) && (x5 = exp(g, mult(@1_x_783[@i_246[@i_469]], x[@i_469]))))))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(x[@i_468], K_u_1095[@i_468], x1_425[@i_468], x2_424[@i_468], X[@i_468], @1_x_783[@i_246[@i_468]], r_420[@i_468]) && otheruses(r_420[@i_468]) && ((x1 = x1_425[@i_468]) && ((x2 = x2_424[@i_468]) && ((x3 = X[@i_468]) && ((x4 = exp(g, @1_x_783[@i_246[@i_468]])) && (x5 = exp(g, mult(@1_x_783[@i_246[@i_468]], x[@i_468]))))))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(x[@i_467], K_u_1096[@i_467], x1_431[@i_467], x2_430[@i_467], X[@i_467], @1_x_925[@i_241[@i_467]], r_426[@i_467]) && otheruses(r_426[@i_467]) && ((x1 = x1_431[@i_467]) && ((x2 = x2_430[@i_467]) && ((x3 = X[@i_467]) && ((x4 = exp(g, @1_x_925[@i_241[@i_467]])) && (x5 = exp(g, mult(@1_x_925[@i_241[@i_467]], x[@i_467]))))))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(x[@i_466], K_u_1096[@i_466], x1_437[@i_466], x2_436[@i_466], X[@i_466], @1_x_925[@i_241[@i_466]], r_432[@i_466]) && otheruses(r_432[@i_466]) && ((x1 = x1_437[@i_466]) && ((x2 = x2_436[@i_466]) && ((x3 = X[@i_466]) && ((x4 = exp(g, @1_x_925[@i_241[@i_466]])) && (x5 = exp(g, mult(@1_x_925[@i_241[@i_466]], x[@i_466]))))))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(x1_443[@i_465], x2_442[@i_465], X[@i_465], Yp[@i_238[@i_465]], K_u_1097[@i_465], r_438[@i_465]) && otheruses(r_438[@i_465]) && ((x1 = x1_443[@i_465]) && ((x2 = x2_442[@i_465]) && ((x3 = X[@i_465]) && ((x4 = Yp[@i_238[@i_465]]) && (x5 = K_u_1097[@i_465]))))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(x1_449[@i_464], x2_448[@i_464], X[@i_464], Yp[@i_238[@i_464]], K_u_1097[@i_464], r_444[@i_464]) && otheruses(r_444[@i_464]) && ((x1 = x1_449[@i_464]) && ((x2 = x2_448[@i_464]) && ((x3 = X[@i_464]) && ((x4 = Yp[@i_238[@i_464]]) && (x5 = K_u_1097[@i_464]))))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(x1_455[@i_463], x2_454[@i_463], X[@i_463], Y[@i_236[@i_463]], K_u_1098[@i_463], r_450[@i_463]) && otheruses(r_450[@i_463]) && ((x1 = x1_455[@i_463]) && ((x2 = x2_454[@i_463]) && ((x3 = X[@i_463]) && ((x4 = Y[@i_236[@i_463]]) && (x5 = K_u_1098[@i_463]))))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(x1_461[@i_462], x2_460[@i_462], X[@i_462], Y[@i_236[@i_462]], K_u_1098[@i_462], r_456[@i_462]) && otheruses(r_456[@i_462]) && ((x1 = x1_461[@i_462]) && ((x2 = x2_460[@i_462]) && ((x3 = X[@i_462]) && ((x4 = Y[@i_236[@i_462]]) && (x5 = K_u_1098[@i_462]))))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_783[@i_246[@i_96]], K_u_1095[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(@1_x_783[@i_246[@i_96]], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_925[@i_241[@i_96]], K_u_1096[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(@1_x_925[@i_241[@i_96]], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1097[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1097[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1098[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1098[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_925[@i_96], K_u_1099[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(@1_x_925[@i_96], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of binder K_u_1097 yields

Game 29 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_x_783[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_x_783[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = exp(g, @1_x_783[@i_246]) in
    let K_u_1095: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_783[@i_246]) = x14[@i_120]) && (exp(g, mult(@1_x_783[@i_246], x)) = x15[@i_120]))))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      find [unique] @i_552 <= qH0 suchthat defined(x1[@i_552], x2[@i_552], x3[@i_552], x4[@i_552], x5[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && ((x1_425 = x1[@i_552]) && ((x2_424 = x2[@i_552]) && ((X = x3[@i_552]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_552]) && (exp(g, mult(@1_x_783[@i_246], x)) = x5[@i_552]))))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_552]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_420);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_419: host = U in
      let x2_418: host = S in
      find [unique] @i_539 <= qH0 suchthat defined(x1[@i_539], x2[@i_539], x3[@i_539], x4[@i_539], x5[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && ((x1_419 = x1[@i_539]) && ((x2_418 = x2[@i_539]) && ((X = x3[@i_539]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_539]) && (exp(g, mult(@1_x_783[@i_246], x)) = x5[@i_539]))))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_539]);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_414);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @1_x_925[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @1_x_925[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = exp(g, @1_x_925[@i_241]) in
    let K_u_1096: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_925[@i_241]) = x14[@i_120]) && (exp(g, mult(@1_x_925[@i_241], x)) = x15[@i_120]))))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      find [unique] @i_578 <= qH0 suchthat defined(x1[@i_578], x2[@i_578], x3[@i_578], x4[@i_578], x5[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && ((x1_437 = x1[@i_578]) && ((x2_436 = x2[@i_578]) && ((X = x3[@i_578]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_578]) && (exp(g, mult(@1_x_925[@i_241], x)) = x5[@i_578]))))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_578]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_432);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_431: host = U in
      let x2_430: host = S in
      find [unique] @i_565 <= qH0 suchthat defined(x1[@i_565], x2[@i_565], x3[@i_565], x4[@i_565], x5[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && ((x1_431 = x1[@i_565]) && ((x2_430 = x2[@i_565]) && ((X = x3[@i_565]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_565]) && (exp(g, mult(@1_x_925[@i_241], x)) = x5[@i_565]))))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_565]);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_426);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u_1097: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (exp(g, mult(yp[@i_238], x)) = x15[@i_120]))))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      find [unique] @i_604 <= qH0 suchthat defined(x1[@i_604], x2[@i_604], x3[@i_604], x4[@i_604], x5[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && ((x1_449 = x1[@i_604]) && ((x2_448 = x2[@i_604]) && ((X = x3[@i_604]) && ((Yp[@i_238] = x4[@i_604]) && (exp(g, mult(yp[@i_238], x)) = x5[@i_604]))))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_604]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_444);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_443: host = U in
      let x2_442: host = S in
      find [unique] @i_591 <= qH0 suchthat defined(x1[@i_591], x2[@i_591], x3[@i_591], x4[@i_591], x5[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && ((x1_443 = x1[@i_591]) && ((x2_442 = x2[@i_591]) && ((X = x3[@i_591]) && ((Yp[@i_238] = x4[@i_591]) && (exp(g, mult(yp[@i_238], x)) = x5[@i_591]))))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_591]);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_438);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u_1098: G = exp(g, mult(y[@i_236], x)) in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (K_u_1098 = x15[@i_120]))))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      find [unique] @i_630 <= qH0 suchthat defined(x1[@i_630], x2[@i_630], x3[@i_630], x4[@i_630], x5[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && ((x1_461 = x1[@i_630]) && ((x2_460 = x2[@i_630]) && ((X = x3[@i_630]) && ((Y[@i_236] = x4[@i_630]) && (K_u_1098 = x5[@i_630]))))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_630]);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind  suchthat defined(j[@i_236], r_396[@i_236]) && otheruses(r_396[@i_236]) && (!_41 = j[@i_236]) then
      (
        let sk_u: hash0 = r_396[@i_236] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_396[@i_236]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_456);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_455: host = U in
      let x2_454: host = S in
      find [unique] @i_617 <= qH0 suchthat defined(x1[@i_617], x2[@i_617], x3[@i_617], x4[@i_617], x5[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && ((x1_455 = x1[@i_617]) && ((x2_454 = x2[@i_617]) && ((X = x3[@i_617]) && ((Y[@i_236] = x4[@i_617]) && (K_u_1098 = x5[@i_617]))))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_617]);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_450);
        out(c6[!_41], r1_90)
  )
  else
    new @1_x_925: exponent;
    let @2_r4_172: G = cst_G in
    let Y_u: G = exp(g, @1_x_925) in
    let K_u_1099: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (exp(g, mult(x[j], y)) = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      find [unique] @i_500 <= qH0 suchthat defined(x1[@i_500], x2[@i_500], x3[@i_500], x4[@i_500], x5[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && ((x1_401 = x1[@i_500]) && ((x2_400 = x2[@i_500]) && ((X_s = x3[@i_500]) && ((Y = x4[@i_500]) && (exp(g, mult(x[j], y)) = x5[@i_500]))))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_500])
      )
      orfind  suchthat defined(@i_236[j], r_450[j]) && otheruses(r_450[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      orfind  suchthat defined(@i_236[j], r_456[j]) && otheruses(r_456[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_456[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_456[j])
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_396)
    )
    orfind  suchthat defined(@i_236[j], r1_90[j], K_u_1098[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (exp(g, mult(x[j], y)) = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_x_783[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_x_783[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_783[@i_222]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @1_x_925[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @1_x_925[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_925[@i_217]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_x_783[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_x_783[@i_198]) && ((@2_x = exp(g, @1_x_783[@i_198])) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@1_x_925[@i_193], Ystar_u[@i_193], @2_r4_172[@i_193]) && otheruses(Ystar_u[@i_193] -> @1_x_925[@i_193]) && ((@2_x = exp(g, @1_x_925[@i_193])) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_x_783[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_x_783[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], exp(g, @1_x_783[@i_186]))
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @1_x_925[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @1_x_925[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], exp(g, @1_x_925[@i_181]))
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_x_783: exponent;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], exp(g, @1_x_783))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(x1_395[@i_473], x2_394[@i_473], Xp[@i_473], Yp[@i_473], Kp[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && ((x1 = x1_395[@i_473]) && ((x2 = x2_394[@i_473]) && ((x3 = Xp[@i_473]) && ((x4 = Yp[@i_473]) && (x5 = Kp[@i_473]))))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(y[@i_472], x[j[@i_472]], K_s[@i_472], x1_401[@i_472], x2_400[@i_472], X_s[@i_472], Y[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && ((x1 = x1_401[@i_472]) && ((x2 = x2_400[@i_472]) && ((x3 = X_s[@i_472]) && ((x4 = Y[@i_472]) && (x5 = exp(g, mult(x[j[@i_472]], y[@i_472]))))))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(y[@i_471], x[j[@i_471]], K_s[@i_471], x1_407[@i_471], x2_406[@i_471], X_s[@i_471], Y[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && ((x1 = x1_407[@i_471]) && ((x2 = x2_406[@i_471]) && ((x3 = X_s[@i_471]) && ((x4 = Y[@i_471]) && (x5 = exp(g, mult(x[j[@i_471]], y[@i_471]))))))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(x[@i_470], K_u_1099[@i_470], x1_413[@i_470], x2_412[@i_470], X[@i_470], @1_x_925[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && ((x1 = x1_413[@i_470]) && ((x2 = x2_412[@i_470]) && ((x3 = X[@i_470]) && ((x4 = exp(g, @1_x_925[@i_470])) && (x5 = exp(g, mult(@1_x_925[@i_470], x[@i_470]))))))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(x[@i_469], K_u_1095[@i_469], x1_419[@i_469], x2_418[@i_469], X[@i_469], @1_x_783[@i_246[@i_469]], r_414[@i_469]) && otheruses(r_414[@i_469]) && ((x1 = x1_419[@i_469]) && ((x2 = x2_418[@i_469]) && ((x3 = X[@i_469]) && ((x4 = exp(g, @1_x_783[@i_246[@i_469]])) && (x5 = exp(g, mult(@1_x_783[@i_246[@i_469]], x[@i_469]))))))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(x[@i_468], K_u_1095[@i_468], x1_425[@i_468], x2_424[@i_468], X[@i_468], @1_x_783[@i_246[@i_468]], r_420[@i_468]) && otheruses(r_420[@i_468]) && ((x1 = x1_425[@i_468]) && ((x2 = x2_424[@i_468]) && ((x3 = X[@i_468]) && ((x4 = exp(g, @1_x_783[@i_246[@i_468]])) && (x5 = exp(g, mult(@1_x_783[@i_246[@i_468]], x[@i_468]))))))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(x[@i_467], K_u_1096[@i_467], x1_431[@i_467], x2_430[@i_467], X[@i_467], @1_x_925[@i_241[@i_467]], r_426[@i_467]) && otheruses(r_426[@i_467]) && ((x1 = x1_431[@i_467]) && ((x2 = x2_430[@i_467]) && ((x3 = X[@i_467]) && ((x4 = exp(g, @1_x_925[@i_241[@i_467]])) && (x5 = exp(g, mult(@1_x_925[@i_241[@i_467]], x[@i_467]))))))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(x[@i_466], K_u_1096[@i_466], x1_437[@i_466], x2_436[@i_466], X[@i_466], @1_x_925[@i_241[@i_466]], r_432[@i_466]) && otheruses(r_432[@i_466]) && ((x1 = x1_437[@i_466]) && ((x2 = x2_436[@i_466]) && ((x3 = X[@i_466]) && ((x4 = exp(g, @1_x_925[@i_241[@i_466]])) && (x5 = exp(g, mult(@1_x_925[@i_241[@i_466]], x[@i_466]))))))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(x[@i_465], yp[@i_238[@i_465]], K_u_1097[@i_465], x1_443[@i_465], x2_442[@i_465], X[@i_465], Yp[@i_238[@i_465]], r_438[@i_465]) && otheruses(r_438[@i_465]) && ((x1 = x1_443[@i_465]) && ((x2 = x2_442[@i_465]) && ((x3 = X[@i_465]) && ((x4 = Yp[@i_238[@i_465]]) && (x5 = exp(g, mult(yp[@i_238[@i_465]], x[@i_465]))))))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(x[@i_464], yp[@i_238[@i_464]], K_u_1097[@i_464], x1_449[@i_464], x2_448[@i_464], X[@i_464], Yp[@i_238[@i_464]], r_444[@i_464]) && otheruses(r_444[@i_464]) && ((x1 = x1_449[@i_464]) && ((x2 = x2_448[@i_464]) && ((x3 = X[@i_464]) && ((x4 = Yp[@i_238[@i_464]]) && (x5 = exp(g, mult(yp[@i_238[@i_464]], x[@i_464]))))))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(x1_455[@i_463], x2_454[@i_463], X[@i_463], Y[@i_236[@i_463]], K_u_1098[@i_463], r_450[@i_463]) && otheruses(r_450[@i_463]) && ((x1 = x1_455[@i_463]) && ((x2 = x2_454[@i_463]) && ((x3 = X[@i_463]) && ((x4 = Y[@i_236[@i_463]]) && (x5 = K_u_1098[@i_463]))))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(x1_461[@i_462], x2_460[@i_462], X[@i_462], Y[@i_236[@i_462]], K_u_1098[@i_462], r_456[@i_462]) && otheruses(r_456[@i_462]) && ((x1 = x1_461[@i_462]) && ((x2 = x2_460[@i_462]) && ((x3 = X[@i_462]) && ((x4 = Y[@i_236[@i_462]]) && (x5 = K_u_1098[@i_462]))))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_783[@i_246[@i_96]], K_u_1095[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(@1_x_783[@i_246[@i_96]], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_925[@i_241[@i_96]], K_u_1096[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(@1_x_925[@i_241[@i_96]], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], yp[@i_238[@i_96]], K_u_1097[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(yp[@i_238[@i_96]], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], K_u_1098[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = K_u_1098[@i_96]))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_925[@i_96], K_u_1099[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(@1_x_925[@i_96], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of binder K_u_1098 yields

Game 30 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_x_783[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_x_783[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = exp(g, @1_x_783[@i_246]) in
    let K_u_1095: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_783[@i_246]) = x14[@i_120]) && (exp(g, mult(@1_x_783[@i_246], x)) = x15[@i_120]))))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      find [unique] @i_552 <= qH0 suchthat defined(x1[@i_552], x2[@i_552], x3[@i_552], x4[@i_552], x5[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && ((x1_425 = x1[@i_552]) && ((x2_424 = x2[@i_552]) && ((X = x3[@i_552]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_552]) && (exp(g, mult(@1_x_783[@i_246], x)) = x5[@i_552]))))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_552]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_420);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_419: host = U in
      let x2_418: host = S in
      find [unique] @i_539 <= qH0 suchthat defined(x1[@i_539], x2[@i_539], x3[@i_539], x4[@i_539], x5[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && ((x1_419 = x1[@i_539]) && ((x2_418 = x2[@i_539]) && ((X = x3[@i_539]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_539]) && (exp(g, mult(@1_x_783[@i_246], x)) = x5[@i_539]))))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_539]);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_414);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @1_x_925[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @1_x_925[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = exp(g, @1_x_925[@i_241]) in
    let K_u_1096: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_925[@i_241]) = x14[@i_120]) && (exp(g, mult(@1_x_925[@i_241], x)) = x15[@i_120]))))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      find [unique] @i_578 <= qH0 suchthat defined(x1[@i_578], x2[@i_578], x3[@i_578], x4[@i_578], x5[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && ((x1_437 = x1[@i_578]) && ((x2_436 = x2[@i_578]) && ((X = x3[@i_578]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_578]) && (exp(g, mult(@1_x_925[@i_241], x)) = x5[@i_578]))))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_578]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_432);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_431: host = U in
      let x2_430: host = S in
      find [unique] @i_565 <= qH0 suchthat defined(x1[@i_565], x2[@i_565], x3[@i_565], x4[@i_565], x5[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && ((x1_431 = x1[@i_565]) && ((x2_430 = x2[@i_565]) && ((X = x3[@i_565]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_565]) && (exp(g, mult(@1_x_925[@i_241], x)) = x5[@i_565]))))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_565]);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_426);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u_1097: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (exp(g, mult(yp[@i_238], x)) = x15[@i_120]))))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      find [unique] @i_604 <= qH0 suchthat defined(x1[@i_604], x2[@i_604], x3[@i_604], x4[@i_604], x5[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && ((x1_449 = x1[@i_604]) && ((x2_448 = x2[@i_604]) && ((X = x3[@i_604]) && ((Yp[@i_238] = x4[@i_604]) && (exp(g, mult(yp[@i_238], x)) = x5[@i_604]))))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_604]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_444);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_443: host = U in
      let x2_442: host = S in
      find [unique] @i_591 <= qH0 suchthat defined(x1[@i_591], x2[@i_591], x3[@i_591], x4[@i_591], x5[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && ((x1_443 = x1[@i_591]) && ((x2_442 = x2[@i_591]) && ((X = x3[@i_591]) && ((Yp[@i_238] = x4[@i_591]) && (exp(g, mult(yp[@i_238], x)) = x5[@i_591]))))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_591]);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_438);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u_1098: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (exp(g, mult(y[@i_236], x)) = x15[@i_120]))))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      find [unique] @i_630 <= qH0 suchthat defined(x1[@i_630], x2[@i_630], x3[@i_630], x4[@i_630], x5[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && ((x1_461 = x1[@i_630]) && ((x2_460 = x2[@i_630]) && ((X = x3[@i_630]) && ((Y[@i_236] = x4[@i_630]) && (exp(g, mult(y[@i_236], x)) = x5[@i_630]))))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_630]);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind  suchthat defined(j[@i_236], r_396[@i_236]) && otheruses(r_396[@i_236]) && (!_41 = j[@i_236]) then
      (
        let sk_u: hash0 = r_396[@i_236] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_396[@i_236]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_456);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_455: host = U in
      let x2_454: host = S in
      find [unique] @i_617 <= qH0 suchthat defined(x1[@i_617], x2[@i_617], x3[@i_617], x4[@i_617], x5[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && ((x1_455 = x1[@i_617]) && ((x2_454 = x2[@i_617]) && ((X = x3[@i_617]) && ((Y[@i_236] = x4[@i_617]) && (exp(g, mult(y[@i_236], x)) = x5[@i_617]))))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_617]);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_450);
        out(c6[!_41], r1_90)
  )
  else
    new @1_x_925: exponent;
    let @2_r4_172: G = cst_G in
    let Y_u: G = exp(g, @1_x_925) in
    let K_u_1099: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (exp(g, mult(x[j], y)) = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      find [unique] @i_500 <= qH0 suchthat defined(x1[@i_500], x2[@i_500], x3[@i_500], x4[@i_500], x5[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && ((x1_401 = x1[@i_500]) && ((x2_400 = x2[@i_500]) && ((X_s = x3[@i_500]) && ((Y = x4[@i_500]) && (exp(g, mult(x[j], y)) = x5[@i_500]))))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_500])
      )
      orfind  suchthat defined(@i_236[j], r_450[j]) && otheruses(r_450[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      orfind  suchthat defined(@i_236[j], r_456[j]) && otheruses(r_456[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_456[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_456[j])
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_396)
    )
    orfind  suchthat defined(x[j], y[@i_236[j]], K_u_1098[j], @i_236[j], r1_90[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (exp(g, mult(x[j], y)) = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_x_783[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_x_783[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_783[@i_222]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @1_x_925[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @1_x_925[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_925[@i_217]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = exp(g, mult(xp, yp)) in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_x_783[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_x_783[@i_198]) && ((@2_x = exp(g, @1_x_783[@i_198])) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@1_x_925[@i_193], Ystar_u[@i_193], @2_r4_172[@i_193]) && otheruses(Ystar_u[@i_193] -> @1_x_925[@i_193]) && ((@2_x = exp(g, @1_x_925[@i_193])) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_x_783[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_x_783[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], exp(g, @1_x_783[@i_186]))
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @1_x_925[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @1_x_925[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], exp(g, @1_x_925[@i_181]))
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_x_783: exponent;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], exp(g, @1_x_783))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(x1_395[@i_473], x2_394[@i_473], Xp[@i_473], Yp[@i_473], Kp[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && ((x1 = x1_395[@i_473]) && ((x2 = x2_394[@i_473]) && ((x3 = Xp[@i_473]) && ((x4 = Yp[@i_473]) && (x5 = Kp[@i_473]))))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(y[@i_472], x[j[@i_472]], K_s[@i_472], x1_401[@i_472], x2_400[@i_472], X_s[@i_472], Y[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && ((x1 = x1_401[@i_472]) && ((x2 = x2_400[@i_472]) && ((x3 = X_s[@i_472]) && ((x4 = Y[@i_472]) && (x5 = exp(g, mult(x[j[@i_472]], y[@i_472]))))))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(y[@i_471], x[j[@i_471]], K_s[@i_471], x1_407[@i_471], x2_406[@i_471], X_s[@i_471], Y[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && ((x1 = x1_407[@i_471]) && ((x2 = x2_406[@i_471]) && ((x3 = X_s[@i_471]) && ((x4 = Y[@i_471]) && (x5 = exp(g, mult(x[j[@i_471]], y[@i_471]))))))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(x[@i_470], K_u_1099[@i_470], x1_413[@i_470], x2_412[@i_470], X[@i_470], @1_x_925[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && ((x1 = x1_413[@i_470]) && ((x2 = x2_412[@i_470]) && ((x3 = X[@i_470]) && ((x4 = exp(g, @1_x_925[@i_470])) && (x5 = exp(g, mult(@1_x_925[@i_470], x[@i_470]))))))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(x[@i_469], K_u_1095[@i_469], x1_419[@i_469], x2_418[@i_469], X[@i_469], @1_x_783[@i_246[@i_469]], r_414[@i_469]) && otheruses(r_414[@i_469]) && ((x1 = x1_419[@i_469]) && ((x2 = x2_418[@i_469]) && ((x3 = X[@i_469]) && ((x4 = exp(g, @1_x_783[@i_246[@i_469]])) && (x5 = exp(g, mult(@1_x_783[@i_246[@i_469]], x[@i_469]))))))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(x[@i_468], K_u_1095[@i_468], x1_425[@i_468], x2_424[@i_468], X[@i_468], @1_x_783[@i_246[@i_468]], r_420[@i_468]) && otheruses(r_420[@i_468]) && ((x1 = x1_425[@i_468]) && ((x2 = x2_424[@i_468]) && ((x3 = X[@i_468]) && ((x4 = exp(g, @1_x_783[@i_246[@i_468]])) && (x5 = exp(g, mult(@1_x_783[@i_246[@i_468]], x[@i_468]))))))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(x[@i_467], K_u_1096[@i_467], x1_431[@i_467], x2_430[@i_467], X[@i_467], @1_x_925[@i_241[@i_467]], r_426[@i_467]) && otheruses(r_426[@i_467]) && ((x1 = x1_431[@i_467]) && ((x2 = x2_430[@i_467]) && ((x3 = X[@i_467]) && ((x4 = exp(g, @1_x_925[@i_241[@i_467]])) && (x5 = exp(g, mult(@1_x_925[@i_241[@i_467]], x[@i_467]))))))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(x[@i_466], K_u_1096[@i_466], x1_437[@i_466], x2_436[@i_466], X[@i_466], @1_x_925[@i_241[@i_466]], r_432[@i_466]) && otheruses(r_432[@i_466]) && ((x1 = x1_437[@i_466]) && ((x2 = x2_436[@i_466]) && ((x3 = X[@i_466]) && ((x4 = exp(g, @1_x_925[@i_241[@i_466]])) && (x5 = exp(g, mult(@1_x_925[@i_241[@i_466]], x[@i_466]))))))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(x[@i_465], yp[@i_238[@i_465]], K_u_1097[@i_465], x1_443[@i_465], x2_442[@i_465], X[@i_465], Yp[@i_238[@i_465]], r_438[@i_465]) && otheruses(r_438[@i_465]) && ((x1 = x1_443[@i_465]) && ((x2 = x2_442[@i_465]) && ((x3 = X[@i_465]) && ((x4 = Yp[@i_238[@i_465]]) && (x5 = exp(g, mult(yp[@i_238[@i_465]], x[@i_465]))))))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(x[@i_464], yp[@i_238[@i_464]], K_u_1097[@i_464], x1_449[@i_464], x2_448[@i_464], X[@i_464], Yp[@i_238[@i_464]], r_444[@i_464]) && otheruses(r_444[@i_464]) && ((x1 = x1_449[@i_464]) && ((x2 = x2_448[@i_464]) && ((x3 = X[@i_464]) && ((x4 = Yp[@i_238[@i_464]]) && (x5 = exp(g, mult(yp[@i_238[@i_464]], x[@i_464]))))))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(x[@i_463], y[@i_236[@i_463]], K_u_1098[@i_463], x1_455[@i_463], x2_454[@i_463], X[@i_463], Y[@i_236[@i_463]], r_450[@i_463]) && otheruses(r_450[@i_463]) && ((x1 = x1_455[@i_463]) && ((x2 = x2_454[@i_463]) && ((x3 = X[@i_463]) && ((x4 = Y[@i_236[@i_463]]) && (x5 = exp(g, mult(y[@i_236[@i_463]], x[@i_463]))))))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(x[@i_462], y[@i_236[@i_462]], K_u_1098[@i_462], x1_461[@i_462], x2_460[@i_462], X[@i_462], Y[@i_236[@i_462]], r_456[@i_462]) && otheruses(r_456[@i_462]) && ((x1 = x1_461[@i_462]) && ((x2 = x2_460[@i_462]) && ((x3 = X[@i_462]) && ((x4 = Y[@i_236[@i_462]]) && (x5 = exp(g, mult(y[@i_236[@i_462]], x[@i_462]))))))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], Kp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = Kp[@i_99]))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_783[@i_246[@i_96]], K_u_1095[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(@1_x_783[@i_246[@i_96]], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_925[@i_241[@i_96]], K_u_1096[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(@1_x_925[@i_241[@i_96]], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], yp[@i_238[@i_96]], K_u_1097[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(yp[@i_238[@i_96]], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], y[@i_236[@i_96]], K_u_1098[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(y[@i_236[@i_96]], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_925[@i_96], K_u_1099[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(@1_x_925[@i_96], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of binder Kp yields

Game 31 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = exp(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_x_783[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_x_783[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = exp(g, @1_x_783[@i_246]) in
    let K_u_1095: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_783[@i_246]) = x14[@i_120]) && (exp(g, mult(@1_x_783[@i_246], x)) = x15[@i_120]))))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      find [unique] @i_552 <= qH0 suchthat defined(x1[@i_552], x2[@i_552], x3[@i_552], x4[@i_552], x5[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && ((x1_425 = x1[@i_552]) && ((x2_424 = x2[@i_552]) && ((X = x3[@i_552]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_552]) && (exp(g, mult(@1_x_783[@i_246], x)) = x5[@i_552]))))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_552]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_420);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_419: host = U in
      let x2_418: host = S in
      find [unique] @i_539 <= qH0 suchthat defined(x1[@i_539], x2[@i_539], x3[@i_539], x4[@i_539], x5[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && ((x1_419 = x1[@i_539]) && ((x2_418 = x2[@i_539]) && ((X = x3[@i_539]) && ((exp(g, @1_x_783[@i_246]) = x4[@i_539]) && (exp(g, mult(@1_x_783[@i_246], x)) = x5[@i_539]))))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_539]);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_414);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @1_x_925[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @1_x_925[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = exp(g, @1_x_925[@i_241]) in
    let K_u_1096: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((exp(g, @1_x_925[@i_241]) = x14[@i_120]) && (exp(g, mult(@1_x_925[@i_241], x)) = x15[@i_120]))))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      find [unique] @i_578 <= qH0 suchthat defined(x1[@i_578], x2[@i_578], x3[@i_578], x4[@i_578], x5[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && ((x1_437 = x1[@i_578]) && ((x2_436 = x2[@i_578]) && ((X = x3[@i_578]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_578]) && (exp(g, mult(@1_x_925[@i_241], x)) = x5[@i_578]))))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_578]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_432);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_431: host = U in
      let x2_430: host = S in
      find [unique] @i_565 <= qH0 suchthat defined(x1[@i_565], x2[@i_565], x3[@i_565], x4[@i_565], x5[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && ((x1_431 = x1[@i_565]) && ((x2_430 = x2[@i_565]) && ((X = x3[@i_565]) && ((exp(g, @1_x_925[@i_241]) = x4[@i_565]) && (exp(g, mult(@1_x_925[@i_241], x)) = x5[@i_565]))))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_565]);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_426);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u_1097: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && (exp(g, mult(yp[@i_238], x)) = x15[@i_120]))))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      find [unique] @i_604 <= qH0 suchthat defined(x1[@i_604], x2[@i_604], x3[@i_604], x4[@i_604], x5[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && ((x1_449 = x1[@i_604]) && ((x2_448 = x2[@i_604]) && ((X = x3[@i_604]) && ((Yp[@i_238] = x4[@i_604]) && (exp(g, mult(yp[@i_238], x)) = x5[@i_604]))))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_604]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_444);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_443: host = U in
      let x2_442: host = S in
      find [unique] @i_591 <= qH0 suchthat defined(x1[@i_591], x2[@i_591], x3[@i_591], x4[@i_591], x5[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && ((x1_443 = x1[@i_591]) && ((x2_442 = x2[@i_591]) && ((X = x3[@i_591]) && ((Yp[@i_238] = x4[@i_591]) && (exp(g, mult(yp[@i_238], x)) = x5[@i_591]))))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_591]);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_438);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u_1098: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && (exp(g, mult(y[@i_236], x)) = x15[@i_120]))))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      find [unique] @i_630 <= qH0 suchthat defined(x1[@i_630], x2[@i_630], x3[@i_630], x4[@i_630], x5[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && ((x1_461 = x1[@i_630]) && ((x2_460 = x2[@i_630]) && ((X = x3[@i_630]) && ((Y[@i_236] = x4[@i_630]) && (exp(g, mult(y[@i_236], x)) = x5[@i_630]))))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_630]);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind  suchthat defined(j[@i_236], r_396[@i_236]) && otheruses(r_396[@i_236]) && (!_41 = j[@i_236]) then
      (
        let sk_u: hash0 = r_396[@i_236] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_396[@i_236]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_456);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_455: host = U in
      let x2_454: host = S in
      find [unique] @i_617 <= qH0 suchthat defined(x1[@i_617], x2[@i_617], x3[@i_617], x4[@i_617], x5[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && ((x1_455 = x1[@i_617]) && ((x2_454 = x2[@i_617]) && ((X = x3[@i_617]) && ((Y[@i_236] = x4[@i_617]) && (exp(g, mult(y[@i_236], x)) = x5[@i_617]))))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_617]);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_450);
        out(c6[!_41], r1_90)
  )
  else
    new @1_x_925: exponent;
    let @2_r4_172: G = cst_G in
    let Y_u: G = exp(g, @1_x_925) in
    let K_u_1099: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = exp(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && (exp(g, mult(x[j], y)) = x15[@i_115]))))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      find [unique] @i_500 <= qH0 suchthat defined(x1[@i_500], x2[@i_500], x3[@i_500], x4[@i_500], x5[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && ((x1_401 = x1[@i_500]) && ((x2_400 = x2[@i_500]) && ((X_s = x3[@i_500]) && ((Y = x4[@i_500]) && (exp(g, mult(x[j], y)) = x5[@i_500]))))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_500])
      )
      orfind  suchthat defined(@i_236[j], r_450[j]) && otheruses(r_450[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      orfind  suchthat defined(@i_236[j], r_456[j]) && otheruses(r_456[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_456[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_456[j])
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_396)
    )
    orfind  suchthat defined(x[j], y[@i_236[j]], K_u_1098[j], @i_236[j], r1_90[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && (exp(g, mult(x[j], y)) = x5[@i_513]))))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_x_783[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_x_783[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_783[@i_222]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @1_x_925[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @1_x_925[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((exp(g, @1_x_925[@i_217]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = exp(g, xp) in
  new yp: exponent;
  let Yp: G = exp(g, yp) in
  let Kp: G = cst_G in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_x_783[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_x_783[@i_198]) && ((@2_x = exp(g, @1_x_783[@i_198])) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@1_x_925[@i_193], Ystar_u[@i_193], @2_r4_172[@i_193]) && otheruses(Ystar_u[@i_193] -> @1_x_925[@i_193]) && ((@2_x = exp(g, @1_x_925[@i_193])) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_x_783[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_x_783[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], exp(g, @1_x_783[@i_186]))
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @1_x_925[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @1_x_925[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], exp(g, @1_x_925[@i_181]))
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_x_783: exponent;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], exp(g, @1_x_783))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(yp[@i_473], xp[@i_473], Kp[@i_473], x1_395[@i_473], x2_394[@i_473], Xp[@i_473], Yp[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && ((x1 = x1_395[@i_473]) && ((x2 = x2_394[@i_473]) && ((x3 = Xp[@i_473]) && ((x4 = Yp[@i_473]) && (x5 = exp(g, mult(xp[@i_473], yp[@i_473]))))))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(y[@i_472], x[j[@i_472]], K_s[@i_472], x1_401[@i_472], x2_400[@i_472], X_s[@i_472], Y[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && ((x1 = x1_401[@i_472]) && ((x2 = x2_400[@i_472]) && ((x3 = X_s[@i_472]) && ((x4 = Y[@i_472]) && (x5 = exp(g, mult(x[j[@i_472]], y[@i_472]))))))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(y[@i_471], x[j[@i_471]], K_s[@i_471], x1_407[@i_471], x2_406[@i_471], X_s[@i_471], Y[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && ((x1 = x1_407[@i_471]) && ((x2 = x2_406[@i_471]) && ((x3 = X_s[@i_471]) && ((x4 = Y[@i_471]) && (x5 = exp(g, mult(x[j[@i_471]], y[@i_471]))))))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(x[@i_470], K_u_1099[@i_470], x1_413[@i_470], x2_412[@i_470], X[@i_470], @1_x_925[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && ((x1 = x1_413[@i_470]) && ((x2 = x2_412[@i_470]) && ((x3 = X[@i_470]) && ((x4 = exp(g, @1_x_925[@i_470])) && (x5 = exp(g, mult(@1_x_925[@i_470], x[@i_470]))))))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(x[@i_469], K_u_1095[@i_469], x1_419[@i_469], x2_418[@i_469], X[@i_469], @1_x_783[@i_246[@i_469]], r_414[@i_469]) && otheruses(r_414[@i_469]) && ((x1 = x1_419[@i_469]) && ((x2 = x2_418[@i_469]) && ((x3 = X[@i_469]) && ((x4 = exp(g, @1_x_783[@i_246[@i_469]])) && (x5 = exp(g, mult(@1_x_783[@i_246[@i_469]], x[@i_469]))))))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(x[@i_468], K_u_1095[@i_468], x1_425[@i_468], x2_424[@i_468], X[@i_468], @1_x_783[@i_246[@i_468]], r_420[@i_468]) && otheruses(r_420[@i_468]) && ((x1 = x1_425[@i_468]) && ((x2 = x2_424[@i_468]) && ((x3 = X[@i_468]) && ((x4 = exp(g, @1_x_783[@i_246[@i_468]])) && (x5 = exp(g, mult(@1_x_783[@i_246[@i_468]], x[@i_468]))))))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(x[@i_467], K_u_1096[@i_467], x1_431[@i_467], x2_430[@i_467], X[@i_467], @1_x_925[@i_241[@i_467]], r_426[@i_467]) && otheruses(r_426[@i_467]) && ((x1 = x1_431[@i_467]) && ((x2 = x2_430[@i_467]) && ((x3 = X[@i_467]) && ((x4 = exp(g, @1_x_925[@i_241[@i_467]])) && (x5 = exp(g, mult(@1_x_925[@i_241[@i_467]], x[@i_467]))))))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(x[@i_466], K_u_1096[@i_466], x1_437[@i_466], x2_436[@i_466], X[@i_466], @1_x_925[@i_241[@i_466]], r_432[@i_466]) && otheruses(r_432[@i_466]) && ((x1 = x1_437[@i_466]) && ((x2 = x2_436[@i_466]) && ((x3 = X[@i_466]) && ((x4 = exp(g, @1_x_925[@i_241[@i_466]])) && (x5 = exp(g, mult(@1_x_925[@i_241[@i_466]], x[@i_466]))))))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(x[@i_465], yp[@i_238[@i_465]], K_u_1097[@i_465], x1_443[@i_465], x2_442[@i_465], X[@i_465], Yp[@i_238[@i_465]], r_438[@i_465]) && otheruses(r_438[@i_465]) && ((x1 = x1_443[@i_465]) && ((x2 = x2_442[@i_465]) && ((x3 = X[@i_465]) && ((x4 = Yp[@i_238[@i_465]]) && (x5 = exp(g, mult(yp[@i_238[@i_465]], x[@i_465]))))))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(x[@i_464], yp[@i_238[@i_464]], K_u_1097[@i_464], x1_449[@i_464], x2_448[@i_464], X[@i_464], Yp[@i_238[@i_464]], r_444[@i_464]) && otheruses(r_444[@i_464]) && ((x1 = x1_449[@i_464]) && ((x2 = x2_448[@i_464]) && ((x3 = X[@i_464]) && ((x4 = Yp[@i_238[@i_464]]) && (x5 = exp(g, mult(yp[@i_238[@i_464]], x[@i_464]))))))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(x[@i_463], y[@i_236[@i_463]], K_u_1098[@i_463], x1_455[@i_463], x2_454[@i_463], X[@i_463], Y[@i_236[@i_463]], r_450[@i_463]) && otheruses(r_450[@i_463]) && ((x1 = x1_455[@i_463]) && ((x2 = x2_454[@i_463]) && ((x3 = X[@i_463]) && ((x4 = Y[@i_236[@i_463]]) && (x5 = exp(g, mult(y[@i_236[@i_463]], x[@i_463]))))))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(x[@i_462], y[@i_236[@i_462]], K_u_1098[@i_462], x1_461[@i_462], x2_460[@i_462], X[@i_462], Y[@i_236[@i_462]], r_456[@i_462]) && otheruses(r_456[@i_462]) && ((x1 = x1_461[@i_462]) && ((x2 = x2_460[@i_462]) && ((x3 = X[@i_462]) && ((x4 = Y[@i_236[@i_462]]) && (x5 = exp(g, mult(y[@i_236[@i_462]], x[@i_462]))))))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(yp[@i_99], xp[@i_99], Kp[@i_99], x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && (x15 = exp(g, mult(xp[@i_99], yp[@i_99]))))))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_783[@i_246[@i_96]], K_u_1095[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(@1_x_783[@i_246[@i_96]], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_925[@i_241[@i_96]], K_u_1096[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(@1_x_925[@i_241[@i_96]], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], yp[@i_238[@i_96]], K_u_1097[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(yp[@i_238[@i_96]], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], y[@i_236[@i_96]], K_u_1098[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(y[@i_236[@i_96]], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_925[@i_96], K_u_1099[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && (x15 = exp(g, mult(@1_x_925[@i_96], x[@i_96]))))))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying equivalence
equiv ! !_11 <= @1_na new @1_a: exponent; (
  @1_OA() := exp(g, @1_a),
  @1_Oa() [3] := @1_a,
  ! !_12 <= @1_naCDH @1_OCDHa(@1_m_15: G, @1_j_16 <= @1_nb) := (@1_m_15 = exp(g, mult(@1_b[@1_j_16], @1_a)))), ! !_13 <= @1_nb new @1_b: exponent; (
  @1_OB() := exp(g, @1_b),
  @1_Ob() [3] := @1_b,
  ! !_14 <= @1_nbCDH @1_OCDHb(@1_m_17: G, @1_j_18 <= @1_na) := (@1_m_17 = exp(g, mult(@1_a[@1_j_18], @1_b))))
<=(set(proba <= (#@1_OCDHa + #@1_OCDHb) * max(1., 74. / 10. * #@1_Oa) * max(1., 74. / 10. * #@1_Ob) * pCDH(time + (@1_na + @1_nb + #@1_OCDHa + #@1_OCDHb) * time(exp))))=>
      ! !_19 <= @1_na new @1_a: exponent; (
  @1_OA() := @1_exp'(g, @1_a),
  @1_Oa() [3] := let @1_ka: bitstring = @1_mark in @1_a,
  ! !_20 <= @1_naCDH @1_OCDHa(@1_m_23: G, @1_j_24 <= @1_nb) := find @1_u_25 <= @1_nb suchthat defined(@1_kb[@1_u_25], @1_b[@1_u_25]) && (@1_b[@1_j_24] = @1_b[@1_u_25]) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else if defined(@1_ka) then (@1_m_23 = @1_exp'(g, mult(@1_b[@1_j_24], @1_a))) else false), ! !_21 <= @1_nb new @1_b: exponent; (
  @1_OB() := @1_exp'(g, @1_b),
  @1_Ob() [3] := let @1_kb: bitstring = @1_mark in @1_b,
  ! !_22 <= @1_nbCDH @1_OCDHb(@1_m_26: G, @1_j_27 <= @1_na) := find @1_u_28 <= @1_na suchthat defined(@1_ka[@1_u_28], @1_a[@1_u_28]) && (@1_a[@1_j_27] = @1_a[@1_u_28]) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else if defined(@1_kb) then (@1_m_26 = @1_exp'(g, mult(@1_a[@1_j_27], @1_b))) else false)
with x, @1_x_925, yp, y, xp, @1_x_783 [Excluding set(dist 31->32.1, proba <= 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31))) U set(dist 31->32.2, proba <= NP * qD / |exponent|) U set(dist 31->32.3, proba <= NU * qD / |exponent|) U set(dist 31->32.4, proba <= NU * NP / |exponent|) U set(dist 31->32.5, proba <= 0.5 * qD * qD / |exponent|) U set(dist 31->32.6, proba <= 0.5 * NU * NU / |exponent|)] yields

Game 32 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_x_783[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_x_783[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = @1_exp'(g, @1_x_783[@i_246]) in
    let K_u_1095: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && find  else find  else ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((@1_exp'(g, @1_x_783[@i_246]) = x14[@i_120]) && false)))) then
    (
      let x1_425: host = U in
      let x2_424: host = S in
      find [unique] @i_552 <= qH0 suchthat defined(x1[@i_552], x2[@i_552], x3[@i_552], x4[@i_552], x5[@i_552], r_384[@i_552]) && otheruses(r_384[@i_552]) && find  else find  else ((x1_425 = x1[@i_552]) && ((x2_424 = x2[@i_552]) && ((X = x3[@i_552]) && ((@1_exp'(g, @1_x_783[@i_246]) = x4[@i_552]) && false)))) then
      (
        let sk_u: hash0 = r_384[@i_552] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_552]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_420: hash0;
        let sk_u: hash0 = r_420 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_420);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_419: host = U in
      let x2_418: host = S in
      find [unique] @i_539 <= qH0 suchthat defined(x1[@i_539], x2[@i_539], x3[@i_539], x4[@i_539], x5[@i_539], r_384[@i_539]) && otheruses(r_384[@i_539]) && find  else find  else ((x1_419 = x1[@i_539]) && ((x2_418 = x2[@i_539]) && ((X = x3[@i_539]) && ((@1_exp'(g, @1_x_783[@i_246]) = x4[@i_539]) && false)))) then
      (
        let sk_u: hash0 = r_384[@i_539] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_539]);
        out(c6[!_41], r1_90)
      )
      else
        new r_414: hash0;
        let sk_u: hash0 = r_414 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_414);
        out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @1_x_925[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @1_x_925[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = @1_exp'(g, @1_x_925[@i_241]) in
    let K_u_1096: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && find  else find  else ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((@1_exp'(g, @1_x_925[@i_241]) = x14[@i_120]) && false)))) then
    (
      let x1_437: host = U in
      let x2_436: host = S in
      find [unique] @i_578 <= qH0 suchthat defined(x1[@i_578], x2[@i_578], x3[@i_578], x4[@i_578], x5[@i_578], r_384[@i_578]) && otheruses(r_384[@i_578]) && find  else find  else ((x1_437 = x1[@i_578]) && ((x2_436 = x2[@i_578]) && ((X = x3[@i_578]) && ((@1_exp'(g, @1_x_925[@i_241]) = x4[@i_578]) && false)))) then
      (
        let sk_u: hash0 = r_384[@i_578] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_578]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_432: hash0;
        let sk_u: hash0 = r_432 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_432);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_431: host = U in
      let x2_430: host = S in
      find [unique] @i_565 <= qH0 suchthat defined(x1[@i_565], x2[@i_565], x3[@i_565], x4[@i_565], x5[@i_565], r_384[@i_565]) && otheruses(r_384[@i_565]) && find  else find  else ((x1_431 = x1[@i_565]) && ((x2_430 = x2[@i_565]) && ((X = x3[@i_565]) && ((@1_exp'(g, @1_x_925[@i_241]) = x4[@i_565]) && false)))) then
      (
        let sk_u: hash0 = r_384[@i_565] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_565]);
        out(c6[!_41], r1_90)
      )
      else
        new r_426: hash0;
        let sk_u: hash0 = r_426 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_426);
        out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238], yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u_1097: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && find  else find  else ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Yp[@i_238] = x14[@i_120]) && false)))) then
    (
      let x1_449: host = U in
      let x2_448: host = S in
      find [unique] @i_604 <= qH0 suchthat defined(x1[@i_604], x2[@i_604], x3[@i_604], x4[@i_604], x5[@i_604], r_384[@i_604]) && otheruses(r_384[@i_604]) && find  else find  else ((x1_449 = x1[@i_604]) && ((x2_448 = x2[@i_604]) && ((X = x3[@i_604]) && ((Yp[@i_238] = x4[@i_604]) && false)))) then
      (
        let sk_u: hash0 = r_384[@i_604] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_604]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_444: hash0;
        let sk_u: hash0 = r_444 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_444);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_443: host = U in
      let x2_442: host = S in
      find [unique] @i_591 <= qH0 suchthat defined(x1[@i_591], x2[@i_591], x3[@i_591], x4[@i_591], x5[@i_591], r_384[@i_591]) && otheruses(r_384[@i_591]) && find  else find  else ((x1_443 = x1[@i_591]) && ((x2_442 = x2[@i_591]) && ((X = x3[@i_591]) && ((Yp[@i_238] = x4[@i_591]) && false)))) then
      (
        let sk_u: hash0 = r_384[@i_591] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_591]);
        out(c6[!_41], r1_90)
      )
      else
        new r_438: hash0;
        let sk_u: hash0 = r_438 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_438);
        out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236], y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u_1098: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    find [unique] @i_120 <= qH1 suchthat defined(x11[@i_120], x12[@i_120], x13[@i_120], x14[@i_120], x15[@i_120], r1_66[@i_120]) && otheruses(r1_66[@i_120]) && find  else find  else ((x1_95 = x11[@i_120]) && ((x2_94 = x12[@i_120]) && ((X = x13[@i_120]) && ((Y[@i_236] = x14[@i_120]) && false)))) then
    (
      let x1_461: host = U in
      let x2_460: host = S in
      find [unique] @i_630 <= qH0 suchthat defined(x1[@i_630], x2[@i_630], x3[@i_630], x4[@i_630], x5[@i_630], r_384[@i_630]) && otheruses(r_384[@i_630]) && find  else find  else ((x1_461 = x1[@i_630]) && ((x2_460 = x2[@i_630]) && ((X = x3[@i_630]) && ((Y[@i_236] = x4[@i_630]) && false)))) then
      (
        let sk_u: hash0 = r_384[@i_630] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_384[@i_630]);
        out(c6[!_41], r1_66[@i_120])
      )
      orfind  suchthat defined(j[@i_236], r_396[@i_236]) && otheruses(r_396[@i_236]) && (!_41 = j[@i_236]) then
      (
        let sk_u: hash0 = r_396[@i_236] in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_396[@i_236]);
        out(c6[!_41], r1_66[@i_120])
      )
      else
        new r_456: hash0;
        let sk_u: hash0 = r_456 in
        event termU(U, X, S, Ystar_u, r1_66[@i_120], r_456);
        out(c6[!_41], r1_66[@i_120])
    )
    else
      let x1_455: host = U in
      let x2_454: host = S in
      find [unique] @i_617 <= qH0 suchthat defined(x1[@i_617], x2[@i_617], x3[@i_617], x4[@i_617], x5[@i_617], r_384[@i_617]) && otheruses(r_384[@i_617]) && find  else find  else ((x1_455 = x1[@i_617]) && ((x2_454 = x2[@i_617]) && ((X = x3[@i_617]) && ((Y[@i_236] = x4[@i_617]) && false)))) then
      (
        let sk_u: hash0 = r_384[@i_617] in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_384[@i_617]);
        out(c6[!_41], r1_90)
      )
      else
        new r_450: hash0;
        let sk_u: hash0 = r_450 in
        new r1_90: hash1;
        event termU(U, X, S, Ystar_u, r1_90, r_450);
        out(c6[!_41], r1_90)
  )
  else
    new @1_x_925: exponent;
    let @2_r4_172: G = cst_G in
    let Y_u: G = @1_exp'(g, @1_x_925) in
    let K_u_1099: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j], x[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    let x1_89: host = U in
    let x2_88: host = S in
    find [unique] @i_115 <= qH1 suchthat defined(x11[@i_115], x12[@i_115], x13[@i_115], x14[@i_115], x15[@i_115], r1_66[@i_115]) && otheruses(r1_66[@i_115]) && find  else find  else ((x1_89 = x11[@i_115]) && ((x2_88 = x12[@i_115]) && ((X_s = x13[@i_115]) && ((Y = x14[@i_115]) && false)))) then
    (
      if (auth_s = r1_66[@i_115]) then
      let x1_401: host = U in
      let x2_400: host = S in
      find [unique] @i_500 <= qH0 suchthat defined(x1[@i_500], x2[@i_500], x3[@i_500], x4[@i_500], x5[@i_500], r_384[@i_500]) && otheruses(r_384[@i_500]) && find  else find  else ((x1_401 = x1[@i_500]) && ((x2_400 = x2[@i_500]) && ((X_s = x3[@i_500]) && ((Y = x4[@i_500]) && false)))) then
      (
        let sk_s: hash0 = r_384[@i_500] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_500])
      )
      orfind  suchthat defined(@i_236[j], r_450[j]) && otheruses(r_450[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      orfind  suchthat defined(@i_236[j], r_456[j]) && otheruses(r_456[j]) && (!_42 = @i_236[j]) then
      (
        let sk_s: hash0 = r_456[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_456[j])
      )
      else
        new r_396: hash0;
        let sk_s: hash0 = r_396 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_396)
    )
    orfind  suchthat defined(x[j], y[@i_236[j]], K_u_1098[j], @i_236[j], r1_90[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    (
      if (auth_s = r1_90[j]) then
      let x1_407: host = U in
      let x2_406: host = S in
      find [unique] @i_513 <= qH0 suchthat defined(x1[@i_513], x2[@i_513], x3[@i_513], x4[@i_513], x5[@i_513], r_384[@i_513]) && otheruses(r_384[@i_513]) && find  else find  else ((x1_407 = x1[@i_513]) && ((x2_406 = x2[@i_513]) && ((X_s = x3[@i_513]) && ((Y = x4[@i_513]) && false)))) then
      (
        let sk_s: hash0 = r_384[@i_513] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_384[@i_513])
      )
      orfind  suchthat defined(r_450[j]) && otheruses(r_450[j]) then
      (
        let sk_s: hash0 = r_450[j] in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
      )
      else
        new r_402: hash0;
        let sk_s: hash0 = r_402 in
        event termS(U, X_s, S, @2_r2_169, auth_s, r_402)
    )
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_x_783[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_x_783[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_exp'(g, @1_x_783[@i_222]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @1_x_925[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @1_x_925[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_exp'(g, @1_x_925[@i_217]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  let Kp: G = cst_G in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_x_783[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_x_783[@i_198]) && ((@2_x = @1_exp'(g, @1_x_783[@i_198])) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@1_x_925[@i_193], Ystar_u[@i_193], @2_r4_172[@i_193]) && otheruses(Ystar_u[@i_193] -> @1_x_925[@i_193]) && ((@2_x = @1_exp'(g, @1_x_925[@i_193])) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_x_783[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_x_783[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_exp'(g, @1_x_783[@i_186]))
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @1_x_925[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @1_x_925[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], @1_exp'(g, @1_x_925[@i_181]))
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_x_783: exponent;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_exp'(g, @1_x_783))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  orfind @i_473 <= NP suchthat defined(yp[@i_473], xp[@i_473], Kp[@i_473], x1_395[@i_473], x2_394[@i_473], Xp[@i_473], Yp[@i_473], r_390[@i_473]) && otheruses(r_390[@i_473]) && find  else find  else ((x1 = x1_395[@i_473]) && ((x2 = x2_394[@i_473]) && ((x3 = Xp[@i_473]) && ((x4 = Yp[@i_473]) && false)))) then
    out(c20[!_46], r_390[@i_473])
  orfind @i_472 <= NS suchthat defined(y[@i_472], x[j[@i_472]], K_s[@i_472], x1_401[@i_472], x2_400[@i_472], X_s[@i_472], Y[@i_472], r_396[@i_472]) && otheruses(r_396[@i_472]) && find  else find  else ((x1 = x1_401[@i_472]) && ((x2 = x2_400[@i_472]) && ((x3 = X_s[@i_472]) && ((x4 = Y[@i_472]) && false)))) then
    out(c20[!_46], r_396[@i_472])
  orfind @i_471 <= NS suchthat defined(y[@i_471], x[j[@i_471]], K_s[@i_471], x1_407[@i_471], x2_406[@i_471], X_s[@i_471], Y[@i_471], r_402[@i_471]) && otheruses(r_402[@i_471]) && find  else find  else ((x1 = x1_407[@i_471]) && ((x2 = x2_406[@i_471]) && ((x3 = X_s[@i_471]) && ((x4 = Y[@i_471]) && false)))) then
    out(c20[!_46], r_402[@i_471])
  orfind @i_470 <= NU suchthat defined(x[@i_470], K_u_1099[@i_470], x1_413[@i_470], x2_412[@i_470], X[@i_470], @1_x_925[@i_470], r_408[@i_470]) && otheruses(r_408[@i_470]) && find  else find  else ((x1 = x1_413[@i_470]) && ((x2 = x2_412[@i_470]) && ((x3 = X[@i_470]) && ((x4 = @1_exp'(g, @1_x_925[@i_470])) && false)))) then
    out(c20[!_46], r_408[@i_470])
  orfind @i_469 <= NU suchthat defined(x[@i_469], K_u_1095[@i_469], x1_419[@i_469], x2_418[@i_469], X[@i_469], @1_x_783[@i_246[@i_469]], r_414[@i_469]) && otheruses(r_414[@i_469]) && find  else find  else ((x1 = x1_419[@i_469]) && ((x2 = x2_418[@i_469]) && ((x3 = X[@i_469]) && ((x4 = @1_exp'(g, @1_x_783[@i_246[@i_469]])) && false)))) then
    out(c20[!_46], r_414[@i_469])
  orfind @i_468 <= NU suchthat defined(x[@i_468], K_u_1095[@i_468], x1_425[@i_468], x2_424[@i_468], X[@i_468], @1_x_783[@i_246[@i_468]], r_420[@i_468]) && otheruses(r_420[@i_468]) && find  else find  else ((x1 = x1_425[@i_468]) && ((x2 = x2_424[@i_468]) && ((x3 = X[@i_468]) && ((x4 = @1_exp'(g, @1_x_783[@i_246[@i_468]])) && false)))) then
    out(c20[!_46], r_420[@i_468])
  orfind @i_467 <= NU suchthat defined(x[@i_467], K_u_1096[@i_467], x1_431[@i_467], x2_430[@i_467], X[@i_467], @1_x_925[@i_241[@i_467]], r_426[@i_467]) && otheruses(r_426[@i_467]) && find  else find  else ((x1 = x1_431[@i_467]) && ((x2 = x2_430[@i_467]) && ((x3 = X[@i_467]) && ((x4 = @1_exp'(g, @1_x_925[@i_241[@i_467]])) && false)))) then
    out(c20[!_46], r_426[@i_467])
  orfind @i_466 <= NU suchthat defined(x[@i_466], K_u_1096[@i_466], x1_437[@i_466], x2_436[@i_466], X[@i_466], @1_x_925[@i_241[@i_466]], r_432[@i_466]) && otheruses(r_432[@i_466]) && find  else find  else ((x1 = x1_437[@i_466]) && ((x2 = x2_436[@i_466]) && ((x3 = X[@i_466]) && ((x4 = @1_exp'(g, @1_x_925[@i_241[@i_466]])) && false)))) then
    out(c20[!_46], r_432[@i_466])
  orfind @i_465 <= NU suchthat defined(x[@i_465], yp[@i_238[@i_465]], K_u_1097[@i_465], x1_443[@i_465], x2_442[@i_465], X[@i_465], Yp[@i_238[@i_465]], r_438[@i_465]) && otheruses(r_438[@i_465]) && find  else find  else ((x1 = x1_443[@i_465]) && ((x2 = x2_442[@i_465]) && ((x3 = X[@i_465]) && ((x4 = Yp[@i_238[@i_465]]) && false)))) then
    out(c20[!_46], r_438[@i_465])
  orfind @i_464 <= NU suchthat defined(x[@i_464], yp[@i_238[@i_464]], K_u_1097[@i_464], x1_449[@i_464], x2_448[@i_464], X[@i_464], Yp[@i_238[@i_464]], r_444[@i_464]) && otheruses(r_444[@i_464]) && find  else find  else ((x1 = x1_449[@i_464]) && ((x2 = x2_448[@i_464]) && ((x3 = X[@i_464]) && ((x4 = Yp[@i_238[@i_464]]) && false)))) then
    out(c20[!_46], r_444[@i_464])
  orfind @i_463 <= NU suchthat defined(x[@i_463], y[@i_236[@i_463]], K_u_1098[@i_463], x1_455[@i_463], x2_454[@i_463], X[@i_463], Y[@i_236[@i_463]], r_450[@i_463]) && otheruses(r_450[@i_463]) && find  else find  else ((x1 = x1_455[@i_463]) && ((x2 = x2_454[@i_463]) && ((x3 = X[@i_463]) && ((x4 = Y[@i_236[@i_463]]) && false)))) then
    out(c20[!_46], r_450[@i_463])
  orfind @i_462 <= NU suchthat defined(x[@i_462], y[@i_236[@i_462]], K_u_1098[@i_462], x1_461[@i_462], x2_460[@i_462], X[@i_462], Y[@i_236[@i_462]], r_456[@i_462]) && otheruses(r_456[@i_462]) && find  else find  else ((x1 = x1_461[@i_462]) && ((x2 = x2_460[@i_462]) && ((x3 = X[@i_462]) && ((x4 = Y[@i_236[@i_462]]) && false)))) then
    out(c20[!_46], r_456[@i_462])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  orfind @i_99 <= NP suchthat defined(yp[@i_99], xp[@i_99], Kp[@i_99], x1_77[@i_99], x2_76[@i_99], Xp[@i_99], Yp[@i_99], r1_72[@i_99]) && otheruses(r1_72[@i_99]) && find  else find  else ((x11 = x1_77[@i_99]) && ((x12 = x2_76[@i_99]) && ((x13 = Xp[@i_99]) && ((x14 = Yp[@i_99]) && false)))) then
    out(c21[!_47], r1_72[@i_99])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_783[@i_246[@i_96]], K_u_1095[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && find  else find  else ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && false)))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_925[@i_241[@i_96]], K_u_1096[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && find  else find  else ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && false)))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], yp[@i_238[@i_96]], K_u_1097[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && find  else find  else ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && false)))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], y[@i_236[@i_96]], K_u_1098[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && find  else find  else ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && false)))) then
    out(c21[!_47], r1_90[@i_96])
  orfind @i_96 <= NU suchthat defined(x[@i_96], @1_x_925[@i_96], K_u_1099[@i_96], x1_95[@i_96], x2_94[@i_96], X[@i_96], Y_u[@i_96], r1_90[@i_96]) && otheruses(r1_90[@i_96]) && find  else find  else ((x11 = x1_95[@i_96]) && ((x12 = x2_94[@i_96]) && ((x13 = X[@i_96]) && ((x14 = Y_u[@i_96]) && false)))) then
    out(c21[!_47], r1_90[@i_96])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying simplify yields

Game 33 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_x_783[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_x_783[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = @1_exp'(g, @1_x_783[@i_246]) in
    let K_u_1095: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    let x1_419: host = U in
    let x2_418: host = S in
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_90: hash1;
    event termU(U, X, S, Ystar_u, r1_90, r_414);
    out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @1_x_925[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @1_x_925[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = @1_exp'(g, @1_x_925[@i_241]) in
    let K_u_1096: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    let x1_431: host = U in
    let x2_430: host = S in
    new r_426: hash0;
    let sk_u: hash0 = r_426 in
    new r1_90: hash1;
    event termU(U, X, S, Ystar_u, r1_90, r_426);
    out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u_1097: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    let x1_443: host = U in
    let x2_442: host = S in
    new r_438: hash0;
    let sk_u: hash0 = r_438 in
    new r1_90: hash1;
    event termU(U, X, S, Ystar_u, r1_90, r_438);
    out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u_1098: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    let x1_455: host = U in
    let x2_454: host = S in
    new r_450: hash0;
    let sk_u: hash0 = r_450 in
    new r1_90: hash1;
    event termU(U, X, S, Ystar_u, r1_90, r_450);
    out(c6[!_41], r1_90)
  )
  else
    new @1_x_925: exponent;
    let @2_r4_172: G = cst_G in
    let Y_u: G = @1_exp'(g, @1_x_925) in
    let K_u_1099: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    let K_s: G = cst_G in
    let x1_89: host = U in
    let x2_88: host = S in
    if defined(@i_236[j], r1_90[j], r_450[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    if (auth_s = r1_90[j]) then
    let x1_407: host = U in
    let x2_406: host = S in
    if defined(r_450[j]) && otheruses(r_450[j]) then
    let sk_s: hash0 = r_450[j] in
    event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_x_783[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_x_783[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_exp'(g, @1_x_783[@i_222]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @1_x_925[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @1_x_925[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_exp'(g, @1_x_925[@i_217]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  let Kp: G = cst_G in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_x_783[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_x_783[@i_198]) && ((@2_x = @1_exp'(g, @1_x_783[@i_198])) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@1_x_925[@i_193], Ystar_u[@i_193], @2_r4_172[@i_193]) && otheruses(Ystar_u[@i_193] -> @1_x_925[@i_193]) && ((@2_x = @1_exp'(g, @1_x_925[@i_193])) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_x_783[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_x_783[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_exp'(g, @1_x_783[@i_186]))
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @1_x_925[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @1_x_925[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], @1_exp'(g, @1_x_925[@i_181]))
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_x_783: exponent;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_exp'(g, @1_x_783))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying move all binders yields

Game 34 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_x_783[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_x_783[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    let Y_u: G = @1_exp'(g, @1_x_783[@i_246]) in
    let K_u_1095: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    let x1_419: host = U in
    let x2_418: host = S in
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_90: hash1;
    event termU(U, X, S, Ystar_u, r1_90, r_414);
    out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @1_x_925[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @1_x_925[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    let Y_u: G = @1_exp'(g, @1_x_925[@i_241]) in
    let K_u_1096: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    let x1_431: host = U in
    let x2_430: host = S in
    new r_426: hash0;
    let sk_u: hash0 = r_426 in
    new r1_90: hash1;
    event termU(U, X, S, Ystar_u, r1_90, r_426);
    out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    let Y_u: G = Yp[@i_238] in
    let K_u_1097: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    let x1_443: host = U in
    let x2_442: host = S in
    new r_438: hash0;
    let sk_u: hash0 = r_438 in
    new r1_90: hash1;
    event termU(U, X, S, Ystar_u, r1_90, r_438);
    out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    let Y_u: G = Y[@i_236] in
    let K_u_1098: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    let x1_455: host = U in
    let x2_454: host = S in
    new r_450: hash0;
    let sk_u: hash0 = r_450 in
    new r1_90: hash1;
    event termU(U, X, S, Ystar_u, r1_90, r_450);
    out(c6[!_41], r1_90)
  )
  else
    new @1_x_925: exponent;
    let @2_r4_172: G = cst_G in
    let Y_u: G = @1_exp'(g, @1_x_925) in
    let K_u_1099: G = cst_G in
    let x1_95: host = U in
    let x2_94: host = S in
    new r1_90: hash1;
    let x1_413: host = U in
    let x2_412: host = S in
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_236[j], r1_90[j], r_450[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    if (auth_s = r1_90[j]) then
    if defined(r_450[j]) && otheruses(r_450[j]) then
    let sk_s: hash0 = r_450[j] in
    event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_x_783[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_x_783[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_exp'(g, @1_x_783[@i_222]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @1_x_925[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @1_x_925[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_exp'(g, @1_x_925[@i_217]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  let Kp: G = cst_G in
  new @2_r2_163: G;
  let x1_77: host = U in
  let x2_76: host = S in
  new r1_72: hash1;
  let x1_395: host = U in
  let x2_394: host = S in
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_x_783[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_x_783[@i_198]) && ((@2_x = @1_exp'(g, @1_x_783[@i_198])) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@1_x_925[@i_193], Ystar_u[@i_193], @2_r4_172[@i_193]) && otheruses(Ystar_u[@i_193] -> @1_x_925[@i_193]) && ((@2_x = @1_exp'(g, @1_x_925[@i_193])) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_x_783[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_x_783[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_exp'(g, @1_x_783[@i_186]))
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @1_x_925[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @1_x_925[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], @1_exp'(g, @1_x_925[@i_181]))
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_x_783: exponent;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_exp'(g, @1_x_783))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of useless yields

Game 35 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_x_783[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_x_783[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_90: hash1;
    event termU(U, X, S, Ystar_u, r1_90, r_414);
    out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @1_x_925[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @1_x_925[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    new r_426: hash0;
    let sk_u: hash0 = r_426 in
    new r1_90: hash1;
    event termU(U, X, S, Ystar_u, r1_90, r_426);
    out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    new r_438: hash0;
    let sk_u: hash0 = r_438 in
    new r1_90: hash1;
    event termU(U, X, S, Ystar_u, r1_90, r_438);
    out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    new r_450: hash0;
    let sk_u: hash0 = r_450 in
    new r1_90: hash1;
    event termU(U, X, S, Ystar_u, r1_90, r_450);
    out(c6[!_41], r1_90)
  )
  else
    new @1_x_925: exponent;
    let @2_r4_172: G = cst_G in
    new r1_90: hash1;
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_236[j], r1_90[j], r_450[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    if (auth_s = r1_90[j]) then
    if defined(r_450[j]) && otheruses(r_450[j]) then
    let sk_s: hash0 = r_450[j] in
    event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_x_783[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_x_783[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_exp'(g, @1_x_783[@i_222]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @1_x_925[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @1_x_925[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_exp'(g, @1_x_925[@i_217]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_x_783[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_x_783[@i_198]) && ((@2_x = @1_exp'(g, @1_x_783[@i_198])) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@1_x_925[@i_193], Ystar_u[@i_193], @2_r4_172[@i_193]) && otheruses(Ystar_u[@i_193] -> @1_x_925[@i_193]) && ((@2_x = @1_exp'(g, @1_x_925[@i_193])) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_x_783[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_x_783[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_exp'(g, @1_x_783[@i_186]))
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @1_x_925[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @1_x_925[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], @1_exp'(g, @1_x_925[@i_181]))
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_x_783: exponent;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_exp'(g, @1_x_783))
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


RESULT Proved event termS(x, X, y, Y, a, k) && termU(x, X, y, Y, a, k') ==> (k = k') excluding set(dist 3->4, proba <= 1. / |exponent| * NP + 4. * 1. / |exponent| * NS + 2. * NU * NP / |exponent| + 3. * NS * NP / |exponent| + qH1 * NP / |exponent| + 2. * NS / |hash1| + NP * NP / |exponent| + 0.5 * NS * NS / |exponent| + 0.5 * NU * NU / |exponent|) U set(event Auth in game 10) U set(dist 10->11, proba <= (NP * NP + 2. * qE * NP + 2. * NU * NP + 4. * NS * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 4. * NS * qE + 2. * qD * qE + NU * NU + 4. * NS * NU + 2. * qD * NU + 4. * NS * NS + 4. * qD * NS + qD * qD + -1. * NP + -1. * qE + -1. * NU + -2. * NS + -1. * qD) / |G|) U set(dist 11->12, proba <= 2. * NS * NP / |exponent| + qE * NP / |exponent| + NU * NP / |exponent| + qD * NP / |exponent| + NP * NS / |exponent| + qE * NS / |exponent| + NU * NS / |exponent| + NS * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G| + 0.5 * NS * NS / |G| + NS * NP / |G| + NS * qE / |G|) U set(event Encrypt in game 15) U set(dist 16->17, proba <= 1. / |exponent| * NP + 15. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + 10. * NU * NP / |exponent| + 2. * NS * NP / |exponent| + qH0 * NP / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + 8.5 * NU * NU / |G| + 3. * NS * NU / |G| + 2. * NP * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NP * qD / |G| + qD * NP / |exponent| + NU * qH1 / |hash1| + qD * NU / |G| + 0.5 * qD * qD / |G|) U set(dist 23->24, proba <= 4. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|) U set(dist 31->32.1, proba <= 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31))) U set(dist 31->32.2, proba <= NP * qD / |exponent|) U set(dist 31->32.3, proba <= NU * qD / |exponent|) U set(dist 31->32.4, proba <= NU * NP / |exponent|) U set(dist 31->32.5, proba <= 0.5 * qD * qD / |exponent|) U set(dist 31->32.6, proba <= 0.5 * NU * NU / |exponent|)
RESULT Proved event termS(x, X, y, Y, a, k) && termU(x, X, y, Y, a, k') ==> (k = k') excluding set(dist 3->4, proba <= 1. / |exponent| * NP + 4. * 1. / |exponent| * NS + 2. * NU * NP / |exponent| + 3. * NS * NP / |exponent| + qH1 * NP / |exponent| + 2. * NS / |hash1| + NP * NP / |exponent| + 0.5 * NS * NS / |exponent| + 0.5 * NU * NU / |exponent|) U set(dist 10->11, proba <= (NP * NP + 2. * qE * NP + 2. * NU * NP + 4. * NS * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 4. * NS * qE + 2. * qD * qE + NU * NU + 4. * NS * NU + 2. * qD * NU + 4. * NS * NS + 4. * qD * NS + qD * qD + -1. * NP + -1. * qE + -1. * NU + -2. * NS + -1. * qD) / |G|) U set(dist 11->12, proba <= 2. * NS * NP / |exponent| + qE * NP / |exponent| + NU * NP / |exponent| + qD * NP / |exponent| + NP * NS / |exponent| + qE * NS / |exponent| + NU * NS / |exponent| + NS * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G| + 0.5 * NS * NS / |G| + NS * NP / |G| + NS * qE / |G|) U set(proba <= NS / |passwd| + NU / |passwd| + 0.5 * qD * qD / |G| + 0.5 * qH1 * qH1 / |hash1| + 0.5 * qE * qE / |G|) U set(dist 16->17, proba <= 1. / |exponent| * NP + 15. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + 10. * NU * NP / |exponent| + 2. * NS * NP / |exponent| + qH0 * NP / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + 8.5 * NU * NU / |G| + 3. * NS * NU / |G| + 2. * NP * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NP * qD / |G| + qD * NP / |exponent| + NU * qH1 / |hash1| + qD * NU / |G| + 0.5 * qD * qD / |G|) U set(dist 23->24, proba <= 4. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|) U set(dist 31->32.1, proba <= 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31))) U set(dist 31->32.2, proba <= NP * qD / |exponent|) U set(dist 31->32.3, proba <= NU * qD / |exponent|) U set(dist 31->32.4, proba <= NU * NP / |exponent|) U set(dist 31->32.5, proba <= 0.5 * qD * qD / |exponent|) U set(dist 31->32.6, proba <= 0.5 * NU * NU / |exponent|)
RESULT Proved event termS(x, X, y, Y, a, k) && termU(x, X, y, Y, a, k') ==> (k = k') with probability NU * NU / |exponent| + 0.5 * qD * qD / |exponent| + 14. * NU * NP / |exponent| + NU * qD / |exponent| + NP * qD / |exponent| + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + NS * qD / |exponent| + NS * NU / |exponent| + 23. * 1. / |exponent| * NS + qD * qD / |G| + qD * NU / |G| + NU * qH1 / |hash1| + 2. * qD * NP / |exponent| + NP * qD / |G| + NS * NU / |hash1| + NS * qD / |G| + qH0 * NU / |G| + 2. * NP * NU / |G| + 3. * NS * NU / |G| + 8.5 * NU * NU / |G| + 2. * qD * NS / |exponent| + 2. * NU * NS / |exponent| + qH0 * NP / |exponent| + 7. * NS * NP / |exponent| + 28. * 1. / |exponent| * NU + 2. * 1. / |exponent| * NP + 0.5 * qE * qE / |G| + 0.5 * qH1 * qH1 / |hash1| + NU / |passwd| + NS / |passwd| + NS * qE / |G| + NS * NP / |G| + 0.5 * NS * NS / |G| + qH1 * NU / |G| + 1.5 * NS * NS / |exponent| + qE * NS / |exponent| + NP * NS / |exponent| + qE * NP / |exponent| + (NP * NP + 2. * qE * NP + 2. * NU * NP + 4. * NS * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 4. * NS * qE + 2. * qD * qE + NU * NU + 4. * NS * NU + 2. * qD * NU + 4. * NS * NS + 4. * qD * NS + qD * qD + -1. * NP + -1. * qE + -1. * NU + -2. * NS + -1. * qD) / |G| + NP * NP / |exponent| + 2. * NS / |hash1| + qH1 * NP / |exponent|
RESULT Proved event inj:termS(x, X, y, Y, a, k) ==> inj:termU(x, X, y, Y, a, k) excluding set(dist 3->4, proba <= 1. / |exponent| * NP + 4. * 1. / |exponent| * NS + 2. * NU * NP / |exponent| + 3. * NS * NP / |exponent| + qH1 * NP / |exponent| + 2. * NS / |hash1| + NP * NP / |exponent| + 0.5 * NS * NS / |exponent| + 0.5 * NU * NU / |exponent|) U set(event Auth in game 10) U set(dist 10->11, proba <= (NP * NP + 2. * qE * NP + 2. * NU * NP + 4. * NS * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 4. * NS * qE + 2. * qD * qE + NU * NU + 4. * NS * NU + 2. * qD * NU + 4. * NS * NS + 4. * qD * NS + qD * qD + -1. * NP + -1. * qE + -1. * NU + -2. * NS + -1. * qD) / |G|) U set(dist 11->12, proba <= 2. * NS * NP / |exponent| + qE * NP / |exponent| + NU * NP / |exponent| + qD * NP / |exponent| + NP * NS / |exponent| + qE * NS / |exponent| + NU * NS / |exponent| + NS * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G| + 0.5 * NS * NS / |G| + NS * NP / |G| + NS * qE / |G|) U set(event Encrypt in game 15) U set(dist 16->17, proba <= 1. / |exponent| * NP + 15. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + 10. * NU * NP / |exponent| + 2. * NS * NP / |exponent| + qH0 * NP / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + 8.5 * NU * NU / |G| + 3. * NS * NU / |G| + 2. * NP * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NP * qD / |G| + qD * NP / |exponent| + NU * qH1 / |hash1| + qD * NU / |G| + 0.5 * qD * qD / |G|) U set(dist 23->24, proba <= 4. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|) U set(dist 31->32.1, proba <= 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31))) U set(dist 31->32.2, proba <= NP * qD / |exponent|) U set(dist 31->32.3, proba <= NU * qD / |exponent|) U set(dist 31->32.4, proba <= NU * NP / |exponent|) U set(dist 31->32.5, proba <= 0.5 * qD * qD / |exponent|) U set(dist 31->32.6, proba <= 0.5 * NU * NU / |exponent|)
RESULT Proved event inj:termS(x, X, y, Y, a, k) ==> inj:termU(x, X, y, Y, a, k) excluding set(dist 3->4, proba <= 1. / |exponent| * NP + 4. * 1. / |exponent| * NS + 2. * NU * NP / |exponent| + 3. * NS * NP / |exponent| + qH1 * NP / |exponent| + 2. * NS / |hash1| + NP * NP / |exponent| + 0.5 * NS * NS / |exponent| + 0.5 * NU * NU / |exponent|) U set(dist 10->11, proba <= (NP * NP + 2. * qE * NP + 2. * NU * NP + 4. * NS * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 4. * NS * qE + 2. * qD * qE + NU * NU + 4. * NS * NU + 2. * qD * NU + 4. * NS * NS + 4. * qD * NS + qD * qD + -1. * NP + -1. * qE + -1. * NU + -2. * NS + -1. * qD) / |G|) U set(dist 11->12, proba <= 2. * NS * NP / |exponent| + qE * NP / |exponent| + NU * NP / |exponent| + qD * NP / |exponent| + NP * NS / |exponent| + qE * NS / |exponent| + NU * NS / |exponent| + NS * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G| + 0.5 * NS * NS / |G| + NS * NP / |G| + NS * qE / |G|) U set(proba <= NS / |passwd| + NU / |passwd| + 0.5 * qD * qD / |G| + 0.5 * qH1 * qH1 / |hash1| + 0.5 * qE * qE / |G|) U set(dist 16->17, proba <= 1. / |exponent| * NP + 15. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + 10. * NU * NP / |exponent| + 2. * NS * NP / |exponent| + qH0 * NP / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + 8.5 * NU * NU / |G| + 3. * NS * NU / |G| + 2. * NP * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NP * qD / |G| + qD * NP / |exponent| + NU * qH1 / |hash1| + qD * NU / |G| + 0.5 * qD * qD / |G|) U set(dist 23->24, proba <= 4. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|) U set(dist 31->32.1, proba <= 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31))) U set(dist 31->32.2, proba <= NP * qD / |exponent|) U set(dist 31->32.3, proba <= NU * qD / |exponent|) U set(dist 31->32.4, proba <= NU * NP / |exponent|) U set(dist 31->32.5, proba <= 0.5 * qD * qD / |exponent|) U set(dist 31->32.6, proba <= 0.5 * NU * NU / |exponent|)
RESULT Proved event inj:termS(x, X, y, Y, a, k) ==> inj:termU(x, X, y, Y, a, k) with probability NU * NU / |exponent| + 0.5 * qD * qD / |exponent| + 14. * NU * NP / |exponent| + NU * qD / |exponent| + NP * qD / |exponent| + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + NS * qD / |exponent| + NS * NU / |exponent| + 23. * 1. / |exponent| * NS + qD * qD / |G| + qD * NU / |G| + NU * qH1 / |hash1| + 2. * qD * NP / |exponent| + NP * qD / |G| + NS * NU / |hash1| + NS * qD / |G| + qH0 * NU / |G| + 2. * NP * NU / |G| + 3. * NS * NU / |G| + 8.5 * NU * NU / |G| + 2. * qD * NS / |exponent| + 2. * NU * NS / |exponent| + qH0 * NP / |exponent| + 7. * NS * NP / |exponent| + 28. * 1. / |exponent| * NU + 2. * 1. / |exponent| * NP + 0.5 * qE * qE / |G| + 0.5 * qH1 * qH1 / |hash1| + NU / |passwd| + NS / |passwd| + NS * qE / |G| + NS * NP / |G| + 0.5 * NS * NS / |G| + qH1 * NU / |G| + 1.5 * NS * NS / |exponent| + qE * NS / |exponent| + NP * NS / |exponent| + qE * NP / |exponent| + (NP * NP + 2. * qE * NP + 2. * NU * NP + 4. * NS * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 4. * NS * qE + 2. * qD * qE + NU * NU + 4. * NS * NU + 2. * qD * NU + 4. * NS * NS + 4. * qD * NS + qD * qD + -1. * NP + -1. * qE + -1. * NU + -2. * NS + -1. * qD) / |G| + NP * NP / |exponent| + 2. * NS / |hash1| + qH1 * NP / |exponent|
RESULT Proved secrecy of sk_p excluding set(dist 3->4, proba <= 1. / |exponent| * NP + 4. * 1. / |exponent| * NS + 2. * NU * NP / |exponent| + 3. * NS * NP / |exponent| + qH1 * NP / |exponent| + 2. * NS / |hash1| + NP * NP / |exponent| + 0.5 * NS * NS / |exponent| + 0.5 * NU * NU / |exponent|) U set(event Auth in game 10) U set(dist 10->11, proba <= (NP * NP + 2. * qE * NP + 2. * NU * NP + 4. * NS * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 4. * NS * qE + 2. * qD * qE + NU * NU + 4. * NS * NU + 2. * qD * NU + 4. * NS * NS + 4. * qD * NS + qD * qD + -1. * NP + -1. * qE + -1. * NU + -2. * NS + -1. * qD) / |G|) U set(dist 11->12, proba <= 2. * NS * NP / |exponent| + qE * NP / |exponent| + NU * NP / |exponent| + qD * NP / |exponent| + NP * NS / |exponent| + qE * NS / |exponent| + NU * NS / |exponent| + NS * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G| + 0.5 * NS * NS / |G| + NS * NP / |G| + NS * qE / |G|) U set(event Encrypt in game 15) U set(dist 16->17, proba <= 1. / |exponent| * NP + 15. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + 10. * NU * NP / |exponent| + 2. * NS * NP / |exponent| + qH0 * NP / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + 8.5 * NU * NU / |G| + 3. * NS * NU / |G| + 2. * NP * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NP * qD / |G| + qD * NP / |exponent| + NU * qH1 / |hash1| + qD * NU / |G| + 0.5 * qD * qD / |G|) U set(dist 23->24, proba <= 4. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|) U set(dist 31->32.1, proba <= 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31))) U set(dist 31->32.2, proba <= NP * qD / |exponent|) U set(dist 31->32.3, proba <= NU * qD / |exponent|) U set(dist 31->32.4, proba <= NU * NP / |exponent|) U set(dist 31->32.5, proba <= 0.5 * qD * qD / |exponent|) U set(dist 31->32.6, proba <= 0.5 * NU * NU / |exponent|)
RESULT Proved secrecy of sk_p excluding set(dist 3->4, proba <= 1. / |exponent| * NP + 4. * 1. / |exponent| * NS + 2. * NU * NP / |exponent| + 3. * NS * NP / |exponent| + qH1 * NP / |exponent| + 2. * NS / |hash1| + NP * NP / |exponent| + 0.5 * NS * NS / |exponent| + 0.5 * NU * NU / |exponent|) U set(dist 10->11, proba <= (NP * NP + 2. * qE * NP + 2. * NU * NP + 4. * NS * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 4. * NS * qE + 2. * qD * qE + NU * NU + 4. * NS * NU + 2. * qD * NU + 4. * NS * NS + 4. * qD * NS + qD * qD + -1. * NP + -1. * qE + -1. * NU + -2. * NS + -1. * qD) / |G|) U set(dist 11->12, proba <= 2. * NS * NP / |exponent| + qE * NP / |exponent| + NU * NP / |exponent| + qD * NP / |exponent| + NP * NS / |exponent| + qE * NS / |exponent| + NU * NS / |exponent| + NS * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G| + 0.5 * NS * NS / |G| + NS * NP / |G| + NS * qE / |G|) U set(proba <= NS / |passwd| + NU / |passwd| + 0.5 * qD * qD / |G| + 0.5 * qH1 * qH1 / |hash1| + 0.5 * qE * qE / |G|) U set(dist 16->17, proba <= 1. / |exponent| * NP + 15. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + 10. * NU * NP / |exponent| + 2. * NS * NP / |exponent| + qH0 * NP / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + 8.5 * NU * NU / |G| + 3. * NS * NU / |G| + 2. * NP * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NP * qD / |G| + qD * NP / |exponent| + NU * qH1 / |hash1| + qD * NU / |G| + 0.5 * qD * qD / |G|) U set(dist 23->24, proba <= 4. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|) U set(dist 31->32.1, proba <= 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31))) U set(dist 31->32.2, proba <= NP * qD / |exponent|) U set(dist 31->32.3, proba <= NU * qD / |exponent|) U set(dist 31->32.4, proba <= NU * NP / |exponent|) U set(dist 31->32.5, proba <= 0.5 * qD * qD / |exponent|) U set(dist 31->32.6, proba <= 0.5 * NU * NU / |exponent|)
RESULT Proved secrecy of sk_p with probability NU * NU / |exponent| + 0.5 * qD * qD / |exponent| + 14. * NU * NP / |exponent| + NU * qD / |exponent| + NP * qD / |exponent| + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + NS * qD / |exponent| + NS * NU / |exponent| + 23. * 1. / |exponent| * NS + qD * qD / |G| + qD * NU / |G| + NU * qH1 / |hash1| + 2. * qD * NP / |exponent| + NP * qD / |G| + NS * NU / |hash1| + NS * qD / |G| + qH0 * NU / |G| + 2. * NP * NU / |G| + 3. * NS * NU / |G| + 8.5 * NU * NU / |G| + 2. * qD * NS / |exponent| + 2. * NU * NS / |exponent| + qH0 * NP / |exponent| + 7. * NS * NP / |exponent| + 28. * 1. / |exponent| * NU + 2. * 1. / |exponent| * NP + 0.5 * qE * qE / |G| + 0.5 * qH1 * qH1 / |hash1| + NU / |passwd| + NS / |passwd| + NS * qE / |G| + NS * NP / |G| + 0.5 * NS * NS / |G| + qH1 * NU / |G| + 1.5 * NS * NS / |exponent| + qE * NS / |exponent| + NP * NS / |exponent| + qE * NP / |exponent| + (NP * NP + 2. * qE * NP + 2. * NU * NP + 4. * NS * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 4. * NS * qE + 2. * qD * qE + NU * NU + 4. * NS * NU + 2. * qD * NU + 4. * NS * NS + 4. * qD * NS + qD * qD + -1. * NP + -1. * qE + -1. * NU + -2. * NS + -1. * qD) / |G| + NP * NP / |exponent| + 2. * NS / |hash1| + qH1 * NP / |exponent|
RESULT Proved secrecy of sk_s excluding set(dist 3->4, proba <= 1. / |exponent| * NP + 4. * 1. / |exponent| * NS + 2. * NU * NP / |exponent| + 3. * NS * NP / |exponent| + qH1 * NP / |exponent| + 2. * NS / |hash1| + NP * NP / |exponent| + 0.5 * NS * NS / |exponent| + 0.5 * NU * NU / |exponent|) U set(event Auth in game 10) U set(dist 10->11, proba <= (NP * NP + 2. * qE * NP + 2. * NU * NP + 4. * NS * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 4. * NS * qE + 2. * qD * qE + NU * NU + 4. * NS * NU + 2. * qD * NU + 4. * NS * NS + 4. * qD * NS + qD * qD + -1. * NP + -1. * qE + -1. * NU + -2. * NS + -1. * qD) / |G|) U set(dist 11->12, proba <= 2. * NS * NP / |exponent| + qE * NP / |exponent| + NU * NP / |exponent| + qD * NP / |exponent| + NP * NS / |exponent| + qE * NS / |exponent| + NU * NS / |exponent| + NS * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G| + 0.5 * NS * NS / |G| + NS * NP / |G| + NS * qE / |G|) U set(event Encrypt in game 15) U set(dist 16->17, proba <= 1. / |exponent| * NP + 15. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + 10. * NU * NP / |exponent| + 2. * NS * NP / |exponent| + qH0 * NP / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + 8.5 * NU * NU / |G| + 3. * NS * NU / |G| + 2. * NP * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NP * qD / |G| + qD * NP / |exponent| + NU * qH1 / |hash1| + qD * NU / |G| + 0.5 * qD * qD / |G|) U set(dist 23->24, proba <= 4. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|) U set(dist 31->32.1, proba <= 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31))) U set(dist 31->32.2, proba <= NP * qD / |exponent|) U set(dist 31->32.3, proba <= NU * qD / |exponent|) U set(dist 31->32.4, proba <= NU * NP / |exponent|) U set(dist 31->32.5, proba <= 0.5 * qD * qD / |exponent|) U set(dist 31->32.6, proba <= 0.5 * NU * NU / |exponent|)
RESULT Proved secrecy of sk_s excluding set(dist 3->4, proba <= 1. / |exponent| * NP + 4. * 1. / |exponent| * NS + 2. * NU * NP / |exponent| + 3. * NS * NP / |exponent| + qH1 * NP / |exponent| + 2. * NS / |hash1| + NP * NP / |exponent| + 0.5 * NS * NS / |exponent| + 0.5 * NU * NU / |exponent|) U set(dist 10->11, proba <= (NP * NP + 2. * qE * NP + 2. * NU * NP + 4. * NS * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 4. * NS * qE + 2. * qD * qE + NU * NU + 4. * NS * NU + 2. * qD * NU + 4. * NS * NS + 4. * qD * NS + qD * qD + -1. * NP + -1. * qE + -1. * NU + -2. * NS + -1. * qD) / |G|) U set(dist 11->12, proba <= 2. * NS * NP / |exponent| + qE * NP / |exponent| + NU * NP / |exponent| + qD * NP / |exponent| + NP * NS / |exponent| + qE * NS / |exponent| + NU * NS / |exponent| + NS * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G| + 0.5 * NS * NS / |G| + NS * NP / |G| + NS * qE / |G|) U set(proba <= NS / |passwd| + NU / |passwd| + 0.5 * qD * qD / |G| + 0.5 * qH1 * qH1 / |hash1| + 0.5 * qE * qE / |G|) U set(dist 16->17, proba <= 1. / |exponent| * NP + 15. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + 10. * NU * NP / |exponent| + 2. * NS * NP / |exponent| + qH0 * NP / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + 8.5 * NU * NU / |G| + 3. * NS * NU / |G| + 2. * NP * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NP * qD / |G| + qD * NP / |exponent| + NU * qH1 / |hash1| + qD * NU / |G| + 0.5 * qD * qD / |G|) U set(dist 23->24, proba <= 4. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|) U set(dist 31->32.1, proba <= 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31))) U set(dist 31->32.2, proba <= NP * qD / |exponent|) U set(dist 31->32.3, proba <= NU * qD / |exponent|) U set(dist 31->32.4, proba <= NU * NP / |exponent|) U set(dist 31->32.5, proba <= 0.5 * qD * qD / |exponent|) U set(dist 31->32.6, proba <= 0.5 * NU * NU / |exponent|)
RESULT Proved secrecy of sk_s with probability NU * NU / |exponent| + 0.5 * qD * qD / |exponent| + 14. * NU * NP / |exponent| + NU * qD / |exponent| + NP * qD / |exponent| + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + NS * qD / |exponent| + NS * NU / |exponent| + 23. * 1. / |exponent| * NS + qD * qD / |G| + qD * NU / |G| + NU * qH1 / |hash1| + 2. * qD * NP / |exponent| + NP * qD / |G| + NS * NU / |hash1| + NS * qD / |G| + qH0 * NU / |G| + 2. * NP * NU / |G| + 3. * NS * NU / |G| + 8.5 * NU * NU / |G| + 2. * qD * NS / |exponent| + 2. * NU * NS / |exponent| + qH0 * NP / |exponent| + 7. * NS * NP / |exponent| + 28. * 1. / |exponent| * NU + 2. * 1. / |exponent| * NP + 0.5 * qE * qE / |G| + 0.5 * qH1 * qH1 / |hash1| + NU / |passwd| + NS / |passwd| + NS * qE / |G| + NS * NP / |G| + 0.5 * NS * NS / |G| + qH1 * NU / |G| + 1.5 * NS * NS / |exponent| + qE * NS / |exponent| + NP * NS / |exponent| + qE * NP / |exponent| + (NP * NP + 2. * qE * NP + 2. * NU * NP + 4. * NS * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 4. * NS * qE + 2. * qD * qE + NU * NU + 4. * NS * NU + 2. * qD * NU + 4. * NS * NS + 4. * qD * NS + qD * qD + -1. * NP + -1. * qE + -1. * NU + -2. * NS + -1. * qD) / |G| + NP * NP / |exponent| + 2. * NS / |hash1| + qH1 * NP / |exponent|
RESULT Proved secrecy of sk_u excluding set(dist 3->4, proba <= 1. / |exponent| * NP + 4. * 1. / |exponent| * NS + 2. * NU * NP / |exponent| + 3. * NS * NP / |exponent| + qH1 * NP / |exponent| + 2. * NS / |hash1| + NP * NP / |exponent| + 0.5 * NS * NS / |exponent| + 0.5 * NU * NU / |exponent|) U set(event Auth in game 10) U set(dist 10->11, proba <= (NP * NP + 2. * qE * NP + 2. * NU * NP + 4. * NS * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 4. * NS * qE + 2. * qD * qE + NU * NU + 4. * NS * NU + 2. * qD * NU + 4. * NS * NS + 4. * qD * NS + qD * qD + -1. * NP + -1. * qE + -1. * NU + -2. * NS + -1. * qD) / |G|) U set(dist 11->12, proba <= 2. * NS * NP / |exponent| + qE * NP / |exponent| + NU * NP / |exponent| + qD * NP / |exponent| + NP * NS / |exponent| + qE * NS / |exponent| + NU * NS / |exponent| + NS * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G| + 0.5 * NS * NS / |G| + NS * NP / |G| + NS * qE / |G|) U set(event Encrypt in game 15) U set(dist 16->17, proba <= 1. / |exponent| * NP + 15. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + 10. * NU * NP / |exponent| + 2. * NS * NP / |exponent| + qH0 * NP / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + 8.5 * NU * NU / |G| + 3. * NS * NU / |G| + 2. * NP * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NP * qD / |G| + qD * NP / |exponent| + NU * qH1 / |hash1| + qD * NU / |G| + 0.5 * qD * qD / |G|) U set(dist 23->24, proba <= 4. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|) U set(dist 31->32.1, proba <= 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31))) U set(dist 31->32.2, proba <= NP * qD / |exponent|) U set(dist 31->32.3, proba <= NU * qD / |exponent|) U set(dist 31->32.4, proba <= NU * NP / |exponent|) U set(dist 31->32.5, proba <= 0.5 * qD * qD / |exponent|) U set(dist 31->32.6, proba <= 0.5 * NU * NU / |exponent|)
RESULT Proved secrecy of sk_u excluding set(dist 3->4, proba <= 1. / |exponent| * NP + 4. * 1. / |exponent| * NS + 2. * NU * NP / |exponent| + 3. * NS * NP / |exponent| + qH1 * NP / |exponent| + 2. * NS / |hash1| + NP * NP / |exponent| + 0.5 * NS * NS / |exponent| + 0.5 * NU * NU / |exponent|) U set(dist 10->11, proba <= (NP * NP + 2. * qE * NP + 2. * NU * NP + 4. * NS * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 4. * NS * qE + 2. * qD * qE + NU * NU + 4. * NS * NU + 2. * qD * NU + 4. * NS * NS + 4. * qD * NS + qD * qD + -1. * NP + -1. * qE + -1. * NU + -2. * NS + -1. * qD) / |G|) U set(dist 11->12, proba <= 2. * NS * NP / |exponent| + qE * NP / |exponent| + NU * NP / |exponent| + qD * NP / |exponent| + NP * NS / |exponent| + qE * NS / |exponent| + NU * NS / |exponent| + NS * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G| + 0.5 * NS * NS / |G| + NS * NP / |G| + NS * qE / |G|) U set(proba <= NS / |passwd| + NU / |passwd| + 0.5 * qD * qD / |G| + 0.5 * qH1 * qH1 / |hash1| + 0.5 * qE * qE / |G|) U set(dist 16->17, proba <= 1. / |exponent| * NP + 15. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + 10. * NU * NP / |exponent| + 2. * NS * NP / |exponent| + qH0 * NP / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + 8.5 * NU * NU / |G| + 3. * NS * NU / |G| + 2. * NP * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NP * qD / |G| + qD * NP / |exponent| + NU * qH1 / |hash1| + qD * NU / |G| + 0.5 * qD * qD / |G|) U set(dist 23->24, proba <= 4. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|) U set(dist 31->32.1, proba <= 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31))) U set(dist 31->32.2, proba <= NP * qD / |exponent|) U set(dist 31->32.3, proba <= NU * qD / |exponent|) U set(dist 31->32.4, proba <= NU * NP / |exponent|) U set(dist 31->32.5, proba <= 0.5 * qD * qD / |exponent|) U set(dist 31->32.6, proba <= 0.5 * NU * NU / |exponent|)
RESULT Proved secrecy of sk_u with probability NU * NU / |exponent| + 0.5 * qD * qD / |exponent| + 14. * NU * NP / |exponent| + NU * qD / |exponent| + NP * qD / |exponent| + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + NS * qD / |exponent| + NS * NU / |exponent| + 23. * 1. / |exponent| * NS + qD * qD / |G| + qD * NU / |G| + NU * qH1 / |hash1| + 2. * qD * NP / |exponent| + NP * qD / |G| + NS * NU / |hash1| + NS * qD / |G| + qH0 * NU / |G| + 2. * NP * NU / |G| + 3. * NS * NU / |G| + 8.5 * NU * NU / |G| + 2. * qD * NS / |exponent| + 2. * NU * NS / |exponent| + qH0 * NP / |exponent| + 7. * NS * NP / |exponent| + 28. * 1. / |exponent| * NU + 2. * 1. / |exponent| * NP + 0.5 * qE * qE / |G| + 0.5 * qH1 * qH1 / |hash1| + NU / |passwd| + NS / |passwd| + NS * qE / |G| + NS * NP / |G| + 0.5 * NS * NS / |G| + qH1 * NU / |G| + 1.5 * NS * NS / |exponent| + qE * NS / |exponent| + NP * NS / |exponent| + qE * NP / |exponent| + (NP * NP + 2. * qE * NP + 2. * NU * NP + 4. * NS * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 4. * NS * qE + 2. * qD * qE + NU * NU + 4. * NS * NU + 2. * qD * NU + 4. * NS * NS + 4. * qD * NS + qD * qD + -1. * NP + -1. * qE + -1. * NU + -2. * NS + -1. * qD) / |G| + NP * NP / |exponent| + 2. * NS / |hash1| + qH1 * NP / |exponent|

Applying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
 yields

Game 36 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@1_X_3743[@i_246], @2_m[@i_246], @2_kd[@i_246], @1_x_783[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_X_3743[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_90: hash1;
    event termU(U, X, S, Ystar_u, r1_90, r_414);
    out(c6[!_41], r1_90)
  )
  orfind @i_241 <= NU suchthat defined(Ystar_u[@i_241], @1_x_925[@i_241], @2_r4_172[@i_241]) && otheruses(Ystar_u[@i_241] -> @1_x_925[@i_241]) && (Ystar_u = Ystar_u[@i_241]) then
  (
    new r_426: hash0;
    let sk_u: hash0 = r_426 in
    new r1_90: hash1;
    event termU(U, X, S, Ystar_u, r1_90, r_426);
    out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    new r_438: hash0;
    let sk_u: hash0 = r_438 in
    new r1_90: hash1;
    event termU(U, X, S, Ystar_u, r1_90, r_438);
    out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    new r_450: hash0;
    let sk_u: hash0 = r_450 in
    new r1_90: hash1;
    event termU(U, X, S, Ystar_u, r1_90, r_450);
    out(c6[!_41], r1_90)
  )
  else
    new @1_x_925: exponent;
    let @2_r4_172: G = cst_G in
    new r1_90: hash1;
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    event termU(U, X, S, Ystar_u, r1_90, r_408);
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_236[j], r1_90[j], r_450[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    if (auth_s = r1_90[j]) then
    if defined(r_450[j]) && otheruses(r_450[j]) then
    let sk_s: hash0 = r_450[j] in
    event termS(U, X_s, S, @2_r2_169, auth_s, r_450[j])
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@1_X_3743[@i_222], @2_m[@i_222], @2_kd[@i_222], @1_x_783[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_X_3743[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3743[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind @i_217 <= NU suchthat defined(Ystar_u[@i_217], @1_x_925[@i_217], @2_r4_172[@i_217]) && otheruses(Ystar_u[@i_217] -> @1_x_925[@i_217]) && (@2_r2_169 = Ystar_u[@i_217]) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_exp'(g, @1_x_925[@i_217]) = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[@i_198], @1_x_783[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_X_3743[@i_198]) && ((@2_x = @1_X_3743[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_193 <= NU suchthat defined(@1_x_925[@i_193], Ystar_u[@i_193], @2_r4_172[@i_193]) && otheruses(Ystar_u[@i_193] -> @1_x_925[@i_193]) && ((@2_x = @1_exp'(g, @1_x_925[@i_193])) && (@2_ke = pw)) then
    out(@2_c2[!_44], Ystar_u[@i_193])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@1_X_3743[@i_186], @2_m[@i_186], @2_kd[@i_186], @1_x_783[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_X_3743[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_X_3743[@i_186])
  orfind @i_181 <= NU suchthat defined(Ystar_u[@i_181], @1_x_925[@i_181], @2_r4_172[@i_181]) && otheruses(Ystar_u[@i_181] -> @1_x_925[@i_181]) && ((@2_m = Ystar_u[@i_181]) && (@2_kd = pw)) then
    out(@2_c4[!_45], @1_exp'(g, @1_x_925[@i_181]))
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_X_3743: G;
    let @1_x_783: exponent = cst_exponent in
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_X_3743)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying simplify yields

Game 37 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_X_3743[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_X_3743[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    new r_438: hash0;
    let sk_u: hash0 = r_438 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    new r_450: hash0;
    let sk_u: hash0 = r_450 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  else
    let @2_r4_172: G = cst_G in
    new r1_90: hash1;
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_236[j], r1_90[j], r_450[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    if (auth_s = r1_90[j]) then
    let sk_s: hash0 = r_450[j]
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_X_3743[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_X_3743[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3743[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_X_3743[@i_198]) && ((@2_x = @1_X_3743[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_X_3743[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_X_3743[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_X_3743[@i_186])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_X_3743: G;
    let @1_x_783: exponent = cst_exponent in
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_X_3743)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of useless yields

Game 38 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_X_3743[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_X_3743[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    new r_438: hash0;
    let sk_u: hash0 = r_438 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    new r_450: hash0;
    let sk_u: hash0 = r_450 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  else
    new r1_90: hash1;
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_236[j], r1_90[j], r_450[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    if (auth_s = r1_90[j]) then
    let sk_s: hash0 = r_450[j]
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_X_3743[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_X_3743[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3743[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new yp: exponent;
  let Yp: G = @1_exp'(g, yp) in
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_X_3743[@i_198]) && ((@2_x = @1_X_3743[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_X_3743[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_X_3743[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_X_3743[@i_186])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_X_3743: G;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_X_3743)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
 yields

Game 39 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_X_3743[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_X_3743[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@2_r2_163[@i_238], Yp[@i_238]) && otheruses(Yp[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    new r_438: hash0;
    let sk_u: hash0 = r_438 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    new r_450: hash0;
    let sk_u: hash0 = r_450 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  else
    new r1_90: hash1;
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_236[j], r1_90[j], r_450[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    if (auth_s = r1_90[j]) then
    let sk_s: hash0 = r_450[j]
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_X_3743[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_X_3743[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3743[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new @1_X_3894: G;
  let Yp: G = @1_X_3894 in
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_X_3743[@i_198]) && ((@2_x = @1_X_3743[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(Yp[@i_190], @2_r2_163[@i_190]) && otheruses(Yp[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = Yp[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_X_3743[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_X_3743[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_X_3743[@i_186])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@2_r2_163[@i_178], Yp[@i_178]) && otheruses(Yp[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Yp[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_X_3743: G;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_X_3743)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of useless yields

Game 40 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_X_3743[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_X_3743[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@1_X_3894[@i_238], Yp[@i_238], @2_r2_163[@i_238]) && otheruses(@1_X_3894[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    new r_438: hash0;
    let sk_u: hash0 = r_438 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    new r_450: hash0;
    let sk_u: hash0 = r_450 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  else
    new r1_90: hash1;
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_236[j], r1_90[j], r_450[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    if (auth_s = r1_90[j]) then
    let sk_s: hash0 = r_450[j]
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_X_3743[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_X_3743[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3743[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new xp: exponent;
  let Xp: G = @1_exp'(g, xp) in
  new @1_X_3894: G;
  let Yp: G = cst_G in
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_X_3743[@i_198]) && ((@2_x = @1_X_3743[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(@1_X_3894[@i_190], Yp[@i_190], @2_r2_163[@i_190]) && otheruses(@1_X_3894[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = @1_X_3894[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_X_3743[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_X_3743[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_X_3743[@i_186])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@1_X_3894[@i_178], Yp[@i_178], @2_r2_163[@i_178]) && otheruses(@1_X_3894[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], @1_X_3894[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_X_3743: G;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_X_3743)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
 yields

Game 41 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_X_3743[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_X_3743[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_238 <= NP suchthat defined(@1_X_3894[@i_238], Yp[@i_238], @2_r2_163[@i_238]) && otheruses(@1_X_3894[@i_238] -> @2_r2_163[@i_238]) && (Ystar_u = @2_r2_163[@i_238]) then
  (
    new r_438: hash0;
    let sk_u: hash0 = r_438 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    new r_450: hash0;
    let sk_u: hash0 = r_450 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  else
    new r1_90: hash1;
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_236[j], r1_90[j], r_450[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    if (auth_s = r1_90[j]) then
    let sk_s: hash0 = r_450[j]
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_X_3743[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_X_3743[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3743[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new @1_X_3956: G;
  let Xp: G = @1_X_3956 in
  new @1_X_3894: G;
  let Yp: G = cst_G in
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_X_3743[@i_198]) && ((@2_x = @1_X_3743[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_190 <= NP suchthat defined(@1_X_3894[@i_190], Yp[@i_190], @2_r2_163[@i_190]) && otheruses(@1_X_3894[@i_190] -> @2_r2_163[@i_190]) && ((@2_x = @1_X_3894[@i_190]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_163[@i_190])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_X_3743[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_X_3743[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_X_3743[@i_186])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_178 <= NP suchthat defined(@1_X_3894[@i_178], Yp[@i_178], @2_r2_163[@i_178]) && otheruses(@1_X_3894[@i_178] -> @2_r2_163[@i_178]) && ((@2_m = @2_r2_163[@i_178]) && (@2_kd = pw)) then
    out(@2_c4[!_45], @1_X_3894[@i_178])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_X_3743: G;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_X_3743)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying simplify yields

Game 42 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_X_3743[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_X_3743[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    new r_450: hash0;
    let sk_u: hash0 = r_450 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  else
    new r1_90: hash1;
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_236[j], r1_90[j], r_450[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    if (auth_s = r1_90[j]) then
    let sk_s: hash0 = r_450[j]
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_X_3743[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_X_3743[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3743[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new @1_X_3956: G;
  let Xp: G = @1_X_3956 in
  let Yp: G = cst_G in
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, Xp, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_X_3743[@i_198]) && ((@2_x = @1_X_3743[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_X_3743[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_X_3743[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_X_3743[@i_186])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_X_3743: G;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_X_3743)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of useless yields

Game 43 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_X_3743[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_X_3743[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    new r_450: hash0;
    let sk_u: hash0 = r_450 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  else
    new r1_90: hash1;
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new y: exponent;
  let Y: G = @1_exp'(g, y) in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_236[j], r1_90[j], r_450[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    if (auth_s = r1_90[j]) then
    let sk_s: hash0 = r_450[j]
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_X_3743[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_X_3743[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3743[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new @1_X_3956: G;
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, @1_X_3956, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_X_3743[@i_198]) && ((@2_x = @1_X_3743[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_X_3743[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_X_3743[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_X_3743[@i_186])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_X_3743: G;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_X_3743)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
 yields

Game 44 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_X_3743[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_X_3743[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_236 <= NS suchthat defined(@2_r2_169[@i_236], Y[@i_236]) && otheruses(Y[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    new r_450: hash0;
    let sk_u: hash0 = r_450 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  else
    new r1_90: hash1;
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new @1_X_4096: G;
  let Y: G = @1_X_4096 in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_236[j], r1_90[j], r_450[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    if (auth_s = r1_90[j]) then
    let sk_s: hash0 = r_450[j]
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_X_3743[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_X_3743[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3743[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(Y -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((Y = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new @1_X_3956: G;
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, @1_X_3956, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_X_3743[@i_198]) && ((@2_x = @1_X_3743[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_188 <= NS suchthat defined(Y[@i_188], @2_r2_169[@i_188]) && otheruses(Y[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = Y[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_X_3743[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_X_3743[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_X_3743[@i_186])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_176 <= NS suchthat defined(@2_r2_169[@i_176], Y[@i_176]) && otheruses(Y[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], Y[@i_176])
  else
    new @1_X_3743: G;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_X_3743)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of useless yields

Game 45 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new x: exponent;
  let X: G = @1_exp'(g, x) in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_X_3743[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_X_3743[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_236 <= NS suchthat defined(@1_X_4096[@i_236], Y[@i_236], @2_r2_169[@i_236]) && otheruses(@1_X_4096[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    new r_450: hash0;
    let sk_u: hash0 = r_450 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  else
    new r1_90: hash1;
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new @1_X_4096: G;
  let Y: G = cst_G in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_236[j], r1_90[j], r_450[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    if (auth_s = r1_90[j]) then
    let sk_s: hash0 = r_450[j]
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_X_3743[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_X_3743[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3743[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(@1_X_4096 -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_4096 = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new @1_X_3956: G;
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, @1_X_3956, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_X_3743[@i_198]) && ((@2_x = @1_X_3743[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_188 <= NS suchthat defined(@1_X_4096[@i_188], Y[@i_188], @2_r2_169[@i_188]) && otheruses(@1_X_4096[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = @1_X_4096[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_X_3743[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_X_3743[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_X_3743[@i_186])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_176 <= NS suchthat defined(@1_X_4096[@i_176], Y[@i_176], @2_r2_169[@i_176]) && otheruses(@1_X_4096[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], @1_X_4096[@i_176])
  else
    new @1_X_3743: G;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_X_3743)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying equivalence
equiv ! !_9 <= @1_N new @1_x: exponent; @1_OX() := @1_exp'(g, @1_x)
<=(0)=>
      ! !_10 <= @1_N new @1_X: G; @1_OX() := @1_X
 yields

Game 46 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new @1_X_4140: G;
  let X: G = @1_X_4140 in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_X_3743[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_X_3743[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  orfind @i_236 <= NS suchthat defined(@1_X_4096[@i_236], Y[@i_236], @2_r2_169[@i_236]) && otheruses(@1_X_4096[@i_236] -> @2_r2_169[@i_236]) && (Ystar_u = @2_r2_169[@i_236]) then
  (
    new r_450: hash0;
    let sk_u: hash0 = r_450 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  else
    new r1_90: hash1;
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new @1_X_4096: G;
  let Y: G = cst_G in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
  (
    if defined(@i_236[j], r1_90[j], r_450[j]) && otheruses(r1_90[j]) && (!_42 = @i_236[j]) then
    if (auth_s = r1_90[j]) then
    let sk_s: hash0 = r_450[j]
  )
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_X_3743[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_X_3743[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3743[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    orfind  suchthat otheruses(@1_X_4096 -> @2_r2_169) then
    (
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_4096 = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new @1_X_3956: G;
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, @1_X_3956, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_X_3743[@i_198]) && ((@2_x = @1_X_3743[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  orfind @i_188 <= NS suchthat defined(@1_X_4096[@i_188], Y[@i_188], @2_r2_169[@i_188]) && otheruses(@1_X_4096[@i_188] -> @2_r2_169[@i_188]) && ((@2_x = @1_X_4096[@i_188]) && (@2_ke = pw)) then
    out(@2_c2[!_44], @2_r2_169[@i_188])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_X_3743[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_X_3743[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_X_3743[@i_186])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  orfind @i_176 <= NS suchthat defined(@1_X_4096[@i_176], Y[@i_176], @2_r2_169[@i_176]) && otheruses(@1_X_4096[@i_176] -> @2_r2_169[@i_176]) && ((@2_m = @2_r2_169[@i_176]) && (@2_kd = pw)) then
    out(@2_c4[!_45], @1_X_4096[@i_176])
  else
    new @1_X_3743: G;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_X_3743)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying simplify yields

Game 47 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new @1_X_4140: G;
  let X: G = @1_X_4140 in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_X_3743[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_X_3743[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  else
    new r1_90: hash1;
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  let Y: G = cst_G in
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
    yield
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_X_3743[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_X_3743[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3743[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
    event Auth
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new @1_X_3956: G;
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, @1_X_3956, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_X_3743[@i_198]) && ((@2_x = @1_X_3743[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_X_3743[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_X_3743[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_X_3743[@i_186])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  else
    new @1_X_3743: G;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_X_3743)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying move all binders yields

Game 48 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new @1_X_4140: G;
  let X: G = @1_X_4140 in
  out(c2[!_41], (U, X));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_X_3743[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_X_3743[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_90: hash1;
    out(c6[!_41], r1_90)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  else
    new r1_90: hash1;
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    out(c6[!_41], r1_90)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(X[j]) && (X[j] = X_s) then
    yield
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_X_3743[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_X_3743[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3743[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
    event Auth
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new @1_X_3956: G;
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, @1_X_3956, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_X_3743[@i_198]) && ((@2_x = @1_X_3743[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_X_3743[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_X_3743[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_X_3743[@i_186])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  else
    new @1_X_3743: G;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_X_3743)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying remove assignments of useless yields

Game 49 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new @1_X_4140: G;
  let X: G = cst_G in
  out(c2[!_41], (U, @1_X_4140));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_X_3743[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_X_3743[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_4247: hash1;
    out(c6[!_41], r1_4247)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  else
    new r1_4246: hash1;
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    out(c6[!_41], r1_4246)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(@1_X_4140[j], X[j]) && (@1_X_4140[j] = X_s) then
    yield
  else
    find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_X_3743[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_X_3743[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
    find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3743[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
    event Auth
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new @1_X_3956: G;
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, @1_X_3956, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_X_3743[@i_198]) && ((@2_x = @1_X_3743[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_X_3743[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_X_3743[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_X_3743[@i_186])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  else
    new @1_X_3743: G;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_X_3743)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying insert instruction find i1 <= qD, i2 <= qH1 suchthat defined(@2_m[i1], @2_kd[i1], @1_X_3743[i1], x11[i2], x12[i2], x13[i2], x14[i2], r1_66[i2]) && (@2_r2_169 = @2_m[i1]) && (U = x11[i2]) && (S = x12[i2]) && (X_s = x13[i2]) && (@1_X_3743[i1] = x14[i2]) && (auth_s = r1_66[i2]) && (pw = @2_kd[i1]) then at occurrence 370 yields

Game 50 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new @1_X_4140: G;
  let X: G = cst_G in
  out(c2[!_41], (U, @1_X_4140));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_X_3743[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_X_3743[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_4247: hash1;
    out(c6[!_41], r1_4247)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  else
    new r1_4246: hash1;
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    out(c6[!_41], r1_4246)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(@1_X_4140[j], X[j]) && (@1_X_4140[j] = X_s) then
    yield
  else
    find i1 <= qD, i2 <= qH1 suchthat defined(@2_m[i1], @2_kd[i1], @1_X_3743[i1], x11[i2], x12[i2], x13[i2], x14[i2], r1_66[i2]) && ((@2_r2_169 = @2_m[i1]) && ((U = x11[i2]) && ((S = x12[i2]) && ((X_s = x13[i2]) && ((@1_X_3743[i1] = x14[i2]) && ((auth_s = r1_66[i2]) && (pw = @2_kd[i1]))))))) then
    (
      find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_X_3743[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_X_3743[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3743[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
    )
    else
      find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_X_3743[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_X_3743[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3743[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new @1_X_3956: G;
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, @1_X_3956, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_X_3743[@i_198]) && ((@2_x = @1_X_3743[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_X_3743[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_X_3743[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_X_3743[@i_186])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  else
    new @1_X_3743: G;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_X_3743)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying insert event Auth2 at occurrence 445 [Excluding set(event Auth2 in game 51)] yields

Game 51 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new @1_X_4140: G;
  let X: G = cst_G in
  out(c2[!_41], (U, @1_X_4140));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_X_3743[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_X_3743[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_4247: hash1;
    out(c6[!_41], r1_4247)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  else
    new r1_4246: hash1;
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    out(c6[!_41], r1_4246)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(@1_X_4140[j], X[j]) && (@1_X_4140[j] = X_s) then
    yield
  else
    find i1 <= qD, i2 <= qH1 suchthat defined(@2_m[i1], @2_kd[i1], @1_X_3743[i1], x11[i2], x12[i2], x13[i2], x14[i2], r1_66[i2]) && ((@2_r2_169 = @2_m[i1]) && ((U = x11[i2]) && ((S = x12[i2]) && ((X_s = x13[i2]) && ((@1_X_3743[i1] = x14[i2]) && ((auth_s = r1_66[i2]) && (pw = @2_kd[i1]))))))) then
      event Auth2
    else
      find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_X_3743[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_X_3743[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3743[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new @1_X_3956: G;
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, @1_X_3956, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_X_3743[@i_198]) && ((@2_x = @1_X_3743[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_X_3743[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_X_3743[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_X_3743[@i_186])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  else
    new @1_X_3743: G;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_X_3743)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying move binder r1_4246 yields

Game 52 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new @1_X_4140: G;
  let X: G = cst_G in
  out(c2[!_41], (U, @1_X_4140));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_246 <= qD suchthat defined(@2_m[@i_246], @2_kd[@i_246], @1_X_3743[@i_246], @2_r4_157[@i_246]) && otheruses(@2_m[@i_246] -> @1_X_3743[@i_246]) && ((Ystar_u = @2_m[@i_246]) && (pw = @2_kd[@i_246])) then
  (
    new r_414: hash0;
    let sk_u: hash0 = r_414 in
    new r1_4247: hash1;
    out(c6[!_41], r1_4247)
  )
  orfind @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  else
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    new r1_4246: hash1;
    out(c6[!_41], r1_4246)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(@1_X_4140[j], X[j]) && (@1_X_4140[j] = X_s) then
    yield
  else
    find i1 <= qD, i2 <= qH1 suchthat defined(@2_m[i1], @2_kd[i1], @1_X_3743[i1], x11[i2], x12[i2], x13[i2], x14[i2], r1_66[i2]) && ((@2_r2_169 = @2_m[i1]) && ((U = x11[i2]) && ((S = x12[i2]) && ((X_s = x13[i2]) && ((@1_X_3743[i1] = x14[i2]) && ((auth_s = r1_66[i2]) && (pw = @2_kd[i1]))))))) then
      event Auth2
    else
      find [unique] @i_222 <= qD suchthat defined(@2_m[@i_222], @2_kd[@i_222], @1_X_3743[@i_222], @2_r4_157[@i_222]) && otheruses(@2_m[@i_222] -> @1_X_3743[@i_222]) && ((@2_r2_169 = @2_m[@i_222]) && (pw = @2_kd[@i_222])) then
      find nj <= qH1 suchthat defined(x11[nj], x12[nj], x13[nj], x14[nj], r1_66[nj]) && ((U = x11[nj]) && ((S = x12[nj]) && ((X_s = x13[nj]) && ((@1_X_3743[@i_222] = x14[nj]) && (auth_s = r1_66[nj]))))) then
      event Auth
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new @1_X_3956: G;
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, @1_X_3956, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_X_3743[@i_198]) && ((@2_x = @1_X_3743[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_X_3743[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_X_3743[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_X_3743[@i_186])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  else
    new @1_X_3743: G;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_X_3743)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying simplify yields

Game 53 is
in(start, ());
new pw: passwd;
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new @1_X_4140: G;
  let X: G = cst_G in
  out(c2[!_41], (U, @1_X_4140));
  in(c5[!_41], (=S, Ystar_u: G));
  find [unique] @i_239 <= qE suchthat defined(@2_r2_160[@i_239], @2_ke[@i_239], @2_x[@i_239]) && otheruses(@2_x[@i_239] -> @2_r2_160[@i_239]) && ((Ystar_u = @2_r2_160[@i_239]) && (pw = @2_ke[@i_239])) then
    event Encrypt
  else
    new r_408: hash0;
    let sk_u: hash0 = r_408 in
    new r1_4246: hash1;
    out(c6[!_41], r1_4246)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1);
  find j <= NU suchthat defined(@1_X_4140[j], X[j]) && (@1_X_4140[j] = X_s) then
    yield
  else
    find i1 <= qD, i2 <= qH1 suchthat defined(@2_m[i1], x11[i2], x12[i2], x13[i2], @1_X_3743[i1], x14[i2], r1_66[i2], @2_kd[i1]) && ((@2_r2_169 = @2_m[i1]) && ((U = x11[i2]) && ((S = x12[i2]) && ((X_s = x13[i2]) && ((@1_X_3743[i1] = x14[i2]) && ((auth_s = r1_66[i2]) && (pw = @2_kd[i1]))))))) then
    event Auth2
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new @1_X_3956: G;
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, @1_X_3956, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_X_3743[@i_198]) && ((@2_x = @1_X_3743[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_X_3743[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_X_3743[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_X_3743[@i_186])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  else
    new @1_X_3743: G;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_X_3743)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


Applying simplify with collision elimination at pw [Excluding set(dist 53->54, proba <= NS / |passwd| + NU / |passwd| + 0.5 * qD * qD / |G| + 0.5 * qH1 * qH1 / |hash1| + 0.5 * qE * qE / |G|)] yields

Game 54 is
in(start, ());
out(c8, ());
(
  ! !_41 <= NU
  in(c1[!_41], ());
  new @1_X_4140: G;
  let X: G = cst_G in
  out(c2[!_41], (U, @1_X_4140));
  in(c5[!_41], (=S, Ystar_u: G));
  new r_408: hash0;
  let sk_u: hash0 = r_408 in
  new r1_4246: hash1;
  out(c6[!_41], r1_4246)
) | (
  ! !_42 <= NS
  in(c3[!_42], (=U, X_s: G));
  new @2_r2_169: G;
  out(c4[!_42], (S, @2_r2_169));
  in(c7[!_42], auth_s: hash1)
) | (
  ! !_43 <= NP
  in(cp[!_43], ());
  new @1_X_3956: G;
  new @2_r2_163: G;
  new r1_72: hash1;
  new r_390: hash0;
  let sk_p: hash0 = r_390 in
  out(cp[!_43], (U, @1_X_3956, S, @2_r2_163, r1_72))
) | (
  ! !_44 <= qE
  in(@2_c1[!_44], (@2_x: G, @2_ke: passwd));
  find [unique] @i_198 <= qD suchthat defined(@1_X_3743[@i_198], @2_kd[@i_198], @2_m[@i_198], @2_r4_157[@i_198]) && otheruses(@2_m[@i_198] -> @1_X_3743[@i_198]) && ((@2_x = @1_X_3743[@i_198]) && (@2_ke = @2_kd[@i_198])) then
    out(@2_c2[!_44], @2_m[@i_198])
  orfind @i_191 <= qE suchthat defined(@2_x[@i_191], @2_ke[@i_191], @2_r2_160[@i_191]) && otheruses(@2_x[@i_191] -> @2_r2_160[@i_191]) && ((@2_x = @2_x[@i_191]) && (@2_ke = @2_ke[@i_191])) then
    out(@2_c2[!_44], @2_r2_160[@i_191])
  else
    new @2_r2_160: G;
    out(@2_c2[!_44], @2_r2_160)
) | (
  ! !_45 <= qD
  in(@2_c3[!_45], (@2_m: G, @2_kd: passwd));
  find [unique] @i_186 <= qD suchthat defined(@2_m[@i_186], @2_kd[@i_186], @1_X_3743[@i_186], @2_r4_157[@i_186]) && otheruses(@2_m[@i_186] -> @1_X_3743[@i_186]) && ((@2_m = @2_m[@i_186]) && (@2_kd = @2_kd[@i_186])) then
    out(@2_c4[!_45], @1_X_3743[@i_186])
  orfind @i_179 <= qE suchthat defined(@2_r2_160[@i_179], @2_ke[@i_179], @2_x[@i_179]) && otheruses(@2_x[@i_179] -> @2_r2_160[@i_179]) && ((@2_m = @2_r2_160[@i_179]) && (@2_kd = @2_ke[@i_179])) then
    out(@2_c4[!_45], @2_x[@i_179])
  else
    new @1_X_3743: G;
    let @2_r4_157: G = cst_G in
    out(@2_c4[!_45], @1_X_3743)
) | (
  ! !_46 <= qH0
  in(c10[!_46], (x1: host, x2: host, x3: G, x4: G, x5: G));
  find [unique] @i_474 <= qH0 suchthat defined(x1[@i_474], x2[@i_474], x3[@i_474], x4[@i_474], x5[@i_474], r_384[@i_474]) && otheruses(r_384[@i_474]) && ((x1 = x1[@i_474]) && ((x2 = x2[@i_474]) && ((x3 = x3[@i_474]) && ((x4 = x4[@i_474]) && (x5 = x5[@i_474]))))) then
    out(c20[!_46], r_384[@i_474])
  else
    new r_384: hash0;
    out(c20[!_46], r_384)
) | (
  ! !_47 <= qH1
  in(c11[!_47], (x11: host, x12: host, x13: G, x14: G, x15: G));
  find [unique] @i_100 <= qH1 suchthat defined(x11[@i_100], x12[@i_100], x13[@i_100], x14[@i_100], x15[@i_100], r1_66[@i_100]) && otheruses(r1_66[@i_100]) && ((x11 = x11[@i_100]) && ((x12 = x12[@i_100]) && ((x13 = x13[@i_100]) && ((x14 = x14[@i_100]) && (x15 = x15[@i_100]))))) then
    out(c21[!_47], r1_66[@i_100])
  else
    new r1_66: hash1;
    out(c21[!_47], r1_66)
)


RESULT Proved event Auth2 ==> false in game 51 excluding set(dist 53->54, proba <= NS / |passwd| + NU / |passwd| + 0.5 * qD * qD / |G| + 0.5 * qH1 * qH1 / |hash1| + 0.5 * qE * qE / |G|)
RESULT Proved event Auth2 ==> false in game 51 with probability 0.5 * qE * qE / |G| + 0.5 * qH1 * qH1 / |hash1| + 0.5 * qD * qD / |G| + NU / |passwd| + NS / |passwd|
RESULT Proved event Encrypt ==> false in game 15 excluding set(dist 16->17, proba <= 1. / |exponent| * NP + 15. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + 10. * NU * NP / |exponent| + 2. * NS * NP / |exponent| + qH0 * NP / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + 8.5 * NU * NU / |G| + 3. * NS * NU / |G| + 2. * NP * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NP * qD / |G| + qD * NP / |exponent| + NU * qH1 / |hash1| + qD * NU / |G| + 0.5 * qD * qD / |G|) U set(dist 23->24, proba <= 4. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|) U set(dist 31->32.1, proba <= 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31))) U set(dist 31->32.2, proba <= NP * qD / |exponent|) U set(dist 31->32.3, proba <= NU * qD / |exponent|) U set(dist 31->32.4, proba <= NU * NP / |exponent|) U set(dist 31->32.5, proba <= 0.5 * qD * qD / |exponent|) U set(dist 31->32.6, proba <= 0.5 * NU * NU / |exponent|) U set(event Auth2 in game 51) U set(dist 53->54, proba <= NS / |passwd| + NU / |passwd| + 0.5 * qD * qD / |G| + 0.5 * qH1 * qH1 / |hash1| + 0.5 * qE * qE / |G|)
RESULT Proved event Encrypt ==> false in game 15 excluding set(dist 16->17, proba <= 1. / |exponent| * NP + 15. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + 10. * NU * NP / |exponent| + 2. * NS * NP / |exponent| + qH0 * NP / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + 8.5 * NU * NU / |G| + 3. * NS * NU / |G| + 2. * NP * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NP * qD / |G| + qD * NP / |exponent| + NU * qH1 / |hash1| + qD * NU / |G| + 0.5 * qD * qD / |G|) U set(dist 23->24, proba <= 4. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|) U set(dist 31->32.1, proba <= 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31))) U set(dist 31->32.2, proba <= NP * qD / |exponent|) U set(dist 31->32.3, proba <= NU * qD / |exponent|) U set(dist 31->32.4, proba <= NU * NP / |exponent|) U set(dist 31->32.5, proba <= 0.5 * qD * qD / |exponent|) U set(dist 31->32.6, proba <= 0.5 * NU * NU / |exponent|) U set(dist 53->54, proba <= NS / |passwd| + NU / |passwd| + 0.5 * qD * qD / |G| + 0.5 * qH1 * qH1 / |hash1| + 0.5 * qE * qE / |G|)
RESULT Proved event Encrypt ==> false in game 15 with probability 0.5 * qE * qE / |G| + 0.5 * qH1 * qH1 / |hash1| + qD * qD / |G| + NU / |passwd| + NS / |passwd| + 0.5 * NU * NU / |exponent| + 0.5 * qD * qD / |exponent| + 11. * NU * NP / |exponent| + NU * qD / |exponent| + NP * qD / |exponent| + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + NS * qD / |exponent| + NS * NU / |exponent| + 19. * 1. / |exponent| * NS + qD * NU / |G| + NU * qH1 / |hash1| + qD * NP / |exponent| + NP * qD / |G| + NS * NU / |hash1| + NS * qD / |G| + qH0 * NU / |G| + 2. * NP * NU / |G| + 3. * NS * NU / |G| + 8.5 * NU * NU / |G| + qD * NS / |exponent| + NU * NS / |exponent| + qH0 * NP / |exponent| + 2. * NS * NP / |exponent| + 28. * 1. / |exponent| * NU + 1. / |exponent| * NP
RESULT Proved event Auth ==> false in game 10 excluding set(dist 10->11, proba <= (NP * NP + 2. * qE * NP + 2. * NU * NP + 4. * NS * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 4. * NS * qE + 2. * qD * qE + NU * NU + 4. * NS * NU + 2. * qD * NU + 4. * NS * NS + 4. * qD * NS + qD * qD + -1. * NP + -1. * qE + -1. * NU + -2. * NS + -1. * qD) / |G|) U set(dist 11->12, proba <= 2. * NS * NP / |exponent| + qE * NP / |exponent| + NU * NP / |exponent| + qD * NP / |exponent| + NP * NS / |exponent| + qE * NS / |exponent| + NU * NS / |exponent| + NS * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G| + 0.5 * NS * NS / |G| + NS * NP / |G| + NS * qE / |G|) U set(event Encrypt in game 15) U set(dist 16->17, proba <= 1. / |exponent| * NP + 15. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + 10. * NU * NP / |exponent| + 2. * NS * NP / |exponent| + qH0 * NP / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + 8.5 * NU * NU / |G| + 3. * NS * NU / |G| + 2. * NP * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NP * qD / |G| + qD * NP / |exponent| + NU * qH1 / |hash1| + qD * NU / |G| + 0.5 * qD * qD / |G|) U set(dist 23->24, proba <= 4. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|) U set(dist 31->32.1, proba <= 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31))) U set(dist 31->32.2, proba <= NP * qD / |exponent|) U set(dist 31->32.3, proba <= NU * qD / |exponent|) U set(dist 31->32.4, proba <= NU * NP / |exponent|) U set(dist 31->32.5, proba <= 0.5 * qD * qD / |exponent|) U set(dist 31->32.6, proba <= 0.5 * NU * NU / |exponent|) U set(event Auth2 in game 51) U set(dist 53->54, proba <= NS / |passwd| + NU / |passwd| + 0.5 * qD * qD / |G| + 0.5 * qH1 * qH1 / |hash1| + 0.5 * qE * qE / |G|)
RESULT Proved event Auth ==> false in game 10 excluding set(dist 10->11, proba <= (NP * NP + 2. * qE * NP + 2. * NU * NP + 4. * NS * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 4. * NS * qE + 2. * qD * qE + NU * NU + 4. * NS * NU + 2. * qD * NU + 4. * NS * NS + 4. * qD * NS + qD * qD + -1. * NP + -1. * qE + -1. * NU + -2. * NS + -1. * qD) / |G|) U set(dist 11->12, proba <= 2. * NS * NP / |exponent| + qE * NP / |exponent| + NU * NP / |exponent| + qD * NP / |exponent| + NP * NS / |exponent| + qE * NS / |exponent| + NU * NS / |exponent| + NS * NS / |exponent| + qD * NS / |exponent| + qH1 * NU / |G| + 0.5 * NS * NS / |G| + NS * NP / |G| + NS * qE / |G|) U set(dist 16->17, proba <= 1. / |exponent| * NP + 15. * 1. / |exponent| * NS + 28. * 1. / |exponent| * NU + 10. * NU * NP / |exponent| + 2. * NS * NP / |exponent| + qH0 * NP / |exponent| + NU * NS / |exponent| + qD * NS / |exponent| + 8.5 * NU * NU / |G| + 3. * NS * NU / |G| + 2. * NP * NU / |G| + qH0 * NU / |G| + NS * qD / |G| + NS * NU / |hash1| + NP * qD / |G| + qD * NP / |exponent| + NU * qH1 / |hash1| + qD * NU / |G| + 0.5 * qD * qD / |G|) U set(dist 23->24, proba <= 4. * 1. / |exponent| * NS + NS * NU / |exponent| + NS * qD / |exponent|) U set(dist 31->32.1, proba <= 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31))) U set(dist 31->32.2, proba <= NP * qD / |exponent|) U set(dist 31->32.3, proba <= NU * qD / |exponent|) U set(dist 31->32.4, proba <= NU * NP / |exponent|) U set(dist 31->32.5, proba <= 0.5 * qD * qD / |exponent|) U set(dist 31->32.6, proba <= 0.5 * NU * NU / |exponent|) U set(dist 53->54, proba <= NS / |passwd| + NU / |passwd| + 0.5 * qD * qD / |G| + 0.5 * qH1 * qH1 / |hash1| + 0.5 * qE * qE / |G|)
RESULT Proved event Auth ==> false in game 10 with probability 0.5 * qE * qE / |G| + 0.5 * qH1 * qH1 / |hash1| + qD * qD / |G| + NU / |passwd| + NS / |passwd| + 0.5 * NU * NU / |exponent| + 0.5 * qD * qD / |exponent| + 12. * NU * NP / |exponent| + NU * qD / |exponent| + NP * qD / |exponent| + 2. * qH1 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + 2. * qH0 * pCDH(NS * time(exp) + 2. * NP * time(exp) + qD * time(exp) + 2. * NU * time(exp) + 2. * qH0 * time(exp) + 2. * qH1 * time(exp) + time + time(context for game 31)) + NS * qD / |exponent| + NS * NU / |exponent| + 19. * 1. / |exponent| * NS + qD * NU / |G| + NU * qH1 / |hash1| + 2. * qD * NP / |exponent| + NP * qD / |G| + NS * NU / |hash1| + NS * qD / |G| + qH0 * NU / |G| + 2. * NP * NU / |G| + 3. * NS * NU / |G| + 8.5 * NU * NU / |G| + 2. * qD * NS / |exponent| + 2. * NU * NS / |exponent| + qH0 * NP / |exponent| + 4. * NS * NP / |exponent| + 28. * 1. / |exponent| * NU + 1. / |exponent| * NP + NS * qE / |G| + NS * NP / |G| + 0.5 * NS * NS / |G| + qH1 * NU / |G| + NS * NS / |exponent| + qE * NS / |exponent| + NP * NS / |exponent| + qE * NP / |exponent| + (NP * NP + 2. * qE * NP + 2. * NU * NP + 4. * NS * NP + 2. * qD * NP + qE * qE + 2. * NU * qE + 4. * NS * qE + 2. * qD * qE + NU * NU + 4. * NS * NU + 2. * qD * NU + 4. * NS * NS + 4. * qD * NS + qD * qD + -1. * NP + -1. * qE + -1. * NU + -2. * NS + -1. * qD) / |G|
RESULT time(context for game 31) = 0
All queries proved.
